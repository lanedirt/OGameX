!function(t,e){"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,(function(t,e){var i=[],n=t.document,a=i.slice,s=i.concat,o=i.push,r=i.indexOf,l={},c=l.toString,d=l.hasOwnProperty,u={},h="1.12.4",p=function(t,e){return new p.fn.init(t,e)},f=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,m=/^-ms-/,g=/-([\da-z])/gi,v=function(t,e){return e.toUpperCase()};function b(t){var e=!!t&&"length"in t&&t.length,i=p.type(t);return"function"!==i&&!p.isWindow(t)&&("array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t)}p.fn=p.prototype={jquery:h,constructor:p,selector:"",length:0,toArray:function(){return a.call(this)},get:function(t){return null!=t?0>t?this[t+this.length]:this[t]:a.call(this)},pushStack:function(t){var e=p.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t){return p.each(this,t)},map:function(t){return this.pushStack(p.map(this,(function(e,i){return t.call(e,i,e)})))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(0>t?e:0);return this.pushStack(i>=0&&e>i?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:o,sort:i.sort,splice:i.splice},p.extend=p.fn.extend=function(){var t,e,i,n,a,s,o=arguments[0]||{},r=1,l=arguments.length,c=!1;for("boolean"==typeof o&&(c=o,o=arguments[r]||{},r++),"object"==typeof o||p.isFunction(o)||(o={}),r===l&&(o=this,r--);l>r;r++)if(null!=(a=arguments[r]))for(n in a)t=o[n],o!==(i=a[n])&&(c&&i&&(p.isPlainObject(i)||(e=p.isArray(i)))?(e?(e=!1,s=t&&p.isArray(t)?t:[]):s=t&&p.isPlainObject(t)?t:{},o[n]=p.extend(c,s,i)):void 0!==i&&(o[n]=i));return o},p.extend({expando:"jQuery"+(h+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===p.type(t)},isArray:Array.isArray||function(t){return"array"===p.type(t)},isWindow:function(t){return null!=t&&t==t.window},isNumeric:function(t){var e=t&&t.toString();return!p.isArray(t)&&e-parseFloat(e)+1>=0},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},isPlainObject:function(t){var e;if(!t||"object"!==p.type(t)||t.nodeType||p.isWindow(t))return!1;try{if(t.constructor&&!d.call(t,"constructor")&&!d.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}if(!u.ownFirst)for(e in t)return d.call(t,e);for(e in t);return void 0===e||d.call(t,e)},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?l[c.call(t)]||"object":typeof t},globalEval:function(e){e&&p.trim(e)&&(t.execScript||function(e){t.eval.call(t,e)})(e)},camelCase:function(t){return t.replace(m,"ms-").replace(g,v)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e){var i,n=0;if(b(t))for(i=t.length;i>n&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},trim:function(t){return null==t?"":(t+"").replace(f,"")},makeArray:function(t,e){var i=e||[];return null!=t&&(b(Object(t))?p.merge(i,"string"==typeof t?[t]:t):o.call(i,t)),i},inArray:function(t,e,i){var n;if(e){if(r)return r.call(e,t,i);for(n=e.length,i=i?0>i?Math.max(0,n+i):i:0;n>i;i++)if(i in e&&e[i]===t)return i}return-1},merge:function(t,e){for(var i=+e.length,n=0,a=t.length;i>n;)t[a++]=e[n++];if(i!=i)for(;void 0!==e[n];)t[a++]=e[n++];return t.length=a,t},grep:function(t,e,i){for(var n=[],a=0,s=t.length,o=!i;s>a;a++)!e(t[a],a)!==o&&n.push(t[a]);return n},map:function(t,e,i){var n,a,o=0,r=[];if(b(t))for(n=t.length;n>o;o++)null!=(a=e(t[o],o,i))&&r.push(a);else for(o in t)null!=(a=e(t[o],o,i))&&r.push(a);return s.apply([],r)},guid:1,proxy:function(t,e){var i,n,s;return"string"==typeof e&&(s=t[e],e=t,t=s),p.isFunction(t)?(i=a.call(arguments,2),n=function(){return t.apply(e||this,i.concat(a.call(arguments)))},n.guid=t.guid=t.guid||p.guid++,n):void 0},now:function(){return+new Date},support:u}),"function"==typeof Symbol&&(p.fn[Symbol.iterator]=i[Symbol.iterator]),p.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){l["[object "+e+"]"]=e.toLowerCase()}));var y=function(t){var e,i,n,a,s,o,r,l,c,d,u,h,p,f,m,g,v,b,y,_="sizzle"+1*new Date,x=t.document,w=0,C=0,k=st(),$=st(),S=st(),T=function(t,e){return t===e&&(u=!0),0},I=1<<31,D={}.hasOwnProperty,A=[],P=A.pop,O=A.push,E=A.push,M=A.slice,L=function(t,e){for(var i=0,n=t.length;n>i;i++)if(t[i]===e)return i;return-1},j="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",R="[\\x20\\t\\r\\n\\f]",N="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",B="\\["+R+"*("+N+")(?:"+R+"*([*^$|!~]?=)"+R+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+N+"))|)"+R+"*\\]",F=":("+N+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+B+")*)|.*)\\)|)",H=new RegExp(R+"+","g"),z=new RegExp("^"+R+"+|((?:^|[^\\\\])(?:\\\\.)*)"+R+"+$","g"),W=new RegExp("^"+R+"*,"+R+"*"),U=new RegExp("^"+R+"*([>+~]|"+R+")"+R+"*"),q=new RegExp("="+R+"*([^\\]'\"]*?)"+R+"*\\]","g"),Y=new RegExp(F),V=new RegExp("^"+N+"$"),G={ID:new RegExp("^#("+N+")"),CLASS:new RegExp("^\\.("+N+")"),TAG:new RegExp("^("+N+"|[*])"),ATTR:new RegExp("^"+B),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+R+"*(even|odd|(([+-]|)(\\d*)n|)"+R+"*(?:([+-]|)"+R+"*(\\d+)|))"+R+"*\\)|)","i"),bool:new RegExp("^(?:"+j+")$","i"),needsContext:new RegExp("^"+R+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+R+"*((?:-\\d)?\\d*)"+R+"*\\)|)(?=[^-]|$)","i")},K=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Z=/[+~]/,tt=/'|\\/g,et=new RegExp("\\\\([\\da-f]{1,6}"+R+"?|("+R+")|.)","ig"),it=function(t,e,i){var n="0x"+e-65536;return n!=n||i?e:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},nt=function(){h()};try{E.apply(A=M.call(x.childNodes),x.childNodes),A[x.childNodes.length].nodeType}catch(t){E={apply:A.length?function(t,e){O.apply(t,M.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}function at(t,e,n,a){var s,r,c,d,u,f,v,b,w=e&&e.ownerDocument,C=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==C&&9!==C&&11!==C)return n;if(!a&&((e?e.ownerDocument||e:x)!==p&&h(e),e=e||p,m)){if(11!==C&&(f=J.exec(t)))if(s=f[1]){if(9===C){if(!(c=e.getElementById(s)))return n;if(c.id===s)return n.push(c),n}else if(w&&(c=w.getElementById(s))&&y(e,c)&&c.id===s)return n.push(c),n}else{if(f[2])return E.apply(n,e.getElementsByTagName(t)),n;if((s=f[3])&&i.getElementsByClassName&&e.getElementsByClassName)return E.apply(n,e.getElementsByClassName(s)),n}if(i.qsa&&!S[t+" "]&&(!g||!g.test(t))){if(1!==C)w=e,b=t;else if("object"!==e.nodeName.toLowerCase()){for((d=e.getAttribute("id"))?d=d.replace(tt,"\\$&"):e.setAttribute("id",d=_),r=(v=o(t)).length,u=V.test(d)?"#"+d:"[id='"+d+"']";r--;)v[r]=u+" "+mt(v[r]);b=v.join(","),w=Z.test(t)&&pt(e.parentNode)||e}if(b)try{return E.apply(n,w.querySelectorAll(b)),n}catch(t){}finally{d===_&&e.removeAttribute("id")}}}return l(t.replace(z,"$1"),e,n,a)}function st(){var t=[];return function e(i,a){return t.push(i+" ")>n.cacheLength&&delete e[t.shift()],e[i+" "]=a}}function ot(t){return t[_]=!0,t}function rt(t){var e=p.createElement("div");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function lt(t,e){for(var i=t.split("|"),a=i.length;a--;)n.attrHandle[i[a]]=e}function ct(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||I)-(~t.sourceIndex||I);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function dt(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ut(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function ht(t){return ot((function(e){return e=+e,ot((function(i,n){for(var a,s=t([],i.length,e),o=s.length;o--;)i[a=s[o]]&&(i[a]=!(n[a]=i[a]))}))}))}function pt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in i=at.support={},s=at.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},h=at.setDocument=function(t){var e,a,o=t?t.ownerDocument||t:x;return o!==p&&9===o.nodeType&&o.documentElement?(f=(p=o).documentElement,m=!s(p),(a=p.defaultView)&&a.top!==a&&(a.addEventListener?a.addEventListener("unload",nt,!1):a.attachEvent&&a.attachEvent("onunload",nt)),i.attributes=rt((function(t){return t.className="i",!t.getAttribute("className")})),i.getElementsByTagName=rt((function(t){return t.appendChild(p.createComment("")),!t.getElementsByTagName("*").length})),i.getElementsByClassName=Q.test(p.getElementsByClassName),i.getById=rt((function(t){return f.appendChild(t).id=_,!p.getElementsByName||!p.getElementsByName(_).length})),i.getById?(n.find.ID=function(t,e){if(void 0!==e.getElementById&&m){var i=e.getElementById(t);return i?[i]:[]}},n.filter.ID=function(t){var e=t.replace(et,it);return function(t){return t.getAttribute("id")===e}}):(delete n.find.ID,n.filter.ID=function(t){var e=t.replace(et,it);return function(t){var i=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}}),n.find.TAG=i.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):i.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,n=[],a=0,s=e.getElementsByTagName(t);if("*"===t){for(;i=s[a++];)1===i.nodeType&&n.push(i);return n}return s},n.find.CLASS=i.getElementsByClassName&&function(t,e){return void 0!==e.getElementsByClassName&&m?e.getElementsByClassName(t):void 0},v=[],g=[],(i.qsa=Q.test(p.querySelectorAll))&&(rt((function(t){f.appendChild(t).innerHTML="<a id='"+_+"'></a><select id='"+_+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&g.push("[*^$]="+R+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||g.push("\\["+R+"*(?:value|"+j+")"),t.querySelectorAll("[id~="+_+"-]").length||g.push("~="),t.querySelectorAll(":checked").length||g.push(":checked"),t.querySelectorAll("a#"+_+"+*").length||g.push(".#.+[+~]")})),rt((function(t){var e=p.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&g.push("name"+R+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||g.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),g.push(",.*:")}))),(i.matchesSelector=Q.test(b=f.matches||f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&rt((function(t){i.disconnectedMatch=b.call(t,"div"),b.call(t,"[s!='']:x"),v.push("!=",F)})),g=g.length&&new RegExp(g.join("|")),v=v.length&&new RegExp(v.join("|")),e=Q.test(f.compareDocumentPosition),y=e||Q.test(f.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},T=e?function(t,e){if(t===e)return u=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n||(1&(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!i.sortDetached&&e.compareDocumentPosition(t)===n?t===p||t.ownerDocument===x&&y(x,t)?-1:e===p||e.ownerDocument===x&&y(x,e)?1:d?L(d,t)-L(d,e):0:4&n?-1:1)}:function(t,e){if(t===e)return u=!0,0;var i,n=0,a=t.parentNode,s=e.parentNode,o=[t],r=[e];if(!a||!s)return t===p?-1:e===p?1:a?-1:s?1:d?L(d,t)-L(d,e):0;if(a===s)return ct(t,e);for(i=t;i=i.parentNode;)o.unshift(i);for(i=e;i=i.parentNode;)r.unshift(i);for(;o[n]===r[n];)n++;return n?ct(o[n],r[n]):o[n]===x?-1:r[n]===x?1:0},p):p},at.matches=function(t,e){return at(t,null,null,e)},at.matchesSelector=function(t,e){if((t.ownerDocument||t)!==p&&h(t),e=e.replace(q,"='$1']"),i.matchesSelector&&m&&!S[e+" "]&&(!v||!v.test(e))&&(!g||!g.test(e)))try{var n=b.call(t,e);if(n||i.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(t){}return at(e,p,null,[t]).length>0},at.contains=function(t,e){return(t.ownerDocument||t)!==p&&h(t),y(t,e)},at.attr=function(t,e){(t.ownerDocument||t)!==p&&h(t);var a=n.attrHandle[e.toLowerCase()],s=a&&D.call(n.attrHandle,e.toLowerCase())?a(t,e,!m):void 0;return void 0!==s?s:i.attributes||!m?t.getAttribute(e):(s=t.getAttributeNode(e))&&s.specified?s.value:null},at.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},at.uniqueSort=function(t){var e,n=[],a=0,s=0;if(u=!i.detectDuplicates,d=!i.sortStable&&t.slice(0),t.sort(T),u){for(;e=t[s++];)e===t[s]&&(a=n.push(s));for(;a--;)t.splice(n[a],1)}return d=null,t},a=at.getText=function(t){var e,i="",n=0,s=t.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=a(t)}else if(3===s||4===s)return t.nodeValue}else for(;e=t[n++];)i+=a(e);return i},n=at.selectors={cacheLength:50,createPseudo:ot,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,it),t[3]=(t[3]||t[4]||t[5]||"").replace(et,it),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||at.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&at.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return G.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&Y.test(i)&&(e=o(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,it).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=k[t+" "];return e||(e=new RegExp("(^|"+R+")"+t+"("+R+"|$)"))&&k(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,i){return function(n){var a=at.attr(n,t);return null==a?"!="===e:!e||(a+="","="===e?a===i:"!="===e?a!==i:"^="===e?i&&0===a.indexOf(i):"*="===e?i&&a.indexOf(i)>-1:"$="===e?i&&a.slice(-i.length)===i:"~="===e?(" "+a.replace(H," ")+" ").indexOf(i)>-1:"|="===e&&(a===i||a.slice(0,i.length+1)===i+"-"))}},CHILD:function(t,e,i,n,a){var s="nth"!==t.slice(0,3),o="last"!==t.slice(-4),r="of-type"===e;return 1===n&&0===a?function(t){return!!t.parentNode}:function(e,i,l){var c,d,u,h,p,f,m=s!==o?"nextSibling":"previousSibling",g=e.parentNode,v=r&&e.nodeName.toLowerCase(),b=!l&&!r,y=!1;if(g){if(s){for(;m;){for(h=e;h=h[m];)if(r?h.nodeName.toLowerCase()===v:1===h.nodeType)return!1;f=m="only"===t&&!f&&"nextSibling"}return!0}if(f=[o?g.firstChild:g.lastChild],o&&b){for(y=(p=(c=(d=(u=(h=g)[_]||(h[_]={}))[h.uniqueID]||(u[h.uniqueID]={}))[t]||[])[0]===w&&c[1])&&c[2],h=p&&g.childNodes[p];h=++p&&h&&h[m]||(y=p=0)||f.pop();)if(1===h.nodeType&&++y&&h===e){d[t]=[w,p,y];break}}else if(b&&(y=p=(c=(d=(u=(h=e)[_]||(h[_]={}))[h.uniqueID]||(u[h.uniqueID]={}))[t]||[])[0]===w&&c[1]),!1===y)for(;(h=++p&&h&&h[m]||(y=p=0)||f.pop())&&((r?h.nodeName.toLowerCase()!==v:1!==h.nodeType)||!++y||(b&&((d=(u=h[_]||(h[_]={}))[h.uniqueID]||(u[h.uniqueID]={}))[t]=[w,y]),h!==e)););return(y-=a)===n||y%n==0&&y/n>=0}}},PSEUDO:function(t,e){var i,a=n.pseudos[t]||n.setFilters[t.toLowerCase()]||at.error("unsupported pseudo: "+t);return a[_]?a(e):a.length>1?(i=[t,t,"",e],n.setFilters.hasOwnProperty(t.toLowerCase())?ot((function(t,i){for(var n,s=a(t,e),o=s.length;o--;)t[n=L(t,s[o])]=!(i[n]=s[o])})):function(t){return a(t,0,i)}):a}},pseudos:{not:ot((function(t){var e=[],i=[],n=r(t.replace(z,"$1"));return n[_]?ot((function(t,e,i,a){for(var s,o=n(t,null,a,[]),r=t.length;r--;)(s=o[r])&&(t[r]=!(e[r]=s))})):function(t,a,s){return e[0]=t,n(e,null,s,i),e[0]=null,!i.pop()}})),has:ot((function(t){return function(e){return at(t,e).length>0}})),contains:ot((function(t){return t=t.replace(et,it),function(e){return(e.textContent||e.innerText||a(e)).indexOf(t)>-1}})),lang:ot((function(t){return V.test(t||"")||at.error("unsupported lang: "+t),t=t.replace(et,it).toLowerCase(),function(e){var i;do{if(i=m?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(i=i.toLowerCase())===t||0===i.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===f},focus:function(t){return t===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!n.pseudos.empty(t)},header:function(t){return X.test(t.nodeName)},input:function(t){return K.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:ht((function(){return[0]})),last:ht((function(t,e){return[e-1]})),eq:ht((function(t,e,i){return[0>i?i+e:i]})),even:ht((function(t,e){for(var i=0;e>i;i+=2)t.push(i);return t})),odd:ht((function(t,e){for(var i=1;e>i;i+=2)t.push(i);return t})),lt:ht((function(t,e,i){for(var n=0>i?i+e:i;--n>=0;)t.push(n);return t})),gt:ht((function(t,e,i){for(var n=0>i?i+e:i;++n<e;)t.push(n);return t}))}},n.pseudos.nth=n.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})n.pseudos[e]=dt(e);for(e in{submit:!0,reset:!0})n.pseudos[e]=ut(e);function ft(){}function mt(t){for(var e=0,i=t.length,n="";i>e;e++)n+=t[e].value;return n}function gt(t,e,i){var n=e.dir,a=i&&"parentNode"===n,s=C++;return e.first?function(e,i,s){for(;e=e[n];)if(1===e.nodeType||a)return t(e,i,s)}:function(e,i,o){var r,l,c,d=[w,s];if(o){for(;e=e[n];)if((1===e.nodeType||a)&&t(e,i,o))return!0}else for(;e=e[n];)if(1===e.nodeType||a){if((r=(l=(c=e[_]||(e[_]={}))[e.uniqueID]||(c[e.uniqueID]={}))[n])&&r[0]===w&&r[1]===s)return d[2]=r[2];if(l[n]=d,d[2]=t(e,i,o))return!0}}}function vt(t){return t.length>1?function(e,i,n){for(var a=t.length;a--;)if(!t[a](e,i,n))return!1;return!0}:t[0]}function bt(t,e,i,n,a){for(var s,o=[],r=0,l=t.length,c=null!=e;l>r;r++)(s=t[r])&&(i&&!i(s,n,a)||(o.push(s),c&&e.push(r)));return o}function yt(t,e,i,n,a,s){return n&&!n[_]&&(n=yt(n)),a&&!a[_]&&(a=yt(a,s)),ot((function(s,o,r,l){var c,d,u,h=[],p=[],f=o.length,m=s||function(t,e,i){for(var n=0,a=e.length;a>n;n++)at(t,e[n],i);return i}(e||"*",r.nodeType?[r]:r,[]),g=!t||!s&&e?m:bt(m,h,t,r,l),v=i?a||(s?t:f||n)?[]:o:g;if(i&&i(g,v,r,l),n)for(c=bt(v,p),n(c,[],r,l),d=c.length;d--;)(u=c[d])&&(v[p[d]]=!(g[p[d]]=u));if(s){if(a||t){if(a){for(c=[],d=v.length;d--;)(u=v[d])&&c.push(g[d]=u);a(null,v=[],c,l)}for(d=v.length;d--;)(u=v[d])&&(c=a?L(s,u):h[d])>-1&&(s[c]=!(o[c]=u))}}else v=bt(v===o?v.splice(f,v.length):v),a?a(null,o,v,l):E.apply(o,v)}))}function _t(t){for(var e,i,a,s=t.length,o=n.relative[t[0].type],r=o||n.relative[" "],l=o?1:0,d=gt((function(t){return t===e}),r,!0),u=gt((function(t){return L(e,t)>-1}),r,!0),h=[function(t,i,n){var a=!o&&(n||i!==c)||((e=i).nodeType?d(t,i,n):u(t,i,n));return e=null,a}];s>l;l++)if(i=n.relative[t[l].type])h=[gt(vt(h),i)];else{if((i=n.filter[t[l].type].apply(null,t[l].matches))[_]){for(a=++l;s>a&&!n.relative[t[a].type];a++);return yt(l>1&&vt(h),l>1&&mt(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(z,"$1"),i,a>l&&_t(t.slice(l,a)),s>a&&_t(t=t.slice(a)),s>a&&mt(t))}h.push(i)}return vt(h)}function xt(t,e){var i=e.length>0,a=t.length>0,s=function(s,o,r,l,d){var u,f,g,v=0,b="0",y=s&&[],_=[],x=c,C=s||a&&n.find.TAG("*",d),k=w+=null==x?1:Math.random()||.1,$=C.length;for(d&&(c=o===p||o||d);b!==$&&null!=(u=C[b]);b++){if(a&&u){for(f=0,o||u.ownerDocument===p||(h(u),r=!m);g=t[f++];)if(g(u,o||p,r)){l.push(u);break}d&&(w=k)}i&&((u=!g&&u)&&v--,s&&y.push(u))}if(v+=b,i&&b!==v){for(f=0;g=e[f++];)g(y,_,o,r);if(s){if(v>0)for(;b--;)y[b]||_[b]||(_[b]=P.call(l));_=bt(_)}E.apply(l,_),d&&!s&&_.length>0&&v+e.length>1&&at.uniqueSort(l)}return d&&(w=k,c=x),y};return i?ot(s):s}return ft.prototype=n.filters=n.pseudos,n.setFilters=new ft,o=at.tokenize=function(t,e){var i,a,s,o,r,l,c,d=$[t+" "];if(d)return e?0:d.slice(0);for(r=t,l=[],c=n.preFilter;r;){for(o in i&&!(a=W.exec(r))||(a&&(r=r.slice(a[0].length)||r),l.push(s=[])),i=!1,(a=U.exec(r))&&(i=a.shift(),s.push({value:i,type:a[0].replace(z," ")}),r=r.slice(i.length)),n.filter)!(a=G[o].exec(r))||c[o]&&!(a=c[o](a))||(i=a.shift(),s.push({value:i,type:o,matches:a}),r=r.slice(i.length));if(!i)break}return e?r.length:r?at.error(t):$(t,l).slice(0)},r=at.compile=function(t,e){var i,n=[],a=[],s=S[t+" "];if(!s){for(e||(e=o(t)),i=e.length;i--;)(s=_t(e[i]))[_]?n.push(s):a.push(s);(s=S(t,xt(a,n))).selector=t}return s},l=at.select=function(t,e,a,s){var l,c,d,u,h,p="function"==typeof t&&t,f=!s&&o(t=p.selector||t);if(a=a||[],1===f.length){if((c=f[0]=f[0].slice(0)).length>2&&"ID"===(d=c[0]).type&&i.getById&&9===e.nodeType&&m&&n.relative[c[1].type]){if(!(e=(n.find.ID(d.matches[0].replace(et,it),e)||[])[0]))return a;p&&(e=e.parentNode),t=t.slice(c.shift().value.length)}for(l=G.needsContext.test(t)?0:c.length;l--&&(d=c[l],!n.relative[u=d.type]);)if((h=n.find[u])&&(s=h(d.matches[0].replace(et,it),Z.test(c[0].type)&&pt(e.parentNode)||e))){if(c.splice(l,1),!(t=s.length&&mt(c)))return E.apply(a,s),a;break}}return(p||r(t,f))(s,e,!m,a,!e||Z.test(t)&&pt(e.parentNode)||e),a},i.sortStable=_.split("").sort(T).join("")===_,i.detectDuplicates=!!u,h(),i.sortDetached=rt((function(t){return 1&t.compareDocumentPosition(p.createElement("div"))})),rt((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||lt("type|href|height|width",(function(t,e,i){return i?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),i.attributes&&rt((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||lt("value",(function(t,e,i){return i||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue})),rt((function(t){return null==t.getAttribute("disabled")}))||lt(j,(function(t,e,i){var n;return i?void 0:!0===t[e]?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null})),at}(t);p.find=y,p.expr=y.selectors,p.expr[":"]=p.expr.pseudos,p.uniqueSort=p.unique=y.uniqueSort,p.text=y.getText,p.isXMLDoc=y.isXML,p.contains=y.contains;var _=function(t,e,i){for(var n=[],a=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(a&&p(t).is(i))break;n.push(t)}return n},x=function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i},w=p.expr.match.needsContext,C=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,k=/^.[^:#\[\.,]*$/;function $(t,e,i){if(p.isFunction(e))return p.grep(t,(function(t,n){return!!e.call(t,n,t)!==i}));if(e.nodeType)return p.grep(t,(function(t){return t===e!==i}));if("string"==typeof e){if(k.test(e))return p.filter(e,t,i);e=p.filter(e,t)}return p.grep(t,(function(t){return p.inArray(t,e)>-1!==i}))}p.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?p.find.matchesSelector(n,t)?[n]:[]:p.find.matches(t,p.grep(e,(function(t){return 1===t.nodeType})))},p.fn.extend({find:function(t){var e,i=[],n=this,a=n.length;if("string"!=typeof t)return this.pushStack(p(t).filter((function(){for(e=0;a>e;e++)if(p.contains(n[e],this))return!0})));for(e=0;a>e;e++)p.find(t,n[e],i);return(i=this.pushStack(a>1?p.unique(i):i)).selector=this.selector?this.selector+" "+t:t,i},filter:function(t){return this.pushStack($(this,t||[],!1))},not:function(t){return this.pushStack($(this,t||[],!0))},is:function(t){return!!$(this,"string"==typeof t&&w.test(t)?p(t):t||[],!1).length}});var S,T=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,I=p.fn.init=function(t,e,i){var a,s;if(!t)return this;if(i=i||S,"string"==typeof t){if(!(a="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:T.exec(t))||!a[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(a[1]){if(e=e instanceof p?e[0]:e,p.merge(this,p.parseHTML(a[1],e&&e.nodeType?e.ownerDocument||e:n,!0)),C.test(a[1])&&p.isPlainObject(e))for(a in e)p.isFunction(this[a])?this[a](e[a]):this.attr(a,e[a]);return this}if((s=n.getElementById(a[2]))&&s.parentNode){if(s.id!==a[2])return S.find(t);this.length=1,this[0]=s}return this.context=n,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):p.isFunction(t)?void 0!==i.ready?i.ready(t):t(p):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),p.makeArray(t,this))};I.prototype=p.fn,S=p(n);var D=/^(?:parents|prev(?:Until|All))/,A={children:!0,contents:!0,next:!0,prev:!0};function P(t,e){do{t=t[e]}while(t&&1!==t.nodeType);return t}p.fn.extend({has:function(t){var e,i=p(t,this),n=i.length;return this.filter((function(){for(e=0;n>e;e++)if(p.contains(this,i[e]))return!0}))},closest:function(t,e){for(var i,n=0,a=this.length,s=[],o=w.test(t)||"string"!=typeof t?p(t,e||this.context):0;a>n;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(o?o.index(i)>-1:1===i.nodeType&&p.find.matchesSelector(i,t))){s.push(i);break}return this.pushStack(s.length>1?p.uniqueSort(s):s)},index:function(t){return t?"string"==typeof t?p.inArray(this[0],p(t)):p.inArray(t.jquery?t[0]:t,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(p.uniqueSort(p.merge(this.get(),p(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),p.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return _(t,"parentNode")},parentsUntil:function(t,e,i){return _(t,"parentNode",i)},next:function(t){return P(t,"nextSibling")},prev:function(t){return P(t,"previousSibling")},nextAll:function(t){return _(t,"nextSibling")},prevAll:function(t){return _(t,"previousSibling")},nextUntil:function(t,e,i){return _(t,"nextSibling",i)},prevUntil:function(t,e,i){return _(t,"previousSibling",i)},siblings:function(t){return x((t.parentNode||{}).firstChild,t)},children:function(t){return x(t.firstChild)},contents:function(t){return p.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:p.merge([],t.childNodes)}},(function(t,e){p.fn[t]=function(i,n){var a=p.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(a=p.filter(n,a)),this.length>1&&(A[t]||(a=p.uniqueSort(a)),D.test(t)&&(a=a.reverse())),this.pushStack(a)}}));var O,E,M=/\S+/g;function L(){n.addEventListener?(n.removeEventListener("DOMContentLoaded",j),t.removeEventListener("load",j)):(n.detachEvent("onreadystatechange",j),t.detachEvent("onload",j))}function j(){(n.addEventListener||"load"===t.event.type||"complete"===n.readyState)&&(L(),p.ready())}for(E in p.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return p.each(t.match(M)||[],(function(t,i){e[i]=!0})),e}(t):p.extend({},t);var e,i,n,a,s=[],o=[],r=-1,l=function(){for(a=t.once,n=e=!0;o.length;r=-1)for(i=o.shift();++r<s.length;)!1===s[r].apply(i[0],i[1])&&t.stopOnFalse&&(r=s.length,i=!1);t.memory||(i=!1),e=!1,a&&(s=i?[]:"")},c={add:function(){return s&&(i&&!e&&(r=s.length-1,o.push(i)),function e(i){p.each(i,(function(i,n){p.isFunction(n)?t.unique&&c.has(n)||s.push(n):n&&n.length&&"string"!==p.type(n)&&e(n)}))}(arguments),i&&!e&&l()),this},remove:function(){return p.each(arguments,(function(t,e){for(var i;(i=p.inArray(e,s,i))>-1;)s.splice(i,1),r>=i&&r--})),this},has:function(t){return t?p.inArray(t,s)>-1:s.length>0},empty:function(){return s&&(s=[]),this},disable:function(){return a=o=[],s=i="",this},disabled:function(){return!s},lock:function(){return a=!0,i||c.disable(),this},locked:function(){return!!a},fireWith:function(t,i){return a||(i=[t,(i=i||[]).slice?i.slice():i],o.push(i),e||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!n}};return c},p.extend({Deferred:function(t){var e=[["resolve","done",p.Callbacks("once memory"),"resolved"],["reject","fail",p.Callbacks("once memory"),"rejected"],["notify","progress",p.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return a.done(arguments).fail(arguments),this},then:function(){var t=arguments;return p.Deferred((function(i){p.each(e,(function(e,s){var o=p.isFunction(t[e])&&t[e];a[s[1]]((function(){var t=o&&o.apply(this,arguments);t&&p.isFunction(t.promise)?t.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[s[0]+"With"](this===n?i.promise():this,o?[t]:arguments)}))})),t=null})).promise()},promise:function(t){return null!=t?p.extend(t,n):n}},a={};return n.pipe=n.then,p.each(e,(function(t,s){var o=s[2],r=s[3];n[s[1]]=o.add,r&&o.add((function(){i=r}),e[1^t][2].disable,e[2][2].lock),a[s[0]]=function(){return a[s[0]+"With"](this===a?n:this,arguments),this},a[s[0]+"With"]=o.fireWith})),n.promise(a),t&&t.call(a,a),a},when:function(t){var e,i,n,s=0,o=a.call(arguments),r=o.length,l=1!==r||t&&p.isFunction(t.promise)?r:0,c=1===l?t:p.Deferred(),d=function(t,i,n){return function(s){i[t]=this,n[t]=arguments.length>1?a.call(arguments):s,n===e?c.notifyWith(i,n):--l||c.resolveWith(i,n)}};if(r>1)for(e=new Array(r),i=new Array(r),n=new Array(r);r>s;s++)o[s]&&p.isFunction(o[s].promise)?o[s].promise().progress(d(s,i,e)).done(d(s,n,o)).fail(c.reject):--l;return l||c.resolveWith(n,o),c.promise()}}),p.fn.ready=function(t){return p.ready.promise().done(t),this},p.extend({isReady:!1,readyWait:1,holdReady:function(t){t?p.readyWait++:p.ready(!0)},ready:function(t){(!0===t?--p.readyWait:p.isReady)||(p.isReady=!0,!0!==t&&--p.readyWait>0||(O.resolveWith(n,[p]),p.fn.triggerHandler&&(p(n).triggerHandler("ready"),p(n).off("ready"))))}}),p.ready.promise=function(e){if(!O)if(O=p.Deferred(),"complete"===n.readyState||"loading"!==n.readyState&&!n.documentElement.doScroll)t.setTimeout(p.ready);else if(n.addEventListener)n.addEventListener("DOMContentLoaded",j),t.addEventListener("load",j);else{n.attachEvent("onreadystatechange",j),t.attachEvent("onload",j);var i=!1;try{i=null==t.frameElement&&n.documentElement}catch(t){}i&&i.doScroll&&function e(){if(!p.isReady){try{i.doScroll("left")}catch(i){return t.setTimeout(e,50)}L(),p.ready()}}()}return O.promise(e)},p.ready.promise(),p(u))break;u.ownFirst="0"===E,u.inlineBlockNeedsLayout=!1,p((function(){var t,e,i,a;(i=n.getElementsByTagName("body")[0])&&i.style&&(e=n.createElement("div"),(a=n.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",i.appendChild(a).appendChild(e),void 0!==e.style.zoom&&(e.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",u.inlineBlockNeedsLayout=t=3===e.offsetWidth,t&&(i.style.zoom=1)),i.removeChild(a))})),function(){var t=n.createElement("div");u.deleteExpando=!0;try{delete t.test}catch(t){u.deleteExpando=!1}t=null}();var R=function(t){var e=p.noData[(t.nodeName+" ").toLowerCase()],i=+t.nodeType||1;return(1===i||9===i)&&(!e||!0!==e&&t.getAttribute("classid")===e)},N=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,B=/([A-Z])/g;function F(t,e,i){if(void 0===i&&1===t.nodeType){var n="data-"+e.replace(B,"-$1").toLowerCase();if("string"==typeof(i=t.getAttribute(n))){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:N.test(i)?p.parseJSON(i):i)}catch(t){}p.data(t,e,i)}else i=void 0}return i}function H(t){var e;for(e in t)if(("data"!==e||!p.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function z(t,e,n,a){if(R(t)){var s,o,r=p.expando,l=t.nodeType,c=l?p.cache:t,d=l?t[r]:t[r]&&r;if(d&&c[d]&&(a||c[d].data)||void 0!==n||"string"!=typeof e)return d||(d=l?t[r]=i.pop()||p.guid++:r),c[d]||(c[d]=l?{}:{toJSON:p.noop}),"object"!=typeof e&&"function"!=typeof e||(a?c[d]=p.extend(c[d],e):c[d].data=p.extend(c[d].data,e)),o=c[d],a||(o.data||(o.data={}),o=o.data),void 0!==n&&(o[p.camelCase(e)]=n),"string"==typeof e?null==(s=o[e])&&(s=o[p.camelCase(e)]):s=o,s}}function W(t,e,i){if(R(t)){var n,a,s=t.nodeType,o=s?p.cache:t,r=s?t[p.expando]:p.expando;if(o[r]){if(e&&(n=i?o[r]:o[r].data)){p.isArray(e)?e=e.concat(p.map(e,p.camelCase)):e in n?e=[e]:e=(e=p.camelCase(e))in n?[e]:e.split(" "),a=e.length;for(;a--;)delete n[e[a]];if(i?!H(n):!p.isEmptyObject(n))return}(i||(delete o[r].data,H(o[r])))&&(s?p.cleanData([t],!0):u.deleteExpando||o!=o.window?delete o[r]:o[r]=void 0)}}}p.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(t){return!!(t=t.nodeType?p.cache[t[p.expando]]:t[p.expando])&&!H(t)},data:function(t,e,i){return z(t,e,i)},removeData:function(t,e){return W(t,e)},_data:function(t,e,i){return z(t,e,i,!0)},_removeData:function(t,e){return W(t,e,!0)}}),p.fn.extend({data:function(t,e){var i,n,a,s=this[0],o=s&&s.attributes;if(void 0===t){if(this.length&&(a=p.data(s),1===s.nodeType&&!p._data(s,"parsedAttrs"))){for(i=o.length;i--;)o[i]&&(0===(n=o[i].name).indexOf("data-")&&F(s,n=p.camelCase(n.slice(5)),a[n]));p._data(s,"parsedAttrs",!0)}return a}return"object"==typeof t?this.each((function(){p.data(this,t)})):arguments.length>1?this.each((function(){p.data(this,t,e)})):s?F(s,t,p.data(s,t)):void 0},removeData:function(t){return this.each((function(){p.removeData(this,t)}))}}),p.extend({queue:function(t,e,i){var n;return t?(e=(e||"fx")+"queue",n=p._data(t,e),i&&(!n||p.isArray(i)?n=p._data(t,e,p.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(t,e){e=e||"fx";var i=p.queue(t,e),n=i.length,a=i.shift(),s=p._queueHooks(t,e);"inprogress"===a&&(a=i.shift(),n--),a&&("fx"===e&&i.unshift("inprogress"),delete s.stop,a.call(t,(function(){p.dequeue(t,e)}),s)),!n&&s&&s.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return p._data(t,i)||p._data(t,i,{empty:p.Callbacks("once memory").add((function(){p._removeData(t,e+"queue"),p._removeData(t,i)}))})}}),p.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?p.queue(this[0],t):void 0===e?this:this.each((function(){var i=p.queue(this,t,e);p._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&p.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){p.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,a=p.Deferred(),s=this,o=this.length,r=function(){--n||a.resolveWith(s,[s])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";o--;)(i=p._data(s[o],t+"queueHooks"))&&i.empty&&(n++,i.empty.add(r));return r(),a.promise(e)}}),function(){var t;u.shrinkWrapBlocks=function(){return null!=t?t:(t=!1,(i=n.getElementsByTagName("body")[0])&&i.style?(e=n.createElement("div"),(a=n.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",i.appendChild(a).appendChild(e),void 0!==e.style.zoom&&(e.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",e.appendChild(n.createElement("div")).style.width="5px",t=3!==e.offsetWidth),i.removeChild(a),t):void 0);var e,i,a}}();var U=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,q=new RegExp("^(?:([+-])=|)("+U+")([a-z%]*)$","i"),Y=["Top","Right","Bottom","Left"],V=function(t,e){return t=e||t,"none"===p.css(t,"display")||!p.contains(t.ownerDocument,t)};function G(t,e,i,n){var a,s=1,o=20,r=n?function(){return n.cur()}:function(){return p.css(t,e,"")},l=r(),c=i&&i[3]||(p.cssNumber[e]?"":"px"),d=(p.cssNumber[e]||"px"!==c&&+l)&&q.exec(p.css(t,e));if(d&&d[3]!==c){c=c||d[3],i=i||[],d=+l||1;do{d/=s=s||".5",p.style(t,e,d+c)}while(s!==(s=r()/l)&&1!==s&&--o)}return i&&(d=+d||+l||0,a=i[1]?d+(i[1]+1)*i[2]:+i[2],n&&(n.unit=c,n.start=d,n.end=a)),a}var K=function(t,e,i,n,a,s,o){var r=0,l=t.length,c=null==i;if("object"===p.type(i))for(r in a=!0,i)K(t,e,r,i[r],!0,s,o);else if(void 0!==n&&(a=!0,p.isFunction(n)||(o=!0),c&&(o?(e.call(t,n),e=null):(c=e,e=function(t,e,i){return c.call(p(t),i)})),e))for(;l>r;r++)e(t[r],i,o?n:n.call(t[r],r,e(t[r],i)));return a?t:c?e.call(t):l?e(t[0],i):s},X=/^(?:checkbox|radio)$/i,Q=/<([\w:-]+)/,J=/^$|\/(?:java|ecma)script/i,Z=/^\s+/,tt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video";function et(t){var e=tt.split("|"),i=t.createDocumentFragment();if(i.createElement)for(;e.length;)i.createElement(e.pop());return i}!function(){var t=n.createElement("div"),e=n.createDocumentFragment(),i=n.createElement("input");t.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",u.leadingWhitespace=3===t.firstChild.nodeType,u.tbody=!t.getElementsByTagName("tbody").length,u.htmlSerialize=!!t.getElementsByTagName("link").length,u.html5Clone="<:nav></:nav>"!==n.createElement("nav").cloneNode(!0).outerHTML,i.type="checkbox",i.checked=!0,e.appendChild(i),u.appendChecked=i.checked,t.innerHTML="<textarea>x</textarea>",u.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue,e.appendChild(t),(i=n.createElement("input")).setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),t.appendChild(i),u.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,u.noCloneEvent=!!t.addEventListener,t[p.expando]=1,u.attributes=!t.getAttribute(p.expando)}();var it={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:u.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]};function nt(t,e){var i,n,a=0,s=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):void 0;if(!s)for(s=[],i=t.childNodes||t;null!=(n=i[a]);a++)!e||p.nodeName(n,e)?s.push(n):p.merge(s,nt(n,e));return void 0===e||e&&p.nodeName(t,e)?p.merge([t],s):s}function at(t,e){for(var i,n=0;null!=(i=t[n]);n++)p._data(i,"globalEval",!e||p._data(e[n],"globalEval"))}it.optgroup=it.option,it.tbody=it.tfoot=it.colgroup=it.caption=it.thead,it.th=it.td;var st=/<|&#?\w+;/,ot=/<tbody/i;function rt(t){X.test(t.type)&&(t.defaultChecked=t.checked)}function lt(t,e,i,n,a){for(var s,o,r,l,c,d,h,f=t.length,m=et(e),g=[],v=0;f>v;v++)if((o=t[v])||0===o)if("object"===p.type(o))p.merge(g,o.nodeType?[o]:o);else if(st.test(o)){for(l=l||m.appendChild(e.createElement("div")),c=(Q.exec(o)||["",""])[1].toLowerCase(),h=it[c]||it._default,l.innerHTML=h[1]+p.htmlPrefilter(o)+h[2],s=h[0];s--;)l=l.lastChild;if(!u.leadingWhitespace&&Z.test(o)&&g.push(e.createTextNode(Z.exec(o)[0])),!u.tbody)for(s=(o="table"!==c||ot.test(o)?"<table>"!==h[1]||ot.test(o)?0:l:l.firstChild)&&o.childNodes.length;s--;)p.nodeName(d=o.childNodes[s],"tbody")&&!d.childNodes.length&&o.removeChild(d);for(p.merge(g,l.childNodes),l.textContent="";l.firstChild;)l.removeChild(l.firstChild);l=m.lastChild}else g.push(e.createTextNode(o));for(l&&m.removeChild(l),u.appendChecked||p.grep(nt(g,"input"),rt),v=0;o=g[v++];)if(n&&p.inArray(o,n)>-1)a&&a.push(o);else if(r=p.contains(o.ownerDocument,o),l=nt(m.appendChild(o),"script"),r&&at(l),i)for(s=0;o=l[s++];)J.test(o.type||"")&&i.push(o);return l=null,m}!function(){var e,i,a=n.createElement("div");for(e in{submit:!0,change:!0,focusin:!0})i="on"+e,(u[e]=i in t)||(a.setAttribute(i,"t"),u[e]=!1===a.attributes[i].expando);a=null}();var ct=/^(?:input|select|textarea)$/i,dt=/^key/,ut=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,ht=/^(?:focusinfocus|focusoutblur)$/,pt=/^([^.]*)(?:\.(.+)|)/;function ft(){return!0}function mt(){return!1}function gt(){try{return n.activeElement}catch(t){}}function vt(t,e,i,n,a,s){var o,r;if("object"==typeof e){for(r in"string"!=typeof i&&(n=n||i,i=void 0),e)vt(t,r,i,n,e[r],s);return t}if(null==n&&null==a?(a=i,n=i=void 0):null==a&&("string"==typeof i?(a=n,n=void 0):(a=n,n=i,i=void 0)),!1===a)a=mt;else if(!a)return t;return 1===s&&(o=a,a=function(t){return p().off(t),o.apply(this,arguments)},a.guid=o.guid||(o.guid=p.guid++)),t.each((function(){p.event.add(this,e,a,n,i)}))}p.event={global:{},add:function(t,e,i,n,a){var s,o,r,l,c,d,u,h,f,m,g,v=p._data(t);if(v){for(i.handler&&(i=(l=i).handler,a=l.selector),i.guid||(i.guid=p.guid++),(o=v.events)||(o=v.events={}),(d=v.handle)||(d=v.handle=function(t){return void 0===p||t&&p.event.triggered===t.type?void 0:p.event.dispatch.apply(d.elem,arguments)},d.elem=t),r=(e=(e||"").match(M)||[""]).length;r--;)f=g=(s=pt.exec(e[r])||[])[1],m=(s[2]||"").split(".").sort(),f&&(c=p.event.special[f]||{},f=(a?c.delegateType:c.bindType)||f,c=p.event.special[f]||{},u=p.extend({type:f,origType:g,data:n,handler:i,guid:i.guid,selector:a,needsContext:a&&p.expr.match.needsContext.test(a),namespace:m.join(".")},l),(h=o[f])||((h=o[f]=[]).delegateCount=0,c.setup&&!1!==c.setup.call(t,n,m,d)||(t.addEventListener?t.addEventListener(f,d,!1):t.attachEvent&&t.attachEvent("on"+f,d))),c.add&&(c.add.call(t,u),u.handler.guid||(u.handler.guid=i.guid)),a?h.splice(h.delegateCount++,0,u):h.push(u),p.event.global[f]=!0);t=null}},remove:function(t,e,i,n,a){var s,o,r,l,c,d,u,h,f,m,g,v=p.hasData(t)&&p._data(t);if(v&&(d=v.events)){for(c=(e=(e||"").match(M)||[""]).length;c--;)if(f=g=(r=pt.exec(e[c])||[])[1],m=(r[2]||"").split(".").sort(),f){for(u=p.event.special[f]||{},h=d[f=(n?u.delegateType:u.bindType)||f]||[],r=r[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=s=h.length;s--;)o=h[s],!a&&g!==o.origType||i&&i.guid!==o.guid||r&&!r.test(o.namespace)||n&&n!==o.selector&&("**"!==n||!o.selector)||(h.splice(s,1),o.selector&&h.delegateCount--,u.remove&&u.remove.call(t,o));l&&!h.length&&(u.teardown&&!1!==u.teardown.call(t,m,v.handle)||p.removeEvent(t,f,v.handle),delete d[f])}else for(f in d)p.event.remove(t,f+e[c],i,n,!0);p.isEmptyObject(d)&&(delete v.handle,p._removeData(t,"events"))}},trigger:function(e,i,a,s){var o,r,l,c,u,h,f,m=[a||n],g=d.call(e,"type")?e.type:e,v=d.call(e,"namespace")?e.namespace.split("."):[];if(l=h=a=a||n,3!==a.nodeType&&8!==a.nodeType&&!ht.test(g+p.event.triggered)&&(g.indexOf(".")>-1&&(v=g.split("."),g=v.shift(),v.sort()),r=g.indexOf(":")<0&&"on"+g,(e=e[p.expando]?e:new p.Event(g,"object"==typeof e&&e)).isTrigger=s?2:3,e.namespace=v.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=a),i=null==i?[e]:p.makeArray(i,[e]),u=p.event.special[g]||{},s||!u.trigger||!1!==u.trigger.apply(a,i))){if(!s&&!u.noBubble&&!p.isWindow(a)){for(c=u.delegateType||g,ht.test(c+g)||(l=l.parentNode);l;l=l.parentNode)m.push(l),h=l;h===(a.ownerDocument||n)&&m.push(h.defaultView||h.parentWindow||t)}for(f=0;(l=m[f++])&&!e.isPropagationStopped();)e.type=f>1?c:u.bindType||g,(o=(p._data(l,"events")||{})[e.type]&&p._data(l,"handle"))&&o.apply(l,i),(o=r&&l[r])&&o.apply&&R(l)&&(e.result=o.apply(l,i),!1===e.result&&e.preventDefault());if(e.type=g,!s&&!e.isDefaultPrevented()&&(!u._default||!1===u._default.apply(m.pop(),i))&&R(a)&&r&&a[g]&&!p.isWindow(a)){(h=a[r])&&(a[r]=null),p.event.triggered=g;try{a[g]()}catch(t){}p.event.triggered=void 0,h&&(a[r]=h)}return e.result}},dispatch:function(t){t=p.event.fix(t);var e,i,n,s,o,r=[],l=a.call(arguments),c=(p._data(this,"events")||{})[t.type]||[],d=p.event.special[t.type]||{};if(l[0]=t,t.delegateTarget=this,!d.preDispatch||!1!==d.preDispatch.call(this,t)){for(r=p.event.handlers.call(this,t,c),e=0;(s=r[e++])&&!t.isPropagationStopped();)for(t.currentTarget=s.elem,i=0;(o=s.handlers[i++])&&!t.isImmediatePropagationStopped();)t.rnamespace&&!t.rnamespace.test(o.namespace)||(t.handleObj=o,t.data=o.data,void 0!==(n=((p.event.special[o.origType]||{}).handle||o.handler).apply(s.elem,l))&&!1===(t.result=n)&&(t.preventDefault(),t.stopPropagation()));return d.postDispatch&&d.postDispatch.call(this,t),t.result}},handlers:function(t,e){var i,n,a,s,o=[],r=e.delegateCount,l=t.target;if(r&&l.nodeType&&("click"!==t.type||isNaN(t.button)||t.button<1))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==t.type)){for(n=[],i=0;r>i;i++)void 0===n[a=(s=e[i]).selector+" "]&&(n[a]=s.needsContext?p(a,this).index(l)>-1:p.find(a,this,null,[l]).length),n[a]&&n.push(s);n.length&&o.push({elem:l,handlers:n})}return r<e.length&&o.push({elem:this,handlers:e.slice(r)}),o},fix:function(t){if(t[p.expando])return t;var e,i,a,s=t.type,o=t,r=this.fixHooks[s];for(r||(this.fixHooks[s]=r=ut.test(s)?this.mouseHooks:dt.test(s)?this.keyHooks:{}),a=r.props?this.props.concat(r.props):this.props,t=new p.Event(o),e=a.length;e--;)t[i=a[e]]=o[i];return t.target||(t.target=o.srcElement||n),3===t.target.nodeType&&(t.target=t.target.parentNode),t.metaKey=!!t.metaKey,r.filter?r.filter(t,o):t},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var i,a,s,o=e.button,r=e.fromElement;return null==t.pageX&&null!=e.clientX&&(s=(a=t.target.ownerDocument||n).documentElement,i=a.body,t.pageX=e.clientX+(s&&s.scrollLeft||i&&i.scrollLeft||0)-(s&&s.clientLeft||i&&i.clientLeft||0),t.pageY=e.clientY+(s&&s.scrollTop||i&&i.scrollTop||0)-(s&&s.clientTop||i&&i.clientTop||0)),!t.relatedTarget&&r&&(t.relatedTarget=r===t.target?e.toElement:r),t.which||void 0===o||(t.which=1&o?1:2&o?3:4&o?2:0),t}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==gt()&&this.focus)try{return this.focus(),!1}catch(t){}},delegateType:"focusin"},blur:{trigger:function(){return this===gt()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return p.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(t){return p.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,i){var n=p.extend(new p.Event,i,{type:t,isSimulated:!0});p.event.trigger(n,null,e),n.isDefaultPrevented()&&i.preventDefault()}},p.removeEvent=n.removeEventListener?function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)}:function(t,e,i){var n="on"+e;t.detachEvent&&(void 0===t[n]&&(t[n]=null),t.detachEvent(n,i))},p.Event=function(t,e){return this instanceof p.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?ft:mt):this.type=t,e&&p.extend(this,e),this.timeStamp=t&&t.timeStamp||p.now(),void(this[p.expando]=!0)):new p.Event(t,e)},p.Event.prototype={constructor:p.Event,isDefaultPrevented:mt,isPropagationStopped:mt,isImmediatePropagationStopped:mt,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=ft,t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=ft,t&&!this.isSimulated&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=ft,t&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),this.stopPropagation()}},p.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){p.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=t.relatedTarget,a=t.handleObj;return n&&(n===this||p.contains(this,n))||(t.type=a.origType,i=a.handler.apply(this,arguments),t.type=e),i}}})),u.submit||(p.event.special.submit={setup:function(){return!p.nodeName(this,"form")&&void p.event.add(this,"click._submit keypress._submit",(function(t){var e=t.target,i=p.nodeName(e,"input")||p.nodeName(e,"button")?p.prop(e,"form"):void 0;i&&!p._data(i,"submit")&&(p.event.add(i,"submit._submit",(function(t){t._submitBubble=!0})),p._data(i,"submit",!0))}))},postDispatch:function(t){t._submitBubble&&(delete t._submitBubble,this.parentNode&&!t.isTrigger&&p.event.simulate("submit",this.parentNode,t))},teardown:function(){return!p.nodeName(this,"form")&&void p.event.remove(this,"._submit")}}),u.change||(p.event.special.change={setup:function(){return ct.test(this.nodeName)?("checkbox"!==this.type&&"radio"!==this.type||(p.event.add(this,"propertychange._change",(function(t){"checked"===t.originalEvent.propertyName&&(this._justChanged=!0)})),p.event.add(this,"click._change",(function(t){this._justChanged&&!t.isTrigger&&(this._justChanged=!1),p.event.simulate("change",this,t)}))),!1):void p.event.add(this,"beforeactivate._change",(function(t){var e=t.target;ct.test(e.nodeName)&&!p._data(e,"change")&&(p.event.add(e,"change._change",(function(t){!this.parentNode||t.isSimulated||t.isTrigger||p.event.simulate("change",this.parentNode,t)})),p._data(e,"change",!0))}))},handle:function(t){var e=t.target;return this!==e||t.isSimulated||t.isTrigger||"radio"!==e.type&&"checkbox"!==e.type?t.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return p.event.remove(this,"._change"),!ct.test(this.nodeName)}}),u.focusin||p.each({focus:"focusin",blur:"focusout"},(function(t,e){var i=function(t){p.event.simulate(e,t.target,p.event.fix(t))};p.event.special[e]={setup:function(){var n=this.ownerDocument||this,a=p._data(n,e);a||n.addEventListener(t,i,!0),p._data(n,e,(a||0)+1)},teardown:function(){var n=this.ownerDocument||this,a=p._data(n,e)-1;a?p._data(n,e,a):(n.removeEventListener(t,i,!0),p._removeData(n,e))}}})),p.fn.extend({on:function(t,e,i,n){return vt(this,t,e,i,n)},one:function(t,e,i,n){return vt(this,t,e,i,n,1)},off:function(t,e,i){var n,a;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,p(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(a in t)this.off(a,e,t[a]);return this}return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=mt),this.each((function(){p.event.remove(this,t,i,e)}))},trigger:function(t,e){return this.each((function(){p.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var i=this[0];return i?p.event.trigger(t,e,i,!0):void 0}});var bt=/ jQuery\d+="(?:null|\d+)"/g,yt=new RegExp("<(?:"+tt+")[\\s/>]","i"),_t=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,xt=/<script|<style|<link/i,wt=/checked\s*(?:[^=]|=\s*.checked.)/i,Ct=/^true\/(.*)/,kt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,$t=et(n).appendChild(n.createElement("div"));function St(t,e){return p.nodeName(t,"table")&&p.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function Tt(t){return t.type=(null!==p.find.attr(t,"type"))+"/"+t.type,t}function It(t){var e=Ct.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function Dt(t,e){if(1===e.nodeType&&p.hasData(t)){var i,n,a,s=p._data(t),o=p._data(e,s),r=s.events;if(r)for(i in delete o.handle,o.events={},r)for(n=0,a=r[i].length;a>n;n++)p.event.add(e,i,r[i][n]);o.data&&(o.data=p.extend({},o.data))}}function At(t,e){var i,n,a;if(1===e.nodeType){if(i=e.nodeName.toLowerCase(),!u.noCloneEvent&&e[p.expando]){for(n in(a=p._data(e)).events)p.removeEvent(e,n,a.handle);e.removeAttribute(p.expando)}"script"===i&&e.text!==t.text?(Tt(e).text=t.text,It(e)):"object"===i?(e.parentNode&&(e.outerHTML=t.outerHTML),u.html5Clone&&t.innerHTML&&!p.trim(e.innerHTML)&&(e.innerHTML=t.innerHTML)):"input"===i&&X.test(t.type)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===i?e.defaultSelected=e.selected=t.defaultSelected:"input"!==i&&"textarea"!==i||(e.defaultValue=t.defaultValue)}}function Pt(t,e,i,n){e=s.apply([],e);var a,o,r,l,c,d,h=0,f=t.length,m=f-1,g=e[0],v=p.isFunction(g);if(v||f>1&&"string"==typeof g&&!u.checkClone&&wt.test(g))return t.each((function(a){var s=t.eq(a);v&&(e[0]=g.call(this,a,s.html())),Pt(s,e,i,n)}));if(f&&(a=(d=lt(e,t[0].ownerDocument,!1,t,n)).firstChild,1===d.childNodes.length&&(d=a),a||n)){for(r=(l=p.map(nt(d,"script"),Tt)).length;f>h;h++)o=d,h!==m&&(o=p.clone(o,!0,!0),r&&p.merge(l,nt(o,"script"))),i.call(t[h],o,h);if(r)for(c=l[l.length-1].ownerDocument,p.map(l,It),h=0;r>h;h++)o=l[h],J.test(o.type||"")&&!p._data(o,"globalEval")&&p.contains(c,o)&&(o.src?p._evalUrl&&p._evalUrl(o.src):p.globalEval((o.text||o.textContent||o.innerHTML||"").replace(kt,"")));d=a=null}return t}function Ot(t,e,i){for(var n,a=e?p.filter(e,t):t,s=0;null!=(n=a[s]);s++)i||1!==n.nodeType||p.cleanData(nt(n)),n.parentNode&&(i&&p.contains(n.ownerDocument,n)&&at(nt(n,"script")),n.parentNode.removeChild(n));return t}p.extend({htmlPrefilter:function(t){return t.replace(_t,"<$1></$2>")},clone:function(t,e,i){var n,a,s,o,r,l=p.contains(t.ownerDocument,t);if(u.html5Clone||p.isXMLDoc(t)||!yt.test("<"+t.nodeName+">")?s=t.cloneNode(!0):($t.innerHTML=t.outerHTML,$t.removeChild(s=$t.firstChild)),!(u.noCloneEvent&&u.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||p.isXMLDoc(t)))for(n=nt(s),r=nt(t),o=0;null!=(a=r[o]);++o)n[o]&&At(a,n[o]);if(e)if(i)for(r=r||nt(t),n=n||nt(s),o=0;null!=(a=r[o]);o++)Dt(a,n[o]);else Dt(t,s);return(n=nt(s,"script")).length>0&&at(n,!l&&nt(t,"script")),n=r=a=null,s},cleanData:function(t,e){for(var n,a,s,o,r=0,l=p.expando,c=p.cache,d=u.attributes,h=p.event.special;null!=(n=t[r]);r++)if((e||R(n))&&(o=(s=n[l])&&c[s])){if(o.events)for(a in o.events)h[a]?p.event.remove(n,a):p.removeEvent(n,a,o.handle);c[s]&&(delete c[s],d||void 0===n.removeAttribute?n[l]=void 0:n.removeAttribute(l),i.push(s))}}}),p.fn.extend({domManip:Pt,detach:function(t){return Ot(this,t,!0)},remove:function(t){return Ot(this,t)},text:function(t){return K(this,(function(t){return void 0===t?p.text(this):this.empty().append((this[0]&&this[0].ownerDocument||n).createTextNode(t))}),null,t,arguments.length)},append:function(){return Pt(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||St(this,t).appendChild(t)}))},prepend:function(){return Pt(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=St(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return Pt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return Pt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++){for(1===t.nodeType&&p.cleanData(nt(t,!1));t.firstChild;)t.removeChild(t.firstChild);t.options&&p.nodeName(t,"select")&&(t.options.length=0)}return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return p.clone(this,t,e)}))},html:function(t){return K(this,(function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t)return 1===e.nodeType?e.innerHTML.replace(bt,""):void 0;if("string"==typeof t&&!xt.test(t)&&(u.htmlSerialize||!yt.test(t))&&(u.leadingWhitespace||!Z.test(t))&&!it[(Q.exec(t)||["",""])[1].toLowerCase()]){t=p.htmlPrefilter(t);try{for(;n>i;i++)1===(e=this[i]||{}).nodeType&&(p.cleanData(nt(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return Pt(this,arguments,(function(e){var i=this.parentNode;p.inArray(this,t)<0&&(p.cleanData(nt(this)),i&&i.replaceChild(e,this))}),t)}}),p.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){p.fn[t]=function(t){for(var i,n=0,a=[],s=p(t),r=s.length-1;r>=n;n++)i=n===r?this:this.clone(!0),p(s[n])[e](i),o.apply(a,i.get());return this.pushStack(a)}}));var Et,Mt={HTML:"block",BODY:"block"};function Lt(t,e){var i=p(e.createElement(t)).appendTo(e.body),n=p.css(i[0],"display");return i.detach(),n}function jt(t){var e=n,i=Mt[t];return i||("none"!==(i=Lt(t,e))&&i||((e=((Et=(Et||p("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement))[0].contentWindow||Et[0].contentDocument).document).write(),e.close(),i=Lt(t,e),Et.detach()),Mt[t]=i),i}var Rt=/^margin/,Nt=new RegExp("^("+U+")(?!px)[a-z%]+$","i"),Bt=function(t,e,i,n){var a,s,o={};for(s in e)o[s]=t.style[s],t.style[s]=e[s];for(s in a=i.apply(t,n||[]),e)t.style[s]=o[s];return a},Ft=n.documentElement;!function(){var e,i,a,s,o,r,l=n.createElement("div"),c=n.createElement("div");if(c.style){function d(){var d,u,h=n.documentElement;h.appendChild(l),c.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",e=a=r=!1,i=o=!0,t.getComputedStyle&&(u=t.getComputedStyle(c),e="1%"!==(u||{}).top,r="2px"===(u||{}).marginLeft,a="4px"===(u||{width:"4px"}).width,c.style.marginRight="50%",i="4px"===(u||{marginRight:"4px"}).marginRight,(d=c.appendChild(n.createElement("div"))).style.cssText=c.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",d.style.marginRight=d.style.width="0",c.style.width="1px",o=!parseFloat((t.getComputedStyle(d)||{}).marginRight),c.removeChild(d)),c.style.display="none",(s=0===c.getClientRects().length)&&(c.style.display="",c.innerHTML="<table><tr><td></td><td>t</td></tr></table>",c.childNodes[0].style.borderCollapse="separate",(d=c.getElementsByTagName("td"))[0].style.cssText="margin:0;border:0;padding:0;display:none",(s=0===d[0].offsetHeight)&&(d[0].style.display="",d[1].style.display="none",s=0===d[0].offsetHeight)),h.removeChild(l)}c.style.cssText="float:left;opacity:.5",u.opacity="0.5"===c.style.opacity,u.cssFloat=!!c.style.cssFloat,c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",u.clearCloneStyle="content-box"===c.style.backgroundClip,(l=n.createElement("div")).style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",c.innerHTML="",l.appendChild(c),u.boxSizing=""===c.style.boxSizing||""===c.style.MozBoxSizing||""===c.style.WebkitBoxSizing,p.extend(u,{reliableHiddenOffsets:function(){return null==e&&d(),s},boxSizingReliable:function(){return null==e&&d(),a},pixelMarginRight:function(){return null==e&&d(),i},pixelPosition:function(){return null==e&&d(),e},reliableMarginRight:function(){return null==e&&d(),o},reliableMarginLeft:function(){return null==e&&d(),r}})}}();var Ht,zt,Wt=/^(top|right|bottom|left)$/;function Ut(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}t.getComputedStyle?(Ht=function(e){var i=e.ownerDocument.defaultView;return i&&i.opener||(i=t),i.getComputedStyle(e)},zt=function(t,e,i){var n,a,s,o,r=t.style;return""!==(o=(i=i||Ht(t))?i.getPropertyValue(e)||i[e]:void 0)&&void 0!==o||p.contains(t.ownerDocument,t)||(o=p.style(t,e)),i&&!u.pixelMarginRight()&&Nt.test(o)&&Rt.test(e)&&(n=r.width,a=r.minWidth,s=r.maxWidth,r.minWidth=r.maxWidth=r.width=o,o=i.width,r.width=n,r.minWidth=a,r.maxWidth=s),void 0===o?o:o+""}):Ft.currentStyle&&(Ht=function(t){return t.currentStyle},zt=function(t,e,i){var n,a,s,o,r=t.style;return null==(o=(i=i||Ht(t))?i[e]:void 0)&&r&&r[e]&&(o=r[e]),Nt.test(o)&&!Wt.test(e)&&(n=r.left,(s=(a=t.runtimeStyle)&&a.left)&&(a.left=t.currentStyle.left),r.left="fontSize"===e?"1em":o,o=r.pixelLeft+"px",r.left=n,s&&(a.left=s)),void 0===o?o:o+""||"auto"});var qt=/alpha\([^)]*\)/i,Yt=/opacity\s*=\s*([^)]*)/i,Vt=/^(none|table(?!-c[ea]).+)/,Gt=new RegExp("^("+U+")(.*)$","i"),Kt={position:"absolute",visibility:"hidden",display:"block"},Xt={letterSpacing:"0",fontWeight:"400"},Qt=["Webkit","O","Moz","ms"],Jt=n.createElement("div").style;function Zt(t){if(t in Jt)return t;for(var e=t.charAt(0).toUpperCase()+t.slice(1),i=Qt.length;i--;)if((t=Qt[i]+e)in Jt)return t}function te(t,e){for(var i,n,a,s=[],o=0,r=t.length;r>o;o++)(n=t[o]).style&&(s[o]=p._data(n,"olddisplay"),i=n.style.display,e?(s[o]||"none"!==i||(n.style.display=""),""===n.style.display&&V(n)&&(s[o]=p._data(n,"olddisplay",jt(n.nodeName)))):(a=V(n),(i&&"none"!==i||!a)&&p._data(n,"olddisplay",a?i:p.css(n,"display"))));for(o=0;r>o;o++)(n=t[o]).style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?s[o]||"":"none"));return t}function ee(t,e,i){var n=Gt.exec(e);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):e}function ie(t,e,i,n,a){for(var s=i===(n?"border":"content")?4:"width"===e?1:0,o=0;4>s;s+=2)"margin"===i&&(o+=p.css(t,i+Y[s],!0,a)),n?("content"===i&&(o-=p.css(t,"padding"+Y[s],!0,a)),"margin"!==i&&(o-=p.css(t,"border"+Y[s]+"Width",!0,a))):(o+=p.css(t,"padding"+Y[s],!0,a),"padding"!==i&&(o+=p.css(t,"border"+Y[s]+"Width",!0,a)));return o}function ne(t,e,i){var n=!0,a="width"===e?t.offsetWidth:t.offsetHeight,s=Ht(t),o=u.boxSizing&&"border-box"===p.css(t,"boxSizing",!1,s);if(0>=a||null==a){if((0>(a=zt(t,e,s))||null==a)&&(a=t.style[e]),Nt.test(a))return a;n=o&&(u.boxSizingReliable()||a===t.style[e]),a=parseFloat(a)||0}return a+ie(t,e,i||(o?"border":"content"),n,s)+"px"}function ae(t,e,i,n,a){return new ae.prototype.init(t,e,i,n,a)}p.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=zt(t,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:u.cssFloat?"cssFloat":"styleFloat"},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var a,s,o,r=p.camelCase(e),l=t.style;if(e=p.cssProps[r]||(p.cssProps[r]=Zt(r)||r),o=p.cssHooks[e]||p.cssHooks[r],void 0===i)return o&&"get"in o&&void 0!==(a=o.get(t,!1,n))?a:l[e];if("string"===(s=typeof i)&&(a=q.exec(i))&&a[1]&&(i=G(t,e,a),s="number"),null!=i&&i==i&&("number"===s&&(i+=a&&a[3]||(p.cssNumber[r]?"":"px")),u.clearCloneStyle||""!==i||0!==e.indexOf("background")||(l[e]="inherit"),!o||!("set"in o)||void 0!==(i=o.set(t,i,n))))try{l[e]=i}catch(t){}}},css:function(t,e,i,n){var a,s,o,r=p.camelCase(e);return e=p.cssProps[r]||(p.cssProps[r]=Zt(r)||r),(o=p.cssHooks[e]||p.cssHooks[r])&&"get"in o&&(s=o.get(t,!0,i)),void 0===s&&(s=zt(t,e,n)),"normal"===s&&e in Xt&&(s=Xt[e]),""===i||i?(a=parseFloat(s),!0===i||isFinite(a)?a||0:s):s}}),p.each(["height","width"],(function(t,e){p.cssHooks[e]={get:function(t,i,n){return i?Vt.test(p.css(t,"display"))&&0===t.offsetWidth?Bt(t,Kt,(function(){return ne(t,e,n)})):ne(t,e,n):void 0},set:function(t,i,n){var a=n&&Ht(t);return ee(0,i,n?ie(t,e,n,u.boxSizing&&"border-box"===p.css(t,"boxSizing",!1,a),a):0)}}})),u.opacity||(p.cssHooks.opacity={get:function(t,e){return Yt.test((e&&t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":e?"1":""},set:function(t,e){var i=t.style,n=t.currentStyle,a=p.isNumeric(e)?"alpha(opacity="+100*e+")":"",s=n&&n.filter||i.filter||"";i.zoom=1,(e>=1||""===e)&&""===p.trim(s.replace(qt,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===e||n&&!n.filter)||(i.filter=qt.test(s)?s.replace(qt,a):s+" "+a)}}),p.cssHooks.marginRight=Ut(u.reliableMarginRight,(function(t,e){return e?Bt(t,{display:"inline-block"},zt,[t,"marginRight"]):void 0})),p.cssHooks.marginLeft=Ut(u.reliableMarginLeft,(function(t,e){return e?(parseFloat(zt(t,"marginLeft"))||(p.contains(t.ownerDocument,t)?t.getBoundingClientRect().left-Bt(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})):0))+"px":void 0})),p.each({margin:"",padding:"",border:"Width"},(function(t,e){p.cssHooks[t+e]={expand:function(i){for(var n=0,a={},s="string"==typeof i?i.split(" "):[i];4>n;n++)a[t+Y[n]+e]=s[n]||s[n-2]||s[0];return a}},Rt.test(t)||(p.cssHooks[t+e].set=ee)})),p.fn.extend({css:function(t,e){return K(this,(function(t,e,i){var n,a,s={},o=0;if(p.isArray(e)){for(n=Ht(t),a=e.length;a>o;o++)s[e[o]]=p.css(t,e[o],!1,n);return s}return void 0!==i?p.style(t,e,i):p.css(t,e)}),t,e,arguments.length>1)},show:function(){return te(this,!0)},hide:function(){return te(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){V(this)?p(this).show():p(this).hide()}))}}),p.Tween=ae,ae.prototype={constructor:ae,init:function(t,e,i,n,a,s){this.elem=t,this.prop=i,this.easing=a||p.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=s||(p.cssNumber[i]?"":"px")},cur:function(){var t=ae.propHooks[this.prop];return t&&t.get?t.get(this):ae.propHooks._default.get(this)},run:function(t){var e,i=ae.propHooks[this.prop];return this.options.duration?this.pos=e=p.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):ae.propHooks._default.set(this),this}},ae.prototype.init.prototype=ae.prototype,ae.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=p.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){p.fx.step[t.prop]?p.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[p.cssProps[t.prop]]&&!p.cssHooks[t.prop]?t.elem[t.prop]=t.now:p.style(t.elem,t.prop,t.now+t.unit)}}},ae.propHooks.scrollTop=ae.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},p.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},p.fx=ae.prototype.init,p.fx.step={};var se,oe,re=/^(?:toggle|show|hide)$/,le=/queueHooks$/;function ce(){return t.setTimeout((function(){se=void 0})),se=p.now()}function de(t,e){var i,n={height:t},a=0;for(e=e?1:0;4>a;a+=2-e)n["margin"+(i=Y[a])]=n["padding"+i]=t;return e&&(n.opacity=n.width=t),n}function ue(t,e,i){for(var n,a=(he.tweeners[e]||[]).concat(he.tweeners["*"]),s=0,o=a.length;o>s;s++)if(n=a[s].call(i,e,t))return n}function he(t,e,i){var n,a,s=0,o=he.prefilters.length,r=p.Deferred().always((function(){delete l.elem})),l=function(){if(a)return!1;for(var e=se||ce(),i=Math.max(0,c.startTime+c.duration-e),n=1-(i/c.duration||0),s=0,o=c.tweens.length;o>s;s++)c.tweens[s].run(n);return r.notifyWith(t,[c,n,i]),1>n&&o?i:(r.resolveWith(t,[c]),!1)},c=r.promise({elem:t,props:p.extend({},e),opts:p.extend(!0,{specialEasing:{},easing:p.easing._default},i),originalProperties:e,originalOptions:i,startTime:se||ce(),duration:i.duration,tweens:[],createTween:function(e,i){var n=p.Tween(t,c.opts,e,i,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(n),n},stop:function(e){var i=0,n=e?c.tweens.length:0;if(a)return this;for(a=!0;n>i;i++)c.tweens[i].run(1);return e?(r.notifyWith(t,[c,1,0]),r.resolveWith(t,[c,e])):r.rejectWith(t,[c,e]),this}}),d=c.props;for(function(t,e){var i,n,a,s,o;for(i in t)if(a=e[n=p.camelCase(i)],s=t[i],p.isArray(s)&&(a=s[1],s=t[i]=s[0]),i!==n&&(t[n]=s,delete t[i]),(o=p.cssHooks[n])&&"expand"in o)for(i in s=o.expand(s),delete t[n],s)i in t||(t[i]=s[i],e[i]=a);else e[n]=a}(d,c.opts.specialEasing);o>s;s++)if(n=he.prefilters[s].call(c,t,d,c.opts))return p.isFunction(n.stop)&&(p._queueHooks(c.elem,c.opts.queue).stop=p.proxy(n.stop,n)),n;return p.map(d,ue,c),p.isFunction(c.opts.start)&&c.opts.start.call(t,c),p.fx.timer(p.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}p.Animation=p.extend(he,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return G(i.elem,t,q.exec(e),i),i}]},tweener:function(t,e){p.isFunction(t)?(e=t,t=["*"]):t=t.match(M);for(var i,n=0,a=t.length;a>n;n++)i=t[n],he.tweeners[i]=he.tweeners[i]||[],he.tweeners[i].unshift(e)},prefilters:[function(t,e,i){var n,a,s,o,r,l,c,d=this,h={},f=t.style,m=t.nodeType&&V(t),g=p._data(t,"fxshow");for(n in i.queue||(null==(r=p._queueHooks(t,"fx")).unqueued&&(r.unqueued=0,l=r.empty.fire,r.empty.fire=function(){r.unqueued||l()}),r.unqueued++,d.always((function(){d.always((function(){r.unqueued--,p.queue(t,"fx").length||r.empty.fire()}))}))),1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[f.overflow,f.overflowX,f.overflowY],"inline"===("none"===(c=p.css(t,"display"))?p._data(t,"olddisplay")||jt(t.nodeName):c)&&"none"===p.css(t,"float")&&(u.inlineBlockNeedsLayout&&"inline"!==jt(t.nodeName)?f.zoom=1:f.display="inline-block")),i.overflow&&(f.overflow="hidden",u.shrinkWrapBlocks()||d.always((function(){f.overflow=i.overflow[0],f.overflowX=i.overflow[1],f.overflowY=i.overflow[2]}))),e)if(a=e[n],re.exec(a)){if(delete e[n],s=s||"toggle"===a,a===(m?"hide":"show")){if("show"!==a||!g||void 0===g[n])continue;m=!0}h[n]=g&&g[n]||p.style(t,n)}else c=void 0;if(p.isEmptyObject(h))"inline"===("none"===c?jt(t.nodeName):c)&&(f.display=c);else for(n in g?"hidden"in g&&(m=g.hidden):g=p._data(t,"fxshow",{}),s&&(g.hidden=!m),m?p(t).show():d.done((function(){p(t).hide()})),d.done((function(){var e;for(e in p._removeData(t,"fxshow"),h)p.style(t,e,h[e])})),h)o=ue(m?g[n]:0,n,d),n in g||(g[n]=o.start,m&&(o.end=o.start,o.start="width"===n||"height"===n?1:0))}],prefilter:function(t,e){e?he.prefilters.unshift(t):he.prefilters.push(t)}}),p.speed=function(t,e,i){var n=t&&"object"==typeof t?p.extend({},t):{complete:i||!i&&e||p.isFunction(t)&&t,duration:t,easing:i&&e||e&&!p.isFunction(e)&&e};return n.duration=p.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in p.fx.speeds?p.fx.speeds[n.duration]:p.fx.speeds._default,null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){p.isFunction(n.old)&&n.old.call(this),n.queue&&p.dequeue(this,n.queue)},n},p.fn.extend({fadeTo:function(t,e,i,n){return this.filter(V).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var a=p.isEmptyObject(t),s=p.speed(e,i,n),o=function(){var e=he(this,p.extend({},t),s);(a||p._data(this,"finish"))&&e.stop(!0)};return o.finish=o,a||!1===s.queue?this.each(o):this.queue(s.queue,o)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each((function(){var e=!0,a=null!=t&&t+"queueHooks",s=p.timers,o=p._data(this);if(a)o[a]&&o[a].stop&&n(o[a]);else for(a in o)o[a]&&o[a].stop&&le.test(a)&&n(o[a]);for(a=s.length;a--;)s[a].elem!==this||null!=t&&s[a].queue!==t||(s[a].anim.stop(i),e=!1,s.splice(a,1));!e&&i||p.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,i=p._data(this),n=i[t+"queue"],a=i[t+"queueHooks"],s=p.timers,o=n?n.length:0;for(i.finish=!0,p.queue(this,t,[]),a&&a.stop&&a.stop.call(this,!0),e=s.length;e--;)s[e].elem===this&&s[e].queue===t&&(s[e].anim.stop(!0),s.splice(e,1));for(e=0;o>e;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish}))}}),p.each(["toggle","show","hide"],(function(t,e){var i=p.fn[e];p.fn[e]=function(t,n,a){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(de(e,!0),t,n,a)}})),p.each({slideDown:de("show"),slideUp:de("hide"),slideToggle:de("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){p.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}})),p.timers=[],p.fx.tick=function(){var t,e=p.timers,i=0;for(se=p.now();i<e.length;i++)(t=e[i])()||e[i]!==t||e.splice(i--,1);e.length||p.fx.stop(),se=void 0},p.fx.timer=function(t){p.timers.push(t),t()?p.fx.start():p.timers.pop()},p.fx.interval=13,p.fx.start=function(){oe||(oe=t.setInterval(p.fx.tick,p.fx.interval))},p.fx.stop=function(){t.clearInterval(oe),oe=null},p.fx.speeds={slow:600,fast:200,_default:400},p.fn.delay=function(e,i){return e=p.fx&&p.fx.speeds[e]||e,i=i||"fx",this.queue(i,(function(i,n){var a=t.setTimeout(i,e);n.stop=function(){t.clearTimeout(a)}}))},function(){var t,e=n.createElement("input"),i=n.createElement("div"),a=n.createElement("select"),s=a.appendChild(n.createElement("option"));(i=n.createElement("div")).setAttribute("className","t"),i.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",t=i.getElementsByTagName("a")[0],e.setAttribute("type","checkbox"),i.appendChild(e),(t=i.getElementsByTagName("a")[0]).style.cssText="top:1px",u.getSetAttribute="t"!==i.className,u.style=/top/.test(t.getAttribute("style")),u.hrefNormalized="/a"===t.getAttribute("href"),u.checkOn=!!e.value,u.optSelected=s.selected,u.enctype=!!n.createElement("form").enctype,a.disabled=!0,u.optDisabled=!s.disabled,(e=n.createElement("input")).setAttribute("value",""),u.input=""===e.getAttribute("value"),e.value="t",e.setAttribute("type","radio"),u.radioValue="t"===e.value}();var pe=/\r/g,fe=/[\x20\t\r\n\f]+/g;p.fn.extend({val:function(t){var e,i,n,a=this[0];return arguments.length?(n=p.isFunction(t),this.each((function(i){var a;1===this.nodeType&&(null==(a=n?t.call(this,i,p(this).val()):t)?a="":"number"==typeof a?a+="":p.isArray(a)&&(a=p.map(a,(function(t){return null==t?"":t+""}))),(e=p.valHooks[this.type]||p.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,a,"value")||(this.value=a))}))):a?(e=p.valHooks[a.type]||p.valHooks[a.nodeName.toLowerCase()])&&"get"in e&&void 0!==(i=e.get(a,"value"))?i:"string"==typeof(i=a.value)?i.replace(pe,""):null==i?"":i:void 0}}),p.extend({valHooks:{option:{get:function(t){var e=p.find.attr(t,"value");return null!=e?e:p.trim(p.text(t)).replace(fe," ")}},select:{get:function(t){for(var e,i,n=t.options,a=t.selectedIndex,s="select-one"===t.type||0>a,o=s?null:[],r=s?a+1:n.length,l=0>a?r:s?a:0;r>l;l++)if(((i=n[l]).selected||l===a)&&(u.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!p.nodeName(i.parentNode,"optgroup"))){if(e=p(i).val(),s)return e;o.push(e)}return o},set:function(t,e){for(var i,n,a=t.options,s=p.makeArray(e),o=a.length;o--;)if(n=a[o],p.inArray(p.valHooks.option.get(n),s)>-1)try{n.selected=i=!0}catch(t){n.scrollHeight}else n.selected=!1;return i||(t.selectedIndex=-1),a}}}}),p.each(["radio","checkbox"],(function(){p.valHooks[this]={set:function(t,e){return p.isArray(e)?t.checked=p.inArray(p(t).val(),e)>-1:void 0}},u.checkOn||(p.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}));var me,ge,ve=p.expr.attrHandle,be=/^(?:checked|selected)$/i,ye=u.getSetAttribute,_e=u.input;p.fn.extend({attr:function(t,e){return K(this,p.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){p.removeAttr(this,t)}))}}),p.extend({attr:function(t,e,i){var n,a,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return void 0===t.getAttribute?p.prop(t,e,i):(1===s&&p.isXMLDoc(t)||(e=e.toLowerCase(),a=p.attrHooks[e]||(p.expr.match.bool.test(e)?ge:me)),void 0!==i?null===i?void p.removeAttr(t,e):a&&"set"in a&&void 0!==(n=a.set(t,i,e))?n:(t.setAttribute(e,i+""),i):a&&"get"in a&&null!==(n=a.get(t,e))?n:null==(n=p.find.attr(t,e))?void 0:n)},attrHooks:{type:{set:function(t,e){if(!u.radioValue&&"radio"===e&&p.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr:function(t,e){var i,n,a=0,s=e&&e.match(M);if(s&&1===t.nodeType)for(;i=s[a++];)n=p.propFix[i]||i,p.expr.match.bool.test(i)?_e&&ye||!be.test(i)?t[n]=!1:t[p.camelCase("default-"+i)]=t[n]=!1:p.attr(t,i,""),t.removeAttribute(ye?i:n)}}),ge={set:function(t,e,i){return!1===e?p.removeAttr(t,i):_e&&ye||!be.test(i)?t.setAttribute(!ye&&p.propFix[i]||i,i):t[p.camelCase("default-"+i)]=t[i]=!0,i}},p.each(p.expr.match.bool.source.match(/\w+/g),(function(t,e){var i=ve[e]||p.find.attr;_e&&ye||!be.test(e)?ve[e]=function(t,e,n){var a,s;return n||(s=ve[e],ve[e]=a,a=null!=i(t,e,n)?e.toLowerCase():null,ve[e]=s),a}:ve[e]=function(t,e,i){return i?void 0:t[p.camelCase("default-"+e)]?e.toLowerCase():null}})),_e&&ye||(p.attrHooks.value={set:function(t,e,i){return p.nodeName(t,"input")?void(t.defaultValue=e):me&&me.set(t,e,i)}}),ye||(me={set:function(t,e,i){var n=t.getAttributeNode(i);return n||t.setAttributeNode(n=t.ownerDocument.createAttribute(i)),n.value=e+="","value"===i||e===t.getAttribute(i)?e:void 0}},ve.id=ve.name=ve.coords=function(t,e,i){var n;return i?void 0:(n=t.getAttributeNode(e))&&""!==n.value?n.value:null},p.valHooks.button={get:function(t,e){var i=t.getAttributeNode(e);return i&&i.specified?i.value:void 0},set:me.set},p.attrHooks.contenteditable={set:function(t,e,i){me.set(t,""!==e&&e,i)}},p.each(["width","height"],(function(t,e){p.attrHooks[e]={set:function(t,i){return""===i?(t.setAttribute(e,"auto"),i):void 0}}}))),u.style||(p.attrHooks.style={get:function(t){return t.style.cssText||void 0},set:function(t,e){return t.style.cssText=e+""}});var xe=/^(?:input|select|textarea|button|object)$/i,we=/^(?:a|area)$/i;p.fn.extend({prop:function(t,e){return K(this,p.prop,t,e,arguments.length>1)},removeProp:function(t){return t=p.propFix[t]||t,this.each((function(){try{this[t]=void 0,delete this[t]}catch(t){}}))}}),p.extend({prop:function(t,e,i){var n,a,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return 1===s&&p.isXMLDoc(t)||(e=p.propFix[e]||e,a=p.propHooks[e]),void 0!==i?a&&"set"in a&&void 0!==(n=a.set(t,i,e))?n:t[e]=i:a&&"get"in a&&null!==(n=a.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=p.find.attr(t,"tabindex");return e?parseInt(e,10):xe.test(t.nodeName)||we.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),u.hrefNormalized||p.each(["href","src"],(function(t,e){p.propHooks[e]={get:function(t){return t.getAttribute(e,4)}}})),u.optSelected||(p.propHooks.selected={get:function(t){var e=t.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),p.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){p.propFix[this.toLowerCase()]=this})),u.enctype||(p.propFix.enctype="encoding");var Ce=/[\t\r\n\f]/g;function ke(t){return p.attr(t,"class")||""}p.fn.extend({addClass:function(t){var e,i,n,a,s,o,r,l=0;if(p.isFunction(t))return this.each((function(e){p(this).addClass(t.call(this,e,ke(this)))}));if("string"==typeof t&&t)for(e=t.match(M)||[];i=this[l++];)if(a=ke(i),n=1===i.nodeType&&(" "+a+" ").replace(Ce," ")){for(o=0;s=e[o++];)n.indexOf(" "+s+" ")<0&&(n+=s+" ");a!==(r=p.trim(n))&&p.attr(i,"class",r)}return this},removeClass:function(t){var e,i,n,a,s,o,r,l=0;if(p.isFunction(t))return this.each((function(e){p(this).removeClass(t.call(this,e,ke(this)))}));if(!arguments.length)return this.attr("class","");if("string"==typeof t&&t)for(e=t.match(M)||[];i=this[l++];)if(a=ke(i),n=1===i.nodeType&&(" "+a+" ").replace(Ce," ")){for(o=0;s=e[o++];)for(;n.indexOf(" "+s+" ")>-1;)n=n.replace(" "+s+" "," ");a!==(r=p.trim(n))&&p.attr(i,"class",r)}return this},toggleClass:function(t,e){var i=typeof t;return"boolean"==typeof e&&"string"===i?e?this.addClass(t):this.removeClass(t):p.isFunction(t)?this.each((function(i){p(this).toggleClass(t.call(this,i,ke(this),e),e)})):this.each((function(){var e,n,a,s;if("string"===i)for(n=0,a=p(this),s=t.match(M)||[];e=s[n++];)a.hasClass(e)?a.removeClass(e):a.addClass(e);else void 0!==t&&"boolean"!==i||((e=ke(this))&&p._data(this,"__className__",e),p.attr(this,"class",e||!1===t?"":p._data(this,"__className__")||""))}))},hasClass:function(t){var e,i,n=0;for(e=" "+t+" ";i=this[n++];)if(1===i.nodeType&&(" "+ke(i)+" ").replace(Ce," ").indexOf(e)>-1)return!0;return!1}}),p.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),(function(t,e){p.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}})),p.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}});var $e=t.location,Se=p.now(),Te=/\?/,Ie=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;p.parseJSON=function(e){if(t.JSON&&t.JSON.parse)return t.JSON.parse(e+"");var i,n=null,a=p.trim(e+"");return a&&!p.trim(a.replace(Ie,(function(t,e,a,s){return i&&e&&(n=0),0===n?t:(i=a||e,n+=!s-!a,"")})))?Function("return "+a)():p.error("Invalid JSON: "+e)},p.parseXML=function(e){var i;if(!e||"string"!=typeof e)return null;try{t.DOMParser?i=(new t.DOMParser).parseFromString(e,"text/xml"):((i=new t.ActiveXObject("Microsoft.XMLDOM")).async="false",i.loadXML(e))}catch(t){i=void 0}return i&&i.documentElement&&!i.getElementsByTagName("parsererror").length||p.error("Invalid XML: "+e),i};var De=/#.*$/,Ae=/([?&])_=[^&]*/,Pe=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Oe=/^(?:GET|HEAD)$/,Ee=/^\/\//,Me=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Le={},je={},Re="*/".concat("*"),Ne=$e.href,Be=Me.exec(Ne.toLowerCase())||[];function Fe(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,a=0,s=e.toLowerCase().match(M)||[];if(p.isFunction(i))for(;n=s[a++];)"+"===n.charAt(0)?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function He(t,e,i,n){var a={},s=t===je;function o(r){var l;return a[r]=!0,p.each(t[r]||[],(function(t,r){var c=r(e,i,n);return"string"!=typeof c||s||a[c]?s?!(l=c):void 0:(e.dataTypes.unshift(c),o(c),!1)})),l}return o(e.dataTypes[0])||!a["*"]&&o("*")}function ze(t,e){var i,n,a=p.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((a[n]?t:i||(i={}))[n]=e[n]);return i&&p.extend(!0,t,i),t}function We(t){return t.style&&t.style.display||p.css(t,"display")}p.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ne,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Be[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Re,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":p.parseJSON,"text xml":p.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?ze(ze(t,p.ajaxSettings),e):ze(p.ajaxSettings,t)},ajaxPrefilter:Fe(Le),ajaxTransport:Fe(je),ajax:function(e,i){"object"==typeof e&&(i=e,e=void 0),i=i||{};var n,a,s,o,r,l,c,d,u=p.ajaxSetup({},i),h=u.context||u,f=u.context&&(h.nodeType||h.jquery)?p(h):p.event,m=p.Deferred(),g=p.Callbacks("once memory"),v=u.statusCode||{},b={},y={},_=0,x="canceled",w={readyState:0,getResponseHeader:function(t){var e;if(2===_){if(!d)for(d={};e=Pe.exec(o);)d[e[1].toLowerCase()]=e[2];e=d[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===_?o:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return _||(t=y[i]=y[i]||t,b[t]=e),this},overrideMimeType:function(t){return _||(u.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>_)for(e in t)v[e]=[v[e],t[e]];else w.always(t[w.status]);return this},abort:function(t){var e=t||x;return c&&c.abort(e),C(0,e),this}};if(m.promise(w).complete=g.add,w.success=w.done,w.error=w.fail,u.url=((e||u.url||Ne)+"").replace(De,"").replace(Ee,Be[1]+"//"),u.type=i.method||i.type||u.method||u.type,u.dataTypes=p.trim(u.dataType||"*").toLowerCase().match(M)||[""],null==u.crossDomain&&(n=Me.exec(u.url.toLowerCase()),u.crossDomain=!(!n||n[1]===Be[1]&&n[2]===Be[2]&&(n[3]||("http:"===n[1]?"80":"443"))===(Be[3]||("http:"===Be[1]?"80":"443")))),u.data&&u.processData&&"string"!=typeof u.data&&(u.data=p.param(u.data,u.traditional)),He(Le,u,i,w),2===_)return w;for(a in(l=p.event&&u.global)&&0==p.active++&&p.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!Oe.test(u.type),s=u.url,u.hasContent||(u.data&&(s=u.url+=(Te.test(s)?"&":"?")+u.data,delete u.data),!1===u.cache&&(u.url=Ae.test(s)?s.replace(Ae,"$1_="+Se++):s+(Te.test(s)?"&":"?")+"_="+Se++)),u.ifModified&&(p.lastModified[s]&&w.setRequestHeader("If-Modified-Since",p.lastModified[s]),p.etag[s]&&w.setRequestHeader("If-None-Match",p.etag[s])),(u.data&&u.hasContent&&!1!==u.contentType||i.contentType)&&w.setRequestHeader("Content-Type",u.contentType),w.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+Re+"; q=0.01":""):u.accepts["*"]),u.headers)w.setRequestHeader(a,u.headers[a]);if(u.beforeSend&&(!1===u.beforeSend.call(h,w,u)||2===_))return w.abort();for(a in x="abort",{success:1,error:1,complete:1})w[a](u[a]);if(c=He(je,u,i,w)){if(w.readyState=1,l&&f.trigger("ajaxSend",[w,u]),2===_)return w;u.async&&u.timeout>0&&(r=t.setTimeout((function(){w.abort("timeout")}),u.timeout));try{_=1,c.send(b,C)}catch(t){if(!(2>_))throw t;C(-1,t)}}else C(-1,"No Transport");function C(e,i,n,a){var d,b,y,x,C,k=i;2!==_&&(_=2,r&&t.clearTimeout(r),c=void 0,o=a||"",w.readyState=e>0?4:0,d=e>=200&&300>e||304===e,n&&(x=function(t,e,i){for(var n,a,s,o,r=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===a&&(a=t.mimeType||e.getResponseHeader("Content-Type"));if(a)for(o in r)if(r[o]&&r[o].test(a)){l.unshift(o);break}if(l[0]in i)s=l[0];else{for(o in i){if(!l[0]||t.converters[o+" "+l[0]]){s=o;break}n||(n=o)}s=s||n}return s?(s!==l[0]&&l.unshift(s),i[s]):void 0}(u,w,n)),x=function(t,e,i,n){var a,s,o,r,l,c={},d=t.dataTypes.slice();if(d[1])for(o in t.converters)c[o.toLowerCase()]=t.converters[o];for(s=d.shift();s;)if(t.responseFields[s]&&(i[t.responseFields[s]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=s,s=d.shift())if("*"===s)s=l;else if("*"!==l&&l!==s){if(!(o=c[l+" "+s]||c["* "+s]))for(a in c)if((r=a.split(" "))[1]===s&&(o=c[l+" "+r[0]]||c["* "+r[0]])){!0===o?o=c[a]:!0!==c[a]&&(s=r[0],d.unshift(r[1]));break}if(!0!==o)if(o&&t.throws)e=o(e);else try{e=o(e)}catch(t){return{state:"parsererror",error:o?t:"No conversion from "+l+" to "+s}}}return{state:"success",data:e}}(u,x,w,d),d?(u.ifModified&&((C=w.getResponseHeader("Last-Modified"))&&(p.lastModified[s]=C),(C=w.getResponseHeader("etag"))&&(p.etag[s]=C)),204===e||"HEAD"===u.type?k="nocontent":304===e?k="notmodified":(k=x.state,b=x.data,d=!(y=x.error))):(y=k,!e&&k||(k="error",0>e&&(e=0))),w.status=e,w.statusText=(i||k)+"",d?m.resolveWith(h,[b,k,w]):m.rejectWith(h,[w,k,y]),w.statusCode(v),v=void 0,l&&f.trigger(d?"ajaxSuccess":"ajaxError",[w,u,d?b:y]),g.fireWith(h,[w,k]),l&&(f.trigger("ajaxComplete",[w,u]),--p.active||p.event.trigger("ajaxStop")))}return w},getJSON:function(t,e,i){return p.get(t,e,i,"json")},getScript:function(t,e){return p.get(t,void 0,e,"script")}}),p.each(["get","post"],(function(t,e){p[e]=function(t,i,n,a){return p.isFunction(i)&&(a=a||n,n=i,i=void 0),p.ajax(p.extend({url:t,type:e,dataType:a,data:i,success:n},p.isPlainObject(t)&&t))}})),p._evalUrl=function(t){return p.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},p.fn.extend({wrapAll:function(t){if(p.isFunction(t))return this.each((function(e){p(this).wrapAll(t.call(this,e))}));if(this[0]){var e=p(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstChild&&1===t.firstChild.nodeType;)t=t.firstChild;return t})).append(this)}return this},wrapInner:function(t){return p.isFunction(t)?this.each((function(e){p(this).wrapInner(t.call(this,e))})):this.each((function(){var e=p(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)}))},wrap:function(t){var e=p.isFunction(t);return this.each((function(i){p(this).wrapAll(e?t.call(this,i):t)}))},unwrap:function(){return this.parent().each((function(){p.nodeName(this,"body")||p(this).replaceWith(this.childNodes)})).end()}}),p.expr.filters.hidden=function(t){return u.reliableHiddenOffsets()?t.offsetWidth<=0&&t.offsetHeight<=0&&!t.getClientRects().length:function(t){if(!p.contains(t.ownerDocument||n,t))return!0;for(;t&&1===t.nodeType;){if("none"===We(t)||"hidden"===t.type)return!0;t=t.parentNode}return!1}(t)},p.expr.filters.visible=function(t){return!p.expr.filters.hidden(t)};var Ue=/%20/g,qe=/\[\]$/,Ye=/\r?\n/g,Ve=/^(?:submit|button|image|reset|file)$/i,Ge=/^(?:input|select|textarea|keygen)/i;function Ke(t,e,i,n){var a;if(p.isArray(e))p.each(e,(function(e,a){i||qe.test(t)?n(t,a):Ke(t+"["+("object"==typeof a&&null!=a?e:"")+"]",a,i,n)}));else if(i||"object"!==p.type(e))n(t,e);else for(a in e)Ke(t+"["+a+"]",e[a],i,n)}p.param=function(t,e){var i,n=[],a=function(t,e){e=p.isFunction(e)?e():null==e?"":e,n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=p.ajaxSettings&&p.ajaxSettings.traditional),p.isArray(t)||t.jquery&&!p.isPlainObject(t))p.each(t,(function(){a(this.name,this.value)}));else for(i in t)Ke(i,t[i],e,a);return n.join("&").replace(Ue,"+")},p.fn.extend({serialize:function(){return p.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=p.prop(this,"elements");return t?p.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!p(this).is(":disabled")&&Ge.test(this.nodeName)&&!Ve.test(t)&&(this.checked||!X.test(t))})).map((function(t,e){var i=p(this).val();return null==i?null:p.isArray(i)?p.map(i,(function(t){return{name:e.name,value:t.replace(Ye,"\r\n")}})):{name:e.name,value:i.replace(Ye,"\r\n")}})).get()}}),p.ajaxSettings.xhr=void 0!==t.ActiveXObject?function(){return this.isLocal?ti():n.documentMode>8?Ze():/^(get|post|head|put|delete|options)$/i.test(this.type)&&Ze()||ti()}:Ze;var Xe=0,Qe={},Je=p.ajaxSettings.xhr();function Ze(){try{return new t.XMLHttpRequest}catch(t){}}function ti(){try{return new t.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}t.attachEvent&&t.attachEvent("onunload",(function(){for(var t in Qe)Qe[t](void 0,!0)})),u.cors=!!Je&&"withCredentials"in Je,(Je=u.ajax=!!Je)&&p.ajaxTransport((function(e){var i;if(!e.crossDomain||u.cors)return{send:function(n,a){var s,o=e.xhr(),r=++Xe;if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(s in e.xhrFields)o[s]=e.xhrFields[s];for(s in e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest"),n)void 0!==n[s]&&o.setRequestHeader(s,n[s]+"");o.send(e.hasContent&&e.data||null),i=function(t,n){var s,l,c;if(i&&(n||4===o.readyState))if(delete Qe[r],i=void 0,o.onreadystatechange=p.noop,n)4!==o.readyState&&o.abort();else{c={},s=o.status,"string"==typeof o.responseText&&(c.text=o.responseText);try{l=o.statusText}catch(t){l=""}s||!e.isLocal||e.crossDomain?1223===s&&(s=204):s=c.text?200:404}c&&a(s,l,c,o.getAllResponseHeaders())},e.async?4===o.readyState?t.setTimeout(i):o.onreadystatechange=Qe[r]=i:i()},abort:function(){i&&i(void 0,!0)}}})),p.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return p.globalEval(t),t}}}),p.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET",t.global=!1)})),p.ajaxTransport("script",(function(t){if(t.crossDomain){var e,i=n.head||p("head")[0]||n.documentElement;return{send:function(a,s){(e=n.createElement("script")).async=!0,t.scriptCharset&&(e.charset=t.scriptCharset),e.src=t.url,e.onload=e.onreadystatechange=function(t,i){(i||!e.readyState||/loaded|complete/.test(e.readyState))&&(e.onload=e.onreadystatechange=null,e.parentNode&&e.parentNode.removeChild(e),e=null,i||s(200,"success"))},i.insertBefore(e,i.firstChild)},abort:function(){e&&e.onload(void 0,!0)}}}}));var ei=[],ii=/(=)\?(?=&|$)|\?\?/;p.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=ei.pop()||p.expando+"_"+Se++;return this[t]=!0,t}}),p.ajaxPrefilter("json jsonp",(function(e,i,n){var a,s,o,r=!1!==e.jsonp&&(ii.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&ii.test(e.data)&&"data");return r||"jsonp"===e.dataTypes[0]?(a=e.jsonpCallback=p.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,r?e[r]=e[r].replace(ii,"$1"+a):!1!==e.jsonp&&(e.url+=(Te.test(e.url)?"&":"?")+e.jsonp+"="+a),e.converters["script json"]=function(){return o||p.error(a+" was not called"),o[0]},e.dataTypes[0]="json",s=t[a],t[a]=function(){o=arguments},n.always((function(){void 0===s?p(t).removeProp(a):t[a]=s,e[a]&&(e.jsonpCallback=i.jsonpCallback,ei.push(a)),o&&p.isFunction(s)&&s(o[0]),o=s=void 0})),"script"):void 0})),p.parseHTML=function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||n;var a=C.exec(t),s=!i&&[];return a?[e.createElement(a[1])]:(a=lt([t],e,s),s&&s.length&&p(s).remove(),p.merge([],a.childNodes))};var ni=p.fn.load;function ai(t){return p.isWindow(t)?t:9===t.nodeType&&(t.defaultView||t.parentWindow)}p.fn.load=function(t,e,i){if("string"!=typeof t&&ni)return ni.apply(this,arguments);var n,a,s,o=this,r=t.indexOf(" ");return r>-1&&(n=p.trim(t.slice(r,t.length)),t=t.slice(0,r)),p.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(a="POST"),o.length>0&&p.ajax({url:t,type:a||"GET",dataType:"html",data:e}).done((function(t){s=arguments,o.html(n?p("<div>").append(p.parseHTML(t)).find(n):t)})).always(i&&function(t,e){o.each((function(){i.apply(this,s||[t.responseText,e,t])}))}),this},p.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){p.fn[e]=function(t){return this.on(e,t)}})),p.expr.filters.animated=function(t){return p.grep(p.timers,(function(e){return t===e.elem})).length},p.offset={setOffset:function(t,e,i){var n,a,s,o,r,l,c=p.css(t,"position"),d=p(t),u={};"static"===c&&(t.style.position="relative"),r=d.offset(),s=p.css(t,"top"),l=p.css(t,"left"),("absolute"===c||"fixed"===c)&&p.inArray("auto",[s,l])>-1?(o=(n=d.position()).top,a=n.left):(o=parseFloat(s)||0,a=parseFloat(l)||0),p.isFunction(e)&&(e=e.call(t,i,p.extend({},r))),null!=e.top&&(u.top=e.top-r.top+o),null!=e.left&&(u.left=e.left-r.left+a),"using"in e?e.using.call(t,u):d.css(u)}},p.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){p.offset.setOffset(this,t,e)}));var e,i,n={top:0,left:0},a=this[0],s=a&&a.ownerDocument;return s?(e=s.documentElement,p.contains(e,a)?(void 0!==a.getBoundingClientRect&&(n=a.getBoundingClientRect()),i=ai(s),{top:n.top+(i.pageYOffset||e.scrollTop)-(e.clientTop||0),left:n.left+(i.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}):n):void 0},position:function(){if(this[0]){var t,e,i={top:0,left:0},n=this[0];return"fixed"===p.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),p.nodeName(t[0],"html")||(i=t.offset()),i.top+=p.css(t[0],"borderTopWidth",!0),i.left+=p.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-p.css(n,"marginTop",!0),left:e.left-i.left-p.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&!p.nodeName(t,"html")&&"static"===p.css(t,"position");)t=t.offsetParent;return t||Ft}))}}),p.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var i=/Y/.test(e);p.fn[t]=function(n){return K(this,(function(t,n,a){var s=ai(t);return void 0===a?s?e in s?s[e]:s.document.documentElement[n]:t[n]:void(s?s.scrollTo(i?p(s).scrollLeft():a,i?a:p(s).scrollTop()):t[n]=a)}),t,n,arguments.length,null)}})),p.each(["top","left"],(function(t,e){p.cssHooks[e]=Ut(u.pixelPosition,(function(t,i){return i?(i=zt(t,e),Nt.test(i)?p(t).position()[e]+"px":i):void 0}))})),p.each({Height:"height",Width:"width"},(function(t,e){p.each({padding:"inner"+t,content:e,"":"outer"+t},(function(i,n){p.fn[n]=function(n,a){var s=arguments.length&&(i||"boolean"!=typeof n),o=i||(!0===n||!0===a?"margin":"border");return K(this,(function(e,i,n){var a;return p.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(a=e.documentElement,Math.max(e.body["scroll"+t],a["scroll"+t],e.body["offset"+t],a["offset"+t],a["client"+t])):void 0===n?p.css(e,i,o):p.style(e,i,n,o)}),e,s?n:void 0,s,null)}}))})),p.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}}),p.fn.size=function(){return this.length},p.fn.andSelf=p.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],(function(){return p}));var si=t.jQuery,oi=t.$;return p.noConflict=function(e){return t.$===p&&(t.$=oi),e&&t.jQuery===p&&(t.jQuery=si),p},e||(t.jQuery=t.$=p),p})),document.createElement("canvas").getContext||function(){function t(){}function e(t){this.type_=t,this.r1_=this.y1_=this.x1_=this.r0_=this.y0_=this.x0_=0,this.colors_=[]}function i(t,e,i){!function(t){for(var e=0;e<3;e++)for(var i=0;i<2;i++)if(!isFinite(t[e][i])||isNaN(t[e][i]))return!1;return!0}(e)||(t.m_=e,i&&(t.lineScale_=g(m(e[0][0]*e[1][1]-e[0][1]*e[1][0]))))}function n(t,e,i,n){t.currentPath_.push({type:"bezierCurveTo",cp1x:e.x,cp1y:e.y,cp2x:i.x,cp2y:i.y,x:n.x,y:n.y}),t.currentX_=n.x,t.currentY_=n.y}function a(t){this.m_=[[1,0,0],[0,1,0],[0,0,1]],this.mStack_=[],this.aStack_=[],this.currentPath_=[],this.fillStyle=this.strokeStyle="#000",this.lineWidth=1,this.lineJoin="miter",this.lineCap="butt",this.miterLimit=1*v,this.globalAlpha=1,this.canvas=t;var e=t.ownerDocument.createElement("div");e.style.width=t.clientWidth+"px",e.style.height=t.clientHeight+"px",e.style.overflow="hidden",e.style.position="absolute",t.appendChild(e),this.element_=e,this.lineScale_=this.arcScaleY_=this.arcScaleX_=1}function s(t){var e,i=1;if("rgb"==(t=String(t)).substring(0,3)){var n=t.indexOf("(",3),a=t.indexOf(")",n+1),s=t.substring(n+1,a).split(",");e="#";for(var o=0;o<3;o++)e+=x[Number(s[o])];4==s.length&&"a"==t.substr(3,1)&&(i=s[3])}else e=t;return{color:e,alpha:i}}function o(t,e){e.fillStyle=t.fillStyle,e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.shadowBlur=t.shadowBlur,e.shadowColor=t.shadowColor,e.shadowOffsetX=t.shadowOffsetX,e.shadowOffsetY=t.shadowOffsetY,e.strokeStyle=t.strokeStyle,e.globalAlpha=t.globalAlpha,e.arcScaleX_=t.arcScaleX_,e.arcScaleY_=t.arcScaleY_,e.lineScale_=t.lineScale_}function r(t,e){for(var i=[[1,0,0],[0,1,0],[0,0,1]],n=0;n<3;n++)for(var a=0;a<3;a++){for(var s=0,o=0;o<3;o++)s+=t[n][o]*e[o][a];i[n][a]=s}return i}function l(t){var e=t.srcElement;e.firstChild&&(e.firstChild.style.width=e.clientWidth+"px",e.firstChild.style.height=e.clientHeight+"px")}function c(t){var e=t.srcElement;switch(t.propertyName){case"width":e.style.width=e.attributes.width.nodeValue+"px",e.getContext().clearRect();break;case"height":e.style.height=e.attributes.height.nodeValue+"px",e.getContext().clearRect()}}function d(){return this.context_||(this.context_=new a(this))}var u=Math,h=u.round,p=u.sin,f=u.cos,m=u.abs,g=u.sqrt,v=10,b=v/2,y=Array.prototype.slice,_={init:function(t){if(/MSIE/.test(navigator.userAgent)&&!window.opera){var e=t||document;e.createElement("canvas"),e.attachEvent("onreadystatechange",function(t,e){var i=y.call(arguments,2);return function(){return t.apply(e,i.concat(y.call(arguments)))}}(this.init_,this,e))}},init_:function(t){if(t.namespaces.g_vml_||t.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML"),t.namespaces.g_o_||t.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML"),!t.styleSheets.ex_canvas_){var e=t.createStyleSheet();e.owningElement.id="ex_canvas_",e.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}g_vml_\\:*{behavior:url(#default#VML)}g_o_\\:*{behavior:url(#default#VML)}"}for(var i=t.getElementsByTagName("canvas"),n=0;n<i.length;n++)this.initElement(i[n])},initElement:function(t){if(!t.getContext){t.getContext=d,t.innerHTML="",t.attachEvent("onpropertychange",c),t.attachEvent("onresize",l);var e=t.attributes;e.width&&e.width.specified?t.style.width=e.width.nodeValue+"px":t.width=t.clientWidth,e.height&&e.height.specified?t.style.height=e.height.nodeValue+"px":t.height=t.clientHeight}return t}};_.init();for(var x=[],w=0;w<16;w++)for(var C=0;C<16;C++)x[16*w+C]=w.toString(16)+C.toString(16);var k=a.prototype;k.clearRect=function(){this.element_.innerHTML=""},k.beginPath=function(){this.currentPath_=[]},k.moveTo=function(t,e){var i=this.getCoords_(t,e);this.currentPath_.push({type:"moveTo",x:i.x,y:i.y}),this.currentX_=i.x,this.currentY_=i.y},k.lineTo=function(t,e){var i=this.getCoords_(t,e);this.currentPath_.push({type:"lineTo",x:i.x,y:i.y}),this.currentX_=i.x,this.currentY_=i.y},k.bezierCurveTo=function(t,e,i,a,s,o){var r=this.getCoords_(s,o);n(this,this.getCoords_(t,e),this.getCoords_(i,a),r)},k.quadraticCurveTo=function(t,e,i,a){var s=this.getCoords_(t,e),o=this.getCoords_(i,a),r={x:this.currentX_+.6666666666666666*(s.x-this.currentX_),y:this.currentY_+.6666666666666666*(s.y-this.currentY_)};n(this,r,{x:r.x+(o.x-this.currentX_)/3,y:r.y+(o.y-this.currentY_)/3},o)},k.arc=function(t,e,i,n,a,s){i*=v;var o=s?"at":"wa",r=t+f(n)*i-b,l=e+p(n)*i-b,c=t+f(a)*i-b,d=e+p(a)*i-b;r==c&&!s&&(r+=.125);var u=this.getCoords_(t,e),h=this.getCoords_(r,l),m=this.getCoords_(c,d);this.currentPath_.push({type:o,x:u.x,y:u.y,radius:i,xStart:h.x,yStart:h.y,xEnd:m.x,yEnd:m.y})},k.rect=function(t,e,i,n){this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+n),this.lineTo(t,e+n),this.closePath()},k.strokeRect=function(t,e,i,n){var a=this.currentPath_;this.beginPath(),this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+n),this.lineTo(t,e+n),this.closePath(),this.stroke(),this.currentPath_=a},k.fillRect=function(t,e,i,n){var a=this.currentPath_;this.beginPath(),this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+n),this.lineTo(t,e+n),this.closePath(),this.fill(),this.currentPath_=a},k.createLinearGradient=function(t,i,n,a){var s=new e("gradient");return s.x0_=t,s.y0_=i,s.x1_=n,s.y1_=a,s},k.createRadialGradient=function(t,i,n,a,s,o){var r=new e("gradientradial");return r.x0_=t,r.y0_=i,r.r0_=n,r.x1_=a,r.y1_=s,r.r1_=o,r},k.drawImage=function(t){var e,i,n,a,s,o,r,l,c=t.runtimeStyle.width,d=t.runtimeStyle.height;t.runtimeStyle.width="auto",t.runtimeStyle.height="auto";var p=t.width,f=t.height;if(t.runtimeStyle.width=c,t.runtimeStyle.height=d,3==arguments.length)e=arguments[1],i=arguments[2],s=o=0,r=n=p,l=a=f;else if(5==arguments.length)e=arguments[1],i=arguments[2],n=arguments[3],a=arguments[4],s=o=0,r=p,l=f;else{if(9!=arguments.length)throw Error("Invalid number of arguments");s=arguments[1],o=arguments[2],r=arguments[3],l=arguments[4],e=arguments[5],i=arguments[6],n=arguments[7],a=arguments[8]}var m=this.getCoords_(e,i),g=[];if(g.push(" <g_vml_:group",' coordsize="',10*v,",",10*v,'"',' coordorigin="0,0"',' style="width:',10,"px;height:",10,"px;position:absolute;"),1!=this.m_[0][0]||this.m_[0][1]){var b=[];b.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",h(m.x/v),",","Dy=",h(m.y/v),"");var y=m,_=this.getCoords_(e+n,i),x=this.getCoords_(e,i+a),w=this.getCoords_(e+n,i+a);y.x=u.max(y.x,_.x,x.x,w.x),y.y=u.max(y.y,_.y,x.y,w.y),g.push("padding:0 ",h(y.x/v),"px ",h(y.y/v),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",b.join(""),", sizingmethod='clip');")}else g.push("top:",h(m.y/v),"px;left:",h(m.x/v),"px;");g.push(' ">','<g_vml_:image src="',t.src,'"',' style="width:',v*n,"px;"," height:",v*a,'px;"',' cropleft="',s/p,'"',' croptop="',o/f,'"',' cropright="',(p-s-r)/p,'"',' cropbottom="',(f-o-l)/f,'"'," />","</g_vml_:group>"),this.element_.insertAdjacentHTML("BeforeEnd",g.join(""))},k.stroke=function(t){var e=[],i=s(t?this.fillStyle:this.strokeStyle),n=i.color,a=i.alpha*this.globalAlpha;e.push("<g_vml_:shape",' filled="',!!t,'"',' style="position:absolute;width:',10,"px;height:",10,'px;"',' coordorigin="0 0" coordsize="',10*v," ",10*v,'"',' stroked="',!t,'"',' path="');for(var o={x:null,y:null},r={x:null,y:null},l=0;l<this.currentPath_.length;l++){var c=this.currentPath_[l];switch(c.type){case"moveTo":e.push(" m ",h(c.x),",",h(c.y));break;case"lineTo":e.push(" l ",h(c.x),",",h(c.y));break;case"close":e.push(" x "),c=null;break;case"bezierCurveTo":e.push(" c ",h(c.cp1x),",",h(c.cp1y),",",h(c.cp2x),",",h(c.cp2y),",",h(c.x),",",h(c.y));break;case"at":case"wa":e.push(" ",c.type," ",h(c.x-this.arcScaleX_*c.radius),",",h(c.y-this.arcScaleY_*c.radius)," ",h(c.x+this.arcScaleX_*c.radius),",",h(c.y+this.arcScaleY_*c.radius)," ",h(c.xStart),",",h(c.yStart)," ",h(c.xEnd),",",h(c.yEnd))}c&&((null==o.x||c.x<o.x)&&(o.x=c.x),(null==r.x||c.x>r.x)&&(r.x=c.x),(null==o.y||c.y<o.y)&&(o.y=c.y),(null==r.y||c.y>r.y)&&(r.y=c.y))}if(e.push(' ">'),t)if("object"==typeof this.fillStyle){var d=this.fillStyle,p=0,f={x:0,y:0},m=0,g=1;if("gradient"==d.type_){var b=d.x1_/this.arcScaleX_,y=d.y1_/this.arcScaleY_,_=this.getCoords_(d.x0_/this.arcScaleX_,d.y0_/this.arcScaleY_),x=this.getCoords_(b,y);(p=180*Math.atan2(x.x-_.x,x.y-_.y)/Math.PI)<0&&(p+=360),p<1e-6&&(p=0)}else{_=this.getCoords_(d.x0_,d.y0_);var w=r.x-o.x,C=r.y-o.y;f={x:(_.x-o.x)/w,y:(_.y-o.y)/C},w/=this.arcScaleX_*v,C/=this.arcScaleY_*v;var k=u.max(w,C);m=2*d.r0_/k,g=2*d.r1_/k-m}var $=d.colors_;$.sort((function(t,e){return t.offset-e.offset}));var S=$.length,T=$[0].color,I=$[S-1].color,D=$[0].alpha*this.globalAlpha,A=$[S-1].alpha*this.globalAlpha,P=[];for(l=0;l<S;l++){var O=$[l];P.push(O.offset*g+m+" "+O.color)}e.push('<g_vml_:fill type="',d.type_,'"',' method="none" focus="100%"',' color="',T,'"',' color2="',I,'"',' colors="',P.join(","),'"',' opacity="',A,'"',' g_o_:opacity2="',D,'"',' angle="',p,'"',' focusposition="',f.x,",",f.y,'" />')}else e.push('<g_vml_:fill color="',n,'" opacity="',a,'" />');else{var E=this.lineScale_*this.lineWidth;E<1&&(a*=E),e.push("<g_vml_:stroke",' opacity="',a,'"',' joinstyle="',this.lineJoin,'"',' miterlimit="',this.miterLimit,'"',' endcap="',function(t){switch(t){case"butt":return"flat";case"round":return"round";default:return"square"}}(this.lineCap),'"',' weight="',E,'px"',' color="',n,'" />')}e.push("</g_vml_:shape>"),this.element_.insertAdjacentHTML("beforeEnd",e.join(""))},k.fill=function(){this.stroke(!0)},k.closePath=function(){this.currentPath_.push({type:"close"})},k.getCoords_=function(t,e){var i=this.m_;return{x:v*(t*i[0][0]+e*i[1][0]+i[2][0])-b,y:v*(t*i[0][1]+e*i[1][1]+i[2][1])-b}},k.save=function(){var t={};o(this,t),this.aStack_.push(t),this.mStack_.push(this.m_),this.m_=r([[1,0,0],[0,1,0],[0,0,1]],this.m_)},k.restore=function(){o(this.aStack_.pop(),this),this.m_=this.mStack_.pop()},k.translate=function(t,e){i(this,r([[1,0,0],[0,1,0],[t,e,1]],this.m_),!1)},k.rotate=function(t){var e=f(t),n=p(t);i(this,r([[e,n,0],[-n,e,0],[0,0,1]],this.m_),!1)},k.scale=function(t,e){this.arcScaleX_*=t,this.arcScaleY_*=e,i(this,r([[t,0,0],[0,e,0],[0,0,1]],this.m_),!0)},k.transform=function(t,e,n,a,s,o){i(this,r([[t,e,0],[n,a,0],[s,o,1]],this.m_),!0)},k.setTransform=function(t,e,n,a,s,o){i(this,[[t,e,0],[n,a,0],[s,o,1]],!0)},k.clip=function(){},k.arcTo=function(){},k.createPattern=function(){return new t},e.prototype.addColorStop=function(t,e){e=s(e),this.colors_.push({offset:t,color:e.color,alpha:e.alpha})},G_vmlCanvasManager=_,CanvasRenderingContext2D=a,CanvasGradient=e,CanvasPattern=t}(),function(t){"function"==typeof define&&define.amd?define(["./jquery"],t):t(jQuery)}((function(t){function e(e,n){var a,s,o,r=e.nodeName.toLowerCase();return"area"===r?(s=(a=e.parentNode).name,!(!e.href||!s||"map"!==a.nodeName.toLowerCase())&&(!!(o=t("img[usemap='#"+s+"']")[0])&&i(o))):(/^(input|select|textarea|button|object)$/.test(r)?!e.disabled:"a"===r&&e.href||n)&&i(e)}function i(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter((function(){return"hidden"===t.css(this,"visibility")})).length}function n(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},t.extend(this._defaults,this.regional[""]),this.regional.en=t.extend(!0,{},this.regional[""]),this.regional["en-US"]=t.extend(!0,{},this.regional.en),this.dpDiv=a(t("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function a(e){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(i,"mouseout",(function(){t(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).removeClass("ui-datepicker-next-hover")})).delegate(i,"mouseover",s)}function s(){t.datepicker._isDisabledDatepicker(p.inline?p.dpDiv.parent()[0]:p.input[0])||(t(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),t(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).addClass("ui-datepicker-next-hover"))}function o(e,i){for(var n in t.extend(e,i),i)null==i[n]&&(e[n]=i[n]);return e}function r(t){return function(){var e=this.element.val();t.apply(this,arguments),this._refresh(),e!==this.element.val()&&this._trigger("change")}}var l;t.ui=t.ui||{},t.extend(t.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({scrollParent:function(e){var i=this.css("position"),n="absolute"===i,a=e?/(auto|scroll|hidden)/:/(auto|scroll)/,s=this.parents().filter((function(){var e=t(this);return(!n||"static"!==e.css("position"))&&a.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))})).eq(0);return"fixed"!==i&&s.length?s:t(this[0].ownerDocument||document)},uniqueId:(l=0,function(){return this.each((function(){this.id||(this.id="ui-id-"+ ++l)}))}),removeUniqueId:function(){return this.each((function(){/^ui-id-\d+$/.test(this.id)&&t(this).removeAttr("id")}))}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo((function(e){return function(i){return!!t.data(i,e)}})):function(e,i,n){return!!t.data(e,n[3])},focusable:function(i){return e(i,!isNaN(t.attr(i,"tabindex")))},tabbable:function(i){var n=t.attr(i,"tabindex"),a=isNaN(n);return(a||n>=0)&&e(i,!a)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],(function(e,i){function n(e,i,n,s){return t.each(a,(function(){i-=parseFloat(t.css(e,"padding"+this))||0,n&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),s&&(i-=parseFloat(t.css(e,"margin"+this))||0)})),i}var a="Width"===i?["Left","Right"]:["Top","Bottom"],s=i.toLowerCase(),o={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+i]=function(e){return void 0===e?o["inner"+i].call(this):this.each((function(){t(this).css(s,n(this,e)+"px")}))},t.fn["outer"+i]=function(e,a){return"number"!=typeof e?o["outer"+i].call(this,e):this.each((function(){t(this).css(s,n(this,e,!0,a)+"px")}))}})),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(i){return arguments.length?e.call(this,t.camelCase(i)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.fn.extend({focus:function(e){return function(i,n){return"number"==typeof i?this.each((function(){var e=this;setTimeout((function(){t(e).focus(),n&&n.call(e)}),i)})):e.apply(this,arguments)}}(t.fn.focus),disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(t+".ui-disableSelection",(function(t){t.preventDefault()}))}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var i,n,a=t(this[0]);a.length&&a[0]!==document;){if(("absolute"===(i=a.css("position"))||"relative"===i||"fixed"===i)&&(n=parseInt(a.css("zIndex"),10),!isNaN(n)&&0!==n))return n;a=a.parent()}return 0}}),t.ui.plugin={add:function(e,i,n){var a,s=t.ui[e].prototype;for(a in n)s.plugins[a]=s.plugins[a]||[],s.plugins[a].push([i,n[a]])},call:function(t,e,i,n){var a,s=t.plugins[e];if(s&&(n||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(a=0;s.length>a;a++)t.options[s[a][0]]&&s[a][1].apply(t.element,i)}};var c=0,d=Array.prototype.slice;t.cleanData=function(e){return function(i){var n,a,s;for(s=0;null!=(a=i[s]);s++)try{(n=t._data(a,"events"))&&n.remove&&t(a).triggerHandler("remove")}catch(t){}e(i)}}(t.cleanData),t.widget=function(e,i,n){var a,s,o,r,l={},c=e.split(".")[0];return e=e.split(".")[1],a=c+"-"+e,n||(n=i,i=t.Widget),t.expr[":"][a.toLowerCase()]=function(e){return!!t.data(e,a)},t[c]=t[c]||{},s=t[c][e],o=t[c][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new o(t,e)},t.extend(o,s,{version:n.version,_proto:t.extend({},n),_childConstructors:[]}),(r=new i).options=t.widget.extend({},r.options),t.each(n,(function(e,n){return t.isFunction(n)?void(l[e]=(a=function(){return i.prototype[e].apply(this,arguments)},s=function(t){return i.prototype[e].apply(this,t)},function(){var t,e=this._super,i=this._superApply;return this._super=a,this._superApply=s,t=n.apply(this,arguments),this._super=e,this._superApply=i,t})):void(l[e]=n);var a,s})),o.prototype=t.widget.extend(r,{widgetEventPrefix:s&&r.widgetEventPrefix||e},l,{constructor:o,namespace:c,widgetName:e,widgetFullName:a}),s?(t.each(s._childConstructors,(function(e,i){var n=i.prototype;t.widget(n.namespace+"."+n.widgetName,o,i._proto)})),delete s._childConstructors):i._childConstructors.push(o),t.widget.bridge(e,o),o},t.widget.extend=function(e){for(var i,n,a=d.call(arguments,1),s=0,o=a.length;o>s;s++)for(i in a[s])n=a[s][i],a[s].hasOwnProperty(i)&&void 0!==n&&(e[i]=t.isPlainObject(n)?t.isPlainObject(e[i])?t.widget.extend({},e[i],n):t.widget.extend({},n):n);return e},t.widget.bridge=function(e,i){var n=i.prototype.widgetFullName||e;t.fn[e]=function(a){var s="string"==typeof a,o=d.call(arguments,1),r=this;return s?this.each((function(){var i,s=t.data(this,n);return"instance"===a?(r=s,!1):s?t.isFunction(s[a])&&"_"!==a.charAt(0)?(i=s[a].apply(s,o))!==s&&void 0!==i?(r=i&&i.jquery?r.pushStack(i.get()):i,!1):void 0:t.error("no such method '"+a+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+a+"'")})):(o.length&&(a=t.widget.extend.apply(null,[a].concat(o))),this.each((function(){var e=t.data(this,n);e?(e.option(a||{}),e._init&&e._init()):t.data(this,n,new i(a,this))}))),r}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,i){i=t(i||this.defaultElement||this)[0],this.element=t(i),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),i!==this&&(t.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===i&&this.destroy()}}),this.document=t(i.style?i.ownerDocument:i.document||i),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var n,a,s,o=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(o={},n=e.split("."),e=n.shift(),n.length){for(a=o[e]=t.widget.extend({},this.options[e]),s=0;n.length-1>s;s++)a[n[s]]=a[n[s]]||{},a=a[n[s]];if(e=n.pop(),1===arguments.length)return void 0===a[e]?null:a[e];a[e]=i}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];o[e]=i}return this._setOptions(o),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!e),e&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(e,i,n){var a,s=this;"boolean"!=typeof e&&(n=i,i=e,e=!1),n?(i=a=t(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,a=this.widget()),t.each(n,(function(n,o){function r(){return e||!0!==s.options.disabled&&!t(this).hasClass("ui-state-disabled")?("string"==typeof o?s[o]:o).apply(s,arguments):void 0}"string"!=typeof o&&(r.guid=o.guid=o.guid||r.guid||t.guid++);var l=n.match(/^([\w:-]*)\s*(.*)$/),c=l[1]+s.eventNamespace,d=l[2];d?a.delegate(d,c,r):i.bind(c,r)}))},_off:function(e,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(i).undelegate(i),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){var i=this;return setTimeout((function(){return("string"==typeof t?i[t]:t).apply(i,arguments)}),e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,n){var a,s,o=this.options[e];if(n=n||{},(i=t.Event(i)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],s=i.originalEvent)for(a in s)a in i||(i[a]=s[a]);return this.element.trigger(i,n),!(t.isFunction(o)&&!1===o.apply(this.element[0],[i].concat(n))||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},(function(e,i){t.Widget.prototype["_"+e]=function(n,a,s){"string"==typeof a&&(a={effect:a});var o,r=a?!0===a||"number"==typeof a?i:a.effect||i:e;"number"==typeof(a=a||{})&&(a={duration:a}),o=!t.isEmptyObject(a),a.complete=s,a.delay&&n.delay(a.delay),o&&t.effects&&t.effects.effect[r]?n[e](a):r!==e&&n[r]?n[r](a.duration,a.easing,s):n.queue((function(i){t(this)[e](),s&&s.call(n[0]),i()}))}})),t.widget;var u=!1;t(document).mouseup((function(){u=!1})),t.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,(function(t){return e._mouseDown(t)})).bind("click."+this.widgetName,(function(i){return!0===t.data(i.target,e.widgetName+".preventClickEvent")?(t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0})),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!u){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var i=this,n=1===e.which,a=!("string"!=typeof this.options.cancel||!e.target.nodeName)&&t(e.target).closest(this.options.cancel).length;return!(n&&!a&&this._mouseCapture(e))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout((function(){i.mouseDelayMet=!0}),this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(e),!this._mouseStarted)?(e.preventDefault(),!0):(!0===t.data(e.target,this.widgetName+".preventClickEvent")&&t.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return i._mouseMove(t)},this._mouseUpDelegate=function(t){return i._mouseUp(t)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),u=!0,!0))}},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||9>document.documentMode)&&!e.button)return this._mouseUp(e);if(!e.which)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,e),this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),u=!1,!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),function(){function e(t,e,i){return[parseFloat(t[0])*(h.test(t[0])?e/100:1),parseFloat(t[1])*(h.test(t[1])?i/100:1)]}function i(e,i){return parseInt(t.css(e,i),10)||0}t.ui=t.ui||{};var n,a,s=Math.max,o=Math.abs,r=Math.round,l=/left|center|right/,c=/top|center|bottom/,d=/[\+\-]\d+(\.[\d]+)?%?/,u=/^\w+/,h=/%$/,p=t.fn.position;t.position={scrollbarWidth:function(){if(void 0!==n)return n;var e,i,a=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),s=a.children()[0];return t("body").append(a),e=s.offsetWidth,a.css("overflow","scroll"),e===(i=s.offsetWidth)&&(i=a[0].clientWidth),a.remove(),n=e-i},getScrollInfo:function(e){var i=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),n=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),a="scroll"===i||"auto"===i&&e.width<e.element[0].scrollWidth;return{width:"scroll"===n||"auto"===n&&e.height<e.element[0].scrollHeight?t.position.scrollbarWidth():0,height:a?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),n=t.isWindow(i[0]),a=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:n,isDocument:a,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:n||a?i.width():i.outerWidth(),height:n||a?i.height():i.outerHeight()}}},t.fn.position=function(n){if(!n||!n.of)return p.apply(this,arguments);n=t.extend({},n);var h,f,m,g,v,b,y=t(n.of),_=t.position.getWithinInfo(n.within),x=t.position.getScrollInfo(_),w=(n.collision||"flip").split(" "),C={};return b=function(e){var i=e[0];return 9===i.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}(y),y[0].preventDefault&&(n.at="left top"),f=b.width,m=b.height,g=b.offset,v=t.extend({},g),t.each(["my","at"],(function(){var t,e,i=(n[this]||"").split(" ");1===i.length&&(i=l.test(i[0])?i.concat(["center"]):c.test(i[0])?["center"].concat(i):["center","center"]),i[0]=l.test(i[0])?i[0]:"center",i[1]=c.test(i[1])?i[1]:"center",t=d.exec(i[0]),e=d.exec(i[1]),C[this]=[t?t[0]:0,e?e[0]:0],n[this]=[u.exec(i[0])[0],u.exec(i[1])[0]]})),1===w.length&&(w[1]=w[0]),"right"===n.at[0]?v.left+=f:"center"===n.at[0]&&(v.left+=f/2),"bottom"===n.at[1]?v.top+=m:"center"===n.at[1]&&(v.top+=m/2),h=e(C.at,f,m),v.left+=h[0],v.top+=h[1],this.each((function(){var l,c,d=t(this),u=d.outerWidth(),p=d.outerHeight(),b=i(this,"marginLeft"),k=i(this,"marginTop"),$=u+b+i(this,"marginRight")+x.width,S=p+k+i(this,"marginBottom")+x.height,T=t.extend({},v),I=e(C.my,d.outerWidth(),d.outerHeight());"right"===n.my[0]?T.left-=u:"center"===n.my[0]&&(T.left-=u/2),"bottom"===n.my[1]?T.top-=p:"center"===n.my[1]&&(T.top-=p/2),T.left+=I[0],T.top+=I[1],a||(T.left=r(T.left),T.top=r(T.top)),l={marginLeft:b,marginTop:k},t.each(["left","top"],(function(e,i){t.ui.position[w[e]]&&t.ui.position[w[e]][i](T,{targetWidth:f,targetHeight:m,elemWidth:u,elemHeight:p,collisionPosition:l,collisionWidth:$,collisionHeight:S,offset:[h[0]+I[0],h[1]+I[1]],my:n.my,at:n.at,within:_,elem:d})})),n.using&&(c=function(t){var e=g.left-T.left,i=e+f-u,a=g.top-T.top,r=a+m-p,l={target:{element:y,left:g.left,top:g.top,width:f,height:m},element:{element:d,left:T.left,top:T.top,width:u,height:p},horizontal:0>i?"left":e>0?"right":"center",vertical:0>r?"top":a>0?"bottom":"middle"};u>f&&f>o(e+i)&&(l.horizontal="center"),p>m&&m>o(a+r)&&(l.vertical="middle"),l.important=s(o(e),o(i))>s(o(a),o(r))?"horizontal":"vertical",n.using.call(this,t,l)}),d.offset(t.extend(T,{using:c}))}))},t.ui.position={fit:{left:function(t,e){var i,n=e.within,a=n.isWindow?n.scrollLeft:n.offset.left,o=n.width,r=t.left-e.collisionPosition.marginLeft,l=a-r,c=r+e.collisionWidth-o-a;e.collisionWidth>o?l>0&&0>=c?(i=t.left+l+e.collisionWidth-o-a,t.left+=l-i):t.left=c>0&&0>=l?a:l>c?a+o-e.collisionWidth:a:l>0?t.left+=l:c>0?t.left-=c:t.left=s(t.left-r,t.left)},top:function(t,e){var i,n=e.within,a=n.isWindow?n.scrollTop:n.offset.top,o=e.within.height,r=t.top-e.collisionPosition.marginTop,l=a-r,c=r+e.collisionHeight-o-a;e.collisionHeight>o?l>0&&0>=c?(i=t.top+l+e.collisionHeight-o-a,t.top+=l-i):t.top=c>0&&0>=l?a:l>c?a+o-e.collisionHeight:a:l>0?t.top+=l:c>0?t.top-=c:t.top=s(t.top-r,t.top)}},flip:{left:function(t,e){var i,n,a=e.within,s=a.offset.left+a.scrollLeft,r=a.width,l=a.isWindow?a.scrollLeft:a.offset.left,c=t.left-e.collisionPosition.marginLeft,d=c-l,u=c+e.collisionWidth-r-l,h="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];0>d?(0>(i=t.left+h+p+f+e.collisionWidth-r-s)||o(d)>i)&&(t.left+=h+p+f):u>0&&(((n=t.left-e.collisionPosition.marginLeft+h+p+f-l)>0||u>o(n))&&(t.left+=h+p+f))},top:function(t,e){var i,n,a=e.within,s=a.offset.top+a.scrollTop,r=a.height,l=a.isWindow?a.scrollTop:a.offset.top,c=t.top-e.collisionPosition.marginTop,d=c-l,u=c+e.collisionHeight-r-l,h="top"===e.my[1]?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,p="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,f=-2*e.offset[1];0>d?(0>(n=t.top+h+p+f+e.collisionHeight-r-s)||o(d)>n)&&(t.top+=h+p+f):u>0&&(((i=t.top-e.collisionPosition.marginTop+h+p+f-l)>0||u>o(i))&&(t.top+=h+p+f))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}},function(){var e,i,n,s,o,r=document.getElementsByTagName("body")[0],l=document.createElement("div");for(o in e=document.createElement(r?"div":"body"),n={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},r&&t.extend(n,{position:"absolute",left:"-1000px",top:"-1000px"}),n)e.style[o]=n[o];e.appendChild(l),(i=r||document.documentElement).insertBefore(e,i.firstChild),l.style.cssText="position: absolute; left: 10.7432222px;",s=t(l).offset().left,a=s>10&&11>s,e.innerHTML="",i.removeChild(e)}()}(),t.ui.position,t.widget("ui.accordion",{version:"1.11.4",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var e=this.options;this.prevShow=this.prevHide=t(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),e.collapsible||!1!==e.active&&null!=e.active||(e.active=0),this._processPanels(),0>e.active&&(e.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():t()}},_createIcons:function(){var e=this.options.icons;e&&(t("<span>").addClass("ui-accordion-header-icon ui-icon "+e.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(e.header).addClass(e.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var t;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),t=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&t.css("height","")},_setOption:function(t,e){return"active"===t?void this._activate(e):("event"===t&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(e)),this._super(t,e),"collapsible"!==t||e||!1!==this.options.active||this._activate(0),"icons"===t&&(this._destroyIcons(),e&&this._createIcons()),void("disabled"===t&&(this.element.toggleClass("ui-state-disabled",!!e).attr("aria-disabled",e),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!e))))},_keydown:function(e){if(!e.altKey&&!e.ctrlKey){var i=t.ui.keyCode,n=this.headers.length,a=this.headers.index(e.target),s=!1;switch(e.keyCode){case i.RIGHT:case i.DOWN:s=this.headers[(a+1)%n];break;case i.LEFT:case i.UP:s=this.headers[(a-1+n)%n];break;case i.SPACE:case i.ENTER:this._eventHandler(e);break;case i.HOME:s=this.headers[0];break;case i.END:s=this.headers[n-1]}s&&(t(e.target).attr("tabIndex",-1),t(s).attr("tabIndex",0),s.focus(),e.preventDefault())}},_panelKeyDown:function(e){e.keyCode===t.ui.keyCode.UP&&e.ctrlKey&&t(e.currentTarget).prev().focus()},refresh:function(){var e=this.options;this._processPanels(),!1===e.active&&!0===e.collapsible||!this.headers.length?(e.active=!1,this.active=t()):!1===e.active?this._activate(0):this.active.length&&!t.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(e.active=!1,this.active=t()):this._activate(Math.max(0,e.active-1)):e.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var t=this.headers,e=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide(),e&&(this._off(t.not(this.headers)),this._off(e.not(this.panels)))},_refresh:function(){var e,i=this.options,n=i.heightStyle,a=this.element.parent();this.active=this._findActive(i.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each((function(){var e=t(this),i=e.uniqueId().attr("id"),n=e.next(),a=n.uniqueId().attr("id");e.attr("aria-controls",a),n.attr("aria-labelledby",i)})).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(i.event),"fill"===n?(e=a.height(),this.element.siblings(":visible").each((function(){var i=t(this),n=i.css("position");"absolute"!==n&&"fixed"!==n&&(e-=i.outerHeight(!0))})),this.headers.each((function(){e-=t(this).outerHeight(!0)})),this.headers.next().each((function(){t(this).height(Math.max(0,e-t(this).innerHeight()+t(this).height()))})).css("overflow","auto")):"auto"===n&&(e=0,this.headers.next().each((function(){e=Math.max(e,t(this).css("height","").height())})).height(e))},_activate:function(e){var i=this._findActive(e)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return"number"==typeof e?this.headers.eq(e):t()},_setupEvents:function(e){var i={keydown:"_keydown"};e&&t.each(e.split(" "),(function(t,e){i[e]="_eventHandler"})),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(e){var i=this.options,n=this.active,a=t(e.currentTarget),s=a[0]===n[0],o=s&&i.collapsible,r=o?t():a.next(),l=n.next(),c={oldHeader:n,oldPanel:l,newHeader:o?t():a,newPanel:r};e.preventDefault(),s&&!i.collapsible||!1===this._trigger("beforeActivate",e,c)||(i.active=!o&&this.headers.index(a),this.active=s?t():a,this._toggle(c),n.removeClass("ui-accordion-header-active ui-state-active"),i.icons&&n.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header),s||(a.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),i.icons&&a.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader),a.next().addClass("ui-accordion-content-active")))},_toggle:function(e){var i=e.newPanel,n=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=n,this.options.animate?this._animate(i,n,e):(n.hide(),i.show(),this._toggleComplete(e)),n.attr({"aria-hidden":"true"}),n.prev().attr({"aria-selected":"false","aria-expanded":"false"}),i.length&&n.length?n.prev().attr({tabIndex:-1,"aria-expanded":"false"}):i.length&&this.headers.filter((function(){return 0===parseInt(t(this).attr("tabIndex"),10)})).attr("tabIndex",-1),i.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(t,e,i){var n,a,s,o=this,r=0,l=t.css("box-sizing"),c=t.length&&(!e.length||t.index()<e.index()),d=this.options.animate||{},u=c&&d.down||d,h=function(){o._toggleComplete(i)};return"number"==typeof u&&(s=u),"string"==typeof u&&(a=u),a=a||u.easing||d.easing,s=s||u.duration||d.duration,e.length?t.length?(n=t.show().outerHeight(),e.animate(this.hideProps,{duration:s,easing:a,step:function(t,e){e.now=Math.round(t)}}),void t.hide().animate(this.showProps,{duration:s,easing:a,complete:h,step:function(t,i){i.now=Math.round(t),"height"!==i.prop?"content-box"===l&&(r+=i.now):"content"!==o.options.heightStyle&&(i.now=Math.round(n-e.outerHeight()-r),r=0)}})):e.animate(this.hideProps,s,a,h):t.animate(this.showProps,s,a,h)},_toggleComplete:function(t){var e=t.oldPanel;e.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),e.length&&(e.parent()[0].className=e.parent()[0].className),this._trigger("activate",null,t)}}),t.widget("ui.menu",{version:"1.11.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(t){t.preventDefault()},"click .ui-menu-item":function(e){var i=t(e.target);!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(e),e.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(e):!this.element.is(":focus")&&t(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){if(!this.previousFilter){var i=t(e.currentTarget);i.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(e,i)}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var i=this.active||this.element.find(this.options.items).eq(0);e||this.focus(t,i)},blur:function(e){this._delay((function(){t.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(e)}))},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){this._closeOnDocumentClick(t)&&this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each((function(){var e=t(this);e.data("ui-menu-submenu-carat")&&e.remove()})),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(e){var i,n,a,s,o=!0;switch(e.keyCode){case t.ui.keyCode.PAGE_UP:this.previousPage(e);break;case t.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case t.ui.keyCode.HOME:this._move("first","first",e);break;case t.ui.keyCode.END:this._move("last","last",e);break;case t.ui.keyCode.UP:this.previous(e);break;case t.ui.keyCode.DOWN:this.next(e);break;case t.ui.keyCode.LEFT:this.collapse(e);break;case t.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case t.ui.keyCode.ENTER:case t.ui.keyCode.SPACE:this._activate(e);break;case t.ui.keyCode.ESCAPE:this.collapse(e);break;default:o=!1,n=this.previousFilter||"",a=String.fromCharCode(e.keyCode),s=!1,clearTimeout(this.filterTimer),a===n?s=!0:a=n+a,i=this._filterMenuItems(a),(i=s&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i).length||(a=String.fromCharCode(e.keyCode),i=this._filterMenuItems(a)),i.length?(this.focus(e,i),this.previousFilter=a,this.filterTimer=this._delay((function(){delete this.previousFilter}),1e3)):delete this.previousFilter}o&&e.preventDefault()},_activate:function(t){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(t):this.select(t))},refresh:function(){var e,i=this,n=this.options.icons.submenu,a=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),a.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each((function(){var e=t(this),i=e.parent(),a=t("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(a),e.attr("aria-labelledby",i.attr("id"))})),(e=a.add(this.element).find(this.options.items)).not(".ui-menu-item").each((function(){var e=t(this);i._isDivider(e)&&e.addClass("ui-widget-content ui-menu-divider")})),e.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),e.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!t.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(t,e){"icons"===t&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(e.submenu),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!e).attr("aria-disabled",e),this._super(t,e)},focus:function(t,e){var i,n;this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),n=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",n.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay((function(){this._close()}),this.delay),(i=e.children(".ui-menu")).length&&t&&/^mouse/.test(t.type)&&this._startOpening(i),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})},_scrollIntoView:function(e){var i,n,a,s,o,r;this._hasScroll()&&(i=parseFloat(t.css(this.activeMenu[0],"borderTopWidth"))||0,n=parseFloat(t.css(this.activeMenu[0],"paddingTop"))||0,a=e.offset().top-this.activeMenu.offset().top-i-n,s=this.activeMenu.scrollTop(),o=this.activeMenu.height(),r=e.outerHeight(),0>a?this.activeMenu.scrollTop(s+a):a+r>o&&this.activeMenu.scrollTop(s+a-o+r))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",t,{item:this.active}))},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay((function(){this._close(),this._open(t)}),this.delay))},_open:function(e){var i=t.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(e,i){clearTimeout(this.timer),this.timer=this._delay((function(){var n=i?this.element:t(e&&e.target).closest(this.element.find(".ui-menu"));n.length||(n=this.element),this._close(n),this.blur(e),this.activeMenu=n}),this.delay)},_close:function(t){t||(t=this.active?this.active.parent():this.element),t.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(e){return!t(e.target).closest(".ui-menu").length},_isDivider:function(t){return!/[^\-\u2014\u2013\s]/.test(t.text())},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();e&&e.length&&(this._open(e.parent()),this._delay((function(){this.focus(t,e)})))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(t,e,i){var n;this.active&&(n="first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[t+"All"](".ui-menu-item").eq(0)),n&&n.length&&this.active||(n=this.activeMenu.find(this.options.items)[e]()),this.focus(i,n)},nextPage:function(e){var i,n,a;return this.active?void(this.isLastItem()||(this._hasScroll()?(n=this.active.offset().top,a=this.element.height(),this.active.nextAll(".ui-menu-item").each((function(){return 0>(i=t(this)).offset().top-n-a})),this.focus(e,i)):this.focus(e,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(e)},previousPage:function(e){var i,n,a;return this.active?void(this.isFirstItem()||(this._hasScroll()?(n=this.active.offset().top,a=this.element.height(),this.active.prevAll(".ui-menu-item").each((function(){return(i=t(this)).offset().top-n+a>0})),this.focus(e,i)):this.focus(e,this.activeMenu.find(this.options.items).first()))):void this.next(e)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||t(e.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,i)},_filterMenuItems:function(e){var i=e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),n=RegExp("^"+i,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter((function(){return n.test(t.trim(t(this).text()))}))}}),t.widget("ui.autocomplete",{version:"1.11.4",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var e,i,n,a=this.element[0].nodeName.toLowerCase(),s="textarea"===a,o="input"===a;this.isMultiLine=!!s||!o&&this.element.prop("isContentEditable"),this.valueMethod=this.element[s||o?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(a){if(this.element.prop("readOnly"))return e=!0,n=!0,void(i=!0);e=!1,n=!1,i=!1;var s=t.ui.keyCode;switch(a.keyCode){case s.PAGE_UP:e=!0,this._move("previousPage",a);break;case s.PAGE_DOWN:e=!0,this._move("nextPage",a);break;case s.UP:e=!0,this._keyEvent("previous",a);break;case s.DOWN:e=!0,this._keyEvent("next",a);break;case s.ENTER:this.menu.active&&(e=!0,a.preventDefault(),this.menu.select(a));break;case s.TAB:this.menu.active&&this.menu.select(a);break;case s.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(a),a.preventDefault());break;default:i=!0,this._searchTimeout(a)}},keypress:function(n){if(e)return e=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&n.preventDefault());if(!i){var a=t.ui.keyCode;switch(n.keyCode){case a.PAGE_UP:this._move("previousPage",n);break;case a.PAGE_DOWN:this._move("nextPage",n);break;case a.UP:this._keyEvent("previous",n);break;case a.DOWN:this._keyEvent("next",n)}}},input:function(t){return n?(n=!1,void t.preventDefault()):void this._searchTimeout(t)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(t),void this._change(t))}}),this._initSource(),this.menu=t("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay((function(){delete this.cancelBlur}));var i=this.menu.element[0];t(e.target).closest(".ui-menu-item").length||this._delay((function(){var e=this;this.document.one("mousedown",(function(n){n.target===e.element[0]||n.target===i||t.contains(i,n.target)||e.close()}))}))},menufocus:function(e,i){var n,a;return this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type))?(this.menu.blur(),void this.document.one("mousemove",(function(){t(e.target).trigger(e.originalEvent)}))):(a=i.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",e,{item:a})&&e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(a.value),void((n=i.item.attr("aria-label")||a.value)&&t.trim(n).length&&(this.liveRegion.children().hide(),t("<div>").text(n).appendTo(this.liveRegion))))},menuselect:function(t,e){var i=e.item.data("ui-autocomplete-item"),n=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=n,this._delay((function(){this.previous=n,this.selectedItem=i}))),!1!==this._trigger("select",t,{item:i})&&this._value(i.value),this.term=this._value(),this.close(t),this.selectedItem=i}}),this.liveRegion=t("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),"source"===t&&this._initSource(),"appendTo"===t&&this.menu.element.appendTo(this._appendTo()),"disabled"===t&&e&&this.xhr&&this.xhr.abort()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(".ui-front")),e.length||(e=this.document[0].body),e},_initSource:function(){var e,i,n=this;t.isArray(this.options.source)?(e=this.options.source,this.source=function(i,n){n(t.ui.autocomplete.filter(e,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(e,a){n.xhr&&n.xhr.abort(),n.xhr=t.ajax({url:i,data:e,dataType:"json",success:function(t){a(t)},error:function(){a([])}})}):this.source=this.options.source},_searchTimeout:function(t){clearTimeout(this.searching),this.searching=this._delay((function(){var e=this.term===this._value(),i=this.menu.element.is(":visible"),n=t.altKey||t.ctrlKey||t.metaKey||t.shiftKey;(!e||e&&!i&&!n)&&(this.selectedItem=null,this.search(null,t))}),this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):!1!==this._trigger("search",e)?this._search(t):void 0},_search:function(t){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:t},this._response())},_response:function(){var e=++this.requestIndex;return t.proxy((function(t){e===this.requestIndex&&this.__response(t),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")}),this)},__response:function(t){t&&(t=this._normalize(t)),this._trigger("response",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger("open")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",t))},_change:function(t){this.previous!==this._value()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:t.map(e,(function(e){return"string"==typeof e?{label:e,value:e}:t.extend({},e,{label:e.label||e.value,value:e.value||e.label})}))},_suggest:function(e){var i=this.menu.element.empty();this._renderMenu(i,e),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(t.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(e,i){var n=this;t.each(i,(function(t,i){n._renderItemData(e,i)}))},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-autocomplete-item",e)},_renderItem:function(e,i){return t("<li>").text(i.label).appendTo(e)},_move:function(t,e){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[t](e):void this.search(null,e)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(t,e),e.preventDefault())}}),t.extend(t.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,i){var n=RegExp(t.ui.autocomplete.escapeRegex(i),"i");return t.grep(e,(function(t){return n.test(t.label||t.value||t)}))}}),t.widget("ui.autocomplete",t.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(t){return t+(t>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.children().hide(),t("<div>").text(i).appendTo(this.liveRegion))}}),t.ui.autocomplete;var h,p,f="ui-button ui-widget ui-state-default ui-corner-all",m="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",g=function(){var e=t(this);setTimeout((function(){e.find(":ui-button").button("refresh")}),1)},v=function(e){var i=e.name,n=e.form,a=t([]);return i&&(i=i.replace(/'/g,"\\'"),a=n?t(n).find("[name='"+i+"'][type=radio]"):t("[name='"+i+"'][type=radio]",e.ownerDocument).filter((function(){return!this.form}))),a};t.widget("ui.button",{version:"1.11.4",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,g),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var e=this,i=this.options,n="checkbox"===this.type||"radio"===this.type,a=n?"":"ui-state-active";null===i.label&&(i.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(f).attr("role","button").bind("mouseenter"+this.eventNamespace,(function(){i.disabled||this===h&&t(this).addClass("ui-state-active")})).bind("mouseleave"+this.eventNamespace,(function(){i.disabled||t(this).removeClass(a)})).bind("click"+this.eventNamespace,(function(t){i.disabled&&(t.preventDefault(),t.stopImmediatePropagation())})),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),n&&this.element.bind("change"+this.eventNamespace,(function(){e.refresh()})),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,(function(){return!i.disabled&&void 0})):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,(function(){if(i.disabled)return!1;t(this).addClass("ui-state-active"),e.buttonElement.attr("aria-pressed","true");var n=e.element[0];v(n).not(n).map((function(){return t(this).button("widget")[0]})).removeClass("ui-state-active").attr("aria-pressed","false")})):(this.buttonElement.bind("mousedown"+this.eventNamespace,(function(){return!i.disabled&&(t(this).addClass("ui-state-active"),h=this,void e.document.one("mouseup",(function(){h=null})))})).bind("mouseup"+this.eventNamespace,(function(){return!i.disabled&&void t(this).removeClass("ui-state-active")})).bind("keydown"+this.eventNamespace,(function(e){return!i.disabled&&void((e.keyCode===t.ui.keyCode.SPACE||e.keyCode===t.ui.keyCode.ENTER)&&t(this).addClass("ui-state-active"))})).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,(function(){t(this).removeClass("ui-state-active")})),this.buttonElement.is("a")&&this.buttonElement.keyup((function(e){e.keyCode===t.ui.keyCode.SPACE&&t(this).click()}))),this._setOption("disabled",i.disabled),this._resetButton()},_determineButtonType:function(){var t,e,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(t=this.element.parents().last(),e="label[for='"+this.element.attr("id")+"']",this.buttonElement=t.find(e),this.buttonElement.length||(t=t.length?t.siblings():this.element.siblings(),this.buttonElement=t.filter(e),this.buttonElement.length||(this.buttonElement=t.find(e))),this.element.addClass("ui-helper-hidden-accessible"),(i=this.element.is(":checked"))&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(f+" ui-state-active "+m).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(t,e){return this._super(t,e),"disabled"===t?(this.widget().toggleClass("ui-state-disabled",!!e),this.element.prop("disabled",!!e),void(e&&("checkbox"===this.type||"radio"===this.type?this.buttonElement.removeClass("ui-state-focus"):this.buttonElement.removeClass("ui-state-focus ui-state-active")))):void this._resetButton()},refresh:function(){var e=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");e!==this.options.disabled&&this._setOption("disabled",e),"radio"===this.type?v(this.element[0]).each((function(){t(this).is(":checked")?t(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):t(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")})):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"!==this.type){var e=this.buttonElement.removeClass(m),i=t("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(e.empty()).text(),n=this.options.icons,a=n.primary&&n.secondary,s=[];n.primary||n.secondary?(this.options.text&&s.push("ui-button-text-icon"+(a?"s":n.primary?"-primary":"-secondary")),n.primary&&e.prepend("<span class='ui-button-icon-primary ui-icon "+n.primary+"'></span>"),n.secondary&&e.append("<span class='ui-button-icon-secondary ui-icon "+n.secondary+"'></span>"),this.options.text||(s.push(a?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||e.attr("title",t.trim(i)))):s.push("ui-button-text-only"),e.addClass(s.join(" "))}else this.options.label&&this.element.val(this.options.label)}}),t.widget("ui.buttonset",{version:"1.11.4",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(t,e){"disabled"===t&&this.buttons.button("option",t,e),this._super(t,e)},refresh:function(){var e="rtl"===this.element.css("direction"),i=this.element.find(this.options.items),n=i.filter(":ui-button");i.not(":ui-button").button(),n.button("refresh"),this.buttons=i.map((function(){return t(this).button("widget")[0]})).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(e?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(e?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map((function(){return t(this).button("widget")[0]})).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}}),t.ui.button,t.extend(t.ui,{datepicker:{version:"1.11.4"}}),t.extend(n.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return o(this._defaults,t||{}),this},_attachDatepicker:function(e,i){var n,a,s;a="div"===(n=e.nodeName.toLowerCase())||"span"===n,e.id||(this.uuid+=1,e.id="dp"+this.uuid),(s=this._newInst(t(e),a)).settings=t.extend({},i||{}),"input"===n?this._connectDatepicker(e,s):a&&this._inlineDatepicker(e,s)},_newInst:function(e,i){return{id:e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?a(t("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,i){var n=t(e);i.append=t([]),i.trigger=t([]),n.hasClass(this.markerClassName)||(this._attachments(n,i),n.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),t.data(e,"datepicker",i),i.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,i){var n,a,s,o=this._get(i,"appendText"),r=this._get(i,"isRTL");i.append&&i.append.remove(),o&&(i.append=t("<span class='"+this._appendClass+"'>"+o+"</span>"),e[r?"before":"after"](i.append)),e.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),("focus"===(n=this._get(i,"showOn"))||"both"===n)&&e.focus(this._showDatepicker),("button"===n||"both"===n)&&(a=this._get(i,"buttonText"),s=this._get(i,"buttonImage"),i.trigger=t(this._get(i,"buttonImageOnly")?t("<img/>").addClass(this._triggerClass).attr({src:s,alt:a,title:a}):t("<button type='button'></button>").addClass(this._triggerClass).html(s?t("<img/>").attr({src:s,alt:a,title:a}):a)),e[r?"before":"after"](i.trigger),i.trigger.click((function(){return t.datepicker._datepickerShowing&&t.datepicker._lastInput===e[0]?t.datepicker._hideDatepicker():t.datepicker._datepickerShowing&&t.datepicker._lastInput!==e[0]?(t.datepicker._hideDatepicker(),t.datepicker._showDatepicker(e[0])):t.datepicker._showDatepicker(e[0]),!1})))},_autoSize:function(t){if(this._get(t,"autoSize")&&!t.inline){var e,i,n,a,s=new Date(2009,11,20),o=this._get(t,"dateFormat");o.match(/[DM]/)&&(e=function(t){for(i=0,n=0,a=0;t.length>a;a++)t[a].length>i&&(i=t[a].length,n=a);return n},s.setMonth(e(this._get(t,o.match(/MM/)?"monthNames":"monthNamesShort"))),s.setDate(e(this._get(t,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-s.getDay())),t.input.attr("size",this._formatDate(t,s).length)}},_inlineDatepicker:function(e,i){var n=t(e);n.hasClass(this.markerClassName)||(n.addClass(this.markerClassName).append(i.dpDiv),t.data(e,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(e),i.dpDiv.css("display","block"))},_dialogDatepicker:function(e,i,n,a,s){var r,l,c,d,u,h=this._dialogInst;return h||(this.uuid+=1,r="dp"+this.uuid,this._dialogInput=t("<input type='text' id='"+r+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),t("body").append(this._dialogInput),(h=this._dialogInst=this._newInst(this._dialogInput,!1)).settings={},t.data(this._dialogInput[0],"datepicker",h)),o(h.settings,a||{}),i=i&&i.constructor===Date?this._formatDate(h,i):i,this._dialogInput.val(i),this._pos=s?s.length?s:[s.pageX,s.pageY]:null,this._pos||(l=document.documentElement.clientWidth,c=document.documentElement.clientHeight,d=document.documentElement.scrollLeft||document.body.scrollLeft,u=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[l/2-100+d,c/2-150+u]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),h.settings.onSelect=n,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),t.blockUI&&t.blockUI(this.dpDiv),t.data(this._dialogInput[0],"datepicker",h),this},_destroyDatepicker:function(e){var i,n=t(e),a=t.data(e,"datepicker");n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),t.removeData(e,"datepicker"),"input"===i?(a.append.remove(),a.trigger.remove(),n.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&n.removeClass(this.markerClassName).empty(),p===a&&(p=null))},_enableDatepicker:function(e){var i,n,a=t(e),s=t.data(e,"datepicker");a.hasClass(this.markerClassName)&&("input"===(i=e.nodeName.toLowerCase())?(e.disabled=!1,s.trigger.filter("button").each((function(){this.disabled=!1})).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&((n=a.children("."+this._inlineClass)).children().removeClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=t.map(this._disabledInputs,(function(t){return t===e?null:t})))},_disableDatepicker:function(e){var i,n,a=t(e),s=t.data(e,"datepicker");a.hasClass(this.markerClassName)&&("input"===(i=e.nodeName.toLowerCase())?(e.disabled=!0,s.trigger.filter("button").each((function(){this.disabled=!0})).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&((n=a.children("."+this._inlineClass)).children().addClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=t.map(this._disabledInputs,(function(t){return t===e?null:t})),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;this._disabledInputs.length>e;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(e){try{return t.data(e,"datepicker")}catch(t){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,i,n){var a,s,r,l,c=this._getInst(e);return 2===arguments.length&&"string"==typeof i?"defaults"===i?t.extend({},t.datepicker._defaults):c?"all"===i?t.extend({},c.settings):this._get(c,i):null:(a=i||{},"string"==typeof i&&((a={})[i]=n),void(c&&(this._curInst===c&&this._hideDatepicker(),s=this._getDateDatepicker(e,!0),r=this._getMinMaxDate(c,"min"),l=this._getMinMaxDate(c,"max"),o(c.settings,a),null!==r&&void 0!==a.dateFormat&&void 0===a.minDate&&(c.settings.minDate=this._formatDate(c,r)),null!==l&&void 0!==a.dateFormat&&void 0===a.maxDate&&(c.settings.maxDate=this._formatDate(c,l)),"disabled"in a&&(a.disabled?this._disableDatepicker(e):this._enableDatepicker(e)),this._attachments(t(e),c),this._autoSize(c),this._setDate(c,s),this._updateAlternate(c),this._updateDatepicker(c))))},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var i=this._getInst(t);i&&(this._setDate(i,e),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(t,e){var i=this._getInst(t);return i&&!i.inline&&this._setDateFromField(i,e),i?this._getDate(i):null},_doKeyDown:function(e){var i,n,a,s=t.datepicker._getInst(e.target),o=!0,r=s.dpDiv.is(".ui-datepicker-rtl");if(s._keyEvent=!0,t.datepicker._datepickerShowing)switch(e.keyCode){case 9:t.datepicker._hideDatepicker(),o=!1;break;case 13:return(a=t("td."+t.datepicker._dayOverClass+":not(."+t.datepicker._currentClass+")",s.dpDiv))[0]&&t.datepicker._selectDay(e.target,s.selectedMonth,s.selectedYear,a[0]),(i=t.datepicker._get(s,"onSelect"))?(n=t.datepicker._formatDate(s),i.apply(s.input?s.input[0]:null,[n,s])):t.datepicker._hideDatepicker(),!1;case 27:t.datepicker._hideDatepicker();break;case 33:t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(s,"stepBigMonths"):-t.datepicker._get(s,"stepMonths"),"M");break;case 34:t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(s,"stepBigMonths"):+t.datepicker._get(s,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&t.datepicker._clearDate(e.target),o=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&t.datepicker._gotoToday(e.target),o=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,r?1:-1,"D"),o=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(s,"stepBigMonths"):-t.datepicker._get(s,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,-7,"D"),o=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,r?-1:1,"D"),o=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(s,"stepBigMonths"):+t.datepicker._get(s,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,7,"D"),o=e.ctrlKey||e.metaKey;break;default:o=!1}else 36===e.keyCode&&e.ctrlKey?t.datepicker._showDatepicker(this):o=!1;o&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var i,n,a=t.datepicker._getInst(e.target);return t.datepicker._get(a,"constrainInput")?(i=t.datepicker._possibleChars(t.datepicker._get(a,"dateFormat")),n=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),e.ctrlKey||e.metaKey||" ">n||!i||i.indexOf(n)>-1):void 0},_doKeyUp:function(e){var i=t.datepicker._getInst(e.target);if(i.input.val()!==i.lastVal)try{t.datepicker.parseDate(t.datepicker._get(i,"dateFormat"),i.input?i.input.val():null,t.datepicker._getFormatConfig(i))&&(t.datepicker._setDateFromField(i),t.datepicker._updateAlternate(i),t.datepicker._updateDatepicker(i))}catch(t){}return!0},_showDatepicker:function(e){var i,n,a,s,r,l,c;("input"!==(e=e.target||e).nodeName.toLowerCase()&&(e=t("input",e.parentNode)[0]),t.datepicker._isDisabledDatepicker(e)||t.datepicker._lastInput===e)||(i=t.datepicker._getInst(e),t.datepicker._curInst&&t.datepicker._curInst!==i&&(t.datepicker._curInst.dpDiv.stop(!0,!0),i&&t.datepicker._datepickerShowing&&t.datepicker._hideDatepicker(t.datepicker._curInst.input[0])),!1!==(a=(n=t.datepicker._get(i,"beforeShow"))?n.apply(e,[e,i]):{})&&(o(i.settings,a),i.lastVal=null,t.datepicker._lastInput=e,t.datepicker._setDateFromField(i),t.datepicker._inDialog&&(e.value=""),t.datepicker._pos||(t.datepicker._pos=t.datepicker._findPos(e),t.datepicker._pos[1]+=e.offsetHeight),s=!1,t(e).parents().each((function(){return!(s|="fixed"===t(this).css("position"))})),r={left:t.datepicker._pos[0],top:t.datepicker._pos[1]},t.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),t.datepicker._updateDatepicker(i),r=t.datepicker._checkOffset(i,r,s),i.dpDiv.css({position:t.datepicker._inDialog&&t.blockUI?"static":s?"fixed":"absolute",display:"none",left:r.left+"px",top:r.top+"px"}),i.inline||(l=t.datepicker._get(i,"showAnim"),c=t.datepicker._get(i,"duration"),i.dpDiv.css("z-index",function(t){for(var e,i;t.length&&t[0]!==document;){if(("absolute"===(e=t.css("position"))||"relative"===e||"fixed"===e)&&(i=parseInt(t.css("zIndex"),10),!isNaN(i)&&0!==i))return i;t=t.parent()}return 0}(t(e))+1),t.datepicker._datepickerShowing=!0,t.effects&&t.effects.effect[l]?i.dpDiv.show(l,t.datepicker._get(i,"showOptions"),c):i.dpDiv[l||"show"](l?c:null),t.datepicker._shouldFocusInput(i)&&i.input.focus(),t.datepicker._curInst=i)))},_updateDatepicker:function(e){this.maxRows=4,p=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e);var i,n=this._getNumberOfMonths(e),a=n[1],o=e.dpDiv.find("."+this._dayOverClass+" a");o.length>0&&s.apply(o.get(0)),e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),a>1&&e.dpDiv.addClass("ui-datepicker-multi-"+a).css("width",17*a+"em"),e.dpDiv[(1!==n[0]||1!==n[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===t.datepicker._curInst&&t.datepicker._datepickerShowing&&t.datepicker._shouldFocusInput(e)&&e.input.focus(),e.yearshtml&&(i=e.yearshtml,setTimeout((function(){i===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),i=e.yearshtml=null}),0))},_shouldFocusInput:function(t){return t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&!t.input.is(":focus")},_checkOffset:function(e,i,n){var a=e.dpDiv.outerWidth(),s=e.dpDiv.outerHeight(),o=e.input?e.input.outerWidth():0,r=e.input?e.input.outerHeight():0,l=document.documentElement.clientWidth+(n?0:t(document).scrollLeft()),c=document.documentElement.clientHeight+(n?0:t(document).scrollTop());return i.left-=this._get(e,"isRTL")?a-o:0,i.left-=n&&i.left===e.input.offset().left?t(document).scrollLeft():0,i.top-=n&&i.top===e.input.offset().top+r?t(document).scrollTop():0,i.left-=Math.min(i.left,i.left+a>l&&l>a?Math.abs(i.left+a-l):0),i.top-=Math.min(i.top,i.top+s>c&&c>s?Math.abs(s+r):0),i},_findPos:function(e){for(var i,n=this._getInst(e),a=this._get(n,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||t.expr.filters.hidden(e));)e=e[a?"previousSibling":"nextSibling"];return[(i=t(e).offset()).left,i.top]},_hideDatepicker:function(e){var i,n,a,s,o=this._curInst;!o||e&&o!==t.data(e,"datepicker")||this._datepickerShowing&&(i=this._get(o,"showAnim"),n=this._get(o,"duration"),a=function(){t.datepicker._tidyDialog(o)},t.effects&&(t.effects.effect[i]||t.effects[i])?o.dpDiv.hide(i,t.datepicker._get(o,"showOptions"),n,a):o.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?n:null,a),i||a(),this._datepickerShowing=!1,(s=this._get(o,"onClose"))&&s.apply(o.input?o.input[0]:null,[o.input?o.input.val():"",o]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),t.blockUI&&(t.unblockUI(),t("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(t.datepicker._curInst){var i=t(e.target),n=t.datepicker._getInst(i[0]);(i[0].id!==t.datepicker._mainDivId&&0===i.parents("#"+t.datepicker._mainDivId).length&&!i.hasClass(t.datepicker.markerClassName)&&!i.closest("."+t.datepicker._triggerClass).length&&t.datepicker._datepickerShowing&&(!t.datepicker._inDialog||!t.blockUI)||i.hasClass(t.datepicker.markerClassName)&&t.datepicker._curInst!==n)&&t.datepicker._hideDatepicker()}},_adjustDate:function(e,i,n){var a=t(e),s=this._getInst(a[0]);this._isDisabledDatepicker(a[0])||(this._adjustInstDate(s,i+("M"===n?this._get(s,"showCurrentAtPos"):0),n),this._updateDatepicker(s))},_gotoToday:function(e){var i,n=t(e),a=this._getInst(n[0]);this._get(a,"gotoCurrent")&&a.currentDay?(a.selectedDay=a.currentDay,a.drawMonth=a.selectedMonth=a.currentMonth,a.drawYear=a.selectedYear=a.currentYear):(i=new Date,a.selectedDay=i.getDate(),a.drawMonth=a.selectedMonth=i.getMonth(),a.drawYear=a.selectedYear=i.getFullYear()),this._notifyChange(a),this._adjustDate(n)},_selectMonthYear:function(e,i,n){var a=t(e),s=this._getInst(a[0]);s["selected"+("M"===n?"Month":"Year")]=s["draw"+("M"===n?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(s),this._adjustDate(a)},_selectDay:function(e,i,n,a){var s,o=t(e);t(a).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||((s=this._getInst(o[0])).selectedDay=s.currentDay=t("a",a).html(),s.selectedMonth=s.currentMonth=i,s.selectedYear=s.currentYear=n,this._selectDate(e,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear)))},_clearDate:function(e){var i=t(e);this._selectDate(i,"")},_selectDate:function(e,i){var n,a=t(e),s=this._getInst(a[0]);i=null!=i?i:this._formatDate(s),s.input&&s.input.val(i),this._updateAlternate(s),(n=this._get(s,"onSelect"))?n.apply(s.input?s.input[0]:null,[i,s]):s.input&&s.input.trigger("change"),s.inline?this._updateDatepicker(s):(this._hideDatepicker(),this._lastInput=s.input[0],"object"!=typeof s.input[0]&&s.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var i,n,a,s=this._get(e,"altField");s&&(i=this._get(e,"altFormat")||this._get(e,"dateFormat"),n=this._getDate(e),a=this.formatDate(i,n,this._getFormatConfig(e)),t(s).each((function(){t(this).val(a)})))},noWeekends:function(t){var e=t.getDay();return[e>0&&6>e,""]},iso8601Week:function(t){var e,i=new Date(t.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),e=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((e-i)/864e5)/7)+1},parseDate:function(e,i,n){if(null==e||null==i)throw"Invalid arguments";if(""===(i="object"==typeof i?""+i:i+""))return null;var a,s,o,r,l=0,c=(n?n.shortYearCutoff:null)||this._defaults.shortYearCutoff,d="string"!=typeof c?c:(new Date).getFullYear()%100+parseInt(c,10),u=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,h=(n?n.dayNames:null)||this._defaults.dayNames,p=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,f=(n?n.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,v=-1,b=-1,y=!1,_=function(t){var i=e.length>a+1&&e.charAt(a+1)===t;return i&&a++,i},x=function(t){var e=_(t),n="@"===t?14:"!"===t?20:"y"===t&&e?4:"o"===t?3:2,a=RegExp("^\\d{"+("y"===t?n:1)+","+n+"}"),s=i.substring(l).match(a);if(!s)throw"Missing number at position "+l;return l+=s[0].length,parseInt(s[0],10)},w=function(e,n,a){var s=-1,o=t.map(_(e)?a:n,(function(t,e){return[[e,t]]})).sort((function(t,e){return-(t[1].length-e[1].length)}));if(t.each(o,(function(t,e){var n=e[1];return i.substr(l,n.length).toLowerCase()===n.toLowerCase()?(s=e[0],l+=n.length,!1):void 0})),-1!==s)return s+1;throw"Unknown name at position "+l},C=function(){if(i.charAt(l)!==e.charAt(a))throw"Unexpected literal at position "+l;l++};for(a=0;e.length>a;a++)if(y)"'"!==e.charAt(a)||_("'")?C():y=!1;else switch(e.charAt(a)){case"d":v=x("d");break;case"D":w("D",u,h);break;case"o":b=x("o");break;case"m":g=x("m");break;case"M":g=w("M",p,f);break;case"y":m=x("y");break;case"@":m=(r=new Date(x("@"))).getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case"!":m=(r=new Date((x("!")-this._ticksTo1970)/1e4)).getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case"'":_("'")?C():y=!0;break;default:C()}if(i.length>l&&(o=i.substr(l),!/^\s+/.test(o)))throw"Extra/unparsed characters found in date: "+o;if(-1===m?m=(new Date).getFullYear():100>m&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(d>=m?0:-100)),b>-1)for(g=1,v=b;!((s=this._getDaysInMonth(m,g-1))>=v);)g++,v-=s;if((r=this._daylightSavingAdjust(new Date(m,g-1,v))).getFullYear()!==m||r.getMonth()+1!==g||r.getDate()!==v)throw"Invalid date";return r},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864e9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(t,e,i){if(!e)return"";var n,a=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,s=(i?i.dayNames:null)||this._defaults.dayNames,o=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,l=function(e){var i=t.length>n+1&&t.charAt(n+1)===e;return i&&n++,i},c=function(t,e,i){var n=""+e;if(l(t))for(;i>n.length;)n="0"+n;return n},d=function(t,e,i,n){return l(t)?n[e]:i[e]},u="",h=!1;if(e)for(n=0;t.length>n;n++)if(h)"'"!==t.charAt(n)||l("'")?u+=t.charAt(n):h=!1;else switch(t.charAt(n)){case"d":u+=c("d",e.getDate(),2);break;case"D":u+=d("D",e.getDay(),a,s);break;case"o":u+=c("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=c("m",e.getMonth()+1,2);break;case"M":u+=d("M",e.getMonth(),o,r);break;case"y":u+=l("y")?e.getFullYear():(10>e.getYear()%100?"0":"")+e.getYear()%100;break;case"@":u+=e.getTime();break;case"!":u+=1e4*e.getTime()+this._ticksTo1970;break;case"'":l("'")?u+="'":h=!0;break;default:u+=t.charAt(n)}return u},_possibleChars:function(t){var e,i="",n=!1,a=function(i){var n=t.length>e+1&&t.charAt(e+1)===i;return n&&e++,n};for(e=0;t.length>e;e++)if(n)"'"!==t.charAt(e)||a("'")?i+=t.charAt(e):n=!1;else switch(t.charAt(e)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":a("'")?i+="'":n=!0;break;default:i+=t.charAt(e)}return i},_get:function(t,e){return void 0!==t.settings[e]?t.settings[e]:this._defaults[e]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var i=this._get(t,"dateFormat"),n=t.lastVal=t.input?t.input.val():null,a=this._getDefaultDate(t),s=a,o=this._getFormatConfig(t);try{s=this.parseDate(i,n,o)||a}catch(t){n=e?"":n}t.selectedDay=s.getDate(),t.drawMonth=t.selectedMonth=s.getMonth(),t.drawYear=t.selectedYear=s.getFullYear(),t.currentDay=n?s.getDate():0,t.currentMonth=n?s.getMonth():0,t.currentYear=n?s.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(e,i,n){var a,s,o=null==i||""===i?n:"string"==typeof i?function(i){try{return t.datepicker.parseDate(t.datepicker._get(e,"dateFormat"),i,t.datepicker._getFormatConfig(e))}catch(t){}for(var n=(i.toLowerCase().match(/^c/)?t.datepicker._getDate(e):null)||new Date,a=n.getFullYear(),s=n.getMonth(),o=n.getDate(),r=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=r.exec(i);l;){switch(l[2]||"d"){case"d":case"D":o+=parseInt(l[1],10);break;case"w":case"W":o+=7*parseInt(l[1],10);break;case"m":case"M":s+=parseInt(l[1],10),o=Math.min(o,t.datepicker._getDaysInMonth(a,s));break;case"y":case"Y":a+=parseInt(l[1],10),o=Math.min(o,t.datepicker._getDaysInMonth(a,s))}l=r.exec(i)}return new Date(a,s,o)}(i):"number"==typeof i?isNaN(i)?n:(a=i,(s=new Date).setDate(s.getDate()+a),s):new Date(i.getTime());return(o=o&&"Invalid Date"==""+o?n:o)&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(t){return t?(t.setHours(t.getHours()>12?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var n=!e,a=t.selectedMonth,s=t.selectedYear,o=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=o.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=o.getMonth(),t.drawYear=t.selectedYear=t.currentYear=o.getFullYear(),a===t.selectedMonth&&s===t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(n?"":this._formatDate(t))},_getDate:function(t){return!t.currentYear||t.input&&""===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay))},_attachHandlers:function(e){var i=this._get(e,"stepMonths"),n="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map((function(){var e={prev:function(){t.datepicker._adjustDate(n,-i,"M")},next:function(){t.datepicker._adjustDate(n,+i,"M")},hide:function(){t.datepicker._hideDatepicker()},today:function(){t.datepicker._gotoToday(n)},selectDay:function(){return t.datepicker._selectDay(n,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return t.datepicker._selectMonthYear(n,this,"M"),!1},selectYear:function(){return t.datepicker._selectMonthYear(n,this,"Y"),!1}};t(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])}))},_generateHTML:function(t){var e,i,n,a,s,o,r,l,c,d,u,h,p,f,m,g,v,b,y,_,x,w,C,k,$,S,T,I,D,A,P,O,E,M,L,j,R,N,B,F=new Date,H=this._daylightSavingAdjust(new Date(F.getFullYear(),F.getMonth(),F.getDate())),z=this._get(t,"isRTL"),W=this._get(t,"showButtonPanel"),U=this._get(t,"hideIfNoPrevNext"),q=this._get(t,"navigationAsDateFormat"),Y=this._getNumberOfMonths(t),V=this._get(t,"showCurrentAtPos"),G=this._get(t,"stepMonths"),K=1!==Y[0]||1!==Y[1],X=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),Q=this._getMinMaxDate(t,"min"),J=this._getMinMaxDate(t,"max"),Z=t.drawMonth-V,tt=t.drawYear;if(0>Z&&(Z+=12,tt--),J)for(e=this._daylightSavingAdjust(new Date(J.getFullYear(),J.getMonth()-Y[0]*Y[1]+1,J.getDate())),e=Q&&Q>e?Q:e;this._daylightSavingAdjust(new Date(tt,Z,1))>e;)0>--Z&&(Z=11,tt--);for(t.drawMonth=Z,t.drawYear=tt,i=this._get(t,"prevText"),i=q?this.formatDate(i,this._daylightSavingAdjust(new Date(tt,Z-G,1)),this._getFormatConfig(t)):i,n=this._canAdjustMonth(t,-1,tt,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(z?"e":"w")+"'>"+i+"</span></a>":U?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(z?"e":"w")+"'>"+i+"</span></a>",a=this._get(t,"nextText"),a=q?this.formatDate(a,this._daylightSavingAdjust(new Date(tt,Z+G,1)),this._getFormatConfig(t)):a,s=this._canAdjustMonth(t,1,tt,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+a+"'><span class='ui-icon ui-icon-circle-triangle-"+(z?"w":"e")+"'>"+a+"</span></a>":U?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+a+"'><span class='ui-icon ui-icon-circle-triangle-"+(z?"w":"e")+"'>"+a+"</span></a>",o=this._get(t,"currentText"),r=this._get(t,"gotoCurrent")&&t.currentDay?X:H,o=q?this.formatDate(o,r,this._getFormatConfig(t)):o,l=t.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(t,"closeText")+"</button>",c=W?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(z?l:"")+(this._isInRange(t,r)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(z?"":l)+"</div>":"",d=parseInt(this._get(t,"firstDay"),10),d=isNaN(d)?0:d,u=this._get(t,"showWeek"),h=this._get(t,"dayNames"),p=this._get(t,"dayNamesMin"),f=this._get(t,"monthNames"),m=this._get(t,"monthNamesShort"),g=this._get(t,"beforeShowDay"),v=this._get(t,"showOtherMonths"),b=this._get(t,"selectOtherMonths"),y=this._getDefaultDate(t),_="",w=0;Y[0]>w;w++){for(C="",this.maxRows=4,k=0;Y[1]>k;k++){if($=this._daylightSavingAdjust(new Date(tt,Z,t.selectedDay)),S=" ui-corner-all",T="",K){if(T+="<div class='ui-datepicker-group",Y[1]>1)switch(k){case 0:T+=" ui-datepicker-group-first",S=" ui-corner-"+(z?"right":"left");break;case Y[1]-1:T+=" ui-datepicker-group-last",S=" ui-corner-"+(z?"left":"right");break;default:T+=" ui-datepicker-group-middle",S=""}T+="'>"}for(T+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+S+"'>"+(/all|left/.test(S)&&0===w?z?s:n:"")+(/all|right/.test(S)&&0===w?z?n:s:"")+this._generateMonthYearHeader(t,Z,tt,Q,J,w>0||k>0,f,m)+"</div><table class='ui-datepicker-calendar'><thead><tr>",I=u?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",x=0;7>x;x++)I+="<th scope='col'"+((x+d+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+h[D=(x+d)%7]+"'>"+p[D]+"</span></th>";for(T+=I+"</tr></thead><tbody>",A=this._getDaysInMonth(tt,Z),tt===t.selectedYear&&Z===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,A)),P=(this._getFirstDayOfMonth(tt,Z)-d+7)%7,O=Math.ceil((P+A)/7),E=K&&this.maxRows>O?this.maxRows:O,this.maxRows=E,M=this._daylightSavingAdjust(new Date(tt,Z,1-P)),L=0;E>L;L++){for(T+="<tr>",j=u?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(M)+"</td>":"",x=0;7>x;x++)R=g?g.apply(t.input?t.input[0]:null,[M]):[!0,""],B=(N=M.getMonth()!==Z)&&!b||!R[0]||Q&&Q>M||J&&M>J,j+="<td class='"+((x+d+6)%7>=5?" ui-datepicker-week-end":"")+(N?" ui-datepicker-other-month":"")+(M.getTime()===$.getTime()&&Z===t.selectedMonth&&t._keyEvent||y.getTime()===M.getTime()&&y.getTime()===$.getTime()?" "+this._dayOverClass:"")+(B?" "+this._unselectableClass+" ui-state-disabled":"")+(N&&!v?"":" "+R[1]+(M.getTime()===X.getTime()?" "+this._currentClass:"")+(M.getTime()===H.getTime()?" ui-datepicker-today":""))+"'"+(N&&!v||!R[2]?"":" title='"+R[2].replace(/'/g,"&#39;")+"'")+(B?"":" data-handler='selectDay' data-event='click' data-month='"+M.getMonth()+"' data-year='"+M.getFullYear()+"'")+">"+(N&&!v?"&#xa0;":B?"<span class='ui-state-default'>"+M.getDate()+"</span>":"<a class='ui-state-default"+(M.getTime()===H.getTime()?" ui-state-highlight":"")+(M.getTime()===X.getTime()?" ui-state-active":"")+(N?" ui-priority-secondary":"")+"' href='#'>"+M.getDate()+"</a>")+"</td>",M.setDate(M.getDate()+1),M=this._daylightSavingAdjust(M);T+=j+"</tr>"}++Z>11&&(Z=0,tt++),C+=T+="</tbody></table>"+(K?"</div>"+(Y[0]>0&&k===Y[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"")}_+=C}return _+=c,t._keyEvent=!1,_},_generateMonthYearHeader:function(t,e,i,n,a,s,o,r){var l,c,d,u,h,p,f,m,g=this._get(t,"changeMonth"),v=this._get(t,"changeYear"),b=this._get(t,"showMonthAfterYear"),y="<div class='ui-datepicker-title'>",_="";if(s||!g)_+="<span class='ui-datepicker-month'>"+o[e]+"</span>";else{for(l=n&&n.getFullYear()===i,c=a&&a.getFullYear()===i,_+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",d=0;12>d;d++)(!l||d>=n.getMonth())&&(!c||a.getMonth()>=d)&&(_+="<option value='"+d+"'"+(d===e?" selected='selected'":"")+">"+r[d]+"</option>");_+="</select>"}if(b||(y+=_+(!s&&g&&v?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",s||!v)y+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(u=this._get(t,"yearRange").split(":"),h=(new Date).getFullYear(),f=(p=function(t){var e=t.match(/c[+\-].*/)?i+parseInt(t.substring(1),10):t.match(/[+\-].*/)?h+parseInt(t,10):parseInt(t,10);return isNaN(e)?h:e})(u[0]),m=Math.max(f,p(u[1]||"")),f=n?Math.max(f,n.getFullYear()):f,m=a?Math.min(m,a.getFullYear()):m,t.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";m>=f;f++)t.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";t.yearshtml+="</select>",y+=t.yearshtml,t.yearshtml=null}return y+=this._get(t,"yearSuffix"),b&&(y+=(!s&&g&&v?"":"&#xa0;")+_),y+"</div>"},_adjustInstDate:function(t,e,i){var n=t.drawYear+("Y"===i?e:0),a=t.drawMonth+("M"===i?e:0),s=Math.min(t.selectedDay,this._getDaysInMonth(n,a))+("D"===i?e:0),o=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(n,a,s)));t.selectedDay=o.getDate(),t.drawMonth=t.selectedMonth=o.getMonth(),t.drawYear=t.selectedYear=o.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,"min"),n=this._getMinMaxDate(t,"max"),a=i&&i>e?i:e;return n&&a>n?n:a},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,n){var a=this._getNumberOfMonths(t),s=this._daylightSavingAdjust(new Date(i,n+(0>e?e:a[0]*a[1]),1));return 0>e&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(t,s)},_isInRange:function(t,e){var i,n,a=this._getMinMaxDate(t,"min"),s=this._getMinMaxDate(t,"max"),o=null,r=null,l=this._get(t,"yearRange");return l&&(i=l.split(":"),n=(new Date).getFullYear(),o=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(o+=n),i[1].match(/[+\-].*/)&&(r+=n)),(!a||e.getTime()>=a.getTime())&&(!s||e.getTime()<=s.getTime())&&(!o||e.getFullYear()>=o)&&(!r||r>=e.getFullYear())},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return{shortYearCutoff:e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,n){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var a=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(n,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),a,this._getFormatConfig(t))}}),t.fn.datepicker=function(e){if(!this.length)return this;t.datepicker.initialized||(t(document).mousedown(t.datepicker._checkExternalClick),t.datepicker.initialized=!0),0===t("#"+t.datepicker._mainDivId).length&&t("body").append(t.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!==e&&"getDate"!==e&&"widget"!==e?"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i)):this.each((function(){"string"==typeof e?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this].concat(i)):t.datepicker._attachDatepicker(this,e)})):t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i))},t.datepicker=new n,t.datepicker.initialized=!1,t.datepicker.uuid=(new Date).getTime(),t.datepicker.version="1.11.4",t.datepicker,t.widget("ui.draggable",t.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(e){var i=this.options;return this._blurActiveElement(e),!(this.helper||i.disabled||t(e.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(e),!!this.handle&&(this._blockFrames(!0===i.iframeFix?"iframe":i.iframeFix),!0))},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map((function(){var e=t(this);return t("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]}))},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var i=this.document[0];if(this.handleElement.is(e.target))try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&t(i.activeElement).blur()}catch(t){}},_mouseStart:function(e){var i=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter((function(){return"fixed"===t(this).css("position")})).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),!1===this._trigger("start",e)?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._normalizeRightBottom(),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(e,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var n=this._uiHash();if(!1===this._trigger("drag",e,n))return this._mouseUp({}),!1;this.position=n.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var i=this,n=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(n=t.ui.ddmanager.drop(this,e)),this.dropped&&(n=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!n||"valid"===this.options.revert&&n||!0===this.options.revert||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),(function(){!1!==i._trigger("stop",e)&&i._clear()})):!1!==this._trigger("stop",e)&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.focus(),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return!this.options.handle||!!t(e.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(e){var i=this.options,n=t.isFunction(i.helper),a=n?t(i.helper.apply(this.element[0],[e])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return a.parents("body").length||a.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),n&&a[0]===this.element[0]&&this._setPositionRelative(),a[0]===this.element[0]||/(fixed|absolute)/.test(a.css("position"))||a.css("position","absolute"),a},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,n,a=this.options,s=this.document[0];return this.relativeContainer=null,a.containment?"window"===a.containment?void(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===a.containment?void(this.containment=[0,0,t(s).width()-this.helperProportions.width-this.margins.left,(t(s).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):a.containment.constructor===Array?void(this.containment=a.containment):("parent"===a.containment&&(a.containment=this.helper[0].parentNode),void((n=(i=t(a.containment))[0])&&(e=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(e?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i))):void(this.containment=null)},_convertPositionTo:function(t,e){e||(e=this.position);var i="absolute"===t?1:-1,n=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:n?0:this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:n?0:this.offset.scroll.left)*i}},_generatePosition:function(t,e){var i,n,a,s,o=this.options,r=this._isRootNode(this.scrollParent[0]),l=t.pageX,c=t.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(this.relativeContainer?(n=this.relativeContainer.offset(),i=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):i=this.containment,t.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(c=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(c=i[3]+this.offset.click.top)),o.grid&&(a=o.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,c=i?a-this.offset.click.top>=i[1]||a-this.offset.click.top>i[3]?a:a-this.offset.click.top>=i[1]?a-o.grid[1]:a+o.grid[1]:a,s=o.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,l=i?s-this.offset.click.left>=i[0]||s-this.offset.click.left>i[2]?s:s-this.offset.click.left>=i[0]?s-o.grid[0]:s+o.grid[0]:s),"y"===o.axis&&(l=this.originalPageX),"x"===o.axis&&(c=this.originalPageY)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(e,i,n){return n=n||this._uiHash(),t.ui.plugin.call(this,e,[i,n,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),n.offset=this.positionAbs),t.Widget.prototype._trigger.call(this,e,i,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i,n){var a=t.extend({},i,{item:n.element});n.sortables=[],t(n.options.connectToSortable).each((function(){var i=t(this).sortable("instance");i&&!i.options.disabled&&(n.sortables.push(i),i.refreshPositions(),i._trigger("activate",e,a))}))},stop:function(e,i,n){var a=t.extend({},i,{item:n.element});n.cancelHelperRemoval=!1,t.each(n.sortables,(function(){var t=this;t.isOver?(t.isOver=0,n.cancelHelperRemoval=!0,t.cancelHelperRemoval=!1,t._storedCSS={position:t.placeholder.css("position"),top:t.placeholder.css("top"),left:t.placeholder.css("left")},t._mouseStop(e),t.options.helper=t.options._helper):(t.cancelHelperRemoval=!0,t._trigger("deactivate",e,a))}))},drag:function(e,i,n){t.each(n.sortables,(function(){var a=!1,s=this;s.positionAbs=n.positionAbs,s.helperProportions=n.helperProportions,s.offset.click=n.offset.click,s._intersectsWith(s.containerCache)&&(a=!0,t.each(n.sortables,(function(){return this.positionAbs=n.positionAbs,this.helperProportions=n.helperProportions,this.offset.click=n.offset.click,this!==s&&this._intersectsWith(this.containerCache)&&t.contains(s.element[0],this.element[0])&&(a=!1),a}))),a?(s.isOver||(s.isOver=1,n._parent=i.helper.parent(),s.currentItem=i.helper.appendTo(s.element).data("ui-sortable-item",!0),s.options._helper=s.options.helper,s.options.helper=function(){return i.helper[0]},e.target=s.currentItem[0],s._mouseCapture(e,!0),s._mouseStart(e,!0,!0),s.offset.click.top=n.offset.click.top,s.offset.click.left=n.offset.click.left,s.offset.parent.left-=n.offset.parent.left-s.offset.parent.left,s.offset.parent.top-=n.offset.parent.top-s.offset.parent.top,n._trigger("toSortable",e),n.dropped=s.element,t.each(n.sortables,(function(){this.refreshPositions()})),n.currentItem=n.element,s.fromOutside=n),s.currentItem&&(s._mouseDrag(e),i.position=s.position)):s.isOver&&(s.isOver=0,s.cancelHelperRemoval=!0,s.options._revert=s.options.revert,s.options.revert=!1,s._trigger("out",e,s._uiHash(s)),s._mouseStop(e,!0),s.options.revert=s.options._revert,s.options.helper=s.options._helper,s.placeholder&&s.placeholder.remove(),i.helper.appendTo(n._parent),n._refreshOffsets(e),i.position=n._generatePosition(e,!0),n._trigger("fromSortable",e),n.dropped=!1,t.each(n.sortables,(function(){this.refreshPositions()})))}))}}),t.ui.plugin.add("draggable","cursor",{start:function(e,i,n){var a=t("body"),s=n.options;a.css("cursor")&&(s._cursor=a.css("cursor")),a.css("cursor",s.cursor)},stop:function(e,i,n){var a=n.options;a._cursor&&t("body").css("cursor",a._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,i,n){var a=t(i.helper),s=n.options;a.css("opacity")&&(s._opacity=a.css("opacity")),a.css("opacity",s.opacity)},stop:function(e,i,n){var a=n.options;a._opacity&&t(i.helper).css("opacity",a._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(t,e,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(e,i,n){var a=n.options,s=!1,o=n.scrollParentNotHidden[0],r=n.document[0];o!==r&&"HTML"!==o.tagName?(a.axis&&"x"===a.axis||(n.overflowOffset.top+o.offsetHeight-e.pageY<a.scrollSensitivity?o.scrollTop=s=o.scrollTop+a.scrollSpeed:e.pageY-n.overflowOffset.top<a.scrollSensitivity&&(o.scrollTop=s=o.scrollTop-a.scrollSpeed)),a.axis&&"y"===a.axis||(n.overflowOffset.left+o.offsetWidth-e.pageX<a.scrollSensitivity?o.scrollLeft=s=o.scrollLeft+a.scrollSpeed:e.pageX-n.overflowOffset.left<a.scrollSensitivity&&(o.scrollLeft=s=o.scrollLeft-a.scrollSpeed))):(a.axis&&"x"===a.axis||(e.pageY-t(r).scrollTop()<a.scrollSensitivity?s=t(r).scrollTop(t(r).scrollTop()-a.scrollSpeed):t(window).height()-(e.pageY-t(r).scrollTop())<a.scrollSensitivity&&(s=t(r).scrollTop(t(r).scrollTop()+a.scrollSpeed))),a.axis&&"y"===a.axis||(e.pageX-t(r).scrollLeft()<a.scrollSensitivity?s=t(r).scrollLeft(t(r).scrollLeft()-a.scrollSpeed):t(window).width()-(e.pageX-t(r).scrollLeft())<a.scrollSensitivity&&(s=t(r).scrollLeft(t(r).scrollLeft()+a.scrollSpeed)))),!1!==s&&t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(n,e)}}),t.ui.plugin.add("draggable","snap",{start:function(e,i,n){var a=n.options;n.snapElements=[],t(a.snap.constructor!==String?a.snap.items||":data(ui-draggable)":a.snap).each((function(){var e=t(this),i=e.offset();this!==n.element[0]&&n.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:i.top,left:i.left})}))},drag:function(e,i,n){var a,s,o,r,l,c,d,u,h,p,f=n.options,m=f.snapTolerance,g=i.offset.left,v=g+n.helperProportions.width,b=i.offset.top,y=b+n.helperProportions.height;for(h=n.snapElements.length-1;h>=0;h--)c=(l=n.snapElements[h].left-n.margins.left)+n.snapElements[h].width,u=(d=n.snapElements[h].top-n.margins.top)+n.snapElements[h].height,l-m>v||g>c+m||d-m>y||b>u+m||!t.contains(n.snapElements[h].item.ownerDocument,n.snapElements[h].item)?(n.snapElements[h].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,e,t.extend(n._uiHash(),{snapItem:n.snapElements[h].item})),n.snapElements[h].snapping=!1):("inner"!==f.snapMode&&(a=m>=Math.abs(d-y),s=m>=Math.abs(u-b),o=m>=Math.abs(l-v),r=m>=Math.abs(c-g),a&&(i.position.top=n._convertPositionTo("relative",{top:d-n.helperProportions.height,left:0}).top),s&&(i.position.top=n._convertPositionTo("relative",{top:u,left:0}).top),o&&(i.position.left=n._convertPositionTo("relative",{top:0,left:l-n.helperProportions.width}).left),r&&(i.position.left=n._convertPositionTo("relative",{top:0,left:c}).left)),p=a||s||o||r,"outer"!==f.snapMode&&(a=m>=Math.abs(d-b),s=m>=Math.abs(u-y),o=m>=Math.abs(l-g),r=m>=Math.abs(c-v),a&&(i.position.top=n._convertPositionTo("relative",{top:d,left:0}).top),s&&(i.position.top=n._convertPositionTo("relative",{top:u-n.helperProportions.height,left:0}).top),o&&(i.position.left=n._convertPositionTo("relative",{top:0,left:l}).left),r&&(i.position.left=n._convertPositionTo("relative",{top:0,left:c-n.helperProportions.width}).left)),!n.snapElements[h].snapping&&(a||s||o||r||p)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,e,t.extend(n._uiHash(),{snapItem:n.snapElements[h].item})),n.snapElements[h].snapping=a||s||o||r||p)}}),t.ui.plugin.add("draggable","stack",{start:function(e,i,n){var a,s=n.options,o=t.makeArray(t(s.stack)).sort((function(e,i){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(i).css("zIndex"),10)||0)}));o.length&&(a=parseInt(t(o[0]).css("zIndex"),10)||0,t(o).each((function(e){t(this).css("zIndex",a+e)})),this.css("zIndex",a+o.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,i,n){var a=t(i.helper),s=n.options;a.css("zIndex")&&(s._zIndex=a.css("zIndex")),a.css("zIndex",s.zIndex)},stop:function(e,i,n){var a=n.options;a._zIndex&&t(i.helper).css("zIndex",a._zIndex)}}),t.ui.draggable,t.widget("ui.resizable",t.ui.mouse,{version:"1.11.4",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(t){return parseInt(t,10)||0},_isNumber:function(t){return!isNaN(parseInt(t,10))},_hasScroll:function(e,i){if("hidden"===t(e).css("overflow"))return!1;var n=i&&"left"===i?"scrollLeft":"scrollTop",a=!1;return e[n]>0||(e[n]=1,a=e[n]>0,e[n]=0,a)},_create:function(){var e,i,n,a,s=this,o=this.options;if(this.element.addClass("ui-resizable"),t.extend(this,{_aspectRatio:!!o.aspectRatio,aspectRatio:o.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:o.helper||o.ghost||o.animate?o.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(t("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=o.handles||(t(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=t(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),e=this.handles.split(","),this.handles={},i=0;e.length>i;i++)n=t.trim(e[i]),(a=t("<div class='ui-resizable-handle "+("ui-resizable-"+n)+"'></div>")).css({zIndex:o.zIndex}),"se"===n&&a.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[n]=".ui-resizable-"+n,this.element.append(a);this._renderAxis=function(e){var i,n,a,o;for(i in e=e||this.element,this.handles)this.handles[i].constructor===String?this.handles[i]=this.element.children(this.handles[i]).first().show():(this.handles[i].jquery||this.handles[i].nodeType)&&(this.handles[i]=t(this.handles[i]),this._on(this.handles[i],{mousedown:s._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(n=t(this.handles[i],this.element),o=/sw|ne|nw|se|n|s/.test(i)?n.outerHeight():n.outerWidth(),a=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),e.css(a,o),this._proportionallyResize()),this._handles=this._handles.add(this.handles[i])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.mouseover((function(){s.resizing||(this.className&&(a=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),s.axis=a&&a[1]?a[1]:"se")})),o.autoHide&&(this._handles.hide(),t(this.element).addClass("ui-resizable-autohide").mouseenter((function(){o.disabled||(t(this).removeClass("ui-resizable-autohide"),s._handles.show())})).mouseleave((function(){o.disabled||s.resizing||(t(this).addClass("ui-resizable-autohide"),s._handles.hide())}))),this._mouseInit()},_destroy:function(){this._mouseDestroy();var e,i=function(e){t(e).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(e){var i,n,a=!1;for(i in this.handles)((n=t(this.handles[i])[0])===e.target||t.contains(n,e.target))&&(a=!0);return!this.options.disabled&&a},_mouseStart:function(e){var i,n,a,s=this.options,o=this.element;return this.resizing=!0,this._renderProxy(),i=this._num(this.helper.css("left")),n=this._num(this.helper.css("top")),s.containment&&(i+=t(s.containment).scrollLeft()||0,n+=t(s.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:n},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:o.width(),height:o.height()},this.originalSize=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()},this.sizeDiff={width:o.outerWidth()-o.width(),height:o.outerHeight()-o.height()},this.originalPosition={left:i,top:n},this.originalMousePosition={left:e.pageX,top:e.pageY},this.aspectRatio="number"==typeof s.aspectRatio?s.aspectRatio:this.originalSize.width/this.originalSize.height||1,a=t(".ui-resizable-"+this.axis).css("cursor"),t("body").css("cursor","auto"===a?this.axis+"-resize":a),o.addClass("ui-resizable-resizing"),this._propagate("start",e),!0},_mouseDrag:function(e){var i,n,a=this.originalMousePosition,s=this.axis,o=e.pageX-a.left||0,r=e.pageY-a.top||0,l=this._change[s];return this._updatePrevProperties(),!!l&&(i=l.apply(this,[e,o,r]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(i=this._updateRatio(i,e)),i=this._respectSize(i,e),this._updateCache(i),this._propagate("resize",e),n=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),t.isEmptyObject(n)||(this._updatePrevProperties(),this._trigger("resize",e,this.ui()),this._applyChanges()),!1)},_mouseStop:function(e){this.resizing=!1;var i,n,a,s,o,r,l,c=this.options,d=this;return this._helper&&(a=(n=(i=this._proportionallyResizeElements).length&&/textarea/i.test(i[0].nodeName))&&this._hasScroll(i[0],"left")?0:d.sizeDiff.height,s=n?0:d.sizeDiff.width,o={width:d.helper.width()-s,height:d.helper.height()-a},r=parseInt(d.element.css("left"),10)+(d.position.left-d.originalPosition.left)||null,l=parseInt(d.element.css("top"),10)+(d.position.top-d.originalPosition.top)||null,c.animate||this.element.css(t.extend(o,{top:l,left:r})),d.helper.height(d.size.height),d.helper.width(d.size.width),this._helper&&!c.animate&&this._proportionallyResize()),t("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(t.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(t.height=this.size.height+"px"),this.helper.css(t),t},_updateVirtualBoundaries:function(t){var e,i,n,a,s,o=this.options;s={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||t)&&(e=s.minHeight*this.aspectRatio,n=s.minWidth/this.aspectRatio,i=s.maxHeight*this.aspectRatio,a=s.maxWidth/this.aspectRatio,e>s.minWidth&&(s.minWidth=e),n>s.minHeight&&(s.minHeight=n),s.maxWidth>i&&(s.maxWidth=i),s.maxHeight>a&&(s.maxHeight=a)),this._vBoundaries=s},_updateCache:function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,i=this.size,n=this.axis;return this._isNumber(t.height)?t.width=t.height*this.aspectRatio:this._isNumber(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===n&&(t.left=e.left+(i.width-t.width),t.top=null),"nw"===n&&(t.top=e.top+(i.height-t.height),t.left=e.left+(i.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,i=this.axis,n=this._isNumber(t.width)&&e.maxWidth&&e.maxWidth<t.width,a=this._isNumber(t.height)&&e.maxHeight&&e.maxHeight<t.height,s=this._isNumber(t.width)&&e.minWidth&&e.minWidth>t.width,o=this._isNumber(t.height)&&e.minHeight&&e.minHeight>t.height,r=this.originalPosition.left+this.originalSize.width,l=this.position.top+this.size.height,c=/sw|nw|w/.test(i),d=/nw|ne|n/.test(i);return s&&(t.width=e.minWidth),o&&(t.height=e.minHeight),n&&(t.width=e.maxWidth),a&&(t.height=e.maxHeight),s&&c&&(t.left=r-e.minWidth),n&&c&&(t.left=r-e.maxWidth),o&&d&&(t.top=l-e.minHeight),a&&d&&(t.top=l-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_getPaddingPlusBorderDimensions:function(t){for(var e=0,i=[],n=[t.css("borderTopWidth"),t.css("borderRightWidth"),t.css("borderBottomWidth"),t.css("borderLeftWidth")],a=[t.css("paddingTop"),t.css("paddingRight"),t.css("paddingBottom"),t.css("paddingLeft")];4>e;e++)i[e]=parseInt(n[e],10)||0,i[e]+=parseInt(a[e],10)||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t,e=0,i=this.helper||this.element;this._proportionallyResizeElements.length>e;e++)t=this._proportionallyResizeElements[e],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(t)),t.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var e=this.element,i=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||t("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var i=this.originalSize;return{left:this.originalPosition.left+e,width:i.width-e}},n:function(t,e,i){var n=this.originalSize;return{top:this.originalPosition.top+i,height:n.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(e,i,n){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,i,n]))},sw:function(e,i,n){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,i,n]))},ne:function(e,i,n){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,i,n]))},nw:function(e,i,n){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,i,n]))}},_propagate:function(e,i){t.ui.plugin.call(this,e,[i,this.ui()]),"resize"!==e&&this._trigger(e,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),t.ui.plugin.add("resizable","animate",{stop:function(e){var i=t(this).resizable("instance"),n=i.options,a=i._proportionallyResizeElements,s=a.length&&/textarea/i.test(a[0].nodeName),o=s&&i._hasScroll(a[0],"left")?0:i.sizeDiff.height,r=s?0:i.sizeDiff.width,l={width:i.size.width-r,height:i.size.height-o},c=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,d=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(t.extend(l,d&&c?{top:d,left:c}:{}),{duration:n.animateDuration,easing:n.animateEasing,step:function(){var n={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};a&&a.length&&t(a[0]).css({width:n.width,height:n.height}),i._updateCache(n),i._propagate("resize",e)}})}}),t.ui.plugin.add("resizable","containment",{start:function(){var e,i,n,a,s,o,r,l=t(this).resizable("instance"),c=l.options,d=l.element,u=c.containment,h=u instanceof t?u.get(0):/parent/.test(u)?d.parent().get(0):u;h&&(l.containerElement=t(h),/document/.test(u)||u===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight}):(e=t(h),i=[],t(["Top","Right","Left","Bottom"]).each((function(t,n){i[t]=l._num(e.css("padding"+n))})),l.containerOffset=e.offset(),l.containerPosition=e.position(),l.containerSize={height:e.innerHeight()-i[3],width:e.innerWidth()-i[1]},n=l.containerOffset,a=l.containerSize.height,s=l.containerSize.width,o=l._hasScroll(h,"left")?h.scrollWidth:s,r=l._hasScroll(h)?h.scrollHeight:a,l.parentData={element:h,left:n.left,top:n.top,width:o,height:r}))},resize:function(e){var i,n,a,s,o=t(this).resizable("instance"),r=o.options,l=o.containerOffset,c=o.position,d=o._aspectRatio||e.shiftKey,u={top:0,left:0},h=o.containerElement,p=!0;h[0]!==document&&/static/.test(h.css("position"))&&(u=l),c.left<(o._helper?l.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-l.left:o.position.left-u.left),d&&(o.size.height=o.size.width/o.aspectRatio,p=!1),o.position.left=r.helper?l.left:0),c.top<(o._helper?l.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-l.top:o.position.top),d&&(o.size.width=o.size.height*o.aspectRatio,p=!1),o.position.top=o._helper?l.top:0),a=o.containerElement.get(0)===o.element.parent().get(0),s=/relative|absolute/.test(o.containerElement.css("position")),a&&s?(o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top):(o.offset.left=o.element.offset().left,o.offset.top=o.element.offset().top),i=Math.abs(o.sizeDiff.width+(o._helper?o.offset.left-u.left:o.offset.left-l.left)),n=Math.abs(o.sizeDiff.height+(o._helper?o.offset.top-u.top:o.offset.top-l.top)),i+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-i,d&&(o.size.height=o.size.width/o.aspectRatio,p=!1)),n+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-n,d&&(o.size.width=o.size.height*o.aspectRatio,p=!1)),p||(o.position.left=o.prevPosition.left,o.position.top=o.prevPosition.top,o.size.width=o.prevSize.width,o.size.height=o.prevSize.height)},stop:function(){var e=t(this).resizable("instance"),i=e.options,n=e.containerOffset,a=e.containerPosition,s=e.containerElement,o=t(e.helper),r=o.offset(),l=o.outerWidth()-e.sizeDiff.width,c=o.outerHeight()-e.sizeDiff.height;e._helper&&!i.animate&&/relative/.test(s.css("position"))&&t(this).css({left:r.left-a.left-n.left,width:l,height:c}),e._helper&&!i.animate&&/static/.test(s.css("position"))&&t(this).css({left:r.left-a.left-n.left,width:l,height:c})}}),t.ui.plugin.add("resizable","alsoResize",{start:function(){var e=t(this).resizable("instance").options;t(e.alsoResize).each((function(){var e=t(this);e.data("ui-resizable-alsoresize",{width:parseInt(e.width(),10),height:parseInt(e.height(),10),left:parseInt(e.css("left"),10),top:parseInt(e.css("top"),10)})}))},resize:function(e,i){var n=t(this).resizable("instance"),a=n.options,s=n.originalSize,o=n.originalPosition,r={height:n.size.height-s.height||0,width:n.size.width-s.width||0,top:n.position.top-o.top||0,left:n.position.left-o.left||0};t(a.alsoResize).each((function(){var e=t(this),n=t(this).data("ui-resizable-alsoresize"),a={},s=e.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];t.each(s,(function(t,e){var i=(n[e]||0)+(r[e]||0);i&&i>=0&&(a[e]=i||null)})),e.css(a)}))},stop:function(){t(this).removeData("resizable-alsoresize")}}),t.ui.plugin.add("resizable","ghost",{start:function(){var e=t(this).resizable("instance"),i=e.options,n=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:n.height,width:n.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),e.ghost.appendTo(e.helper)},resize:function(){var e=t(this).resizable("instance");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=t(this).resizable("instance");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),t.ui.plugin.add("resizable","grid",{resize:function(){var e,i=t(this).resizable("instance"),n=i.options,a=i.size,s=i.originalSize,o=i.originalPosition,r=i.axis,l="number"==typeof n.grid?[n.grid,n.grid]:n.grid,c=l[0]||1,d=l[1]||1,u=Math.round((a.width-s.width)/c)*c,h=Math.round((a.height-s.height)/d)*d,p=s.width+u,f=s.height+h,m=n.maxWidth&&p>n.maxWidth,g=n.maxHeight&&f>n.maxHeight,v=n.minWidth&&n.minWidth>p,b=n.minHeight&&n.minHeight>f;n.grid=l,v&&(p+=c),b&&(f+=d),m&&(p-=c),g&&(f-=d),/^(se|s|e)$/.test(r)?(i.size.width=p,i.size.height=f):/^(ne)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.top=o.top-h):/^(sw)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.left=o.left-u):((0>=f-d||0>=p-c)&&(e=i._getPaddingPlusBorderDimensions(this)),f-d>0?(i.size.height=f,i.position.top=o.top-h):(f=d-e.height,i.size.height=f,i.position.top=o.top+s.height-f),p-c>0?(i.size.width=p,i.position.left=o.left-u):(p=c-e.width,i.size.width=p,i.position.left=o.left+s.width-p))}}),t.ui.resizable,t.widget("ui.dialog",{version:"1.11.4",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var i=t(this).css(e).offset().top;0>i&&t(this).css("top",e.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&t.fn.draggable&&this._makeDraggable(),this.options.resizable&&t.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var e=this.options.appendTo;return e&&(e.jquery||e.nodeType)?t(e):this.document.find(e||"body").eq(0)},_destroy:function(){var t,e=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),(t=e.parent.children().eq(e.index)).length&&t[0]!==this.element[0]?t.before(this.element):e.parent.append(this.element)},widget:function(){return this.uiDialog},disable:t.noop,enable:t.noop,close:function(e){var i,n=this;if(this._isOpen&&!1!==this._trigger("beforeClose",e)){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{(i=this.document[0].activeElement)&&"body"!==i.nodeName.toLowerCase()&&t(i).blur()}catch(t){}this._hide(this.uiDialog,this.options.hide,(function(){n._trigger("close",e)}))}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,i){var n=!1,a=this.uiDialog.siblings(".ui-front:visible").map((function(){return+t(this).css("z-index")})).get(),s=Math.max.apply(null,a);return s>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",s+1),n=!0),n&&!i&&this._trigger("focus",e),n},open:function(){var e=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=t(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,(function(){e._focusTabbable(),e._trigger("focus")})),this._makeFocusTarget(),void this._trigger("open"))},_focusTabbable:function(){var t=this._focusedElement;t||(t=this.element.find("[autofocus]")),t.length||(t=this.element.find(":tabbable")),t.length||(t=this.uiDialogButtonPane.find(":tabbable")),t.length||(t=this.uiDialogTitlebarClose.filter(":tabbable")),t.length||(t=this.uiDialog),t.eq(0).focus()},_keepFocus:function(e){function i(){var e=this.document[0].activeElement;this.uiDialog[0]===e||t.contains(this.uiDialog[0],e)||this._focusTabbable()}e.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=t("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(e){if(this.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===t.ui.keyCode.ESCAPE)return e.preventDefault(),void this.close(e);if(e.keyCode===t.ui.keyCode.TAB&&!e.isDefaultPrevented()){var i=this.uiDialog.find(":tabbable"),n=i.filter(":first"),a=i.filter(":last");e.target!==a[0]&&e.target!==this.uiDialog[0]||e.shiftKey?e.target!==n[0]&&e.target!==this.uiDialog[0]||!e.shiftKey||(this._delay((function(){a.focus()})),e.preventDefault()):(this._delay((function(){n.focus()})),e.preventDefault())}},mousedown:function(t){this._moveToTop(t)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var e;this.uiDialogTitlebar=t("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(e){t(e.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=t("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(t){t.preventDefault(),this.close(t)}}),e=t("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(e),this.uiDialog.attr({"aria-labelledby":e.attr("id")})},_title:function(t){this.options.title||t.html("&#160;"),t.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=t("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=t("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var e=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),t.isEmptyObject(i)||t.isArray(i)&&!i.length?void this.uiDialog.removeClass("ui-dialog-buttons"):(t.each(i,(function(i,n){var a,s;n=t.isFunction(n)?{click:n,text:i}:n,n=t.extend({type:"button"},n),a=n.click,n.click=function(){a.apply(e.element[0],arguments)},s={icons:n.icons,text:n.showText},delete n.icons,delete n.showText,t("<button></button>",n).button(s).appendTo(e.uiButtonSet)})),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function e(t){return{position:t.position,offset:t.offset}}var i=this,n=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(n,a){t(this).addClass("ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",n,e(a))},drag:function(t,n){i._trigger("drag",t,e(n))},stop:function(a,s){var o=s.offset.left-i.document.scrollLeft(),r=s.offset.top-i.document.scrollTop();n.position={my:"left top",at:"left"+(o>=0?"+":"")+o+" top"+(r>=0?"+":"")+r,of:i.window},t(this).removeClass("ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",a,e(s))}})},_makeResizable:function(){function e(t){return{originalPosition:t.originalPosition,originalSize:t.originalSize,position:t.position,size:t.size}}var i=this,n=this.options,a=n.resizable,s=this.uiDialog.css("position"),o="string"==typeof a?a:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:n.maxWidth,maxHeight:n.maxHeight,minWidth:n.minWidth,minHeight:this._minHeight(),handles:o,start:function(n,a){t(this).addClass("ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",n,e(a))},resize:function(t,n){i._trigger("resize",t,e(n))},stop:function(a,s){var o=i.uiDialog.offset(),r=o.left-i.document.scrollLeft(),l=o.top-i.document.scrollTop();n.height=i.uiDialog.height(),n.width=i.uiDialog.width(),n.position={my:"left top",at:"left"+(r>=0?"+":"")+r+" top"+(l>=0?"+":"")+l,of:i.window},t(this).removeClass("ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",a,e(s))}}).css("position",s)},_trackFocus:function(){this._on(this.widget(),{focusin:function(e){this._makeFocusTarget(),this._focusedElement=t(e.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var e=this._trackingInstances(),i=t.inArray(this,e);-1!==i&&e.splice(i,1)},_trackingInstances:function(){var t=this.document.data("ui-dialog-instances");return t||(t=[],this.document.data("ui-dialog-instances",t)),t},_minHeight:function(){var t=this.options;return"auto"===t.height?t.minHeight:Math.min(t.minHeight,t.height)},_position:function(){var t=this.uiDialog.is(":visible");t||this.uiDialog.show(),this.uiDialog.position(this.options.position),t||this.uiDialog.hide()},_setOptions:function(e){var i=this,n=!1,a={};t.each(e,(function(t,e){i._setOption(t,e),t in i.sizeRelatedOptions&&(n=!0),t in i.resizableRelatedOptions&&(a[t]=e)})),n&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",a)},_setOption:function(t,e){var i,n,a=this.uiDialog;"dialogClass"===t&&a.removeClass(this.options.dialogClass).addClass(e),"disabled"!==t&&(this._super(t,e),"appendTo"===t&&this.uiDialog.appendTo(this._appendTo()),"buttons"===t&&this._createButtons(),"closeText"===t&&this.uiDialogTitlebarClose.button({label:""+e}),"draggable"===t&&((i=a.is(":data(ui-draggable)"))&&!e&&a.draggable("destroy"),!i&&e&&this._makeDraggable()),"position"===t&&this._position(),"resizable"===t&&((n=a.is(":data(ui-resizable)"))&&!e&&a.resizable("destroy"),n&&"string"==typeof e&&a.resizable("option","handles",e),n||!1===e||this._makeResizable()),"title"===t&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var t,e,i,n=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),n.minWidth>n.width&&(n.width=n.minWidth),t=this.uiDialog.css({height:"auto",width:n.width}).outerHeight(),e=Math.max(0,n.minHeight-t),i="number"==typeof n.maxHeight?Math.max(0,n.maxHeight-t):"none","auto"===n.height?this.element.css({minHeight:e,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,n.height-t)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map((function(){var e=t(this);return t("<div>").css({position:"absolute",width:e.outerWidth(),height:e.outerHeight()}).appendTo(e.parent()).offset(e.offset())[0]}))},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(e){return!!t(e.target).closest(".ui-dialog").length||!!t(e.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var e=!0;this._delay((function(){e=!1})),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(t){e||this._allowInteraction(t)||(t.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=t("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var t=this.document.data("ui-dialog-overlays")-1;t?this.document.data("ui-dialog-overlays",t):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null}}}),t.widget("ui.droppable",{version:"1.11.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,i=this.options,n=i.accept;this.isover=!1,this.isout=!0,this.accept=t.isFunction(n)?n:function(t){return t.is(n)},this.proportions=function(){return arguments.length?void(e=arguments[0]):e||(e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight})},this._addToManager(i.scope),i.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(e){t.ui.ddmanager.droppables[e]=t.ui.ddmanager.droppables[e]||[],t.ui.ddmanager.droppables[e].push(this)},_splice:function(t){for(var e=0;t.length>e;e++)t[e]===this&&t.splice(e,1)},_destroy:function(){var e=t.ui.ddmanager.droppables[this.options.scope];this._splice(e),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,i){if("accept"===e)this.accept=t.isFunction(i)?i:function(t){return t.is(i)};else if("scope"===e){var n=t.ui.ddmanager.droppables[this.options.scope];this._splice(n),this._addToManager(i)}this._super(e,i)},_activate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",e,this.ui(i))},_deactivate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",e,this.ui(i))},_over:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(i)))},_out:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(i)))},_drop:function(e,i){var n=i||t.ui.ddmanager.current,a=!1;return!(!n||(n.currentItem||n.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each((function(){var i=t(this).droppable("instance");return i.options.greedy&&!i.options.disabled&&i.options.scope===n.options.scope&&i.accept.call(i.element[0],n.currentItem||n.element)&&t.ui.intersect(n,t.extend(i,{offset:i.element.offset()}),i.options.tolerance,e)?(a=!0,!1):void 0})),!a&&(!!this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(n)),this.element)))},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}}}),t.ui.intersect=function(){function t(t,e,i){return t>=e&&e+i>t}return function(e,i,n,a){if(!i.offset)return!1;var s=(e.positionAbs||e.position.absolute).left+e.margins.left,o=(e.positionAbs||e.position.absolute).top+e.margins.top,r=s+e.helperProportions.width,l=o+e.helperProportions.height,c=i.offset.left,d=i.offset.top,u=c+i.proportions().width,h=d+i.proportions().height;switch(n){case"fit":return s>=c&&u>=r&&o>=d&&h>=l;case"intersect":return s+e.helperProportions.width/2>c&&u>r-e.helperProportions.width/2&&o+e.helperProportions.height/2>d&&h>l-e.helperProportions.height/2;case"pointer":return t(a.pageY,d,i.proportions().height)&&t(a.pageX,c,i.proportions().width);case"touch":return(o>=d&&h>=o||l>=d&&h>=l||d>o&&l>h)&&(s>=c&&u>=s||r>=c&&u>=r||c>s&&r>u);default:return!1}}}(),t.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(e,i){var n,a,s=t.ui.ddmanager.droppables[e.options.scope]||[],o=i?i.type:null,r=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(n=0;s.length>n;n++)if(!(s[n].options.disabled||e&&!s[n].accept.call(s[n].element[0],e.currentItem||e.element))){for(a=0;r.length>a;a++)if(r[a]===s[n].element[0]){s[n].proportions().height=0;continue t}s[n].visible="none"!==s[n].element.css("display"),s[n].visible&&("mousedown"===o&&s[n]._activate.call(s[n],i),s[n].offset=s[n].element.offset(),s[n].proportions({width:s[n].element[0].offsetWidth,height:s[n].element[0].offsetHeight}))}},drop:function(e,i){var n=!1;return t.each((t.ui.ddmanager.droppables[e.options.scope]||[]).slice(),(function(){this.options&&(!this.options.disabled&&this.visible&&t.ui.intersect(e,this,this.options.tolerance,i)&&(n=this._drop.call(this,i)||n),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))})),n},dragStart:function(e,i){e.element.parentsUntil("body").bind("scroll.droppable",(function(){e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)}))},drag:function(e,i){e.options.refreshPositions&&t.ui.ddmanager.prepareOffsets(e,i),t.each(t.ui.ddmanager.droppables[e.options.scope]||[],(function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var n,a,s,o=t.ui.intersect(e,this,this.options.tolerance,i),r=!o&&this.isover?"isout":o&&!this.isover?"isover":null;r&&(this.options.greedy&&(a=this.options.scope,(s=this.element.parents(":data(ui-droppable)").filter((function(){return t(this).droppable("instance").options.scope===a}))).length&&((n=t(s[0]).droppable("instance")).greedyChild="isover"===r)),n&&"isover"===r&&(n.isover=!1,n.isout=!0,n._out.call(n,i)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,i),n&&"isout"===r&&(n.isout=!1,n.isover=!0,n._over.call(n,i)))}}))},dragStop:function(e,i){e.element.parentsUntil("body").unbind("scroll.droppable"),e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)}},t.ui.droppable;var b="ui-effects-",y=t;t.effects={effect:{}},function(t,e){function i(t,e,i){var n=d[e.type]||{};return null==t?i||!e.def?null:e.def:(t=n.floor?~~t:parseFloat(t),isNaN(t)?e.def:n.mod?(t+n.mod)%n.mod:0>t?0:t>n.max?n.max:t)}function n(i){var n=l(),a=n._rgba=[];return i=i.toLowerCase(),p(r,(function(t,s){var o,r=s.re.exec(i),l=r&&s.parse(r),d=s.space||"rgba";return l?(o=n[d](l),n[c[d].cache]=o[c[d].cache],a=n._rgba=o._rgba,!1):e})),a.length?("0,0,0,0"===a.join()&&t.extend(a,s.transparent),n):s[i]}function a(t,e,i){return 1>6*(i=(i+1)%1)?t+6*(e-t)*i:1>2*i?e:2>3*i?t+6*(e-t)*(2/3-i):t}var s,o=/^([\-+])=\s*(\d+\.?\d*)/,r=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],l=t.Color=function(e,i,n,a){return new t.Color.fn.parse(e,i,n,a)},c={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},d={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},u=l.support={},h=t("<p>")[0],p=t.each;h.style.cssText="background-color:rgba(1,1,1,.5)",u.rgba=h.style.backgroundColor.indexOf("rgba")>-1,p(c,(function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}})),l.fn=t.extend(l.prototype,{parse:function(a,o,r,d){if(a===e)return this._rgba=[null,null,null,null],this;(a.jquery||a.nodeType)&&(a=t(a).css(o),o=e);var u=this,h=t.type(a),f=this._rgba=[];return o!==e&&(a=[a,o,r,d],h="array"),"string"===h?this.parse(n(a)||s._default):"array"===h?(p(c.rgba.props,(function(t,e){f[e.idx]=i(a[e.idx],e)})),this):"object"===h?(p(c,a instanceof l?function(t,e){a[e.cache]&&(u[e.cache]=a[e.cache].slice())}:function(e,n){var s=n.cache;p(n.props,(function(t,e){if(!u[s]&&n.to){if("alpha"===t||null==a[t])return;u[s]=n.to(u._rgba)}u[s][e.idx]=i(a[t],e,!0)})),u[s]&&0>t.inArray(null,u[s].slice(0,3))&&(u[s][3]=1,n.from&&(u._rgba=n.from(u[s])))}),this):e},is:function(t){var i=l(t),n=!0,a=this;return p(c,(function(t,s){var o,r=i[s.cache];return r&&(o=a[s.cache]||s.to&&s.to(a._rgba)||[],p(s.props,(function(t,i){return null!=r[i.idx]?n=r[i.idx]===o[i.idx]:e}))),n})),n},_space:function(){var t=[],e=this;return p(c,(function(i,n){e[n.cache]&&t.push(i)})),t.pop()},transition:function(t,e){var n=l(t),a=n._space(),s=c[a],o=0===this.alpha()?l("transparent"):this,r=o[s.cache]||s.to(o._rgba),u=r.slice();return n=n[s.cache],p(s.props,(function(t,a){var s=a.idx,o=r[s],l=n[s],c=d[a.type]||{};null!==l&&(null===o?u[s]=l:(c.mod&&(l-o>c.mod/2?o+=c.mod:o-l>c.mod/2&&(o-=c.mod)),u[s]=i((l-o)*e+o,a)))})),this[a](u)},blend:function(e){if(1===this._rgba[3])return this;var i=this._rgba.slice(),n=i.pop(),a=l(e)._rgba;return l(t.map(i,(function(t,e){return(1-n)*a[e]+n*t})))},toRgbaString:function(){var e="rgba(",i=t.map(this._rgba,(function(t,e){return null==t?e>2?1:0:t}));return 1===i[3]&&(i.pop(),e="rgb("),e+i.join()+")"},toHslaString:function(){var e="hsla(",i=t.map(this.hsla(),(function(t,e){return null==t&&(t=e>2?1:0),e&&3>e&&(t=Math.round(100*t)+"%"),t}));return 1===i[3]&&(i.pop(),e="hsl("),e+i.join()+")"},toHexString:function(e){var i=this._rgba.slice(),n=i.pop();return e&&i.push(~~(255*n)),"#"+t.map(i,(function(t){return 1===(t=(t||0).toString(16)).length?"0"+t:t})).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,c.hsla.to=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e,i,n=t[0]/255,a=t[1]/255,s=t[2]/255,o=t[3],r=Math.max(n,a,s),l=Math.min(n,a,s),c=r-l,d=r+l,u=.5*d;return e=l===r?0:n===r?60*(a-s)/c+360:a===r?60*(s-n)/c+120:60*(n-a)/c+240,i=0===c?0:.5>=u?c/d:c/(2-d),[Math.round(e)%360,i,u,null==o?1:o]},c.hsla.from=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/360,i=t[1],n=t[2],s=t[3],o=.5>=n?n*(1+i):n+i-n*i,r=2*n-o;return[Math.round(255*a(r,o,e+1/3)),Math.round(255*a(r,o,e)),Math.round(255*a(r,o,e-1/3)),s]},p(c,(function(n,a){var s=a.props,r=a.cache,c=a.to,d=a.from;l.fn[n]=function(n){if(c&&!this[r]&&(this[r]=c(this._rgba)),n===e)return this[r].slice();var a,o=t.type(n),u="array"===o||"object"===o?n:arguments,h=this[r].slice();return p(s,(function(t,e){var n=u["object"===o?t:e.idx];null==n&&(n=h[e.idx]),h[e.idx]=i(n,e)})),d?((a=l(d(h)))[r]=h,a):l(h)},p(s,(function(e,i){l.fn[e]||(l.fn[e]=function(a){var s,r=t.type(a),l="alpha"===e?this._hsla?"hsla":"rgba":n,c=this[l](),d=c[i.idx];return"undefined"===r?d:("function"===r&&(a=a.call(this,d),r=t.type(a)),null==a&&i.empty?this:("string"===r&&((s=o.exec(a))&&(a=d+parseFloat(s[2])*("+"===s[1]?1:-1))),c[i.idx]=a,this[l](c)))})}))})),l.hook=function(e){var i=e.split(" ");p(i,(function(e,i){t.cssHooks[i]={set:function(e,a){var s,o,r="";if("transparent"!==a&&("string"!==t.type(a)||(s=n(a)))){if(a=l(s||a),!u.rgba&&1!==a._rgba[3]){for(o="backgroundColor"===i?e.parentNode:e;(""===r||"transparent"===r)&&o&&o.style;)try{r=t.css(o,"backgroundColor"),o=o.parentNode}catch(t){}a=a.blend(r&&"transparent"!==r?r:"_default")}a=a.toRgbaString()}try{e.style[i]=a}catch(t){}}},t.fx.step[i]=function(e){e.colorInit||(e.start=l(e.elem,i),e.end=l(e.end),e.colorInit=!0),t.cssHooks[i].set(e.elem,e.start.transition(e.end,e.pos))}}))},l.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor"),t.cssHooks.borderColor={expand:function(t){var e={};return p(["Top","Right","Bottom","Left"],(function(i,n){e["border"+n+"Color"]=t})),e}},s=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(y),function(){function e(e){var i,n,a=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,s={};if(a&&a.length&&a[0]&&a[a[0]])for(n=a.length;n--;)"string"==typeof a[i=a[n]]&&(s[t.camelCase(i)]=a[i]);else for(i in a)"string"==typeof a[i]&&(s[i]=a[i]);return s}var i,n=["add","remove","toggle"],a={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};t.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],(function(e,i){t.fx.step[i]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(y.style(t.elem,i,t.end),t.setAttr=!0)}})),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.effects.animateClass=function(i,s,o,r){var l=t.speed(s,o,r);return this.queue((function(){var s,o=t(this),r=o.attr("class")||"",c=l.children?o.find("*").addBack():o;c=c.map((function(){return{el:t(this),start:e(this)}})),(s=function(){t.each(n,(function(t,e){i[e]&&o[e+"Class"](i[e])}))})(),c=c.map((function(){return this.end=e(this.el[0]),this.diff=function(e,i){var n,s,o={};for(n in i)s=i[n],e[n]!==s&&(a[n]||(t.fx.step[n]||!isNaN(parseFloat(s)))&&(o[n]=s));return o}(this.start,this.end),this})),o.attr("class",r),c=c.map((function(){var e=this,i=t.Deferred(),n=t.extend({},l,{queue:!1,complete:function(){i.resolve(e)}});return this.el.animate(this.diff,n),i.promise()})),t.when.apply(t,c.get()).done((function(){s(),t.each(arguments,(function(){var e=this.el;t.each(this.diff,(function(t){e.css(t,"")}))})),l.complete.call(o[0])}))}))},t.fn.extend({addClass:(i=t.fn.addClass,function(e,n,a,s){return n?t.effects.animateClass.call(this,{add:e},n,a,s):i.apply(this,arguments)}),removeClass:function(e){return function(i,n,a,s){return arguments.length>1?t.effects.animateClass.call(this,{remove:i},n,a,s):e.apply(this,arguments)}}(t.fn.removeClass),toggleClass:function(e){return function(i,n,a,s,o){return"boolean"==typeof n||void 0===n?a?t.effects.animateClass.call(this,n?{add:i}:{remove:i},a,s,o):e.apply(this,arguments):t.effects.animateClass.call(this,{toggle:i},n,a,s)}}(t.fn.toggleClass),switchClass:function(e,i,n,a,s){return t.effects.animateClass.call(this,{add:i,remove:e},n,a,s)}})}(),function(){function e(e,i,n,a){return t.isPlainObject(e)&&(i=e,e=e.effect),e={effect:e},null==i&&(i={}),t.isFunction(i)&&(a=i,n=null,i={}),("number"==typeof i||t.fx.speeds[i])&&(a=n,n=i,i={}),t.isFunction(n)&&(a=n,n=null),i&&t.extend(e,i),n=n||i.duration,e.duration=t.fx.off?0:"number"==typeof n?n:n in t.fx.speeds?t.fx.speeds[n]:t.fx.speeds._default,e.complete=a||i.complete,e}function i(e){return!(e&&"number"!=typeof e&&!t.fx.speeds[e])||("string"==typeof e&&!t.effects.effect[e]||(!!t.isFunction(e)||"object"==typeof e&&!e.effect))}var n;t.extend(t.effects,{version:"1.11.4",save:function(t,e){for(var i=0;e.length>i;i++)null!==e[i]&&t.data(b+e[i],t[0].style[e[i]])},restore:function(t,e){var i,n;for(n=0;e.length>n;n++)null!==e[n]&&(void 0===(i=t.data(b+e[n]))&&(i=""),t.css(e[n],i))},setMode:function(t,e){return"toggle"===e&&(e=t.is(":hidden")?"show":"hide"),e},getBaseline:function(t,e){var i,n;switch(t[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=t[0]/e.height}switch(t[1]){case"left":n=0;break;case"center":n=.5;break;case"right":n=1;break;default:n=t[1]/e.width}return{x:n,y:i}},createWrapper:function(e){if(e.parent().is(".ui-effects-wrapper"))return e.parent();var i={width:e.outerWidth(!0),height:e.outerHeight(!0),float:e.css("float")},n=t("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),a={width:e.width(),height:e.height()},s=document.activeElement;try{s.id}catch(t){s=document.body}return e.wrap(n),(e[0]===s||t.contains(e[0],s))&&t(s).focus(),n=e.parent(),"static"===e.css("position")?(n.css({position:"relative"}),e.css({position:"relative"})):(t.extend(i,{position:e.css("position"),zIndex:e.css("z-index")}),t.each(["top","left","bottom","right"],(function(t,n){i[n]=e.css(n),isNaN(parseInt(i[n],10))&&(i[n]="auto")})),e.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),e.css(a),n.css(i).show()},removeWrapper:function(e){var i=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),(e[0]===i||t.contains(e[0],i))&&t(i).focus()),e},setTransition:function(e,i,n,a){return a=a||{},t.each(i,(function(t,i){var s=e.cssUnit(i);s[0]>0&&(a[i]=s[0]*n+s[1])})),a}}),t.fn.extend({effect:function(){function i(e){function i(){t.isFunction(s)&&s.call(a[0]),t.isFunction(e)&&e()}var a=t(this),s=n.complete,r=n.mode;(a.is(":hidden")?"hide"===r:"show"===r)?(a[r](),i()):o.call(a[0],n,i)}var n=e.apply(this,arguments),a=n.mode,s=n.queue,o=t.effects.effect[n.effect];return t.fx.off||!o?a?this[a](n.duration,n.complete):this.each((function(){n.complete&&n.complete.call(this)})):!1===s?this.each(i):this.queue(s||"fx",i)},show:(n=t.fn.show,function(t){if(i(t))return n.apply(this,arguments);var a=e.apply(this,arguments);return a.mode="show",this.effect.call(this,a)}),hide:function(t){return function(n){if(i(n))return t.apply(this,arguments);var a=e.apply(this,arguments);return a.mode="hide",this.effect.call(this,a)}}(t.fn.hide),toggle:function(t){return function(n){if(i(n)||"boolean"==typeof n)return t.apply(this,arguments);var a=e.apply(this,arguments);return a.mode="toggle",this.effect.call(this,a)}}(t.fn.toggle),cssUnit:function(e){var i=this.css(e),n=[];return t.each(["em","px","%","pt"],(function(t,e){i.indexOf(e)>0&&(n=[parseFloat(i),e])})),n}})}(),function(){var e={};t.each(["Quad","Cubic","Quart","Quint","Expo"],(function(t,i){e[i]=function(e){return Math.pow(e,t+2)}})),t.extend(e,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,i=4;((e=Math.pow(2,--i))-1)/11>t;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*e-2)/22-t,2)}}),t.each(e,(function(e,i){t.easing["easeIn"+e]=i,t.easing["easeOut"+e]=function(t){return 1-i(1-t)},t.easing["easeInOut"+e]=function(t){return.5>t?i(2*t)/2:1-i(-2*t+2)/2}}))}(),t.effects,t.effects.effect.blind=function(e,i){var n,a,s,o=t(this),r=["position","top","bottom","left","right","height","width"],l=t.effects.setMode(o,e.mode||"hide"),c=e.direction||"up",d=/up|down|vertical/.test(c),u=d?"height":"width",h=d?"top":"left",p=/up|left|vertical|horizontal/.test(c),f={},m="show"===l;o.parent().is(".ui-effects-wrapper")?t.effects.save(o.parent(),r):t.effects.save(o,r),o.show(),a=(n=t.effects.createWrapper(o).css({overflow:"hidden"}))[u](),s=parseFloat(n.css(h))||0,f[u]=m?a:0,p||(o.css(d?"bottom":"right",0).css(d?"top":"left","auto").css({position:"absolute"}),f[h]=m?s:a+s),m&&(n.css(u,0),p||n.css(h,s+a)),n.animate(f,{duration:e.duration,easing:e.easing,queue:!1,complete:function(){"hide"===l&&o.hide(),t.effects.restore(o,r),t.effects.removeWrapper(o),i()}})},t.effects.effect.bounce=function(e,i){var n,a,s,o=t(this),r=["position","top","bottom","left","right","height","width"],l=t.effects.setMode(o,e.mode||"effect"),c="hide"===l,d="show"===l,u=e.direction||"up",h=e.distance,p=e.times||5,f=2*p+(d||c?1:0),m=e.duration/f,g=e.easing,v="up"===u||"down"===u?"top":"left",b="up"===u||"left"===u,y=o.queue(),_=y.length;for((d||c)&&r.push("opacity"),t.effects.save(o,r),o.show(),t.effects.createWrapper(o),h||(h=o["top"===v?"outerHeight":"outerWidth"]()/3),d&&((s={opacity:1})[v]=0,o.css("opacity",0).css(v,b?2*-h:2*h).animate(s,m,g)),c&&(h/=Math.pow(2,p-1)),(s={})[v]=0,n=0;p>n;n++)(a={})[v]=(b?"-=":"+=")+h,o.animate(a,m,g).animate(s,m,g),h=c?2*h:h/2;c&&((a={opacity:0})[v]=(b?"-=":"+=")+h,o.animate(a,m,g)),o.queue((function(){c&&o.hide(),t.effects.restore(o,r),t.effects.removeWrapper(o),i()})),_>1&&y.splice.apply(y,[1,0].concat(y.splice(_,f+1))),o.dequeue()},t.effects.effect.clip=function(e,i){var n,a,s,o=t(this),r=["position","top","bottom","left","right","height","width"],l="show"===t.effects.setMode(o,e.mode||"hide"),c="vertical"===(e.direction||"vertical"),d=c?"height":"width",u=c?"top":"left",h={};t.effects.save(o,r),o.show(),n=t.effects.createWrapper(o).css({overflow:"hidden"}),s=(a="IMG"===o[0].tagName?n:o)[d](),l&&(a.css(d,0),a.css(u,s/2)),h[d]=l?s:0,h[u]=l?0:s/2,a.animate(h,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){l||o.hide(),t.effects.restore(o,r),t.effects.removeWrapper(o),i()}})},t.effects.effect.drop=function(e,i){var n,a=t(this),s=["position","top","bottom","left","right","opacity","height","width"],o=t.effects.setMode(a,e.mode||"hide"),r="show"===o,l=e.direction||"left",c="up"===l||"down"===l?"top":"left",d="up"===l||"left"===l?"pos":"neg",u={opacity:r?1:0};t.effects.save(a,s),a.show(),t.effects.createWrapper(a),n=e.distance||a["top"===c?"outerHeight":"outerWidth"](!0)/2,r&&a.css("opacity",0).css(c,"pos"===d?-n:n),u[c]=(r?"pos"===d?"+=":"-=":"pos"===d?"-=":"+=")+n,a.animate(u,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===o&&a.hide(),t.effects.restore(a,s),t.effects.removeWrapper(a),i()}})},t.effects.effect.explode=function(e,i){function n(){v.push(this),v.length===d*u&&(h.css({visibility:"visible"}),t(v).remove(),p||h.hide(),i())}var a,s,o,r,l,c,d=e.pieces?Math.round(Math.sqrt(e.pieces)):3,u=d,h=t(this),p="show"===t.effects.setMode(h,e.mode||"hide"),f=h.show().css("visibility","hidden").offset(),m=Math.ceil(h.outerWidth()/u),g=Math.ceil(h.outerHeight()/d),v=[];for(a=0;d>a;a++)for(r=f.top+a*g,c=a-(d-1)/2,s=0;u>s;s++)o=f.left+s*m,l=s-(u-1)/2,h.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-s*m,top:-a*g}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:m,height:g,left:o+(p?l*m:0),top:r+(p?c*g:0),opacity:p?0:1}).animate({left:o+(p?0:l*m),top:r+(p?0:c*g),opacity:p?1:0},e.duration||500,e.easing,n)},t.effects.effect.fade=function(e,i){var n=t(this),a=t.effects.setMode(n,e.mode||"toggle");n.animate({opacity:a},{queue:!1,duration:e.duration,easing:e.easing,complete:i})},t.effects.effect.fold=function(e,i){var n,a,s=t(this),o=["position","top","bottom","left","right","height","width"],r=t.effects.setMode(s,e.mode||"hide"),l="show"===r,c="hide"===r,d=e.size||15,u=/([0-9]+)%/.exec(d),h=!!e.horizFirst,p=l!==h,f=p?["width","height"]:["height","width"],m=e.duration/2,g={},v={};t.effects.save(s,o),s.show(),n=t.effects.createWrapper(s).css({overflow:"hidden"}),a=p?[n.width(),n.height()]:[n.height(),n.width()],u&&(d=parseInt(u[1],10)/100*a[c?0:1]),l&&n.css(h?{height:0,width:d}:{height:d,width:0}),g[f[0]]=l?a[0]:d,v[f[1]]=l?a[1]:0,n.animate(g,m,e.easing).animate(v,m,e.easing,(function(){c&&s.hide(),t.effects.restore(s,o),t.effects.removeWrapper(s),i()}))},t.effects.effect.highlight=function(e,i){var n=t(this),a=["backgroundImage","backgroundColor","opacity"],s=t.effects.setMode(n,e.mode||"show"),o={backgroundColor:n.css("backgroundColor")};"hide"===s&&(o.opacity=0),t.effects.save(n,a),n.show().css({backgroundImage:"none",backgroundColor:e.color||"#ffff99"}).animate(o,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===s&&n.hide(),t.effects.restore(n,a),i()}})},t.effects.effect.size=function(e,i){var n,a,s,o=t(this),r=["position","top","bottom","left","right","width","height","overflow","opacity"],l=["width","height","overflow"],c=["fontSize"],d=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],u=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],h=t.effects.setMode(o,e.mode||"effect"),p=e.restore||"effect"!==h,f=e.scale||"both",m=e.origin||["middle","center"],g=o.css("position"),v=p?r:["position","top","bottom","left","right","overflow","opacity"],b={height:0,width:0,outerHeight:0,outerWidth:0};"show"===h&&o.show(),n={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},"toggle"===e.mode&&"show"===h?(o.from=e.to||b,o.to=e.from||n):(o.from=e.from||("show"===h?b:n),o.to=e.to||("hide"===h?b:n)),s={from:{y:o.from.height/n.height,x:o.from.width/n.width},to:{y:o.to.height/n.height,x:o.to.width/n.width}},("box"===f||"both"===f)&&(s.from.y!==s.to.y&&(v=v.concat(d),o.from=t.effects.setTransition(o,d,s.from.y,o.from),o.to=t.effects.setTransition(o,d,s.to.y,o.to)),s.from.x!==s.to.x&&(v=v.concat(u),o.from=t.effects.setTransition(o,u,s.from.x,o.from),o.to=t.effects.setTransition(o,u,s.to.x,o.to))),("content"===f||"both"===f)&&s.from.y!==s.to.y&&(v=v.concat(c).concat(l),o.from=t.effects.setTransition(o,c,s.from.y,o.from),o.to=t.effects.setTransition(o,c,s.to.y,o.to)),t.effects.save(o,v),o.show(),t.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),m&&(a=t.effects.getBaseline(m,n),o.from.top=(n.outerHeight-o.outerHeight())*a.y,o.from.left=(n.outerWidth-o.outerWidth())*a.x,o.to.top=(n.outerHeight-o.to.outerHeight)*a.y,o.to.left=(n.outerWidth-o.to.outerWidth)*a.x),o.css(o.from),("content"===f||"both"===f)&&(d=d.concat(["marginTop","marginBottom"]).concat(c),u=u.concat(["marginLeft","marginRight"]),l=r.concat(d).concat(u),o.find("*[width]").each((function(){var i=t(this),n=i.height(),a=i.width(),o=i.outerHeight(),r=i.outerWidth();p&&t.effects.save(i,l),i.from={height:n*s.from.y,width:a*s.from.x,outerHeight:o*s.from.y,outerWidth:r*s.from.x},i.to={height:n*s.to.y,width:a*s.to.x,outerHeight:n*s.to.y,outerWidth:a*s.to.x},s.from.y!==s.to.y&&(i.from=t.effects.setTransition(i,d,s.from.y,i.from),i.to=t.effects.setTransition(i,d,s.to.y,i.to)),s.from.x!==s.to.x&&(i.from=t.effects.setTransition(i,u,s.from.x,i.from),i.to=t.effects.setTransition(i,u,s.to.x,i.to)),i.css(i.from),i.animate(i.to,e.duration,e.easing,(function(){p&&t.effects.restore(i,l)}))}))),o.animate(o.to,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){0===o.to.opacity&&o.css("opacity",o.from.opacity),"hide"===h&&o.hide(),t.effects.restore(o,v),p||("static"===g?o.css({position:"relative",top:o.to.top,left:o.to.left}):t.each(["top","left"],(function(t,e){o.css(e,(function(e,i){var n=parseInt(i,10),a=t?o.to.left:o.to.top;return"auto"===i?a+"px":n+a+"px"}))}))),t.effects.removeWrapper(o),i()}})},t.effects.effect.scale=function(e,i){var n=t(this),a=t.extend(!0,{},e),s=t.effects.setMode(n,e.mode||"effect"),o=parseInt(e.percent,10)||(0===parseInt(e.percent,10)||"hide"===s?0:100),r=e.direction||"both",l=e.origin,c={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()},d="horizontal"!==r?o/100:1,u="vertical"!==r?o/100:1;a.effect="size",a.queue=!1,a.complete=i,"effect"!==s&&(a.origin=l||["middle","center"],a.restore=!0),a.from=e.from||("show"===s?{height:0,width:0,outerHeight:0,outerWidth:0}:c),a.to={height:c.height*d,width:c.width*u,outerHeight:c.outerHeight*d,outerWidth:c.outerWidth*u},a.fade&&("show"===s&&(a.from.opacity=0,a.to.opacity=1),"hide"===s&&(a.from.opacity=1,a.to.opacity=0)),n.effect(a)},t.effects.effect.puff=function(e,i){var n=t(this),a=t.effects.setMode(n,e.mode||"hide"),s="hide"===a,o=parseInt(e.percent,10)||150,r=o/100,l={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()};t.extend(e,{effect:"scale",queue:!1,fade:!0,mode:a,complete:i,percent:s?o:100,from:s?l:{height:l.height*r,width:l.width*r,outerHeight:l.outerHeight*r,outerWidth:l.outerWidth*r}}),n.effect(e)},t.effects.effect.pulsate=function(e,i){var n,a=t(this),s=t.effects.setMode(a,e.mode||"show"),o="show"===s,r="hide"===s,l=o||"hide"===s,c=2*(e.times||5)+(l?1:0),d=e.duration/c,u=0,h=a.queue(),p=h.length;for((o||!a.is(":visible"))&&(a.css("opacity",0).show(),u=1),n=1;c>n;n++)a.animate({opacity:u},d,e.easing),u=1-u;a.animate({opacity:u},d,e.easing),a.queue((function(){r&&a.hide(),i()})),p>1&&h.splice.apply(h,[1,0].concat(h.splice(p,c+1))),a.dequeue()},t.effects.effect.shake=function(e,i){var n,a=t(this),s=["position","top","bottom","left","right","height","width"],o=t.effects.setMode(a,e.mode||"effect"),r=e.direction||"left",l=e.distance||20,c=e.times||3,d=2*c+1,u=Math.round(e.duration/d),h="up"===r||"down"===r?"top":"left",p="up"===r||"left"===r,f={},m={},g={},v=a.queue(),b=v.length;for(t.effects.save(a,s),a.show(),t.effects.createWrapper(a),f[h]=(p?"-=":"+=")+l,m[h]=(p?"+=":"-=")+2*l,g[h]=(p?"-=":"+=")+2*l,a.animate(f,u,e.easing),n=1;c>n;n++)a.animate(m,u,e.easing).animate(g,u,e.easing);a.animate(m,u,e.easing).animate(f,u/2,e.easing).queue((function(){"hide"===o&&a.hide(),t.effects.restore(a,s),t.effects.removeWrapper(a),i()})),b>1&&v.splice.apply(v,[1,0].concat(v.splice(b,d+1))),a.dequeue()},t.effects.effect.slide=function(e,i){var n,a=t(this),s=["position","top","bottom","left","right","width","height"],o=t.effects.setMode(a,e.mode||"show"),r="show"===o,l=e.direction||"left",c="up"===l||"down"===l?"top":"left",d="up"===l||"left"===l,u={};t.effects.save(a,s),a.show(),n=e.distance||a["top"===c?"outerHeight":"outerWidth"](!0),t.effects.createWrapper(a).css({overflow:"hidden"}),r&&a.css(c,d?isNaN(n)?"-"+n:-n:n),u[c]=(r?d?"+=":"-=":d?"-=":"+=")+n,a.animate(u,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===o&&a.hide(),t.effects.restore(a,s),t.effects.removeWrapper(a),i()}})},t.effects.effect.transfer=function(e,i){var n=t(this),a=t(e.to),s="fixed"===a.css("position"),o=t("body"),r=s?o.scrollTop():0,l=s?o.scrollLeft():0,c=a.offset(),d={top:c.top-r,left:c.left-l,height:a.innerHeight(),width:a.innerWidth()},u=n.offset(),h=t("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(e.className).css({top:u.top-r,left:u.left-l,height:n.innerHeight(),width:n.innerWidth(),position:s?"fixed":"absolute"}).animate(d,e.duration,e.easing,(function(){h.remove(),i()}))},t.widget("ui.progressbar",{version:"1.11.4",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=t("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(t){return void 0===t?this.options.value:(this.options.value=this._constrainedValue(t),void this._refreshValue())},_constrainedValue:function(t){return void 0===t&&(t=this.options.value),this.indeterminate=!1===t,"number"!=typeof t&&(t=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,t))},_setOptions:function(t){var e=t.value;delete t.value,this._super(t),this.options.value=this._constrainedValue(e),this._refreshValue()},_setOption:function(t,e){"max"===t&&(e=Math.max(this.min,e)),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!e).attr("aria-disabled",e),this._super(t,e)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var e=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||e>this.min).toggleClass("ui-corner-right",e===this.options.max).width(i.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=t("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":e}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),e===this.options.max&&this._trigger("complete")}}),t.widget("ui.selectable",t.ui.mouse,{version:"1.11.4",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e,i=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){(e=t(i.options.filter,i.element[0])).addClass("ui-selectee"),e.each((function(){var e=t(this),i=e.offset();t.data(this,"selectable-item",{element:this,$element:e,left:i.left,top:i.top,right:i.left+e.outerWidth(),bottom:i.top+e.outerHeight(),startselected:!1,selected:e.hasClass("ui-selected"),selecting:e.hasClass("ui-selecting"),unselecting:e.hasClass("ui-unselecting")})}))},this.refresh(),this.selectees=e.addClass("ui-selectee"),this._mouseInit(),this.helper=t("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(e){var i=this,n=this.options;this.opos=[e.pageX,e.pageY],this.options.disabled||(this.selectees=t(n.filter,this.element[0]),this._trigger("start",e),t(n.appendTo).append(this.helper),this.helper.css({left:e.pageX,top:e.pageY,width:0,height:0}),n.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each((function(){var n=t.data(this,"selectable-item");n.startselected=!0,e.metaKey||e.ctrlKey||(n.$element.removeClass("ui-selected"),n.selected=!1,n.$element.addClass("ui-unselecting"),n.unselecting=!0,i._trigger("unselecting",e,{unselecting:n.element}))})),t(e.target).parents().addBack().each((function(){var n,a=t.data(this,"selectable-item");return a?(n=!e.metaKey&&!e.ctrlKey||!a.$element.hasClass("ui-selected"),a.$element.removeClass(n?"ui-unselecting":"ui-selected").addClass(n?"ui-selecting":"ui-unselecting"),a.unselecting=!n,a.selecting=n,a.selected=n,n?i._trigger("selecting",e,{selecting:a.element}):i._trigger("unselecting",e,{unselecting:a.element}),!1):void 0})))},_mouseDrag:function(e){if(this.dragged=!0,!this.options.disabled){var i,n=this,a=this.options,s=this.opos[0],o=this.opos[1],r=e.pageX,l=e.pageY;return s>r&&(i=r,r=s,s=i),o>l&&(i=l,l=o,o=i),this.helper.css({left:s,top:o,width:r-s,height:l-o}),this.selectees.each((function(){var i=t.data(this,"selectable-item"),c=!1;i&&i.element!==n.element[0]&&("touch"===a.tolerance?c=!(i.left>r||s>i.right||i.top>l||o>i.bottom):"fit"===a.tolerance&&(c=i.left>s&&r>i.right&&i.top>o&&l>i.bottom),c?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,n._trigger("selecting",e,{selecting:i.element}))):(i.selecting&&((e.metaKey||e.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),n._trigger("unselecting",e,{unselecting:i.element}))),i.selected&&(e.metaKey||e.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,n._trigger("unselecting",e,{unselecting:i.element})))))})),!1}},_mouseStop:function(e){var i=this;return this.dragged=!1,t(".ui-unselecting",this.element[0]).each((function(){var n=t.data(this,"selectable-item");n.$element.removeClass("ui-unselecting"),n.unselecting=!1,n.startselected=!1,i._trigger("unselected",e,{unselected:n.element})})),t(".ui-selecting",this.element[0]).each((function(){var n=t.data(this,"selectable-item");n.$element.removeClass("ui-selecting").addClass("ui-selected"),n.selecting=!1,n.selected=!0,n.startselected=!0,i._trigger("selected",e,{selected:n.element})})),this._trigger("stop",e),this.helper.remove(),!1}}),t.widget("ui.selectmenu",{version:"1.11.4",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var t=this.element.uniqueId().attr("id");this.ids={element:t,button:t+"-button",menu:t+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var e=this;this.label=t("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(t){this.button.focus(),t.preventDefault()}}),this.element.hide(),this.button=t("<span>",{class:"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),t("<span>",{class:"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=t("<span>",{class:"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",(function(){e.menuItems||e._refreshMenu()})),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var e=this;this.menu=t("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=t("<div>",{class:"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(t,i){t.preventDefault(),e._setSelection(),e._select(i.item.data("ui-selectmenu-item"),t)},focus:function(t,i){var n=i.item.data("ui-selectmenu-item");null!=e.focusIndex&&n.index!==e.focusIndex&&(e._trigger("focus",t,{item:n}),e.isOpen||e._select(n,t)),e.focusIndex=n.index,e.button.attr("aria-activedescendant",e.menuItems.eq(n.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var t,e=this.element.find("option");e.length&&(this._parseOptions(e),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),t=this._getSelectedItem(),this.menuInstance.focus(null,t),this._setAria(t.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(t){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",t))},_position:function(){this.menuWrap.position(t.extend({of:this.button},this.options.position))},close:function(t){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",t))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(e,i){var n=this,a="";t.each(i,(function(i,s){s.optgroup!==a&&(t("<li>",{class:"ui-selectmenu-optgroup ui-menu-divider"+(s.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:s.optgroup}).appendTo(e),a=s.optgroup),n._renderItemData(e,s)}))},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-selectmenu-item",e)},_renderItem:function(e,i){var n=t("<li>");return i.disabled&&n.addClass("ui-state-disabled"),this._setText(n,i.label),n.appendTo(e)},_setText:function(t,e){e?t.text(e):t.html("&#160;")},_move:function(t,e){var i,n,a=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex):(i=this.menuItems.eq(this.element[0].selectedIndex),a+=":not(.ui-state-disabled)"),(n="first"===t||"last"===t?i["first"===t?"prevAll":"nextAll"](a).eq(-1):i[t+"All"](a).eq(0)).length&&this.menuInstance.focus(e,n)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(t){this[this.isOpen?"close":"open"](t)},_setSelection:function(){var t;this.range&&(window.getSelection?((t=window.getSelection()).removeAllRanges(),t.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(e){this.isOpen&&(t(e.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(e))}},_buttonEvents:{mousedown:function(){var t;window.getSelection?(t=window.getSelection()).rangeCount&&(this.range=t.getRangeAt(0)):this.range=document.selection.createRange()},click:function(t){this._setSelection(),this._toggle(t)},keydown:function(e){var i=!0;switch(e.keyCode){case t.ui.keyCode.TAB:case t.ui.keyCode.ESCAPE:this.close(e),i=!1;break;case t.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(e);break;case t.ui.keyCode.UP:e.altKey?this._toggle(e):this._move("prev",e);break;case t.ui.keyCode.DOWN:e.altKey?this._toggle(e):this._move("next",e);break;case t.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(e):this._toggle(e);break;case t.ui.keyCode.LEFT:this._move("prev",e);break;case t.ui.keyCode.RIGHT:this._move("next",e);break;case t.ui.keyCode.HOME:case t.ui.keyCode.PAGE_UP:this._move("first",e);break;case t.ui.keyCode.END:case t.ui.keyCode.PAGE_DOWN:this._move("last",e);break;default:this.menu.trigger(e),i=!1}i&&e.preventDefault()}},_selectFocusedItem:function(t){var e=this.menuItems.eq(this.focusIndex);e.hasClass("ui-state-disabled")||this._select(e.data("ui-selectmenu-item"),t)},_select:function(t,e){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=t.index,this._setText(this.buttonText,t.label),this._setAria(t),this._trigger("select",e,{item:t}),t.index!==i&&this._trigger("change",e,{item:t}),this.close(e)},_setAria:function(t){var e=this.menuItems.eq(t.index).attr("id");this.button.attr({"aria-labelledby":e,"aria-activedescendant":e}),this.menu.attr("aria-activedescendant",e)},_setOption:function(t,e){"icons"===t&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(e.button),this._super(t,e),"appendTo"===t&&this.menuWrap.appendTo(this._appendTo()),"disabled"===t&&(this.menuInstance.option("disabled",e),this.button.toggleClass("ui-state-disabled",e).attr("aria-disabled",e),this.element.prop("disabled",e),e?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===t&&this._resizeButton()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(".ui-front")),e.length||(e=this.document[0].body),e},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var t=this.options.width;t||(t=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(t)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(e){var i=[];e.each((function(e,n){var a=t(n),s=a.parent("optgroup");i.push({element:a,index:e,value:a.val(),label:a.text(),optgroup:s.attr("label")||"",disabled:s.prop("disabled")||a.prop("disabled")})})),this.items=i},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),t.widget("ui.slider",t.ui.mouse,{version:"1.11.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,i,n=this.options,a=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),s=[];for(i=n.values&&n.values.length||1,a.length>i&&(a.slice(i).remove(),a=a.slice(0,i)),e=a.length;i>e;e++)s.push("<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>");this.handles=a.add(t(s.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each((function(e){t(this).data("ui-slider-handle-index",e)}))},_createRange:function(){var e=this.options,i="";e.range?(!0===e.range&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:t.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=t("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===e.range||"max"===e.range?" ui-slider-range-"+e.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(e){var i,n,a,s,o,r,l,c=this,d=this.options;return!d.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(i),a=this._valueMax()-this._valueMin()+1,this.handles.each((function(e){var i=Math.abs(n-c.values(e));(a>i||a===i&&(e===c._lastChangedValue||c.values(e)===d.min))&&(a=i,s=t(this),o=e)})),!1!==this._start(e,o)&&(this._mouseSliding=!0,this._handleIndex=o,s.addClass("ui-state-active").focus(),r=s.offset(),l=!t(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:e.pageX-r.left-s.width()/2,top:e.pageY-r.top-s.height()/2-(parseInt(s.css("borderTopWidth"),10)||0)-(parseInt(s.css("borderBottomWidth"),10)||0)+(parseInt(s.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,o,n),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,i,n,a,s;return"horizontal"===this.orientation?(e=this.elementSize.width,i=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,i=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),(n=i/e)>1&&(n=1),0>n&&(n=0),"vertical"===this.orientation&&(n=1-n),a=this._valueMax()-this._valueMin(),s=this._valueMin()+n*a,this._trimAlignValue(s)},_start:function(t,e){var i={handle:this.handles[e],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("start",t,i)},_slide:function(t,e,i){var n,a,s;this.options.values&&this.options.values.length?(n=this.values(e?0:1),2===this.options.values.length&&!0===this.options.range&&(0===e&&i>n||1===e&&n>i)&&(i=n),i!==this.values(e)&&((a=this.values())[e]=i,s=this._trigger("slide",t,{handle:this.handles[e],value:i,values:a}),n=this.values(e?0:1),!1!==s&&this.values(e,i))):i!==this.value()&&(!1!==(s=this._trigger("slide",t,{handle:this.handles[e],value:i}))&&this.value(i))},_stop:function(t,e){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("stop",t,i)},_change:function(t,e){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._lastChangedValue=e,this._trigger("change",t,i)}},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),void this._change(null,0)):this._value()},values:function(e,i){var n,a,s;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(i),this._refreshValue(),void this._change(null,e);if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(e):this.value();for(n=this.options.values,a=arguments[0],s=0;n.length>s;s+=1)n[s]=this._trimAlignValue(a[s]),this._change(null,s);this._refreshValue()},_setOption:function(e,i){var n,a=0;switch("range"===e&&!0===this.options.range&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),t.isArray(this.options.values)&&(a=this.options.values.length),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!i),this._super(e,i),e){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue(),this.handles.css("horizontal"===i?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),n=0;a>n;n+=1)this._change(null,n);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var t=this.options.value;return this._trimAlignValue(t)},_values:function(t){var e,i,n;if(arguments.length)return e=this.options.values[t],this._trimAlignValue(e);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),n=0;i.length>n;n+=1)i[n]=this._trimAlignValue(i[n]);return i}return[]},_trimAlignValue:function(t){if(this._valueMin()>=t)return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,i=(t-this._valueMin())%e,n=t-i;return 2*Math.abs(i)>=e&&(n+=i>0?e:-e),parseFloat(n.toFixed(5))},_calculateNewMax:function(){var t=this.options.max,e=this._valueMin(),i=this.options.step;t=Math.floor(+(t-e).toFixed(this._precision())/i)*i+e,this.max=parseFloat(t.toFixed(this._precision()))},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=""+t,i=e.indexOf(".");return-1===i?0:e.length-i-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var e,i,n,a,s,o=this.options.range,r=this.options,l=this,c=!this._animateOff&&r.animate,d={};this.options.values&&this.options.values.length?this.handles.each((function(n){i=(l.values(n)-l._valueMin())/(l._valueMax()-l._valueMin())*100,d["horizontal"===l.orientation?"left":"bottom"]=i+"%",t(this).stop(1,1)[c?"animate":"css"](d,r.animate),!0===l.options.range&&("horizontal"===l.orientation?(0===n&&l.range.stop(1,1)[c?"animate":"css"]({left:i+"%"},r.animate),1===n&&l.range[c?"animate":"css"]({width:i-e+"%"},{queue:!1,duration:r.animate})):(0===n&&l.range.stop(1,1)[c?"animate":"css"]({bottom:i+"%"},r.animate),1===n&&l.range[c?"animate":"css"]({height:i-e+"%"},{queue:!1,duration:r.animate}))),e=i})):(n=this.value(),a=this._valueMin(),s=this._valueMax(),i=s!==a?(n-a)/(s-a)*100:0,d["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[c?"animate":"css"](d,r.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:i+"%"},r.animate),"max"===o&&"horizontal"===this.orientation&&this.range[c?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:r.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:i+"%"},r.animate),"max"===o&&"vertical"===this.orientation&&this.range[c?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:r.animate}))},_handleEvents:{keydown:function(e){var i,n,a,s=t(e.target).data("ui-slider-handle-index");switch(e.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(e.preventDefault(),!this._keySliding&&(this._keySliding=!0,t(e.target).addClass("ui-state-active"),!1===this._start(e,s)))return}switch(a=this.options.step,i=n=this.options.values&&this.options.values.length?this.values(s):this.value(),e.keyCode){case t.ui.keyCode.HOME:n=this._valueMin();break;case t.ui.keyCode.END:n=this._valueMax();break;case t.ui.keyCode.PAGE_UP:n=this._trimAlignValue(i+(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(i-(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(i===this._valueMax())return;n=this._trimAlignValue(i+a);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(i===this._valueMin())return;n=this._trimAlignValue(i-a)}this._slide(e,s,n)},keyup:function(e){var i=t(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,i),this._change(e,i),t(e.target).removeClass("ui-state-active"))}}}),t.widget("ui.sortable",t.ui.mouse,{version:"1.11.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,i){return t>=e&&e+i>t},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),"handle"===t&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),t.each(this.items,(function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")}))},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(e,i){var n=null,a=!1,s=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(e),t(e.target).parents().each((function(){return t.data(this,s.widgetName+"-item")===s?(n=t(this),!1):void 0})),t.data(e.target,s.widgetName+"-item")===s&&(n=t(e.target)),!!n&&(!(this.options.handle&&!i&&(t(this.options.handle,n).find("*").addBack().each((function(){this===e.target&&(a=!0)})),!a))&&(this.currentItem=n,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(e,i,n){var a,s,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(s=this.document.find("body"),this.storedCursor=s.css("cursor"),s.css("cursor",o.cursor),this.storedStylesheet=t("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(s)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!n)for(a=this.containers.length-1;a>=0;a--)this.containers[a]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var i,n,a,s,o=this.options,r=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+o.scrollSpeed:e.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+o.scrollSpeed:e.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(e.pageY-this.document.scrollTop()<o.scrollSensitivity?r=this.document.scrollTop(this.document.scrollTop()-o.scrollSpeed):this.window.height()-(e.pageY-this.document.scrollTop())<o.scrollSensitivity&&(r=this.document.scrollTop(this.document.scrollTop()+o.scrollSpeed)),e.pageX-this.document.scrollLeft()<o.scrollSensitivity?r=this.document.scrollLeft(this.document.scrollLeft()-o.scrollSpeed):this.window.width()-(e.pageX-this.document.scrollLeft())<o.scrollSensitivity&&(r=this.document.scrollLeft(this.document.scrollLeft()+o.scrollSpeed))),!1!==r&&t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(a=(n=this.items[i]).item[0],(s=this._intersectsWithPointer(n))&&n.instance===this.currentContainer&&a!==this.currentItem[0]&&this.placeholder[1===s?"next":"prev"]()[0]!==a&&!t.contains(this.placeholder[0],a)&&("semi-dynamic"!==this.options.type||!t.contains(this.element[0],a))){if(this.direction=1===s?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(n))break;this._rearrange(e,n),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var n=this,a=this.placeholder.offset(),s=this.options.axis,o={};s&&"x"!==s||(o.left=a.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),s&&"y"!==s||(o.top=a.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(o,parseInt(this.options.revert,10)||500,(function(){n._clear(e)}))}else this._clear(e,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),n=[];return e=e||{},t(i).each((function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);i&&n.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))})),!n.length&&e.key&&n.push(e.key+"="),n.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),n=[];return e=e||{},i.each((function(){n.push(t(e.item||this).attr(e.attribute||"id")||"")})),n},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,n=this.positionAbs.top,a=n+this.helperProportions.height,s=t.left,o=s+t.width,r=t.top,l=r+t.height,c=this.offset.click.top,d=this.offset.click.left,u="x"===this.options.axis||n+c>r&&l>n+c,h="y"===this.options.axis||e+d>s&&o>e+d,p=u&&h;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?p:e+this.helperProportions.width/2>s&&o>i-this.helperProportions.width/2&&n+this.helperProportions.height/2>r&&l>a-this.helperProportions.height/2},_intersectsWithPointer:function(t){var e="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),i="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),n=e&&i,a=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return!!n&&(this.floating?s&&"right"===s||"down"===a?2:1:a&&("down"===a?2:1))},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),n=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return this.floating&&a?"right"===a&&i||"left"===a&&!i:n&&("down"===n&&e||"up"===n&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){function i(){r.push(this)}var n,a,s,o,r=[],l=[],c=this._connectWith();if(c&&e)for(n=c.length-1;n>=0;n--)for(a=(s=t(c[n],this.document[0])).length-1;a>=0;a--)(o=t.data(s[a],this.widgetFullName))&&o!==this&&!o.options.disabled&&l.push([t.isFunction(o.options.items)?o.options.items.call(o.element):t(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(l.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=l.length-1;n>=0;n--)l[n][0].each(i);return t(r)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,(function(t){for(var i=0;e.length>i;i++)if(e[i]===t.item[0])return!1;return!0}))},_refreshItems:function(e){this.items=[],this.containers=[this];var i,n,a,s,o,r,l,c,d=this.items,u=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],h=this._connectWith();if(h&&this.ready)for(i=h.length-1;i>=0;i--)for(n=(a=t(h[i],this.document[0])).length-1;n>=0;n--)(s=t.data(a[n],this.widgetFullName))&&s!==this&&!s.options.disabled&&(u.push([t.isFunction(s.options.items)?s.options.items.call(s.element[0],e,{item:this.currentItem}):t(s.options.items,s.element),s]),this.containers.push(s));for(i=u.length-1;i>=0;i--)for(o=u[i][1],n=0,c=(r=u[i][0]).length;c>n;n++)(l=t(r[n])).data(this.widgetName+"-item",o),d.push({item:l,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(e){var i,n,a,s;for(this.floating=!!this.items.length&&("x"===this.options.axis||this._isFloating(this.items[0].item)),this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset()),i=this.items.length-1;i>=0;i--)(n=this.items[i]).instance!==this.currentContainer&&this.currentContainer&&n.item[0]!==this.currentItem[0]||(a=this.options.toleranceElement?t(this.options.toleranceElement,n.item):n.item,e||(n.width=a.outerWidth(),n.height=a.outerHeight()),s=a.offset(),n.left=s.left,n.top=s.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)s=this.containers[i].element.offset(),this.containers[i].containerCache.left=s.left,this.containers[i].containerCache.top=s.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(e){var i,n=(e=e||this).options;n.placeholder&&n.placeholder.constructor!==String||(i=n.placeholder,n.placeholder={element:function(){var n=e.currentItem[0].nodeName.toLowerCase(),a=t("<"+n+">",e.document[0]).addClass(i||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tbody"===n?e._createTrPlaceholder(e.currentItem.find("tr").eq(0),t("<tr>",e.document[0]).appendTo(a)):"tr"===n?e._createTrPlaceholder(e.currentItem,a):"img"===n&&a.attr("src",e.currentItem.attr("src")),i||a.css("visibility","hidden"),a},update:function(t,a){(!i||n.forcePlaceholderSize)&&(a.height()||a.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),a.width()||a.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(n.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),n.placeholder.update(e,e.placeholder)},_createTrPlaceholder:function(e,i){var n=this;e.children().each((function(){t("<td>&#160;</td>",n.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(i)}))},_contactContainers:function(e){var i,n,a,s,o,r,l,c,d,u,h=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!t.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(h&&t.contains(this.containers[i].element[0],h.element[0]))continue;h=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",e,this._uiHash(this)),this.containers[i].containerCache.over=0);if(h)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(a=1e4,s=null,o=(d=h.floating||this._isFloating(this.currentItem))?"left":"top",r=d?"width":"height",u=d?"clientX":"clientY",n=this.items.length-1;n>=0;n--)t.contains(this.containers[p].element[0],this.items[n].item[0])&&this.items[n].item[0]!==this.currentItem[0]&&(l=this.items[n].item.offset()[o],c=!1,e[u]-l>this.items[n][r]/2&&(c=!0),a>Math.abs(e[u]-l)&&(a=Math.abs(e[u]-l),s=this.items[n],this.direction=c?"up":"down"));if(!s&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return void(this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash()),this.currentContainer.containerCache.over=1));s?this._rearrange(e,s,null,!0):this._rearrange(e,null,this.containers[p].element,!0),this._trigger("change",e,this._uiHash()),this.containers[p]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(e){var i=this.options,n=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return n.parents("body").length||t("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(n[0]),n[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!n[0].style.width||i.forceHelperSize)&&n.width(this.currentItem.width()),(!n[0].style.height||i.forceHelperSize)&&n.height(this.currentItem.height()),n},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,n,a=this.options;"parent"===a.containment&&(a.containment=this.helper[0].parentNode),("document"===a.containment||"window"===a.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===a.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===a.containment?this.document.width():this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(a.containment)||(e=t(a.containment)[0],i=t(a.containment).offset(),n="hidden"!==t(e).css("overflow"),this.containment=[i.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,i.left+(n?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(n?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,i){i||(i=this.position);var n="absolute"===e?1:-1,a="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(a[0].tagName);return{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:a.scrollTop())*n,left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:a.scrollLeft())*n}},_generatePosition:function(e){var i,n,a=this.options,s=e.pageX,o=e.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),a.grid&&(i=this.originalPageY+Math.round((o-this.originalPageY)/a.grid[1])*a.grid[1],o=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-a.grid[1]:i+a.grid[1]:i,n=this.originalPageX+Math.round((s-this.originalPageX)/a.grid[0])*a.grid[0],s=this.containment?n-this.offset.click.left>=this.containment[0]&&n-this.offset.click.left<=this.containment[2]?n:n-this.offset.click.left>=this.containment[0]?n-a.grid[0]:n+a.grid[0]:n)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:r.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:r.scrollLeft())}},_rearrange:function(t,e,i,n){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var a=this.counter;this._delay((function(){a===this.counter&&this.refreshPositions(!n)}))},_clear:function(t,e){function i(t,e,i){return function(n){i._trigger(t,n,e._uiHash(e))}}this.reverting=!1;var n,a=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)("auto"===this._storedCSS[n]||"static"===this._storedCSS[n])&&(this._storedCSS[n]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&a.push((function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))})),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||a.push((function(t){this._trigger("update",t,this._uiHash())})),this!==this.currentContainer&&(e||(a.push((function(t){this._trigger("remove",t,this._uiHash())})),a.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),a.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),n=this.containers.length-1;n>=0;n--)e||a.push(i("deactivate",this,this.containers[n])),this.containers[n].containerCache.over&&(a.push(i("out",this,this.containers[n])),this.containers[n].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(n=0;a.length>n;n++)a[n].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===t.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}}),t.widget("ui.spinner",{version:"1.11.4",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var e={},i=this.element;return t.each(["min","max","step"],(function(t,n){var a=i.attr(n);void 0!==a&&a.length&&(e[n]=a)})),e},_events:{keydown:function(t){this._start(t)&&this._keydown(t)&&t.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",t)))},mousewheel:function(t,e){if(e){if(!this.spinning&&!this._start(t))return!1;this._spin((e>0?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay((function(){this.spinning&&this._stop(t)}),100),t.preventDefault()}},"mousedown .ui-spinner-button":function(e){function i(){this.element[0]===this.document[0].activeElement||(this.element.focus(),this.previous=n,this._delay((function(){this.previous=n})))}var n;n=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),e.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay((function(){delete this.cancelBlur,i.call(this)})),!1!==this._start(e)&&this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){return t(e.currentTarget).hasClass("ui-state-active")?!1!==this._start(e)&&void this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var t=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=t.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*t.height())&&t.height()>0&&t.height(t.height()),this.options.disabled&&this.disable()},_keydown:function(e){var i=this.options,n=t.ui.keyCode;switch(e.keyCode){case n.UP:return this._repeat(null,1,e),!0;case n.DOWN:return this._repeat(null,-1,e),!0;case n.PAGE_UP:return this._repeat(null,i.page,e),!0;case n.PAGE_DOWN:return this._repeat(null,-i.page,e),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(t){return!(!this.spinning&&!1===this._trigger("start",t))&&(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(t,e,i){t=t||500,clearTimeout(this.timer),this.timer=this._delay((function(){this._repeat(40,e,i)}),t),this._spin(e*this.options.step,i)},_spin:function(t,e){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+t*this._increment(this.counter)),this.spinning&&!1===this._trigger("spin",e,{value:i})||(this._value(i),this.counter++)},_increment:function(e){var i=this.options.incremental;return i?t.isFunction(i)?i(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=""+t,i=e.indexOf(".");return-1===i?0:e.length-i-1},_adjustValue:function(t){var e,i,n=this.options;return i=t-(e=null!==n.min?n.min:0),t=e+(i=Math.round(i/n.step)*n.step),t=parseFloat(t.toFixed(this._precision())),null!==n.max&&t>n.max?n.max:null!==n.min&&n.min>t?n.min:t},_stop:function(t){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",t))},_setOption:function(t,e){if("culture"===t||"numberFormat"===t){var i=this._parse(this.element.val());return this.options[t]=e,void this.element.val(this._format(i))}("max"===t||"min"===t||"step"===t)&&"string"==typeof e&&(e=this._parse(e)),"icons"===t&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(e.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(e.down)),this._super(t,e),"disabled"===t&&(this.widget().toggleClass("ui-state-disabled",!!e),this.element.prop("disabled",!!e),this.buttons.button(e?"disable":"enable"))},_setOptions:r((function(t){this._super(t)})),_parse:function(t){return"string"==typeof t&&""!==t&&(t=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t),""===t||isNaN(t)?null:t},_format:function(t){return""===t?"":window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):t},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var t=this.value();return null!==t&&t===this._adjustValue(t)},_value:function(t,e){var i;""!==t&&(null!==(i=this._parse(t))&&(e||(i=this._adjustValue(i)),t=this._format(i))),this.element.val(t),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:r((function(t){this._stepUp(t)})),_stepUp:function(t){this._start()&&(this._spin((t||1)*this.options.step),this._stop())},stepDown:r((function(t){this._stepDown(t)})),_stepDown:function(t){this._start()&&(this._spin((t||1)*-this.options.step),this._stop())},pageUp:r((function(t){this._stepUp((t||1)*this.options.page)})),pageDown:r((function(t){this._stepDown((t||1)*this.options.page)})),value:function(t){return arguments.length?void r(this._value).call(this,t):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),t.widget("ui.tabs",{version:"1.11.4",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var t=/#.*$/;return function(e){var i,n;i=(e=e.cloneNode(!1)).href.replace(t,""),n=location.href.replace(t,"");try{i=decodeURIComponent(i)}catch(t){}try{n=decodeURIComponent(n)}catch(t){}return e.hash.length>1&&i===n}}(),_create:function(){var e=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible),this._processTabs(),i.active=this._initialActive(),t.isArray(i.disabled)&&(i.disabled=t.unique(i.disabled.concat(t.map(this.tabs.filter(".ui-state-disabled"),(function(t){return e.tabs.index(t)})))).sort()),this.active=!1!==this.options.active&&this.anchors.length?this._findActive(i.active):t(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var e=this.options.active,i=this.options.collapsible,n=location.hash.substring(1);return null===e&&(n&&this.tabs.each((function(i,a){return t(a).attr("aria-controls")===n?(e=i,!1):void 0})),null===e&&(e=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===e||-1===e)&&(e=!!this.tabs.length&&0)),!1!==e&&(-1===(e=this.tabs.index(this.tabs.eq(e)))&&(e=!i&&0)),!i&&!1===e&&this.anchors.length&&(e=0),e},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):t()}},_tabKeydown:function(e){var i=t(this.document[0].activeElement).closest("li"),n=this.tabs.index(i),a=!0;if(!this._handlePageNav(e)){switch(e.keyCode){case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:n++;break;case t.ui.keyCode.UP:case t.ui.keyCode.LEFT:a=!1,n--;break;case t.ui.keyCode.END:n=this.anchors.length-1;break;case t.ui.keyCode.HOME:n=0;break;case t.ui.keyCode.SPACE:return e.preventDefault(),clearTimeout(this.activating),void this._activate(n);case t.ui.keyCode.ENTER:return e.preventDefault(),clearTimeout(this.activating),void this._activate(n!==this.options.active&&n);default:return}e.preventDefault(),clearTimeout(this.activating),n=this._focusNextTab(n,a),e.ctrlKey||e.metaKey||(i.attr("aria-selected","false"),this.tabs.eq(n).attr("aria-selected","true"),this.activating=this._delay((function(){this.option("active",n)}),this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===t.ui.keyCode.UP&&(e.preventDefault(),this.active.focus())},_handlePageNav:function(e){return e.altKey&&e.keyCode===t.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):e.altKey&&e.keyCode===t.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(e,i){for(var n=this.tabs.length-1;-1!==t.inArray((e>n&&(e=0),0>e&&(e=n),e),this.options.disabled);)e=i?e+1:e-1;return e},_focusNextTab:function(t,e){return t=this._findNextTab(t,e),this.tabs.eq(t).focus(),t},_setOption:function(t,e){return"active"===t?void this._activate(e):"disabled"===t?void this._setupDisabled(e):(this._super(t,e),"collapsible"===t&&(this.element.toggleClass("ui-tabs-collapsible",e),e||!1!==this.options.active||this._activate(0)),"event"===t&&this._setupEvents(e),void("heightStyle"===t&&this._setupHeightStyle(e)))},_sanitizeSelector:function(t){return t?t.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,i=this.tablist.children(":has(a[href])");e.disabled=t.map(i.filter(".ui-state-disabled"),(function(t){return i.index(t)})),this._processTabs(),!1!==e.active&&this.anchors.length?this.active.length&&!t.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=t()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=t()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var e=this,i=this.tabs,n=this.anchors,a=this.panels;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,(function(e){t(this).is(".ui-state-disabled")&&e.preventDefault()})).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,(function(){t(this).closest("li").is(".ui-state-disabled")&&this.blur()})),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map((function(){return t("a",this)[0]})).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=t(),this.anchors.each((function(i,n){var a,s,o,r=t(n).uniqueId().attr("id"),l=t(n).closest("li"),c=l.attr("aria-controls");e._isLocal(n)?(o=(a=n.hash).substring(1),s=e.element.find(e._sanitizeSelector(a))):(a="#"+(o=l.attr("aria-controls")||t({}).uniqueId()[0].id),(s=e.element.find(a)).length||(s=e._createPanel(o)).insertAfter(e.panels[i-1]||e.tablist),s.attr("aria-live","polite")),s.length&&(e.panels=e.panels.add(s)),c&&l.data("ui-tabs-aria-controls",c),l.attr({"aria-controls":o,"aria-labelledby":r}),s.attr("aria-labelledby",r)})),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel"),i&&(this._off(i.not(this.tabs)),this._off(n.not(this.anchors)),this._off(a.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(e){return t("<div>").attr("id",e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(e){t.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1);for(var i,n=0;i=this.tabs[n];n++)!0===e||-1!==t.inArray(n,e)?t(i).addClass("ui-state-disabled").attr("aria-disabled","true"):t(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=e},_setupEvents:function(e){var i={};e&&t.each(e.split(" "),(function(t,e){i[e]="_eventHandler"})),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(t){t.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var i,n=this.element.parent();"fill"===e?(i=n.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each((function(){var e=t(this),n=e.css("position");"absolute"!==n&&"fixed"!==n&&(i-=e.outerHeight(!0))})),this.element.children().not(this.panels).each((function(){i-=t(this).outerHeight(!0)})),this.panels.each((function(){t(this).height(Math.max(0,i-t(this).innerHeight()+t(this).height()))})).css("overflow","auto")):"auto"===e&&(i=0,this.panels.each((function(){i=Math.max(i,t(this).height("").height())})).height(i))},_eventHandler:function(e){var i=this.options,n=this.active,a=t(e.currentTarget).closest("li"),s=a[0]===n[0],o=s&&i.collapsible,r=o?t():this._getPanelForTab(a),l=n.length?this._getPanelForTab(n):t(),c={oldTab:n,oldPanel:l,newTab:o?t():a,newPanel:r};e.preventDefault(),a.hasClass("ui-state-disabled")||a.hasClass("ui-tabs-loading")||this.running||s&&!i.collapsible||!1===this._trigger("beforeActivate",e,c)||(i.active=!o&&this.tabs.index(a),this.active=s?t():a,this.xhr&&this.xhr.abort(),l.length||r.length||t.error("jQuery UI Tabs: Mismatching fragment identifier."),r.length&&this.load(this.tabs.index(a),e),this._toggle(e,c))},_toggle:function(e,i){function n(){s.running=!1,s._trigger("activate",e,i)}function a(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&s.options.show?s._show(o,s.options.show,n):(o.show(),n())}var s=this,o=i.newPanel,r=i.oldPanel;this.running=!0,r.length&&this.options.hide?this._hide(r,this.options.hide,(function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),a()})):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),r.hide(),a()),r.attr("aria-hidden","true"),i.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),o.length&&r.length?i.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter((function(){return 0===t(this).attr("tabIndex")})).attr("tabIndex",-1),o.attr("aria-hidden","false"),i.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(e){var i,n=this._findActive(e);n[0]!==this.active[0]&&(n.length||(n=this.active),i=n.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return!1===e?t():this.tabs.eq(e)},_getIndex:function(t){return"string"==typeof t&&(t=this.anchors.index(this.anchors.filter("[href$='"+t+"']"))),t},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each((function(){t.data(this,"ui-tabs-destroy")?t(this).remove():t(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")})),this.tabs.each((function(){var e=t(this),i=e.data("ui-tabs-aria-controls");i?e.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):e.removeAttr("aria-controls")})),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(e){var i=this.options.disabled;!1!==i&&(void 0===e?i=!1:(e=this._getIndex(e),i=t.isArray(i)?t.map(i,(function(t){return t!==e?t:null})):t.map(this.tabs,(function(t,i){return i!==e?i:null}))),this._setupDisabled(i))},disable:function(e){var i=this.options.disabled;if(!0!==i){if(void 0===e)i=!0;else{if(e=this._getIndex(e),-1!==t.inArray(e,i))return;i=t.isArray(i)?t.merge([e],i).sort():[e]}this._setupDisabled(i)}},load:function(e,i){e=this._getIndex(e);var n=this,a=this.tabs.eq(e),s=a.find(".ui-tabs-anchor"),o=this._getPanelForTab(a),r={tab:a,panel:o},l=function(t,e){"abort"===e&&n.panels.stop(!1,!0),a.removeClass("ui-tabs-loading"),o.removeAttr("aria-busy"),t===n.xhr&&delete n.xhr};this._isLocal(s[0])||(this.xhr=t.ajax(this._ajaxSettings(s,i,r)),this.xhr&&"canceled"!==this.xhr.statusText&&(a.addClass("ui-tabs-loading"),o.attr("aria-busy","true"),this.xhr.done((function(t,e,a){setTimeout((function(){o.html(t),n._trigger("load",i,r),l(a,e)}),1)})).fail((function(t,e){setTimeout((function(){l(t,e)}),1)}))))},_ajaxSettings:function(e,i,n){var a=this;return{url:e.attr("href"),beforeSend:function(e,s){return a._trigger("beforeLoad",i,t.extend({jqXHR:e,ajaxSettings:s},n))}}},_getPanelForTab:function(e){var i=t(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}}),t.widget("ui.tooltip",{version:"1.11.4",options:{content:function(){var e=t(this).attr("title")||"";return t("<a>").text(e).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(e,i){var n=(e.attr("aria-describedby")||"").split(/\s+/);n.push(i),e.data("ui-tooltip-id",i).attr("aria-describedby",t.trim(n.join(" ")))},_removeDescribedBy:function(e){var i=e.data("ui-tooltip-id"),n=(e.attr("aria-describedby")||"").split(/\s+/),a=t.inArray(i,n);-1!==a&&n.splice(a,1),e.removeData("ui-tooltip-id"),(n=t.trim(n.join(" ")))?e.attr("aria-describedby",n):e.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=t("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(e,i){var n=this;return"disabled"===e?(this[i?"_disable":"_enable"](),void(this.options[e]=i)):(this._super(e,i),void("content"===e&&t.each(this.tooltips,(function(t,e){n._updateContent(e.element)}))))},_disable:function(){var e=this;t.each(this.tooltips,(function(i,n){var a=t.Event("blur");a.target=a.currentTarget=n.element[0],e.close(a,!0)})),this.element.find(this.options.items).addBack().each((function(){var e=t(this);e.is("[title]")&&e.data("ui-tooltip-title",e.attr("title")).removeAttr("title")}))},_enable:function(){this.element.find(this.options.items).addBack().each((function(){var e=t(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))}))},open:function(e){var i=this,n=t(e?e.target:this.element).closest(this.options.items);n.length&&!n.data("ui-tooltip-id")&&(n.attr("title")&&n.data("ui-tooltip-title",n.attr("title")),n.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&n.parents().each((function(){var e,n=t(this);n.data("ui-tooltip-open")&&((e=t.Event("blur")).target=e.currentTarget=this,i.close(e,!0)),n.attr("title")&&(n.uniqueId(),i.parents[this.id]={element:this,title:n.attr("title")},n.attr("title",""))})),this._registerCloseHandlers(e,n),this._updateContent(n,e))},_updateContent:function(t,e){var i,n=this.options.content,a=this,s=e?e.type:null;return"string"==typeof n?this._open(e,t,n):void((i=n.call(t[0],(function(i){a._delay((function(){t.data("ui-tooltip-open")&&(e&&(e.type=s),this._open(e,t,i))}))})))&&this._open(e,t,i))},_open:function(e,i,n){function a(t){c.of=t,o.is(":hidden")||o.position(c)}var s,o,r,l,c=t.extend({},this.options.position);if(n){if(s=this._find(i))return void s.tooltip.find(".ui-tooltip-content").html(n);i.is("[title]")&&(e&&"mouseover"===e.type?i.attr("title",""):i.removeAttr("title")),s=this._tooltip(i),o=s.tooltip,this._addDescribedBy(i,o.attr("id")),o.find(".ui-tooltip-content").html(n),this.liveRegion.children().hide(),n.clone?(l=n.clone()).removeAttr("id").find("[id]").removeAttr("id"):l=n,t("<div>").html(l).appendTo(this.liveRegion),this.options.track&&e&&/^mouse/.test(e.type)?(this._on(this.document,{mousemove:a}),a(e)):o.position(t.extend({of:i},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.show&&this.options.show.delay&&(r=this.delayedShow=setInterval((function(){o.is(":visible")&&(a(c.of),clearInterval(r))}),t.fx.interval)),this._trigger("open",e,{tooltip:o})}},_registerCloseHandlers:function(e,i){var n={keyup:function(e){if(e.keyCode===t.ui.keyCode.ESCAPE){var n=t.Event(e);n.currentTarget=i[0],this.close(n,!0)}}};i[0]!==this.element[0]&&(n.remove=function(){this._removeTooltip(this._find(i).tooltip)}),e&&"mouseover"!==e.type||(n.mouseleave="close"),e&&"focusin"!==e.type||(n.focusout="close"),this._on(!0,i,n)},close:function(e){var i,n=this,a=t(e?e.currentTarget:this.element),s=this._find(a);return s?(i=s.tooltip,void(s.closing||(clearInterval(this.delayedShow),a.data("ui-tooltip-title")&&!a.attr("title")&&a.attr("title",a.data("ui-tooltip-title")),this._removeDescribedBy(a),s.hiding=!0,i.stop(!0),this._hide(i,this.options.hide,(function(){n._removeTooltip(t(this))})),a.removeData("ui-tooltip-open"),this._off(a,"mouseleave focusout keyup"),a[0]!==this.element[0]&&this._off(a,"remove"),this._off(this.document,"mousemove"),e&&"mouseleave"===e.type&&t.each(this.parents,(function(e,i){t(i.element).attr("title",i.title),delete n.parents[e]})),s.closing=!0,this._trigger("close",e,{tooltip:i}),s.hiding||(s.closing=!1)))):void a.removeData("ui-tooltip-open")},_tooltip:function(e){var i=t("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||"")),n=i.uniqueId().attr("id");return t("<div>").addClass("ui-tooltip-content").appendTo(i),i.appendTo(this.document[0].body),this.tooltips[n]={element:e,tooltip:i}},_find:function(t){var e=t.data("ui-tooltip-id");return e?this.tooltips[e]:null},_removeTooltip:function(t){t.remove(),delete this.tooltips[t.attr("id")]},_destroy:function(){var e=this;t.each(this.tooltips,(function(i,n){var a=t.Event("blur"),s=n.element;a.target=a.currentTarget=s[0],e.close(a,!0),t("#"+i).remove(),s.data("ui-tooltip-title")&&(s.attr("title")||s.attr("title",s.data("ui-tooltip-title")),s.removeData("ui-tooltip-title"))})),this.liveRegion.remove()}})})),function(t){t.anythingSlider=function(e,i){var n,a,s=this;s.el=e,s.$el=t(e).addClass("anythingBase").wrap('<div class="anythingSlider"><div class="anythingWindow" /></div>'),s.$el.data("AnythingSlider",s),s.init=function(){s.options=n=t.extend({},t.anythingSlider.defaults,i),s.initialized=!1,t.isFunction(n.onBeforeInitialize)&&s.$el.bind("before_initialize",n.onBeforeInitialize),s.$el.trigger("before_initialize",s),t('\x3c!--[if lte IE 8]><script>jQuery("body").addClass("as-oldie");<\/script><![endif]--\x3e').appendTo("body").remove(),s.$wrapper=s.$el.parent().closest("div.anythingSlider").addClass("anythingSlider-"+n.theme),s.$window=s.$el.closest("div.anythingWindow"),s.win=window,s.$win=t(s.win),s.$controls=t('<div class="anythingControls"></div>'),s.$nav=t('<ul class="thumbNav"><li><a><span></span></a></li></ul>'),s.$startStop=t('<a href="#" class="start-stop"></a>'),(n.buildStartStop||n.buildNavigation)&&s.$controls.appendTo(n.appendControlsTo&&t(n.appendControlsTo).length?t(n.appendControlsTo):s.$wrapper),n.buildNavigation&&s.$nav.appendTo(n.appendNavigationTo&&t(n.appendNavigationTo).length?t(n.appendNavigationTo):s.$controls),n.buildStartStop&&s.$startStop.appendTo(n.appendStartStopTo&&t(n.appendStartStopTo).length?t(n.appendStartStopTo):s.$controls),s.runTimes=t(".anythingBase").length,s.regex=new RegExp("panel"+s.runTimes+"-(\\d+)","i"),1===s.runTimes&&s.makeActive(),s.flag=!1,s.playing=n.autoPlay,s.slideshow=!1,s.hovered=!1,s.panelSize=[],s.currentPage=s.targetPage=n.startPanel=parseInt(n.startPanel,10)||1,n.changeBy=parseInt(n.changeBy,10)||1,a=(n.mode||"h").toLowerCase().match(/(h|v|f)/),a=n.vertical?"v":(a||["h"])[0],n.mode="v"===a?"vertical":"f"===a?"fade":"horizontal","f"===a&&(n.showMultiple=1,n.infiniteSlides=!1),s.adj=n.infiniteSlides?0:1,s.adjustMultiple=0,s.width=s.$el.width(),s.height=s.$el.height(),s.outerPad=[s.$wrapper.innerWidth()-s.$wrapper.width(),s.$wrapper.innerHeight()-s.$wrapper.height()],n.playRtl&&s.$wrapper.addClass("rtl"),n.expand&&(s.$outer=s.$wrapper.parent(),s.$window.css({width:"100%",height:"100%"}),s.checkResize()),n.buildStartStop&&s.buildAutoPlay(),n.buildArrows&&s.buildNextBackButtons(),n.autoPlay||(n.autoPlayLocked=!1),s.$lastPage=s.$targetPage=s.$currentPage,s.updateSlider(),t.isFunction(t.easing[n.easing])||(n.easing="swing"),n.pauseOnHover&&s.$wrapper.hover((function(){s.playing&&(s.$el.trigger("slideshow_paused",s),s.clearTimer(!0))}),(function(){s.playing&&(s.$el.trigger("slideshow_unpaused",s),s.startStop(s.playing,!0))})),s.slideControls(!1),s.$wrapper.bind("mouseenter mouseleave",(function(e){t(this)["mouseenter"===e.type?"addClass":"removeClass"]("anythingSlider-hovered"),s.hovered="mouseenter"===e.type,s.slideControls(s.hovered)})),t(document).keyup((function(t){if(n.enableKeyboard&&s.$wrapper.hasClass("activeSlider")&&!t.target.tagName.match("TEXTAREA|INPUT|SELECT")){if("vertical"!==n.mode&&(38===t.which||40===t.which))return;switch(t.which){case 39:case 40:s.goForward();break;case 37:case 38:s.goBack()}}})),s.currentPage=s.gotoHash()||n.startPanel||1,s.gotoPage(s.currentPage,!1,null,-1);var e="slideshow_paused slideshow_unpaused slide_init slide_begin slideshow_stop slideshow_start initialized swf_completed".split(" ");t.each("onShowPause onShowUnpause onSlideInit onSlideBegin onShowStop onShowStart onInitialized onSWFComplete".split(" "),(function(i,a){t.isFunction(n[a])&&s.$el.bind(e[i],n[a])})),t.isFunction(n.onSlideComplete)&&s.$el.bind("slide_complete",(function(){return setTimeout((function(){n.onSlideComplete(s)}),0),!1})),s.initialized=!0,s.$el.trigger("initialized",s),s.startStop(n.autoPlay)},s.updateSlider=function(){if(s.$el.children(".cloned").remove(),s.navTextVisible="hidden"!==s.$nav.find("span:first").css("visibility"),s.$nav.empty(),s.currentPage=s.currentPage||1,s.$items=s.$el.children(),s.pages=s.$items.length,s.dir="vertical"===n.mode?"top":"left",n.showMultiple="vertical"===n.mode?1:parseInt(n.showMultiple,10)||1,n.navigationSize=!1===n.navigationSize?0:parseInt(n.navigationSize,10)||0,s.$items.find("a").unbind("focus.AnythingSlider").bind("focus.AnythingSlider",(function(e){var i=t(this).closest(".panel"),a=s.$items.index(i)+s.adj;s.$items.find(".focusedLink").removeClass("focusedLink"),t(this).addClass("focusedLink"),s.$window.scrollLeft(0).scrollTop(0),-1!==a&&(a>=s.currentPage+n.showMultiple||a<s.currentPage)&&(s.gotoPage(a),e.preventDefault())})),n.showMultiple>1&&(n.showMultiple>s.pages&&(n.showMultiple=s.pages),s.adjustMultiple=n.infiniteSlides&&s.pages>1?0:n.showMultiple-1),s.$controls.add(s.$nav).add(s.$startStop).add(s.$forward).add(s.$back)[s.pages<=1?"hide":"show"](),s.pages>1&&s.buildNavigation(),"fade"!==n.mode&&n.infiniteSlides&&s.pages>1&&(s.$el.prepend(s.$items.filter(":last").clone().addClass("cloned")),n.showMultiple>1?s.$el.append(s.$items.filter(":lt("+n.showMultiple+")").clone().addClass("cloned multiple")):s.$el.append(s.$items.filter(":first").clone().addClass("cloned")),s.$el.find(".cloned").each((function(){t(this).find("a,input,textarea,select,button,area,form").attr({disabled:"disabled",name:""}),t(this).find("[id]").andSelf().removeAttr("id")}))),s.$items=s.$el.addClass(n.mode).children().addClass("panel"),s.setDimensions(),n.resizeContents?(s.$items.css("width",s.width),s.$wrapper.css("width",s.getDim(s.currentPage)[0]).add(s.$items).css("height",s.height)):s.$win.load((function(){s.setDimensions(),e=s.getDim(s.currentPage),s.$wrapper.css({width:e[0],height:e[1]}),s.setCurrentPage(s.currentPage,!1)})),s.currentPage>s.pages&&(s.currentPage=s.pages),s.setCurrentPage(s.currentPage,!1),s.$nav.find("a").eq(s.currentPage-1).addClass("cur"),"fade"===n.mode){var e=s.$items.eq(s.currentPage-1);n.resumeOnVisible?e.css({opacity:1}).siblings().css({opacity:0}):(s.$items.css("opacity",1),e.fadeIn(0).siblings().fadeOut(0))}},s.buildNavigation=function(){var e,i,a,o,r;n.buildNavigation&&s.pages>1&&(s.$items.filter(":not(.cloned)").each((function(l){r=t("<li/>"),i=(1===(a=l+1)?" first":"")+(a===s.pages?" last":""),e='<a class="panel'+a+(s.navTextVisible?'"':" "+n.tooltipClass+'" title="@"')+' href="#"><span>@</span></a>',t.isFunction(n.navigationFormatter)?"string"==typeof(o=n.navigationFormatter(a,t(this)))?r.html(e.replace(/@/g,o)):r=t("<li/>",o):r.html(e.replace(/@/g,a)),r.appendTo(s.$nav).addClass(i).data("index",a)})),s.$nav.children("li").bind(n.clickControls,(function(e){!s.flag&&n.enableNavigation&&(s.flag=!0,setTimeout((function(){s.flag=!1}),100),s.gotoPage(t(this).data("index"))),e.preventDefault()})),n.navigationSize&&n.navigationSize<s.pages&&(s.$controls.find(".anythingNavWindow").length||s.$nav.before('<ul><li class="prev"><a href="#"><span>'+n.backText+"</span></a></li></ul>").after('<ul><li class="next"><a href="#"><span>'+n.forwardText+"</span></a></li></ul>").wrap('<div class="anythingNavWindow"></div>'),s.navWidths=s.$nav.find("li").map((function(){return t(this).outerWidth(!0)+Math.ceil(parseInt(t(this).find("span").css("left"),10)/2||0)})).get(),s.navLeft=s.currentPage,s.$nav.width(s.navWidth(1,s.pages+1)+25),s.$controls.find(".anythingNavWindow").width(s.navWidth(1,n.navigationSize+1)).end().find(".prev,.next").bind(n.clickControls,(function(e){s.flag||(s.flag=!0,setTimeout((function(){s.flag=!1}),200),s.navWindow(s.navLeft+n.navigationSize*(t(this).is(".prev")?-1:1))),e.preventDefault()}))))},s.navWidth=function(t,e){var i,n=Math.min(t,e),a=Math.max(t,e),o=0;for(i=n;i<a;i++)o+=s.navWidths[i-1]||0;return o},s.navWindow=function(t){if(n.navigationSize&&n.navigationSize<s.pages&&s.navWidths){var e=s.pages-n.navigationSize+1;(t=t<=1?1:t>1&&t<e?t:e)!==s.navLeft&&(s.$controls.find(".anythingNavWindow").animate({scrollLeft:s.navWidth(1,t),width:s.navWidth(t,t+n.navigationSize)},{queue:!1,duration:n.animationTime}),s.navLeft=t)}},s.buildNextBackButtons=function(){s.$forward=t('<span class="arrow forward"><a href="#"><span>'+n.forwardText+"</span></a></span>"),s.$back=t('<span class="arrow back"><a href="#"><span>'+n.backText+"</span></a></span>"),s.$back.bind(n.clickBackArrow,(function(t){n.enableArrows&&!s.flag&&(s.flag=!0,setTimeout((function(){s.flag=!1}),100),s.goBack()),t.preventDefault()})),s.$forward.bind(n.clickForwardArrow,(function(t){n.enableArrows&&!s.flag&&(s.flag=!0,setTimeout((function(){s.flag=!1}),100),s.goForward()),t.preventDefault()})),s.$back.add(s.$forward).find("a").bind("focusin focusout",(function(){t(this).toggleClass("hover")})),s.$back.appendTo(n.appendBackTo&&t(n.appendBackTo).length?t(n.appendBackTo):s.$wrapper),s.$forward.appendTo(n.appendForwardTo&&t(n.appendForwardTo).length?t(n.appendForwardTo):s.$wrapper),s.arrowWidth=s.$forward.width(),s.arrowRight=parseInt(s.$forward.css("right"),10),s.arrowLeft=parseInt(s.$back.css("left"),10)},s.buildAutoPlay=function(){s.$startStop.html("<span>"+(s.playing?n.stopText:n.startText)+"</span>").bind(n.clickSlideshow,(function(t){n.enableStartStop&&(s.startStop(!s.playing),s.makeActive(),s.playing&&!n.autoPlayDelayed&&s.goForward(!0)),t.preventDefault()})).bind("focusin focusout",(function(){t(this).toggleClass("hover")}))},s.checkResize=function(t){clearTimeout(s.resizeTimer),s.resizeTimer=setTimeout((function(){var e=s.$outer.width()-s.outerPad[0],i=("BODY"===s.$outer[0].tagName?s.$win.height():s.$outer.height())-s.outerPad[1];s.width*n.showMultiple===e&&s.height===i||(s.setDimensions(),s.gotoPage(s.currentPage,s.playing,null,-1)),void 0===t&&s.checkResize()}),500)},s.setDimensions=function(){var e,i,a,o,r=0,l={width:"100%",height:"100%"},c=n.showMultiple>1?s.width||s.$window.width()/n.showMultiple:s.$window.width(),d=s.$win.width();n.expand&&(e=s.$outer.width()-s.outerPad[0],s.height=i=s.$outer.height()-s.outerPad[1],s.$wrapper.add(s.$window).add(s.$items).css({width:e,height:i}),s.width=c=n.showMultiple>1?e/n.showMultiple:e),s.$items.each((function(u){o=t(this),a=o.children(),n.resizeContents?(e=s.width,i=s.height,o.css({width:e,height:i}),a.length&&("EMBED"===a[0].tagName&&a.attr(l),"OBJECT"===a[0].tagName&&a.find("embed").attr(l),1===a.length&&a.css(l))):(e=o.width()||s.width,1===a.length&&e>=d&&(e=a.width()>=d?c:a.width(),a.css("max-width",e)),o.css("width",e),(i=1===a.length?a.outerHeight(!0):o.height())<=s.outerPad[1]&&(i=s.height),o.css("height",i)),s.panelSize[u]=[e,i,r],r+="vertical"===n.mode?i:e})),s.$el.css("vertical"===n.mode?"height":"width","fade"===n.mode?s.width:r)},s.getDim=function(t){var e,i=s.width,a=s.height;if(s.pages<1||isNaN(t))return[i,a];if(t=n.infiniteSlides&&s.pages>1?t:t-1,(e=s.panelSize[t])&&(i=e[0]||i,a=e[1]||a),n.showMultiple>1)for(e=1;e<n.showMultiple;e++)i+=s.panelSize[t+e][0],a=Math.max(a,s.panelSize[t+e][1]);return[i,a]},s.goForward=function(t){s.gotoPage(s[n.allowRapidChange?"targetPage":"currentPage"]+n.changeBy*(n.playRtl?-1:1),t)},s.goBack=function(t){s.gotoPage(s[n.allowRapidChange?"targetPage":"currentPage"]+n.changeBy*(n.playRtl?1:-1),t)},s.gotoPage=function(e,i,a,o){if(!0!==i&&(i=!1,s.startStop(!1),s.makeActive()),/^[#|.]/.test(e)&&t(e).length&&(e=t(e).closest(".panel").index()+s.adj),1!==n.changeBy){var r=s.pages-s.adjustMultiple;e<1&&(e=n.stopAtEnd?1:n.infiniteSlides?s.pages+e:n.showMultiple>1-e?1:r),e>s.pages?e=n.stopAtEnd?s.pages:n.showMultiple>1-e?1:e-=r:e>=r&&(e=r)}s.pages<=1||(s.$lastPage=s.$currentPage,"number"!=typeof e&&(e=parseInt(e,10)||n.startPanel,s.setCurrentPage(e)),i&&n.isVideoPlaying(s)||(s.exactPage=e,e>s.pages+1-s.adj&&(e=n.infiniteSlides||n.stopAtEnd?s.pages:1),e<s.adj&&(e=n.infiniteSlides||n.stopAtEnd?1:s.pages),n.infiniteSlides||(s.exactPage=e),s.currentPage=e>s.pages?s.pages:e<1?1:s.currentPage,s.$currentPage=s.$items.eq(s.currentPage-s.adj),s.targetPage=0===e?s.pages:e>s.pages?1:e,s.$targetPage=s.$items.eq(s.targetPage-s.adj),(o=void 0!==o?o:n.animationTime)>=0&&s.$el.trigger("slide_init",s),o>0&&s.slideControls(!0),n.buildNavigation&&s.setNavigation(s.targetPage),!0!==i&&(i=!1),(!i||n.stopAtEnd&&e===s.pages)&&s.startStop(!1),o>=0&&s.$el.trigger("slide_begin",s),setTimeout((function(t){var i,r=!0;n.allowRapidChange&&s.$wrapper.add(s.$el).add(s.$items).stop(!0,!0),n.resizeContents||(i=s.getDim(e),t={},s.$wrapper.width()!==i[0]&&(t.width=i[0]||s.width,r=!1),s.$wrapper.height()!==i[1]&&(t.height=i[1]||s.height,r=!1),r||s.$wrapper.filter(":not(:animated)").animate(t,{queue:!1,duration:o<0?0:o,easing:n.easing})),"fade"===n.mode?s.$lastPage[0]!==s.$targetPage[0]?(s.fadeIt(s.$lastPage,0,o),s.fadeIt(s.$targetPage,1,o,(function(){s.endAnimation(e,a,o)}))):s.endAnimation(e,a,o):((t={})[s.dir]=-s.panelSize[n.infiniteSlides&&s.pages>1?e:e-1][2],s.$el.filter(":not(:animated)").animate(t,{queue:!1,duration:o<0?0:o,easing:n.easing,complete:function(){s.endAnimation(e,a,o)}}))}),parseInt(n.delayBeforeAnimate,10)||0)))},s.endAnimation=function(t,e,i){0===t?(s.$el.css(s.dir,"fade"===n.mode?0:-s.panelSize[s.pages][2]),t=s.pages):t>s.pages&&(s.$el.css(s.dir,"fade"===n.mode?0:-s.panelSize[1][2]),t=1),s.exactPage=t,s.setCurrentPage(t,!1),"fade"===n.mode&&s.fadeIt(s.$items.not(":eq("+(t-s.adj)+")"),0,0),s.hovered||s.slideControls(!1),n.hashTags&&s.setHash(t),i>=0&&s.$el.trigger("slide_complete",s),"function"==typeof e&&e(s),n.autoPlayLocked&&!s.playing&&setTimeout((function(){s.startStop(!0)}),n.resumeDelay-(n.autoPlayDelayed?n.delay:0))},s.fadeIt=function(t,e,i,a){var s=i<0?0:i;n.resumeOnVisible?t.filter(":not(:animated)").fadeTo(s,e,a):t.filter(":not(:animated)")[0===e?"fadeOut":"fadeIn"](s,a)},s.setCurrentPage=function(t,e){if(t=parseInt(t,10),!(s.pages<1||0===t||isNaN(t))){if(t>s.pages+1-s.adj&&(t=s.pages-s.adj),t<s.adj&&(t=1),n.buildArrows&&!n.infiniteSlides&&n.stopAtEnd&&(s.$forward[t===s.pages-s.adjustMultiple?"addClass":"removeClass"]("disabled"),s.$back[1===t?"addClass":"removeClass"]("disabled"),t===s.pages&&s.playing&&s.startStop()),!e){var i=s.getDim(t);s.$wrapper.css({width:i[0],height:i[1]}).add(s.$window).scrollLeft(0).scrollTop(0),s.$el.css(s.dir,"fade"===n.mode?0:-s.panelSize[n.infiniteSlides&&s.pages>1?t:t-1][2])}s.currentPage=t,s.$currentPage=s.$items.removeClass("activePage").eq(t-s.adj).addClass("activePage"),n.buildNavigation&&s.setNavigation(t)}},s.setNavigation=function(t){s.$nav.find(".cur").removeClass("cur").end().find("a").eq(t-1).addClass("cur")},s.makeActive=function(){s.$wrapper.hasClass("activeSlider")||(t(".activeSlider").removeClass("activeSlider"),s.$wrapper.addClass("activeSlider"))},s.gotoHash=function(){var e=s.win.location.hash,i=e.indexOf("&"),a=e.match(s.regex);if(null!==a||/^#&/.test(e)||/#!?\//.test(e))null!==a&&(a=n.hashTags?parseInt(a[1],10):null);else{e=e.substring(0,i>=0?i:e.length);try{a=t(e).length&&t(e).closest(".anythingBase")[0]===s.el?s.$items.index(t(e).closest(".panel"))+s.adj:null}catch(t){a=null}}return a},s.setHash=function(t){var e="panel"+s.runTimes+"-",i=s.win.location.hash;void 0!==i&&(s.win.location.hash=i.indexOf(e)>0?i.replace(s.regex,e+t):i+"&"+e+t)},s.slideControls=function(t){var e=t?"slideDown":"slideUp",i=t?0:n.animationTime,a=t?n.animationTime:0,o=t?1:0,r=t?0:1;n.toggleControls&&s.$controls.stop(!0,!0).delay(i)[e](n.animationTime/2).delay(a),n.buildArrows&&n.toggleArrows&&(!s.hovered&&s.playing&&(r=1,o=0),s.$forward.stop(!0,!0).delay(i).animate({right:s.arrowRight+r*s.arrowWidth,opacity:o},n.animationTime/2),s.$back.stop(!0,!0).delay(i).animate({left:s.arrowLeft+r*s.arrowWidth,opacity:o},n.animationTime/2))},s.clearTimer=function(t){s.timer&&(s.win.clearInterval(s.timer),!t&&s.slideshow&&(s.$el.trigger("slideshow_stop",s),s.slideshow=!1))},s.startStop=function(t,e){!0!==t&&(t=!1),s.playing=t,t&&!e&&(s.$el.trigger("slideshow_start",s),s.slideshow=!0),n.buildStartStop&&(s.$startStop.toggleClass("playing",t).find("span").html(t?n.stopText:n.startText),"hidden"===s.$startStop.find("span").css("visibility")&&s.$startStop.addClass(n.tooltipClass).attr("title",t?n.stopText:n.startText)),t?(s.clearTimer(!0),s.timer=s.win.setInterval((function(){n.isVideoPlaying(s)?n.resumeOnVideoEnd||s.startStop():s.goForward(!0)}),n.delay)):s.clearTimer()},s.init()},t.anythingSlider.defaults={theme:"default",mode:"horiz",expand:!1,resizeContents:!0,showMultiple:!1,easing:"swing",buildArrows:!0,buildNavigation:!0,buildStartStop:!0,toggleArrows:!1,toggleControls:!1,startText:"Start",stopText:"Stop",forwardText:"&raquo;",backText:"&laquo;",tooltipClass:"tooltip",enableArrows:!0,enableNavigation:!0,enableStartStop:!0,enableKeyboard:!0,startPanel:1,changeBy:1,hashTags:!0,infiniteSlides:!0,navigationFormatter:null,navigationSize:!1,autoPlay:!1,autoPlayLocked:!1,autoPlayDelayed:!1,pauseOnHover:!0,stopAtEnd:!1,playRtl:!1,delay:3e3,resumeDelay:15e3,animationTime:600,delayBeforeAnimate:0,clickForwardArrow:"click",clickBackArrow:"click",clickControls:"click focusin",clickSlideshow:"click",allowRapidChange:!1,resumeOnVideoEnd:!0,resumeOnVisible:!0,addWmodeToObject:"opaque",isVideoPlaying:function(t){return!1}},t.fn.anythingSlider=function(e,i){return this.each((function(){var n,a=t(this).data("AnythingSlider");(typeof e).match("object|undefined")?a?a.updateSlider():new t.anythingSlider(this,e):/\d/.test(e)&&!isNaN(e)&&a?(n="number"==typeof e?e:parseInt(t.trim(e),10))>=1&&n<=a.pages&&a.gotoPage(n,!1,i):/^[#|.]/.test(e)&&t(e).length&&a.gotoPage(e,!1,i)}))}}(jQuery),function(t,e){var i,n,a,s,o,r,l,c,d,u,h,p,f,m=Array.prototype.slice,g=decodeURIComponent,v=t.param,b=t.bbq=t.bbq||{},y=t.event.special,_="hashchange",x="querystring",w="fragment",C="elemUrlAttr",k="href",$="src",S=/^.*\?|#.*$/g,T={};function I(t){return"string"==typeof t}function D(t){var e=m.call(arguments,1);return function(){return t.apply(this,e.concat(m.call(arguments)))}}function A(e,a,o,r,l){var c,p,m,v,b;return r!==i?(b=(m=o.match(e?u:/^([^#?]*)\??([^#]*)(#?.*)/))[3]||"",2===l&&I(r)?p=r.replace(e?d:S,""):(v=s(m[2]),r=I(r)?s[e?w:x](r):r,p=2===l?r:1===l?t.extend({},r,v):t.extend({},v,r),p=n(p),e&&(p=p.replace(h,g))),c=m[1]+(e?f:p||!m[1]?"?":"")+p+b):c=a(o!==i?o:location.href),c}function P(t,e,n){return e===i||"boolean"==typeof e?(n=e,e=v[t?w:x]()):e=I(e)?e.replace(t?d:S,""):e,s(e,n)}function O(e,n,a,s){return I(a)||"object"==typeof a||(s=a,a=n,n=i),this.each((function(){var i=t(this),o=n||c()[(this.nodeName||"").toLowerCase()]||"",r=o&&i.attr(o)||"";i.attr(o,v[e](r,a,s))}))}v[x]=D(A,0,(function(t){return t.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")})),v[w]=a=D(A,1,(function(t){return t.replace(u,"$2")})),v.sorted=n=function(e,i){var n=[],a={};return t.each(v(e,i).split("&"),(function(t,e){var i=e.replace(/(?:%5B|=).*$/,""),s=a[i];s||(s=a[i]=[],n.push(i)),s.push(e)})),t.map(n.sort(),(function(t){return a[t]})).join("&")},a.noEscape=function(e){e=e||"";var i=t.map(e.split(""),encodeURIComponent);h=new RegExp(i.join("|"),"g")},a.noEscape(",/"),a.ajaxCrawlable=function(t){return t!==i&&(t?(d=/^.*(?:#!|#)/,u=/^([^#]*)(?:#!|#)?(.*)$/,f="#!"):(d=/^.*#/,u=/^([^#]*)#?(.*)$/,f="#"),p=!!t),p},a.ajaxCrawlable(0),t.deparam=s=function(e,n){var a={},s={true:!0,false:!1,null:null};return t.each(e.replace(/\+/g," ").split("&"),(function(e,o){var r,l=o.split("="),c=g(l[0]),d=a,u=0,h=c.split("]["),p=h.length-1;if(/\[/.test(h[0])&&/\]$/.test(h[p])?(h[p]=h[p].replace(/\]$/,""),p=(h=h.shift().split("[").concat(h)).length-1):p=0,2===l.length)if(r=g(l[1]),n&&(r=r&&!isNaN(r)?+r:"undefined"===r?i:s[r]!==i?s[r]:r),p)for(;u<=p;u++)d=d[c=""===h[u]?d.length:h[u]]=u<p?d[c]||(h[u+1]&&isNaN(h[u+1])?{}:[]):r;else t.isArray(a[c])?a[c].push(r):a[c]!==i?a[c]=[a[c],r]:a[c]=r;else c&&(a[c]=n?i:"")})),a},s[x]=D(P,0),s[w]=o=D(P,1),t[C]||(t[C]=function(e){return t.extend(T,e)})({a:k,base:k,iframe:$,img:$,input:$,form:"action",link:k,script:$}),c=t[C],t.fn[x]=D(O,x),t.fn[w]=D(O,w),b.pushState=r=function(t,e){I(t)&&/^#/.test(t)&&e===i&&(e=2);var n=t!==i,s=a(location.href,n?t:{},n?e:2);location.href=s},b.getState=l=function(t,e){return t===i||"boolean"==typeof t?o(t):o(e)[t]},b.removeState=function(e){var n={};e!==i&&(n=l(),t.each(t.isArray(e)?e:arguments,(function(t,e){delete n[e]}))),r(n,2)},y[_]=t.extend(y[_],{add:function(e){var n;function o(t){var e=t[w]=a();t.getState=function(t,n){return t===i||"boolean"==typeof t?s(e,t):s(e,n)[t]},n.apply(this,arguments)}if(t.isFunction(e))return n=e,o;n=e.handler,e.handler=o}})}(jQuery),function(t,e,i){var n,a="hashchange",s=document,o=t.event.special,r=s.documentMode,l="on"+a in e&&(r===i||r>7);function c(t){return"#"+(t=t||location.href).replace(/^[^#]*#?(.*)$/,"$1")}t.fn[a]=function(t){return t?this.bind(a,t):this.trigger(a)},t.fn[a].delay=50,o[a]=t.extend(o[a],{setup:function(){if(l)return!1;t(n.start)},teardown:function(){if(l)return!1;t(n.stop)}}),n=function(){var n,o,r,d={},u=c(),h=function(t){return t},p=h,f=h;function m(){var i=c(),s=f(u);i!==u?(p(u=i,s),t(e).trigger(a)):s!==u&&(location.href=location.href.replace(/#.*/,"")+s),n=setTimeout(m,t.fn[a].delay)}return d.start=function(){n||m()},d.stop=function(){n&&clearTimeout(n),n=i},null!==navigator.userAgent.match(/MSIE/i)&&!l&&(d.start=function(){o||(r=(r=t.fn[a].src)&&r+c(),o=t('<iframe tabindex="-1" title="empty"/>').hide().one("load",(function(){r||p(c()),m()})).attr("src",r||"javascript:0").insertAfter("body")[0].contentWindow,s.onpropertychange=function(){try{"title"===event.propertyName&&(o.document.title=s.title)}catch(t){}})},d.stop=h,f=function(){return c(o.location.href)},p=function(e,i){var n=o.document,r=t.fn[a].domain;e!==i&&(n.title=s.title,n.open(),r&&n.write('<script>document.domain="'+r+'"<\/script>'),n.close(),o.location.hash=e)}),d}()}(jQuery,this),function(t){function e(e){var i=(e||"").split(/ /),n={center:"50%",left:"0%",right:"100%",top:"0%",bottom:"100%"},a=function(t){var e=(n[i[t]]||i[t]||"50%").match(/^([+-]=)?([+-]?\d+(\.\d*)?)(.*)$/);i[t]=[e[1],parseFloat(e[2]),e[4]||"px"]};return 1==i.length&&t.inArray(i[0],["top","bottom"])>-1&&(i[1]=i[0],i[0]="50%"),a(0),a(1),i}function i(i){i.set||function(i){i.start=e(t(i.elem).css("backgroundPosition")),i.end=e(i.end);for(var n=0;n<i.end.length;n++)i.end[n][0]&&(i.end[n][1]=i.start[n][1]+("-="==i.end[n][0]?-1:1)*i.end[n][1]);i.set=!0}(i),t(i.elem).css("background-position",i.pos*(i.end[0][1]-i.start[0][1])+i.start[0][1]+i.end[0][2]+" "+(i.pos*(i.end[1][1]-i.start[1][1])+i.start[1][1]+i.end[1][2]))}!!t.Tween?t.Tween.propHooks.backgroundPosition={get:function(i){return e(t(i.elem).css(i.prop))},set:i}:t.fx.step.backgroundPosition=i}(jQuery),function(t){t.colorpicker=new function(){this.regional=[],this.regional[""]={ok:"OK",cancel:"Cancel",none:"None",button:"Color",title:"Pick a color",transparent:"Transparent",hsvH:"H",hsvS:"S",hsvV:"V",rgbR:"R",rgbG:"G",rgbB:"B",labL:"L",labA:"a",labB:"b",hslH:"H",hslS:"S",hslL:"L",cmykC:"C",cmykM:"M",cmykY:"Y",cmykK:"K",alphaA:"A"},this.swatches=[],this.swatches.html={black:{r:0,g:0,b:0},dimgray:{r:.4117647058823529,g:.4117647058823529,b:.4117647058823529},gray:{r:.5019607843137255,g:.5019607843137255,b:.5019607843137255},darkgray:{r:.6627450980392157,g:.6627450980392157,b:.6627450980392157},silver:{r:.7529411764705882,g:.7529411764705882,b:.7529411764705882},lightgrey:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},gainsboro:{r:.8627450980392157,g:.8627450980392157,b:.8627450980392157},whitesmoke:{r:.9607843137254902,g:.9607843137254902,b:.9607843137254902},white:{r:1,g:1,b:1},rosybrown:{r:.7372549019607844,g:.5607843137254902,b:.5607843137254902},indianred:{r:.803921568627451,g:.3607843137254902,b:.3607843137254902},brown:{r:.6470588235294118,g:.16470588235294117,b:.16470588235294117},firebrick:{r:.6980392156862745,g:.13333333333333333,b:.13333333333333333},lightcoral:{r:.9411764705882353,g:.5019607843137255,b:.5019607843137255},maroon:{r:.5019607843137255,g:0,b:0},darkred:{r:.5450980392156862,g:0,b:0},red:{r:1,g:0,b:0},snow:{r:1,g:.9803921568627451,b:.9803921568627451},salmon:{r:.9803921568627451,g:.5019607843137255,b:.4470588235294118},mistyrose:{r:1,g:.8941176470588236,b:.8823529411764706},tomato:{r:1,g:.38823529411764707,b:.2784313725490196},darksalmon:{r:.9137254901960784,g:.5882352941176471,b:.47843137254901963},orangered:{r:1,g:.27058823529411763,b:0},coral:{r:1,g:.4980392156862745,b:.3137254901960784},lightsalmon:{r:1,g:.6274509803921569,b:.47843137254901963},sienna:{r:.6274509803921569,g:.3215686274509804,b:.17647058823529413},seashell:{r:1,g:.9607843137254902,b:.9333333333333333},chocolate:{r:.8235294117647058,g:.4117647058823529,b:.11764705882352941},saddlebrown:{r:.5450980392156862,g:.27058823529411763,b:.07450980392156863},sandybrown:{r:.9568627450980393,g:.6431372549019608,b:.3764705882352941},peachpuff:{r:1,g:.8549019607843137,b:.7254901960784313},peru:{r:.803921568627451,g:.5215686274509804,b:.24705882352941178},linen:{r:.9803921568627451,g:.9411764705882353,b:.9019607843137255},darkorange:{r:1,g:.5490196078431373,b:0},bisque:{r:1,g:.8941176470588236,b:.7686274509803922},burlywood:{r:.8705882352941177,g:.7215686274509804,b:.5294117647058824},tan:{r:.8235294117647058,g:.7058823529411765,b:.5490196078431373},antiquewhite:{r:.9803921568627451,g:.9215686274509803,b:.8431372549019608},navajowhite:{r:1,g:.8705882352941177,b:.6784313725490196},blanchedalmond:{r:1,g:.9215686274509803,b:.803921568627451},papayawhip:{r:1,g:.9372549019607843,b:.8352941176470589},orange:{r:1,g:.6470588235294118,b:0},moccasin:{r:1,g:.8941176470588236,b:.7098039215686275},wheat:{r:.9607843137254902,g:.8705882352941177,b:.7019607843137254},oldlace:{r:.9921568627450981,g:.9607843137254902,b:.9019607843137255},floralwhite:{r:1,g:.9803921568627451,b:.9411764705882353},goldenrod:{r:.8549019607843137,g:.6470588235294118,b:.12549019607843137},darkgoldenrod:{r:.7215686274509804,g:.5254901960784314,b:.043137254901960784},cornsilk:{r:1,g:.9725490196078431,b:.8627450980392157},gold:{r:1,g:.8431372549019608,b:0},palegoldenrod:{r:.9333333333333333,g:.9098039215686274,b:.6666666666666666},khaki:{r:.9411764705882353,g:.9019607843137255,b:.5490196078431373},lemonchiffon:{r:1,g:.9803921568627451,b:.803921568627451},darkkhaki:{r:.7411764705882353,g:.7176470588235294,b:.4196078431372549},beige:{r:.9607843137254902,g:.9607843137254902,b:.8627450980392157},lightgoldenrodyellow:{r:.9803921568627451,g:.9803921568627451,b:.8235294117647058},olive:{r:.5019607843137255,g:.5019607843137255,b:0},yellow:{r:1,g:1,b:0},lightyellow:{r:1,g:1,b:.8784313725490196},ivory:{r:1,g:1,b:.9411764705882353},olivedrab:{r:.4196078431372549,g:.5568627450980392,b:.13725490196078433},yellowgreen:{r:.6039215686274509,g:.803921568627451,b:.19607843137254902},darkolivegreen:{r:.3333333333333333,g:.4196078431372549,b:.1843137254901961},greenyellow:{r:.6784313725490196,g:1,b:.1843137254901961},lawngreen:{r:.48627450980392156,g:.9882352941176471,b:0},chartreuse:{r:.4980392156862745,g:1,b:0},darkseagreen:{r:.5607843137254902,g:.7372549019607844,b:.5607843137254902},forestgreen:{r:.13333333333333333,g:.5450980392156862,b:.13333333333333333},limegreen:{r:.19607843137254902,g:.803921568627451,b:.19607843137254902},lightgreen:{r:.5647058823529412,g:.9333333333333333,b:.5647058823529412},palegreen:{r:.596078431372549,g:.984313725490196,b:.596078431372549},darkgreen:{r:0,g:.39215686274509803,b:0},green:{r:0,g:.5019607843137255,b:0},lime:{r:0,g:1,b:0},honeydew:{r:.9411764705882353,g:1,b:.9411764705882353},mediumseagreen:{r:.23529411764705882,g:.7019607843137254,b:.44313725490196076},seagreen:{r:.1803921568627451,g:.5450980392156862,b:.3411764705882353},springgreen:{r:0,g:1,b:.4980392156862745},mintcream:{r:.9607843137254902,g:1,b:.9803921568627451},mediumspringgreen:{r:0,g:.9803921568627451,b:.6039215686274509},mediumaquamarine:{r:.4,g:.803921568627451,b:.6666666666666666},aquamarine:{r:.4980392156862745,g:1,b:.8313725490196079},turquoise:{r:.25098039215686274,g:.8784313725490196,b:.8156862745098039},lightseagreen:{r:.12549019607843137,g:.6980392156862745,b:.6666666666666666},mediumturquoise:{r:.2823529411764706,g:.8196078431372549,b:.8},darkslategray:{r:.1843137254901961,g:.30980392156862746,b:.30980392156862746},paleturquoise:{r:.6862745098039216,g:.9333333333333333,b:.9333333333333333},teal:{r:0,g:.5019607843137255,b:.5019607843137255},darkcyan:{r:0,g:.5450980392156862,b:.5450980392156862},darkturquoise:{r:0,g:.807843137254902,b:.8196078431372549},aqua:{r:0,g:1,b:1},cyan:{r:0,g:1,b:1},lightcyan:{r:.8784313725490196,g:1,b:1},azure:{r:.9411764705882353,g:1,b:1},cadetblue:{r:.37254901960784315,g:.6196078431372549,b:.6274509803921569},powderblue:{r:.6901960784313725,g:.8784313725490196,b:.9019607843137255},lightblue:{r:.6784313725490196,g:.8470588235294118,b:.9019607843137255},deepskyblue:{r:0,g:.7490196078431373,b:1},skyblue:{r:.5294117647058824,g:.807843137254902,b:.9215686274509803},lightskyblue:{r:.5294117647058824,g:.807843137254902,b:.9803921568627451},steelblue:{r:.27450980392156865,g:.5098039215686274,b:.7058823529411765},aliceblue:{r:.9411764705882353,g:.9725490196078431,b:1},dodgerblue:{r:.11764705882352941,g:.5647058823529412,b:1},slategray:{r:.4392156862745098,g:.5019607843137255,b:.5647058823529412},lightslategray:{r:.4666666666666667,g:.5333333333333333,b:.6},lightsteelblue:{r:.6901960784313725,g:.7686274509803922,b:.8705882352941177},cornflowerblue:{r:.39215686274509803,g:.5843137254901961,b:.9294117647058824},royalblue:{r:.2549019607843137,g:.4117647058823529,b:.8823529411764706},midnightblue:{r:.09803921568627451,g:.09803921568627451,b:.4392156862745098},lavender:{r:.9019607843137255,g:.9019607843137255,b:.9803921568627451},navy:{r:0,g:0,b:.5019607843137255},darkblue:{r:0,g:0,b:.5450980392156862},mediumblue:{r:0,g:0,b:.803921568627451},blue:{r:0,g:0,b:1},ghostwhite:{r:.9725490196078431,g:.9725490196078431,b:1},darkslateblue:{r:.2823529411764706,g:.23921568627450981,b:.5450980392156862},slateblue:{r:.41568627450980394,g:.35294117647058826,b:.803921568627451},mediumslateblue:{r:.4823529411764706,g:.40784313725490196,b:.9333333333333333},mediumpurple:{r:.5764705882352941,g:.4392156862745098,b:.8588235294117647},blueviolet:{r:.5411764705882353,g:.16862745098039217,b:.8862745098039215},indigo:{r:.29411764705882354,g:0,b:.5098039215686274},darkorchid:{r:.6,g:.19607843137254902,b:.8},darkviolet:{r:.5803921568627451,g:0,b:.8274509803921568},mediumorchid:{r:.7294117647058823,g:.3333333333333333,b:.8274509803921568},thistle:{r:.8470588235294118,g:.7490196078431373,b:.8470588235294118},plum:{r:.8666666666666667,g:.6274509803921569,b:.8666666666666667},violet:{r:.9333333333333333,g:.5098039215686274,b:.9333333333333333},purple:{r:.5019607843137255,g:0,b:.5019607843137255},darkmagenta:{r:.5450980392156862,g:0,b:.5450980392156862},magenta:{r:1,g:0,b:1},fuchsia:{r:1,g:0,b:1},orchid:{r:.8549019607843137,g:.4392156862745098,b:.8392156862745098},mediumvioletred:{r:.7803921568627451,g:.08235294117647059,b:.5215686274509804},deeppink:{r:1,g:.0784313725490196,b:.5764705882352941},hotpink:{r:1,g:.4117647058823529,b:.7058823529411765},palevioletred:{r:.8588235294117647,g:.4392156862745098,b:.5764705882352941},lavenderblush:{r:1,g:.9411764705882353,b:.9607843137254902},crimson:{r:.8627450980392157,g:.0784313725490196,b:.23529411764705882},pink:{r:1,g:.7529411764705882,b:.796078431372549},lightpink:{r:1,g:.7137254901960784,b:.7568627450980392}}};var e=0,i={full:["header","map","bar","hex","hsv","rgb","alpha","lab","cmyk","preview","swatches","footer"],popup:["map","bar","hex","hsv","rgb","alpha","preview","footer"],draggable:["header","map","bar","hex","hsv","rgb","alpha","preview","footer"],inline:["map","bar","hex","hsv","rgb","alpha","preview"]},n=function(t){var e=Math.round(t).toString(16);return 1===e.length&&(e="0"+e),e.toLowerCase()},a=function(t){var e,i;return(i=/^#?([a-fA-F0-9]{1,6})$/.exec(t))?(e=parseInt(i[1],16),new o((e>>16&255)/255,(e>>8&255)/255,(255&e)/255)):new o},s={header:function(e){var i=null;this.init=function(){var n;i=t((n='<span class="ui-dialog-title">'+(e.options.title||e._getRegional("title"))+"</span>",!e.inline&&e.options.showCloseButton&&(n+='<a href="#" class="ui-dialog-titlebar-close ui-corner-all" role="button"><span class="ui-icon ui-icon-closethick">close</span></a>'),'<div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix">'+n+"</div>")).prependTo(e.dialog);var a=t(".ui-dialog-titlebar-close",i);e._hoverable(a),e._focusable(a),a.click((function(t){t.preventDefault(),e.close()})),!e.inline&&e.options.draggable&&e.dialog.draggable({handle:i})}},map:function(e){var i,n,a,s,o=this,r=null;i=function(s){if(e.opened){var o=t(".ui-colorpicker-map-layer-pointer",r),l=o.offset(),c=o.width(),d=o.height(),u=s.pageX-l.left,h=s.pageY-l.top;u>=0&&u<c&&h>=0&&h<d&&(s.stopImmediatePropagation(),s.preventDefault(),r.unbind("mousedown",i),t(document).bind("mouseup",n),t(document).bind("mousemove",a),a(s))}},n=function(e){e.stopImmediatePropagation(),e.preventDefault(),t(document).unbind("mouseup",n),t(document).unbind("mousemove",a),r.bind("mousedown",i)},a=function(i){if(i.stopImmediatePropagation(),i.preventDefault(),i.pageX!==o.x||i.pageY!==o.y){o.x=i.pageX,o.y=i.pageY;var n=t(".ui-colorpicker-map-layer-pointer",r),a=n.offset(),s=n.width(),l=n.height(),c=i.pageX-a.left,d=i.pageY-a.top;switch(c=Math.max(0,Math.min(c/s,1)),d=Math.max(0,Math.min(d/l,1)),e.mode){case"h":e.color.setHSV(null,c,1-d);break;case"s":case"a":e.color.setHSV(c,null,1-d);break;case"v":e.color.setHSV(c,1-d,null);break;case"r":e.color.setRGB(null,1-d,c);break;case"g":e.color.setRGB(1-d,null,c);break;case"b":e.color.setRGB(c,1-d,null)}e._change()}},s=function(){return'<div class="ui-colorpicker-map ui-colorpicker-border"><span class="ui-colorpicker-map-layer-1">&nbsp;</span><span class="ui-colorpicker-map-layer-2">&nbsp;</span>'+(e.options.alpha?'<span class="ui-colorpicker-map-layer-alpha">&nbsp;</span>':"")+'<span class="ui-colorpicker-map-layer-pointer"><span class="ui-colorpicker-map-pointer"></span></span></div>'},this.update=function(){switch(e.mode){case"h":t(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 0",opacity:""}).show(),t(".ui-colorpicker-map-layer-2",r).hide();break;case"s":case"a":t(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 -260px",opacity:""}).show(),t(".ui-colorpicker-map-layer-2",r).css({"background-position":"0 -520px",opacity:""}).show();break;case"v":t(r).css("background-color","black"),t(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 -780px",opacity:""}).show(),t(".ui-colorpicker-map-layer-2",r).hide();break;case"r":t(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 -1040px",opacity:""}).show(),t(".ui-colorpicker-map-layer-2",r).css({"background-position":"0 -1300px",opacity:""}).show();break;case"g":t(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 -1560px",opacity:""}).show(),t(".ui-colorpicker-map-layer-2",r).css({"background-position":"0 -1820px",opacity:""}).show();break;case"b":t(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 -2080px",opacity:""}).show(),t(".ui-colorpicker-map-layer-2",r).css({"background-position":"0 -2340px",opacity:""}).show()}o.repaint()},this.repaint=function(){var i=t(".ui-colorpicker-map-layer-pointer",r),n=0,a=0;switch(e.mode){case"h":n=e.color.getHSV().s*i.width(),a=(1-e.color.getHSV().v)*i.width(),t(r).css("background-color",e.color.copy().normalize().toCSS());break;case"s":case"a":n=e.color.getHSV().h*i.width(),a=(1-e.color.getHSV().v)*i.width(),t(".ui-colorpicker-map-layer-2",r).css("opacity",1-e.color.getHSV().s);break;case"v":n=e.color.getHSV().h*i.width(),a=(1-e.color.getHSV().s)*i.width(),t(".ui-colorpicker-map-layer-1",r).css("opacity",e.color.getHSV().v);break;case"r":n=e.color.getRGB().b*i.width(),a=(1-e.color.getRGB().g)*i.width(),t(".ui-colorpicker-map-layer-2",r).css("opacity",e.color.getRGB().r);break;case"g":n=e.color.getRGB().b*i.width(),a=(1-e.color.getRGB().r)*i.width(),t(".ui-colorpicker-map-layer-2",r).css("opacity",e.color.getRGB().g);break;case"b":n=e.color.getRGB().r*i.width(),a=(1-e.color.getRGB().g)*i.width(),t(".ui-colorpicker-map-layer-2",r).css("opacity",e.color.getRGB().b)}e.options.alpha&&t(".ui-colorpicker-map-layer-alpha",r).css("opacity",1-e.color.getAlpha()),t(".ui-colorpicker-map-pointer",r).css({left:n-7,top:a-7})},this.init=function(){(r=t(s()).appendTo(t(".ui-colorpicker-map-container",e.dialog))).bind("mousedown",i)}},bar:function(e){var i,n,a,s,o=this,r=null;i=function(s){if(e.opened){var o=t(".ui-colorpicker-bar-layer-pointer",r),l=o.offset(),c=o.width(),d=o.height(),u=s.pageX-l.left,h=s.pageY-l.top;u>=0&&u<c&&h>=0&&h<d&&(s.stopImmediatePropagation(),s.preventDefault(),r.unbind("mousedown",i),t(document).bind("mouseup",n),t(document).bind("mousemove",a),a(s))}},n=function(e){e.stopImmediatePropagation(),e.preventDefault(),t(document).unbind("mouseup",n),t(document).unbind("mousemove",a),r.bind("mousedown",i)},a=function(i){if(i.stopImmediatePropagation(),i.preventDefault(),i.pageY!==o.y){o.y=i.pageY;var n=t(".ui-colorpicker-bar-layer-pointer",r),a=n.offset(),s=n.height(),l=i.pageY-a.top;switch(l=Math.max(0,Math.min(l/s,1)),e.mode){case"h":e.color.setHSV(1-l,null,null);break;case"s":e.color.setHSV(null,1-l,null);break;case"v":e.color.setHSV(null,null,1-l);break;case"r":e.color.setRGB(1-l,null,null);break;case"g":e.color.setRGB(null,1-l,null);break;case"b":e.color.setRGB(null,null,1-l);break;case"a":e.color.setAlpha(1-l)}e._change()}},s=function(){var t='<div class="ui-colorpicker-bar ui-colorpicker-border"><span class="ui-colorpicker-bar-layer-1">&nbsp;</span><span class="ui-colorpicker-bar-layer-2">&nbsp;</span><span class="ui-colorpicker-bar-layer-3">&nbsp;</span><span class="ui-colorpicker-bar-layer-4">&nbsp;</span>';return e.options.alpha&&(t+='<span class="ui-colorpicker-bar-layer-alpha">&nbsp;</span><span class="ui-colorpicker-bar-layer-alphabar">&nbsp;</span>'),t+='<span class="ui-colorpicker-bar-layer-pointer"><span class="ui-colorpicker-bar-pointer"></span></span></div>'},this.update=function(){switch(e.mode){case"h":case"s":case"v":case"r":case"g":case"b":t(".ui-colorpicker-bar-layer-alpha",r).show(),t(".ui-colorpicker-bar-layer-alphabar",r).hide();break;case"a":t(".ui-colorpicker-bar-layer-alpha",r).hide(),t(".ui-colorpicker-bar-layer-alphabar",r).show()}switch(e.mode){case"h":t(".ui-colorpicker-bar-layer-1",r).css({"background-position":"0 0",opacity:""}).show(),t(".ui-colorpicker-bar-layer-2",r).hide(),t(".ui-colorpicker-bar-layer-3",r).hide(),t(".ui-colorpicker-bar-layer-4",r).hide();break;case"s":t(".ui-colorpicker-bar-layer-1",r).css({"background-position":"0 -260px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-2",r).css({"background-position":"0 -520px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-3",r).hide(),t(".ui-colorpicker-bar-layer-4",r).hide();break;case"v":t(".ui-colorpicker-bar-layer-1",r).css({"background-position":"0 -520px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-2",r).hide(),t(".ui-colorpicker-bar-layer-3",r).hide(),t(".ui-colorpicker-bar-layer-4",r).hide();break;case"r":t(".ui-colorpicker-bar-layer-1",r).css({"background-position":"0 -1560px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-2",r).css({"background-position":"0 -1300px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-3",r).css({"background-position":"0 -780px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-4",r).css({"background-position":"0 -1040px",opacity:""}).show();break;case"g":t(".ui-colorpicker-bar-layer-1",r).css({"background-position":"0 -2600px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-2",r).css({"background-position":"0 -2340px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-3",r).css({"background-position":"0 -1820px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-4",r).css({"background-position":"0 -2080px",opacity:""}).show();break;case"b":t(".ui-colorpicker-bar-layer-1",r).css({"background-position":"0 -3640px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-2",r).css({"background-position":"0 -3380px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-3",r).css({"background-position":"0 -2860px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-4",r).css({"background-position":"0 -3120px",opacity:""}).show();break;case"a":t(".ui-colorpicker-bar-layer-1",r).hide(),t(".ui-colorpicker-bar-layer-2",r).hide(),t(".ui-colorpicker-bar-layer-3",r).hide(),t(".ui-colorpicker-bar-layer-4",r).hide()}o.repaint()},this.repaint=function(){var i=t(".ui-colorpicker-bar-layer-pointer",r),n=0;switch(e.mode){case"h":n=(1-e.color.getHSV().h)*i.height();break;case"s":n=(1-e.color.getHSV().s)*i.height(),t(".ui-colorpicker-bar-layer-2",r).css("opacity",1-e.color.getHSV().v),t(r).css("background-color",e.color.copy().normalize().toCSS());break;case"v":n=(1-e.color.getHSV().v)*i.height(),t(r).css("background-color",e.color.copy().normalize().toCSS());break;case"r":n=(1-e.color.getRGB().r)*i.height(),t(".ui-colorpicker-bar-layer-2",r).css("opacity",Math.max(0,e.color.getRGB().b-e.color.getRGB().g)),t(".ui-colorpicker-bar-layer-3",r).css("opacity",Math.max(0,e.color.getRGB().g-e.color.getRGB().b)),t(".ui-colorpicker-bar-layer-4",r).css("opacity",Math.min(e.color.getRGB().b,e.color.getRGB().g));break;case"g":n=(1-e.color.getRGB().g)*i.height(),t(".ui-colorpicker-bar-layer-2",r).css("opacity",Math.max(0,e.color.getRGB().b-e.color.getRGB().r)),t(".ui-colorpicker-bar-layer-3",r).css("opacity",Math.max(0,e.color.getRGB().r-e.color.getRGB().b)),t(".ui-colorpicker-bar-layer-4",r).css("opacity",Math.min(e.color.getRGB().r,e.color.getRGB().b));break;case"b":n=(1-e.color.getRGB().b)*i.height(),t(".ui-colorpicker-bar-layer-2",r).css("opacity",Math.max(0,e.color.getRGB().r-e.color.getRGB().g)),t(".ui-colorpicker-bar-layer-3",r).css("opacity",Math.max(0,e.color.getRGB().g-e.color.getRGB().r)),t(".ui-colorpicker-bar-layer-4",r).css("opacity",Math.min(e.color.getRGB().r,e.color.getRGB().g));break;case"a":n=(1-e.color.getAlpha())*i.height(),t(r).css("background-color",e.color.copy().normalize().toCSS())}"a"!==e.mode&&t(".ui-colorpicker-bar-layer-alpha",r).css("opacity",1-e.color.getAlpha()),t(".ui-colorpicker-bar-pointer",r).css("top",n-3)},this.init=function(){(r=t(s()).appendTo(t(".ui-colorpicker-bar-container",e.dialog))).bind("mousedown",i)}},preview:function(e){var i=null;this.init=function(){i=t('<div class="ui-colorpicker-preview ui-colorpicker-border"><div class="ui-colorpicker-preview-initial"><div class="ui-colorpicker-preview-initial-alpha"></div></div><div class="ui-colorpicker-preview-current"><div class="ui-colorpicker-preview-current-alpha"></div></div></div>').appendTo(t(".ui-colorpicker-preview-container",e.dialog)),t(".ui-colorpicker-preview-initial",i).click((function(){e.color=e.currentColor.copy(),e._change()}))},this.update=function(){e.options.alpha?t(".ui-colorpicker-preview-initial-alpha, .ui-colorpicker-preview-current-alpha",i).show():t(".ui-colorpicker-preview-initial-alpha, .ui-colorpicker-preview-current-alpha",i).hide(),this.repaint()},this.repaint=function(){t(".ui-colorpicker-preview-initial",i).css("background-color",e.currentColor.toCSS()).attr("title",e.currentColor.toHex()),t(".ui-colorpicker-preview-initial-alpha",i).css("opacity",1-e.currentColor.getAlpha()),t(".ui-colorpicker-preview-current",i).css("background-color",e.color.toCSS()).attr("title",e.color.toHex()),t(".ui-colorpicker-preview-current-alpha",i).css("opacity",1-e.color.getAlpha())}},hsv:function(e){var i,n=null;i=function(){var t="";return e.options.hsv&&(t+='<div class="ui-colorpicker-hsv-h"><input class="ui-colorpicker-mode" type="radio" value="h"/><label>'+e._getRegional("hsvH")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="360" size="10"/><span class="ui-colorpicker-unit">&deg;</span></div><div class="ui-colorpicker-hsv-s"><input class="ui-colorpicker-mode" type="radio" value="s"/><label>'+e._getRegional("hsvS")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-hsv-v"><input class="ui-colorpicker-mode" type="radio" value="v"/><label>'+e._getRegional("hsvV")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div>'),'<div class="ui-colorpicker-hsv">'+t+"</div>"},this.init=function(){n=t(i()).appendTo(t(".ui-colorpicker-hsv-container",e.dialog)),t(".ui-colorpicker-mode",n).click((function(){e.mode=t(this).val(),e._updateAllParts()})),t(".ui-colorpicker-number",n).bind("change keyup",(function(){e.color.setHSV(t(".ui-colorpicker-hsv-h .ui-colorpicker-number",n).val()/360,t(".ui-colorpicker-hsv-s .ui-colorpicker-number",n).val()/100,t(".ui-colorpicker-hsv-v .ui-colorpicker-number",n).val()/100),e._change()}))},this.repaint=function(){var i=e.color.getHSV();i.h*=360,i.s*=100,i.v*=100,t.each(i,(function(e,i){var a=t(".ui-colorpicker-hsv-"+e+" .ui-colorpicker-number",n);i=Math.round(i),a.val()!==i&&a.val(i)}))},this.update=function(){t(".ui-colorpicker-mode",n).each((function(){t(this).attr("checked",t(this).val()===e.mode)})),this.repaint()}},rgb:function(e){var i,n=null;i=function(){var t="";return e.options.rgb&&(t+='<div class="ui-colorpicker-rgb-r"><input class="ui-colorpicker-mode" type="radio" value="r"/><label>'+e._getRegional("rgbR")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div><div class="ui-colorpicker-rgb-g"><input class="ui-colorpicker-mode" type="radio" value="g"/><label>'+e._getRegional("rgbG")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div><div class="ui-colorpicker-rgb-b"><input class="ui-colorpicker-mode" type="radio" value="b"/><label>'+e._getRegional("rgbB")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>'),'<div class="ui-colorpicker-rgb">'+t+"</div>"},this.init=function(){n=t(i()).appendTo(t(".ui-colorpicker-rgb-container",e.dialog)),t(".ui-colorpicker-mode",n).click((function(){e.mode=t(this).val(),e._updateAllParts()})),t(".ui-colorpicker-number",n).bind("change keyup",(function(){e.color.setRGB(t(".ui-colorpicker-rgb-r .ui-colorpicker-number",n).val()/255,t(".ui-colorpicker-rgb-g .ui-colorpicker-number",n).val()/255,t(".ui-colorpicker-rgb-b .ui-colorpicker-number",n).val()/255),e._change()}))},this.repaint=function(){t.each(e.color.getRGB(),(function(e,i){var a=t(".ui-colorpicker-rgb-"+e+" .ui-colorpicker-number",n);i=Math.round(255*i),a.val()!==i&&a.val(i)}))},this.update=function(){t(".ui-colorpicker-mode",n).each((function(){t(this).attr("checked",t(this).val()===e.mode)})),this.repaint()}},lab:function(e){var i=null;this.init=function(){i=t(function(){var t="";return e.options.hsv&&(t+='<div class="ui-colorpicker-lab-l"><label>'+e._getRegional("labL")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/></div><div class="ui-colorpicker-lab-a"><label>'+e._getRegional("labA")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div><div class="ui-colorpicker-lab-b"><label>'+e._getRegional("labB")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div>'),'<div class="ui-colorpicker-lab">'+t+"</div>"}()).appendTo(t(".ui-colorpicker-lab-container",e.dialog)),t(".ui-colorpicker-number",i).on("change keyup",(function(n){e.color.setLAB(parseInt(t(".ui-colorpicker-lab-l .ui-colorpicker-number",i).val(),10)/100,(parseInt(t(".ui-colorpicker-lab-a .ui-colorpicker-number",i).val(),10)+128)/255,(parseInt(t(".ui-colorpicker-lab-b .ui-colorpicker-number",i).val(),10)+128)/255),e._change()}))},this.repaint=function(){var n=e.color.getLAB();n.l*=100,n.a=255*n.a-128,n.b=255*n.b-128,t.each(n,(function(e,n){var a=t(".ui-colorpicker-lab-"+e+" .ui-colorpicker-number",i);n=Math.round(n),a.val()!==n&&a.val(n)}))},this.update=function(){this.repaint()}},cmyk:function(e){var i=null;this.init=function(){var n;i=t((n="",e.options.hsv&&(n+='<div class="ui-colorpicker-cmyk-c"><label>'+e._getRegional("cmykC")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-cmyk-m"><label>'+e._getRegional("cmykM")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-cmyk-y"><label>'+e._getRegional("cmykY")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-cmyk-k"><label>'+e._getRegional("cmykK")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'),'<div class="ui-colorpicker-cmyk">'+n+"</div>")).appendTo(t(".ui-colorpicker-cmyk-container",e.dialog)),t(".ui-colorpicker-number",i).on("change keyup",(function(n){e.color.setCMYK(parseInt(t(".ui-colorpicker-cmyk-c .ui-colorpicker-number",i).val(),10)/100,parseInt(t(".ui-colorpicker-cmyk-m .ui-colorpicker-number",i).val(),10)/100,parseInt(t(".ui-colorpicker-cmyk-y .ui-colorpicker-number",i).val(),10)/100,parseInt(t(".ui-colorpicker-cmyk-k .ui-colorpicker-number",i).val(),10)/100),e._change()}))},this.repaint=function(){t.each(e.color.getCMYK(),(function(e,n){var a=t(".ui-colorpicker-cmyk-"+e+" .ui-colorpicker-number",i);n=Math.round(100*n),a.val()!==n&&a.val(n)}))},this.update=function(){this.repaint()}},alpha:function(e){var i,n=null;i=function(){var t="";return e.options.alpha&&(t+='<div class="ui-colorpicker-a"><input class="ui-colorpicker-mode" name="mode" type="radio" value="a"/><label>'+e._getRegional("alphaA")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'),'<div class="ui-colorpicker-alpha">'+t+"</div>"},this.init=function(){n=t(i()).appendTo(t(".ui-colorpicker-alpha-container",e.dialog)),t(".ui-colorpicker-mode",n).click((function(){e.mode=t(this).val(),e._updateAllParts()})),t(".ui-colorpicker-number",n).bind("change keyup",(function(){e.color.setAlpha(t(".ui-colorpicker-a .ui-colorpicker-number",n).val()/100),e._change()}))},this.update=function(){t(".ui-colorpicker-mode",n).each((function(){t(this).attr("checked",t(this).val()===e.mode)})),this.repaint()},this.repaint=function(){var i=t(".ui-colorpicker-a .ui-colorpicker-number",n),a=Math.round(100*e.color.getAlpha());i.is(":focus")||i.val()===a||i.val(a)}},hex:function(e){var i,s=null;i=function(){var t="";return e.options.alpha&&(t+='<input class="ui-colorpicker-hex-alpha" type="text" maxlength="2" size="2"/>'),'<div class="ui-colorpicker-hex"><label>#</label>'+(t+='<input class="ui-colorpicker-hex-input" type="text" maxlength="6" size="6"/>')+"</div>"},this.init=function(){s=t(i()).appendTo(t(".ui-colorpicker-hex-container",e.dialog)),t(".ui-colorpicker-hex-input",s).bind("change keydown keyup",(function(e,i,n){/[^a-fA-F0-9]/.test(t(this).val())&&t(this).val(t(this).val().replace(/[^a-fA-F0-9]/,""))})),t(".ui-colorpicker-hex-input",s).bind("change keyup",(function(){e.color=a(t(this).val()).setAlpha(e.color.getAlpha()),e._change()})),t(".ui-colorpicker-hex-alpha",s).bind("change keydown keyup",(function(){/[^a-fA-F0-9]/.test(t(this).val())&&t(this).val(t(this).val().replace(/[^a-fA-F0-9]/,""))})),t(".ui-colorpicker-hex-alpha",s).bind("change keyup",(function(){e.color.setAlpha(parseInt(t(".ui-colorpicker-hex-alpha",s).val(),16)/255),e._change()}))},this.update=function(){this.repaint()},this.repaint=function(){t(".ui-colorpicker-hex-input",s).is(":focus")||t(".ui-colorpicker-hex-input",s).val(e.color.toHex(!0)),t(".ui-colorpicker-hex-alpha",s).is(":focus")||t(".ui-colorpicker-hex-alpha",s).val(n(255*e.color.getAlpha()))}},swatches:function(e){var i=null;this.init=function(){var n;i=t((n="",t.each(e._getSwatches(),(function(t,e){var i=new o(e.r,e.g,e.b).toCSS();n+='<div class="ui-colorpicker-swatch" style="background-color:'+i+'" title="'+t+'"></div>'})),'<div class="ui-colorpicker-swatches ui-colorpicker-border" style="width:'+e.options.swatchesWidth+'px">'+n+"</div>")).appendTo(t(".ui-colorpicker-swatches-container",e.dialog)),t(".ui-colorpicker-swatch",i).click((function(){e.color=e._parseColor(t(this).css("background-color")),e._change()}))}},footer:function(i){var n=null,a="ui-colorpicker-special-transparent-"+e,s="ui-colorpicker-special-none-"+e;this.init=function(){var e;n=t((e="",(i.options.alpha||!i.inline&&i.options.showNoneButton)&&(e+='<div class="ui-colorpicker-buttonset">',i.options.alpha&&(e+='<input type="radio" name="ui-colorpicker-special" id="'+a+'" class="ui-colorpicker-special-transparent"/><label for="'+a+'">'+i._getRegional("transparent")+"</label>"),!i.inline&&i.options.showNoneButton&&(e+='<input type="radio" name="ui-colorpicker-special" id="'+s+'" class="ui-colorpicker-special-none"><label for="'+s+'">'+i._getRegional("none")+"</label>"),e+="</div>"),i.inline||(e+='<div class="ui-dialog-buttonset">',i.options.showCancelButton&&(e+='<button class="ui-colorpicker-cancel">'+i._getRegional("cancel")+"</button>"),e+='<button class="ui-colorpicker-ok">'+i._getRegional("ok")+"</button>",e+="</div>"),'<div class="ui-dialog-buttonpane ui-widget-content">'+e+"</div>")).appendTo(i.dialog),t(".ui-colorpicker-ok",n).button().click((function(){i.close()})),t(".ui-colorpicker-cancel",n).button().click((function(){i.color=i.currentColor.copy(),i._change(i.color.set),i.close()})),t(".ui-colorpicker-buttonset",n).buttonset(),t(".ui-colorpicker-special-color",n).click((function(){i._change()})),t("#"+s,n).click((function(){i._change(!1)})),t("#"+a,n).click((function(){i.color.setAlpha(0),i._change()}))},this.repaint=function(){i.color.set?0==i.color.getAlpha()?t(".ui-colorpicker-special-transparent",n).attr("checked",!0).button("refresh"):t("input",n).attr("checked",!1).button("refresh"):t(".ui-colorpicker-special-none",n).attr("checked",!0).button("refresh"),t(".ui-colorpicker-cancel",n).button(i.changed?"enable":"disable")},this.update=function(){}}},o=function(){var e={rgb:{r:0,g:0,b:0},hsv:{h:0,s:0,v:0},hsl:{h:0,s:0,l:0},lab:{l:0,a:0,b:0},cmyk:{c:0,m:0,y:0,k:1}},i=1,n=arguments,a=function(t){return isNaN(t)||null===t?0:("string"==typeof t&&(t=parseInt(t,10)),Math.max(0,Math.min(t,1)))},s=function(t){var e="0123456789abcdef",i=t%16;return e.charAt((t-i)/16)+e.charAt(i)},r=function(t){var e=t.r>.04045?Math.pow((t.r+.055)/1.055,2.4):t.r/12.92,i=t.g>.04045?Math.pow((t.g+.055)/1.055,2.4):t.g/12.92,n=t.b>.04045?Math.pow((t.b+.055)/1.055,2.4):t.b/12.92;return{x:.4124*e+.3576*i+.1805*n,y:.2126*e+.7152*i+.0722*n,z:.0193*e+.1192*i+.9505*n}},l=function(t){var e,i,n,a=Math.min(t.r,t.g,t.b),s=Math.max(t.r,t.g,t.b),o=s-a,r={h:0,s:0,v:s};return 0===o?(r.h=0,r.s=0):(r.s=o/s,e=((s-t.r)/6+o/2)/o,i=((s-t.g)/6+o/2)/o,n=((s-t.b)/6+o/2)/o,t.r===s?r.h=n-i:t.g===s?r.h=1/3+e-n:t.b===s&&(r.h=2/3+i-e),r.h<0?r.h+=1:r.h>1&&(r.h-=1)),r},c=function(t){var e,i,n,a=Math.min(t.r,t.g,t.b),s=Math.max(t.r,t.g,t.b),o=s-a,r={h:0,s:0,l:(s+a)/2};return 0===o?(r.h=0,r.s=0):(r.s=r.l<.5?o/(s+a):o/(2-s-a),e=((s-t.r)/6+o/2)/o,i=((s-t.g)/6+o/2)/o,n=((s-t.b)/6+o/2)/o,t.r===s?r.h=n-i:t.g===s?r.h=1/3+e-n:t.b===s&&(r.h=2/3+i-e),r.h<0?r.h+=1:r.h>1&&(r.h-=1)),r},d=function(t){var e=t.x/.95047,i=t.y,n=t.z/1.08883;return e=e>.008856?Math.pow(e,1/3):7.787*e+16/116,{l:(116*(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116)-16)/100,a:(500*(e-i)+128)/255,b:(200*(i-(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116))+128)/255}},u=function(t){return{c:1-t.r,m:1-t.g,y:1-t.b}},h=function(t){var e=1;return t.c<e&&(e=t.c),t.m<e&&(e=t.m),t.y<e&&(e=t.y),1==e?{c:0,m:0,y:0,k:1}:{c:(t.c-e)/(1-e),m:(t.m-e)/(1-e),y:(t.y-e)/(1-e),k:e}};this.set=!0,this.setAlpha=function(t){return null!==t&&(i=a(t)),this},this.getAlpha=function(){return i},this.setRGB=function(t,i,n){return e={rgb:this.getRGB()},null!==t&&(e.rgb.r=a(t)),null!==i&&(e.rgb.g=a(i)),null!==n&&(e.rgb.b=a(n)),this},this.setHSV=function(t,i,n){return e={hsv:this.getHSV()},null!==t&&(e.hsv.h=a(t)),null!==i&&(e.hsv.s=a(i)),null!==n&&(e.hsv.v=a(n)),this},this.setHSL=function(t,i,n){return e={hsl:this.getHSL()},null!==t&&(e.hsl.h=a(t)),null!==i&&(e.hsl.s=a(i)),null!==n&&(e.hsl.l=a(n)),this},this.setLAB=function(t,i,n){return e={lab:this.getLAB()},null!==t&&(e.lab.l=a(t)),null!==i&&(e.lab.a=a(i)),null!==n&&(e.lab.b=a(n)),this},this.setCMYK=function(t,i,n,s){return e={cmyk:this.getCMYK()},null!==t&&(e.cmyk.c=a(t)),null!==i&&(e.cmyk.m=a(i)),null!==n&&(e.cmyk.y=a(n)),null!==s&&(e.cmyk.k=a(s)),this},this.getRGB=function(){var i,n,s,o,r,l;return e.rgb||(e.rgb=e.lab?function(t){var e={r:3.2406*t.x+-1.5372*t.y+-.4986*t.z,g:-.9689*t.x+1.8758*t.y+.0415*t.z,b:.0557*t.x+-.204*t.y+1.057*t.z};return e.r=e.r>.0031308?1.055*Math.pow(e.r,1/2.4)-.055:12.92*e.r,e.g=e.g>.0031308?1.055*Math.pow(e.g,1/2.4)-.055:12.92*e.g,e.b=e.b>.0031308?1.055*Math.pow(e.b,1/2.4)-.055:12.92*e.b,e}((n=e.lab,s=100*n.l,o=255*n.a-128,r=255*n.b-128,(l={x:0,y:(s+16)/116,z:0}).x=o/500+l.y,l.z=l.y-r/200,l.x=Math.pow(l.x,3)>.008856?Math.pow(l.x,3):(l.x-16/116)/7.787,l.y=Math.pow(l.y,3)>.008856?Math.pow(l.y,3):(l.y-16/116)/7.787,l.z=Math.pow(l.z,3)>.008856?Math.pow(l.z,3):(l.z-16/116)/7.787,l.x*=.95047,l.y*=1,l.z*=1.08883,l)):e.hsv?function(t){var e,i,n,a,s,o={r:0,g:0,b:0};return 0===t.s?o.r=o.g=o.b=t.v:(e=1===t.h?0:6*t.h,i=Math.floor(e),n=t.v*(1-t.s),a=t.v*(1-t.s*(e-i)),s=t.v*(1-t.s*(1-(e-i))),0===i?(o.r=t.v,o.g=s,o.b=n):1===i?(o.r=a,o.g=t.v,o.b=n):2===i?(o.r=n,o.g=t.v,o.b=s):3===i?(o.r=n,o.g=a,o.b=t.v):4===i?(o.r=s,o.g=n,o.b=t.v):(o.r=t.v,o.g=n,o.b=a)),o}(e.hsv):e.hsl?function(t){var e,i,n=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),6*i<1?t+6*(e-t)*i:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t};return 0===t.s?{r:t.l,g:t.l,b:t.l}:(i=t.l<.5?t.l*(1+t.s):t.l+t.s-t.s*t.l,{r:n(e=2*t.l-i,i,t.h+1/3),g:n(e,i,t.h),b:n(e,i,t.h-1/3)})}(e.hsl):e.cmyk?function(t){return{r:1-t.c,g:1-t.m,b:1-t.y}}({c:(i=e.cmyk).c*(1-i.k)+i.k,m:i.m*(1-i.k)+i.k,y:i.y*(1-i.k)+i.k}):{r:0,g:0,b:0},e.rgb.r=a(e.rgb.r),e.rgb.g=a(e.rgb.g),e.rgb.b=a(e.rgb.b)),t.extend({},e.rgb)},this.getHSV=function(){return e.hsv||(e.hsv=e.lab?l(this.getRGB()):e.rgb?l(e.rgb):e.hsl||e.cmyk?l(this.getRGB()):{h:0,s:0,v:0},e.hsv.h=a(e.hsv.h),e.hsv.s=a(e.hsv.s),e.hsv.v=a(e.hsv.v)),t.extend({},e.hsv)},this.getHSL=function(){return e.hsl||(e.hsl=e.rgb?c(e.rgb):e.hsv||e.cmyk||e.hsv?c(this.getRGB()):{h:0,s:0,l:0},e.hsl.h=a(e.hsl.h),e.hsl.s=a(e.hsl.s),e.hsl.l=a(e.hsl.l)),t.extend({},e.hsl)},this.getCMYK=function(){return e.cmyk||(e.cmyk=e.rgb?h(u(e.rgb)):e.hsv||e.hsl||e.lab?h(u(this.getRGB())):{c:0,m:0,y:0,k:1},e.cmyk.c=a(e.cmyk.c),e.cmyk.m=a(e.cmyk.m),e.cmyk.y=a(e.cmyk.y),e.cmyk.k=a(e.cmyk.k)),t.extend({},e.cmyk)},this.getLAB=function(){return e.lab||(e.lab=e.rgb?d(r(e.rgb)):e.hsv||e.hsl||e.cmyk?d(r(this.getRGB())):{l:0,a:0,b:0},e.lab.l=a(e.lab.l),e.lab.a=a(e.lab.a),e.lab.b=a(e.lab.b)),t.extend({},e.lab)},this.getChannels=function(){return{r:this.getRGB().r,g:this.getRGB().g,b:this.getRGB().b,a:this.getAlpha(),h:this.getHSV().h,s:this.getHSV().s,v:this.getHSV().v,c:this.getCMYK().c,m:this.getCMYK().m,y:this.getCMYK().y,k:this.getCMYK().k,L:this.getLAB().l,A:this.getLAB().a,B:this.getLAB().b}},this.getSpaces=function(){return t.extend(!0,{},e)},this.setSpaces=function(t){return e=t,this},this.distance=function(t){var e,i="get"+"lab".toUpperCase(),n=this[i](),a=t[i](),s=0;for(e in n)s+=Math.pow(n[e]-a[e],2);return s},this.equals=function(t){var e=this.getRGB(),i=t.getRGB();return this.getAlpha()==t.getAlpha()&&e.r==i.r&&e.g==i.g&&e.b==i.b},this.limit=function(t){t-=1;var e=this.getRGB();this.setRGB(Math.round(e.r*t)/t,Math.round(e.g*t)/t,Math.round(e.b*t)/t)},this.toHex=function(){var t=this.getRGB();return s(255*t.r)+s(255*t.g)+s(255*t.b)},this.toCSS=function(){return"#"+this.toHex()},this.normalize=function(){return this.setHSV(null,1,1),this},this.copy=function(){var t=this.getSpaces(),e=this.getAlpha();return new o(t,e)},2==n.length&&(this.setSpaces(n[0]),this.setAlpha(0===n[1]?0:n[1]||1)),n.length>2&&(this.setRGB(n[0],n[1],n[2]),this.setAlpha(0===n[3]?0:n[3]||1))};t.widget("vanderlee.colorpicker",{options:{alpha:!1,altAlpha:!0,altField:"",altOnChange:!0,altProperties:"background-color",autoOpen:!1,buttonColorize:!1,buttonImage:"images/ui-colorpicker.png",buttonImageOnly:!1,buttonText:null,closeOnEscape:!0,closeOnOutside:!0,color:"#00FF00",colorFormat:"HEX",draggable:!0,duration:"fast",hsv:!0,inline:!0,layout:{map:[0,0,1,5],bar:[1,0,1,5],preview:[2,0,1,1],hsv:[2,1,1,1],rgb:[2,2,1,1],alpha:[2,3,1,1],hex:[2,4,1,1],lab:[3,1,1,1],cmyk:[3,2,1,2],swatches:[4,0,1,5]},limit:"",modal:!1,mode:"h",parts:"",regional:"",rgb:!0,showAnim:"fadeIn",showCancelButton:!0,showNoneButton:!1,showCloseButton:!0,showOn:"focus",showOptions:{},swatches:null,swatchesWidth:84,title:null,close:null,init:null,select:null,open:null},_create:function(){var i,n=this;return++e,n.widgetEventPrefix="color",n.opened=!1,n.generated=!1,n.inline=!1,n.changed=!1,n.dialog=null,n.button=null,n.image=null,n.overlay=null,n.mode=n.options.mode,"input"!==this.element[0].nodeName.toLowerCase()&&n.options.inline?(n.inline=!0,t(this.element).html('<div class="ui-colorpicker ui-colorpicker-inline ui-dialog ui-widget ui-widget-content ui-corner-all"></div>'),n.dialog=t(".ui-colorpicker",this.element),n._generate(),n.opened=!0):(n._setColor(n.element.val()),this._callback("init"),t("body").append('<div class="ui-colorpicker ui-colorpicker-dialog ui-dialog ui-widget ui-widget-content ui-corner-all" style="display: none;"></div>'),n.dialog=t(".ui-colorpicker:last"),t(document).delegate("html","touchstart click",(function(e){if(n.opened&&e.target!==n.element[0]&&!n.overlay)if(n.dialog.is(e.target)||n.dialog.has(e.target).length>0)n.element.blur();else{var i,a=t(e.target).parents();for(i=0;i<=a.length;++i)if(null!==n.button&&a[i]===n.button[0])return;n.options.closeOnOutside&&n.close()}})),t(document).keydown((function(t){27==t.keyCode&&n.opened&&n.options.closeOnEscape&&n.close()})),"focus"!==n.options.showOn&&"both"!==n.options.showOn||n.element.on("focus click",(function(){n.open()})),"button"!==n.options.showOn&&"both"!==n.options.showOn||(""!==n.options.buttonImage&&(i=n.options.buttonText||n._getRegional("button"),n.image=t("<img/>").attr({src:n.options.buttonImage,alt:i,title:i}),n._setImageBackground()),n.options.buttonImageOnly&&n.image?n.button=n.image:(n.button=t('<button type="button"></button>').html(n.image||n.options.buttonText).button(),n.image=n.image?t("img",n.button).first():null),n.button.insertAfter(n.element).click((function(){n[n.opened?"close":"open"]()}))),n.options.autoOpen&&n.open(),n.element.keydown((function(t){9===t.keyCode&&n.close()})).keyup((function(t){var e=n._parseColor(n.element.val());n.color.equals(e)||(n.color=e,n._change())}))),this},_setOption:function(e,i){var n=this;if("disabled"===e)i?n.dialog.addClass("ui-colorpicker-disabled"):n.dialog.removeClass("ui-colorpicker-disabled");t.Widget.prototype._setOption.apply(n,arguments)},_setImageBackground:function(){this.image&&this.options.buttonColorize&&this.image.css("background-color",this.color.set?this._formatColor("RGBA",this.color):"")},_setAltField:function(){if(this.options.altOnChange&&this.options.altField&&this.options.altProperties){var e,i,n=this.options.altProperties.split(",");for(e=0;e<=n.length;++e)switch(i=t.trim(n[e])){case"color":case"background-color":case"outline-color":case"border-color":t(this.options.altField).css(i,this.color.set?this.color.toCSS():"")}this.options.altAlpha&&t(this.options.altField).css("opacity",this.color.set?this.color.getAlpha():"")}},_setColor:function(t){this.color=this._parseColor(t),this.currentColor=this.color.copy(),this._setImageBackground(),this._setAltField()},setColor:function(t){this._setColor(t),this._change(this.color.set)},_generate:function(){var e,n,a=this;a._setColor(a.inline?a.options.color:a.element.val()),e="string"==typeof a.options.parts?i[a.options.parts]?i[a.options.parts]:i[a.inline?"inline":"popup"]:a.options.parts,a.parts={},t.each(e,(function(t,e){s[e]&&(a.parts[e]=new s[e](a))})),a.generated||(n=[],t.each(a.options.layout,(function(t,e){a.parts[t]&&n.push({part:t,pos:e})})),t(function(e,i){var n,a,s,o,r,l,c,d,u,h,p,f,m,g;for(e.sort((function(t,e){return t.pos[1]==e.pos[1]?t.pos[0]-e.pos[0]:t.pos[1]-e.pos[1]})),o=0,r=0,t.each(e,(function(t,e){o=Math.max(o,e.pos[0]+e.pos[2]),r=Math.max(r,e.pos[1]+e.pos[3])})),n=[],a=0;a<o;++a)n.push([]);for(c=[],l=[],t.each(e,(function(t,e){for(a=0;a<e.pos[2];a+=1)l[e.pos[0]+a]=!0;for(s=0;s<e.pos[3];s+=1)c[e.pos[1]+s]=!0})),h="",u=e[d=0],s=0;s<r;++s){for(h+="<tr>",a=0;a<o;a)if(void 0!==u&&a==u.pos[0]&&s==u.pos[1]){for(h+=i(u,a,s),f=0;f<u.pos[3];f+=1)for(p=0;p<u.pos[2];p+=1)n[a+p][s+f]=!0;a+=u.pos[2],u=e[++d]}else{for(m=0,g=!1;a<o&&void 0===n[a][s]&&(void 0===u||s<u.pos[1]||s==u.pos[1]&&a<u.pos[0]);)!0===l[a]&&(m+=1),g=!0,a+=1;m>0?h+='<td colspan="'+m+'"></td>':g||(a+=1)}h+="</tr>"}return'<table cellspacing="0" cellpadding="0" border="0"><tbody>'+h+"</tbody></table>"}(n,(function(t,e,i){var n=["ui-colorpicker-"+t.part+"-container"];return e>0&&n.push("ui-colorpicker-padding-left"),i>0&&n.push("ui-colorpicker-padding-top"),'<td  class="'+n.join(" ")+'"'+(t.pos[2]>1?' colspan="'+t.pos[2]+'"':"")+(t.pos[3]>1?' rowspan="'+t.pos[3]+'"':"")+' valign="top"></td>'}))).appendTo(a.dialog).addClass("ui-dialog-content ui-widget-content"),a._initAllParts(),a._updateAllParts(),a.generated=!0)},_effectGeneric:function(e,i,n,a,s){var o=this;t.effects&&t.effects[o.options.showAnim]?e[i](o.options.showAnim,o.options.showOptions,o.options.duration,s):(e["slideDown"===o.options.showAnim?n:"fadeIn"===o.options.showAnim?a:i](o.options.showAnim?o.options.duration:null,s),o.options.showAnim&&o.options.duration||s())},_effectShow:function(t,e){this._effectGeneric(t,"show","slideDown","fadeIn",e)},_effectHide:function(t,e){this._effectGeneric(t,"hide","slideUp","fadeOut",e)},open:function(){var e,i,n,a,s,o,r,l,c=this;c.opened||(c._generate(),e=c.element.offset(),i=t(window).height()+t(window).scrollTop(),n=t(window).width()+t(window).scrollLeft(),a=c.dialog.outerHeight(),s=c.dialog.outerWidth(),o=e.left,r=e.top+c.element.outerHeight(),o+s>n&&(o=Math.max(0,n-s)),r+a>i&&(r=e.top-a>=t(window).scrollTop()?e.top-a:Math.max(0,i-a)),c.dialog.css({left:o,top:r}),l=0,t(c.element[0]).parents().each((function(){var e=t(this).css("z-index");if(("number"==typeof e||"string"==typeof e)&&""!==e&&!isNaN(e))return l=parseInt(e),!1})),c.dialog.css("z-index",l+=2),c.overlay=c.options.modal?new t.ui.dialog.overlay(c):null,c._effectShow(this.dialog),c.opened=!0,c._callback("open",!0),t((function(){c._repaintAllParts()})))},close:function(){var t=this;t.currentColor=t.color.copy(),t.changed=!1,t._effectHide(t.dialog,(function(){t.dialog.empty(),t.generated=!1,t.opened=!1,t._callback("close",!0)})),t.overlay&&t.overlay.destroy()},destroy:function(){this.element.unbind(),null!==this.image&&this.image.remove(),null!==this.button&&this.button.remove(),null!==this.dialog&&this.dialog.remove(),this.overlay&&this.overlay.destroy()},_callback:function(t,e){var i,n,a=this;return a.color.set?(i={formatted:a._formatColor(a.options.colorFormat,a.color)},(n=a.color.getLAB()).a=2*n.a-1,n.b=2*n.b-1,!0===e&&(i.a=a.color.getAlpha(),i.rgb=a.color.getRGB(),i.hsv=a.color.getHSV(),i.cmyk=a.color.getCMYK(),i.hsl=a.color.getHSL(),i.lab=n),a._trigger(t,null,i)):a._trigger(t,null,{formatted:""})},_initAllParts:function(){t.each(this.parts,(function(t,e){e.init&&e.init()}))},_updateAllParts:function(){t.each(this.parts,(function(t,e){e.update&&e.update()}))},_repaintAllParts:function(){t.each(this.parts,(function(t,e){e.repaint&&e.repaint()}))},_change:function(t){switch(this.color.set=!1!==t,this.changed=!0,this.options.limit){case"websafe":this.color.limit(6);break;case"nibble":this.color.limit(16);break;case"binary":this.color.limit(2);break;case"name":var e=this._getSwatch(this._closestName(this.color));this.color.setRGB(e.r,e.g,e.b)}this.inline||(this.color.set?this.color.equals(this._parseColor(this.element.val()))||this.element.val(this._formatColor(this.options.colorFormat,this.color)):this.element.val(""),this._setImageBackground(),this._setAltField()),this.opened&&this._repaintAllParts(),this._callback("select")},_hoverable:function(t){t.hover((function(){t.addClass("ui-state-hover")}),(function(){t.removeClass("ui-state-hover")}))},_focusable:function(t){t.focus((function(){t.addClass("ui-state-focus")})).blur((function(){t.removeClass("ui-state-focus")}))},_getRegional:function(e){return void 0!==t.colorpicker.regional[this.options.regional][e]?t.colorpicker.regional[this.options.regional][e]:t.colorpicker.regional[""][e]},_getSwatches:function(){return"string"==typeof this.options.swatches?t.colorpicker.swatches[this.options.swatches]:t.isPlainObject(this.options.swatches)?t.colorpicker.swatches:t.colorpicker.swatches.html},_getSwatch:function(e){var i=this._getSwatches(),n=!1;return void 0!==i[e]?i[e]:(t.each(i,(function(t,i){return t.toLowerCase()!=e.toLowerCase()||(n=i,!1)})),n)},_parseColor:function(e){var i,n;return""==e?new o:(i=this._getSwatch(t.trim(e)))?new o(i.r,i.g,i.b):(n=/^rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(e))?new o(n[1]/255,n[2]/255,n[3]/255,parseFloat(n[4])):(n=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(e))?(new o).setHSL(n[1]/255,n[2]/255,n[3]/255).setAlpha(parseFloat(n[4])):(n=/^rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(e))?new o(n[1]/100,n[2]/100,n[3]/100,n[4]/100):(n=/^hsla?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(e))?(new o).setHSL(n[1]/100,n[2]/100,n[3]/100).setAlpha(n[4]/100):(n=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(e))?new o(parseInt(n[1],16)/255,parseInt(n[2],16)/255,parseInt(n[3],16)/255):(n=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(e))?new o(parseInt(n[1]+n[1],16)/255,parseInt(n[2]+n[2],16)/255,parseInt(n[3]+n[3],16)/255):a(e)},_exactName:function(e){var i=!1;return t.each(this._getSwatches(),(function(t,n){return!e.equals(new o(n.r,n.g,n.b))||(i=t,!1)})),i},_closestName:function(e){e.getRGB();var i,n=null,a=!1;return t.each(this._getSwatches(),(function(t,s){if((i=e.distance(new o(s.r,s.g,s.b)))<n||null===n){if(a=t,0==i)return!1;n=i}return!0})),a},_formatColor:function(e,i){var a=this,s=null,o={x:function(t){return n(255*t)},d:function(t){return Math.round(255*t)},f:function(t){return t},p:function(t){return 100*t}},r=i.getChannels();return t.isArray(e)||(e=[e]),t.each(e,(function(t,e){return a._formats[e]?!1===(s=a._formats[e](i,a)):(s=e.replace(/\\?[argbhsvcmykLAB][xdfp]/g,(function(t){return t.match(/^\\/)?t.slice(1):o[t.charAt(1)](r[t.charAt(0)])})),!1)})),s},_formats:{"#HEX":function(t,e){return e._formatColor("#rxgxbx",t)},"#HEX3":function(t,e){var i=e._formats.HEX3(t);return!1!==i&&"#"+i},HEX:function(t,e){return e._formatColor("rxgxbx",t)},HEX3:function(t,e){var i=t.getRGB(),n=Math.round(255*i.r),a=Math.round(255*i.g),s=Math.round(255*i.b);return n>>>4==(n&=15)&&a>>>4==(a&=15)&&s>>>4==(s&=15)&&n.toString(16)+a.toString(16)+s.toString(16)},RGB:function(t,e){return t.getAlpha()>=1&&e._formatColor("rgb(rd,gd,bd)",t)},RGBA:function(t,e){return e._formatColor("rgba(rd,gd,bd,af)",t)},"RGB%":function(t,e){return t.getAlpha()>=1&&e._formatColor("rgb(rp%,gp%,bp%)",t)},"RGBA%":function(t,e){return e._formatColor("rgba(rp%,gp%,bp%,af)",t)},HSL:function(t,e){return t.getAlpha()>=1&&e._formatColor("hsl(hd,sd,vd)",t)},HSLA:function(t,e){return e._formatColor("hsla(hd,sd,vd,af)",t)},"HSL%":function(t,e){return t.getAlpha()>=1&&e._formatColor("hsl(hp%,sp%,vp%)",t)},"HSLA%":function(t,e){return e._formatColor("hsla(hp%,sp%,vp%,af)",t)},NAME:function(t,e){return e._closestName(t)},EXACT:function(t,e){return e._exactName(t)}}})}(jQuery),function(t){"function"==typeof define&&define.amd?define(["./jquery"],t):t(jQuery)}((function(t){var e=/\+/g;function i(t){return t}function n(t){return decodeURIComponent(t.replace(e," "))}function a(t){0===t.indexOf('"')&&(t=t.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return s.json?JSON.parse(t):t}catch(t){}}var s=t.cookie=function(e,o,r){if(void 0!==o){if("number"==typeof(r=t.extend({},s.defaults,r)).expires){var l=r.expires,c=r.expires=new Date;c.setDate(c.getDate()+l)}return o=s.json?JSON.stringify(o):String(o),document.cookie=[s.raw?e:encodeURIComponent(e),"=",s.raw?o:encodeURIComponent(o),r.expires?"; expires="+r.expires.toUTCString():"",r.path?"; path="+r.path:"",r.domain?"; domain="+r.domain:"",r.secure?"; secure":""].join("")}for(var d=s.raw?i:n,u=document.cookie.split("; "),h=e?void 0:{},p=0,f=u.length;p<f;p++){var m=u[p].split("="),g=d(m.shift()),v=d(m.join("="));if(e&&e===g){h=a(v);break}e||(h[g]=a(v))}return h};s.defaults={},t.removeCookie=function(e,i){return void 0!==t.cookie(e)&&(t.cookie(e,"",t.extend({},i,{expires:-1})),!0)}})),function(e){function n(t){return function(t){return t.replace(new RegExp("^[\\s]+","g"),"")}(function(t){return t.replace(new RegExp("[\\s]+$","g"),"")}(t))}e.fn.dump=function(){return e.dump(this)},e.dump=function(a){var s=function(a,r){r||(r=0);var l="",c="";for(i=0;i<r;i++)c+="\t";switch(t=o(a),t){case"string":return'"'+a+'"';case"number":case"error":return a.toString();case"boolean":return a?"true":"false";case"date":return"Date: "+a.toLocaleString();case"array":l+="Array ( \n",e.each(a,(function(t,e){l+=c+"\t"+t+" => "+s(e,r+1)+"\n"})),l+=c+")";break;case"object":l+="Object { \n",e.each(a,(function(t,e){l+=c+"\t"+t+": "+s(e,r+1)+"\n"})),l+=c+"}";break;case"jquery":l+="jQuery Object { \n",e.each(a,(function(t,e){l+=c+"\t"+t+" = "+s(e,r+1)+"\n"})),l+=c+"}";break;case"regexp":return"RegExp: "+a.toString();case"document":case"domelement":l+="DOMElement [ \n"+c+"\tnodeName: "+a.nodeName+"\n"+c+"\tnodeValue: "+a.nodeValue+"\n"+c+"\tinnerHTML: [ \n",e.each(a.childNodes,(function(t,e){if(t<1)var i=0;"string"==o(e)?e.textContent.match(/[^\s]/)?l+=c+"\t\t"+(t-(i||0))+" = String: "+n(e.textContent)+"\n":i--:l+=c+"\t\t"+(t-(i||0))+" = "+s(e,r+2)+"\n"})),l+=c+"\t]\n"+c+"]";break;case"function":var d=a.toString().match(/^(.*)\(([^\)]*)\)/im);return d[1]=n(d[1].replace(new RegExp("[\\s]+","g")," ")),d[2]=n(d[2].replace(new RegExp("[\\s]+","g")," ")),d[1]+"("+d[2]+")";default:l+="N/A: "+t}return l},o=function(t){var e=typeof t;if("object"!=e)return e;switch(t){case null:return"null";case window:return"window";case document:return"document";case window.event:return"event"}if(t.jquery)return"jquery";switch(t.constructor){case Array:return"array";case Boolean:return"boolean";case Date:return"date";case Object:return"object";case RegExp:return"regexp";case ReferenceError:case Error:return"error"}switch(t.nodeType){case 1:return"domelement";case 3:return"string"}return"Unknown"};return s(a)}}(jQuery),function(){var t={getSelection:function(){var t=this.jquery?this[0]:this;return("selectionStart"in t&&function(){var e=t.selectionEnd-t.selectionStart;return{start:t.selectionStart,end:t.selectionEnd,length:e,text:t.value.substr(t.selectionStart,e)}}||document.selection&&function(){t.focus();var e=document.selection.createRange();if(null===e)return{start:0,end:t.value.length,length:0};var i=t.createTextRange(),n=i.duplicate();return i.moveToBookmark(e.getBookmark()),n.setEndPoint("EndToStart",i),{start:n.text.length,end:n.text.length+e.text.length,length:e.text.length,text:e.text}}||function(){return null})()},setSelection:function(){var t=this.jquery?this[0]:this,e=arguments[0]||{};return("selectionStart"in t&&function(){var i="object"==typeof e?e.start:e;return null!=i&&(t.selectionStart=i),null!=e.end&&(t.selectionEnd=e.end),t.focus(),this}||document.selection&&function(){t.focus();var i=document.selection.createRange();if(null===i)return this;var n="object"==typeof e?e.start:e;return null!=n&&(i.moveStart("character",-t.value.length),i.moveStart("character",n),i.collapse()),null!=e.end&&i.moveEnd("character",e.end-n),i.select(),this}||function(){return t.focus(),jQuery(t)})()},replaceSelection:function(){var t=this.jquery?this[0]:this,e=arguments[0]||"";return("selectionStart"in t&&function(){return t.value=t.value.substr(0,t.selectionStart)+e+t.value.substr(t.selectionEnd,t.value.length),this}||document.selection&&function(){return t.focus(),document.selection.createRange().text=e,this}||function(){return t.value+=e,jQuery(t)})()}};jQuery.each(t,(function(t){jQuery.fn[t]=this}))}(),function(t){t.fn.hoverIntent=function(e,i){var n,a,s,o,r={sensitivity:7,interval:100,timeout:0};r=t.extend(r,i?{over:e,out:i}:e);var l=function(t){n=t.pageX,a=t.pageY},c=function(e,i){if(i.hoverIntent_t=clearTimeout(i.hoverIntent_t),Math.abs(s-n)+Math.abs(o-a)<r.sensitivity)return t(i).unbind("mousemove",l),i.hoverIntent_s=1,r.over.apply(i,[e]);s=n,o=a,i.hoverIntent_t=setTimeout((function(){c(e,i)}),r.interval)},d=function(e){var i=jQuery.extend({},e),n=this;n.hoverIntent_t&&(n.hoverIntent_t=clearTimeout(n.hoverIntent_t)),"mouseenter"==e.type?(s=i.pageX,o=i.pageY,t(n).bind("mousemove",l),1!=n.hoverIntent_s&&(n.hoverIntent_t=setTimeout((function(){c(i,n)}),r.interval))):(t(n).unbind("mousemove",l),1==n.hoverIntent_s&&(n.hoverIntent_t=setTimeout((function(){!function(t,e){e.hoverIntent_t=clearTimeout(e.hoverIntent_t),e.hoverIntent_s=0,r.out.apply(e,[t])}(i,n)}),r.timeout)))};return this.bind("mouseenter",d).bind("mouseleave",d)}}(jQuery),function(t){function e(){}function i(t){s=[t]}function n(t,e,i){return t&&t.apply(e.context||e,i)}function a(t){return/\?/.test(t)?"&":"?"}var s,o="async",r="error",l="insertBefore",c="_jqjsp",d="on",u="onclick",h=d+r,p="onload",f="onreadystatechange",m="readyState",g="removeChild",v="<script>",b="success",y="timeout",_=window,x=t.Deferred,w=t("head")[0]||document.documentElement,C={},k=0,$={callback:c,url:location.href},S=_.opera,T=!!t("<div>").html("\x3c!--[if IE]><i><![endif]--\x3e").find("i").length;function I(d){var I,D,A,P,O,E=(d=t.extend({},$,d)).success,M=d.error,L=d.complete,j=d.dataFilter,R=d.callbackParameter,N=d.callback,B=d.cache,F=d.pageCache,H=d.charset,z=d.url,W=d.data,U=d.timeout,q=0,Y=e;if(x&&x((function(t){t.done(E).fail(M),E=t.resolve,M=t.reject})).promise(d),d.abort=function(){!q++&&Y()},!1===n(d.beforeSend,d,[d])||q)return d;function V(t){q++||(Y(),F&&(C[z]={s:[t]}),j&&(t=j.apply(d,[t])),n(E,d,[t,b,d]),n(L,d,[d,b]))}function G(t){q++||(Y(),F&&t!=y&&(C[z]=t),n(M,d,[d,t]),n(L,d,[d,t]))}return z=z||"",W=W?"string"==typeof W?W:t.param(W,d.traditional):"",z+=W?a(z)+W:"",R&&(z+=a(z)+encodeURIComponent(R)+"=?"),!B&&!F&&(z+=a(z)+"_"+(new Date).getTime()+"="),z=z.replace(/=\?(&|$)/,"="+N+"$1"),F&&(I=C[z])?I.s?V(I.s[0]):G(I):(_[N]=i,(A=t(v)[0]).id=c+k++,H&&(A.charset=H),S&&S.version()<11.6?(P=t(v)[0]).text="document.getElementById('"+A.id+"')."+h+"()":A[o]=o,T&&(A.htmlFor=A.id,A.event=u),A[p]=A[h]=A[f]=function(t){if(!A[m]||!/i/.test(A[m])){try{A[u]&&A[u]()}catch(t){}t=s,s=0,t?V(t[0]):G(r)}},A.src=z,Y=function(t){O&&clearTimeout(O),A[f]=A[p]=A[h]=null,w[g](A),P&&w[g](P)},w[l](A,D=w.firstChild),P&&w[l](P,D),O=U>0&&setTimeout((function(){G(y)}),U)),d}I.setup=function(e){t.extend($,e)},t.jsonp=I}(jQuery),function(){var t=function(t,e,i){return i(t=jsPlumbUtil.isArray(t)?t:[t.x,t.y],e=jsPlumbUtil.isArray(e)?e:[e.x,e.y])};jsPlumbUtil={isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},isNumber:function(t){return"[object Number]"===Object.prototype.toString.call(t)},isString:function(t){return"string"==typeof t},isBoolean:function(t){return"boolean"==typeof t},isNull:function(t){return null==t},isObject:function(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)},isDate:function(t){return"[object Date]"===Object.prototype.toString.call(t)},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)},clone:function(t){if(this.isString(t))return""+t;if(this.isBoolean(t))return!!t;if(this.isDate(t))return new Date(t.getTime());if(this.isFunction(t))return t;if(this.isArray(t)){for(var e=[],i=0;i<t.length;i++)e.push(this.clone(t[i]));return e}if(this.isObject(t)){e={};for(var i in t)e[i]=this.clone(t[i]);return e}return t},merge:function(t,e){var i=this.clone(t);for(var n in e)if(null==i[n]||this.isString(e[n])||this.isBoolean(e[n]))i[n]=e[n];else if(this.isArray(e[n])){var a=[];this.isArray(i[n])&&a.push.apply(a,i[n]),a.push.apply(a,e[n]),i[n]=a}else if(this.isObject(e[n]))for(var s in this.isObject(i[n])||(i[n]={}),e[n])i[n][s]=e[n][s];return i},copyValues:function(t,e,i){for(var n=0;n<t.length;n++)i[t[n]]=e[t[n]]},functionChain:function(t,e,i){for(var n=0;n<i.length;n++){var a=i[n][0][i[n][1]].apply(i[n][0],i[n][2]);if(a===e)return a}return t},populate:function(t,e){var i=function(t){if(null!=t){if(jsPlumbUtil.isString(t))return function(t){var i=t.match(/(\${.*?})/g);if(null!=i)for(var n=0;n<i.length;n++){var a=e[i[n].substring(2,i[n].length-1)];null!=a&&(t=t.replace(i[n],a))}return t}(t);if(jsPlumbUtil.isArray(t)){for(var n=[],a=0;a<t.length;a++)n.push(i(t[a]));return n}if(jsPlumbUtil.isObject(t)){n={};for(var a in t)n[a]=i(t[a]);return n}return t}};return i(t)},convertStyle:function(t,e){if("transparent"===t)return t;var i=t,n=function(t){return function(t){return 1==t.length?"0"+t:t}(Number(t).toString(16))},a=/(rgb[a]?\()(.*)(\))/;if(t.match(a)){var s=t.match(a)[2].split(",");i="#"+n(s[0])+n(s[1])+n(s[2]),e||4!=s.length||(i+=n(s[3]))}return i},gradient:function(e,i){return t(e,i,(function(t,e){return e[0]==t[0]?e[1]>t[1]?1/0:-1/0:e[1]==t[1]?e[0]>t[0]?0:-0:(e[1]-t[1])/(e[0]-t[0])}))},normal:function(t,e){return-1/this.gradient(t,e)},lineLength:function(e,i){return t(e,i,(function(t,e){return Math.sqrt(Math.pow(e[1]-t[1],2)+Math.pow(e[0]-t[0],2))}))},segment:function(e,i){return t(e,i,(function(t,e){return e[0]>t[0]||e[0]==t[0]?e[1]>t[1]?2:1:e[1]>t[1]?3:4}))},theta:function(e,i){return t(e,i,(function(t,e){var i=jsPlumbUtil.gradient(t,e),n=Math.atan(i),a=jsPlumbUtil.segment(t,e);return 4!=a&&3!=a||(n+=Math.PI),n<0&&(n+=2*Math.PI),n}))},intersects:function(t,e){var i=t.x,n=t.x+t.w,a=t.y,s=t.y+t.h,o=e.x,r=e.x+e.w,l=e.y,c=e.y+e.h;return i<=o&&o<=n&&a<=l&&l<=s||i<=r&&r<=n&&a<=l&&l<=s||i<=o&&o<=n&&a<=c&&c<=s||i<=r&&o<=n&&a<=c&&c<=s||o<=i&&i<=r&&l<=a&&a<=c||o<=n&&n<=r&&l<=a&&a<=c||o<=i&&i<=r&&l<=s&&s<=c||o<=n&&i<=r&&l<=s&&s<=c},segmentMultipliers:[null,[1,-1],[1,1],[-1,1],[-1,-1]],inverseSegmentMultipliers:[null,[-1,-1],[-1,1],[1,1],[1,-1]],pointOnLine:function(t,e,i){var n=jsPlumbUtil.gradient(t,e),a=jsPlumbUtil.segment(t,e),s=i>0?jsPlumbUtil.segmentMultipliers[a]:jsPlumbUtil.inverseSegmentMultipliers[a],o=Math.atan(n),r=Math.abs(i*Math.sin(o))*s[1],l=Math.abs(i*Math.cos(o))*s[0];return{x:t.x+l,y:t.y+r}},perpendicularLineTo:function(t,e,i){var n=jsPlumbUtil.gradient(t,e),a=Math.atan(-1/n),s=i/2*Math.sin(a),o=i/2*Math.cos(a);return[{x:e.x+o,y:e.y+s},{x:e.x-o,y:e.y-s}]},findWithFunction:function(t,e){if(t)for(var i=0;i<t.length;i++)if(e(t[i]))return i;return-1},clampToGrid:function(t,e,i,n,a){var s=function(t,e){var i=t%e;return(Math.floor(t/e)+(i>=e/2?1:0))*e};return[n||null==i?t:s(t,i[0]),a||null==i?e:s(e,i[1])]},indexOf:function(t,e){return jsPlumbUtil.findWithFunction(t,(function(t){return t==e}))},removeWithFunction:function(t,e){var i=jsPlumbUtil.findWithFunction(t,e);return i>-1&&t.splice(i,1),-1!=i},remove:function(t,e){var i=jsPlumbUtil.indexOf(t,e);return i>-1&&t.splice(i,1),-1!=i},addWithFunction:function(t,e,i){-1==jsPlumbUtil.findWithFunction(t,i)&&t.push(e)},addToList:function(t,e,i){var n=t[e];return null==n&&(n=[],t[e]=n),n.push(i),n},EventGenerator:function(){var t={},e=this,i=!1,n=["ready"];this.bind=function(i,n){return jsPlumbUtil.addToList(t,i,n),e},this.fire=function(a,s,o){if(!i&&t[a])for(var r=0;r<t[a].length;r++)if(-1!=jsPlumbUtil.findWithFunction(n,(function(t){return t===a})))t[a][r](s,o);else try{t[a][r](s,o)}catch(t){jsPlumbUtil.log("jsPlumb: fire failed for event "+a+" : "+t)}return e},this.unbind=function(i){return i?delete t[i]:t={},e},this.getListener=function(e){return t[e]},this.setSuspendEvents=function(t){i=t},this.isSuspendEvents=function(){return i}},logEnabled:!0,log:function(){if(jsPlumbUtil.logEnabled&&"undefined"!=typeof console)try{var t=arguments[arguments.length-1];console.log(t)}catch(t){}},group:function(t){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.group(t)},groupEnd:function(t){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.groupEnd(t)},time:function(t){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.time(t)},timeEnd:function(t){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.timeEnd(t)},removeElement:function(t){null!=t&&null!=t.parentNode&&t.parentNode.removeChild(t)},removeElements:function(t){for(var e=0;e<t.length;e++)jsPlumbUtil.removeElement(t[e])}}}(),function(){var t=!!document.createElement("canvas").getContext,e=!!window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),i=function(){if(null==i.vml){var t=document.body.appendChild(document.createElement("div"));t.innerHTML='<v:shape id="vml_flag1" adj="1" />';var e=t.firstChild;e.style.behavior="url(#default#VML)",i.vml=!e||"object"==typeof e.adj,t.parentNode.removeChild(t)}return i.vml},n=function(t){var e={},i=[],n={},a={},s={};this.register=function(o){var r=jsPlumb.CurrentLibrary;o=r.getElementObject(o);var l=t.getId(o),c=r.getDOMElement(o),d=r.getOffset(o);e[l]||(e[l]=o,i.push(o),n[l]={});var u=function(e,i){if(e)for(var o=0;o<e.childNodes.length;o++)if(3!=e.childNodes[o].nodeType&&8!=e.childNodes[o].nodeType){var c=r.getElementObject(e.childNodes[o]),h=t.getId(c,null,!0);if(h&&a[h]&&a[h]>0){var p=r.getOffset(c);n[l][h]={id:h,offset:{left:p.left-d.left,top:p.top-d.top}},s[h]=l}u(e.childNodes[o])}};u(c)},this.updateOffsets=function(e){var i=jsPlumb.CurrentLibrary,a=i.getElementObject(e),o=t.getId(a),r=n[o],l=i.getOffset(a);if(r)for(var c in r){var d=i.getElementObject(c),u=i.getOffset(d);n[o][c]={id:c,offset:{left:u.left-l.left,top:u.top-l.top}},s[c]=o}},this.endpointAdded=function(i){var o=jsPlumb.CurrentLibrary,r=document.body,l=t.getId(i),c=o.getDOMElement(i).parentNode;for(a[l]=a[l]?a[l]+1:1;null!=c&&c!=r;){var d=t.getId(c,null,!0);if(d&&e[d]){var u=o.getElementObject(c),h=o.getOffset(u);if(null==n[d][l]){var p=jsPlumb.CurrentLibrary.getOffset(i);n[d][l]={id:l,offset:{left:p.left-h.left,top:p.top-h.top}},s[l]=d}break}c=c.parentNode}},this.endpointDeleted=function(t){if(a[t.elementId]&&(a[t.elementId]--,a[t.elementId]<=0))for(var e in n)n[e]&&(delete n[e][t.elementId],delete s[t.elementId])},this.changeId=function(t,e){n[e]=n[t],n[t]={},s[e]=s[t],s[t]=null},this.getElementsForDraggable=function(t){return n[t]},this.elementRemoved=function(t){var e=s[t];e&&(delete n[e][t],delete s[t])},this.reset=function(){e={},i=[],n={},a={}}};window.console||(window.console={time:function(){},timeEnd:function(){},group:function(){},groupEnd:function(){},log:function(){}}),window.jsPlumbAdapter={headless:!1,appendToRoot:function(t){document.body.appendChild(t)},getRenderModes:function(){return["canvas","svg","vml"]},isRenderModeAvailable:function(n){return{canvas:t,svg:e,vml:i()}[n]},getDragManager:function(t){return new n(t)},setRenderMode:function(t){var e;if(t){t=t.toLowerCase();var i=this.isRenderModeAvailable("canvas"),n=this.isRenderModeAvailable("svg"),a=this.isRenderModeAvailable("vml");"svg"===t?n?e="svg":i?e="canvas":a&&(e="vml"):"canvas"===t&&i?e="canvas":a&&(e="vml")}return e}}}(),function(){jsPlumbUtil.findWithFunction;var t=jsPlumbUtil.indexOf,e=jsPlumbUtil.removeWithFunction,i=(jsPlumbUtil.remove,jsPlumbUtil.addWithFunction,jsPlumbUtil.addToList),n=jsPlumbUtil.isArray,a=jsPlumbUtil.isString,s=jsPlumbUtil.isObject,o=function(t,e){return v.CurrentLibrary.getAttribute(c(t),e)},r=function(t,e){v.CurrentLibrary.addClass(c(t),e)},l=function(t,e){v.CurrentLibrary.removeClass(c(t),e)},c=function(t){return v.CurrentLibrary.getElementObject(t)},d=function(t,e){var i=v.CurrentLibrary.getOffset(c(t));if(null!=e){var n=e.getZoom();return{left:i.left/n,top:i.top/n}}return i},u=function(t){return v.CurrentLibrary.getSize(c(t))},h=jsPlumbUtil.log,p=(jsPlumbUtil.group,jsPlumbUtil.groupEnd,jsPlumbUtil.time,jsPlumbUtil.timeEnd,function(){return""+(new Date).getTime()}),f=window.jsPlumbUIComponent=function(t){var e=this,i=arguments,n=!1,a=t.parameters||{},s=e.idPrefix+(new Date).getTime(),o=null,c=null;if(e._jsPlumb=t._jsPlumb,e.getId=function(){return s},e.hoverClass=t.hoverClass||e._jsPlumb.Defaults.HoverClass||v.Defaults.HoverClass,jsPlumbUtil.EventGenerator.apply(this),t.events)for(var d in t.events)e.bind(d,t.events[d]);this.clone=function(){var t=new Object;return e.constructor.apply(t,i),t},this.getParameter=function(t){return a[t]},this.getParameters=function(){return a},this.setParameter=function(t,e){a[t]=e},this.setParameters=function(t){a=t},this.overlayPlacements=[];var u=t.beforeDetach;this.isDetachAllowed=function(t){var e=!0;if(u)try{e=u(t)}catch(t){h("jsPlumb: beforeDetach callback failed",t)}return e};var f=t.beforeDrop;this.isDropAllowed=function(t,i,n,a,s){var o=e._jsPlumb.checkCondition("beforeDrop",{sourceId:t,targetId:i,scope:n,connection:a,dropEndpoint:s});if(f)try{o=f({sourceId:t,targetId:i,scope:n,connection:a,dropEndpoint:s})}catch(t){h("jsPlumb: beforeDrop callback failed",t)}return o};var m=function(){if(o&&c){var t={};v.extend(t,o),v.extend(t,c),delete e.hoverPaintStyle,t.gradient&&o.fillStyle&&delete t.gradient,c=t}};this.setPaintStyle=function(t,i){o=t,e.paintStyleInUse=o,m(),i||e.repaint()},this.getPaintStyle=function(){return o},this.setHoverPaintStyle=function(t,i){c=t,m(),i||e.repaint()},this.getHoverPaintStyle=function(){return c},this.setHover=function(t,i,a){e._jsPlumb.currentlyDragging||e._jsPlumb.isHoverSuspended()||(n=t,null!=e.canvas&&(null!=e.hoverClass&&(t?g.addClass(e.canvas,e.hoverClass):g.removeClass(e.canvas,e.hoverClass)),t?g.addClass(e.canvas,e._jsPlumb.hoverClass):g.removeClass(e.canvas,e._jsPlumb.hoverClass)),null!=c&&(e.paintStyleInUse=t?c:o,e._jsPlumb.isSuspendDrawing()||(a=a||p(),e.repaint({timestamp:a,recalc:!1}))),e.getAttachedElements&&!i&&w(t,p(),e))},this.isHover=function(){return n},this.bindListeners=function(t,e,i){t.bind("click",(function(t,i){e.fire("click",e,i)})),t.bind("dblclick",(function(t,i){e.fire("dblclick",e,i)})),t.bind("contextmenu",(function(t,i){e.fire("contextmenu",e,i)})),t.bind("mouseenter",(function(t,n){e.isHover()||(i(!0),e.fire("mouseenter",e,n))})),t.bind("mouseexit",(function(t,n){e.isHover()&&(i(!1),e.fire("mouseexit",e,n))})),t.bind("mousedown",(function(t,i){e.fire("mousedown",e,i)})),t.bind("mouseup",(function(t,i){e.fire("mouseup",e,i)}))};var g=v.CurrentLibrary,b=["click","dblclick","mouseenter","mouseout","mousemove","mousedown","mouseup","contextmenu"],y={mouseout:"mouseexit"},_=function(t,e,i){var n=y[i]||i;g.bind(t,i,(function(t){e.fire(n,e,t)}))},x=function(t,e){g.unbind(t,e)};this.attachListeners=function(t,e){for(var i=0,n=b.length;i<n;i++)_(t,e,b[i])};var w=function(t,i,n){var a=e.getAttachedElements();if(a)for(var s=0,o=a.length;s<o;s++)n&&n==a[s]||a[s].setHover(t,!0,i)};this.reattachListenersForElement=function(t){if(arguments.length>1){for(var i=0,n=b.length;i<n;i++)x(t,b[i]);for(i=1,n=arguments.length;i<n;i++)e.attachListeners(t,arguments[i])}};var C=[],k=function(t){return null==t?null:t.split(" ")},$=function(t,i){if(e.getDefaultType){for(var n=e.getTypeDescriptor(),a=jsPlumbUtil.merge({},e.getDefaultType()),s=0,o=C.length;s<o;s++)a=jsPlumbUtil.merge(a,e._jsPlumb.getType(C[s],n));t&&(a=jsPlumbUtil.populate(a,t)),e.applyType(a,i),i||e.repaint()}};e.setType=function(t,e,i){C=k(t)||[],$(e,i)},e.getType=function(){return C},e.reapplyTypes=function(t,e){$(t,e)},e.hasType=function(t){return-1!=jsPlumbUtil.indexOf(C,t)},e.addType=function(t,i,n){var a=k(t),s=!1;if(null!=a){for(var o=0,r=a.length;o<r;o++)e.hasType(a[o])||(C.push(a[o]),s=!0);s&&$(i,n)}},e.removeType=function(t,e){var i,n,a=k(t),s=!1;if(null!=a){for(var o=0,r=a.length;o<r;o++)i=a[o],n=void 0,s=-1!=(n=jsPlumbUtil.indexOf(C,i))&&(C.splice(n,1),!0)||s;s&&$(null,e)}},e.toggleType=function(t,e,i){var n=k(t);if(null!=n){for(var a=0,s=n.length;a<s;a++){var o=jsPlumbUtil.indexOf(C,n[a]);-1!=o?C.splice(o,1):C.push(n[a])}$(e,i)}},this.applyType=function(t,i){if(e.setPaintStyle(t.paintStyle,i),e.setHoverPaintStyle(t.hoverPaintStyle,i),t.parameters)for(var n in t.parameters)e.setParameter(n,t.parameters[n])},this.addClass=function(t){null!=e.canvas&&r(e.canvas,t)},this.removeClass=function(t){null!=e.canvas&&l(e.canvas,t)}},m=(window.overlayCapableJsPlumbUIComponent=function(t){f.apply(this,arguments);var e=this;this.overlays=[];var i=function(t){var i=null;if(n(t)){var a=t[0],s=v.extend({component:e,_jsPlumb:e._jsPlumb},t[1]);3==t.length&&v.extend(s,t[2]),i=new(v.Overlays[e._jsPlumb.getRenderMode()][a])(s)}else i=t.constructor==String?new(v.Overlays[e._jsPlumb.getRenderMode()][t])({component:e,_jsPlumb:e._jsPlumb}):t;e.overlays.push(i)},a=function(t){var i,n=e.defaultOverlayKeys||[],a=t.overlays;a||(a=[]);for(var s=0,o=n.length;s<o;s++)a.unshift.apply(a,(i=n[s],e._jsPlumb.Defaults[i]||v.Defaults[i]||[]));return a}(t);if(a)for(var s=0,o=a.length;s<o;s++)i(a[s]);var r=function(t){for(var i=-1,n=0,a=e.overlays.length;n<a;n++)if(t===e.overlays[n].id){i=n;break}return i};this.addOverlay=function(t,n){i(t),n||e.repaint()},this.getOverlay=function(t){var i=r(t);return i>=0?e.overlays[i]:null},this.getOverlays=function(){return e.overlays},this.hideOverlay=function(t){var i=e.getOverlay(t);i&&i.hide()},this.hideOverlays=function(){for(var t=0,i=e.overlays.length;t<i;t++)e.overlays[t].hide()},this.showOverlay=function(t){var i=e.getOverlay(t);i&&i.show()},this.showOverlays=function(){for(var t=0,i=e.overlays.length;t<i;t++)e.overlays[t].show()},this.removeAllOverlays=function(){for(var t=0,i=e.overlays.length;t<i;t++)e.overlays[t].cleanup&&e.overlays[t].cleanup();e.overlays.splice(0,e.overlays.length),e.repaint()},this.removeOverlay=function(t){var i=r(t);if(-1!=i){var n=e.overlays[i];n.cleanup&&n.cleanup(),e.overlays.splice(i,1)}},this.removeOverlays=function(){for(var t=0,i=arguments.length;t<i;t++)e.removeOverlay(arguments[t])};var l="__label",c=function(t){var i={cssClass:t.cssClass,labelStyle:this.labelStyle,id:l,component:e,_jsPlumb:e._jsPlumb},n=v.extend(i,t);return new(v.Overlays[e._jsPlumb.getRenderMode()].Label)(n)};if(t.label){var d=t.labelLocation||e.defaultLabelLocation||.5,u=t.labelStyle||e._jsPlumb.Defaults.LabelStyle||v.Defaults.LabelStyle;this.overlays.push(c({label:t.label,location:d,labelStyle:u}))}this.setLabel=function(t){var i=e.getOverlay(l);if(i)t.constructor==String||t.constructor==Function?i.setLabel(t):(t.label&&i.setLabel(t.label),t.location&&i.setLocation(t.location));else{var n=t.constructor==String||t.constructor==Function?{label:t}:t;i=c(n),this.overlays.push(i)}e._jsPlumb.isSuspendDrawing()||e.repaint()},this.getLabel=function(){var t=e.getOverlay(l);return null!=t?t.getLabel():null},this.getLabelOverlay=function(){return e.getOverlay(l)};var h=this.applyType;this.applyType=function(t,i){if(h(t,i),e.removeAllOverlays(),t.overlays)for(var n=0,a=t.overlays.length;n<a;n++)e.addOverlay(t.overlays[n],!0)};var p=this.setHover;this.setHover=function(t,i,n){p.apply(e,arguments);for(var a=0,s=e.overlays.length;a<s;a++)e.overlays[a][t?"addClass":"removeClass"](e._jsPlumb.hoverClass)}},0),g=function(g){this.Defaults={Anchor:"BottomCenter",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fillStyle:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{lineWidth:8,strokeStyle:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},g&&v.extend(this.Defaults,g),this.logEnabled=this.Defaults.LogEnabled;var b={},y={};this.registerConnectionType=function(t,e){b[t]=v.extend({},e)},this.registerConnectionTypes=function(t){for(var e in t)b[e]=v.extend({},t[e])},this.registerEndpointType=function(t,e){y[t]=v.extend({},e)},this.registerEndpointTypes=function(t){for(var e in t)y[e]=v.extend({},t[e])},this.getType=function(t,e){return"connection"===e?b[t]:y[t]},jsPlumbUtil.EventGenerator.apply(this);var _=this,x=function(){var t=m+1;return m++,t}(),w=_.bind,C={},k=1;for(var $ in this.getInstanceIndex=function(){return x},this.setZoom=function(t,e){k=t,e&&_.repaintEverything()},this.getZoom=function(){return k},this.Defaults)C[$]=this.Defaults[$];this.bind=function(t,e){"ready"===t&&T?e():w.apply(_,[t,e])},_.importDefaults=function(t){for(var e in t)_.Defaults[e]=t[e]},_.restoreDefaults=function(){_.Defaults=v.extend({},C)};var S=null,T=!1,I=null,D={},A={},P={},O={},E={},M={},L={},j=[],R=this.Defaults.Scope,N=null,B=1,F=function(){return""+B++},H=function(t){return t._nodes?t._nodes:t},z=function(t,e,i,n){if(!jsPlumbAdapter.headless&&!It){var a=o(t,"id"),s=_.dragManager.getElementsForDraggable(a);if(null==i&&(i=p()),_.anchorManager.redraw(a,e,i,null,n),s)for(var r in s)_.anchorManager.redraw(s[r].id,e,i,s[r].offset,n)}},W=function(t,e){var i=null;if(n(t)){i=[];for(var a=0,s=t.length;a<s;a++){var r=c(t[a]),l=o(r,"id");i.push(e(r,l))}}else{i=e(r=c(t),l=o(r,"id"))}return i},U=function(t){return P[t]},q=function(t,e,i){if(!jsPlumbAdapter.headless){var n=null!=e&&e,a=v.CurrentLibrary;if(n&&a.isDragSupported(t)&&!a.isAlreadyDraggable(t)){var s=i||_.Defaults.DragOptions||v.Defaults.DragOptions;s=v.extend({},s);var o=a.dragEvents.drag,c=a.dragEvents.stop,d=a.dragEvents.start;s[d]=et(s[d],(function(){_.setHoverSuspended(!0),_.select({source:t}).addClass(_.elementDraggingClass+" "+_.sourceElementDraggingClass,!0),_.select({target:t}).addClass(_.elementDraggingClass+" "+_.targetElementDraggingClass,!0)})),s[o]=et(s[o],(function(){var e=a.getUIPosition(arguments,_.getZoom());z(t,e,null,!0),r(t,"jsPlumb_dragged")})),s[c]=et(s[c],(function(){var e=a.getUIPosition(arguments,_.getZoom());z(t,e),l(t,"jsPlumb_dragged"),_.setHoverSuspended(!1),_.select({source:t}).removeClass(_.elementDraggingClass+" "+_.sourceElementDraggingClass,!0),_.select({target:t}).removeClass(_.elementDraggingClass+" "+_.targetElementDraggingClass,!0)}));var u=tt(t);L[u]=!0;n=L[u];s.disabled=null!=n&&!n,a.initDraggable(t,s,!1,_),_.dragManager.register(t)}}},Y=function(t){var e=_.Defaults.ConnectionType||_.getDefaultConnectionType(),i=_.Defaults.EndpointType||v.Endpoint,n=v.CurrentLibrary.getParent;t.container?t.parent=t.container:t.sourceEndpoint?t.parent=t.sourceEndpoint.parent:t.source.constructor==i?t.parent=t.source.parent:t.parent=n(t.source),t._jsPlumb=_,t.newConnection=Y,t.newEndpoint=X,t.endpointsByUUID=P,t.endpointsByElement=A,t.finaliseConnection=V;var a=new e(t);return a.id="con_"+F(),G("click","click",a),G("dblclick","dblclick",a),G("contextmenu","contextmenu",a),a},V=function(t,e,n){if(e=e||{},t.suspendedEndpoint||i(D,t.scope,t),_.anchorManager.newConnection(t),z(t.source),!e.doNotFireConnectionEvent&&!1!==e.fireEvent){var a={connection:t,source:t.source,target:t.target,sourceId:t.sourceId,targetId:t.targetId,sourceEndpoint:t.endpoints[0],targetEndpoint:t.endpoints[1]};_.fire("jsPlumbConnection",a,n),_.fire("connection",a,n)}},G=function(t,e,i){i.bind(t,(function(t,n){_.fire(e,i,n)}))},K=function(t){if(t.container)return t.container;var e=v.CurrentLibrary.getTagName(t.source),i=v.CurrentLibrary.getParent(t.source);return e&&"td"===e.toLowerCase()?v.CurrentLibrary.getParent(i):i},X=function(t){var e=_.Defaults.EndpointType||v.Endpoint,i=v.extend({},t);i.parent=K(i),i._jsPlumb=_,i.newConnection=Y,i.newEndpoint=X,i.endpointsByUUID=P,i.endpointsByElement=A,i.finaliseConnection=V,i.fireDetachEvent=it,i.floatingConnections=M,i.getParentFromParams=K,i.connectionsByScope=D;var n=new e(i);return n.id="ep_"+F(),G("click","endpointClick",n),G("dblclick","endpointDblClick",n),G("contextmenu","contextmenu",n),jsPlumbAdapter.headless||_.dragManager.endpointAdded(t.source),n},Q=function(t,e,i){var n=A[t];if(n&&n.length)for(var a=0,s=n.length;a<s;a++){for(var o=0,r=n[a].connections.length;o<r;o++){if(e(n[a].connections[o]))return}i&&i(n[a])}},J=function(t,e,i){e="block"===e;var n=null;i&&(n=e?function(t){t.setVisible(!0,!0,!0)}:function(t){t.setVisible(!1,!0,!0)});var a=o(t,"id");Q(a,(function(t){if(e&&i){var n=t.sourceId===a?1:0;t.endpoints[n].isVisible()&&t.setVisible(!0)}else t.setVisible(e)}),n)},Z=function(t){var e,i=t.timestamp,n=t.recalc,a=t.offset,s=t.elId;if(It&&!i&&(i=Dt),!n&&i&&i===E[s])return{o:O[s],s:j[s]};n||!a?null!=(e=c(s))&&(j[s]=u(e),O[s]=d(e,_),E[s]=i):(O[s]=a,null==j[s]&&null!=(e=c(s))&&(j[s]=u(e)));return O[s]&&!O[s].right&&(O[s].right=O[s].left+j[s][0],O[s].bottom=O[s].top+j[s][1],O[s].width=j[s][0],O[s].height=j[s][1],O[s].centerx=O[s].left+O[s].width/2,O[s].centery=O[s].top+O[s].height/2),{o:O[s],s:j[s]}},tt=function(t,e,i){var n=c(t),a=o(n,"id");return a&&"undefined"!=a||(2==arguments.length&&null!=arguments[1]?a=e:(1==arguments.length||3==arguments.length&&!arguments[2])&&(a="jsPlumb_"+x+"_"+F()),i||function(t,e,i){v.CurrentLibrary.setAttribute(c(t),e,i)}(n,"id",a)),a},et=function(t,e,i){return t=t||function(){},e=e||function(){},function(){var n=null;try{n=e.apply(this,arguments)}catch(t){h(_,"jsPlumb function failed : "+t)}if(null==i||n!==i)try{t.apply(this,arguments)}catch(t){h(_,"wrapped function failed : "+t)}return n}};this.isConnectionBeingDragged=function(){return null!=I},this.setConnectionBeingDragged=function(t){I=t},this.connectorClass="_jsPlumb_connector",this.hoverClass="_jsPlumb_hover",this.endpointClass="_jsPlumb_endpoint",this.endpointConnectedClass="_jsPlumb_endpoint_connected",this.endpointFullClass="_jsPlumb_endpoint_full",this.endpointDropAllowedClass="_jsPlumb_endpoint_drop_allowed",this.endpointDropForbiddenClass="_jsPlumb_endpoint_drop_forbidden",this.overlayClass="_jsPlumb_overlay",this.draggingClass="_jsPlumb_dragging",this.elementDraggingClass="_jsPlumb_element_dragging",this.sourceElementDraggingClass="_jsPlumb_source_element_dragging",this.targetElementDraggingClass="_jsPlumb_target_element_dragging",this.endpointAnchorClassPrefix="_jsPlumb_endpoint_anchor",this.Anchors={},this.Connectors={canvas:{},svg:{},vml:{}},this.Endpoints={canvas:{},svg:{},vml:{}},this.Overlays={canvas:{},svg:{},vml:{}},this.ConnectorRenderers={},this.addClass=function(t,e){return v.CurrentLibrary.addClass(t,e)},this.removeClass=function(t,e){return v.CurrentLibrary.removeClass(t,e)},this.hasClass=function(t,e){return v.CurrentLibrary.hasClass(t,e)},this.addEndpoint=function(t,e,s){s=s||{};var o=v.extend({},s);v.extend(o,e),o.endpoint=o.endpoint||_.Defaults.Endpoint||v.Defaults.Endpoint,o.paintStyle=o.paintStyle||_.Defaults.EndpointStyle||v.Defaults.EndpointStyle,t=H(t);for(var r=[],l=n(t)||null!=t.length&&!a(t)?t:[t],d=0,u=l.length;d<u;d++){var h=c(l[d]),p=tt(h);o.source=h,Z({elId:p,timestamp:Dt});var f=X(o);o.parentAnchor&&(f.parentAnchor=o.parentAnchor),i(A,p,f);var m=O[p],g=j[p],b={anchorLoc:f.anchor.compute({xy:[m.left,m.top],wh:g,element:f,timestamp:Dt}),timestamp:Dt};It&&(b.recalc=!1),It||f.paint(b),r.push(f)}return 1==r.length?r[0]:r},this.addEndpoints=function(t,e,i){for(var a=[],s=0,o=e.length;s<o;s++){var r=_.addEndpoint(t,e[s],i);n(r)?Array.prototype.push.apply(a,r):a.push(r)}return a},this.animate=function(t,e,i){var n=c(t),a=o(t,"id");i=i||{};var s=v.CurrentLibrary.dragEvents.step,r=v.CurrentLibrary.dragEvents.complete;i[s]=et(i[s],(function(){_.repaint(a)})),i[r]=et(i[r],(function(){_.repaint(a)})),v.CurrentLibrary.animate(n,e,i)},this.checkCondition=function(t,e){var i=_.getListener(t),n=!0;if(i&&i.length>0)try{for(var a=0,s=i.length;a<s;a++)n=n&&i[a](e)}catch(e){h(_,"cannot check condition ["+t+"]"+e)}return n},this.checkASyncCondition=function(t,e,i,n){var a=_.getListener(t);if(a&&a.length>0)try{a[0](e,i,n)}catch(e){h(_,"cannot asynchronously check condition ["+t+"]"+e)}},this.connect=function(t,e){var i,n=function(t,e){var i=v.extend({sourceIsNew:!0,targetIsNew:!0},t);if(e&&v.extend(i,e),i.source&&i.source.endpoint&&(i.sourceEndpoint=i.source),i.target&&i.target.endpoint&&(i.targetEndpoint=i.target),t.uuids&&(i.sourceEndpoint=U(t.uuids[0]),i.targetEndpoint=U(t.uuids[1])),i.sourceEndpoint&&i.sourceEndpoint.isFull())h(_,"could not add connection; source endpoint is full");else{if(!i.targetEndpoint||!i.targetEndpoint.isFull()){if(i.sourceEndpoint&&!i.sourceEndpoint.addedViaMouse&&(i.sourceIsNew=!1),i.targetEndpoint&&!i.targetEndpoint.addedViaMouse&&(i.targetIsNew=!1),!i.type&&i.sourceEndpoint&&(i.type=i.sourceEndpoint.connectionType),i.sourceEndpoint&&i.sourceEndpoint.connectorOverlays){i.overlays=i.overlays||[];for(var n=0,a=i.sourceEndpoint.connectorOverlays.length;n<a;n++)i.overlays.push(i.sourceEndpoint.connectorOverlays[n])}if(!i["pointer-events"]&&i.sourceEndpoint&&i.sourceEndpoint.connectorPointerEvents&&(i["pointer-events"]=i.sourceEndpoint.connectorPointerEvents),i.target&&!i.target.endpoint&&!i.targetEndpoint&&!i.newConnection){var s=tt(i.target),o=ft[s],r=mt[s];if(o){if(!$t[s])return;var l=null!=r?r:_.addEndpoint(i.target,o);gt[s]&&(mt[s]=l),i.targetEndpoint=l,l._makeTargetCreator=!0,i.targetIsNew=!0}}if(i.source&&!i.source.endpoint&&!i.sourceEndpoint&&!i.newConnection&&(s=tt(i.source),o=yt[s],r=_t[s],o)){if(!wt[s])return;l=null!=r?r:_.addEndpoint(i.source,o),xt[s]&&(_t[s]=l),i.sourceEndpoint=l,i.sourceIsNew=!0}return i}h(_,"could not add connection; target endpoint is full")}}(t,e);return n&&(null==n.deleteEndpointsOnDetach&&(n.deleteEndpointsOnDetach=!0),i=Y(n),V(i,n)),i},this.deleteEndpoint=function(t,e){_.doWhileSuspended((function(){var e="string"==typeof t?P[t]:t;if(e){var i=e.getUuid();for(var n in i&&(P[i]=null),e.detachAll().cleanup(),e.endpoint.cleanup&&e.endpoint.cleanup(),jsPlumbUtil.removeElements(e.endpoint.getDisplayElements()),_.anchorManager.deleteEndpoint(e),A){var a=A[n];if(a){for(var s=[],o=0,r=a.length;o<r;o++)a[o]!=e&&s.push(a[o]);A[n]=s}A[n].length<1&&delete A[n]}jsPlumbAdapter.headless||_.dragManager.endpointDeleted(e)}return _}),e)},this.deleteEveryEndpoint=function(){return _.doWhileSuspended((function(){for(var t in A){var e=A[t];if(e&&e.length)for(var i=0,n=e.length;i<n;i++)_.deleteEndpoint(e[i],!0)}A={},P={},_.anchorManager.reset(),_.dragManager.reset()})),_};var it=function(t,e,i){var n=_.Defaults.ConnectionType||_.getDefaultConnectionType(),a=t.constructor==n?{connection:t,source:t.source,target:t.target,sourceId:t.sourceId,targetId:t.targetId,sourceEndpoint:t.endpoints[0],targetEndpoint:t.endpoints[1]}:t;e&&(_.fire("jsPlumbConnectionDetached",a,i),_.fire("connectionDetached",a,i)),_.anchorManager.connectionDetached(a)};this.detach=function(){if(0!=arguments.length){var t=_.Defaults.ConnectionType||_.getDefaultConnectionType(),e=arguments[0].constructor==t,i=2==arguments.length&&e?arguments[1]||{}:arguments[0],n=!1!==i.fireEvent,a=i.forceDetach,s=e?arguments[0]:i.connection;if(s)(a||jsPlumbUtil.functionChain(!0,!1,[[s.endpoints[0],"isDetachAllowed",[s]],[s.endpoints[1],"isDetachAllowed",[s]],[s,"isDetachAllowed",[s]],[_,"checkCondition",["beforeDetach",s]]]))&&s.endpoints[0].detach(s,!1,!0,n);else{var o=v.extend({},i);if(o.uuids)U(o.uuids[0]).detachFrom(U(o.uuids[1]),n);else if(o.sourceEndpoint&&o.targetEndpoint)o.sourceEndpoint.detachFrom(o.targetEndpoint);else{var r=tt(o.source),l=tt(o.target);Q(r,(function(t){(t.sourceId==r&&t.targetId==l||t.targetId==r&&t.sourceId==l)&&_.checkCondition("beforeDetach",t)&&t.endpoints[0].detach(t,!1,!0,n)}))}}}},this.detachAllConnections=function(t,e){e=e||{},t=c(t);var i=o(t,"id"),n=A[i];if(n&&n.length)for(var a=0,s=n.length;a<s;a++)n[a].detachAll(e.fireEvent);return _},this.detachEveryConnection=function(t){for(var e in t=t||{},A){var i=A[e];if(i&&i.length)for(var n=0,a=i.length;n<a;n++)i[n].detachAll(t.fireEvent)}return D={},_},this.draggable=function(t,e){if("object"==typeof t&&t.length)for(var i=0,n=t.length;i<n;i++){(a=c(t[i]))&&q(a,!0,e)}else if(t._nodes)for(i=0,n=t._nodes.length;i<n;i++){var a;(a=c(t._nodes[i]))&&q(a,!0,e)}else(a=c(t))&&q(a,!0,e);return _},this.extend=function(t,e){return v.CurrentLibrary.extend(t,e)},this.getDefaultEndpointType=function(){return v.Endpoint},this.getDefaultConnectionType=function(){return v.Connection};var nt=function(t,e,i){return function(){return function(t,e,i,n){for(var a=0,s=t.length;a<s;a++)t[a][e].apply(t[a],i);return n(t)}(t,e,arguments,i)}},at=function(t,e){return function(){return function(t,e,i){for(var n=[],a=0,s=t.length;a<s;a++)n.push([t[a][e].apply(t[a],i),t[a]]);return n}(t,e,arguments)}},st=function(t,e){var i=[];if(t)if("string"==typeof t){if("*"===t)return t;i.push(t)}else if(e)i=t;else for(var n=0,a=t.length;n<a;n++)i.push(tt(c(t[n])));return i},ot=function(e,i,n){return"*"===e||(e.length>0?-1!=t(e,i):!n)};this.getConnections=function(t,e){t?t.constructor==String&&(t={scope:t}):t={};var i=t.scope||_.getDefaultScope(),n=st(i,!0),a=st(t.source),s=st(t.target),o=!e&&n.length>1?{}:[],r=function(t,i){if(!e&&n.length>1){var a=o[t];null==a&&(a=[],o[t]=a),a.push(i)}else o.push(i)};for(var l in D)if(ot(n,l))for(var c=0,d=D[l].length;c<d;c++){var u=D[l][c];ot(a,u.sourceId)&&ot(s,u.targetId)&&r(l,u)}return o};var rt=function(t,e){return function(i){for(var n=0,a=t.length;n<a;n++)i(t[n]);return e(t)}},lt=function(t){return function(e){return t[e]}},ct=function(t,e){for(var i={length:t.length,each:rt(t,e),get:lt(t)},n=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],a=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],s=0,o=n.length;s<o;s++)i[n[s]]=nt(t,n[s],e);for(s=0,o=a.length;s<o;s++)i[a[s]]=at(t,a[s]);return i},dt=function(t){var e=ct(t,dt);return v.CurrentLibrary.extend(e,{setDetachable:nt(t,"setDetachable",dt),setReattach:nt(t,"setReattach",dt),setConnector:nt(t,"setConnector",dt),detach:function(){for(var e=0,i=t.length;e<i;e++)_.detach(t[e])},isDetachable:at(t,"isDetachable"),isReattach:at(t,"isReattach")})},ut=function(t){var e=ct(t,ut);return v.CurrentLibrary.extend(e,{setEnabled:nt(t,"setEnabled",ut),setAnchor:nt(t,"setAnchor",ut),isEnabled:at(t,"isEnabled"),detachAll:function(){for(var e=0,i=t.length;e<i;e++)t[e].detachAll()},remove:function(){for(var e=0,i=t.length;e<i;e++)_.deleteEndpoint(t[e])}})};this.select=function(t){(t=t||{}).scope=t.scope||"*";var e=t.connections||_.getConnections(t,!0);return dt(e)},this.selectEndpoints=function(t){(t=t||{}).scope=t.scope||"*";var e=!t.element&&!t.source&&!t.target,i=e?"*":st(t.element),n=e?"*":st(t.source),a=e?"*":st(t.target),s=st(t.scope,!0),o=[];for(var r in A){var l=ot(i,r,!0),c=ot(n,r,!0),d="*"!=n,u=ot(a,r,!0),h="*"!=a;if(l||c||u)t:for(var p=0,f=A[r].length;p<f;p++){var m=A[r][p];if(ot(s,m.scope,!0)){var g=d&&n.length>0&&!m.isSource,v=h&&a.length>0&&!m.isTarget;if(g||v)continue t;o.push(m)}}}return ut(o)},this.getAllConnections=function(){return D},this.getDefaultScope=function(){return R},this.getEndpoint=U,this.getEndpoints=function(t){return A[tt(t)]},this.getId=tt,this.getOffset=function(t){O[t];return Z({elId:t})},this.getSelector=function(){return v.CurrentLibrary.getSelector.apply(null,arguments)},this.getSize=function(t){return j[t]||Z({elId:t}),j[t]},this.appendElement=function(t,e){_.Defaults.Container?v.CurrentLibrary.appendElement(t,_.Defaults.Container):e?v.CurrentLibrary.appendElement(t,e):jsPlumbAdapter.appendToRoot(t)};var ht=!1;this.isHoverSuspended=function(){return ht},this.setHoverSuspended=function(t){ht=t};var pt=function(t){return function(){return jsPlumbAdapter.isRenderModeAvailable(t)}};this.isCanvasAvailable=pt("canvas"),this.isSVGAvailable=pt("svg"),this.isVMLAvailable=pt("vml"),this.hide=function(t,e){return J(t,"none",e),_},this.idstamp=F,this.init=function(){T||(_.anchorManager=new v.AnchorManager({jsPlumbInstance:_}),_.setRenderMode(_.Defaults.RenderMode),T=!0,_.fire("ready",_))},this.log=S,this.jsPlumbUIComponent=f,this.makeAnchor=function(){var t=function(t,e){if(v.Anchors[t])return new v.Anchors[t](e);if(!_.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+t+"'"}};if(0==arguments.length)return null;var e=arguments[0],i=arguments[1],o=arguments[2],r=null;if(e.compute&&e.getOrientation)return e;if("string"==typeof e)r=t(arguments[0],{elementId:i,jsPlumbInstance:_});else if(n(e))if(n(e[0])||a(e[0]))if(2==e.length&&a(e[0])&&s(e[1])){var l=v.extend({elementId:i,jsPlumbInstance:_},e[1]);r=t(e[0],l)}else r=new v.DynamicAnchor({anchors:e,selector:null,elementId:i,jsPlumbInstance:o});else{var c={x:e[0],y:e[1],orientation:e.length>=4?[e[2],e[3]]:[0,0],offsets:e.length>=6?[e[4],e[5]]:[0,0],elementId:i,jsPlumbInstance:o,cssClass:7==e.length?e[6]:null};(r=new v.Anchor(c)).clone=function(){return new v.Anchor(c)}}return r.id||(r.id="anchor_"+F()),r},this.makeAnchors=function(t,e,i){for(var a=[],s=0,o=t.length;s<o;s++)"string"==typeof t[s]?a.push(v.Anchors[t[s]]({elementId:e,jsPlumbInstance:i})):n(t[s])&&a.push(_.makeAnchor(t[s],e,i));return a},this.makeDynamicAnchor=function(t,e){return new v.DynamicAnchor({anchors:t,selector:e,elementId:null,jsPlumbInstance:_})};var ft={},mt={},gt={},vt={},bt=function(t,e){t.paintStyle=t.paintStyle||_.Defaults.EndpointStyles[e]||_.Defaults.EndpointStyle||v.Defaults.EndpointStyles[e]||v.Defaults.EndpointStyle,t.hoverPaintStyle=t.hoverPaintStyle||_.Defaults.EndpointHoverStyles[e]||_.Defaults.EndpointHoverStyle||v.Defaults.EndpointHoverStyles[e]||v.Defaults.EndpointHoverStyle,t.anchor=t.anchor||_.Defaults.Anchors[e]||_.Defaults.Anchor||v.Defaults.Anchors[e]||v.Defaults.Anchor,t.endpoint=t.endpoint||_.Defaults.Endpoints[e]||_.Defaults.Endpoint||v.Defaults.Endpoints[e]||v.Defaults.Endpoint};this.makeTarget=function(t,e,i){var n=v.extend({_jsPlumb:_},i);v.extend(n,e),bt(n,1);var a=v.CurrentLibrary,s=n.scope||_.Defaults.Scope,r=!(!1===n.deleteEndpointsOnDetach),l=n.maxConnections||-1,h=n.onMaxConnections;_doOne=function(t){var e=tt(t);ft[e]=n,gt[e]=n.uniqueEndpoint,vt[e]=l,$t[e]=!0,proxyComponent=new f(n);var i=v.extend({},n.dropOptions||{}),p=a.dragEvents.drop;i.scope=i.scope||s,i[p]=et(i[p],(function(){var i=v.CurrentLibrary.getDropEvent(arguments),s=_.select({target:e}).length;_.currentlyDragging=!1;var l=c(a.getDragObject(arguments)),p=o(l,"dragId"),f=o(l,"originalScope"),m=M[p],g=m.endpoints[0];n.endpoint&&v.extend({},n.endpoint);if(!$t[e]||vt[e]>0&&s>=vt[e])return h&&h({element:t,connection:m},i),!1;g.anchor.locked=!1,f&&a.setDragScope(l,f);var b=proxyComponent.isDropAllowed(m.sourceId,tt(t),m.scope,m,null);if(m.endpointsToDeleteOnDetach&&(g===m.endpointsToDeleteOnDetach[0]?m.endpointsToDeleteOnDetach[0]=null:g===m.endpointsToDeleteOnDetach[1]&&(m.endpointsToDeleteOnDetach[1]=null)),m.suspendedEndpoint&&(m.targetId=m.suspendedEndpoint.elementId,m.target=a.getElementObject(m.suspendedEndpoint.elementId),m.endpoints[1]=m.suspendedEndpoint),b){g.detach(m,!1,!0,!1);var y=mt[e]||_.addEndpoint(t,n);if(n.uniqueEndpoint&&(mt[e]=y),y._makeTargetCreator=!0,null!=y.anchor.positionFinder){var x=a.getUIPosition(arguments,_.getZoom()),w=d(t,_),C=u(t),k=y.anchor.positionFinder(x,w,C,y.anchor.constructorParams);y.anchor.x=k[0],y.anchor.y=k[1]}var $=_.connect({source:g,target:y,scope:f,previousConnection:m,container:m.parent,deleteEndpointsOnDetach:r,endpointsToDeleteOnDetach:r?[g,y]:null,doNotFireConnectionEvent:g.endpointWillMoveAfterConnection});m.endpoints[1]._makeTargetCreator&&m.endpoints[1].connections.length<2&&_.deleteEndpoint(m.endpoints[1]),$.repaint()}else m.suspendedEndpoint&&(m.isReattach()?(m.setHover(!1),m.floatingAnchorIndex=null,m.suspendedEndpoint.addConnection(m),_.repaint(g.elementId)):g.detach(m,!1,!0,!0,i))})),a.initDroppable(t,i,!0)};for(var p=(t=H(t)).length&&t.constructor!=String?t:[t],m=0,g=p.length;m<g;m++)_doOne(c(p[m]));return _},this.unmakeTarget=function(t,e){t=v.CurrentLibrary.getElementObject(t);var i=tt(t);return e||(delete ft[i],delete gt[i],delete vt[i],delete $t[i]),_},this.makeTargets=function(t,e,i){for(var n=0,a=t.length;n<a;n++)_.makeTarget(t[n],e,i)};var yt={},_t={},xt={},wt={},Ct={},kt={},$t={};this.makeSource=function(t,i,n){var a=v.extend({},n);v.extend(a,i),bt(a,0);for(var s=v.CurrentLibrary,o=a.maxConnections||-1,r=a.onMaxConnections,l=function(t){var i=tt(t),n=function(){return null==a.parent?a.parent:"parent"===a.parent?s.getElementObject(s.getDOMElement(t).parentNode):s.getElementObject(a.parent)},l=null!=a.parent?_.getId(n()):i;yt[l]=a,xt[l]=a.uniqueEndpoint,wt[l]=!0;var c=s.dragEvents.stop,d=s.dragEvents.drag,u=v.extend({},a.dragOptions||{}),h=u.drag,p=u.stop,f=null,m=!1;kt[l]=o,u.scope=u.scope||a.scope,u[d]=et(u[d],(function(){h&&h.apply(this,arguments),m=!1})),u[c]=et(u[c],(function(){if(p&&p.apply(this,arguments),_.currentlyDragging=!1,0==f.connections.length)_.deleteEndpoint(f);else{s.unbind(f.canvas,"mousedown");var t=a.anchor||_.Defaults.Anchor,o=(f.anchor,f.connections[0]);if(f.setAnchor(_.makeAnchor(t,i,_)),a.parent){var r=n();if(r){var l=f.elementId,c=a.container||_.Defaults.Container||v.Defaults.Container;f.setElement(r,c),f.endpointWillMoveAfterConnection=!1,_.anchorManager.rehomeEndpoint(l,r),o.previousConnection=null,e(D[o.scope],(function(t){return t.id===o.id})),_.anchorManager.connectionDetached({sourceId:o.sourceId,targetId:o.targetId,connection:o}),V(o)}}f.repaint(),_.repaint(f.elementId),_.repaint(o.targetId)}}));var g=function(e){if(wt[l]){if(a.filter){var c=s.getOriginalEvent(e),d=jsPlumbUtil.isString(a.filter)?function(t,e,i){for(var n=t.target||t.srcElement,a=!1,s=_.getSelector(e,i),o=0;o<s.length;o++)if(s[o]==n){a=!0;break}return a}(c,t,a.filter):a.filter(c,t);if(!1===d)return}var h=_.select({source:l}).length;if(kt[l]>=0&&h>=kt[l])return r&&r({element:t,maxConnections:o},e),!1;var p=Z({elId:i}).o,g=_.getZoom(),b=((e.pageX||e.page.x)/g-p.left)/p.width,y=((e.pageY||e.page.y)/g-p.top)/p.height,x=b,w=y;if(a.parent){var C=n(),k=tt(C);p=Z({elId:k}).o,x=((e.pageX||e.page.x)-p.left)/p.width,w=((e.pageY||e.page.y)-p.top)/p.height}var $={};if(v.extend($,a),$.isSource=!0,$.anchor=[b,y,0,0],$.parentAnchor=[x,w,0,0],$.dragOptions=u,a.parent){var S=$.container||_.Defaults.Container||v.Defaults.Container;$.container=S||v.CurrentLibrary.getParent(n())}f=_.addEndpoint(i,$),m=!0,f.endpointWillMoveAfterConnection=null!=a.parent,f.endpointWillMoveTo=a.parent?n():null,f.addedViaMouse=!0;var T=function(){m&&_.deleteEndpoint(f)};_.registerListener(f.canvas,"mouseup",T),_.registerListener(t,"mouseup",T),s.trigger(f.canvas,"mousedown",e)}};_.registerListener(t,"mousedown",g),Ct[i]=g,a.filter&&jsPlumbUtil.isString(a.filter)&&s.setDragFilter(t,a.filter)},d=(t=H(t)).length&&t.constructor!=String?t:[t],u=0,h=d.length;u<h;u++)l(c(d[u]));return _},this.unmakeSource=function(t,e){t=v.CurrentLibrary.getElementObject(t);var i=tt(t),n=Ct[i];return n&&_.unregisterListener(t,"mousedown",n),e||(delete yt[i],delete xt[i],delete wt[i],delete Ct[i],delete kt[i]),_},this.unmakeEverySource=function(){for(var t in wt)_.unmakeSource(t,!0);yt={},xt={},wt={},Ct={}},this.unmakeEveryTarget=function(){for(var t in $t)_.unmakeTarget(t,!0);return ft={},gt={},vt={},$t={},_},this.makeSources=function(t,e,i){for(var n=0,a=t.length;n<a;n++)_.makeSource(t[n],e,i);return _};var St=function(t,e,i,n){var s="source"==t?wt:$t;if(a(e))s[e]=n?!s[e]:i;else if(e.length)for(var o=0,r=(e=H(e)).length;o<r;o++){var l=_el=v.CurrentLibrary.getElementObject(e[o]);s[l=tt(_el)]=n?!s[l]:i}return _};this.setSourceEnabled=function(t,e){return St("source",t,e)},this.toggleSourceEnabled=function(t){return St("source",t,null,!0),_.isSourceEnabled(t)},this.isSource=function(t){return t=v.CurrentLibrary.getElementObject(t),null!=wt[tt(t)]},this.isSourceEnabled=function(t){return t=v.CurrentLibrary.getElementObject(t),!0===wt[tt(t)]},this.setTargetEnabled=function(t,e){return St("target",t,e)},this.toggleTargetEnabled=function(t){return St("target",t,null,!0),_.isTargetEnabled(t)},this.isTarget=function(t){return t=v.CurrentLibrary.getElementObject(t),null!=$t[tt(t)]},this.isTargetEnabled=function(t){return t=v.CurrentLibrary.getElementObject(t),!0===$t[tt(t)]},this.ready=function(t){_.bind("ready",t)},this.repaint=function(t,e,i){if("object"==typeof t&&t.length)for(var n=0,a=t.length;n<a;n++)z(c(t[n]),e,i);else z(c(t),e,i);return _},this.repaintEverything=function(){for(var t in A)z(c(t),null,null);return _},this.removeAllEndpoints=function(t,e){var i=function(t){var n=jsPlumbUtil.isString(t)?t:tt(c(t)),a=A[n];if(a)for(var s=0,o=a.length;s<o;s++)_.deleteEndpoint(a[s]);if(delete A[n],e){var r=v.CurrentLibrary.getDOMElement(c(t));if(r&&3!=r.nodeType&&8!=r.nodeType)for(s=0,o=r.childNodes.length;s<o;s++)i(r.childNodes[s])}};return i(t),_},this.remove=function(t){var e=c(t),i=jsPlumbUtil.isString(t)?t:tt(e);_.doWhileSuspended((function(){_.removeAllEndpoints(i,!0),_.dragManager.elementRemoved(i)})),v.CurrentLibrary.removeElement(e)};var Tt={};this.registerListener=function(t,e,n){v.CurrentLibrary.bind(t,e,n),i(Tt,e,{el:t,event:e,listener:n})},this.unregisterListener=function(t,i,n){v.CurrentLibrary.unbind(t,i,n),e(Tt,(function(t){return t.type==i&&t.listener==n}))},this.reset=function(){_.deleteEveryEndpoint(),_.unbind(),ft={},mt={},gt={},vt={},yt={},_t={},xt={},kt={},function(){for(var t in Tt)for(var e=0,i=Tt[t].length;e<i;e++){var n=Tt[t][e];v.CurrentLibrary.unbind(n.el,n.event,n.listener)}Tt={}}(),_.anchorManager.reset(),jsPlumbAdapter.headless||_.dragManager.reset()},this.setDefaultScope=function(t){return R=t,_},this.setDraggable=function(t,e){return W(t,(function(t,i){L[i]=e,v.CurrentLibrary.isDragSupported(t)&&v.CurrentLibrary.setDraggable(t,e)}))},this.setId=function(t,e,i){var n=t.constructor==String?t:_.getId(t),a=_.getConnections({source:n,scope:"*"},!0),s=_.getConnections({target:n,scope:"*"},!0);e=""+e,i||(t=v.CurrentLibrary.getElementObject(n),v.CurrentLibrary.setAttribute(t,"id",e)),t=v.CurrentLibrary.getElementObject(e),A[e]=A[n]||[];for(var o=0,r=A[e].length;o<r;o++)A[e][o].setElementId(e),A[e][o].setReferenceElement(t);delete A[n],_.anchorManager.changeId(n,e),jsPlumbAdapter.headless||_.dragManager.changeId(n,e);var l=function(i,n,a){for(var s=0,o=i.length;s<o;s++)i[s].endpoints[n].setElementId(e),i[s].endpoints[n].setReferenceElement(t),i[s][a+"Id"]=e,i[s][a]=t};l(a,0,"source"),l(s,1,"target"),_.repaint(e)},this.setIdChanged=function(t,e){_.setId(t,e,!0)},this.setDebugLog=function(t){S=t};var It=!1,Dt=null;this.setSuspendDrawing=function(t,e){It=t,Dt=t?(new Date).getTime():null,e&&_.repaintEverything()},this.isSuspendDrawing=function(){return It},this.getSuspendedAt=function(){return Dt},this.doWhileSuspended=function(t,e){_.setSuspendDrawing(!0);try{t()}catch(t){h("Function run while suspended failed",t)}_.setSuspendDrawing(!1,!e)},this.updateOffset=Z,this.getOffset=function(t){return O[t]},this.getSize=function(t){return j[t]},this.getCachedData=function(t){var e=O[t];return e?{o:e,s:j[t]}:Z({elId:t})},this.timestamp=p,this.SVG="svg",this.CANVAS="canvas",this.VML="vml",this.setRenderMode=function(t){return N=jsPlumbAdapter.setRenderMode(t)},this.getRenderMode=function(){return N},this.show=function(t,e){return J(t,"block",e),_},this.sizeCanvas=function(t,e,i,n,a){return t&&(t.style.height=a+"px",t.height=a,t.style.width=n+"px",t.width=n,t.style.left=e+"px",t.style.top=i+"px"),_},this.getTestHarness=function(){return{endpointsByElement:A,endpointCount:function(t){var e=A[t];return e?e.length:0},connectionCount:function(t){var e=D[t=t||R];return e?e.length:0},getId:tt,makeAnchor:self.makeAnchor,makeDynamicAnchor:self.makeDynamicAnchor}},this.toggleVisible=function(t,e){var i=null;e&&(i=function(t){var e=t.isVisible();t.setVisible(!e)}),Q(t,(function(t){var e=t.isVisible();t.setVisible(!e)}),i)},this.toggleDraggable=function(t){return W(t,(function(t,e){var i=null!=L[e]&&L[e];return i=!i,L[e]=i,v.CurrentLibrary.setDraggable(t,i),i}))},this.wrap=et,this.addListener=this.bind,this.adjustForParentOffsetAndScroll=function(t,e){var i=null,n=t;if("svg"===e.tagName.toLowerCase()&&e.parentNode?i=e.parentNode:e.offsetParent&&(i=e.offsetParent),null!=i){var a="body"===i.tagName.toLowerCase()?{left:0,top:0}:d(i,_),s="body"===i.tagName.toLowerCase()?{left:0,top:0}:{left:i.scrollLeft,top:i.scrollTop};n[0]=t[0]-a.left+s.left,n[1]=t[1]-a.top+s.top}return n},jsPlumbAdapter.headless||(_.dragManager=jsPlumbAdapter.getDragManager(_),_.recalculateOffsets=_.dragManager.updateOffsets)},v=new g;"undefined"!=typeof window&&(window.jsPlumb=v),v.getInstance=function(t){var e=new g(t);return e.init(),e},"function"==typeof define&&(define("jsplumb",[],(function(){return v})),define("jsplumbinstance",[],(function(){return v.getInstance()}))),"undefined"!=typeof exports&&(exports.jsPlumb=v)}(),function(){jsPlumb.AnchorManager=function(t){var e={},i={},n={},a={},s={},o="horizontal",r="vertical",l="diagonal",c="identity",d={},u=this,h={},p=t.jsPlumbInstance,f=jsPlumb.CurrentLibrary,m={},g=function(t,e,i,n,a,s){if(t===e)return{orientation:c,a:["top","top"]};var d,u=Math.atan2(n.centery-i.centery,n.centerx-i.centerx),h=Math.atan2(i.centery-n.centery,i.centerx-n.centerx),p=i.left<=n.left&&i.right>=n.left||i.left<=n.right&&i.right>=n.right||i.left<=n.left&&i.right>=n.right||n.left<=i.left&&n.right>=i.right,f=i.top<=n.top&&i.bottom>=n.top||i.top<=n.bottom&&i.bottom>=n.bottom||i.top<=n.top&&i.bottom>=n.bottom||n.top<=i.top&&n.bottom>=i.bottom,m={orientation:l,theta:u,theta2:h};return p||f?p?(m.orientation=o,m.a=i.top<n.top?["bottom","top"]:["top","bottom"]):(m.orientation=r,m.a=i.left<n.left?["right","left"]:["left","right"]):n.left>i.left&&n.top>i.top?m.a=["right","top"]:n.left>i.left&&i.top>n.top?m.a=["top","left"]:n.left<i.left&&n.top<i.top?m.a=["top","right"]:n.left<i.left&&n.top>i.top&&(m.a=["left","top"]),m.a=(d=m.a,[a.isContinuous?a.verifyEdge(d[0]):d[0],s.isContinuous?s.verifyEdge(d[1]):d[1]]),m},v=function(t){return function(e,i){return!1===(t?e[0][0]<i[0][0]:e[0][0]>i[0][0])?-1:1}},b={top:function(t,e){return t[0]>e[0]?1:-1},right:v(!0),bottom:v(!0),left:function(t,e){return(t[0][0]<0?-Math.PI-t[0][0]:Math.PI-t[0][0])>(e[0][0]<0?-Math.PI-e[0][0]:Math.PI-e[0][0])||t[0][1]>e[0][1]?1:-1}},y=function(t,e){var i=p.getCachedData(t),a=i.s,o=i.o,r=function(e,i,a,o,r,l,c){if(o.length>0)for(var d=function(t,e){return t.sort(e)}(o,b[e]),u=function(t,e,i,n,a,s,o){for(var r=[],l=e[a?0:1]/(n.length+1),c=0;c<n.length;c++){var d=(c+1)*l,u=s*e[a?1:0];o&&(d=e[a?0:1]-d);var h=a?d:u,p=i[0]+h,f=h/e[0],m=a?u:d,g=i[1]+m,v=m/e[1];r.push([p,g,f,v,n[c][1],n[c][2]])}return r}(0,i,a,d,r,l,"right"===e||"top"===e),h=function(t,e){var i=p.adjustForParentOffsetAndScroll([e[0],e[1]],t.canvas);n[t.id]=[i[0],i[1],e[2],e[3]],s[t.id]=c},f=0;f<u.length;f++){var m=u[f][4],g=m.endpoints[0].elementId===t,v=m.endpoints[1].elementId===t;g?h(m.endpoints[0],u[f]):v&&h(m.endpoints[1],u[f])}};r("bottom",a,[o.left,o.top],e.bottom,!0,1,[0,1]),r("top",a,[o.left,o.top],e.top,!0,0,[0,-1]),r("left",a,[o.left,o.top],e.left,!1,0,[-1,0]),r("right",a,[o.left,o.top],e.right,!1,1,[1,0])};this.reset=function(){e={},d={},h={}},this.addFloatingConnection=function(t,e){m[t]=e},this.removeFloatingConnection=function(t){delete m[t]},this.newConnection=function(t){var e=t.sourceId,i=t.targetId,n=t.endpoints,a=!0,s=function(t,s,o,r,l){e==i&&o.isContinuous&&(f.removeElement(n[1].canvas),a=!1),jsPlumbUtil.addToList(d,r,[l,s,o.constructor==jsPlumb.DynamicAnchor])};s(0,n[0],n[0].anchor,i,t),a&&s(0,n[1],n[1].anchor,e,t)};var _=function(t){!function(t,e){if(t){var i=function(t){return t[4]==e};jsPlumbUtil.removeWithFunction(t.top,i),jsPlumbUtil.removeWithFunction(t.left,i),jsPlumbUtil.removeWithFunction(t.bottom,i),jsPlumbUtil.removeWithFunction(t.right,i)}}(h[t.elementId],t.id)};this.connectionDetached=function(t){var e=t.connection||t,i=t.sourceId,n=t.targetId,a=e.endpoints,s=function(t,e,i,n,a){i.constructor==jsPlumb.FloatingAnchor||jsPlumbUtil.removeWithFunction(d[n],(function(t){return t[0].id==a.id}))};s(0,a[1],a[1].anchor,i,e),s(0,a[0],a[0].anchor,n,e),_(e.endpoints[0]),_(e.endpoints[1]),u.redraw(e.sourceId),u.redraw(e.targetId)},this.add=function(t,i){jsPlumbUtil.addToList(e,i,t)},this.changeId=function(t,i){d[i]=d[t],e[i]=e[t],delete d[t],delete e[t]},this.getConnectionsFor=function(t){return d[t]||[]},this.getEndpointsFor=function(t){return e[t]||[]},this.deleteEndpoint=function(t){jsPlumbUtil.removeWithFunction(e[t.elementId],(function(e){return e.id==t.id})),_(t)},this.clearFor=function(t){delete e[t],e[t]=[]};var x=function(e,i,n,a,s,o,r,l,c,d,u,h){var p=-1,f=a.endpoints[r],m=f.id,g=[1,0][r],v=[[i,n],a,s,o,m],b=e[c],y=f._continuousAnchorEdge?e[f._continuousAnchorEdge]:null;if(y){var _=jsPlumbUtil.findWithFunction(y,(function(t){return t[4]==m}));if(-1!=_){y.splice(_,1);for(var x=0;x<y.length;x++)jsPlumbUtil.addWithFunction(u,y[x][1],(function(t){return t.id==y[x][1].id})),jsPlumbUtil.addWithFunction(h,y[x][1].endpoints[r],(function(t){return t.id==y[x][1].endpoints[r].id})),jsPlumbUtil.addWithFunction(h,y[x][1].endpoints[g],(function(t){return t.id==y[x][1].endpoints[g].id}))}}for(x=0;x<b.length;x++)1==t.idx&&b[x][3]===o&&-1==p&&(p=x),jsPlumbUtil.addWithFunction(u,b[x][1],(function(t){return t.id==b[x][1].id})),jsPlumbUtil.addWithFunction(h,b[x][1].endpoints[r],(function(t){return t.id==b[x][1].endpoints[r].id})),jsPlumbUtil.addWithFunction(h,b[x][1].endpoints[g],(function(t){return t.id==b[x][1].endpoints[g].id}));var w=l?-1!=p?p:0:b.length;b.splice(w,0,v),f._continuousAnchorEdge=c};this.redraw=function(t,i,n,a,s){if(!p.isSuspendDrawing()){var o=e[t]||[],r=d[t]||[],l=[],c=[],u=[];n=n||p.timestamp(),a=a||{left:0,top:0},i&&(i={left:i.left+a.left,top:i.top+a.top});for(var f=p.updateOffset({elId:t,offset:i,recalc:!1,timestamp:n}),v={},b=0;b<r.length;b++){var _=r[b][0],w=_.sourceId,C=_.targetId,k=_.endpoints[0].anchor.isContinuous,$=_.endpoints[1].anchor.isContinuous;if(k||$){var S=w+"_"+C,T=v[S],I=_.sourceId==t?1:0;k&&!h[w]&&(h[w]={top:[],right:[],bottom:[],left:[]}),$&&!h[C]&&(h[C]={top:[],right:[],bottom:[],left:[]}),t!=C&&p.updateOffset({elId:C,timestamp:n}),t!=w&&p.updateOffset({elId:w,timestamp:n});var D=p.getCachedData(C),A=p.getCachedData(w);C==w&&(k||$)?x(h[w],-Math.PI/2,0,_,!1,C,0,!1,"top",0,l,c):(T||(T=g(w,C,A.o,D.o,_.endpoints[0].anchor,_.endpoints[1].anchor),v[S]=T),k&&x(h[w],T.theta,0,_,!1,C,0,!1,T.a[0],0,l,c),$&&x(h[C],T.theta2,-1,_,!0,w,1,!0,T.a[1],0,l,c)),k&&jsPlumbUtil.addWithFunction(u,w,(function(t){return t===w})),$&&jsPlumbUtil.addWithFunction(u,C,(function(t){return t===C})),jsPlumbUtil.addWithFunction(l,_,(function(t){return t.id==_.id})),(k&&0==I||$&&1==I)&&jsPlumbUtil.addWithFunction(c,_.endpoints[I],(function(t){return t.id==_.endpoints[I].id}))}}for(b=0;b<o.length;b++)0==o[b].connections.length&&o[b].anchor.isContinuous&&(h[t]||(h[t]={top:[],right:[],bottom:[],left:[]}),x(h[t],-Math.PI/2,0,{endpoints:[o[b],o[b]],paint:function(){}},!1,t,0,!1,"top",0,l,c),jsPlumbUtil.addWithFunction(u,t,(function(e){return e===t})));for(b=0;b<u.length;b++)y(u[b],h[u[b]]);for(b=0;b<o.length;b++)o[b].paint({timestamp:n,offset:f,dimensions:f.s});for(b=0;b<c.length;b++){var P=p.getCachedData(c[b].elementId);c[b].paint({timestamp:n,offset:P,dimensions:P.s})}for(b=0;b<r.length;b++){var O=r[b][1];if(O.anchor.constructor==jsPlumb.DynamicAnchor){O.paint({elementWithPrecedence:t}),jsPlumbUtil.addWithFunction(l,r[b][0],(function(t){return t.id==r[b][0].id}));for(var E=0;E<O.connections.length;E++)O.connections[E]!==r[b][0]&&jsPlumbUtil.addWithFunction(l,O.connections[E],(function(t){return t.id==O.connections[E].id}))}else O.anchor.constructor==jsPlumb.Anchor&&jsPlumbUtil.addWithFunction(l,r[b][0],(function(t){return t.id==r[b][0].id}))}var M=m[t];M&&M.paint({timestamp:n,recalc:!1,elId:t});for(b=0;b<l.length;b++)l[b].paint({elId:t,timestamp:n,recalc:!1,clearEdits:s})}},this.rehomeEndpoint=function(t,i){var n=e[t]||[],a=p.getId(i);if(a!==t){for(var s=0;s<n.length;s++)u.add(n[s],a);n.splice(0,n.length)}};var w=function(t){jsPlumbUtil.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;for(var e=t.faces||["top","right","bottom","left"],i=!(!1===t.clockwise),o={},r={top:"bottom",right:"left",left:"right",bottom:"top"},l={top:"right",right:"bottom",left:"top",bottom:"left"},c={top:"left",right:"top",left:"bottom",bottom:"right"},d=i?l:c,u=i?c:l,h=t.cssClass||"",p=0;p<e.length;p++)o[e[p]]=!0;this.verifyEdge=function(t){return o[t]?t:o[r[t]]?r[t]:o[d[t]]?d[t]:o[u[t]]?u[t]:t},this.compute=function(t){return a[t.element.id]||n[t.element.id]||[0,0]},this.getCurrentLocation=function(t){return a[t.id]||n[t.id]||[0,0]},this.getOrientation=function(t){return s[t.id]||[0,0]},this.clearUserDefinedLocation=function(){delete a[t.elementId]},this.setUserDefinedLocation=function(e){a[t.elementId]=e},this.getCssClass=function(){return h},this.setCssClass=function(t){h=t}};p.continuousAnchorFactory={get:function(t){var e=i[t.elementId];return e||(e=new w(t),i[t.elementId]=e),e}}},jsPlumb.Anchor=function(t){var e=this;this.x=t.x||0,this.y=t.y||0,this.elementId=t.elementId,jsPlumbUtil.EventGenerator.apply(this);var i=t.orientation||[0,0],n=t.jsPlumbInstance,a=null,s=null,o=t.cssClass||"";this.getCssClass=function(){return o},this.offsets=t.offsets||[0,0],e.timestamp=null,this.compute=function(t){var i=t.xy,o=t.wh,r=t.element,l=t.timestamp;return t.clearUserDefinedLocation&&(s=null),l&&l===e.timestamp||(null!=s?a=s:(a=[i[0]+e.x*o[0]+e.offsets[0],i[1]+e.y*o[1]+e.offsets[1]],a=n.adjustForParentOffsetAndScroll(a,r.canvas)),e.timestamp=l),a},this.getOrientation=function(t){return i},this.equals=function(t){if(!t)return!1;var e=t.getOrientation(),i=this.getOrientation();return this.x==t.x&&this.y==t.y&&this.offsets[0]==t.offsets[0]&&this.offsets[1]==t.offsets[1]&&i[0]==e[0]&&i[1]==e[1]},this.getCurrentLocation=function(){return a},this.getUserDefinedLocation=function(){return s},this.setUserDefinedLocation=function(t){s=t},this.clearUserDefinedLocation=function(){s=null}},jsPlumb.FloatingAnchor=function(t){jsPlumb.Anchor.apply(this,arguments);var e=t.reference,i=jsPlumb.CurrentLibrary,n=t.jsPlumbInstance,a=t.referenceCanvas,s=i.getSize(i.getElementObject(a)),o=null,r=null;this.x=0,this.y=0,this.isFloating=!0,this.compute=function(t){var e=t.xy,i=t.element,a=[e[0]+s[0]/2,e[1]+s[1]/2];return a=n.adjustForParentOffsetAndScroll(a,i.canvas),r=a,a},this.getOrientation=function(t){if(o)return o;var i=e.getOrientation(t);return[0*Math.abs(i[0])*-1,0*Math.abs(i[1])*-1]},this.over=function(t){o=t.getOrientation()},this.out=function(){o=null},this.getCurrentLocation=function(){return r}},jsPlumb.DynamicAnchor=function(t){jsPlumb.Anchor.apply(this,arguments),this.isSelective=!0,this.isDynamic=!0;for(var e=[],i=function(e){return e.constructor==jsPlumb.Anchor?e:t.jsPlumbInstance.makeAnchor(e,t.elementId,t.jsPlumbInstance)},n=0;n<t.anchors.length;n++)e[n]=i(t.anchors[n]);this.addAnchor=function(t){e.push(i(t))},this.getAnchors=function(){return e},this.locked=!1;var a=e.length>0?e[0]:null,s=(e.length,a),o=this,r=function(t,e,i,n,a){var s=n[0]+t.x*a[0],o=n[1]+t.y*a[1],r=n[0]+a[0]/2,l=n[1]+a[1]/2;return Math.sqrt(Math.pow(e-s,2)+Math.pow(i-o,2))+Math.sqrt(Math.pow(r-s,2)+Math.pow(l-o,2))},l=t.selector||function(t,e,i,n,a){for(var s=i[0]+n[0]/2,o=i[1]+n[1]/2,l=-1,c=1/0,d=0;d<a.length;d++){var u=r(a[d],s,o,t,e);u<c&&(l=d+0,c=u)}return a[l]};this.compute=function(t){var i=t.xy,n=t.wh,r=(t.timestamp,t.txy),c=t.twh;t.clearUserDefinedLocation&&(userDefinedLocation=null);var d=o.getUserDefinedLocation();return null!=d?d:(o.locked||null==r||null==c||(t.timestamp=null,a=l(i,n,r,c,e),o.x=a.x,o.y=a.y,a!=s&&o.fire("anchorChanged",a),s=a),a.compute(t))},this.getCurrentLocation=function(){return o.getUserDefinedLocation()||(null!=a?a.getCurrentLocation():null)},this.getOrientation=function(t){return null!=a?a.getOrientation(t):[0,0]},this.over=function(t){null!=a&&a.over(t)},this.out=function(){null!=a&&a.out()},this.getCssClass=function(){return a&&a.getCssClass()||""}};var t=function(t,e,i,n,a,s){jsPlumb.Anchors[a]=function(o){var r=o.jsPlumbInstance.makeAnchor([t,e,i,n,0,0],o.elementId,o.jsPlumbInstance);return r.type=a,s&&s(r,o),r}};t(.5,0,0,-1,"TopCenter"),t(.5,1,0,1,"BottomCenter"),t(0,.5,-1,0,"LeftMiddle"),t(1,.5,1,0,"RightMiddle"),t(.5,0,0,-1,"Top"),t(.5,1,0,1,"Bottom"),t(0,.5,-1,0,"Left"),t(1,.5,1,0,"Right"),t(.5,.5,0,0,"Center"),t(1,0,0,-1,"TopRight"),t(1,1,0,1,"BottomRight"),t(0,0,0,-1,"TopLeft"),t(0,1,0,1,"BottomLeft"),jsPlumb.Defaults.DynamicAnchors=function(t){return t.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],t.elementId,t.jsPlumbInstance)},jsPlumb.Anchors.AutoDefault=function(t){var e=t.jsPlumbInstance.makeDynamicAnchor(jsPlumb.Defaults.DynamicAnchors(t));return e.type="AutoDefault",e};var e=function(t,e){jsPlumb.Anchors[t]=function(i){var n=i.jsPlumbInstance.makeAnchor(["Continuous",{faces:e}],i.elementId,i.jsPlumbInstance);return n.type=t,n}};jsPlumb.Anchors.Continuous=function(t){return t.jsPlumbInstance.continuousAnchorFactory.get(t)},e("ContinuousLeft",["left"]),e("ContinuousTop",["top"]),e("ContinuousBottom",["bottom"]),e("ContinuousRight",["right"]),jsPlumb.Anchors.Assign=t(0,0,0,0,"Assign",(function(t,e){var i=e.position||"Fixed";t.positionFinder=i.constructor==String?e.jsPlumbInstance.AnchorPositionFinders[i]:i,t.constructorParams=e})),jsPlumb.AnchorPositionFinders={Fixed:function(t,e,i,n){return[(t.left-e.left)/i[0],(t.top-e.top)/i[1]]},Grid:function(t,e,i,n){var a=t.left-e.left,s=t.top-e.top,o=i[0]/n.grid[0],r=i[1]/n.grid[1],l=Math.floor(a/o),c=Math.floor(s/r);return[(l*o+o/2)/i[0],(c*r+r/2)/i[1]]}},jsPlumb.Anchors.Perimeter=function(t){var e=(t=t||{}).anchorCount||60,i=t.shape;if(!i)throw new Error("no shape supplied to Perimeter Anchor type");var n=function(){for(var t=.5,i=2*Math.PI/e,n=0,a=[],s=0;s<e;s++){var o=t+t*Math.sin(n),r=t+t*Math.cos(n);a.push([o,r,0,0]),n+=i}return a},a=function(t){for(var i=e/t.length,n=[],a=function(t,a,s,o,r){for(var l=(s-t)/(i=e*r),c=(o-a)/i,d=0;d<i;d++)n.push([t+l*d,a+c*d,0,0])},s=0;s<t.length;s++)a.apply(null,t[s]);return n},s=function(t){for(var e=[],i=0;i<t.length;i++)e.push([t[i][0],t[i][1],t[i][2],t[i][3],1/t.length]);return a(e)},o=function(){return s([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])},r={Circle:n,Ellipse:n,Diamond:function(){return s([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:o,Square:o,Triangle:function(){return s([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(t){for(var e=t.points,i=[],n=0,s=0;s<e.length-1;s++){var o=Math.sqrt(Math.pow(e[s][2]-e[s][0])+Math.pow(e[s][3]-e[s][1]));n+=o,i.push([e[s][0],e[s][1],e[s+1][0],e[s+1][1],o])}for(s=0;s<i.length;s++)i[s][4]=i[s][4]/n;return a(i)}};if(!r[i])throw new Error("Shape ["+i+"] is unknown by Perimeter Anchor type");var l=r[i](t);t.rotation&&(l=function(t,e){for(var i=[],n=e/180*Math.PI,a=0;a<t.length;a++){var s=t[a][0]-.5,o=t[a][1]-.5;i.push([s*Math.cos(n)-o*Math.sin(n)+.5,s*Math.sin(n)+o*Math.cos(n)+.5,t[a][2],t[a][3]])}return i}(l,t.rotation));var c=t.jsPlumbInstance.makeDynamicAnchor(l);return c.type="Perimeter",c}}(),function(){var t=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"];jsPlumb.Endpoint=function(e){var i=this,n=e._jsPlumb,a=jsPlumb.CurrentLibrary,s=a.getAttribute,o=a.getElementObject,r=jsPlumbUtil,l=a.getOffset,c=e.newConnection,d=e.newEndpoint,u=e.finaliseConnection,h=e.fireDetachEvent,p=e.floatingConnections;i.idPrefix="_jsplumb_e_",i.defaultLabelLocation=[.5,.5],i.defaultOverlayKeys=["Overlays","EndpointOverlays"],this.parent=e.parent,overlayCapableJsPlumbUIComponent.apply(this,arguments),e=e||{},this.getTypeDescriptor=function(){return"endpoint"},this.getDefaultType=function(){return{parameters:{},scope:null,maxConnections:i._jsPlumb.Defaults.MaxConnections,paintStyle:i._jsPlumb.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,endpoint:i._jsPlumb.Defaults.Endpoint||jsPlumb.Defaults.Endpoint,hoverPaintStyle:i._jsPlumb.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,overlays:i._jsPlumb.Defaults.EndpointOverlays||jsPlumb.Defaults.EndpointOverlays,connectorStyle:e.connectorStyle,connectorHoverStyle:e.connectorHoverStyle,connectorClass:e.connectorClass,connectorHoverClass:e.connectorHoverClass,connectorOverlays:e.connectorOverlays,connector:e.connector,connectorTooltip:e.connectorTooltip}};var f=this.applyType;this.applyType=function(e,n){f(e,n),null!=e.maxConnections&&(D=e.maxConnections),e.scope&&(i.scope=e.scope),r.copyValues(t,e,i)};var m=!0,g=!(!1===e.enabled);this.isVisible=function(){return m},this.setVisible=function(t,e,n){if(m=t,i.canvas&&(i.canvas.style.display=t?"block":"none"),i[t?"showOverlays":"hideOverlays"](),!e)for(var a=0;a<i.connections.length;a++)if(i.connections[a].setVisible(t),!n){var s=i===i.connections[a].endpoints[0]?1:0;1==i.connections[a].endpoints[s].connections.length&&i.connections[a].endpoints[s].setVisible(t,!0,!0)}},this.isEnabled=function(){return g},this.setEnabled=function(t){g=t};var v=e.source,b=e.uuid,y=null,_=null;b&&(e.endpointsByUUID[b]=i);var x=s(v,"id");this.elementId=x,this.element=v,i.setElementId=function(t){x=t,i.elementId=t,i.anchor.elementId=t},i.setReferenceElement=function(t){v=t,i.element=t};var w=e.connectionCost;this.getConnectionCost=function(){return w},this.setConnectionCost=function(t){w=t};var C=e.connectionsDirected;this.areConnectionsDirected=function(){return C},this.setConnectionsDirected=function(t){C=t};var k="",$=function(){a.removeClass(v,n.endpointAnchorClassPrefix+"_"+k),i.removeClass(n.endpointAnchorClassPrefix+"_"+k),k=i.anchor.getCssClass(),i.addClass(n.endpointAnchorClassPrefix+"_"+k),a.addClass(v,n.endpointAnchorClassPrefix+"_"+k)};this.setAnchor=function(t,e){i.anchor=n.makeAnchor(t,x,n),$(),i.anchor.bind("anchorChanged",(function(t){i.fire("anchorChanged",{endpoint:i,anchor:t}),$()})),e||n.repaint(x)},this.cleanup=function(){a.removeClass(v,n.endpointAnchorClassPrefix+"_"+k)};var S=e.anchor?e.anchor:e.anchors?e.anchors:n.Defaults.Anchor||"Top";i.setAnchor(S,!0),e._transient||n.anchorManager.add(i,x);var T=null;this.setEndpoint=function(t){var a=function(t,e){var i=n.getRenderMode();if(jsPlumb.Endpoints[i][t])return new jsPlumb.Endpoints[i][t](e);if(!n.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+t+"'"}},s={_jsPlumb:i._jsPlumb,cssClass:e.cssClass,parent:e.parent,container:e.container,tooltip:e.tooltip,connectorTooltip:e.connectorTooltip,endpoint:i};r.isString(t)?T=a(t,s):r.isArray(t)?(s=r.merge(t[1],s),T=a(t[0],s)):T=t.clone();var o=jsPlumb.extend({},s);T.clone=function(){var t=new Object;return T.constructor.apply(t,[o]),t},i.endpoint=T,i.type=i.endpoint.type},this.setEndpoint(e.endpoint||n.Defaults.Endpoint||jsPlumb.Defaults.Endpoint||"Dot");var I=i.setHover;i.setHover=function(){i.endpoint.setHover.apply(i.endpoint,arguments),I.apply(i,arguments)};i.bindListeners(i.endpoint,i,(function(t){i.connections.length>0?i.connections[0].setHover(t,!1):i.setHover(t)})),this.setPaintStyle(e.paintStyle||e.style||n.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,!0),this.setHoverPaintStyle(e.hoverPaintStyle||n.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,!0),this.paintStyleInUse=this.getPaintStyle();this.getPaintStyle();r.copyValues(t,e,this),this.isSource=e.isSource||!1,this.isTarget=e.isTarget||!1;var D=e.maxConnections||n.Defaults.MaxConnections;this.getAttachedElements=function(){return i.connections},this.canvas=this.endpoint.canvas,i.addClass(n.endpointAnchorClassPrefix+"_"+k),a.addClass(v,n.endpointAnchorClassPrefix+"_"+k),this.connections=e.connections||[],this.connectorPointerEvents=e["connector-pointer-events"],this.scope=e.scope||n.getDefaultScope(),this.timestamp=null,i.reattachConnections=e.reattach||n.Defaults.ReattachConnections,i.connectionsDetachable=n.Defaults.ConnectionsDetachable,!1!==e.connectionsDetachable&&!1!==e.detachable||(i.connectionsDetachable=!1);var A=e.dragAllowedWhenFull||!0;e.onMaxConnections&&i.bind("maxConnections",e.onMaxConnections),this.computeAnchor=function(t){return i.anchor.compute(t)},this.addConnection=function(t){i.connections.push(t),i[(i.connections.length>0?"add":"remove")+"Class"](n.endpointConnectedClass),i[(i.isFull()?"add":"remove")+"Class"](n.endpointFullClass)},this.detach=function(t,a,s,o,l){var c=r.findWithFunction(i.connections,(function(e){return e.id==t.id})),d=!1;if(o=!1!==o,c>=0&&(s||t._forceDetach||t.isDetachable()||t.isDetachAllowed(t))){var u=t.endpoints[0]==i?t.endpoints[1]:t.endpoints[0];if(s||t._forceDetach||i.isDetachAllowed(t)){if(i.connections.splice(c,1),!a&&(u.detach(t,!0,s),t.endpointsToDeleteOnDetach))for(var p=0;p<t.endpointsToDeleteOnDetach.length;p++){var f=t.endpointsToDeleteOnDetach[p];f&&0==f.connections.length&&n.deleteEndpoint(f)}null!=t.getConnector()&&r.removeElements(t.getConnector().getDisplayElements(),t.parent),r.removeWithFunction(e.connectionsByScope[t.scope],(function(e){return e.id==t.id})),i[(i.connections.length>0?"add":"remove")+"Class"](n.endpointConnectedClass),i[(i.isFull()?"add":"remove")+"Class"](n.endpointFullClass),d=!0,h(t,!a&&o,l)}}return d},this.detachAll=function(t,e){for(;i.connections.length>0;)i.detach(i.connections[0],!1,!0,t,e);return i},this.detachFrom=function(t,e,n){for(var a=[],s=0;s<i.connections.length;s++)i.connections[s].endpoints[1]!=t&&i.connections[s].endpoints[0]!=t||a.push(i.connections[s]);for(s=0;s<a.length;s++)i.detach(a[s],!1,!0,e,n)&&a[s].setHover(!1,!1);return i},this.detachFromConnection=function(t){var e=r.findWithFunction(i.connections,(function(e){return e.id==t.id}));e>=0&&(i.connections.splice(e,1),i[(i.connections.length>0?"add":"remove")+"Class"](n.endpointConnectedClass),i[(i.isFull()?"add":"remove")+"Class"](n.endpointFullClass))},this.getElement=function(){return v},this.setElement=function(t,s){var l=n.getId(t);r.removeWithFunction(e.endpointsByElement[i.elementId],(function(t){return t.id==i.id})),v=o(t),x=n.getId(v),i.elementId=x;var c=e.getParentFromParams({source:l,container:s}),d=a.getParent(i.canvas);a.removeElement(i.canvas,d),a.appendElement(i.canvas,c);for(var u=0;u<i.connections.length;u++)i.connections[u].moveParent(c),i.connections[u].sourceId=x,i.connections[u].source=v;r.addToList(e.endpointsByElement,l,i)},this.getUuid=function(){return b},i.makeInPlaceCopy=function(){var t=i.anchor.getCurrentLocation(i),n=i.anchor.getOrientation(i),a=i.anchor.getCssClass();return d({anchor:{bind:function(){},compute:function(){return[t[0],t[1]]},getCurrentLocation:function(){return[t[0],t[1]]},getOrientation:function(){return n},getCssClass:function(){return a}},source:v,paintStyle:this.getPaintStyle(),endpoint:e.hideOnDrag?"Blank":T,_transient:!0,scope:i.scope})},this.isConnectedTo=function(t){var e=!1;if(t)for(var n=0;n<i.connections.length;n++)if(i.connections[n].endpoints[1]==t){e=!0;break}return e},this.isFloating=function(){return null!=y},this.connectorSelector=function(){var t=i.connections[0];return i.isTarget&&t?t:i.connections.length<D||-1==D?null:t},this.isFull=function(){return!(i.isFloating()||D<1||i.connections.length<D)},this.setDragAllowedWhenFull=function(t){A=t},this.setStyle=i.setPaintStyle,this.equals=function(t){return this.anchor.equals(t.anchor)};if(this.paint=function(t){var e=(t=t||{}).timestamp,a=!(!1===t.recalc);if(!e||i.timestamp!==e){var s=n.updateOffset({elId:x,timestamp:e,recalc:a}),o=t.offset?t.offset.o:s.o;if(o){var r=t.anchorPoint,l=t.connectorPaintStyle;if(null==r){var c=t.dimensions||s.s;null!=o&&null!=c||(o=(s=n.updateOffset({elId:x,timestamp:e})).o,c=s.s);var d={xy:[o.left,o.top],wh:c,element:i,timestamp:e};if(a&&i.anchor.isDynamic&&i.connections.length>0){var u=function(t){var e=0;if(null!=t)for(var n=0;n<i.connections.length;n++)if(i.connections[n].sourceId==t||i.connections[n].targetId==t){e=n;break}return i.connections[e]}(t.elementWithPrecedence),h=u.endpoints[0]==i?1:0,p=0==h?u.sourceId:u.targetId,f=n.getCachedData(p),m=f.o,g=f.s;d.txy=[m.left,m.top],d.twh=g,d.tElement=u.endpoints[h]}r=i.anchor.compute(d)}T.compute(r,i.anchor.getOrientation(i),i.paintStyleInUse,l||i.paintStyleInUse),T.paint(i.paintStyleInUse,i.anchor),i.timestamp=e;for(var v=0;v<i.overlays.length;v++){var b=i.overlays[v];b.isVisible()&&(i.overlayPlacements[v]=b.draw(i.endpoint,i.paintStyleInUse),b.paint(i.overlayPlacements[v]))}}}},this.repaint=this.paint,a.isDragSupported(v)){var P={id:null,element:null},O=null,E=!1,M=null,L=function(t,e){var i=!1;return{drag:function(){if(i)return i=!1,!0;var n=jsPlumb.CurrentLibrary.getUIPosition(arguments,e.getZoom());t.element&&(jsPlumb.CurrentLibrary.setOffset(t.element,n),e.repaint(t.element,n))},stopDrag:function(){i=!0}}}(P,n),j=e.dragOptions||{},R=jsPlumb.extend({},a.defaultDragOptions),N=a.dragEvents.start,B=a.dragEvents.stop,F=a.dragEvents.drag;(j=jsPlumb.extend(R,j)).scope=j.scope||i.scope,j[N]=n.wrap(j[N],(function(){O=i.connectorSelector();var t=!0;if(i.isEnabled()||(t=!1),null!=O||e.isSource||(t=!1),e.isSource&&i.isFull()&&!A&&(t=!1),null==O||O.isDetachable()||(t=!1),!1===t)return a.stopDrag&&a.stopDrag(),L.stopDrag(),!1;i.addClass("endpointDrag"),O&&!i.isFull()&&e.isSource&&(O=null),n.updateOffset({elId:x}),(_=i.makeInPlaceCopy()).referenceEndpoint=i,_.paint(),function(t,e,i){var n=document.createElement("div");n.style.position="absolute";var a=jsPlumb.CurrentLibrary.getElementObject(n);jsPlumb.CurrentLibrary.appendElement(n,e);var s=i.getId(a);i.updateOffset({elId:s}),t.id=s,t.element=a}(P,i.parent,n);var s=o(_.canvas),u=l(s,n),h=n.adjustForParentOffsetAndScroll([u.left,u.top],_.canvas),f=o(i.canvas);if(a.setOffset(P.element,{left:h[0],top:h[1]}),i.parentAnchor&&(i.anchor=n.makeAnchor(i.parentAnchor,i.elementId,n)),a.setAttribute(f,"dragId",P.id),a.setAttribute(f,"elId",x),y=function(t,e,i,n,a,s,o){return o({paintStyle:t,endpoint:i,anchor:new jsPlumb.FloatingAnchor({reference:e,referenceCanvas:n,jsPlumbInstance:s}),source:a,scope:"__floating"})}(i.getPaintStyle(),i.anchor,T,i.canvas,P.element,n,d),i.canvas.style.visibility="hidden",null==O)i.anchor.locked=!0,i.setHover(!1,!1),(O=c({sourceEndpoint:i,targetEndpoint:y,source:i.endpointWillMoveTo||v,target:P.element,anchors:[i.anchor,y.anchor],paintStyle:e.connectorStyle,hoverPaintStyle:e.connectorHoverStyle,connector:e.connector,overlays:e.connectorOverlays,type:i.connectionType,cssClass:i.connectorClass,hoverClass:i.connectorHoverClass})).addClass(n.draggingClass),y.addClass(n.draggingClass),n.fire("connectionDrag",O);else{E=!0,O.setHover(!1),z(s,!1,!0);var m=O.endpoints[0].id==i.id?0:1;O.floatingAnchorIndex=m,i.detachFromConnection(O);var g=jsPlumb.CurrentLibrary.getDragScope(f);a.setAttribute(f,"originalScope",g);var b=a.getDropScope(f);a.setDragScope(f,b),0==m?(M=[O.source,O.sourceId,H,g],O.source=P.element,O.sourceId=P.id):(M=[O.target,O.targetId,H,g],O.target=P.element,O.targetId=P.id),O.endpoints[0==m?1:0].anchor.locked=!0,O.suspendedEndpoint=O.endpoints[m],O.suspendedElement=O.endpoints[m].getElement(),O.suspendedElementId=O.endpoints[m].elementId,O.suspendedElementType=0==m?"source":"target",O.suspendedEndpoint.setHover(!1),y.referenceEndpoint=O.suspendedEndpoint,O.endpoints[m]=y,O.addClass(n.draggingClass),y.addClass(n.draggingClass),n.fire("connectionDrag",O)}p[P.id]=O,n.anchorManager.addFloatingConnection(P.id,O),y.addConnection(O),r.addToList(e.endpointsByElement,P.id,y),n.currentlyDragging=!0})),j[F]=n.wrap(j[F],L.drag),j[B]=n.wrap(j[B],(function(){var t=a.getDropEvent(arguments);r.removeWithFunction(e.endpointsByElement[P.id],(function(t){return t.id==y.id})),r.removeElement(_.canvas,v),n.anchorManager.clearFor(P.id);var s=null==O.floatingAnchorIndex?1:O.floatingAnchorIndex;O.endpoints[0==s?1:0].anchor.locked=!1,O.endpoints[s]==y&&(E&&O.suspendedEndpoint?(0==s?(O.source=M[0],O.sourceId=M[1]):(O.target=M[0],O.targetId=M[1]),a.setDragScope(M[2],M[3]),O.endpoints[s]=O.suspendedEndpoint,(O.isReattach()||O._forceReattach||O._forceDetach||!O.endpoints[0==s?1:0].detach(O,!1,!1,!0,t))&&(O.setHover(!1),O.floatingAnchorIndex=null,O.suspendedEndpoint.addConnection(O),n.repaint(M[1])),O._forceDetach=null,O._forceReattach=null):(r.removeElements(O.getConnector().getDisplayElements(),i.parent),i.detachFromConnection(O))),r.removeElements([P.element[0],y.canvas],v),n.dragManager.elementRemoved(y.elementId),i.canvas.style.visibility="visible",i.anchor.locked=!1,i.paint({recalc:!1}),O.removeClass(n.draggingClass),y.removeClass(n.draggingClass),n.fire("connectionDragStop",O),O=null,_=null,delete e.endpointsByElement[y.elementId],y.anchor=null,y=null,n.currentlyDragging=!1}));var H=o(i.canvas);a.initDraggable(H,j,!0,n)}var z=function(t,r,l,c){if((e.isTarget||r)&&a.isDropSupported(v)){var d=e.dropOptions||n.Defaults.DropOptions||jsPlumb.Defaults.DropOptions;(d=jsPlumb.extend({},d)).scope=d.scope||i.scope;var f=a.dragEvents.drop,m=a.dragEvents.over,g=a.dragEvents.out;d[f]=n.wrap(d[f],(function(){i.removeClass(n.endpointDropAllowedClass),i.removeClass(n.endpointDropForbiddenClass);var t=a.getDropEvent(arguments),e=o(a.getDragObject(arguments)),r=s(e,"dragId"),l=(s(e,"elId"),s(e,"originalScope")),d=p[r];if(d.suspendedEndpoint&&(d.suspendedEndpoint.id==i.id||i.referenceEndpoint&&d.suspendedEndpoint.id==i.referenceEndpoint.id))d._forceReattach=!0;else if(null!=d){var f=null==d.floatingAnchorIndex?1:d.floatingAnchorIndex;l&&jsPlumb.CurrentLibrary.setDragScope(e,l);var m=null==c||c.isEnabled();if(i.isFull()&&i.fire("maxConnections",{endpoint:i,connection:d,maxConnections:D},t),!i.isFull()&&(0!=f||i.isSource)&&(1!=f||i.isTarget)&&m){var g=!0;d.suspendedEndpoint&&d.suspendedEndpoint.id!=i.id&&(0==f?(d.source=d.suspendedEndpoint.element,d.sourceId=d.suspendedEndpoint.elementId):(d.target=d.suspendedEndpoint.element,d.targetId=d.suspendedEndpoint.elementId),d.isDetachAllowed(d)&&d.endpoints[f].isDetachAllowed(d)&&d.suspendedEndpoint.isDetachAllowed(d)&&n.checkCondition("beforeDetach",d)||(g=!1)),0==f?(d.source=i.element,d.sourceId=i.elementId):(d.target=i.element,d.targetId=i.elementId);var v=function(){d.floatingAnchorIndex=null};(g=g&&i.isDropAllowed(d.sourceId,d.targetId,d.scope,d,i))?function(){d.endpoints[f].detachFromConnection(d),d.suspendedEndpoint&&d.suspendedEndpoint.detachFromConnection(d),d.endpoints[f]=i,i.addConnection(d);var e=i.getParameters();for(var a in e)d.setParameter(a,e[a]);if(d.suspendedEndpoint){var s=d.suspendedEndpoint.getElement(),o=d.suspendedEndpoint.elementId;h({source:0==f?s:d.source,target:1==f?s:d.target,sourceId:0==f?o:d.sourceId,targetId:1==f?o:d.targetId,sourceEndpoint:0==f?d.suspendedEndpoint:d.endpoints[0],targetEndpoint:1==f?d.suspendedEndpoint:d.endpoints[1],connection:d},!0,t)}else e.draggable&&jsPlumb.CurrentLibrary.initDraggable(i.element,j,!0,n);d.endpoints[0].addedViaMouse&&(d.endpointsToDeleteOnDetach[0]=d.endpoints[0]),d.endpoints[1].addedViaMouse&&(d.endpointsToDeleteOnDetach[1]=d.endpoints[1]),u(d,null,t),v()}():(d.suspendedEndpoint&&(d.endpoints[f]=d.suspendedEndpoint,d.setHover(!1),d._forceDetach=!0,0==f?(d.source=d.suspendedEndpoint.element,d.sourceId=d.suspendedEndpoint.elementId):(d.target=d.suspendedEndpoint.element,d.targetId=d.suspendedEndpoint.elementId),d.suspendedEndpoint.addConnection(d),d.endpoints[0].repaint(),d.repaint(),n.repaint(d.sourceId),d._forceDetach=!1),v())}n.currentlyDragging=!1,delete p[r],n.anchorManager.removeFloatingConnection(r)}})),d[m]=n.wrap(d[m],(function(){var t=a.getDragObject(arguments),e=s(o(t),"dragId"),r=p[e];if(null!=r){var l=null==r.floatingAnchorIndex?1:r.floatingAnchorIndex;if(i.isTarget&&0!=r.floatingAnchorIndex||r.suspendedEndpoint&&i.referenceEndpoint&&i.referenceEndpoint.id==r.suspendedEndpoint.id){var c=n.checkCondition("checkDropAllowed",{sourceEndpoint:r.endpoints[l],targetEndpoint:i,connection:r});i[(c?"add":"remove")+"Class"](n.endpointDropAllowedClass),i[(c?"remove":"add")+"Class"](n.endpointDropForbiddenClass),r.endpoints[l].anchor.over(i.anchor)}}})),d[g]=n.wrap(d[g],(function(){var t=a.getDragObject(arguments),e=s(o(t),"dragId"),r=p[e];if(null!=r){var l=null==r.floatingAnchorIndex?1:r.floatingAnchorIndex;(i.isTarget&&0!=r.floatingAnchorIndex||r.suspendedEndpoint&&i.referenceEndpoint&&i.referenceEndpoint.id==r.suspendedEndpoint.id)&&(i.removeClass(n.endpointDropAllowedClass),i.removeClass(n.endpointDropForbiddenClass),r.endpoints[l].anchor.out())}})),a.initDroppable(t,d,!0,l)}};return z(o(i.canvas),!0,!(e._transient||i.anchor.isFloating),i),e.type&&i.addType(e.type,e.data,n.isSuspendDrawing()),i}}(),jsPlumb.Connection=function(t){var e,i,n=this,a=!0,s=t._jsPlumb,o=jsPlumb.CurrentLibrary,r=o.getAttribute,l=o.getElementObject,c=jsPlumbUtil,d=(o.getOffset,t.newConnection,t.newEndpoint),u=null;n.idPrefix="_jsplumb_c_",n.defaultLabelLocation=.5,n.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.parent=t.parent,overlayCapableJsPlumbUIComponent.apply(this,arguments),this.isVisible=function(){return a},this.setVisible=function(t){a=t,n[t?"showOverlays":"hideOverlays"](),u&&u.canvas&&(u.canvas.style.display=t?"block":"none"),n.repaint()};var h=!0===t.editable;this.setEditable=function(t){return u&&u.isEditable()&&(h=t),h},this.isEditable=function(){return h},this.editStarted=function(){n.fire("editStarted",{path:u.getPath()}),s.setHoverSuspended(!0)},this.editCompleted=function(){n.fire("editCompleted",{path:u.getPath()}),n.setHover(!1),s.setHoverSuspended(!1)},this.editCanceled=function(){n.fire("editCanceled",{path:u.getPath()}),n.setHover(!1),s.setHoverSuspended(!1)};var p=this.addClass,f=this.removeClass;this.addClass=function(t,e){p(t),e&&(n.endpoints[0].addClass(t),n.endpoints[1].addClass(t))},this.removeClass=function(t,e){f(t),e&&(n.endpoints[0].removeClass(t),n.endpoints[1].removeClass(t))},this.getTypeDescriptor=function(){return"connection"},this.getDefaultType=function(){return{parameters:{},scope:null,detachable:n._jsPlumb.Defaults.ConnectionsDetachable,rettach:n._jsPlumb.Defaults.ReattachConnections,paintStyle:n._jsPlumb.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,connector:n._jsPlumb.Defaults.Connector||jsPlumb.Defaults.Connector,hoverPaintStyle:n._jsPlumb.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle,overlays:n._jsPlumb.Defaults.ConnectorOverlays||jsPlumb.Defaults.ConnectorOverlays}};var m=this.applyType;this.applyType=function(t,e){m(t,e),null!=t.detachable&&n.setDetachable(t.detachable),null!=t.reattach&&n.setReattach(t.reattach),t.scope&&(n.scope=t.scope),h=t.editable,n.setConnector(t.connector,e)},i=n.setHover,n.setHover=function(t){u.setHover.apply(u,arguments),i.apply(n,arguments)},e=function(t){s.isConnectionBeingDragged()||n.setHover(t,!1)};var g=function(t,e,i){var n=new Object;if(!s.Defaults.DoNotThrowErrors&&null==jsPlumb.Connectors[e])throw{msg:"jsPlumb: unknown connector type '"+e+"'"};return jsPlumb.Connectors[e].apply(n,[i]),jsPlumb.ConnectorRenderers[t].apply(n,[i]),n};this.setConnector=function(i,a){null!=u&&c.removeElements(u.getDisplayElements());var o={_jsPlumb:n._jsPlumb,parent:t.parent,cssClass:t.cssClass,container:t.container,tooltip:n.tooltip,"pointer-events":t["pointer-events"]},r=s.getRenderMode();c.isString(i)?u=g(r,i,o):c.isArray(i)&&(u=1==i.length?g(r,i[0],o):g(r,i[0],c.merge(i[1],o))),n.bindListeners(u,n,e),n.canvas=u.canvas,h&&null!=jsPlumb.ConnectorEditors&&jsPlumb.ConnectorEditors[u.type]&&u.isEditable()?new jsPlumb.ConnectorEditors[u.type]({connector:u,connection:n,params:t.editorParams||{}}):h=!1,a||n.repaint()},this.getConnector=function(){return u},this.source=l(t.source),this.target=l(t.target),t.sourceEndpoint&&(this.source=t.sourceEndpoint.endpointWillMoveTo||t.sourceEndpoint.getElement()),t.targetEndpoint&&(this.target=t.targetEndpoint.getElement()),n.previousConnection=t.previousConnection,this.sourceId=r(this.source,"id"),this.targetId=r(this.target,"id"),this.scope=t.scope,this.endpoints=[],this.endpointStyles=[];var v=function(t,e){return t?s.makeAnchor(t,e,s):null},b=function(t,e,i,a,o,r,l){var c;if(t)n.endpoints[e]=t,t.addConnection(n);else{i.endpoints||(i.endpoints=[null,null]);var u=i.endpoints[e]||i.endpoint||s.Defaults.Endpoints[e]||jsPlumb.Defaults.Endpoints[e]||s.Defaults.Endpoint||jsPlumb.Defaults.Endpoint;i.endpointStyles||(i.endpointStyles=[null,null]),i.endpointHoverStyles||(i.endpointHoverStyles=[null,null]);var h=i.endpointStyles[e]||i.endpointStyle||s.Defaults.EndpointStyles[e]||jsPlumb.Defaults.EndpointStyles[e]||s.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle;null==h.fillStyle&&null!=r&&(h.fillStyle=r.strokeStyle),null==h.outlineColor&&null!=r&&(h.outlineColor=r.outlineColor),null==h.outlineWidth&&null!=r&&(h.outlineWidth=r.outlineWidth);var p=i.endpointHoverStyles[e]||i.endpointHoverStyle||s.Defaults.EndpointHoverStyles[e]||jsPlumb.Defaults.EndpointHoverStyles[e]||s.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle;null!=l&&(null==p&&(p={}),null==p.fillStyle&&(p.fillStyle=l.strokeStyle));var f=i.anchors?i.anchors[e]:i.anchor?i.anchor:v(s.Defaults.Anchors[e],o)||v(jsPlumb.Defaults.Anchors[e],o)||v(s.Defaults.Anchor,o)||v(jsPlumb.Defaults.Anchor,o),m=i.uuids?i.uuids[e]:null;c=d({paintStyle:h,hoverPaintStyle:p,endpoint:u,connections:[n],uuid:m,anchor:f,source:a,scope:i.scope,container:i.container,reattach:i.reattach||s.Defaults.ReattachConnections,detachable:i.detachable||s.Defaults.ConnectionsDetachable}),n.endpoints[e]=c,!1===i.drawEndpoints&&c.setVisible(!1,!0,!0)}return c},y=b(t.sourceEndpoint,0,t,n.source,n.sourceId,t.paintStyle,t.hoverPaintStyle);y&&c.addToList(t.endpointsByElement,this.sourceId,y);var _=b(t.targetEndpoint,1,t,n.target,n.targetId,t.paintStyle,t.hoverPaintStyle);_&&c.addToList(t.endpointsByElement,this.targetId,_),this.scope||(this.scope=this.endpoints[0].scope),n.endpointsToDeleteOnDetach=[null,null],t.deleteEndpointsOnDetach&&(t.sourceIsNew&&(n.endpointsToDeleteOnDetach[0]=n.endpoints[0]),t.targetIsNew&&(n.endpointsToDeleteOnDetach[1]=n.endpoints[1])),t.endpointsToDeleteOnDetach&&(n.endpointsToDeleteOnDetach=t.endpointsToDeleteOnDetach),n.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||t.connector||s.Defaults.Connector||jsPlumb.Defaults.Connector,!0),t.path&&u.setPath(t.path),this.setPaintStyle(this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||t.paintStyle||s.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,!0),this.setHoverPaintStyle(this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||t.hoverPaintStyle||s.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle,!0),this.paintStyleInUse=this.getPaintStyle();var x=s.getSuspendedAt();if(s.updateOffset({elId:this.sourceId,timestamp:x}),s.updateOffset({elId:this.targetId,timestamp:x}),!s.isSuspendDrawing()){var w=s.getCachedData(this.sourceId),C=w.o,k=w.s,$=s.getCachedData(this.targetId),S=$.o,T=$.s,I=x||s.timestamp(),D=this.endpoints[0].anchor.compute({xy:[C.left,C.top],wh:k,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[S.left,S.top],twh:T,tElement:this.endpoints[1],timestamp:I});this.endpoints[0].paint({anchorLoc:D,timestamp:I}),D=this.endpoints[1].anchor.compute({xy:[S.left,S.top],wh:T,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[C.left,C.top],twh:k,tElement:this.endpoints[0],timestamp:I}),this.endpoints[1].paint({anchorLoc:D,timestamp:I})}var A=s.Defaults.ConnectionsDetachable;!1===t.detachable&&(A=!1),!1===n.endpoints[0].connectionsDetachable&&(A=!1),!1===n.endpoints[1].connectionsDetachable&&(A=!1),this.isDetachable=function(){return!0===A},this.setDetachable=function(t){A=!0===t};var P=t.reattach||n.endpoints[0].reattachConnections||n.endpoints[1].reattachConnections||s.Defaults.ReattachConnections;this.isReattach=function(){return!0===P},this.setReattach=function(t){P=!0===t};var O=t.cost||n.endpoints[0].getConnectionCost();n.getCost=function(){return O},n.setCost=function(t){O=t};var E=t.directed;null==t.directed&&(E=n.endpoints[0].areConnectionsDirected()),n.isDirected=function(){return!0===E};var M=jsPlumb.extend({},this.endpoints[0].getParameters());jsPlumb.extend(M,this.endpoints[1].getParameters()),jsPlumb.extend(M,n.getParameters()),n.setParameters(M),this.getAttachedElements=function(){return n.endpoints},this.moveParent=function(t){var e=jsPlumb.CurrentLibrary;e.getParent(u.canvas),u.bgCanvas&&(e.removeElement(u.bgCanvas),e.appendElement(u.bgCanvas,t)),e.removeElement(u.canvas),e.appendElement(u.canvas,t);for(var i=0;i<n.overlays.length;i++)n.overlays[i].isAppendedAtTopLevel&&(e.removeElement(n.overlays[i].canvas),e.appendElement(n.overlays[i].canvas,t),n.overlays[i].reattachListeners&&n.overlays[i].reattachListeners(u));u.reattachListeners&&u.reattachListeners()};var L=null;this.paint=function(t){if(a){var e=(t=t||{}).elId,i=t.ui,o=t.recalc,r=t.timestamp,l=this.targetId;if(this.sourceId,null==r||r!=L){var c=s.updateOffset({elId:e,offset:i,recalc:o,timestamp:r}).o,d=s.updateOffset({elId:l,timestamp:r}).o,h=this.endpoints[0],p=this.endpoints[1];t.clearEdits&&(h.anchor.clearUserDefinedLocation(),p.anchor.clearUserDefinedLocation(),u.setEdited(!1));var f=h.anchor.getCurrentLocation(h),m=p.anchor.getCurrentLocation(p);u.resetBounds(),u.compute({sourcePos:f,targetPos:m,sourceEndpoint:this.endpoints[0],targetEndpoint:this.endpoints[1],lineWidth:n.paintStyleInUse.lineWidth,sourceInfo:c,targetInfo:d,clearEdits:!0===t.clearEdits});for(var g={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},v=0;v<n.overlays.length;v++)(x=n.overlays[v]).isVisible()&&(n.overlayPlacements[v]=x.draw(u,n.paintStyleInUse),g.minX=Math.min(g.minX,n.overlayPlacements[v].minX),g.maxX=Math.max(g.maxX,n.overlayPlacements[v].maxX),g.minY=Math.min(g.minY,n.overlayPlacements[v].minY),g.maxY=Math.max(g.maxY,n.overlayPlacements[v].maxY));var b=parseFloat(n.paintStyleInUse.lineWidth||1)/2,y=parseFloat(n.paintStyleInUse.lineWidth||0),_={xmin:Math.min(u.bounds.minX-(b+y),g.minX),ymin:Math.min(u.bounds.minY-(b+y),g.minY),xmax:Math.max(u.bounds.maxX+(b+y),g.maxX),ymax:Math.max(u.bounds.maxY+(b+y),g.maxY)};for(u.paint(n.paintStyleInUse,null,_),v=0;v<n.overlays.length;v++){var x;(x=n.overlays[v]).isVisible()&&x.paint(n.overlayPlacements[v],_)}}L=r}},this.repaint=function(t){var e=!(!1===(t=t||{}).recalc);this.paint({elId:this.sourceId,recalc:e,timestamp:t.timestamp,clearEdits:t.clearEdits})};var j=t.type||n.endpoints[0].connectionType||n.endpoints[1].connectionType;j&&n.addType(j,t.data,s.isSuspendDrawing())},function(){jsPlumb.DOMElementComponent=function(t){jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.mousemove=this.dblclick=this.click=this.mousedown=this.mouseup=function(t){}},jsPlumb.Segments={AbstractSegment:function(t){this.params=t,this.findClosestPointOnPath=function(t,e){return{d:1/0,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(t.x1,t.x2),minY:Math.min(t.y1,t.y2),maxX:Math.max(t.x1,t.x2),maxY:Math.max(t.y1,t.y2)}}},Straight:function(t){var e,i,n,a,s,o,r,l=this;jsPlumb.Segments.AbstractSegment.apply(this,arguments);this.type="Straight",l.getLength=function(){return e},l.getGradient=function(){return i},this.getCoordinates=function(){return{x1:a,y1:o,x2:s,y2:r}},this.setCoordinates=function(t){a=t.x1,o=t.y1,s=t.x2,r=t.y2,e=Math.sqrt(Math.pow(s-a,2)+Math.pow(r-o,2)),i=jsPlumbUtil.gradient({x:a,y:o},{x:s,y:r}),n=-1/i},this.setCoordinates({x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}),this.getBounds=function(){return{minX:Math.min(a,s),minY:Math.min(o,r),maxX:Math.max(a,s),maxY:Math.max(o,r)}},this.pointOnPath=function(t,i){if(0!=t||i){if(1!=t||i){var n=i?t>0?t:e+t:t*e;return jsPlumbUtil.pointOnLine({x:a,y:o},{x:s,y:r},n)}return{x:s,y:r}}return{x:a,y:o}},this.gradientAtPoint=function(t){return i},this.pointAlongPathFrom=function(t,e,i){var n=l.pointOnPath(t,i),c=1==t?{x:a+10*(s-a),y:o+10*(o-r)}:e<=0?{x:a,y:o}:{x:s,y:r};return e<=0&&Math.abs(e)>1&&(e*=-1),jsPlumbUtil.pointOnLine(n,c,e)},this.findClosestPointOnPath=function(t,s){if(0==i)return{x:t,y:o,d:Math.abs(s-o)};if(i==1/0||i==-1/0)return{x:a,y:s,d:Math.abs(t-1)};var r=o-i*a,l=(s-n*t-r)/(i-n),c=i*l+r;return{d:jsPlumbUtil.lineLength([t,s],[l,c]),x:l,y:c,l:jsPlumbUtil.lineLength([l,c],[a,o])/e}}},Arc:function(t){var e=this,i=(jsPlumb.Segments.AbstractSegment.apply(this,arguments),function(e,i){return jsPlumbUtil.theta([t.cx,t.cy],[e,i])}),n=2*Math.PI;this.radius=t.r,this.anticlockwise=t.ac,this.type="Arc",t.startAngle&&t.endAngle?(this.startAngle=t.startAngle,this.endAngle=t.endAngle,this.x1=t.cx+e.radius*Math.cos(t.startAngle),this.y1=t.cy+e.radius*Math.sin(t.startAngle),this.x2=t.cx+e.radius*Math.cos(t.endAngle),this.y2=t.cy+e.radius*Math.sin(t.endAngle)):(this.startAngle=i(t.x1,t.y1),this.endAngle=i(t.x2,t.y2),this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2),this.endAngle<0&&(this.endAngle+=n),this.startAngle<0&&(this.startAngle+=n),this.segment=jsPlumbUtil.segment([this.x1,this.y1],[this.x2,this.y2]);var a=e.endAngle<e.startAngle?e.endAngle+n:e.endAngle;e.sweep=Math.abs(a-e.startAngle),e.anticlockwise&&(e.sweep=n-e.sweep);var s=2*Math.PI*e.radius,o=e.sweep/n,r=s*o;this.getLength=function(){return r},this.getBounds=function(){return{minX:t.cx-t.r,maxX:t.cx+t.r,minY:t.cy-t.r,maxY:t.cy+t.r}};var l=function(t){var e=Math.floor(t),i=Math.ceil(t);return t-e<1e-10?e:i-t<1e-10?i:t};this.pointOnPath=function(i,a){if(0==i)return{x:e.x1,y:e.y1,theta:e.startAngle};if(1==i)return{x:e.x2,y:e.y2,theta:e.endAngle};a&&(i/=r);var s=function(t){if(e.anticlockwise){var i=e.startAngle<e.endAngle?e.startAngle+n:e.startAngle;return i-(s=Math.abs(i-e.endAngle))*t}var a=e.endAngle<e.startAngle?e.endAngle+n:e.endAngle,s=Math.abs(a-e.startAngle);return e.startAngle+s*t}(i),o=t.cx+t.r*Math.cos(s),c=t.cy+t.r*Math.sin(s);return{x:l(o),y:l(c),theta:s}},this.gradientAtPoint=function(i,n){var a=e.pointOnPath(i,n),s=jsPlumbUtil.normal([t.cx,t.cy],[a.x,a.y]);return e.anticlockwise||s!=1/0&&s!=-1/0||(s*=-1),s},this.pointAlongPathFrom=function(i,n,a){var o=e.pointOnPath(i,a),r=n/s*2*Math.PI,l=e.anticlockwise?-1:1,c=o.theta+l*r;return{x:t.cx+e.radius*Math.cos(c),y:t.cy+e.radius*Math.sin(c)}}},Bezier:function(t){jsPlumb.Segments.AbstractSegment.apply(this,arguments);var e=[{x:t.x1,y:t.y1},{x:t.cp1x,y:t.cp1y},{x:t.cp2x,y:t.cp2y},{x:t.x2,y:t.y2}],i={minX:Math.min(t.x1,t.x2,t.cp1x,t.cp2x),minY:Math.min(t.y1,t.y2,t.cp1y,t.cp2y),maxX:Math.max(t.x1,t.x2,t.cp1x,t.cp2x),maxY:Math.max(t.y1,t.y2,t.cp1y,t.cp2y)};this.type="Bezier";var n=function(t,e,i){return i&&(e=jsBezier.locationAlongCurveFrom(t,e>0?0:1,e)),e};this.pointOnPath=function(t,i){return t=n(e,t,i),jsBezier.pointOnCurve(e,t)},this.gradientAtPoint=function(t,i){return t=n(e,t,i),jsBezier.gradientAtPoint(e,t)},this.pointAlongPathFrom=function(t,i,a){return t=n(e,t,a),jsBezier.pointAlongCurveFrom(e,t,i)},this.getLength=function(){return jsBezier.getLength(e)},this.getBounds=function(){return i}}};var t=function(){var t=this;t.resetBounds=function(){t.bounds={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},t.resetBounds()};jsPlumb.Connectors.AbstractConnector=function(e){t.apply(this,arguments);var i=this,n=[],a=0,s=[],o=[],r=e.stub||0,l=jsPlumbUtil.isArray(r)?r[0]:r,c=jsPlumbUtil.isArray(r)?r[1]:r,d=e.gap||0,u=jsPlumbUtil.isArray(d)?d[0]:d,h=jsPlumbUtil.isArray(d)?d[1]:d,p=null,f=!1,m=null;this.isEditable=function(){return!1},this.setEdited=function(t){f=t},this.getPath=function(){},this.setPath=function(t){},this.findSegmentForPoint=function(t,e){for(var i={d:1/0,s:null,x:null,y:null,l:null},a=0;a<n.length;a++){var s=n[a].findClosestPointOnPath(t,e);s.d<i.d&&(i.d=s.d,i.l=s.l,i.x=s.x,i.y=s.y,i.s=n[a])}return i};var g=function(t,e){e&&(t=t>0?t/a:(a+t)/a);for(var i=s.length-1,r=1,l=0;l<s.length;l++)if(s[l][1]>=t){i=l,r=1==t?1:0==t?0:(t-s[l][0])/o[l];break}return{segment:n[i],proportion:r,index:i}};this.setSegments=function(t){p=[],a=0;for(var e=0;e<t.length;e++)p.push(t[e]),a+=t[e].getLength()};var v=function(t){i.lineWidth=t.lineWidth;var e=jsPlumbUtil.segment(t.sourcePos,t.targetPos),n=t.targetPos[0]<t.sourcePos[0],a=t.targetPos[1]<t.sourcePos[1],s=t.lineWidth||1,o=t.sourceEndpoint.anchor.orientation||t.sourceEndpoint.anchor.getOrientation(t.sourceEndpoint),r=t.targetEndpoint.anchor.orientation||t.targetEndpoint.anchor.getOrientation(t.targetEndpoint),d=n?t.targetPos[0]:t.sourcePos[0],p=a?t.targetPos[1]:t.sourcePos[1],f=Math.abs(t.targetPos[0]-t.sourcePos[0]),m=Math.abs(t.targetPos[1]-t.sourcePos[1]);if(0==o[0]&&0==o[1]||0==r[0]&&0==r[1]){var g=f>m?0:1,v=[1,0][g];r=[],(o=[])[g]=t.sourcePos[g]>t.targetPos[g]?-1:1,r[g]=t.sourcePos[g]>t.targetPos[g]?1:-1,o[v]=0,r[v]=0}var b=n?f+u*o[0]:u*o[0],y=a?m+u*o[1]:u*o[1],_=n?h*r[0]:f+h*r[0],x=a?h*r[1]:m+h*r[1],w=o[0]*r[0]+o[1]*r[1],C={sx:b,sy:y,tx:_,ty:x,lw:s,xSpan:Math.abs(_-b),ySpan:Math.abs(x-y),mx:(b+_)/2,my:(y+x)/2,so:o,to:r,x:d,y:p,w:f,h:m,segment:e,startStubX:b+o[0]*l,startStubY:y+o[1]*l,endStubX:_+r[0]*c,endStubY:x+r[1]*c,isXGreaterThanStubTimes2:Math.abs(b-_)>l+c,isYGreaterThanStubTimes2:Math.abs(y-x)>l+c,opposite:-1==w,perpendicular:0==w,orthogonal:1==w,sourceAxis:0==o[0]?"y":"x",points:[d,p,f,m,b,y,_,x]};return C.anchorOrientation=C.opposite?"opposite":C.orthogonal?"orthogonal":"perpendicular",C};this.getSegments=function(){return n},i.updateBounds=function(t){var e=t.getBounds();i.bounds.minX=Math.min(i.bounds.minX,e.minX),i.bounds.maxX=Math.max(i.bounds.maxX,e.maxX),i.bounds.minY=Math.min(i.bounds.minY,e.minY),i.bounds.maxY=Math.max(i.bounds.maxY,e.maxY)};return this.pointOnPath=function(t,e){var i=g(t,e);return i.segment.pointOnPath(i.proportion,e)},this.gradientAtPoint=function(t){var e=g(t,absolute);return e.segment.gradientAtPoint(e.proportion,absolute)},this.pointAlongPathFrom=function(t,e,i){var n=g(t,i);return n.segment.pointAlongPathFrom(n.proportion,e,!1)},this.compute=function(t){f||(m=v(t)),a=0,n.splice(0,n.length),s.splice(0,s.length),o.splice(0,o.length),this._compute(m,t),i.x=m.points[0],i.y=m.points[1],i.w=m.points[2],i.h=m.points[3],i.segment=m.segment,function(){for(var t=0,e=0;e<n.length;e++){var i=n[e].getLength();o[e]=i/a,s[e]=[t,t+=i/a]}}()},{addSegment:function(t,e){var s=new jsPlumb.Segments[t](e);n.push(s),a+=s.getLength(),i.updateBounds(s)},prepareCompute:v,sourceStub:l,targetStub:c,maxStub:Math.max(l,c),sourceGap:u,targetGap:h,maxGap:Math.max(u,h)}},jsPlumb.Connectors.Straight=function(){this.type="Straight";var t=jsPlumb.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(e,i){t.addSegment("Straight",{x1:e.sx,y1:e.sy,x2:e.startStubX,y2:e.startStubY}),t.addSegment("Straight",{x1:e.startStubX,y1:e.startStubY,x2:e.endStubX,y2:e.endStubY}),t.addSegment("Straight",{x1:e.endStubX,y1:e.endStubY,x2:e.tx,y2:e.ty})}},jsPlumb.Connectors.Bezier=function(t){t=t||{};var e=this,i=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),n=(t.stub,t.curviness||150),a=10;this.type="Bezier",this.getCurviness=function(){return n},this._findControlPoint=function(t,e,i,s,o){var r=s.anchor.getOrientation(s),l=o.anchor.getOrientation(o),c=[];return r[0]!=l[0]||r[1]==l[1]?(0==l[0]?c.push(i[0]<e[0]?t[0]+a:t[0]-a):c.push(t[0]+n*l[0]),0==l[1]?c.push(i[1]<e[1]?t[1]+a:t[1]-a):c.push(t[1]+n*r[1])):(0==r[0]?c.push(e[0]<i[0]?t[0]+a:t[0]-a):c.push(t[0]-n*r[0]),0==r[1]?c.push(e[1]<i[1]?t[1]+a:t[1]-a):c.push(t[1]+n*l[1])),c},this._compute=function(t,n){var a=n.sourcePos,s=n.targetPos,o=Math.abs(a[0]-s[0]),r=Math.abs(a[1]-s[1]),l=a[0]<s[0]?o:0,c=a[1]<s[1]?r:0,d=a[0]<s[0]?0:o,u=a[1]<s[1]?0:r,h=e._findControlPoint([l,c],a,s,n.sourceEndpoint,n.targetEndpoint),p=e._findControlPoint([d,u],s,a,n.targetEndpoint,n.sourceEndpoint);i.addSegment("Bezier",{x1:l,y1:c,x2:d,y2:u,cp1x:h[0],cp1y:h[1],cp2x:p[0],cp2y:p[1]})}},jsPlumb.Endpoints.AbstractEndpoint=function(e){t.apply(this,arguments);var i=this;return this.compute=function(t,e,n,a){var s=i._compute.apply(i,arguments);return i.x=s[0],i.y=s[1],i.w=s[2],i.h=s[3],i.bounds.minX=i.x,i.bounds.minY=i.y,i.bounds.maxX=i.x+i.w,i.bounds.maxY=i.y+i.h,s},{compute:i.compute,cssClass:e.cssClass}},jsPlumb.Endpoints.Dot=function(t){this.type="Dot";var e=this;jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);t=t||{},this.radius=t.radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(t,i,n,a){e.radius=n.radius||e.radius;var s=t[0]-e.radius,o=t[1]-e.radius,r=2*e.radius,l=2*e.radius;if(n.strokeStyle){var c=n.lineWidth||1;s-=c,o-=c,r+=2*c,l+=2*c}return[s,o,r,l,e.radius]}},jsPlumb.Endpoints.Rectangle=function(t){this.type="Rectangle";var e=this;jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);t=t||{},this.width=t.width||20,this.height=t.height||20,this._compute=function(t,i,n,a){var s=n.width||e.width,o=n.height||e.height;return[t[0]-s/2,t[1]-o/2,s,o]}};var e=function(t){jsPlumb.DOMElementComponent.apply(this,arguments);var e=[];this.getDisplayElements=function(){return e},this.appendDisplayElement=function(t){e.push(t)}};jsPlumb.Endpoints.Image=function(t){this.type="Image",e.apply(this,arguments);var i=this,n=(jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments),!1),a=!1,s=t.width,o=t.height,r=null,l=t.endpoint;this.img=new Image,i.ready=!1,this.img.onload=function(){i.ready=!0,s=s||i.img.width,o=o||i.img.height,r&&r(i)},l.setImage=function(t,e){t.constructor==String||t.src;r=e,i.img.src=t,null!=i.canvas&&i.canvas.setAttribute("src",t)},l.setImage(t.src||t.url,t.onload),this._compute=function(t,e,n,a){return i.anchorPoint=t,i.ready?[t[0]-s/2,t[1]-o/2,s,o]:[0,0,0,0]},i.canvas=document.createElement("img"),n=!1,i.canvas.style.margin=0,i.canvas.style.padding=0,i.canvas.style.outline=0,i.canvas.style.position="absolute";var c=t.cssClass?" "+t.cssClass:"";i.canvas.className=jsPlumb.endpointClass+c,s&&i.canvas.setAttribute("width",s),o&&i.canvas.setAttribute("height",o),jsPlumb.appendElement(i.canvas,t.parent),i.attachListeners(i.canvas,i),i.cleanup=function(){a=!0};this.paint=function(t,e){i.ready?function(t,e,r){if(!a){n||(i.canvas.setAttribute("src",i.img.src),i.appendDisplayElement(i.canvas),n=!0);var l=i.anchorPoint[0]-s/2,c=i.anchorPoint[1]-o/2;jsPlumb.sizeCanvas(i.canvas,l,c,s,o)}}():window.setTimeout((function(){i.paint(t,e)}),200)}},jsPlumb.Endpoints.Blank=function(t){var i=this;jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);this.type="Blank",e.apply(this,arguments),this._compute=function(t,e,i,n){return[t[0],t[1],10,0]},i.canvas=document.createElement("div"),i.canvas.style.display="block",i.canvas.style.width="1px",i.canvas.style.height="1px",i.canvas.style.background="transparent",i.canvas.style.position="absolute",i.canvas.className=i._jsPlumb.endpointClass,jsPlumb.appendElement(i.canvas,t.parent),this.paint=function(t,e){jsPlumb.sizeCanvas(i.canvas,i.x,i.y,i.w,i.h)}},jsPlumb.Endpoints.Triangle=function(t){this.type="Triangle";var e=this;jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);(t=t||{}).width=t.width||55,t.height=t.height||55,this.width=t.width,this.height=t.height,this._compute=function(t,i,n,a){var s=n.width||e.width,o=n.height||e.height;return[t[0]-s/2,t[1]-o/2,s,o]}};var i=jsPlumb.Overlays.AbstractOverlay=function(t){var e=!0,i=this;this.isAppendedAtTopLevel=!0,this.component=t.component,this.loc=null==t.location?.5:t.location,this.endpointLoc=null==t.endpointLocation?[.5,.5]:t.endpointLocation,this.setVisible=function(t){e=t,i.component.repaint()},this.isVisible=function(){return e},this.hide=function(){i.setVisible(!1)},this.show=function(){i.setVisible(!0)},this.incrementLocation=function(t){i.loc+=t,i.component.repaint()},this.setLocation=function(t){i.loc=t,i.component.repaint()},this.getLocation=function(){return i.loc}};jsPlumb.Overlays.Arrow=function(t){this.type="Arrow",i.apply(this,arguments),this.isAppendedAtTopLevel=!1,t=t||{};var e=this,n=jsPlumbUtil;this.length=t.length||20,this.width=t.width||20,this.id=t.id;var a=(t.direction||1)<0?-1:1,s=t.paintStyle||{lineWidth:1},o=t.foldback||.623;this.computeMaxSize=function(){return 1.5*e.width},this.cleanup=function(){},this.draw=function(t,i){var r,l,c,d;if(t.pointAlongPathFrom){if(n.isString(e.loc)||e.loc>1||e.loc<0){var u=parseInt(e.loc);r=t.pointAlongPathFrom(u,a*e.length/2,!0),l=t.pointOnPath(u,!0),c=n.pointOnLine(r,l,e.length)}else if(1==e.loc){if(r=t.pointOnPath(e.loc),l=t.pointAlongPathFrom(e.loc,-e.length),c=n.pointOnLine(r,l,e.length),-1==a){var h=c;c=r,r=h}}else if(0==e.loc){if(c=t.pointOnPath(e.loc),l=t.pointAlongPathFrom(e.loc,e.length),r=n.pointOnLine(c,l,e.length),-1==a){h=c;c=r,r=h}}else r=t.pointAlongPathFrom(e.loc,a*e.length/2),l=t.pointOnPath(e.loc),c=n.pointOnLine(r,l,e.length);var p={hxy:r,tail:d=n.perpendicularLineTo(r,c,e.width),cxy:n.pointOnLine(r,c,o*e.length)},f=s.strokeStyle||i.strokeStyle,m=s.fillStyle||i.strokeStyle;return{component:t,d:p,lineWidth:s.lineWidth||i.lineWidth,strokeStyle:f,fillStyle:m,minX:Math.min(r.x,d[0].x,d[1].x),maxX:Math.max(r.x,d[0].x,d[1].x),minY:Math.min(r.y,d[0].y,d[1].y),maxY:Math.max(r.y,d[0].y,d[1].y)}}return{component:t,minX:0,maxX:0,minY:0,maxY:0}}},jsPlumb.Overlays.PlainArrow=function(t){t=t||{};var e=jsPlumb.extend(t,{foldback:1});jsPlumb.Overlays.Arrow.call(this,e),this.type="PlainArrow"},jsPlumb.Overlays.Diamond=function(t){var e=(t=t||{}).length||40,i=jsPlumb.extend(t,{length:e/2,foldback:2});jsPlumb.Overlays.Arrow.call(this,i),this.type="Diamond"};var n=function(t){jsPlumb.DOMElementComponent.apply(this,arguments),i.apply(this,arguments);var e,n=this,a=!1,s=jsPlumb.CurrentLibrary;t=t||{},this.id=t.id;this.getElement=function(){return null==e&&function(){e=t.create(t.component),(e=s.getDOMElement(e)).style.position="absolute";var i=t._jsPlumb.overlayClass+" "+(n.cssClass?n.cssClass:t.cssClass?t.cssClass:"");e.className=i,t._jsPlumb.appendElement(e,t.component.parent),t._jsPlumb.getId(e),n.attachListeners(e,n),n.canvas=e}(),e},this.getDimensions=function(){return s.getSize(s.getElementObject(n.getElement()))};var o=null,r=function(t){return null==o&&(o=n.getDimensions()),o};this.clearCachedDimensions=function(){o=null},this.computeMaxSize=function(){var t=r();return Math.max(t[0],t[1])};var l=n.setVisible;n.setVisible=function(t){l(t),e.style.display=t?"block":"none"},this.cleanup=function(){null!=e&&s.removeElement(e)},this.paint=function(t,i){a||(n.getElement(),t.component.appendDisplayElement(e),n.attachListeners(e,t.component),a=!0),e.style.left=t.component.x+t.d.minx+"px",e.style.top=t.component.y+t.d.miny+"px"},this.draw=function(t,e){var i=r();if(null!=i&&2==i.length){var a={x:0,y:0};if(t.pointOnPath){var s=n.loc,o=!1;(jsPlumbUtil.isString(n.loc)||n.loc<0||n.loc>1)&&(s=parseInt(n.loc),o=!0),a=t.pointOnPath(s,o)}else{var l=n.loc.constructor==Array?n.loc:n.endpointLoc;a={x:l[0]*t.w,y:l[1]*t.h}}var c=a.x-i[0]/2,d=a.y-i[1]/2;return{component:t,d:{minx:c,miny:d,td:i,cxy:a},minX:c,maxX:c+i[0],minY:d,maxY:d+i[1]}}return{minX:0,maxX:0,minY:0,maxY:0}},this.reattachListeners=function(t){e&&n.reattachListenersForElement(e,n,t)}};jsPlumb.Overlays.Custom=function(t){this.type="Custom",n.apply(this,arguments)},jsPlumb.Overlays.GuideLines=function(){var t=this;t.length=50,t.lineWidth=5,this.type="GuideLines",i.apply(this,arguments),jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.draw=function(e,i){var n=e.pointAlongPathFrom(t.loc,t.length/2),a=e.pointOnPath(t.loc),s=jsPlumbUtil.pointOnLine(n,a,t.length),o=jsPlumbUtil.perpendicularLineTo(n,s,40),r=jsPlumbUtil.perpendicularLineTo(s,n,20);return{connector:e,head:n,tail:s,headLine:r,tailLine:o,minX:Math.min(n.x,s.x,r[0].x,r[1].x),minY:Math.min(n.y,s.y,r[0].y,r[1].y),maxX:Math.max(n.x,s.x,r[0].x,r[1].x),maxY:Math.max(n.y,s.y,r[0].y,r[1].y)}},this.cleanup=function(){}},jsPlumb.Overlays.Label=function(t){this.labelStyle=t.labelStyle||jsPlumb.Defaults.LabelStyle,this.cssClass=null!=this.labelStyle?this.labelStyle.cssClass:null,t.create=function(){return document.createElement("div")},jsPlumb.Overlays.Custom.apply(this,arguments),this.type="Label";var e=t.label||"",i=this,n=null;this.setLabel=function(t){e=t,n=null,i.clearCachedDimensions(),a(),i.component.repaint()};var a=function(){if("function"==typeof e){var t=e(i);i.getElement().innerHTML=t.replace(/\r\n/g,"<br/>")}else null==n&&(n=e,i.getElement().innerHTML=n.replace(/\r\n/g,"<br/>"))};this.getLabel=function(){return e};var s=this.getDimensions;this.getDimensions=function(){return a(),s()}}}(),jsPlumb.Connectors.StateMachine=function(t){t=t||{},this.type="StateMachine";var e=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),i=t.curviness||10,n=t.margin||5,a=t.proximityLimit||80,s=t.orientation&&"clockwise"===t.orientation,o=t.loopbackRadius||25,r=!1!==t.showLoopback;this._compute=function(t,l){var c=Math.abs(l.sourcePos[0]-l.targetPos[0]),d=Math.abs(l.sourcePos[1]-l.targetPos[1]),u=Math.min(l.sourcePos[0],l.targetPos[0]),h=Math.min(l.sourcePos[1],l.targetPos[1]);if(r&&l.sourceEndpoint.elementId===l.targetEndpoint.elementId){var p=l.sourcePos[0],f=(l.sourcePos[0],l.sourcePos[1]-n),m=(l.sourcePos[1],p),g=f-o;c=2*o,d=2*o,u=m-o,h=g-o,t.points[0]=u,t.points[1]=h,t.points[2]=c,t.points[3]=d,e.addSegment("Arc",{x1:p-u+4,y1:f-h,startAngle:0,endAngle:2*Math.PI,r:o,ac:!s,x2:p-u-4,y2:f-h,cx:m-u,cy:g-h})}else{var v=l.sourcePos[0]<l.targetPos[0]?0:c,b=l.sourcePos[1]<l.targetPos[1]?0:d,y=l.sourcePos[0]<l.targetPos[0]?c:0,_=l.sourcePos[1]<l.targetPos[1]?d:0;0===l.sourcePos[2]&&(v-=n),1===l.sourcePos[2]&&(v+=n),0===l.sourcePos[3]&&(b-=n),1===l.sourcePos[3]&&(b+=n),0===l.targetPos[2]&&(y-=n),1===l.targetPos[2]&&(y+=n),0===l.targetPos[3]&&(_-=n),1===l.targetPos[3]&&(_+=n);var x=(v+y)/2,w=(b+_)/2,C=-1*x/w,k=Math.atan(C),$=(C==1/0||C==-1/0||Math.abs(i/2*Math.sin(k)),C==1/0||C==-1/0||Math.abs(i/2*Math.cos(k)),function(t,e,i,n){return t<=i&&n<=e?1:t<=i&&e<=n?2:i<=t&&n>=e?3:4}(v,b,y,_)),S=Math.sqrt(Math.pow(y-v,2)+Math.pow(_-b,2)),T=function(t,e,i,n,a,s,o,r,l){return r<=l?[t,e]:1===i?n[3]<=0&&a[3]>=1?[t+(n[2]<.5?-1*s:s),e]:n[2]>=1&&a[2]<=0?[t,e+(n[3]<.5?-1*o:o)]:[t+-1*s,e+-1*o]:2===i?n[3]>=1&&a[3]<=0?[t+(n[2]<.5?-1*s:s),e]:n[2]>=1&&a[2]<=0?[t,e+(n[3]<.5?-1*o:o)]:[t+1*s,e+-1*o]:3===i?n[3]>=1&&a[3]<=0?[t+(n[2]<.5?-1*s:s),e]:n[2]<=0&&a[2]>=1?[t,e+(n[3]<.5?-1*o:o)]:[t+-1*s,e+-1*o]:4===i?n[3]<=0&&a[3]>=1?[t+(n[2]<.5?-1*s:s),e]:n[2]<=0&&a[2]>=1?[t,e+(n[3]<.5?-1*o:o)]:[t+1*s,e+-1*o]:void 0}(x,w,$,l.sourcePos,l.targetPos,i,i,S,a);e.addSegment("Bezier",{x1:y,y1:_,x2:v,y2:b,cp1x:T[0],cp1y:T[1],cp2x:T[0],cp2y:T[1]})}}},jsPlumb.Connectors.Flowchart=function(t){this.type="Flowchart",(t=t||{}).stub=t.stub||30;var e=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),i=t.midpoint||.5,n=[],a=(t.grid,t.alwaysRespectStubs),s=null,o=null,r=null,l=null!=t.cornerRadius?t.cornerRadius:0,c=function(t){return t<0?-1:0==t?0:1},d=function(t,e,i,n){if(o!=e||r!=i){var a=null==o?n.sx:o,s=null==r?n.sy:r,l=a==e?"v":"h",d=c(e-a),u=c(i-s);o=e,r=i,t.push([a,s,e,i,l,d,u])}},u=function(t){return Math.sqrt(Math.pow(t[0]-t[2],2)+Math.pow(t[1]-t[3],2))},h=function(t){var e=[];return e.push.apply(e,t),e},p=function(t,i){for(var n,a,s=0;s<t.length-1;s++){if(n=n||h(t[s]),a=h(t[s+1]),l>0&&n[4]!=a[4]){var o=Math.min(l,u(n),u(a));n[2]-=n[5]*o,n[3]-=n[6]*o,a[0]+=a[5]*o,a[1]+=a[6]*o;var r=n[6]==a[5]&&1==a[5]||n[6]==a[5]&&0==a[5]&&n[5]!=a[6]||n[6]==a[5]&&-1==a[5],c=(a[1]>n[3]?1:-1)==(a[0]>n[2]?1:-1),d=c&&r||!c&&!r?a[0]:n[2],p=c&&r||!c&&!r?n[3]:a[1];e.addSegment("Straight",{x1:n[0],y1:n[1],x2:n[2],y2:n[3]}),e.addSegment("Arc",{r:o,x1:n[2],y1:n[3],x2:a[0],y2:a[1],cx:d,cy:p,ac:r})}else{var f=n[2]==n[0]?0:n[2]>n[0]?i.lw/2:-i.lw/2,m=n[3]==n[1]?0:n[3]>n[1]?i.lw/2:-i.lw/2;e.addSegment("Straight",{x1:n[0]-f,y1:n[1]-m,x2:n[2]+f,y2:n[3]+m})}n=a}e.addSegment("Straight",{x1:a[0],y1:a[1],x2:a[2],y2:a[3]})};this.setSegments=function(t){s=t},this.isEditable=function(){return!0},this.getOriginalSegments=function(){return s||n},this._compute=function(t,l){if(l.clearEdits&&(s=null),null==s){n=[],o=null,r=null;var c=t.startStubX+(t.endStubX-t.startStubX)*i,u=t.startStubY+(t.endStubY-t.startStubY)*i,h=function(e){return[t.startStubX,t.startStubY,t.endStubX,t.endStubY]},f={perpendicular:h,orthogonal:h,opposite:function(e){var i=t,n="x"==e?0:1;return!a&&{x:function(){return 1==i.so[n]&&(i.startStubX>i.endStubX&&i.tx>i.startStubX||i.sx>i.endStubX&&i.tx>i.sx)||-1==i.so[n]&&(i.startStubX<i.endStubX&&i.tx<i.startStubX||i.sx<i.endStubX&&i.tx<i.sx)},y:function(){return 1==i.so[n]&&(i.startStubY>i.endStubY&&i.ty>i.startStubY||i.sy>i.endStubY&&i.ty>i.sy)||-1==i.so[n]&&(i.startStubY<i.endStubY&&i.ty<i.startStubY||i.sy<i.endStubY&&i.ty<i.sy)}}[e]()?{x:[(t.sx+t.tx)/2,t.startStubY,(t.sx+t.tx)/2,t.endStubY],y:[t.startStubX,(t.sy+t.ty)/2,t.endStubX,(t.sy+t.ty)/2]}[e]:[t.startStubX,t.startStubY,t.endStubX,t.endStubY]}},m={perpendicular:function(e,i,n,a,s){var o={x:[[t.startStubX,t.endStubX],null,[t.endStubX,t.startStubX]],y:[[t.startStubY,t.endStubY],null,[t.endStubY,t.startStubY]]},r=(t.midx,t.startStubY,t.midx,t.endStubY,t.startStubX,t.midy,t.endStubX,t.midy,t.endStubX,t.startStubY,t.startStubX,t.endStubY,t.startStubX,t.endStubY,t.endStubX,t.endStubY,t.endStubX,t.startStubY,t.endStubX,t.endStubY,t.startStubX,t.midy,t.endStubX,t.midy,t.endStubX,t.endStubY,t.midx,t.startStubY,t.midx,t.endStubY,t.endStubX,t.endStubY,{x:[t.startStubY,t.endStubY],y:[t.startStubX,t.endStubX]}),l=t.orientations,c=t.so,d=t.to,u=l[e][0],h=l[e][1],p=c[u]+1,f=d[h]+1;-1==d[h]&&r[e][1]<r[e][0]||1==d[h]&&(r[e][1],r[e][0]),o[e][p][0],o[e][p][1],{x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]}[e][p][f]},orthogonal:function(e,i,n,a,s){var o=t,r={x:-1==o.so[0]?Math.min(i,a):Math.max(i,a),y:-1==o.so[1]?Math.min(i,a):Math.max(i,a)}[e];return{x:[[r,n],[r,s],[a,s]],y:[[n,r],[s,r],[s,a]]}[e]},opposite:function(i,n,a,s,o){var r=t,d={x:"y",y:"x"}[i],h={x:"height",y:"width"}[i],p=r["is"+i.toUpperCase()+"GreaterThanStubTimes2"];if(l.sourceEndpoint.elementId==l.targetEndpoint.elementId){var f=a+(1-l.sourceEndpoint.anchor[d])*l.sourceInfo[h]+e.maxStub;return{x:[[n,f],[s,f]],y:[[f,n],[f,s]]}[i]}return!p||1==r.so[v]&&n>s||-1==r.so[v]&&n<s?{x:[[n,u],[s,u]],y:[[c,n],[c,s]]}[i]:1==r.so[v]&&n<s||-1==r.so[v]&&n>s?{x:[[c,r.sy],[c,r.ty]],y:[[r.sx,u],[r.tx,u]]}[i]:void 0}},g=f[t.anchorOrientation](t.sourceAxis),v="x"==t.sourceAxis?0:1,b="x"==t.sourceAxis?1:0,y=g[v],_=g[b],x=g[v+2],w=g[b+2];d(n,g[0],g[1],t);var C=m[t.anchorOrientation](t.sourceAxis,y,_,x,w);if(C)for(var k=0;k<C.length;k++)d(n,C[k][0],C[k][1],t);d(n,g[2],g[3],t),d(n,t.tx,t.ty,t),p(n,t)}else p(s,t)},this.getPath=function(){for(var t=null,e=null,i=[],a=s||n,o=0;o<a.length;o++){var r=a[o],l=r[4],c="v"==l?3:2;null!=t&&e===l?t[c]=r[c]:r[0]==r[2]&&r[1]==r[3]||(i.push({start:[r[0],r[1]],end:[r[2],r[3]]}),t=r,e=r[4])}return i},this.setPath=function(t){s=[];for(var e=0;e<t.length;e++){var i=t[e].start[0],n=t[e].start[1],a=t[e].end[0],o=t[e].end[1],r=i==a?"v":"h",l=c(a-i),d=c(o-n);s.push([i,n,a,o,r,l,d])}}},function(){var t={"stroke-linejoin":"joinstyle",joinstyle:"joinstyle",endcap:"endcap",miterlimit:"miterlimit"},e=null;if(document.createStyleSheet&&document.namespaces){var i=[".jsplumb_vml","jsplumb\\:textbox","jsplumb\\:oval","jsplumb\\:rect","jsplumb\\:stroke","jsplumb\\:shape","jsplumb\\:group"];e=document.createStyleSheet();for(var n=0;n<i.length;n++)e.addRule(i[n],"behavior:url(#default#VML);position:absolute;");document.namespaces.add("jsplumb","urn:schemas-microsoft-com:vml")}jsPlumb.vml={};var a=1e3,s=function(t,e){for(var i in e)t[i]=e[i]},o=function(t,e,i,n,a,o){i=i||{};var l=document.createElement("jsplumb:"+t);return o?a.appendElement(l,n):jsPlumb.CurrentLibrary.appendElement(l,n),l.className=(i.class?i.class+" ":"")+"jsplumb_vml",r(l,e),s(l,i),l},r=function(t,e,i){t.style.left=e[0]+"px",t.style.top=e[1]+"px",t.style.width=e[2]+"px",t.style.height=e[3]+"px",t.style.position="absolute",i&&(t.style.zIndex=i)},l=jsPlumb.vml.convertValue=function(t){return Math.floor(t*a)},c=function(t,e,i,n){"transparent"===e?n.setOpacity(i,"0.0"):n.setOpacity(i,"1.0")},d=function(t,e,i,n){var a={};if(e.strokeStyle){a.stroked="true";var r=jsPlumbUtil.convertStyle(e.strokeStyle,!0);a.strokecolor=r,c(0,r,"stroke",i),a.strokeweight=e.lineWidth+"px"}else a.stroked="false";if(e.fillStyle){a.filled="true";var l=jsPlumbUtil.convertStyle(e.fillStyle,!0);a.fillcolor=l,c(0,l,"fill",i)}else a.filled="false";if(e.dashstyle)null==i.strokeNode?i.strokeNode=o("stroke",[0,0,0,0],{dashstyle:e.dashstyle},t,n):i.strokeNode.dashstyle=e.dashstyle;else if(e["stroke-dasharray"]&&e.lineWidth){for(var d=-1==e["stroke-dasharray"].indexOf(",")?" ":",",u=e["stroke-dasharray"].split(d),h="",p=0;p<u.length;p++)h+=Math.floor(u[p]/e.lineWidth)+d;null==i.strokeNode?i.strokeNode=o("stroke",[0,0,0,0],{dashstyle:h},t,n):i.strokeNode.dashstyle=h}s(t,a)},u=function(){var t=this;jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.opacityNodes={stroke:null,fill:null},this.initOpacityNodes=function(e){t.opacityNodes.stroke=o("stroke",[0,0,1,1],{opacity:"0.0"},e,t._jsPlumb),t.opacityNodes.fill=o("fill",[0,0,1,1],{opacity:"0.0"},e,t._jsPlumb)},this.setOpacity=function(e,i){var n=t.opacityNodes[e];n&&(n.opacity=""+i)};var e=[];this.getDisplayElements=function(){return e},this.appendDisplayElement=function(i,n){n||t.canvas.parentNode.appendChild(i),e.push(i)}},h=(jsPlumb.ConnectorRenderers.vml=function(e){var i=this;i.strokeNode=null,i.canvas=null;u.apply(this,arguments);var n=i._jsPlumb.connectorClass+(e.cssClass?" "+e.cssClass:"");this.paint=function(l){if(null!==l){for(var c=i.getSegments(),u={path:""},h=[i.x,i.y,i.w,i.h],p=0;p<c.length;p++)u.path+=jsPlumb.Segments.vml.SegmentRenderer.getPath(c[p]),u.path+=" ";if(l.outlineColor){var f=l.outlineWidth||1,m=l.lineWidth+2*f,g={strokeStyle:jsPlumbUtil.convertStyle(l.outlineColor),lineWidth:m};for(var v in t)g[v]=l[v];null==i.bgCanvas?(u.class=n,u.coordsize=h[2]*a+","+h[3]*a,i.bgCanvas=o("shape",h,u,e.parent,i._jsPlumb,!0),r(i.bgCanvas,h),i.appendDisplayElement(i.bgCanvas,!0),i.attachListeners(i.bgCanvas,i),i.initOpacityNodes(i.bgCanvas,["stroke"])):(u.coordsize=h[2]*a+","+h[3]*a,r(i.bgCanvas,h),s(i.bgCanvas,u)),d(i.bgCanvas,g,i)}null==i.canvas?(u.class=n,u.coordsize=h[2]*a+","+h[3]*a,i.canvas=o("shape",h,u,e.parent,i._jsPlumb,!0),i.appendDisplayElement(i.canvas,!0),i.attachListeners(i.canvas,i),i.initOpacityNodes(i.canvas,["stroke"])):(u.coordsize=h[2]*a+","+h[3]*a,r(i.canvas,h),s(i.canvas,u)),d(i.canvas,l,i,i._jsPlumb)}},this.reattachListeners=function(){i.canvas&&i.reattachListenersForElement(i.canvas,i)}},window.VmlEndpoint=function(t){u.apply(this,arguments);var e=null,i=this;i.canvas=document.createElement("div"),i.canvas.style.position="absolute";var n=i._jsPlumb.endpointClass+(t.cssClass?" "+t.cssClass:"");t._jsPlumb.appendElement(i.canvas,t.parent),this.paint=function(t,a){var o={};jsPlumb.sizeCanvas(i.canvas,i.x,i.y,i.w,i.h),null==e?(o.class=n,e=i.getVml([0,0,i.w,i.h],o,a,i.canvas,i._jsPlumb),i.attachListeners(e,i),i.appendDisplayElement(e,!0),i.appendDisplayElement(i.canvas,!0),i.initOpacityNodes(e,["fill"])):(r(e,[0,0,i.w,i.h]),s(e,o)),d(e,t,i)},this.reattachListeners=function(){e&&i.reattachListenersForElement(e,i)}});jsPlumb.Segments.vml={SegmentRenderer:{getPath:function(t){return{Straight:function(t){var e=t.params;return"m"+l(e.x1)+","+l(e.y1)+" l"+l(e.x2)+","+l(e.y2)+" e"},Bezier:function(t){var e=t.params;return"m"+l(e.x1)+","+l(e.y1)+" c"+l(e.cp1x)+","+l(e.cp1y)+","+l(e.cp2x)+","+l(e.cp2y)+","+l(e.x2)+","+l(e.y2)+" e"},Arc:function(t){var e,i=t.params,n=Math.min(i.x1,i.x2),a=(Math.max(i.x1,i.x2),Math.min(i.y1,i.y2)),s=(Math.max(i.y1,i.y2),t.anticlockwise?1:0);return(t.anticlockwise?"at ":"wa ")+(e=[null,[function(){return[n,a]},function(){return[n-i.r,a-i.r]}],[function(){return[n-i.r,a]},function(){return[n,a-i.r]}],[function(){return[n-i.r,a-i.r]},function(){return[n,a]}],[function(){return[n,a-i.r]},function(){return[n-i.r,a]}]][t.segment][s](),l(e[0])+","+l(e[1])+","+l(e[0]+2*i.r)+","+l(e[1]+2*i.r)+",")+l(i.x1)+","+l(i.y1)+","+l(i.x2)+","+l(i.y2)+" e"}}[t.type](t)}}},jsPlumb.Endpoints.vml.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments),h.apply(this,arguments),this.getVml=function(t,e,i,n,a){return o("oval",t,e,n,a)}},jsPlumb.Endpoints.vml.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments),h.apply(this,arguments),this.getVml=function(t,e,i,n,a){return o("rect",t,e,n,a)}},jsPlumb.Endpoints.vml.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.vml.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.vml.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.vml.Custom=jsPlumb.Overlays.Custom;var p=function(t,e){t.apply(this,e),u.apply(this,e);var i=this;i.canvas=null,i.isAppendedAtTopLevel=!0;this.paint=function(t,n){var c={},d=t.d,u=t.component;t.strokeStyle&&(c.stroked="true",c.strokecolor=jsPlumbUtil.convertStyle(t.strokeStyle,!0)),t.lineWidth&&(c.strokeweight=t.lineWidth+"px"),t.fillStyle&&(c.filled="true",c.fillcolor=t.fillStyle);var h=Math.min(d.hxy.x,d.tail[0].x,d.tail[1].x,d.cxy.x),p=Math.min(d.hxy.y,d.tail[0].y,d.tail[1].y,d.cxy.y),f=Math.max(d.hxy.x,d.tail[0].x,d.tail[1].x,d.cxy.x),m=Math.max(d.hxy.y,d.tail[0].y,d.tail[1].y,d.cxy.y),g=[h,p,Math.abs(f-h),Math.abs(m-p)];if(c.path=function(t){return"m "+l(t.hxy.x)+","+l(t.hxy.y)+" l "+l(t.tail[0].x)+","+l(t.tail[0].y)+" "+l(t.cxy.x)+","+l(t.cxy.y)+" "+l(t.tail[1].x)+","+l(t.tail[1].y)+" x e"}(d),c.coordsize=u.w*a+","+u.h*a,g[0]=u.x,g[1]=u.y,g[2]=u.w,g[3]=u.h,null==i.canvas){var v=u._jsPlumb.overlayClass||"",b=e&&1==e.length&&e[0].cssClass||"";c.class=b+" "+v,i.canvas=o("shape",g,c,u.canvas.parentNode,u._jsPlumb,!0),u.appendDisplayElement(i.canvas,!0),i.attachListeners(i.canvas,u),i.attachListeners(i.canvas,i)}else r(i.canvas,g),s(i.canvas,c)},this.reattachListeners=function(){i.canvas&&i.reattachListenersForElement(i.canvas,i)},this.cleanup=function(){null!=i.canvas&&jsPlumb.CurrentLibrary.removeElement(i.canvas)}};jsPlumb.Overlays.vml.Arrow=function(){p.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumb.Overlays.vml.PlainArrow=function(){p.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumb.Overlays.vml.Diamond=function(){p.apply(this,[jsPlumb.Overlays.Diamond,arguments])}}(),function(){var t={joinstyle:"stroke-linejoin","stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},e="stroke-dasharray",i="dashstyle",n="linearGradient",a="radialGradient",s="fill",o="stroke",r="style",l="none",c="http://www.w3.org/2000/svg",d="http://www.w3.org/1999/xhtml",u=function(t,e){for(var i in e)t.setAttribute(i,""+e[i])},h=function(t,e){var i=document.createElementNS(c,t);return(e=e||{}).version="1.1",e.xmlns=d,u(i,e),i},p=function(t){return"position:absolute;left:"+t[0]+"px;top:"+t[1]+"px"},f=function(t){for(var e=0;e<t.childNodes.length;e++)t.childNodes[e].tagName!=n&&t.childNodes[e].tagName!=a||t.removeChild(t.childNodes[e])},m=function(c,d,u,p,m){if(u.gradient?function(t,e,i,l,c){var d,u="jsplumb_gradient_"+c._jsPlumb.idstamp();f(t),d=i.gradient.offset?h(a,{id:u}):h(n,{id:u,gradientUnits:"userSpaceOnUse"}),t.appendChild(d);for(var p=0;p<i.gradient.stops.length;p++){var m=1==c.segment||2==c.segment?p:i.gradient.stops.length-1-p,g=jsPlumbUtil.convertStyle(i.gradient.stops[m][1],!0),v=h("stop",{offset:Math.floor(100*i.gradient.stops[p][0])+"%","stop-color":g});d.appendChild(v)}var b=i.strokeStyle?o:s;e.setAttribute(r,b+":url(#"+u+")")}(c,d,u,0,m):(f(c),d.setAttribute(r,"")),d.setAttribute(s,u.fillStyle?jsPlumbUtil.convertStyle(u.fillStyle,!0):l),d.setAttribute(o,u.strokeStyle?jsPlumbUtil.convertStyle(u.strokeStyle,!0):l),u.lineWidth&&d.setAttribute("stroke-width",u.lineWidth),u[i]&&u.lineWidth&&!u[e]){var g=-1==u[i].indexOf(",")?" ":",",v=u[i].split(g),b="";v.forEach((function(t){b+=Math.floor(t*u.lineWidth)+g})),d.setAttribute(e,b)}else u[e]&&d.setAttribute(e,u[e]);for(var y in t)u[y]&&d.setAttribute(t[y],u[y])},g=function(t,e,i){for(var n=i.split(" "),a=t.className.baseVal.split(" "),s=0;s<n.length;s++)if(e)-1==a.indexOf(n[s])&&a.push(n[s]);else{var o=a.indexOf(n[s]);-1!=o&&a.splice(o,1)}t.className.baseVal=a.join(" ")},v=function(t,e,i){t.childNodes.length>i?t.insertBefore(e,t.childNodes[i]):t.appendChild(e)};jsPlumbUtil.svg={addClass:function(t,e){g(t,!0,e)},removeClass:function(t,e){g(t,!1,e)},node:h,attr:u,pos:p};var b=function(t){var e=this,i=t.pointerEventsSpec||"all",n={};jsPlumb.jsPlumbUIComponent.apply(this,t.originalArgs),e.canvas=null,e.path=null,e.svg=null;var a=t.cssClass+" "+(t.originalArgs[0].cssClass||""),s={style:"",width:0,height:0,"pointer-events":i,position:"absolute"};e.svg=h("svg",s),t.useDivWrapper?(e.canvas=document.createElement("div"),e.canvas.style.position="absolute",jsPlumb.sizeCanvas(e.canvas,0,0,1,1),e.canvas.className=a):(u(e.svg,{class:a}),e.canvas=e.svg),t._jsPlumb.appendElement(e.canvas,t.originalArgs[0].parent),t.useDivWrapper&&e.canvas.appendChild(e.svg);var o=[e.canvas];return this.getDisplayElements=function(){return o},this.appendDisplayElement=function(t){o.push(t)},this.paint=function(i,a,s){if(null!=i){var o,r=[e.x,e.y],l=[e.w,e.h];null!=s&&(s.xmin<0&&(r[0]+=s.xmin),s.ymin<0&&(r[1]+=s.ymin),l[0]=s.xmax+(s.xmin<0?-s.xmin:0),l[1]=s.ymax+(s.ymin<0?-s.ymin:0)),t.useDivWrapper?(jsPlumb.sizeCanvas(e.canvas,r[0],r[1],l[0],l[1]),r[0]=0,r[1]=0,o=p([0,0])):o=p([r[0],r[1]]),n.paint.apply(this,arguments),u(e.svg,{style:o,width:l[0],height:l[1]})}},{renderer:n}};jsPlumb.ConnectorRenderers.svg=function(t){var e=this;b.apply(this,[{cssClass:t._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:t._jsPlumb}]).renderer.paint=function(i,n,a){var s=e.getSegments(),o="",r=[0,0];a.xmin<0&&(r[0]=-a.xmin),a.ymin<0&&(r[1]=-a.ymin);for(var l=0;l<s.length;l++)o+=jsPlumb.Segments.svg.SegmentRenderer.getPath(s[l]),o+=" ";var c={d:o,transform:"translate("+r[0]+","+r[1]+")","pointer-events":t["pointer-events"]||"visibleStroke"},d=null;e.x,e.y,e.w,e.h;if(i.outlineColor){var p=i.outlineWidth||1,f=i.lineWidth+2*p;(d=jsPlumb.CurrentLibrary.extend({},i)).strokeStyle=jsPlumbUtil.convertStyle(i.outlineColor),d.lineWidth=f,null==e.bgPath?(e.bgPath=h("path",c),v(e.svg,e.bgPath,0),e.attachListeners(e.bgPath,e)):u(e.bgPath,c),m(e.svg,e.bgPath,d,0,e)}null==e.path?(e.path=h("path",c),v(e.svg,e.path,i.outlineColor?1:0),e.attachListeners(e.path,e)):u(e.path,c),m(e.svg,e.path,i,0,e)},this.reattachListeners=function(){e.bgPath&&e.reattachListenersForElement(e.bgPath,e),e.path&&e.reattachListenersForElement(e.path,e)}};jsPlumb.Segments.svg={SegmentRenderer:{getPath:function(t){return{Straight:function(){var e=t.getCoordinates();return"M "+e.x1+" "+e.y1+" L "+e.x2+" "+e.y2},Bezier:function(){var e=t.params;return"M "+e.x1+" "+e.y1+" C "+e.cp1x+" "+e.cp1y+" "+e.cp2x+" "+e.cp2y+" "+e.x2+" "+e.y2},Arc:function(){var e=t.params,i=t.sweep>Math.PI?1:0,n=t.anticlockwise?0:1;return"M"+t.x1+" "+t.y1+" A "+t.radius+" "+e.r+" 0 "+i+","+n+" "+t.x2+" "+t.y2}}[t.type]()}}};var y=window.SvgEndpoint=function(t){var e=this;b.apply(this,[{cssClass:t._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:t._jsPlumb}]).renderer.paint=function(t){var i=jsPlumb.extend({},t);i.outlineColor&&(i.strokeWidth=i.outlineWidth,i.strokeStyle=jsPlumbUtil.convertStyle(i.outlineColor,!0)),null==e.node?(e.node=e.makeNode(i),e.svg.appendChild(e.node),e.attachListeners(e.node,e)):null!=e.updateNode&&e.updateNode(e.node),m(e.svg,e.node,i,(e.x,e.y,e.w,e.h),e),p(e.node,(e.x,e.y))},this.reattachListeners=function(){e.node&&e.reattachListenersForElement(e.node,e)}};jsPlumb.Endpoints.svg.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments),y.apply(this,arguments),this.makeNode=function(t){return h("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(t){u(t,{cx:this.w/2,cy:this.h/2,r:this.radius})}},jsPlumb.Endpoints.svg.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments),y.apply(this,arguments),this.makeNode=function(t){return h("rect",{width:this.w,height:this.h})},this.updateNode=function(t){u(t,{width:this.w,height:this.h})}},jsPlumb.Endpoints.svg.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.svg.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.svg.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.svg.Custom=jsPlumb.Overlays.Custom;var _=function(t,e){t.apply(this,e),jsPlumb.jsPlumbUIComponent.apply(this,e),this.isAppendedAtTopLevel=!1;var i=this,n=null;this.paint=function(t,s){if(t.component.svg&&s){null==n&&(n=h("path",{"pointer-events":"all"}),t.component.svg.appendChild(n),i.attachListeners(n,t.component),i.attachListeners(n,i));var o=e&&1==e.length&&e[0].cssClass||"",r=[0,0];s.xmin<0&&(r[0]=-s.xmin),s.ymin<0&&(r[1]=-s.ymin),u(n,{d:a(t.d),class:o,stroke:t.strokeStyle?t.strokeStyle:null,fill:t.fillStyle?t.fillStyle:null,transform:"translate("+r[0]+","+r[1]+")"})}};var a=function(t){return"M"+t.hxy.x+","+t.hxy.y+" L"+t.tail[0].x+","+t.tail[0].y+" L"+t.cxy.x+","+t.cxy.y+" L"+t.tail[1].x+","+t.tail[1].y+" L"+t.hxy.x+","+t.hxy.y};this.reattachListeners=function(){n&&i.reattachListenersForElement(n,i)},this.cleanup=function(){null!=n&&jsPlumb.CurrentLibrary.removeElement(n)}};jsPlumb.Overlays.svg.Arrow=function(){_.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumb.Overlays.svg.PlainArrow=function(){_.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumb.Overlays.svg.Diamond=function(){_.apply(this,[jsPlumb.Overlays.Diamond,arguments])},jsPlumb.Overlays.svg.GuideLines=function(){var t,e,i=null,n=this;jsPlumb.Overlays.GuideLines.apply(this,arguments),this.paint=function(s,o){null==i&&(i=h("path"),s.connector.svg.appendChild(i),n.attachListeners(i,s.connector),n.attachListeners(i,n),t=h("path"),s.connector.svg.appendChild(t),n.attachListeners(t,s.connector),n.attachListeners(t,n),e=h("path"),s.connector.svg.appendChild(e),n.attachListeners(e,s.connector),n.attachListeners(e,n));var r=[0,0];o.xmin<0&&(r[0]=-o.xmin),o.ymin<0&&(r[1]=-o.ymin),u(i,{d:a(s.head,s.tail),stroke:"red",fill:null,transform:"translate("+r[0]+","+r[1]+")"}),u(t,{d:a(s.tailLine[0],s.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+r[0]+","+r[1]+")"}),u(e,{d:a(s.headLine[0],s.headLine[1]),stroke:"green",fill:null,transform:"translate("+r[0]+","+r[1]+")"})};var a=function(t,e){return"M "+t.x+","+t.y+" L"+e.x+","+e.y}}}(),function(t){var e=function(e){return t("string"==typeof e?"#"+e:e)};jsPlumb.CurrentLibrary={addClass:function(t,i){t=e(t);try{t[0].className.constructor==SVGAnimatedString&&jsPlumbUtil.svg.addClass(t[0],i)}catch(t){}try{t.addClass(i)}catch(t){}},animate:function(t,e,i){t.animate(e,i)},appendElement:function(t,i){e(i).append(t)},ajax:function(e){(e=e||{}).type=e.type||"get",t.ajax(e)},bind:function(t,i,n){(t=e(t)).bind(i,n)},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete"},extend:function(e,i){return t.extend(e,i)},getAttribute:function(t,e){return t.attr(e)},getClientXY:function(t){return[t.clientX,t.clientY]},getDragObject:function(t){return t[1].draggable||t[1].helper},getDragScope:function(t){return t.draggable("option","scope")},getDropEvent:function(t){return t[0]},getDropScope:function(t){return t.droppable("option","scope")},getDOMElement:function(t){return"string"==typeof t?document.getElementById(t):t.context||null!=t.length?t[0]:t},getElementObject:e,getOffset:function(t){return t.offset()},getOriginalEvent:function(t){return t.originalEvent},getPageXY:function(t){return[t.pageX,t.pageY]},getParent:function(t){return e(t).parent()},getScrollLeft:function(t){return t.scrollLeft()},getScrollTop:function(t){return t.scrollTop()},getSelector:function(i,n){return 2==arguments.length?e(i).find(n):t(i)},getSize:function(t){return[t.outerWidth(),t.outerHeight()]},getTagName:function(t){var i=e(t);return i.length>0?i[0].tagName:null},getUIPosition:function(t,e){if(e=e||1,1==t.length)ret={left:t[0].pageX,top:t[0].pageY};else{var i=t[1],n=i.offset;ret=n||i.absolutePosition,i.position.left/=e,i.position.top/=e}return{left:ret.left/e,top:ret.top/e}},hasClass:function(t,e){return t.hasClass(e)},initDraggable:function(t,e,i,n){(e=e||{}).doNotRemoveHelper||(e.helper=null),i&&(e.scope=e.scope||jsPlumb.Defaults.Scope),t.draggable(e)},initDroppable:function(t,e){e.scope=e.scope||jsPlumb.Defaults.Scope,t.droppable(e)},isAlreadyDraggable:function(t){return e(t).hasClass("ui-draggable")},isDragSupported:function(t,e){return t.draggable},isDropSupported:function(t,e){return t.droppable},removeClass:function(t,i){t=e(t);try{if(t[0].className.constructor==SVGAnimatedString)return void jsPlumbUtil.svg.removeClass(t[0],i)}catch(t){}t.removeClass(i)},removeElement:function(t){e(t).remove()},setAttribute:function(t,e,i){t.attr(e,i)},setDragFilter:function(t,e){jsPlumb.CurrentLibrary.isAlreadyDraggable(t)&&t.draggable("option","cancel",e)},setDraggable:function(t,e){t.draggable("option","disabled",!e)},setDragScope:function(t,e){t.draggable("option","scope",e)},setOffset:function(t,i){e(t).offset(i)},trigger:function(t,i,n){jQuery._data(e(t)[0],"handle")(n)},unbind:function(t,i,n){(t=e(t)).unbind(i,n)}},t(document).ready(jsPlumb.init)}(jQuery),function(){void 0===Math.sgn&&(Math.sgn=function(t){return 0==t?0:0<t?1:-1});var t=function(t,e){return{x:t.x-e.x,y:t.y-e.y}},e=function(t,e){return t.x*e.x+t.y*e.y},i=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},n=function(t,e){return{x:t.x*e,y:t.y*e}},a=Math.pow(2,-65),s=function(a,s){for(var l=[],c=s.length-1,d=2*c-1,u=[],h=[],p=[],f=[],m=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],g=0;g<=c;g++)u[g]=t(s[g],a);for(g=0;g<=c-1;g++)h[g]=t(s[g+1],s[g]),h[g]=n(h[g],3);for(g=0;g<=c-1;g++)for(var v=0;v<=c;v++)p[g]||(p[g]=[]),p[g][v]=e(h[g],u[v]);for(g=0;g<=d;g++)f[g]||(f[g]=[]),f[g].y=0,f[g].x=parseFloat(g)/d;for(d=c-1,u=0;u<=c+d;u++)for(g=Math.max(0,u-d),h=Math.min(u,c);g<=h;g++)j=u-g,f[g+j].y+=p[j][g]*m[j][g];for(c=s.length-1,f=o(f,2*c-1,l,0),d=t(a,s[0]),p=i(d),g=m=0;g<f;g++)d=t(a,r(s,c,l[g],null,null)),(d=i(d))<p&&(p=d,m=l[g]);return d=t(a,s[c]),(d=i(d))<p&&(p=d,m=1),{location:m,distance:p}},o=function(t,e,i,n){var s,l,c=[],d=[],u=[],h=[],p=0;l=Math.sgn(t[0].y);for(var f=1;f<=e;f++)(s=Math.sgn(t[f].y))!=l&&p++,l=s;switch(p){case 0:return 0;case 1:if(64<=n)return i[0]=(t[0].x+t[e].x)/2,1;var m,g;p=t[0].y-t[e].y;for(l=t[e].x-t[0].x,f=t[0].x*t[e].y-t[e].x*t[0].y,s=max_distance_below=0,m=1;m<e;m++)(g=p*t[m].x+l*t[m].y+f)>s?s=g:g<max_distance_below&&(max_distance_below=g);if(s=1/(m=0*(g=l)-1*p)*(1*(f-s)-0*g),p=1/(m=0*(g=l)-1*p)*(1*(l=f-max_distance_below)-0*g),l=Math.min(s,p),Math.max(s,p)-l<a)return u=t[e].x-t[0].x,h=t[e].y-t[0].y,i[0]=0+1*(u*(t[0].y-0)-h*(t[0].x-0))*(1/(0*u-1*h)),1}for(r(t,e,.5,c,d),t=o(c,e,u,n+1),e=o(d,e,h,n+1),n=0;n<t;n++)i[n]=u[n];for(n=0;n<e;n++)i[n+t]=h[n];return t+e},r=function(t,e,i,n,a){for(var s=[[]],o=0;o<=e;o++)s[0][o]=t[o];for(t=1;t<=e;t++)for(o=0;o<=e-t;o++)s[t]||(s[t]=[]),s[t][o]||(s[t][o]={}),s[t][o].x=(1-i)*s[t-1][o].x+i*s[t-1][o+1].x,s[t][o].y=(1-i)*s[t-1][o].y+i*s[t-1][o+1].y;if(null!=n)for(o=0;o<=e;o++)n[o]=s[o][0];if(null!=a)for(o=0;o<=e;o++)a[o]=s[e-o][o];return s[e][0]},l={},c=function(t,e){var i,n=t.length-1;if(!(i=l[n])){var a=function(t){return function(){return t}},s=function(){return function(t){return t}},o=function(){return function(t){return 1-t}},r=function(t){return function(e){for(var i=1,n=0;n<t.length;n++)i*=t[n](e);return i}};(i=[]).push(new function(){return function(t){return Math.pow(t,n)}});for(var c=1;c<n;c++){for(var d=[new a(n)],u=0;u<n-c;u++)d.push(new s);for(u=0;u<c;u++)d.push(new o);i.push(new r(d))}i.push(new function(){return function(t){return Math.pow(1-t,n)}}),l[n]=i}for(o=s=a=0;o<t.length;o++)a+=t[o].x*i[o](e),s+=t[o].y*i[o](e);return{x:a,y:s}},d=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},u=function(t){return t[0].x==t[1].x&&t[0].y==t[1].y},h=function(t,e,i){if(u(t))return{point:t[0],location:e};for(var n=c(t,e),a=0,s=0<i?1:-1,o=null;a<Math.abs(i);)o=c(t,e+=.005*s),a+=d(o,n),n=o;return{point:o,location:e}},p=function(t,e){var i=c(t,e),n=c(t.slice(0,t.length-1),e),a=n.y-i.y;i=n.x-i.x;return 0==a?1/0:Math.atan(a/i)};window.jsBezier={distanceFromCurve:s,gradientAtPoint:p,gradientAtPointAlongCurveFrom:function(t,e,i){return 1<(e=h(t,e,i)).location&&(e.location=1),0>e.location&&(e.location=0),p(t,e.location)},nearestPointOnCurve:function(t,e){var i=s(t,e);return{point:r(e,e.length-1,i.location,null,null),location:i.location}},pointOnCurve:c,pointAlongCurveFrom:function(t,e,i){return h(t,e,i).point},perpendicularToCurveAt:function(t,e,i,n){return e=h(t,e,null==n?0:n),t=p(t,e.location),n=Math.atan(-1/t),t=i/2*Math.sin(n),i=i/2*Math.cos(n),[{x:e.point.x+i,y:e.point.y+t},{x:e.point.x-i,y:e.point.y-t}]},locationAlongCurveFrom:function(t,e,i){return h(t,e,i).location},getLength:function(t){if(u(t))return 0;for(var e=c(t,0),i=0,n=0,a=null;1>n;)a=c(t,n+=.005),i+=d(a,e),e=a;return i}}}(),function($){$.fn.markItUp=function(settings,extraSettings){var method,params,options,ctrlKey,shiftKey,altKey;ctrlKey=shiftKey=altKey=!1,"string"==typeof settings&&(method=settings,params=extraSettings),options={id:"",nameSpace:"",root:"",previewHandler:!1,previewInWindow:"",previewInElement:"",previewAutoRefresh:!0,previewPosition:"after",previewTemplatePath:"~/templates/preview.html",previewParser:!1,previewParserPath:"",previewParserVar:"data",resizeHandle:!0,beforeInsert:"",afterInsert:"",onEnter:{},onShiftEnter:{},onCtrlEnter:{},onTab:{},markupSet:[{}]},$.extend(options,settings,extraSettings),options.root||$("script").each((function(t,e){miuScript=$(e).get(0).src.match(/(.*)jquery\.markitup(\.pack)?\.js$/),null!==miuScript&&(options.root=miuScript[1])}));var uaMatch=function(t){t=t.toLowerCase();var e=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:e[1]||"",version:e[2]||"0"}},matched=uaMatch(navigator.userAgent),browser={};return matched.browser&&(browser[matched.browser]=!0,browser.version=matched.version),browser.chrome?browser.webkit=!0:browser.webkit&&(browser.safari=!0),this.each((function(){var $$,textarea,levels,scrollPosition,caretPosition,caretOffset,clicked,hash,header,footer,previewWindow,template,iFrame,abort;if($$=$(this),textarea=this,levels=[],abort=!1,scrollPosition=caretPosition=0,caretOffset=-1,options.previewParserPath=localize(options.previewParserPath),options.previewTemplatePath=localize(options.previewTemplatePath),method)switch(method){case"remove":remove();break;case"insert":markup(params);break;default:$.error("Method "+method+" does not exist on jQuery.markItUp")}else init();function localize(t,e){return e?t.replace(/("|')~\//g,"$1"+options.root):t.replace(/^~\//,options.root)}function init(){id="",nameSpace="",options.id?id='id="'+options.id+'"':$$.attr("id")&&(id='id="markItUp'+$$.attr("id").substr(0,1).toUpperCase()+$$.attr("id").substr(1)+'"'),options.nameSpace&&(nameSpace='class="'+options.nameSpace+'"'),$$.wrap("<div "+nameSpace+"></div>"),$$.wrap("<div "+id+' class="markItUp"></div>'),$$.wrap('<div class="markItUpContainer"></div>'),$$.addClass("markItUpEditor"),header=$('<div class="markItUpHeader"></div>').insertBefore($$);var t=$(dropMenus(options.markupSet[0],"miu_basic"));t.append('<li class="txt_link fright li_miu_advanced"><span class="toggle_miu_advanced show_miu_advanced awesome-button" role="button">'+locaKeys.moreopts+"</span></li>"),t.appendTo(header),$(dropMenus(options.markupSet[1],"miu_advanced")).appendTo(header).hide(),footer=$('<div class="markItUpFooter"></div>').insertAfter($$),!0===options.resizeHandle&&!0!==browser.safari&&(resizeHandle=$('<div class="markItUpResizeHandle"></div>').insertAfter($$).bind("mousedown.markItUp",(function(t){var e,i,n=$$.height(),a=t.clientY;e=function(t){return $$.css("height",Math.max(20,t.clientY+n-a)+"px"),!1},i=function(t){return $("html").unbind("mousemove.markItUp",e).unbind("mouseup.markItUp",i),!1},$("html").bind("mousemove.markItUp",e).bind("mouseup.markItUp",i)})),footer.append(resizeHandle)),$$.bind("keydown.markItUp",keyPressed).bind("keyup",keyPressed),$$.bind("insertion.markItUp",(function(t,e){!1!==e.target&&get(),textarea===$.markItUp.focused&&markup(e)})),$$.bind("focus.markItUp",(function(){$.markItUp.focused=this})),options.previewInElement&&refreshPreview()}function dropMenus(markupSet,mSetClass){mSetClass||(mSetClass="");var ul=$('<ul class="'+mSetClass+'"></ul>'),i=0;return $.each(markupSet,(function(){var button=this,t="",title,li,j;if(title=button.key?(button.name||"")+" [Ctrl+"+button.key+"]":button.name||"",key=button.key?'accesskey="'+button.key+'"':"",button.separator)li=$('<li class="markItUpSeparator">'+(button.separator||"")+"</li>").appendTo(ul);else{for(i++,j=levels.length-1;j>=0;j--)t+=levels[j]+"-";if(li=$('<li class="markItUpButton markItUpButton'+t+i+" "+(button.className||"")+'"><a href="" '+key+' title="'+title+'">'+(button.name||"")+"</a></li>").bind("contextmenu.markItUp",(function(){return!1})).appendTo(ul),isMobile?li.bind("click.markItUp",(function(){return $(header).find("ul ul").hide(),$(this).find("> ul").length?$(this).find("> ul").show():(button.call&&eval(button.call)(),setTimeout((function(){markup(button)}),1)),!1})):li.unbind("click.markItUp").bind("click.markItUp",(function(){if(button.call)eval(button.call)();else{var $innerUL=$(">ul",li);if($innerUL.length>0){$innerUL.parents(".ui-dialog").find(".ui-dialog-titlebar-close").on("click",(function(){$innerUL.hide()})),$innerUL.addClass("markItUpOutpost"),$("body").append($innerUL);var randomId=Math.ceil(1e4*Math.random());li.attr("id","markitUpDropdown"+randomId),$innerUL.attr("rel","markitUpDropdown"+randomId),$innerUL.find(">li").bind("click.markItUp",(function(){$innerUL.hide(),li.attr("data-opened",0)})),$(window).on("resize",(function(t){repositionDropdowns($innerUL,li)}))}else $innerUL=$('body>ul[rel="'+li.attr("id")+'"]');$("html").one("click.markItUp2",(function(){$innerUL.hide(),li.attr("data-opened",0)})),repositionDropdowns($innerUL,li),$innerUL.filter(":visible").length?($innerUL.hide(),li.attr("data-opened",0)):($innerUL.show(),li.attr("data-opened",1))}return setTimeout((function(){markup(button)}),1),!1})).bind("focusin.markItUp",(function(){$$.focus()})),button.dropMenu){levels.push(i),$(li).addClass("markItUpDropMenu").append(dropMenus(button.dropMenu));var dropDownArr=$('<span class="dropdown_arr"></span>');$(li).append(dropDownArr)}}})),levels.pop(),ul}function repositionDropdowns(t,e){var i,n=t.outerHeight(),a=Math.ceil(e.offset().top);i=a+e.height()+n+$("#siteFooter").outerHeight()>=$(window).innerHeight()+$(window).scrollTop()?a-n-2:a+29,t.css({top:i,left:Math.floor(e.offset().left)})}function magicMarkups(t){return t?t=(t=(t=t.toString()).replace(/\(\!\(([\s\S]*?)\)\!\)/g,(function(t,e){var i=e.split("|!|");return!0===altKey?void 0!==i[1]?i[1]:i[0]:void 0===i[1]?"":i[0]}))).replace(/\[\!\[([\s\S]*?)\]\!\]/g,(function(t,e){var i=e.split(":!:");return!0!==abort&&(value=prompt(i[0],i[1]?i[1]:""),null===value&&(abort=!0),value)})):""}function prepare(t){return $.isFunction(t)&&(t=t(hash)),magicMarkups(t)}function build(t){var e=prepare(clicked.openWith),i=prepare(clicked.placeHolder),n=prepare(clicked.replaceWith),a=prepare(clicked.closeWith),s=prepare(clicked.openBlockWith),o=prepare(clicked.closeBlockWith),r=clicked.multiline;if(""!==n)block=e+n+a;else if(""===selection&&""!==i)block=e+i+a;else{var l=[t=t||selection],c=[];!0===r&&(l=t.split(/\r?\n/));for(var d=0;d<l.length;d++){var u;line=l[d],(u=line.match(/ *$/))?c.push(e+line.replace(/ *$/g,"")+a+u):c.push(e+line+a)}block=c.join("\n")}return block=s+block+o,{block:block,openBlockWith:s,openWith:e,replaceWith:n,placeHolder:i,closeWith:a,closeBlockWith:o}}function markup(t){var e,i,n,a;if(hash=clicked=t,get(),$.extend(hash,{line:"",root:options.root,textarea:textarea,selection:selection||"",caretPosition:caretPosition,ctrlKey:ctrlKey,shiftKey:shiftKey,altKey:altKey}),prepare(options.beforeInsert),prepare(clicked.beforeInsert),(!0===ctrlKey&&!0===shiftKey||!0===t.multiline)&&prepare(clicked.beforeMultiInsert),$.extend(hash,{line:1}),!0===ctrlKey&&!0===shiftKey){for(lines=selection.split(/\r?\n/),i=0,n=lines.length,a=0;a<n;a++)""!==$.trim(lines[a])?($.extend(hash,{line:++i,selection:lines[a]}),lines[a]=build(lines[a]).block):lines[a]="";string={block:lines.join("\n")},start=caretPosition,e=string.block.length+(browser.opera?n-1:0)}else!0===ctrlKey?(string=build(selection),start=caretPosition+string.openWith.length,e=string.block.length-string.openWith.length-string.closeWith.length,e-=string.block.match(/ $/)?1:0,e-=fixIeBug(string.block)):!0===shiftKey?(string=build(selection),start=caretPosition,e=string.block.length,e-=fixIeBug(string.block)):(string=build(selection),start=caretPosition+string.block.length,e=0,start-=fixIeBug(string.block));""===selection&&""===string.replaceWith&&(caretOffset+=fixOperaBug(string.block),start=caretPosition+string.openBlockWith.length+string.openWith.length,e=string.block.length-string.openBlockWith.length-string.openWith.length-string.closeWith.length-string.closeBlockWith.length,caretOffset=$$.val().substring(caretPosition,$$.val().length).length,caretOffset-=fixOperaBug($$.val().substring(0,caretPosition))),$.extend(hash,{caretPosition:caretPosition,scrollPosition:scrollPosition}),string.block!==selection&&!1===abort?(insert(string.block),set(start,e)):caretOffset=-1,get(),$.extend(hash,{line:"",selection:selection}),(!0===ctrlKey&&!0===shiftKey||!0===t.multiline)&&prepare(clicked.afterMultiInsert),prepare(clicked.afterInsert),prepare(options.afterInsert),previewWindow&&options.previewAutoRefresh&&refreshPreview(),shiftKey=altKey=ctrlKey=abort=!1}function fixOperaBug(t){return browser.opera?t.length-t.replace(/\n*/g,"").length:0}function fixIeBug(t){return browser.msie?t.length-t.replace(/\r*/g,"").length:0}function insert(t){document.selection?document.selection.createRange().text=t:textarea.value=textarea.value.substring(0,caretPosition)+t+textarea.value.substring(caretPosition+selection.length,textarea.value.length)}function set(t,e){if(textarea.createTextRange){if(browser.opera&&browser.version>=9.5&&0==e)return!1;range=textarea.createTextRange(),range.collapse(!0),range.moveStart("character",t),range.moveEnd("character",e),range.select()}else textarea.setSelectionRange&&textarea.setSelectionRange(t,t+e);textarea.scrollTop=scrollPosition,textarea.focus()}function get(){if(textarea.focus(),scrollPosition=textarea.scrollTop,document.selection)if(selection=document.selection.createRange().text,browser.msie){var t=document.selection.createRange(),e=t.duplicate();for(e.moveToElementText(textarea),caretPosition=-1;e.inRange(t);)e.moveStart("character"),caretPosition++}else caretPosition=textarea.selectionStart;else caretPosition=textarea.selectionStart,selection=textarea.value.substring(caretPosition,textarea.selectionEnd);return selection}function preview(){"function"==typeof options.previewHandler?previewWindow=!0:options.previewInElement?previewWindow=$(options.previewInElement):!previewWindow||previewWindow.closed?options.previewInWindow?(previewWindow=window.open("","preview",options.previewInWindow),$(window).unload((function(){previewWindow.close()}))):(iFrame=$('<iframe class="markItUpPreviewFrame"></iframe>'),"after"==options.previewPosition?iFrame.insertAfter(footer):iFrame.insertBefore(header),previewWindow=iFrame[iFrame.length-1].contentWindow||frame[iFrame.length-1]):!0===altKey&&(iFrame?iFrame.remove():previewWindow.close(),previewWindow=iFrame=!1),options.previewAutoRefresh||refreshPreview(),options.previewInWindow&&previewWindow.focus()}function refreshPreview(){renderPreview()}function renderPreview(){options.previewHandler&&"function"==typeof options.previewHandler?options.previewHandler($$.val()):options.previewParser&&"function"==typeof options.previewParser?writeInPreview(localize(options.previewParser($$.val()),1)):""!==options.previewParserPath?$.ajax({type:"POST",dataType:"text",global:!1,url:options.previewParserPath,data:options.previewParserVar+"="+encodeURIComponent($$.val()),success:function(t){writeInPreview(localize(t,1))}}):template||$.ajax({url:options.previewTemplatePath,dataType:"text",global:!1,success:function(t){writeInPreview(localize(t,1).replace(/<!-- content -->/g,$$.val()))}});return!1}function writeInPreview(t){if(options.previewInElement)$(options.previewInElement).html(t);else if(previewWindow&&previewWindow.document){try{sp=previewWindow.document.documentElement.scrollTop}catch(t){sp=0}previewWindow.document.open(),previewWindow.document.write(t),previewWindow.document.close(),previewWindow.document.documentElement.scrollTop=sp}}function keyPressed(t){if(shiftKey=t.shiftKey,altKey=t.altKey,ctrlKey=(!t.altKey||!t.ctrlKey)&&(t.ctrlKey||t.metaKey),"keydown"===t.type){if(!0===ctrlKey&&(li=$('a[accesskey="'+(13==t.keyCode?"\\n":String.fromCharCode(t.keyCode))+'"]',header).parent("li"),0!==li.length))return ctrlKey=!1,setTimeout((function(){li.triggerHandler("mouseup")}),1),!1;if(13===t.keyCode||10===t.keyCode)return!0===ctrlKey?(ctrlKey=!1,markup(options.onCtrlEnter),options.onCtrlEnter.keepDefault):!0===shiftKey?(shiftKey=!1,markup(options.onShiftEnter),options.onShiftEnter.keepDefault):(markup(options.onEnter),options.onEnter.keepDefault);if(9===t.keyCode)return 1!=shiftKey&&1!=ctrlKey&&1!=altKey&&(-1!==caretOffset?(get(),set(caretOffset=$$.val().length-caretOffset,0),caretOffset=-1,!1):(markup(options.onTab),options.onTab.keepDefault))}}function remove(){$$.unbind(".markItUp").removeClass("markItUpEditor"),$$.parent("div").parent("div.markItUp").parent("div").replaceWith($$),$$.data("markItUp",null)}}))},$.fn.markItUpRemove=function(){return this.each((function(){$(this).markItUp("remove")}))},$.markItUp=function(t){var e={target:!1};if($.extend(e,t),e.target)return $(e.target).each((function(){$(this).focus(),$(this).trigger("insertion",[e])}));$("textarea").trigger("insertion",[e])}}(jQuery),function(t){"function"==typeof define&&define.amd?define(["./jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}((function(t){function e(e){var o=e||window.event,r=l.call(arguments,1),c=0,u=0,h=0,p=0,f=0,m=0;if((e=t.event.fix(o)).type="mousewheel","detail"in o&&(h=-1*o.detail),"wheelDelta"in o&&(h=o.wheelDelta),"wheelDeltaY"in o&&(h=o.wheelDeltaY),"wheelDeltaX"in o&&(u=-1*o.wheelDeltaX),"axis"in o&&o.axis===o.HORIZONTAL_AXIS&&(u=-1*h,h=0),c=0===h?u:h,"deltaY"in o&&(c=h=-1*o.deltaY),"deltaX"in o&&(u=o.deltaX,0===h&&(c=-1*u)),0!==h||0!==u){if(1===o.deltaMode){var g=t.data(this,"mousewheel-line-height");c*=g,h*=g,u*=g}else if(2===o.deltaMode){var v=t.data(this,"mousewheel-page-height");c*=v,h*=v,u*=v}if(p=Math.max(Math.abs(h),Math.abs(u)),(!s||s>p)&&(s=p,n(o,p)&&(s/=40)),n(o,p)&&(c/=40,u/=40,h/=40),c=Math[c>=1?"floor":"ceil"](c/s),u=Math[u>=1?"floor":"ceil"](u/s),h=Math[h>=1?"floor":"ceil"](h/s),d.settings.normalizeOffset&&this.getBoundingClientRect){var b=this.getBoundingClientRect();f=e.clientX-b.left,m=e.clientY-b.top}return e.deltaX=u,e.deltaY=h,e.deltaFactor=s,e.offsetX=f,e.offsetY=m,e.deltaMode=0,r.unshift(e,c,u,h),a&&clearTimeout(a),a=setTimeout(i,200),(t.event.dispatch||t.event.handle).apply(this,r)}}function i(){s=null}function n(t,e){return d.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}var a,s,o=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],r="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(t.event.fixHooks)for(var c=o.length;c;)t.event.fixHooks[o[--c]]=t.event.mouseHooks;var d=t.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var i=r.length;i;)this.addEventListener(r[--i],e,!1);else this.onmousewheel=e;t.data(this,"mousewheel-line-height",d.getLineHeight(this)),t.data(this,"mousewheel-page-height",d.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var i=r.length;i;)this.removeEventListener(r[--i],e,!1);else this.onmousewheel=null;t.removeData(this,"mousewheel-line-height"),t.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var i=t(e),n=i["offsetParent"in t.fn?"offsetParent":"parent"]();return n.length||(n=t("body")),parseInt(n.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})})),function($){$.extend({tablesorter:new function(){var parsers=[],widgets=[];function benchmark(t,e){log(t+","+((new Date).getTime()-e.getTime())+"ms")}function log(t){"undefined"!=typeof console&&void 0!==console.debug?console.log(t):alert(t)}function buildParserCache(t,e){if(t.config.debug)var i="";if(0!=t.tBodies.length){var n=t.tBodies[0].rows;if(n[0])for(var a=[],s=n[0].cells.length,o=0;o<s;o++){var r=!1;$.metadata&&$(e[o]).metadata()&&$(e[o]).metadata().sorter?r=getParserById($(e[o]).metadata().sorter):t.config.headers[o]&&t.config.headers[o].sorter&&(r=getParserById(t.config.headers[o].sorter)),r||(r=detectParserForColumn(t,n,-1,o)),t.config.debug&&(i+="column:"+o+" parser:"+r.id+"\n"),a.push(r)}return t.config.debug&&log(i),a}}function detectParserForColumn(t,e,i,n){for(var a=parsers.length,s=!1,o=!1,r=!0;""==o&&r;)e[++i]?(s=getNodeFromRowAndCellIndex(e,i,n),o=trimAndGetNodeText(t.config,s),t.config.debug&&log("Checking if value was empty on row:"+i)):r=!1;for(var l=1;l<a;l++)if(parsers[l].is(o,t,s))return parsers[l];return parsers[0]}function getNodeFromRowAndCellIndex(t,e,i){return t[e].cells[i]}function trimAndGetNodeText(t,e){return $.trim(getElementText(t,e))}function getParserById(t){for(var e=parsers.length,i=0;i<e;i++)if(parsers[i].id.toLowerCase()==t.toLowerCase())return parsers[i];return!1}function buildCache(t){if(t.config.debug)var e=new Date;for(var i=t.tBodies[0]&&t.tBodies[0].rows.length||0,n=t.tBodies[0].rows[0]&&t.tBodies[0].rows[0].cells.length||0,a=t.config.parsers,s={row:[],normalized:[]},o=0;o<i;++o){var r=$(t.tBodies[0].rows[o]),l=[];if(r.hasClass(t.config.cssChildRow))s.row[s.row.length-1]=s.row[s.row.length-1].add(r);else{s.row.push(r);for(var c=0;c<n;++c)l.push(a[c].format(getElementText(t.config,r[0].cells[c]),t,r[0].cells[c]));l.push(s.normalized.length),s.normalized.push(l),l=null}}return t.config.debug&&benchmark("Building cache for "+i+" rows:",e),s}function getElementText(t,e){return e?(t.supportsTextContent||(t.supportsTextContent=e.textContent||!1),"simple"==t.textExtraction?t.supportsTextContent?e.textContent:e.childNodes[0]&&e.childNodes[0].hasChildNodes()?e.childNodes[0].innerHTML:e.innerHTML:"function"==typeof t.textExtraction?t.textExtraction(e):$(e).text()):""}function appendToTable(t,e){if(t.config.debug)var i=new Date;for(var n=e,a=n.row,s=n.normalized,o=s.length,r=s[0].length-1,l=$(t.tBodies[0]),c=[],d=0;d<o;d++){var u=s[d][r];if(c.push(a[u]),!t.config.appender)for(var h=a[u].length,p=0;p<h;p++)l[0].appendChild(a[u][p])}t.config.appender&&t.config.appender(t,c),c=null,t.config.debug&&benchmark("Rebuilt table:",i),applyWidget(t),setTimeout((function(){$(t).trigger("sortEnd")}),0)}function buildHeaders(t){if(t.config.debug)var e=new Date;$.metadata;var i=computeTableHeaderCellIndexes(t);return $tableHeaders=$(t.config.selectorHeaders,t).each((function(e){if(this.column=i[this.parentNode.rowIndex+"-"+this.cellIndex],this.order=formatSortingOrder(t.config.sortInitialOrder),this.count=this.order,(checkHeaderMetadata(this)||checkHeaderOptions(t,e))&&(this.sortDisabled=!0),checkHeaderOptionsSortingLocked(t,e)&&(this.order=this.lockedOrder=checkHeaderOptionsSortingLocked(t,e)),!this.sortDisabled){var n=$(this).addClass(t.config.cssHeader);t.config.onRenderHeader&&t.config.onRenderHeader.apply(n)}t.config.headerList[e]=this})),t.config.debug&&(benchmark("Built headers:",e),log($tableHeaders)),$tableHeaders}function computeTableHeaderCellIndexes(t){for(var e=[],i={},n=t.getElementsByTagName("THEAD")[0].getElementsByTagName("TR"),a=0;a<n.length;a++)for(var s=n[a].cells,o=0;o<s.length;o++){var r,l=s[o],c=l.parentNode.rowIndex,d=c+"-"+l.cellIndex,u=l.rowSpan||1,h=l.colSpan||1;void 0===e[c]&&(e[c]=[]);for(var p=0;p<e[c].length+1;p++)if(void 0===e[c][p]){r=p;break}i[d]=r;for(p=c;p<c+u;p++){void 0===e[p]&&(e[p]=[]);for(var f=e[p],m=r;m<r+h;m++)f[m]="x"}}return i}function checkCellColSpan(t,e,i){for(var n=[],a=t.tHead.rows,s=a[i].cells,o=0;o<s.length;o++){var r=s[o];r.colSpan>1?n=n.concat(checkCellColSpan(t,headerArr,i++)):(1==t.tHead.length||r.rowSpan>1||!a[i+1])&&n.push(r)}return n}function checkHeaderMetadata(t){return!(!$.metadata||!1!==$(t).metadata().sorter)}function checkHeaderOptions(t,e){return!(!t.config.headers[e]||!1!==t.config.headers[e].sorter)}function checkHeaderOptionsSortingLocked(t,e){return!(!t.config.headers[e]||!t.config.headers[e].lockedOrder)&&t.config.headers[e].lockedOrder}function applyWidget(t){for(var e=t.config.widgets,i=e.length,n=0;n<i;n++)getWidgetById(e[n]).format(t)}function getWidgetById(t){for(var e=widgets.length,i=0;i<e;i++)if(widgets[i].id.toLowerCase()==t.toLowerCase())return widgets[i]}function formatSortingOrder(t){return"Number"!=typeof t?"desc"==t.toLowerCase()?1:0:1==t?1:0}function isValueInArray(t,e){for(var i=e.length,n=0;n<i;n++)if(e[n][0]==t)return!0;return!1}function setHeadersCss(t,e,i,n){e.removeClass(n[0]).removeClass(n[1]);var a=[];e.each((function(t){this.sortDisabled||(a[this.column]=$(this))}));for(var s=i.length,o=0;o<s;o++)a[i[o][0]].addClass(n[i[o][1]])}function fixColumnWidth(t,e){if(t.config.widthFixed){var i=$("<colgroup>");$("tr:first td",t.tBodies[0]).each((function(){i.append($("<col>").css("width",$(this).width()))})),$(t).prepend(i)}}function updateHeaderSortCount(t,e){for(var i=t.config,n=e.length,a=0;a<n;a++){var s=e[a],o=i.headerList[s[0]];o.count=s[1],o.count++}}function multisort(table,sortList,cache){if(table.config.debug)var sortTime=new Date;for(var dynamicExp="var sortWrapper = function(a,b) {",l=sortList.length,i=0;i<l;i++){var c=sortList[i][0],order=sortList[i][1],s="text"==table.config.parsers[c].type?makeSortFunction("text",0==order?"asc":"desc",c):makeSortFunction("numeric",0==order?"asc":"desc",c),e="e"+i;dynamicExp+="var "+e+" = "+s,dynamicExp+="if("+e+") { return "+e+"; } ",dynamicExp+="else { "}var orgOrderCol=cache.normalized[0].length-1;dynamicExp+="return a["+orgOrderCol+"]-b["+orgOrderCol+"];";for(var i=0;i<l;i++)dynamicExp+="}; ";return dynamicExp+="return 0; ",dynamicExp+="}; ",table.config.debug&&benchmark("Evaling expression:"+dynamicExp,new Date),eval(dynamicExp),cache.normalized.sort(sortWrapper),table.config.debug&&benchmark("Sorting on "+sortList.toString()+" and dir "+order+" time:",sortTime),cache}function makeSortFunction(t,e,i){var n="a["+i+"]",a="b["+i+"]";return"text"==t&&"asc"==e?"("+n+" == "+a+" ? 0 : ("+n+" === null ? Number.POSITIVE_INFINITY : ("+a+" === null ? Number.NEGATIVE_INFINITY : ("+n+" < "+a+") ? -1 : 1 )));":"text"==t&&"desc"==e?"("+n+" == "+a+" ? 0 : ("+n+" === null ? Number.POSITIVE_INFINITY : ("+a+" === null ? Number.NEGATIVE_INFINITY : ("+a+" < "+n+") ? -1 : 1 )));":"numeric"==t&&"asc"==e?"("+n+" === null && "+a+" === null) ? 0 :("+n+" === null ? Number.POSITIVE_INFINITY : ("+a+" === null ? Number.NEGATIVE_INFINITY : "+n+" - "+a+"));":"numeric"==t&&"desc"==e?"("+n+" === null && "+a+" === null) ? 0 :("+n+" === null ? Number.POSITIVE_INFINITY : ("+a+" === null ? Number.NEGATIVE_INFINITY : "+a+" - "+n+"));":void 0}function makeSortText(t){return"((a["+t+"] < b["+t+"]) ? -1 : ((a["+t+"] > b["+t+"]) ? 1 : 0));"}function makeSortTextDesc(t){return"((b["+t+"] < a["+t+"]) ? -1 : ((b["+t+"] > a["+t+"]) ? 1 : 0));"}function makeSortNumeric(t){return"a["+t+"]-b["+t+"];"}function makeSortNumericDesc(t){return"b["+t+"]-a["+t+"];"}function sortText(t,e){return table.config.sortLocaleCompare?t.localeCompare(e):t<e?-1:t>e?1:0}function sortTextDesc(t,e){return table.config.sortLocaleCompare?e.localeCompare(t):e<t?-1:e>t?1:0}function sortNumeric(t,e){return t-e}function sortNumericDesc(t,e){return e-t}function getCachedSortType(t,e){return t[e].type}this.defaults={cssHeader:"header",cssAsc:"headerSortUp",cssDesc:"headerSortDown",cssChildRow:"expand-child",sortInitialOrder:"asc",sortMultiSortKey:"shiftKey",sortForce:null,sortAppend:null,sortLocaleCompare:!0,textExtraction:"simple",parsers:{},widgets:[],widgetZebra:{css:["even","odd"]},headers:{},widthFixed:!1,cancelSelection:!0,sortList:[],headerList:[],dateFormat:"us",decimal:"/.|,/g",onRenderHeader:null,selectorHeaders:"thead th",debug:!1},this.benchmark=benchmark,this.construct=function(t){return this.each((function(){if(this.tHead&&this.tBodies){var e,i,n,a;this.config={},a=$.extend(this.config,$.tablesorter.defaults,t),e=$(this),$.data(this,"tablesorter",a),i=buildHeaders(this),this.config.parsers=buildParserCache(this,i),n=buildCache(this);var s=[a.cssDesc,a.cssAsc];fixColumnWidth(this),i.click((function(t){var o=e[0].tBodies[0]&&e[0].tBodies[0].rows.length||0;if(!this.sortDisabled&&o>0){e.trigger("sortStart");$(this);var r=this.column;if(this.order=this.count++%2,this.lockedOrder&&(this.order=this.lockedOrder),t[a.sortMultiSortKey])if(isValueInArray(r,a.sortList))for(u=0;u<a.sortList.length;u++){var l=a.sortList[u],c=a.headerList[l[0]];l[0]==r&&(c.count=l[1],c.count++,l[1]=c.count%2)}else a.sortList.push([r,this.order]);else{if(a.sortList=[],null!=a.sortForce)for(var d=a.sortForce,u=0;u<d.length;u++)d[u][0]!=r&&a.sortList.push(d[u]);a.sortList.push([r,this.order])}return setTimeout((function(){setHeadersCss(e[0],i,a.sortList,s),appendToTable(e[0],multisort(e[0],a.sortList,n))}),1),!1}})).mousedown((function(){if(a.cancelSelection)return this.onselectstart=function(){return!1},!1})),e.bind("update",(function(){var t=this;setTimeout((function(){t.config.parsers=buildParserCache(t,i),n=buildCache(t)}),1)})).bind("updateCell",(function(t,e){var i=this.config,a=[e.parentNode.rowIndex-1,e.cellIndex];n.normalized[a[0]][a[1]]=i.parsers[a[1]].format(getElementText(i,e),e)})).bind("sorton",(function(t,e){$(this).trigger("sortStart"),a.sortList=e;var o=a.sortList;updateHeaderSortCount(this,o),setHeadersCss(this,i,o,s),appendToTable(this,multisort(this,o,n))})).bind("appendCache",(function(){appendToTable(this,n)})).bind("applyWidgetId",(function(t,e){getWidgetById(e).format(this)})).bind("applyWidgets",(function(){applyWidget(this)})),$.metadata&&$(this).metadata()&&$(this).metadata().sortlist&&(a.sortList=$(this).metadata().sortlist),a.sortList.length>0&&e.trigger("sorton",[a.sortList]),applyWidget(this)}}))},this.addParser=function(t){for(var e=parsers.length,i=!0,n=0;n<e;n++)parsers[n].id.toLowerCase()==t.id.toLowerCase()&&(i=!1);i&&parsers.push(t)},this.addWidget=function(t){widgets.push(t)},this.formatFloat=function(t){var e=parseFloat(t);return isNaN(e)?0:e},this.formatInt=function(t){var e=parseInt(t);return isNaN(e)?0:e},this.isDigit=function(t,e){return/^[-+]?\d*$/.test($.trim(t.replace(/[,.']/g,"")))},this.clearTableBody=function(t){if($.browser.msie){(function(){for(;this.firstChild;)this.removeChild(this.firstChild)}).apply(t.tBodies[0])}else t.tBodies[0].innerHTML=""}}}),$.fn.extend({tablesorter:$.tablesorter.construct});var ts=$.tablesorter;ts.addParser({id:"text",is:function(t){return!0},format:function(t){return $.trim(t.toLocaleLowerCase())},type:"text"}),ts.addParser({id:"digit",is:function(t,e){var i=e.config;return $.tablesorter.isDigit(t,i)},format:function(t){return $.tablesorter.formatFloat(t)},type:"numeric"}),ts.addParser({id:"currency",is:function(t){return/^[$?.]/.test(t)},format:function(t){return $.tablesorter.formatFloat(t.replace(new RegExp(/[$]/g),""))},type:"numeric"}),ts.addParser({id:"ipAddress",is:function(t){return/^\d{2,3}[\.]\d{2,3}[\.]\d{2,3}[\.]\d{2,3}$/.test(t)},format:function(t){for(var e=t.split("."),i="",n=e.length,a=0;a<n;a++){var s=e[a];2==s.length?i+="0"+s:i+=s}return $.tablesorter.formatFloat(i)},type:"numeric"}),ts.addParser({id:"url",is:function(t){return/^(https?|ftp|file):\/\/$/.test(t)},format:function(t){return jQuery.trim(t.replace(new RegExp(/(https?|ftp|file):\/\//),""))},type:"text"}),ts.addParser({id:"isoDate",is:function(t){return/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(t)},format:function(t){return $.tablesorter.formatFloat(""!=t?new Date(t.replace(new RegExp(/-/g),"/")).getTime():"0")},type:"numeric"}),ts.addParser({id:"percent",is:function(t){return/\%$/.test($.trim(t))},format:function(t){return $.tablesorter.formatFloat(t.replace(new RegExp(/%/g),""))},type:"numeric"}),ts.addParser({id:"usLongDate",is:function(t){return t.match(new RegExp(/^[A-Za-z]{3,10}\.? [0-9]{1,2}, ([0-9]{4}|'?[0-9]{2}) (([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(AM|PM)))$/))},format:function(t){return $.tablesorter.formatFloat(new Date(t).getTime())},type:"numeric"}),ts.addParser({id:"shortDate",is:function(t){return/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/.test(t)},format:function(t,e){var i=e.config;return t=t.replace(/\-/g,"/"),"us"==i.dateFormat?t=t.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$1/$2"):"uk"==i.dateFormat?t=t.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$2/$1"):"dd/mm/yy"!=i.dateFormat&&"dd-mm-yy"!=i.dateFormat||(t=t.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})/,"$1/$2/$3")),$.tablesorter.formatFloat(new Date(t).getTime())},type:"numeric"}),ts.addParser({id:"time",is:function(t){return/^(([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(am|pm)))$/.test(t)},format:function(t){return $.tablesorter.formatFloat(new Date("2000/01/01 "+t).getTime())},type:"numeric"}),ts.addParser({id:"metadata",is:function(t){return!1},format:function(t,e,i){var n=e.config,a=n.parserMetadataName?n.parserMetadataName:"sortValue";return $(i).metadata()[a]},type:"numeric"}),ts.addWidget({id:"zebra",format:function(t){if(t.config.debug)var e=new Date;var i,n,a=-1;$("tr:visible",t.tBodies[0]).each((function(e){(i=$(this)).hasClass(t.config.cssChildRow)||a++,n=a%2==0,i.removeClass(t.config.widgetZebra.css[n?0:1]).addClass(t.config.widgetZebra.css[n?1:0])})),t.config.debug&&$.tablesorter.benchmark("Applying Zebra widget",e)}})}(jQuery),function(t){var e={init:function(i){var n=this;return n.data("jqv")&&null!=n.data("jqv")||(i=e._saveOptions(n,i),t(document).on("click",".formError",(function(){t(this).fadeOut(150,(function(){t(this).parent(".formErrorOuter").remove(),t(this).remove()}))}))),this},attach:function(i){var n,a=this;return(n=i?e._saveOptions(a,i):a.data("jqv")).validateAttribute=a.find("[data-validation-engine*=validate]").length?"data-validation-engine":"class",n.binded&&(a.on(n.validationEventTrigger,"["+n.validateAttribute+"*=validate]:not([type=checkbox]):not([type=radio]):not(.datepicker)",e._onFieldEvent),a.on("click","["+n.validateAttribute+"*=validate][type=checkbox],["+n.validateAttribute+"*=validate][type=radio]",e._onFieldEvent),a.on(n.validationEventTrigger,"["+n.validateAttribute+"*=validate][class*=datepicker]",{delay:300},e._onFieldEvent)),n.autoPositionUpdate&&t(window).bind("resize",{noAnimation:!0,formElem:a},e.updatePromptsPosition),a.on("click","a[data-validation-engine-skip], a[class*='validate-skip'], button[data-validation-engine-skip], button[class*='validate-skip'], input[data-validation-engine-skip], input[class*='validate-skip']",e._submitButtonClick),a.removeData("jqv_submitButton"),a.on("submit",e._onSubmitEvent),this},detach:function(){var i=this,n=i.data("jqv");return i.find("["+n.validateAttribute+"*=validate]").not("[type=checkbox]").off(n.validationEventTrigger,e._onFieldEvent),i.find("["+n.validateAttribute+"*=validate][type=checkbox],[class*=validate][type=radio]").off("click",e._onFieldEvent),i.off("submit",e._onSubmitEvent),i.removeData("jqv"),i.off("click","a[data-validation-engine-skip], a[class*='validate-skip'], button[data-validation-engine-skip], button[class*='validate-skip'], input[data-validation-engine-skip], input[class*='validate-skip']",e._submitButtonClick),i.removeData("jqv_submitButton"),n.autoPositionUpdate&&t(window).off("resize",e.updatePromptsPosition),this},validate:function(){var i=t(this),n=null;if(i.is("form")||i.hasClass("validationEngineContainer")){if(i.hasClass("validating"))return!1;i.addClass("validating");var a=i.data("jqv");n=e._validateFields(this);setTimeout((function(){i.removeClass("validating")}),100),n&&a.onSuccess?a.onSuccess():!n&&a.onFailure&&a.onFailure()}else if(i.is("form")||i.hasClass("validationEngineContainer"))i.removeClass("validating");else{var s=i.closest("form, .validationEngineContainer");a=s.data("jqv")?s.data("jqv"):t.validationEngine.defaults;(n=e._validateField(i,a))&&a.onFieldSuccess?a.onFieldSuccess():a.onFieldFailure&&a.InvalidFields.length>0&&a.onFieldFailure()}return a.onValidationComplete?!!a.onValidationComplete(s,n):n},updatePromptsPosition:function(i){if(i&&this==window)var n=i.data.formElem,a=i.data.noAnimation;else n=t(this.closest("form, .validationEngineContainer"));var s=n.data("jqv");return n.find("["+s.validateAttribute+"*=validate]").not(":disabled").each((function(){var i=t(this);s.prettySelect&&i.is(":hidden")&&(i=n.find("#"+s.usePrefix+i.attr("id")+s.useSuffix));var o=e._getPrompt(i),r=t(o).find(".formErrorContent").html();o&&e._updatePrompt(i,t(o),r,void 0,!1,s,a)})),this},showPrompt:function(t,i,n,a){var s=this.closest("form, .validationEngineContainer").data("jqv");return s||(s=e._saveOptions(this,s)),n&&(s.promptPosition=n),s.showArrow=1==a,e._showPrompt(this,t,i,!1,s),this},hide:function(){var i,n=t(this).closest("form, .validationEngineContainer").data("jqv"),a=n&&n.fadeDuration?n.fadeDuration:.3;return i=t(this).is("form")||t(this).hasClass("validationEngineContainer")?"parentForm"+e._getClassName(t(this).attr("id")):e._getClassName(t(this).attr("id"))+"formError",t("."+i).fadeTo(a,.3,(function(){t(this).parent(".formErrorOuter").remove(),t(this).remove()})),this},hideAll:function(){var e=this.data("jqv"),i=e?e.fadeDuration:300;return t(".formError").fadeTo(i,300,(function(){t(this).parent(".formErrorOuter").remove(),t(this).remove()})),this},_onFieldEvent:function(i){var n=t(this),a=n.closest("form, .validationEngineContainer").data("jqv");a.eventTrigger="field",window.setTimeout((function(){e._validateField(n,a),0==a.InvalidFields.length&&a.onFieldSuccess?a.onFieldSuccess():a.InvalidFields.length>0&&a.onFieldFailure&&a.onFieldFailure()}),i.data?i.data.delay:0)},_onSubmitEvent:function(){var i=t(this),n=i.data("jqv");if(i.data("jqv_submitButton")){var a=t("#"+i.data("jqv_submitButton"));if(a&&a.length>0&&(a.hasClass("validate-skip")||"true"==a.attr("data-validation-engine-skip")))return!0}n.eventTrigger="submit";var s=e._validateFields(i);return s&&n.ajaxFormValidation?(e._validateFormWithAjax(i,n),!1):n.onValidationComplete?!!n.onValidationComplete(i,s):s},_checkAjaxStatus:function(e){var i=!0;return t.each(e.ajaxValidCache,(function(t,e){if(!e)return i=!1,!1})),i},_checkAjaxFieldStatus:function(t,e){return 1==e.ajaxValidCache[t]},_validateFields:function(i){var n=i.data("jqv"),a=!1;i.trigger("jqv.form.validating");var s=null;if(i.find("["+n.validateAttribute+"*=validate]").not(":disabled").each((function(){var o=t(this),r=[];if(t.inArray(o.attr("name"),r)<0){if((a|=e._validateField(o,n))&&null==s&&(o.is(":hidden")&&n.prettySelect?s=o=i.find("#"+n.usePrefix+e._jqSelector(o.attr("id"))+n.useSuffix):(o.data("jqv-prompt-at")instanceof jQuery?o=o.data("jqv-prompt-at"):o.data("jqv-prompt-at")&&(o=t(o.data("jqv-prompt-at"))),s=o)),n.doNotShowAllErrosOnSubmit)return!1;if(r.push(o.attr("name")),1==n.showOneMessage&&a)return!1}})),i.trigger("jqv.form.result",[a]),a){if(n.scroll){var o=s.offset().top,r=s.offset().left,l=n.promptPosition;if("string"==typeof l&&-1!=l.indexOf(":")&&(l=l.substring(0,l.indexOf(":"))),"bottomRight"!=l&&"bottomLeft"!=l){var c=e._getPrompt(s);c&&(o=c.offset().top)}if(n.scrollOffset&&(o-=n.scrollOffset),n.isOverflown){var d=t(n.overflownDIV);if(!d.length)return!1;o+=d.scrollTop()+-parseInt(d.offset().top)-5,t(n.overflownDIV+":not(:animated)").animate({scrollTop:o},1100,(function(){n.focusFirstField&&s.focus()}))}else t("html, body").animate({scrollTop:o},1100,(function(){n.focusFirstField&&s.focus()})),t("html, body").animate({scrollLeft:r},1100)}else n.focusFirstField&&s.focus();return!1}return!0},_validateFormWithAjax:function(i,n){var a=i.serialize(),s=n.ajaxFormValidationMethod?n.ajaxFormValidationMethod:"GET",o=n.ajaxFormValidationURL?n.ajaxFormValidationURL:i.attr("action"),r=n.dataType?n.dataType:"json";t.ajax({type:s,url:o,cache:!1,dataType:r,data:a,form:i,methods:e,options:n,beforeSend:function(){return n.onBeforeAjaxFormValidation(i,n)},error:function(t,i){e._ajaxError(t,i)},success:function(a){if("json"==r&&!0!==a){for(var s=!1,o=0;o<a.length;o++){var l=a[o],c=l[0],d=t(t("#"+c)[0]);if(1==d.length){var u=l[2];if(1==l[1])if(""!=u&&u){if(n.allrules[u])(h=n.allrules[u].alertTextOk)&&(u=h);n.showPrompts&&e._showPrompt(d,u,"pass",!1,n,!0)}else e._closePrompt(d);else{var h;if(s|=!0,n.allrules[u])(h=n.allrules[u].alertText)&&(u=h);n.showPrompts&&e._showPrompt(d,u,"",!1,n,!0)}}}n.onAjaxFormComplete(!s,i,a,n)}else n.onAjaxFormComplete(!0,i,a,n)}})},_validateField:function(i,n,a){if(i.attr("id")||(i.attr("id","form-validation-field-"+t.validationEngine.fieldIdCounter),++t.validationEngine.fieldIdCounter),!n.validateNonVisibleFields&&(i.is(":hidden")&&!n.prettySelect||i.parent().is(":hidden")))return!1;var s=i.attr(n.validateAttribute),o=/validate\[(.*)\]/.exec(s);if(!o)return!1;var r=o[1].split(/\[|,|\]/),l=i.attr("name"),c="",d="",u=!1,h=!1;n.isError=!1,n.showArrow=!0,n.maxErrorsPerField>0&&(h=!0);for(var p=t(i.closest("form, .validationEngineContainer")),f=0;f<r.length;f++)r[f]=r[f].replace(" ",""),""===r[f]&&delete r[f];f=0;for(var m=0;f<r.length;f++){if(h&&m>=n.maxErrorsPerField){if(!u){var g=t.inArray("required",r);u=-1!=g&&g>=f}break}var v=void 0;switch(r[f]){case"required":u=!0,v=e._getErrorMessage(p,i,r[f],r,f,n,e._required);break;case"custom":v=e._getErrorMessage(p,i,r[f],r,f,n,e._custom);break;case"groupRequired":var b="["+n.validateAttribute+"*="+r[f+1]+"]",y=p.find(b).eq(0);y[0]!=i[0]&&(e._validateField(y,n,a),n.showArrow=!0),(v=e._getErrorMessage(p,i,r[f],r,f,n,e._groupRequired))&&(u=!0),n.showArrow=!1;break;case"ajax":(v=e._ajax(i,r,f,n))&&(d="load");break;case"minSize":v=e._getErrorMessage(p,i,r[f],r,f,n,e._minSize);break;case"maxSize":v=e._getErrorMessage(p,i,r[f],r,f,n,e._maxSize);break;case"min":v=e._getErrorMessage(p,i,r[f],r,f,n,e._min);break;case"max":v=e._getErrorMessage(p,i,r[f],r,f,n,e._max);break;case"past":v=e._getErrorMessage(p,i,r[f],r,f,n,e._past);break;case"future":v=e._getErrorMessage(p,i,r[f],r,f,n,e._future);break;case"dateRange":b="["+n.validateAttribute+"*="+r[f+1]+"]";n.firstOfGroup=p.find(b).eq(0),n.secondOfGroup=p.find(b).eq(1),(n.firstOfGroup[0].value||n.secondOfGroup[0].value)&&(v=e._getErrorMessage(p,i,r[f],r,f,n,e._dateRange)),v&&(u=!0),n.showArrow=!1;break;case"dateTimeRange":b="["+n.validateAttribute+"*="+r[f+1]+"]";n.firstOfGroup=p.find(b).eq(0),n.secondOfGroup=p.find(b).eq(1),(n.firstOfGroup[0].value||n.secondOfGroup[0].value)&&(v=e._getErrorMessage(p,i,r[f],r,f,n,e._dateTimeRange)),v&&(u=!0),n.showArrow=!1;break;case"maxCheckbox":i=t(p.find("input[name='"+l+"']")),v=e._getErrorMessage(p,i,r[f],r,f,n,e._maxCheckbox);break;case"minCheckbox":i=t(p.find("input[name='"+l+"']")),v=e._getErrorMessage(p,i,r[f],r,f,n,e._minCheckbox);break;case"equals":v=e._getErrorMessage(p,i,r[f],r,f,n,e._equals);break;case"funcCall":v=e._getErrorMessage(p,i,r[f],r,f,n,e._funcCall);break;case"creditCard":v=e._getErrorMessage(p,i,r[f],r,f,n,e._creditCard);break;case"condRequired":void 0!==(v=e._getErrorMessage(p,i,r[f],r,f,n,e._condRequired))&&(u=!0)}var _=!1;if("object"==typeof v)switch(v.status){case"_break":_=!0;break;case"_error":v=v.message;break;case"_error_no_prompt":return!0}if(_)break;"string"==typeof v&&(c+=v+"<br/>",n.isError=!0,m++)}!u&&!i.val()&&i.val().length<1&&(n.isError=!1);var x=i.prop("type"),w=i.data("promptPosition")||n.promptPosition;("radio"==x||"checkbox"==x)&&p.find("input[name='"+l+"']").size()>1&&(i=t("inline"===w?p.find("input[name='"+l+"'][type!=hidden]:last"):p.find("input[name='"+l+"'][type!=hidden]:first")),n.showArrow=!1),i.is(":hidden")&&n.prettySelect&&(i=p.find("#"+n.usePrefix+e._jqSelector(i.attr("id"))+n.useSuffix)),n.isError&&n.showPrompts?e._showPrompt(i,c,d,!1,n):e._closePrompt(i),i.trigger("jqv.field.result",[i,n.isError,c]);var C=t.inArray(i[0],n.InvalidFields);return-1==C?n.isError&&n.InvalidFields.push(i[0]):n.isError||n.InvalidFields.splice(C,1),e._handleStatusCssClasses(i,n),n.isError&&n.onFieldFailure&&n.onFieldFailure(i),!n.isError&&n.onFieldSuccess&&n.onFieldSuccess(i),n.isError},_handleStatusCssClasses:function(t,e){e.addSuccessCssClassToField&&t.removeClass(e.addSuccessCssClassToField),e.addFailureCssClassToField&&t.removeClass(e.addFailureCssClassToField),e.addSuccessCssClassToField&&!e.isError&&t.addClass(e.addSuccessCssClassToField),e.addFailureCssClassToField&&e.isError&&t.addClass(e.addFailureCssClassToField)},_getErrorMessage:function(i,n,a,s,o,r,l){var c=jQuery.inArray(a,s);"custom"!==a&&"funcCall"!==a||(a=a+"["+s[c+1]+"]",delete s[c]);var d,u=a,h=(n.attr("data-validation-engine")?n.attr("data-validation-engine"):n.attr("class")).split(" ");if(null!=(d="future"==a||"past"==a||"maxCheckbox"==a||"minCheckbox"==a?l(i,n,s,o,r):l(n,s,o,r))){var p=e._getCustomErrorMessage(t(n),h,u,r);p&&(d=p)}return d},_getCustomErrorMessage:function(t,i,n,a){var s=!1,o=/^custom\[.*\]$/.test(n)?e._validityProp.custom:e._validityProp[n];if(null!=o&&null!=(s=t.attr("data-errormessage-"+o)))return s;if(null!=(s=t.attr("data-errormessage")))return s;var r="#"+t.attr("id");if(void 0!==a.custom_error_messages[r]&&void 0!==a.custom_error_messages[r][n])s=a.custom_error_messages[r][n].message;else if(i.length>0)for(var l=0;l<i.length&&i.length>0;l++){var c="."+i[l];if(void 0!==a.custom_error_messages[c]&&void 0!==a.custom_error_messages[c][n]){s=a.custom_error_messages[c][n].message;break}}return s||void 0===a.custom_error_messages[n]||void 0===a.custom_error_messages[n].message||(s=a.custom_error_messages[n].message),s},_validityProp:{required:"value-missing",custom:"custom-error",groupRequired:"value-missing",ajax:"custom-error",minSize:"range-underflow",maxSize:"range-overflow",min:"range-underflow",max:"range-overflow",past:"type-mismatch",future:"type-mismatch",dateRange:"type-mismatch",dateTimeRange:"type-mismatch",maxCheckbox:"range-overflow",minCheckbox:"range-underflow",equals:"pattern-mismatch",funcCall:"custom-error",creditCard:"pattern-mismatch",condRequired:"value-missing"},_required:function(e,i,n,a,s){switch(e.prop("type")){case"text":case"password":case"textarea":case"file":case"select-one":case"select-multiple":default:var o=t.trim(e.val()),r=t.trim(e.attr("data-validation-placeholder"));if(!o||r&&o==r)return a.allrules[i[n]].alertText;break;case"radio":case"checkbox":if(s){if(!e.attr("checked"))return a.allrules[i[n]].alertTextCheckboxMultiple;break}var l=e.closest("form, .validationEngineContainer"),c=e.attr("name");if(0==l.find("input[name='"+c+"']:checked").size())return 1==l.find("input[name='"+c+"']:visible").size()?a.allrules[i[n]].alertTextCheckboxe:a.allrules[i[n]].alertTextCheckboxMultiple}},_groupRequired:function(i,n,a,s){var o="["+s.validateAttribute+"*="+n[a+1]+"]",r=!1;if(i.closest("form, .validationEngineContainer").find(o).each((function(){if(!e._required(t(this),n,a,s))return r=!0,!1})),!r)return s.allrules[n[a]].alertText},_custom:function(t,e,i,n){var a,s=e[i+1],o=n.allrules[s];if(o)if(o.regex){var r=o.regex;if(!r)return void alert("jqv:custom regex not found - "+s);if(!new RegExp(r).test(t.val()))return n.allrules[s].alertText}else{if(!o.func)return void alert("jqv:custom type not allowed "+s);if("function"!=typeof(a=o.func))return void alert("jqv:custom parameter 'function' is no function - "+s);if(!a(t,e,i,n))return n.allrules[s].alertText}else alert("jqv:custom rule not found - "+s)},_funcCall:function(t,e,i,n){var a,s=e[i+1];if(s.indexOf(".")>-1){for(var o=s.split("."),r=window;o.length;)r=r[o.shift()];a=r}else a=window[s]||n.customFunctions[s];if("function"==typeof a)return a(t,e,i,n)},_equals:function(e,i,n,a){var s=i[n+1];if(e.val()!=t("#"+s).val())return a.allrules.equals.alertText},_maxSize:function(t,e,i,n){var a=e[i+1];if(t.val().length>a){var s=n.allrules.maxSize;return"string"==typeof s.alertText2?s.alertText+min+s.alertText2:s.alertText}},_minSize:function(t,e,i,n){var a=e[i+1];if(t.val().length<a){var s=n.allrules.minSize;return"string"==typeof s.alertText2?s.alertText+a+s.alertText2:s.alertText}},_min:function(t,e,i,n){var a=parseFloat(e[i+1]);if(parseFloat(t.val())<a){var s=n.allrules.min;return s.alertText2?s.alertText+a+s.alertText2:s.alertText+a}},_max:function(t,e,i,n){var a=parseFloat(e[i+1]);if(parseFloat(t.val())>a){var s=n.allrules.max;return s.alertText2?s.alertText+a+s.alertText2:s.alertText+a}},_past:function(i,n,a,s,o){var r,l=a[s+1],c=t(i.find("input[name='"+l.replace(/^#+/,"")+"']"));if("now"==l.toLowerCase())r=new Date;else if(null!=c.val()){if(c.is(":disabled"))return;r=e._parseDate(c.val())}else r=e._parseDate(l);if(e._parseDate(n.val())>r){var d=o.allrules.past;return d.alertText2?d.alertText+e._dateToString(r)+d.alertText2:d.alertText+e._dateToString(r)}},_future:function(i,n,a,s,o){var r,l=a[s+1],c=t(i.find("input[name='"+l.replace(/^#+/,"")+"']"));if("now"==l.toLowerCase())r=new Date;else if(null!=c.val()){if(c.is(":disabled"))return;r=e._parseDate(c.val())}else r=e._parseDate(l);if(e._parseDate(n.val())<r){var d=o.allrules.future;return d.alertText2?d.alertText+e._dateToString(r)+d.alertText2:d.alertText+e._dateToString(r)}},_isDate:function(t){return new RegExp(/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$|^(?:(?:(?:0?[13578]|1[02])(\/|-)31)|(?:(?:0?[1,3-9]|1[0-2])(\/|-)(?:29|30)))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^(?:(?:0?[1-9]|1[0-2])(\/|-)(?:0?[1-9]|1\d|2[0-8]))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^(0?2(\/|-)29)(\/|-)(?:(?:0[48]00|[13579][26]00|[2468][048]00)|(?:\d\d)?(?:0[48]|[2468][048]|[13579][26]))$/).test(t)},_isDateTime:function(t){return new RegExp(/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])\s+(1[012]|0?[1-9]){1}:(0?[1-5]|[0-6][0-9]){1}:(0?[0-6]|[0-6][0-9]){1}\s+(am|pm|AM|PM){1}$|^(?:(?:(?:0?[13578]|1[02])(\/|-)31)|(?:(?:0?[1,3-9]|1[0-2])(\/|-)(?:29|30)))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^((1[012]|0?[1-9]){1}\/(0?[1-9]|[12][0-9]|3[01]){1}\/\d{2,4}\s+(1[012]|0?[1-9]){1}:(0?[1-5]|[0-6][0-9]){1}:(0?[0-6]|[0-6][0-9]){1}\s+(am|pm|AM|PM){1})$/).test(t)},_dateCompare:function(t,e){return new Date(t.toString())<new Date(e.toString())},_dateRange:function(t,i,n,a){return!a.firstOfGroup[0].value&&a.secondOfGroup[0].value||a.firstOfGroup[0].value&&!a.secondOfGroup[0].value?a.allrules[i[n]].alertText+a.allrules[i[n]].alertText2:e._isDate(a.firstOfGroup[0].value)&&e._isDate(a.secondOfGroup[0].value)&&e._dateCompare(a.firstOfGroup[0].value,a.secondOfGroup[0].value)?void 0:a.allrules[i[n]].alertText+a.allrules[i[n]].alertText2},_dateTimeRange:function(t,i,n,a){return!a.firstOfGroup[0].value&&a.secondOfGroup[0].value||a.firstOfGroup[0].value&&!a.secondOfGroup[0].value?a.allrules[i[n]].alertText+a.allrules[i[n]].alertText2:e._isDateTime(a.firstOfGroup[0].value)&&e._isDateTime(a.secondOfGroup[0].value)&&e._dateCompare(a.firstOfGroup[0].value,a.secondOfGroup[0].value)?void 0:a.allrules[i[n]].alertText+a.allrules[i[n]].alertText2},_maxCheckbox:function(t,e,i,n,a){var s=i[n+1],o=e.attr("name");if(t.find("input[name='"+o+"']:checked").size()>s)return a.showArrow=!1,a.allrules.maxCheckbox.alertText2?a.allrules.maxCheckbox.alertText+" "+s+" "+a.allrules.maxCheckbox.alertText2:a.allrules.maxCheckbox.alertText},_minCheckbox:function(t,e,i,n,a){var s=i[n+1],o=e.attr("name");if(t.find("input[name='"+o+"']:checked").size()<s)return a.showArrow=!1,a.allrules.minCheckbox.alertText+" "+s+" "+a.allrules.minCheckbox.alertText2},_creditCard:function(t,e,i,n){var a=!1,s=t.val().replace(/ +/g,"").replace(/-+/g,""),o=s.length;if(o>=14&&o<=16&&parseInt(s)>0){var r,l=0,c=(i=o-1,1),d=new String;do{r=parseInt(s.charAt(i)),d+=c++%2==0?2*r:r}while(--i>=0);for(i=0;i<d.length;i++)l+=parseInt(d.charAt(i));a=l%10==0}if(!a)return n.allrules.creditCard.alertText},_ajax:function(i,n,a,s){var o=n[a+1],r=s.allrules[o],l=r.extraData,c=r.extraDataDynamic,d={fieldId:i.attr("id"),fieldValue:i.val()};if("object"==typeof l)t.extend(d,l);else if("string"==typeof l){var u=l.split("&");for(a=0;a<u.length;a++){var h=u[a].split("=");h[0]&&h[0]&&(d[h[0]]=h[1])}}if(c){var p=String(c).split(",");for(a=0;a<p.length;a++){var f=p[a];if(t(f).length){var m=i.closest("form, .validationEngineContainer").find(f).val();f.replace("#",""),escape(m);d[f.replace("#","")]=m}}}if("field"==s.eventTrigger&&delete s.ajaxValidCache[i.attr("id")],!s.isError&&!e._checkAjaxFieldStatus(i.attr("id"),s))return t.ajax({type:s.ajaxFormValidationMethod,url:r.url,cache:!1,dataType:"json",data:d,field:i,rule:r,methods:e,options:s,beforeSend:function(){},error:function(t,i){e._ajaxError(t,i)},success:function(n){var a=n[0],o=t("#"+a).eq(0);if(1==o.length){var l=n[1],c=n[2];if(l){if(s.ajaxValidCache[a]=!0,c){if(s.allrules[c])(d=s.allrules[c].alertTextOk)&&(c=d)}else c=r.alertTextOk;s.showPrompts&&(c?e._showPrompt(o,c,"pass",!0,s):e._closePrompt(o)),"submit"==s.eventTrigger&&i.closest("form").submit()}else{var d;if(s.ajaxValidCache[a]=!1,s.isError=!0,c){if(s.allrules[c])(d=s.allrules[c].alertText)&&(c=d)}else c=r.alertText;s.showPrompts&&e._showPrompt(o,c,"",!0,s)}}o.trigger("jqv.field.result",[o,s.isError,c])}}),r.alertTextLoad},_ajaxError:function(t,e){0==t.status&&null==e?alert("The page is not served from a server! ajax call failed"):"undefined"!=typeof console&&console.log("Ajax error: "+t.status+" "+e)},_dateToString:function(t){return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()},_parseDate:function(t){var e=t.split("-");return e==t&&(e=t.split("/")),e==t?(e=t.split("."),new Date(e[2],e[1]-1,e[0])):new Date(e[0],e[1]-1,e[2])},_showPrompt:function(i,n,a,s,o,r){i.data("jqv-prompt-at")instanceof jQuery?i=i.data("jqv-prompt-at"):i.data("jqv-prompt-at")&&(i=t(i.data("jqv-prompt-at")));var l=e._getPrompt(i);r&&(l=!1),t.trim(n)&&(l?e._updatePrompt(i,l,n,a,s,o):e._buildPrompt(i,n,a,s,o))},_buildPrompt:function(i,n,a,s,o){var r=t("<div>");switch(r.addClass(e._getClassName(i.attr("id"))+"formError"),r.addClass("parentForm"+e._getClassName(i.closest("form, .validationEngineContainer").attr("id"))),r.addClass("formError"),a){case"pass":r.addClass("greenPopup");break;case"load":r.addClass("blackPopup")}s&&r.addClass("ajaxed");t("<div>").addClass("formErrorContent").html(n).appendTo(r);var l=i.data("promptPosition")||o.promptPosition;if(o.showArrow){var c=t("<div>").addClass("formErrorArrow");if("string"==typeof l)-1!=(h=l.indexOf(":"))&&(l=l.substring(0,h));switch(l){case"bottomLeft":case"bottomRight":r.find(".formErrorContent").before(c),c.addClass("formErrorArrowBottom").html('<div class="line1">\x3c!-- --\x3e</div><div class="line2">\x3c!-- --\x3e</div><div class="line3">\x3c!-- --\x3e</div><div class="line4">\x3c!-- --\x3e</div><div class="line5">\x3c!-- --\x3e</div><div class="line6">\x3c!-- --\x3e</div><div class="line7">\x3c!-- --\x3e</div><div class="line8">\x3c!-- --\x3e</div><div class="line9">\x3c!-- --\x3e</div><div class="line10">\x3c!-- --\x3e</div>');break;case"topLeft":case"topRight":c.html('<div class="line10">\x3c!-- --\x3e</div><div class="line9">\x3c!-- --\x3e</div><div class="line8">\x3c!-- --\x3e</div><div class="line7">\x3c!-- --\x3e</div><div class="line6">\x3c!-- --\x3e</div><div class="line5">\x3c!-- --\x3e</div><div class="line4">\x3c!-- --\x3e</div><div class="line3">\x3c!-- --\x3e</div><div class="line2">\x3c!-- --\x3e</div><div class="line1">\x3c!-- --\x3e</div>'),r.append(c)}}o.addPromptClass&&r.addClass(o.addPromptClass);var d=i.attr("data-required-class");if(void 0!==d)r.addClass(d);else if(o.prettySelect&&t("#"+i.attr("id")).next().is("select")){var u=t("#"+i.attr("id").substr(o.usePrefix.length).substring(o.useSuffix.length)).attr("data-required-class");void 0!==u&&r.addClass(u)}r.css({opacity:0}),"inline"===l?(r.addClass("inline"),void 0!==i.attr("data-prompt-target")&&t("#"+i.attr("data-prompt-target")).length>0?r.appendTo(t("#"+i.attr("data-prompt-target"))):i.after(r)):i.before(r);var h=e._calculatePosition(i,r,o);return r.css({position:"inline"===l?"relative":"absolute",top:h.callerTopPosition,left:h.callerleftPosition,marginTop:h.marginTopSize,opacity:0}).data("callerField",i),o.autoHidePrompt&&setTimeout((function(){r.animate({opacity:0},(function(){r.closest(".formErrorOuter").remove(),r.remove()}))}),o.autoHideDelay),r.animate({opacity:.87})},_updatePrompt:function(t,i,n,a,s,o,r){if(i){void 0!==a&&("pass"==a?i.addClass("greenPopup"):i.removeClass("greenPopup"),"load"==a?i.addClass("blackPopup"):i.removeClass("blackPopup")),s?i.addClass("ajaxed"):i.removeClass("ajaxed"),i.find(".formErrorContent").html(n);var l=e._calculatePosition(t,i,o),c={top:l.callerTopPosition,left:l.callerleftPosition,marginTop:l.marginTopSize};r?i.css(c):i.animate(c)}},_closePrompt:function(t){var i=e._getPrompt(t);i&&i.fadeTo("fast",0,(function(){i.parent(".formErrorOuter").remove(),i.remove()}))},closePrompt:function(t){return e._closePrompt(t)},_getPrompt:function(i){var n=t(i).closest("form, .validationEngineContainer").attr("id"),a=e._getClassName(i.attr("id"))+"formError",s=t("."+e._escapeExpression(a)+".parentForm"+e._getClassName(n))[0];if(s)return t(s)},_escapeExpression:function(t){return t.replace(/([#;&,\.\+\*\~':"\!\^$\[\]\(\)=>\|])/g,"\\$1")},isRTL:function(e){var i=t(document),n=t("body"),a=e&&e.hasClass("rtl")||e&&"rtl"===(e.attr("dir")||"").toLowerCase()||i.hasClass("rtl")||"rtl"===(i.attr("dir")||"").toLowerCase()||n.hasClass("rtl")||"rtl"===(n.attr("dir")||"").toLowerCase();return Boolean(a)},_calculatePosition:function(t,e,i){var n,a,s,o=t.width(),r=t.position().left,l=t.position().top;t.height();n=a=0,s=-e.height();var c=t.data("promptPosition")||i.promptPosition,d="",u="",h=0,p=0;switch("string"==typeof c&&-1!=c.indexOf(":")&&(d=c.substring(c.indexOf(":")+1),c=c.substring(0,c.indexOf(":")),-1!=d.indexOf(",")&&(u=d.substring(d.indexOf(",")+1),d=d.substring(0,d.indexOf(",")),p=parseInt(u),isNaN(p)&&(p=0)),h=parseInt(d),isNaN(d)&&(d=0)),c){default:case"topRight":a+=r+o-30,n+=l;break;case"topLeft":n+=l,a+=r;break;case"centerRight":n=l+4,s=0,a=r+t.outerWidth(!0)+5;break;case"centerLeft":a=r-(e.width()+2),n=l+4,s=0;break;case"bottomLeft":n=l+t.height()+5,s=0,a=r;break;case"bottomRight":a=r+o-30,n=l+t.height()+5,s=0;break;case"inline":a=0,n=0,s=0}return{callerTopPosition:(n+=p)+"px",callerleftPosition:(a+=h)+"px",marginTopSize:s+"px"}},_saveOptions:function(e,i){if(t.validationEngineLanguage)var n=t.validationEngineLanguage.allRules;else t.error("jQuery.validationEngine rules are not loaded, plz add localization files to the page");t.validationEngine.defaults.allrules=n;var a=t.extend(!0,{},t.validationEngine.defaults,i);return e.data("jqv",a),a},_getClassName:function(t){if(t)return t.replace(/:/g,"_").replace(/\./g,"_")},_jqSelector:function(t){return t.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1")},_condRequired:function(t,i,n,a){var s,o;for(s=n+1;s<i.length;s++)if((o=jQuery("#"+i[s]).first()).length&&null==e._required(o,["required"],0,a,!0))return e._required(t,["required"],0,a)},_submitButtonClick:function(e){var i=t(this);i.closest("form, .validationEngineContainer").data("jqv_submitButton",i.attr("id"))}};t.fn.validationEngine=function(i){var n=t(this);return n[0]?"string"==typeof i&&"_"!=i.charAt(0)&&e[i]?("showPrompt"!=i&&"hide"!=i&&"hideAll"!=i&&e.init.apply(n),e[i].apply(n,Array.prototype.slice.call(arguments,1))):"object"!=typeof i&&i?void t.error("Method "+i+" does not exist in jQuery.validationEngine"):(e.init.apply(n,arguments),e.attach.apply(n)):n},t.validationEngine={fieldIdCounter:0,defaults:{validationEventTrigger:"blur",scroll:!0,focusFirstField:!0,showPrompts:!0,validateNonVisibleFields:!1,promptPosition:"topRight",bindMethod:"bind",inlineAjax:!1,ajaxFormValidation:!1,ajaxFormValidationURL:!1,ajaxFormValidationMethod:"get",onAjaxFormComplete:t.noop,onBeforeAjaxFormValidation:t.noop,onValidationComplete:!1,doNotShowAllErrosOnSubmit:!1,custom_error_messages:{},binded:!0,showArrow:!0,isError:!1,maxErrorsPerField:!1,ajaxValidCache:{},autoPositionUpdate:!1,InvalidFields:[],onFieldSuccess:!1,onFieldFailure:!1,onSuccess:!1,onFailure:!1,validateAttribute:"class",addSuccessCssClassToField:"",addFailureCssClassToField:"",autoHidePrompt:!1,autoHideDelay:1e4,fadeDuration:.3,prettySelect:!1,addPromptClass:"",usePrefix:"",useSuffix:"",showOneMessage:!1}};var i={hook:"rightmiddle",hideOn:!1,skin:"cloud",hideOthers:!1};e._buildPrompt=function(t,e,n,a,s){t.data("promptText",e),Tipped.create(t[0],e,i),Tipped.show(t[0])},e._closePrompt=function(t){t.data("promptText",""),Tipped.remove(t[0])},e._updatePrompt=function(t,i,n,a,s,o,r){t.data("promptText")!=n&&(e._closePrompt(t),e._buildPrompt(t,n))},e._getPrompt=function(t){return Tipped.get(t[0])},t((function(){t.validationEngine.defaults.promptPosition=e.isRTL()?"topLeft":"topRight"}))}(jQuery),function(t){t.fn.wipetouch=function(e){var i={moveX:40,moveY:40,tapToClick:!1,preventDefault:!0,allowDiagonal:!1,preventDefaultWhenTriggering:!0,wipeLeft:!1,wipeRight:!1,wipeUp:!1,wipeDown:!1,wipeUpLeft:!1,wipeDownLeft:!1,wipeUpRight:!1,wipeDownRight:!1,wipeMove:!1,wipeTopLeft:!1,wipeBottomLeft:!1,wipeTopRight:!1,wipeBottomRight:!1};return e&&t.extend(i,e),this.each((function(){var e,n,a,s,o=!1,r=!1,l=!1,c=!1,d=!1;function u(d){f();var u=c||d.originalEvent.touches&&d.originalEvent.touches.length>0;!r&&u&&(i.preventDefault&&d.preventDefault(),i.allowDiagonal&&(i.wipeDownLeft||(i.wipeDownLeft=i.wipeBottomLeft),i.wipeDownRight||(i.wipeDownRight=i.wipeBottomRight),i.wipeUpLeft||(i.wipeUpLeft=i.wipeTopLeft),i.wipeUpRight||(i.wipeUpRight=i.wipeTopRight)),c?(e=d.pageX,n=d.pageY,t(this).bind("mousemove",p),t(this).one("mouseup",h)):(e=d.originalEvent.touches[0].pageX,n=d.originalEvent.touches[0].pageY,t(this).bind("touchmove",p)),o=(new Date).getTime(),a=e,s=n,r=!0,l=t(d.target))}function h(u){i.preventDefault&&u.preventDefault(),c?t(this).unbind("mousemove",p):t(this).unbind("touchmove",p),r?function(r){var u=(new Date).getTime(),h=o-u,p=s,g=a-e,v=p-n,b=Math.abs(g),y=Math.abs(v);if(b<15&&y<15&&h<100){if(d=!1,i.preventDefault)return f(),void l.trigger("click")}else if(c){var _=l.data("events");if(_){var x=_.click;x&&x.length>0&&(t.each(x,(function(t,e){d=e})),l.unbind("click"))}}var w=g>0,C=v>0,k=60*(b+y)/(h/6*h);k<1&&(k=1);k>5&&(k=5);var $={speed:parseInt(k),x:b,y:y,source:l};b>=i.moveX?i.allowDiagonal&&y>=i.moveY?m(w&&C?i.wipeDownRight:w&&!C?i.wipeUpRight:!w&&C?i.wipeDownLeft:i.wipeUpLeft,$,r):b>=y&&m(w?i.wipeRight:i.wipeLeft,$,r):y>=i.moveY&&y>b&&m(C?i.wipeDown:i.wipeUp,$,r);f()}(u):f()}function p(t){i.preventDefault&&t.preventDefault(),c&&!r&&u(t),r&&(c?(a=t.pageX,s=t.pageY):(a=t.originalEvent.touches[0].pageX,s=t.originalEvent.touches[0].pageY),i.wipeMove&&m(i.wipeMove,{curX:a,curY:s}))}function f(){e=!1,n=!1,o=!1,r=!1,d&&window.setTimeout((function(){l.bind("click",d),d=!1}),50)}function m(t,e,n){t&&(i.preventDefaultWhenTriggering&&n.preventDefault(),t(e))}"ontouchstart"in document.documentElement?(t(this).bind("touchstart",u),t(this).bind("touchend",h)):(c=!0,t(this).bind("mousedown",u),t(this).bind("mouseout mouseup",h))})),this}}(jQuery),function(t){"function"==typeof define&&define.amd?define(["./jquery"],t):"undefined"!=typeof module&&module.exports?module.exports=t:t(jQuery,window,document)}((function(t){!function(e){var i="function"==typeof define&&define.amd,n="undefined"!=typeof module&&module.exports,a="https:"==document.location.protocol?"https:":"http:";i||(n?require("./jquery-mousewheel")(t):t.event.special.mousewheel||t("head").append(decodeURI("%3Cscript src="+a+"//cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.13/jquery.mousewheel.js%3E%3C/script%3E"))),function(){var e,i="mCustomScrollbar",n="mCS",a=".mCustomScrollbar",s={setTop:0,setLeft:0,axis:"y",scrollbarPosition:"inside",scrollInertia:950,autoDraggerLength:!0,alwaysShowScrollbar:0,snapOffset:0,mouseWheel:{enable:!0,scrollAmount:"auto",axis:"y",deltaFactor:"auto",disableOver:["select","option","keygen","datalist","textarea"]},scrollButtons:{scrollType:"stepless",scrollAmount:"auto"},keyboard:{enable:!0,scrollType:"stepless",scrollAmount:"auto"},contentTouchScroll:25,documentTouchScroll:!0,advanced:{autoScrollOnFocus:"input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']",updateOnContentResize:!0,updateOnImageLoad:"auto",autoUpdateTimeout:60},theme:"light",callbacks:{onTotalScrollOffset:0,onTotalScrollBackOffset:0,alwaysTriggerOffsets:!0}},o=0,r={},l=window.attachEvent&&!window.addEventListener?1:0,c=!1,d=["mCSB_dragger_onDrag","mCSB_scrollTools_onDrag","mCS_img_loaded","mCS_disabled","mCS_destroyed","mCS_no_scrollbar","mCS-autoHide","mCS-dir-rtl","mCS_no_scrollbar_y","mCS_no_scrollbar_x","mCS_y_hidden","mCS_x_hidden","mCSB_draggerContainer","mCSB_buttonUp","mCSB_buttonDown","mCSB_buttonLeft","mCSB_buttonRight"],u={init:function(e){e=t.extend(!0,{},s,e);var i=h.call(this);if(e.live){var l=e.liveSelector||this.selector||a,c=t(l);if("off"===e.live)return void f(l);r[l]=setTimeout((function(){c.mCustomScrollbar(e),"once"===e.live&&c.length&&f(l)}),500)}else f(l);return e.setWidth=e.set_width?e.set_width:e.setWidth,e.setHeight=e.set_height?e.set_height:e.setHeight,e.axis=e.horizontalScroll?"x":m(e.axis),e.scrollInertia=e.scrollInertia>0&&e.scrollInertia<17?17:e.scrollInertia,"object"!=typeof e.mouseWheel&&1==e.mouseWheel&&(e.mouseWheel={enable:!0,scrollAmount:"auto",axis:"y",preventDefault:!1,deltaFactor:"auto",normalizeDelta:!1,invert:!1}),e.mouseWheel.scrollAmount=e.mouseWheelPixels?e.mouseWheelPixels:e.mouseWheel.scrollAmount,e.mouseWheel.normalizeDelta=e.advanced.normalizeMouseWheelDelta?e.advanced.normalizeMouseWheelDelta:e.mouseWheel.normalizeDelta,e.scrollButtons.scrollType=g(e.scrollButtons.scrollType),p(e),t(i).each((function(){var i=t(this);if(!i.data(n)){i.data(n,{idx:++o,opt:e,scrollRatio:{y:null,x:null},overflowed:null,contentReset:{y:null,x:null},bindEvents:!1,tweenRunning:!1,sequential:{},langDir:i.css("direction"),cbOffsets:null,trigger:null,poll:{size:{o:0,n:0},img:{o:0,n:0},change:{o:0,n:0}}});var a=i.data(n),s=a.opt,r=i.data("mcs-axis"),l=i.data("mcs-scrollbar-position"),c=i.data("mcs-theme");r&&(s.axis=r),l&&(s.scrollbarPosition=l),c&&(s.theme=c,p(s)),v.call(this),a&&s.callbacks.onCreate&&"function"==typeof s.callbacks.onCreate&&s.callbacks.onCreate.call(this),t("#mCSB_"+a.idx+"_container img:not(."+d[2]+")").addClass(d[2]),u.update.call(null,i)}}))},update:function(e,i){var a=e||h.call(this);return t(a).each((function(){var e=t(this);if(e.data(n)){var a=e.data(n),s=a.opt,o=t("#mCSB_"+a.idx+"_container"),r=t("#mCSB_"+a.idx),l=[t("#mCSB_"+a.idx+"_dragger_vertical"),t("#mCSB_"+a.idx+"_dragger_horizontal")];if(!o.length)return;a.tweenRunning&&G(e),i&&a&&s.callbacks.onBeforeUpdate&&"function"==typeof s.callbacks.onBeforeUpdate&&s.callbacks.onBeforeUpdate.call(this),e.hasClass(d[3])&&e.removeClass(d[3]),e.hasClass(d[4])&&e.removeClass(d[4]),r.css("max-height","none"),r.height()!==e.height()&&r.css("max-height",e.height()),y.call(this),"y"===s.axis||s.advanced.autoExpandHorizontalScroll||o.css("width",b(o)),a.overflowed=k.call(this),I.call(this),s.autoDraggerLength&&x.call(this),w.call(this),S.call(this);var c=[Math.abs(o[0].offsetTop),Math.abs(o[0].offsetLeft)];"x"!==s.axis&&(a.overflowed[0]?l[0].height()>l[0].parent().height()?$.call(this):(K(e,c[0].toString(),{dir:"y",dur:0,overwrite:"none"}),a.contentReset.y=null):($.call(this),"y"===s.axis?T.call(this):"yx"===s.axis&&a.overflowed[1]&&K(e,c[1].toString(),{dir:"x",dur:0,overwrite:"none"}))),"y"!==s.axis&&(a.overflowed[1]?l[1].width()>l[1].parent().width()?$.call(this):(K(e,c[1].toString(),{dir:"x",dur:0,overwrite:"none"}),a.contentReset.x=null):($.call(this),"x"===s.axis?T.call(this):"yx"===s.axis&&a.overflowed[0]&&K(e,c[0].toString(),{dir:"y",dur:0,overwrite:"none"}))),i&&a&&(2===i&&s.callbacks.onImageLoad&&"function"==typeof s.callbacks.onImageLoad?s.callbacks.onImageLoad.call(this):3===i&&s.callbacks.onSelectorChange&&"function"==typeof s.callbacks.onSelectorChange?s.callbacks.onSelectorChange.call(this):s.callbacks.onUpdate&&"function"==typeof s.callbacks.onUpdate&&s.callbacks.onUpdate.call(this)),Y.call(this)}}))},scrollTo:function(e,i){if(void 0!==e&&null!=e){var a=h.call(this);return t(a).each((function(){var a=t(this);if(a.data(n)){var s=a.data(n),o=s.opt,r={trigger:"external",scrollInertia:o.scrollInertia,scrollEasing:"mcsEaseInOut",moveDragger:!1,timeout:60,callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},l=t.extend(!0,{},r,i),c=U.call(this,e),d=l.scrollInertia>0&&l.scrollInertia<17?17:l.scrollInertia;c[0]=q.call(this,c[0],"y"),c[1]=q.call(this,c[1],"x"),l.moveDragger&&(c[0]*=s.scrollRatio.y,c[1]*=s.scrollRatio.x),l.dur=at()?0:d,setTimeout((function(){null!==c[0]&&void 0!==c[0]&&"x"!==o.axis&&s.overflowed[0]&&(l.dir="y",l.overwrite="all",K(a,c[0].toString(),l)),null!==c[1]&&void 0!==c[1]&&"y"!==o.axis&&s.overflowed[1]&&(l.dir="x",l.overwrite="none",K(a,c[1].toString(),l))}),l.timeout)}}))}},stop:function(){var e=h.call(this);return t(e).each((function(){var e=t(this);e.data(n)&&G(e)}))},disable:function(e){var i=h.call(this);return t(i).each((function(){var i=t(this);i.data(n)&&(i.data(n),Y.call(this,"remove"),T.call(this),e&&$.call(this),I.call(this,!0),i.addClass(d[3]))}))},destroy:function(){var e=h.call(this);return t(e).each((function(){var a=t(this);if(a.data(n)){var s=a.data(n),o=s.opt,r=t("#mCSB_"+s.idx),l=t("#mCSB_"+s.idx+"_container"),c=t(".mCSB_"+s.idx+"_scrollbar");o.live&&f(o.liveSelector||t(e).selector),Y.call(this,"remove"),T.call(this),$.call(this),a.removeData(n),Z(this,"mcs"),c.remove(),l.find("img."+d[2]).removeClass(d[2]),r.replaceWith(l.contents()),a.removeClass(i+" _"+n+"_"+s.idx+" "+d[6]+" "+d[7]+" "+d[5]+" "+d[3]).addClass(d[4])}}))}},h=function(){return"object"!=typeof t(this)||t(this).length<1?a:this},p=function(e){var i=["rounded","rounded-dark","rounded-dots","rounded-dots-dark"],n=["rounded-dots","rounded-dots-dark","3d","3d-dark","3d-thick","3d-thick-dark","inset","inset-dark","inset-2","inset-2-dark","inset-3","inset-3-dark"],a=["minimal","minimal-dark"],s=["minimal","minimal-dark"],o=["minimal","minimal-dark"];e.autoDraggerLength=!(t.inArray(e.theme,i)>-1)&&e.autoDraggerLength,e.autoExpandScrollbar=!(t.inArray(e.theme,n)>-1)&&e.autoExpandScrollbar,e.scrollButtons.enable=!(t.inArray(e.theme,a)>-1)&&e.scrollButtons.enable,e.autoHideScrollbar=t.inArray(e.theme,s)>-1||e.autoHideScrollbar,e.scrollbarPosition=t.inArray(e.theme,o)>-1?"outside":e.scrollbarPosition},f=function(t){r[t]&&(clearTimeout(r[t]),Z(r,t))},m=function(t){return"yx"===t||"xy"===t||"auto"===t?"yx":"x"===t||"horizontal"===t?"x":"y"},g=function(t){return"stepped"===t||"pixels"===t||"step"===t||"click"===t?"stepped":"stepless"},v=function(){var e=t(this),a=e.data(n),s=a.opt,o=s.autoExpandScrollbar?" "+d[1]+"_expand":"",r=["<div id='mCSB_"+a.idx+"_scrollbar_vertical' class='mCSB_scrollTools mCSB_"+a.idx+"_scrollbar mCS-"+s.theme+" mCSB_scrollTools_vertical"+o+"'><div class='"+d[12]+"'><div id='mCSB_"+a.idx+"_dragger_vertical' class='mCSB_dragger' style='position:absolute;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>","<div id='mCSB_"+a.idx+"_scrollbar_horizontal' class='mCSB_scrollTools mCSB_"+a.idx+"_scrollbar mCS-"+s.theme+" mCSB_scrollTools_horizontal"+o+"'><div class='"+d[12]+"'><div id='mCSB_"+a.idx+"_dragger_horizontal' class='mCSB_dragger' style='position:absolute;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>"],l="yx"===s.axis?"mCSB_vertical_horizontal":"x"===s.axis?"mCSB_horizontal":"mCSB_vertical",c="yx"===s.axis?r[0]+r[1]:"x"===s.axis?r[1]:r[0],u="yx"===s.axis?"<div id='mCSB_"+a.idx+"_container_wrapper' class='mCSB_container_wrapper' />":"",h=s.autoHideScrollbar?" "+d[6]:"",p="x"!==s.axis&&"rtl"===a.langDir?" "+d[7]:"";s.setWidth&&e.css("width",s.setWidth),s.setHeight&&e.css("height",s.setHeight),s.setLeft="y"!==s.axis&&"rtl"===a.langDir?"989999px":s.setLeft,e.addClass(i+" _"+n+"_"+a.idx+h+p).wrapInner("<div id='mCSB_"+a.idx+"' class='mCustomScrollBox mCS-"+s.theme+" "+l+"'><div id='mCSB_"+a.idx+"_container' class='mCSB_container' style='position:relative; top:"+s.setTop+"; left:"+s.setLeft+";' dir='"+a.langDir+"' /></div>");var f=t("#mCSB_"+a.idx),m=t("#mCSB_"+a.idx+"_container");"y"===s.axis||s.advanced.autoExpandHorizontalScroll||m.css("width",b(m)),"outside"===s.scrollbarPosition?("static"===e.css("position")&&e.css("position","relative"),e.css("overflow","visible"),f.addClass("mCSB_outside").after(c)):(f.addClass("mCSB_inside").append(c),m.wrap(u)),_.call(this);var g=[t("#mCSB_"+a.idx+"_dragger_vertical"),t("#mCSB_"+a.idx+"_dragger_horizontal")];g[0].css("min-height",g[0].height()),g[1].css("min-width",g[1].width())},b=function(e){var i=[e[0].scrollWidth,Math.max.apply(Math,e.children().map((function(){return t(this).outerWidth(!0)})).get())],n=e.parent().width();return i[0]>n?i[0]:i[1]>n?i[1]:"100%"},y=function(){var e=t(this).data(n),i=e.opt,a=t("#mCSB_"+e.idx+"_container");if(i.advanced.autoExpandHorizontalScroll&&"y"!==i.axis){a.css({width:"auto","min-width":0,"overflow-x":"scroll"});var s=Math.ceil(a[0].scrollWidth);3===i.advanced.autoExpandHorizontalScroll||2!==i.advanced.autoExpandHorizontalScroll&&s>a.parent().width()?a.css({width:s,"min-width":"100%","overflow-x":"inherit"}):a.css({"overflow-x":"inherit",position:"absolute"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:Math.ceil(a[0].getBoundingClientRect().right+.4)-Math.floor(a[0].getBoundingClientRect().left),"min-width":"100%",position:"relative"}).unwrap()}},_=function(){var e=t(this).data(n),i=e.opt,a=t(".mCSB_"+e.idx+"_scrollbar:first"),s=it(i.scrollButtons.tabindex)?"tabindex='"+i.scrollButtons.tabindex+"'":"",o=["<a href='#' class='"+d[13]+"' "+s+" />","<a href='#' class='"+d[14]+"' "+s+" />","<a href='#' class='"+d[15]+"' "+s+" />","<a href='#' class='"+d[16]+"' "+s+" />"],r=["x"===i.axis?o[2]:o[0],"x"===i.axis?o[3]:o[1],o[2],o[3]];i.scrollButtons.enable&&a.prepend(r[0]).append(r[1]).next(".mCSB_scrollTools").prepend(r[2]).append(r[3])},x=function(){var e=t(this).data(n),i=t("#mCSB_"+e.idx),a=t("#mCSB_"+e.idx+"_container"),s=[t("#mCSB_"+e.idx+"_dragger_vertical"),t("#mCSB_"+e.idx+"_dragger_horizontal")],o=[i.height()/a.outerHeight(!1),i.width()/a.outerWidth(!1)],r=[parseInt(s[0].css("min-height")),Math.round(o[0]*s[0].parent().height()),parseInt(s[1].css("min-width")),Math.round(o[1]*s[1].parent().width())],c=l&&r[1]<r[0]?r[0]:r[1],d=l&&r[3]<r[2]?r[2]:r[3];s[0].css({height:c,"max-height":s[0].parent().height()-10}).find(".mCSB_dragger_bar").css({"line-height":r[0]+"px"}),s[1].css({width:d,"max-width":s[1].parent().width()-10})},w=function(){var e=t(this).data(n),i=t("#mCSB_"+e.idx),a=t("#mCSB_"+e.idx+"_container"),s=[t("#mCSB_"+e.idx+"_dragger_vertical"),t("#mCSB_"+e.idx+"_dragger_horizontal")],o=[a.outerHeight(!1)-i.height(),a.outerWidth(!1)-i.width()],r=[o[0]/(s[0].parent().height()-s[0].height()),o[1]/(s[1].parent().width()-s[1].width())];e.scrollRatio={y:r[0],x:r[1]}},C=function(t,e,i){var n=i?d[0]+"_expanded":"",a=t.closest(".mCSB_scrollTools");"active"===e?(t.toggleClass(d[0]+" "+n),a.toggleClass(d[1]),t[0]._draggable=t[0]._draggable?0:1):t[0]._draggable||("hide"===e?(t.removeClass(d[0]),a.removeClass(d[1])):(t.addClass(d[0]),a.addClass(d[1])))},k=function(){var e=t(this).data(n),i=t("#mCSB_"+e.idx),a=t("#mCSB_"+e.idx+"_container"),s=null==e.overflowed?a.height():a.outerHeight(!1),o=null==e.overflowed?a.width():a.outerWidth(!1),r=a[0].scrollHeight,l=a[0].scrollWidth;return r>s&&(s=r),l>o&&(o=l),[s>i.height(),o>i.width()]},$=function(){var e=t(this),i=e.data(n),a=i.opt,s=t("#mCSB_"+i.idx),o=t("#mCSB_"+i.idx+"_container"),r=[t("#mCSB_"+i.idx+"_dragger_vertical"),t("#mCSB_"+i.idx+"_dragger_horizontal")];if(G(e),("x"!==a.axis&&!i.overflowed[0]||"y"===a.axis&&i.overflowed[0])&&(r[0].add(o).css("top",0),K(e,"_resetY")),"y"!==a.axis&&!i.overflowed[1]||"x"===a.axis&&i.overflowed[1]){var l=dx=0;"rtl"===i.langDir&&(l=s.width()-o.outerWidth(!1),dx=Math.abs(l/i.scrollRatio.x)),o.css("left",l),r[1].css("left",dx),K(e,"_resetX")}},S=function(){function e(){o=setTimeout((function(){t.event.special.mousewheel?(clearTimeout(o),E.call(i[0])):e()}),100)}var i=t(this),a=i.data(n),s=a.opt;if(!a.bindEvents){var o;if(A.call(this),s.contentTouchScroll&&P.call(this),O.call(this),s.mouseWheel.enable)e();N.call(this),F.call(this),s.advanced.autoScrollOnFocus&&B.call(this),s.scrollButtons.enable&&H.call(this),s.keyboard.enable&&z.call(this),a.bindEvents=!0}},T=function(){var e=t(this),i=e.data(n),a=i.opt,s=n+"_"+i.idx,o=".mCSB_"+i.idx+"_scrollbar",r=t("#mCSB_"+i.idx+",#mCSB_"+i.idx+"_container,#mCSB_"+i.idx+"_container_wrapper,"+o+" ."+d[12]+",#mCSB_"+i.idx+"_dragger_vertical,#mCSB_"+i.idx+"_dragger_horizontal,"+o+">a"),l=t("#mCSB_"+i.idx+"_container");a.advanced.releaseDraggableSelectors&&r.add(t(a.advanced.releaseDraggableSelectors)),a.advanced.extraDraggableSelectors&&r.add(t(a.advanced.extraDraggableSelectors)),i.bindEvents&&(t(document).add(t(!L()||top.document)).unbind("."+s),r.each((function(){t(this).unbind("."+s)})),clearTimeout(e[0]._focusTimeout),Z(e[0],"_focusTimeout"),clearTimeout(i.sequential.step),Z(i.sequential,"step"),clearTimeout(l[0].onCompleteTimeout),Z(l[0],"onCompleteTimeout"),i.bindEvents=!1)},I=function(e){var i=t(this),a=i.data(n),s=a.opt,o=t("#mCSB_"+a.idx+"_container_wrapper"),r=o.length?o:t("#mCSB_"+a.idx+"_container"),l=[t("#mCSB_"+a.idx+"_scrollbar_vertical"),t("#mCSB_"+a.idx+"_scrollbar_horizontal")],c=[l[0].find(".mCSB_dragger"),l[1].find(".mCSB_dragger")];"x"!==s.axis&&(a.overflowed[0]&&!e?(l[0].add(c[0]).add(l[0].children("a")).css("display","block"),r.removeClass(d[8]+" "+d[10])):(s.alwaysShowScrollbar?(2!==s.alwaysShowScrollbar&&c[0].css("display","none"),r.removeClass(d[10])):(l[0].css("display","none"),r.addClass(d[10])),r.addClass(d[8]))),"y"!==s.axis&&(a.overflowed[1]&&!e?(l[1].add(c[1]).add(l[1].children("a")).css("display","block"),r.removeClass(d[9]+" "+d[11])):(s.alwaysShowScrollbar?(2!==s.alwaysShowScrollbar&&c[1].css("display","none"),r.removeClass(d[11])):(l[1].css("display","none"),r.addClass(d[11])),r.addClass(d[9]))),a.overflowed[0]||a.overflowed[1]?i.removeClass(d[5]):i.addClass(d[5])},D=function(e){var i=e.type,n=e.target.ownerDocument!==document&&null!==frameElement?[t(frameElement).offset().top,t(frameElement).offset().left]:null,a=L()&&e.target.ownerDocument!==top.document&&null!==frameElement?[t(e.view.frameElement).offset().top,t(e.view.frameElement).offset().left]:[0,0];switch(i){case"pointerdown":case"MSPointerDown":case"pointermove":case"MSPointerMove":case"pointerup":case"MSPointerUp":return n?[e.originalEvent.pageY-n[0]+a[0],e.originalEvent.pageX-n[1]+a[1],!1]:[e.originalEvent.pageY,e.originalEvent.pageX,!1];case"touchstart":case"touchmove":case"touchend":var s=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],o=e.originalEvent.touches.length||e.originalEvent.changedTouches.length;return e.target.ownerDocument!==document?[s.screenY,s.screenX,o>1]:[s.pageY,s.pageX,o>1];default:return n?[e.pageY-n[0]+a[0],e.pageX-n[1]+a[1],!1]:[e.pageY,e.pageX,!1]}},A=function(){function e(t,e,n,a){if(p[0].idleTimer=d.scrollInertia<233?250:0,i.attr("id")===h[1])var s="x",l=(i[0].offsetLeft-e+a)*r.scrollRatio.x;else s="y",l=(i[0].offsetTop-t+n)*r.scrollRatio.y;K(o,l.toString(),{dir:s,drag:!0})}var i,a,s,o=t(this),r=o.data(n),d=r.opt,u=n+"_"+r.idx,h=["mCSB_"+r.idx+"_dragger_vertical","mCSB_"+r.idx+"_dragger_horizontal"],p=t("#mCSB_"+r.idx+"_container"),f=t("#"+h[0]+",#"+h[1]),m=d.advanced.releaseDraggableSelectors?f.add(t(d.advanced.releaseDraggableSelectors)):f,g=d.advanced.extraDraggableSelectors?t(!L()||top.document).add(t(d.advanced.extraDraggableSelectors)):t(!L()||top.document);f.bind("contextmenu."+u,(function(t){t.preventDefault()})).bind("mousedown."+u+" touchstart."+u+" pointerdown."+u+" MSPointerDown."+u,(function(e){if(e.stopImmediatePropagation(),e.preventDefault(),tt(e)){c=!0,l&&(document.onselectstart=function(){return!1}),j.call(p,!1),G(o);var n=(i=t(this)).offset(),r=D(e)[0]-n.top,u=D(e)[1]-n.left,h=i.height()+n.top,f=i.width()+n.left;h>r&&r>0&&f>u&&u>0&&(a=r,s=u),C(i,"active",d.autoExpandScrollbar)}})).bind("touchmove."+u,(function(t){t.stopImmediatePropagation(),t.preventDefault();var n=i.offset(),o=D(t)[0]-n.top,r=D(t)[1]-n.left;e(a,s,o,r)})),t(document).add(g).bind("mousemove."+u+" pointermove."+u+" MSPointerMove."+u,(function(t){if(i){var n=i.offset(),o=D(t)[0]-n.top,r=D(t)[1]-n.left;if(a===o&&s===r)return;e(a,s,o,r)}})).add(m).bind("mouseup."+u+" touchend."+u+" pointerup."+u+" MSPointerUp."+u,(function(){i&&(C(i,"active",d.autoExpandScrollbar),i=null),c=!1,l&&(document.onselectstart=null),j.call(p,!0)}))},P=function(){function i(t){if(!et(t)||c||D(t)[2])e=0;else{e=1,w=0,C=0,d=1,k.removeClass("mCS_touch_action");var i=A.offset();u=D(t)[0]-i.top,h=D(t)[1]-i.left,R=[D(t)[0],D(t)[1]]}}function a(t){if(et(t)&&!c&&!D(t)[2]&&(S.documentTouchScroll||t.preventDefault(),t.stopImmediatePropagation(),(!C||w)&&d)){g=Q();var e=I.offset(),i=D(t)[0]-e.top,n=D(t)[1]-e.left,a="mcsLinearOut";if(O.push(i),E.push(n),R[2]=Math.abs(D(t)[0]-R[0]),R[3]=Math.abs(D(t)[1]-R[1]),$.overflowed[0])var s=P[0].parent().height()-P[0].height(),o=u-i>0&&i-u>-s*$.scrollRatio.y&&(2*R[3]<R[2]||"yx"===S.axis);if($.overflowed[1])var r=P[1].parent().width()-P[1].width(),p=h-n>0&&n-h>-r*$.scrollRatio.x&&(2*R[2]<R[3]||"yx"===S.axis);o||p?(F||t.preventDefault(),w=1):(C=1,k.addClass("mCS_touch_action")),F&&t.preventDefault(),_="yx"===S.axis?[u-i,h-n]:"x"===S.axis?[null,h-n]:[u-i,null],A[0].idleTimer=250,$.overflowed[0]&&l(_[0],M,a,"y","all",!0),$.overflowed[1]&&l(_[1],M,a,"x",j,!0)}}function s(t){if(!et(t)||c||D(t)[2])e=0;else{e=1,t.stopImmediatePropagation(),G(k),m=Q();var i=I.offset();p=D(t)[0]-i.top,f=D(t)[1]-i.left,O=[],E=[]}}function o(t){if(et(t)&&!c&&!D(t)[2]){d=0,t.stopImmediatePropagation(),w=0,C=0,v=Q();var e=I.offset(),i=D(t)[0]-e.top,n=D(t)[1]-e.left;if(!(v-g>30)){var a="mcsEaseOut",s=2.5>(y=1e3/(v-m)),o=s?[O[O.length-2],E[E.length-2]]:[0,0];b=s?[i-o[0],n-o[1]]:[i-p,n-f];var u=[Math.abs(b[0]),Math.abs(b[1])];y=s?[Math.abs(b[0]/4),Math.abs(b[1]/4)]:[y,y];var h=[Math.abs(A[0].offsetTop)-b[0]*r(u[0]/y[0],y[0]),Math.abs(A[0].offsetLeft)-b[1]*r(u[1]/y[1],y[1])];_="yx"===S.axis?[h[0],h[1]]:"x"===S.axis?[null,h[1]]:[h[0],null],x=[4*u[0]+S.scrollInertia,4*u[1]+S.scrollInertia];var k=parseInt(S.contentTouchScroll)||0;_[0]=u[0]>k?_[0]:0,_[1]=u[1]>k?_[1]:0,$.overflowed[0]&&l(_[0],x[0],a,"y",j,!1),$.overflowed[1]&&l(_[1],x[1],a,"x",j,!1)}}}function r(t,e){var i=[1.5*e,2*e,e/1.5,e/2];return t>90?e>4?i[0]:i[3]:t>60?e>3?i[3]:i[2]:t>30?e>8?i[1]:e>6?i[0]:e>4?e:i[2]:e>8?e:i[3]}function l(t,e,i,n,a,s){t&&K(k,t.toString(),{dur:e,scrollEasing:i,dir:n,overwrite:a,drag:s})}var d,u,h,p,f,m,g,v,b,y,_,x,w,C,k=t(this),$=k.data(n),S=$.opt,T=n+"_"+$.idx,I=t("#mCSB_"+$.idx),A=t("#mCSB_"+$.idx+"_container"),P=[t("#mCSB_"+$.idx+"_dragger_vertical"),t("#mCSB_"+$.idx+"_dragger_horizontal")],O=[],E=[],M=0,j="yx"===S.axis?"none":"all",R=[],N=A.find("iframe"),B=["touchstart."+T+" pointerdown."+T+" MSPointerDown."+T,"touchmove."+T+" pointermove."+T+" MSPointerMove."+T,"touchend."+T+" pointerup."+T+" MSPointerUp."+T],F=void 0!==document.body.style.touchAction&&""!==document.body.style.touchAction;A.bind(B[0],(function(t){i(t)})).bind(B[1],(function(t){a(t)})),I.bind(B[0],(function(t){s(t)})).bind(B[2],(function(t){o(t)})),N.length&&N.each((function(){t(this).bind("load",(function(){L(this)&&t(this.contentDocument||this.contentWindow.document).bind(B[0],(function(t){i(t),s(t)})).bind(B[1],(function(t){a(t)})).bind(B[2],(function(t){o(t)}))}))}))},O=function(){function i(){return window.getSelection?window.getSelection().toString():document.selection&&"Control"!=document.selection.type?document.selection.createRange().text:0}function a(t,e,i){d.type=i&&s?"stepped":"stepless",d.scrollAmount=10,W(o,t,e,"mcsLinearOut",i?60:null)}var s,o=t(this),r=o.data(n),l=r.opt,d=r.sequential,u=n+"_"+r.idx,h=t("#mCSB_"+r.idx+"_container"),p=h.parent();h.bind("mousedown."+u,(function(){e||s||(s=1,c=!0)})).add(document).bind("mousemove."+u,(function(t){if(!e&&s&&i()){var n=h.offset(),o=D(t)[0]-n.top+h[0].offsetTop,c=D(t)[1]-n.left+h[0].offsetLeft;o>0&&o<p.height()&&c>0&&c<p.width()?d.step&&a("off",null,"stepped"):("x"!==l.axis&&r.overflowed[0]&&(0>o?a("on",38):o>p.height()&&a("on",40)),"y"!==l.axis&&r.overflowed[1]&&(0>c?a("on",37):c>p.width()&&a("on",39)))}})).bind("mouseup."+u+" dragend."+u,(function(){e||(s&&(s=0,a("off",null)),c=!1)}))},E=function(){function e(e,n){if(G(i),!R(i,e.target)){var o="auto"!==s.mouseWheel.deltaFactor?parseInt(s.mouseWheel.deltaFactor):l&&e.deltaFactor<100?100:e.deltaFactor||100,d=s.scrollInertia;if("x"===s.axis||"x"===s.mouseWheel.axis)var u="x",h=[Math.round(o*a.scrollRatio.x),parseInt(s.mouseWheel.scrollAmount)],p="auto"!==s.mouseWheel.scrollAmount?h[1]:h[0]>=r.width()?.9*r.width():h[0],f=Math.abs(t("#mCSB_"+a.idx+"_container")[0].offsetLeft),m=c[1][0].offsetLeft,g=c[1].parent().width()-c[1].width(),v="y"===s.mouseWheel.axis?e.deltaY||n:e.deltaX;else u="y",h=[Math.round(o*a.scrollRatio.y),parseInt(s.mouseWheel.scrollAmount)],p="auto"!==s.mouseWheel.scrollAmount?h[1]:h[0]>=r.height()?.9*r.height():h[0],f=Math.abs(t("#mCSB_"+a.idx+"_container")[0].offsetTop),m=c[0][0].offsetTop,g=c[0].parent().height()-c[0].height(),v=e.deltaY||n;"y"===u&&!a.overflowed[0]||"x"===u&&!a.overflowed[1]||((s.mouseWheel.invert||e.webkitDirectionInvertedFromDevice)&&(v=-v),s.mouseWheel.normalizeDelta&&(v=0>v?-1:1),(v>0&&0!==m||0>v&&m!==g||s.mouseWheel.preventDefault)&&(e.stopImmediatePropagation(),e.preventDefault()),e.deltaFactor<5&&!s.mouseWheel.normalizeDelta&&(p=e.deltaFactor,d=17),K(i,(f-v*p).toString(),{dir:u,dur:d}))}}if(t(this).data(n)){var i=t(this),a=i.data(n),s=a.opt,o=n+"_"+a.idx,r=t("#mCSB_"+a.idx),c=[t("#mCSB_"+a.idx+"_dragger_vertical"),t("#mCSB_"+a.idx+"_dragger_horizontal")],d=t("#mCSB_"+a.idx+"_container").find("iframe");d.length&&d.each((function(){t(this).bind("load",(function(){L(this)&&t(this.contentDocument||this.contentWindow.document).bind("mousewheel."+o,(function(t,i){e(t,i)}))}))})),r.bind("mousewheel."+o,(function(t,i){e(t,i)}))}},M=new Object,L=function(e){var i=!1,n=!1,a=null;if(void 0===e?n="#empty":void 0!==t(e).attr("id")&&(n=t(e).attr("id")),!1!==n&&void 0!==M[n])return M[n];if(e){try{a=(e.contentDocument||e.contentWindow.document).body.innerHTML}catch(t){}i=null!==a}else{try{a=top.document.body.innerHTML}catch(t){}i=null!==a}return!1!==n&&(M[n]=i),i},j=function(t){var e=this.find("iframe");if(e.length){var i=t?"auto":"none";e.css("pointer-events",i)}},R=function(e,i){var a=i.nodeName.toLowerCase(),s=e.data(n).opt.mouseWheel.disableOver,o=["select","textarea"];return t.inArray(a,s)>-1&&!(t.inArray(a,o)>-1&&!t(i).is(":focus"))},N=function(){var e,i=t(this),a=i.data(n),s=n+"_"+a.idx,o=t("#mCSB_"+a.idx+"_container"),r=o.parent();t(".mCSB_"+a.idx+"_scrollbar ."+d[12]).bind("mousedown."+s+" touchstart."+s+" pointerdown."+s+" MSPointerDown."+s,(function(i){c=!0,t(i.target).hasClass("mCSB_dragger")||(e=1)})).bind("touchend."+s+" pointerup."+s+" MSPointerUp."+s,(function(){c=!1})).bind("click."+s,(function(n){if(e&&(e=0,t(n.target).hasClass(d[12])||t(n.target).hasClass("mCSB_draggerRail"))){G(i);var s=t(this),l=s.find(".mCSB_dragger");if(s.parent(".mCSB_scrollTools_horizontal").length>0){if(!a.overflowed[1])return;var c="x",u=n.pageX>l.offset().left?-1:1,h=Math.abs(o[0].offsetLeft)-u*(.9*r.width())}else{if(!a.overflowed[0])return;c="y",u=n.pageY>l.offset().top?-1:1,h=Math.abs(o[0].offsetTop)-u*(.9*r.height())}K(i,h.toString(),{dir:c,scrollEasing:"mcsEaseInOut"})}}))},B=function(){var e=t(this),i=e.data(n),a=i.opt,s=n+"_"+i.idx,o=t("#mCSB_"+i.idx+"_container"),r=o.parent();o.bind("focusin."+s,(function(){var i=t(document.activeElement),n=o.find(".mCustomScrollBox").length,s=0;i.is(a.advanced.autoScrollOnFocus)&&(G(e),clearTimeout(e[0]._focusTimeout),e[0]._focusTimer=n?(s+17)*n:0,e[0]._focusTimeout=setTimeout((function(){var t=[nt(i)[0],nt(i)[1]],n=[o[0].offsetTop,o[0].offsetLeft],l=[n[0]+t[0]>=0&&n[0]+t[0]<r.height()-i.outerHeight(!1),n[1]+t[1]>=0&&n[0]+t[1]<r.width()-i.outerWidth(!1)],c="yx"!==a.axis||l[0]||l[1]?"all":"none";"x"===a.axis||l[0]||K(e,t[0].toString(),{dir:"y",scrollEasing:"mcsEaseInOut",overwrite:c,dur:s}),"y"===a.axis||l[1]||K(e,t[1].toString(),{dir:"x",scrollEasing:"mcsEaseInOut",overwrite:c,dur:s})}),e[0]._focusTimer))}))},F=function(){var e=t(this).data(n),i=n+"_"+e.idx,a=t("#mCSB_"+e.idx+"_container").parent();a.bind("scroll."+i,(function(){0===a.scrollTop()&&0===a.scrollLeft()||t(".mCSB_"+e.idx+"_scrollbar").css("visibility","hidden")}))},H=function(){var e=t(this),i=e.data(n),a=i.opt,s=i.sequential,o=n+"_"+i.idx,r=".mCSB_"+i.idx+"_scrollbar";t(r+">a").bind("contextmenu."+o,(function(t){t.preventDefault()})).bind("mousedown."+o+" touchstart."+o+" pointerdown."+o+" MSPointerDown."+o+" mouseup."+o+" touchend."+o+" pointerup."+o+" MSPointerUp."+o+" mouseout."+o+" pointerout."+o+" MSPointerOut."+o+" click."+o,(function(n){function o(t,i){s.scrollAmount=a.scrollButtons.scrollAmount,W(e,t,i)}if(n.preventDefault(),tt(n)){var r=t(this).attr("class");switch(s.type=a.scrollButtons.scrollType,n.type){case"mousedown":case"touchstart":case"pointerdown":case"MSPointerDown":if("stepped"===s.type)return;c=!0,i.tweenRunning=!1,o("on",r);break;case"mouseup":case"touchend":case"pointerup":case"MSPointerUp":case"mouseout":case"pointerout":case"MSPointerOut":if("stepped"===s.type)return;c=!1,s.dir&&o("off",r);break;case"click":if("stepped"!==s.type||i.tweenRunning)return;o("on",r)}}}))},z=function(){function e(e){function n(t,e){o.type=s.keyboard.scrollType,o.scrollAmount=s.keyboard.scrollAmount,"stepped"===o.type&&a.tweenRunning||W(i,t,e)}switch(e.type){case"blur":a.tweenRunning&&o.dir&&n("off",null);break;case"keydown":case"keyup":var r=e.keyCode?e.keyCode:e.which,l="on";if("x"!==s.axis&&(38===r||40===r)||"y"!==s.axis&&(37===r||39===r)){if((38===r||40===r)&&!a.overflowed[0]||(37===r||39===r)&&!a.overflowed[1])return;"keyup"===e.type&&(l="off"),t(document.activeElement).is(u)||(e.preventDefault(),e.stopImmediatePropagation(),n(l,r))}else if(33===r||34===r){if((a.overflowed[0]||a.overflowed[1])&&(e.preventDefault(),e.stopImmediatePropagation()),"keyup"===e.type){G(i);var h=34===r?-1:1;if("x"===s.axis||"yx"===s.axis&&a.overflowed[1]&&!a.overflowed[0])var p="x",f=Math.abs(c[0].offsetLeft)-h*(.9*d.width());else p="y",f=Math.abs(c[0].offsetTop)-h*(.9*d.height());K(i,f.toString(),{dir:p,scrollEasing:"mcsEaseInOut"})}}else if((35===r||36===r)&&!t(document.activeElement).is(u)&&((a.overflowed[0]||a.overflowed[1])&&(e.preventDefault(),e.stopImmediatePropagation()),"keyup"===e.type)){if("x"===s.axis||"yx"===s.axis&&a.overflowed[1]&&!a.overflowed[0])p="x",f=35===r?Math.abs(d.width()-c.outerWidth(!1)):0;else p="y",f=35===r?Math.abs(d.height()-c.outerHeight(!1)):0;K(i,f.toString(),{dir:p,scrollEasing:"mcsEaseInOut"})}}}var i=t(this),a=i.data(n),s=a.opt,o=a.sequential,r=n+"_"+a.idx,l=t("#mCSB_"+a.idx),c=t("#mCSB_"+a.idx+"_container"),d=c.parent(),u="input,textarea,select,datalist,keygen,[contenteditable='true']",h=c.find("iframe"),p=["blur."+r+" keydown."+r+" keyup."+r];h.length&&h.each((function(){t(this).bind("load",(function(){L(this)&&t(this.contentDocument||this.contentWindow.document).bind(p[0],(function(t){e(t)}))}))})),l.attr("tabindex","0").bind(p[0],(function(t){e(t)}))},W=function(e,i,a,s,o){function r(t){u.snapAmount&&(h.scrollAmount=u.snapAmount instanceof Array?"x"===h.dir[0]?u.snapAmount[1]:u.snapAmount[0]:u.snapAmount);var i="stepped"!==h.type,n=o||(t?i?m/1.5:g:1e3/60),a=t?i?7.5:40:2.5,l=[Math.abs(p[0].offsetTop),Math.abs(p[0].offsetLeft)],d=[c.scrollRatio.y>10?10:c.scrollRatio.y,c.scrollRatio.x>10?10:c.scrollRatio.x],f="x"===h.dir[0]?l[1]+h.dir[1]*(d[1]*a):l[0]+h.dir[1]*(d[0]*a),v="x"===h.dir[0]?l[1]+h.dir[1]*parseInt(h.scrollAmount):l[0]+h.dir[1]*parseInt(h.scrollAmount),b="auto"!==h.scrollAmount?v:f,y=s||(t?i?"mcsLinearOut":"mcsEaseInOut":"mcsLinear"),_=!!t;return t&&17>n&&(b="x"===h.dir[0]?l[1]:l[0]),K(e,b.toString(),{dir:h.dir[0],scrollEasing:y,dur:n,onComplete:_}),t?void(h.dir=!1):(clearTimeout(h.step),void(h.step=setTimeout((function(){r()}),n)))}function l(){clearTimeout(h.step),Z(h,"step"),G(e)}var c=e.data(n),u=c.opt,h=c.sequential,p=t("#mCSB_"+c.idx+"_container"),f="stepped"===h.type,m=u.scrollInertia<26?26:u.scrollInertia,g=u.scrollInertia<1?17:u.scrollInertia;switch(i){case"on":if(h.dir=[a===d[16]||a===d[15]||39===a||37===a?"x":"y",a===d[13]||a===d[15]||38===a||37===a?-1:1],G(e),it(a)&&"stepped"===h.type)return;r(f);break;case"off":l(),(f||c.tweenRunning&&h.dir)&&r(!0)}},U=function(e){var i=t(this).data(n).opt,a=[];return"function"==typeof e&&(e=e()),e instanceof Array?a=e.length>1?[e[0],e[1]]:"x"===i.axis?[null,e[0]]:[e[0],null]:(a[0]=e.y?e.y:e.x||"x"===i.axis?null:e,a[1]=e.x?e.x:e.y||"y"===i.axis?null:e),"function"==typeof a[0]&&(a[0]=a[0]()),"function"==typeof a[1]&&(a[1]=a[1]()),a},q=function(e,i){if(null!=e&&void 0!==e){var a=t(this),s=a.data(n),o=s.opt,r=t("#mCSB_"+s.idx+"_container"),l=r.parent(),c=typeof e;i||(i="x"===o.axis?"x":"y");var d="x"===i?r.outerWidth(!1)-l.width():r.outerHeight(!1)-l.height(),h="x"===i?r[0].offsetLeft:r[0].offsetTop,p="x"===i?"left":"top";switch(c){case"function":return e();case"object":if(!(m=e.jquery?e:t(e)).length)return;return"x"===i?nt(m)[1]:nt(m)[0];case"string":case"number":if(it(e))return Math.abs(e);if(-1!==e.indexOf("%"))return Math.abs(d*parseInt(e)/100);if(-1!==e.indexOf("-="))return Math.abs(h-parseInt(e.split("-=")[1]));if(-1!==e.indexOf("+=")){var f=h+parseInt(e.split("+=")[1]);return f>=0?0:Math.abs(f)}if(-1!==e.indexOf("px")&&it(e.split("px")[0]))return Math.abs(e.split("px")[0]);if("top"===e||"left"===e)return 0;if("bottom"===e)return Math.abs(l.height()-r.outerHeight(!1));if("right"===e)return Math.abs(l.width()-r.outerWidth(!1));if("first"===e||"last"===e){var m=r.find(":"+e);return"x"===i?nt(m)[1]:nt(m)[0]}return t(e).length?"x"===i?nt(t(e))[1]:nt(t(e))[0]:(r.css(p,e),void u.update.call(null,a[0]))}}},Y=function(e){function i(){return clearTimeout(h[0].autoUpdate),0===r.parents("html").length?void(r=null):void(h[0].autoUpdate=setTimeout((function(){return c.advanced.updateOnSelectorChange&&(l.poll.change.n=s(),l.poll.change.n!==l.poll.change.o)?(l.poll.change.o=l.poll.change.n,void o(3)):c.advanced.updateOnContentResize&&(l.poll.size.n=r[0].scrollHeight+r[0].scrollWidth+h[0].offsetHeight+r[0].offsetHeight+r[0].offsetWidth,l.poll.size.n!==l.poll.size.o)?(l.poll.size.o=l.poll.size.n,void o(1)):!c.advanced.updateOnImageLoad||"auto"===c.advanced.updateOnImageLoad&&"y"===c.axis||(l.poll.img.n=h.find("img").length,l.poll.img.n===l.poll.img.o)?void((c.advanced.updateOnSelectorChange||c.advanced.updateOnContentResize||c.advanced.updateOnImageLoad)&&i()):(l.poll.img.o=l.poll.img.n,void h.find("img").each((function(){a(this)})))}),c.advanced.autoUpdateTimeout))}function a(e){function i(t,e){return function(){return e.apply(t,arguments)}}function n(){this.onload=null,t(e).addClass(d[2]),o(2)}if(t(e).hasClass(d[2]))o();else{var a=new Image;a.onload=i(a,n),a.src=e.src}}function s(){!0===c.advanced.updateOnSelectorChange&&(c.advanced.updateOnSelectorChange="*");var t=0,e=h.find(c.advanced.updateOnSelectorChange);return c.advanced.updateOnSelectorChange&&e.length>0&&e.each((function(){t+=this.offsetHeight+this.offsetWidth})),t}function o(t){clearTimeout(h[0].autoUpdate),u.update.call(null,r[0],t)}var r=t(this),l=r.data(n),c=l.opt,h=t("#mCSB_"+l.idx+"_container");return e?(clearTimeout(h[0].autoUpdate),void Z(h[0],"autoUpdate")):void i()},V=function(t,e,i){return Math.round(t/e)*e-i},G=function(e){var i=e.data(n);t("#mCSB_"+i.idx+"_container,#mCSB_"+i.idx+"_container_wrapper,#mCSB_"+i.idx+"_dragger_vertical,#mCSB_"+i.idx+"_dragger_horizontal").each((function(){J.call(this)}))},K=function(e,i,a){function s(t){return l&&c.callbacks[t]&&"function"==typeof c.callbacks[t]}function o(){return[c.callbacks.alwaysTriggerOffsets||_>=x[0]+k,c.callbacks.alwaysTriggerOffsets||-$>=_]}function r(){var t=[p[0].offsetTop,p[0].offsetLeft],i=[b[0].offsetTop,b[0].offsetLeft],n=[p.outerHeight(!1),p.outerWidth(!1)],s=[h.height(),h.width()];e[0].mcs={content:p,top:t[0],left:t[1],draggerTop:i[0],draggerLeft:i[1],topPct:Math.round(100*Math.abs(t[0])/(Math.abs(n[0])-s[0])),leftPct:Math.round(100*Math.abs(t[1])/(Math.abs(n[1])-s[1])),direction:a.dir}}var l=e.data(n),c=l.opt,d={trigger:"internal",dir:"y",scrollEasing:"mcsEaseOut",drag:!1,dur:c.scrollInertia,overwrite:"all",callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},u=[(a=t.extend(d,a)).dur,a.drag?0:a.dur],h=t("#mCSB_"+l.idx),p=t("#mCSB_"+l.idx+"_container"),f=p.parent(),m=c.callbacks.onTotalScrollOffset?U.call(e,c.callbacks.onTotalScrollOffset):[0,0],g=c.callbacks.onTotalScrollBackOffset?U.call(e,c.callbacks.onTotalScrollBackOffset):[0,0];if(l.trigger=a.trigger,0===f.scrollTop()&&0===f.scrollLeft()||(t(".mCSB_"+l.idx+"_scrollbar").css("visibility","visible"),f.scrollTop(0).scrollLeft(0)),"_resetY"!==i||l.contentReset.y||(s("onOverflowYNone")&&c.callbacks.onOverflowYNone.call(e[0]),l.contentReset.y=1),"_resetX"!==i||l.contentReset.x||(s("onOverflowXNone")&&c.callbacks.onOverflowXNone.call(e[0]),l.contentReset.x=1),"_resetY"!==i&&"_resetX"!==i){if(!l.contentReset.y&&e[0].mcs||!l.overflowed[0]||(s("onOverflowY")&&c.callbacks.onOverflowY.call(e[0]),l.contentReset.x=null),!l.contentReset.x&&e[0].mcs||!l.overflowed[1]||(s("onOverflowX")&&c.callbacks.onOverflowX.call(e[0]),l.contentReset.x=null),c.snapAmount){var v=c.snapAmount instanceof Array?"x"===a.dir?c.snapAmount[1]:c.snapAmount[0]:c.snapAmount;i=V(i,v,c.snapOffset)}switch(a.dir){case"x":var b=t("#mCSB_"+l.idx+"_dragger_horizontal"),y="left",_=p[0].offsetLeft,x=[h.width()-p.outerWidth(!1),b.parent().width()-b.width()],w=[i,0===i?0:i/l.scrollRatio.x],k=m[1],$=g[1],S=k>0?k/l.scrollRatio.x:0,T=$>0?$/l.scrollRatio.x:0;break;case"y":b=t("#mCSB_"+l.idx+"_dragger_vertical"),y="top",_=p[0].offsetTop,x=[h.height()-p.outerHeight(!1),b.parent().height()-b.height()],w=[i,0===i?0:i/l.scrollRatio.y],k=m[0],$=g[0],S=k>0?k/l.scrollRatio.y:0,T=$>0?$/l.scrollRatio.y:0}w[1]<0||0===w[0]&&0===w[1]?w=[0,0]:w[1]>=x[1]?w=[x[0],x[1]]:w[0]=-w[0],e[0].mcs||(r(),s("onInit")&&c.callbacks.onInit.call(e[0])),clearTimeout(p[0].onCompleteTimeout),X(b[0],y,Math.round(w[1]),u[1],a.scrollEasing),!l.tweenRunning&&(0===_&&w[0]>=0||_===x[0]&&w[0]<=x[0])||X(p[0],y,Math.round(w[0]),u[0],a.scrollEasing,a.overwrite,{onStart:function(){a.callbacks&&a.onStart&&!l.tweenRunning&&(s("onScrollStart")&&(r(),c.callbacks.onScrollStart.call(e[0])),l.tweenRunning=!0,C(b),l.cbOffsets=o())},onUpdate:function(){a.callbacks&&a.onUpdate&&s("whileScrolling")&&(r(),c.callbacks.whileScrolling.call(e[0]))},onComplete:function(){if(a.callbacks&&a.onComplete){"yx"===c.axis&&clearTimeout(p[0].onCompleteTimeout);var t=p[0].idleTimer||0;p[0].onCompleteTimeout=setTimeout((function(){s("onScroll")&&(r(),c.callbacks.onScroll.call(e[0])),s("onTotalScroll")&&w[1]>=x[1]-S&&l.cbOffsets[0]&&(r(),c.callbacks.onTotalScroll.call(e[0])),s("onTotalScrollBack")&&w[1]<=T&&l.cbOffsets[1]&&(r(),c.callbacks.onTotalScrollBack.call(e[0])),l.tweenRunning=!1,p[0].idleTimer=0,C(b,"hide")}),t)}}})}},X=function(t,e,i,n,a,s,o){function r(){x.stop||(b||f.call(),b=Q()-v,l(),b>=x.time&&(x.time=b>x.time?b+h-(b-x.time):b+h-1,x.time<b+1&&(x.time=b+1)),x.time<n?x.id=p(r):g.call())}function l(){n>0?(x.currVal=u(x.time,y,w,n,a),_[e]=Math.round(x.currVal)+"px"):_[e]=i+"px",m.call()}function c(){h=1e3/60,x.time=b+h,p=window.requestAnimationFrame?window.requestAnimationFrame:function(t){return l(),setTimeout(t,.01)},x.id=p(r)}function d(){null!=x.id&&(window.requestAnimationFrame?window.cancelAnimationFrame(x.id):clearTimeout(x.id),x.id=null)}function u(t,e,i,n,a){switch(a){case"linear":case"mcsLinear":return i*t/n+e;case"mcsLinearOut":return t/=n,t--,i*Math.sqrt(1-t*t)+e;case"easeInOutSmooth":return 1>(t/=n/2)?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e;case"easeInOutStrong":return 1>(t/=n/2)?i/2*Math.pow(2,10*(t-1))+e:(t--,i/2*(2-Math.pow(2,-10*t))+e);case"easeInOut":case"mcsEaseInOut":return 1>(t/=n/2)?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e;case"easeOutSmooth":return t/=n,-i*(--t*t*t*t-1)+e;case"easeOutStrong":return i*(1-Math.pow(2,-10*t/n))+e;default:var s=(t/=n)*t,o=s*t;return e+i*(.499999999999997*o*s+-2.5*s*s+5.5*o+-6.5*s+4*t)}}t._mTween||(t._mTween={top:{},left:{}});var h,p,f=(o=o||{}).onStart||function(){},m=o.onUpdate||function(){},g=o.onComplete||function(){},v=Q(),b=0,y=t.offsetTop,_=t.style,x=t._mTween[e];"left"===e&&(y=t.offsetLeft);var w=i-y;x.stop=0,"none"!==s&&d(),c()},Q=function(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?Date.now():(new Date).getTime()},J=function(){var t=this;t._mTween||(t._mTween={top:{},left:{}});for(var e=["top","left"],i=0;i<e.length;i++){var n=e[i];t._mTween[n].id&&(window.requestAnimationFrame?window.cancelAnimationFrame(t._mTween[n].id):clearTimeout(t._mTween[n].id),t._mTween[n].id=null,t._mTween[n].stop=1)}},Z=function(t,e){try{delete t[e]}catch(i){t[e]=null}},tt=function(t){return!(t.which&&1!==t.which)},et=function(t){var e=t.originalEvent.pointerType;return!(e&&"touch"!==e&&2!==e)},it=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},nt=function(t){var e=t.parents(".mCSB_container");return[t.offset().top-e.offset().top,t.offset().left-e.offset().left]},at=function(){function t(){var t=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var e=0;e<t.length;e++)if(t[e]+"Hidden"in document)return t[e]+"Hidden";return null}var e=t();return!!e&&document[e]};t.fn[i]=function(e){return u[e]?u[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist"):u.init.apply(this,arguments)},t[i]=function(e){return u[e]?u[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist"):u.init.apply(this,arguments)},t[i].defaults=s,window[i]=!0,t(window).bind("load",(function(){t(a)[i](),t.extend(t.expr[":"],{mcsInView:t.expr[":"].mcsInView||function(e){var i,n,a=t(e),s=a.parents(".mCSB_container");if(s.length)return i=s.parent(),(n=[s[0].offsetTop,s[0].offsetLeft])[0]+nt(a)[0]>=0&&n[0]+nt(a)[0]<i.height()-a.outerHeight(!1)&&n[1]+nt(a)[1]>=0&&n[1]+nt(a)[1]<i.width()-a.outerWidth(!1)},mcsInSight:t.expr[":"].mcsInSight||function(e,i,n){var a,s,o,r,l=t(e),c=l.parents(".mCSB_container"),d="exact"===n[3]?[[1,0],[1,0]]:[[.9,.1],[.6,.4]];if(c.length)return a=[l.outerHeight(!1),l.outerWidth(!1)],o=[c[0].offsetTop+nt(l)[0],c[0].offsetLeft+nt(l)[1]],s=[c.parent()[0].offsetHeight,c.parent()[0].offsetWidth],r=[a[0]<s[0]?d[0]:d[1],a[1]<s[1]?d[0]:d[1]],o[0]-s[0]*r[0][0]<0&&o[0]+a[0]-s[0]*r[0][1]>=0&&o[1]-s[1]*r[1][0]<0&&o[1]+a[1]-s[1]*r[1][1]>=0},mcsOverflow:t.expr[":"].mcsOverflow||function(e){var i=t(e).data(n);if(i)return i.overflowed[0]||i.overflowed[1]}})}))}()}()}));var ogame=ogame||{};!function(t){"function"==typeof define&&define.amd?define(["./jquery"],t):"object"==typeof exports?t(require("./jquery")):t(jQuery)}((function(t){var e=function(){if(t&&t.fn&&t.fn.select2&&t.fn.select2.amd)var e=t.fn.select2.amd;var i,n,a;return e&&e.requirejs||(e?n=e:e={},function(t){var e,s,o,r,l={},c={},d={},u={},h=Object.prototype.hasOwnProperty,p=[].slice,f=/\.js$/;function m(t,e){return h.call(t,e)}function g(t,e){var i,n,a,s,o,r,l,c,u,h,p,m=e&&e.split("/"),g=d.map,v=g&&g["*"]||{};if(t&&"."===t.charAt(0))if(e){for(m=m.slice(0,m.length-1),o=(t=t.split("/")).length-1,d.nodeIdCompat&&f.test(t[o])&&(t[o]=t[o].replace(f,"")),t=m.concat(t),u=0;u<t.length;u+=1)if("."===(p=t[u]))t.splice(u,1),u-=1;else if(".."===p){if(1===u&&(".."===t[2]||".."===t[0]))break;u>0&&(t.splice(u-1,2),u-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((m||v)&&g){for(u=(i=t.split("/")).length;u>0;u-=1){if(n=i.slice(0,u).join("/"),m)for(h=m.length;h>0;h-=1)if((a=g[m.slice(0,h).join("/")])&&(a=a[n])){s=a,r=u;break}if(s)break;!l&&v&&v[n]&&(l=v[n],c=u)}!s&&l&&(s=l,r=c),s&&(i.splice(0,r,s),t=i.join("/"))}return t}function v(e,i){return function(){return s.apply(t,p.call(arguments,0).concat([e,i]))}}function b(t){return function(e){l[t]=e}}function y(i){if(m(c,i)){var n=c[i];delete c[i],u[i]=!0,e.apply(t,n)}if(!m(l,i)&&!m(u,i))throw new Error("No "+i);return l[i]}function _(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function x(t){return function(){return d&&d.config&&d.config[t]||{}}}o=function(t,e){var i,n=_(t),a=n[0];return t=n[1],a&&(i=y(a=g(a,e))),a?t=i&&i.normalize?i.normalize(t,function(t){return function(e){return g(e,t)}}(e)):g(t,e):(a=(n=_(t=g(t,e)))[0],t=n[1],a&&(i=y(a))),{f:a?a+"!"+t:t,n:t,pr:a,p:i}},r={require:function(t){return v(t)},exports:function(t){var e=l[t];return void 0!==e?e:l[t]={}},module:function(t){return{id:t,uri:"",exports:l[t],config:x(t)}}},e=function(e,i,n,a){var s,d,h,p,f,g,_=[],x=typeof n;if(a=a||e,"undefined"===x||"function"===x){for(i=!i.length&&n.length?["require","exports","module"]:i,f=0;f<i.length;f+=1)if("require"===(d=(p=o(i[f],a)).f))_[f]=r.require(e);else if("exports"===d)_[f]=r.exports(e),g=!0;else if("module"===d)s=_[f]=r.module(e);else if(m(l,d)||m(c,d)||m(u,d))_[f]=y(d);else{if(!p.p)throw new Error(e+" missing "+d);p.p.load(p.n,v(a,!0),b(d),{}),_[f]=l[d]}h=n?n.apply(l[e],_):void 0,e&&(s&&s.exports!==t&&s.exports!==l[e]?l[e]=s.exports:h===t&&g||(l[e]=h))}else e&&(l[e]=n)},i=n=s=function(i,n,a,l,c){if("string"==typeof i)return r[i]?r[i](n):y(o(i,n).f);if(!i.splice){if((d=i).deps&&s(d.deps,d.callback),!n)return;n.splice?(i=n,n=a,a=null):i=t}return n=n||function(){},"function"==typeof a&&(a=l,l=c),l?e(t,i,n,a):setTimeout((function(){e(t,i,n,a)}),4),s},s.config=function(t){return s(t)},i._defined=l,(a=function(t,e,i){e.splice||(i=e,e=[]),m(l,t)||m(c,t)||(c[t]=[t,e,i])}).amd={jQuery:!0}}(),e.requirejs=i,e.require=n,e.define=a),e.define("almond",(function(){})),e.define("jquery",[],(function(){var e=t||$;return null==e&&console&&console.error&&console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page."),e})),e.define("select2/utils",["jquery"],(function(t){var e={};function i(t){var e=t.prototype,i=[];for(var n in e){"function"==typeof e[n]&&("constructor"!==n&&i.push(n))}return i}e.Extend=function(t,e){var i={}.hasOwnProperty;function n(){this.constructor=t}for(var a in e)i.call(e,a)&&(t[a]=e[a]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},e.Decorate=function(t,e){var n=i(e),a=i(t);function s(){var i=Array.prototype.unshift,n=e.prototype.constructor.length,a=t.prototype.constructor;n>0&&(i.call(arguments,t.prototype.constructor),a=e.prototype.constructor),a.apply(this,arguments)}e.displayName=t.displayName,s.prototype=new function(){this.constructor=s};for(var o=0;o<a.length;o++){var r=a[o];s.prototype[r]=t.prototype[r]}for(var l=function(t){var i=function(){};t in s.prototype&&(i=s.prototype[t]);var n=e.prototype[t];return function(){return Array.prototype.unshift.call(arguments,i),n.apply(this,arguments)}},c=0;c<n.length;c++){var d=n[c];s.prototype[d]=l(d)}return s};var n=function(){this.listeners={}};return n.prototype.on=function(t,e){this.listeners=this.listeners||{},t in this.listeners?this.listeners[t].push(e):this.listeners[t]=[e]},n.prototype.trigger=function(t){var e=Array.prototype.slice;this.listeners=this.listeners||{},t in this.listeners&&this.invoke(this.listeners[t],e.call(arguments,1)),"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},n.prototype.invoke=function(t,e){for(var i=0,n=t.length;i<n;i++)t[i].apply(this,e)},e.Observable=n,e.generateChars=function(t){for(var e="",i=0;i<t;i++){e+=Math.floor(36*Math.random()).toString(36)}return e},e.bind=function(t,e){return function(){t.apply(e,arguments)}},e._convertData=function(t){for(var e in t){var i=e.split("-"),n=t;if(1!==i.length){for(var a=0;a<i.length;a++){var s=i[a];(s=s.substring(0,1).toLowerCase()+s.substring(1))in n||(n[s]={}),a==i.length-1&&(n[s]=t[e]),n=n[s]}delete t[e]}}return t},e.hasScroll=function(e,i){var n=t(i),a=i.style.overflowX,s=i.style.overflowY;return(a!==s||"hidden"!==s&&"visible"!==s)&&("scroll"===a||"scroll"===s||(n.innerHeight()<i.scrollHeight||n.innerWidth()<i.scrollWidth))},e.escapeMarkup=function(t){var e={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!=typeof t?t:String(t).replace(/[&<>"'\/\\]/g,(function(t){return e[t]}))},e.appendMany=function(e,i){if("1.7"===t.fn.jquery.substr(0,3)){var n=t();t.map(i,(function(t){n=n.add(t)})),i=n}e.append(i)},e})),e.define("select2/results",["jquery","./utils"],(function(t,e){function i(t,e,n){this.$element=t,this.data=n,this.options=e,i.__super__.constructor.call(this)}return e.Extend(i,e.Observable),i.prototype.render=function(){var e=t('<ul class="select2-results__options" role="tree"></ul>');return this.options.get("multiple")&&e.attr("aria-multiselectable","true"),this.$results=e,e},i.prototype.clear=function(){this.$results.empty()},i.prototype.displayMessage=function(e){var i=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var n=t('<li role="treeitem" class="select2-results__option"></li>'),a=this.options.get("translations").get(e.message);n.append(i(a(e.args))),this.$results.append(n)},i.prototype.append=function(t){this.hideLoading();var e=[];if(null!=t.results&&0!==t.results.length){t.results=this.sort(t.results);for(var i=0;i<t.results.length;i++){var n=t.results[i],a=this.option(n);e.push(a)}this.$results.append(e)}else 0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"})},i.prototype.position=function(t,e){e.find(".select2-results").append(t)},i.prototype.sort=function(t){return this.options.get("sorter")(t)},i.prototype.setClasses=function(){var e=this;this.data.current((function(i){var n=t.map(i,(function(t){return t.id.toString()})),a=e.$results.find(".select2-results__option[aria-selected]");a.each((function(){var e=t(this),i=t.data(this,"data"),a=""+i.id;null!=i.element&&i.element.selected||null==i.element&&t.inArray(a,n)>-1?e.attr("aria-selected","true"):e.attr("aria-selected","false")}));var s=a.filter("[aria-selected=true]");s.length>0?s.first().trigger("mouseenter"):a.first().trigger("mouseenter")}))},i.prototype.showLoading=function(t){this.hideLoading();var e={disabled:!0,loading:!0,text:this.options.get("translations").get("searching")(t)},i=this.option(e);i.className+=" loading-results",this.$results.prepend(i)},i.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},i.prototype.option=function(e){var i=document.createElement("li");i.className="select2-results__option";var n={role:"treeitem","aria-selected":"false"};for(var a in e.disabled&&(delete n["aria-selected"],n["aria-disabled"]="true"),null==e.id&&delete n["aria-selected"],null!=e._resultId&&(i.id=e._resultId),e.title&&(i.title=e.title),e.children&&(n.role="group",n["aria-label"]=e.text,delete n["aria-selected"]),n){var s=n[a];i.setAttribute(a,s)}if(e.children){var o=t(i),r=document.createElement("strong");r.className="select2-results__group";t(r);this.template(e,r);for(var l=[],c=0;c<e.children.length;c++){var d=e.children[c],u=this.option(d);l.push(u)}var h=t("<ul></ul>",{class:"select2-results__options select2-results__options--nested"});h.append(l),o.append(r),o.append(h)}else this.template(e,i);return t.data(i,"data",e),i},i.prototype.bind=function(e,i){var n=this,a=e.id+"-results";this.$results.attr("id",a),e.on("results:all",(function(t){n.clear(),n.append(t.data),e.isOpen()&&n.setClasses()})),e.on("results:append",(function(t){n.append(t.data),e.isOpen()&&n.setClasses()})),e.on("query",(function(t){n.showLoading(t)})),e.on("select",(function(){e.isOpen()&&n.setClasses()})),e.on("unselect",(function(){e.isOpen()&&n.setClasses()})),e.on("open",(function(){n.$results.attr("aria-expanded","true"),n.$results.attr("aria-hidden","false"),n.setClasses(),n.ensureHighlightVisible()})),e.on("close",(function(){n.$results.attr("aria-expanded","false"),n.$results.attr("aria-hidden","true"),n.$results.removeAttr("aria-activedescendant")})),e.on("results:toggle",(function(){var t=n.getHighlightedResults();0!==t.length&&t.trigger("mouseup")})),e.on("results:select",(function(){var t=n.getHighlightedResults();if(0!==t.length){var e=t.data("data");"true"==t.attr("aria-selected")?n.trigger("close"):n.trigger("select",{data:e})}})),e.on("results:previous",(function(){var t=n.getHighlightedResults(),e=n.$results.find("[aria-selected]"),i=e.index(t);if(0!==i){var a=i-1;0===t.length&&(a=0);var s=e.eq(a);s.trigger("mouseenter");var o=n.$results.offset().top,r=s.offset().top,l=n.$results.scrollTop()+(r-o);0===a?n.$results.scrollTop(0):r-o<0&&n.$results.scrollTop(l)}})),e.on("results:next",(function(){var t=n.getHighlightedResults(),e=n.$results.find("[aria-selected]"),i=e.index(t)+1;if(!(i>=e.length)){var a=e.eq(i);a.trigger("mouseenter");var s=n.$results.offset().top+n.$results.outerHeight(!1),o=a.offset().top+a.outerHeight(!1),r=n.$results.scrollTop()+o-s;0===i?n.$results.scrollTop(0):o>s&&n.$results.scrollTop(r)}})),e.on("results:focus",(function(t){t.element.addClass("select2-results__option--highlighted")})),e.on("results:message",(function(t){n.displayMessage(t)})),t.fn.mousewheel&&this.$results.on("mousewheel",(function(t){var e=n.$results.scrollTop(),i=n.$results.get(0).scrollHeight-n.$results.scrollTop()+t.deltaY,a=t.deltaY>0&&e-t.deltaY<=0,s=t.deltaY<0&&i<=n.$results.height();a?(n.$results.scrollTop(0),t.preventDefault(),t.stopPropagation()):s&&(n.$results.scrollTop(n.$results.get(0).scrollHeight-n.$results.height()),t.preventDefault(),t.stopPropagation())})),this.$results.on("mouseup",".select2-results__option[aria-selected]",(function(e){var i=t(this),a=i.data("data");"true"!==i.attr("aria-selected")?n.trigger("select",{originalEvent:e,data:a}):n.options.get("multiple")?n.trigger("unselect",{originalEvent:e,data:a}):n.trigger("close")})),this.$results.on("mouseenter",".select2-results__option[aria-selected]",(function(e){var i=t(this).data("data");n.getHighlightedResults().removeClass("select2-results__option--highlighted"),n.trigger("results:focus",{data:i,element:t(this)})}))},i.prototype.getHighlightedResults=function(){return this.$results.find(".select2-results__option--highlighted")},i.prototype.destroy=function(){this.$results.remove()},i.prototype.ensureHighlightVisible=function(){var t=this.getHighlightedResults();if(0!==t.length){var e=this.$results.find("[aria-selected]").index(t),i=this.$results.offset().top,n=t.offset().top,a=this.$results.scrollTop()+(n-i),s=n-i;a-=2*t.outerHeight(!1),e<=2?this.$results.scrollTop(0):(s>this.$results.outerHeight()||s<0)&&this.$results.scrollTop(a)}},i.prototype.template=function(e,i){var n=this.options.get("templateResult"),a=this.options.get("escapeMarkup"),s=n(e);null==s?i.style.display="none":"string"==typeof s?i.innerHTML=a(s):t(i).append(s)},i})),e.define("select2/keys",[],(function(){return{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46}})),e.define("select2/selection/base",["jquery","../utils","../keys"],(function(t,e,i){function n(t,e){this.$element=t,this.options=e,n.__super__.constructor.call(this)}return e.Extend(n,e.Observable),n.prototype.render=function(){var e=t('<span class="select2-selection" role="combobox" aria-autocomplete="list" aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=this.$element.data("old-tabindex")?this._tabindex=this.$element.data("old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),e.attr("title",this.$element.attr("title")),e.attr("tabindex",this._tabindex),this.$selection=e,e},n.prototype.bind=function(t,e){var n=this,a=(t.id,t.id+"-results");this.container=t,this.$selection.on("focus",(function(t){n.trigger("focus",t)})),this.$selection.on("blur",(function(t){n.trigger("blur",t)})),this.$selection.on("keydown",(function(t){n.trigger("keypress",t),t.which===i.SPACE&&t.preventDefault()})),t.on("results:focus",(function(t){n.$selection.attr("aria-activedescendant",t.data._resultId)})),t.on("selection:update",(function(t){n.update(t.data)})),t.on("open",(function(){n.$selection.attr("aria-expanded","true"),n.$selection.attr("aria-owns",a),n._attachCloseHandler(t)})),t.on("close",(function(){n.$selection.attr("aria-expanded","false"),n.$selection.removeAttr("aria-activedescendant"),n.$selection.removeAttr("aria-owns"),n.$selection.focus(),n._detachCloseHandler(t)})),t.on("enable",(function(){n.$selection.attr("tabindex",n._tabindex)})),t.on("disable",(function(){n.$selection.attr("tabindex","-1")}))},n.prototype._attachCloseHandler=function(e){t(document.body).on("mousedown.select2."+e.id,(function(e){var i=t(e.target).closest(".select2");t(".select2.select2-container--open").each((function(){var e=t(this);this!=i[0]&&e.data("element").select2("close")}))}))},n.prototype._detachCloseHandler=function(e){t(document.body).off("mousedown.select2."+e.id)},n.prototype.position=function(t,e){e.find(".selection").append(t)},n.prototype.destroy=function(){this._detachCloseHandler(this.container)},n.prototype.update=function(t){throw new Error("The `update` method must be defined in child classes.")},n})),e.define("select2/selection/single",["jquery","./base","../utils","../keys"],(function(t,e,i,n){function a(){a.__super__.constructor.apply(this,arguments)}return i.Extend(a,e),a.prototype.render=function(){var t=a.__super__.render.call(this);return t.addClass("select2-selection--single"),t.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),t},a.prototype.bind=function(t,e){var i=this;a.__super__.bind.apply(this,arguments);var n=t.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",n),this.$selection.attr("aria-labelledby",n),this.$selection.on("mousedown",(function(t){1===t.which&&i.trigger("toggle",{originalEvent:t})})),this.$selection.on("focus",(function(t){})),this.$selection.on("blur",(function(t){})),t.on("selection:update",(function(t){i.update(t.data)}))},a.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},a.prototype.display=function(t){var e=this.options.get("templateSelection");return this.options.get("escapeMarkup")(e(t))},a.prototype.selectionContainer=function(){return t("<span></span>")},a.prototype.update=function(t){if(0!==t.length){var e=t[0],i=this.display(e),n=this.$selection.find(".select2-selection__rendered");n.empty().append(i),n.prop("title",e.title||e.text)}else this.clear()},a})),e.define("select2/selection/multiple",["jquery","./base","../utils"],(function(t,e,i){function n(t,e){n.__super__.constructor.apply(this,arguments)}return i.Extend(n,e),n.prototype.render=function(){var t=n.__super__.render.call(this);return t.addClass("select2-selection--multiple"),t.html('<ul class="select2-selection__rendered"></ul>'),t},n.prototype.bind=function(e,i){var a=this;n.__super__.bind.apply(this,arguments),this.$selection.on("click",(function(t){a.trigger("toggle",{originalEvent:t})})),this.$selection.on("click",".select2-selection__choice__remove",(function(e){var i=t(this).parent().data("data");a.trigger("unselect",{originalEvent:e,data:i})}))},n.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},n.prototype.display=function(t){var e=this.options.get("templateSelection");return this.options.get("escapeMarkup")(e(t))},n.prototype.selectionContainer=function(){return t('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>')},n.prototype.update=function(t){if(this.clear(),0!==t.length){for(var e=[],n=0;n<t.length;n++){var a=t[n],s=this.display(a),o=this.selectionContainer();o.append(s),o.prop("title",a.title||a.text),o.data("data",a),e.push(o)}var r=this.$selection.find(".select2-selection__rendered");i.appendMany(r,e)}},n})),e.define("select2/selection/placeholder",["../utils"],(function(t){function e(t,e,i){this.placeholder=this.normalizePlaceholder(i.get("placeholder")),t.call(this,e,i)}return e.prototype.normalizePlaceholder=function(t,e){return"string"==typeof e&&(e={id:"",text:e}),e},e.prototype.createPlaceholder=function(t,e){var i=this.selectionContainer();return i.html(this.display(e)),i.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),i},e.prototype.update=function(t,e){var i=1==e.length&&e[0].id!=this.placeholder.id;if(e.length>1||i)return t.call(this,e);this.clear();var n=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(n)},e})),e.define("select2/selection/allowClear",["jquery","../keys"],(function(t,e){function i(){}return i.prototype.bind=function(t,e,i){var n=this;t.call(this,e,i),null==this.placeholder&&this.options.get("debug")&&window.console&&console.error&&console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option."),this.$selection.on("mousedown",".select2-selection__clear",(function(t){n._handleClear(t)})),e.on("keypress",(function(t){n._handleKeyboardClear(t,e)}))},i.prototype._handleClear=function(t,e){if(!this.options.get("disabled")){var i=this.$selection.find(".select2-selection__clear");if(0!==i.length){e.stopPropagation();for(var n=i.data("data"),a=0;a<n.length;a++){var s={data:n[a]};if(this.trigger("unselect",s),s.prevented)return}this.$element.val(this.placeholder.id).trigger("change"),this.trigger("toggle")}}},i.prototype._handleKeyboardClear=function(t,i,n){n.isOpen()||i.which!=e.DELETE&&i.which!=e.BACKSPACE||this._handleClear(i)},i.prototype.update=function(e,i){if(e.call(this,i),!(this.$selection.find(".select2-selection__placeholder").length>0||0===i.length)){var n=t('<span class="select2-selection__clear">&times;</span>');n.data("data",i),this.$selection.find(".select2-selection__rendered").prepend(n)}},i})),e.define("select2/selection/search",["jquery","../utils","../keys"],(function(t,e,i){function n(t,e,i){t.call(this,e,i)}return n.prototype.render=function(e){var i=t('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /></li>');return this.$searchContainer=i,this.$search=i.find("input"),e.call(this)},n.prototype.bind=function(t,e,n){var a=this;t.call(this,e,n),e.on("open",(function(){a.$search.attr("tabindex",0),a.$search.focus()})),e.on("close",(function(){a.$search.attr("tabindex",-1),a.$search.val(""),a.$search.focus()})),e.on("enable",(function(){a.$search.prop("disabled",!1)})),e.on("disable",(function(){a.$search.prop("disabled",!0)})),this.$selection.on("focusin",".select2-search--inline",(function(t){a.trigger("focus",t)})),this.$selection.on("focusout",".select2-search--inline",(function(t){a.trigger("blur",t)})),this.$selection.on("keydown",".select2-search--inline",(function(t){if(t.stopPropagation(),a.trigger("keypress",t),a._keyUpPrevented=t.isDefaultPrevented(),t.which===i.BACKSPACE&&""===a.$search.val()){var e=a.$searchContainer.prev(".select2-selection__choice");if(e.length>0){var n=e.data("data");a.searchRemoveChoice(n),t.preventDefault()}}})),this.$selection.on("input",".select2-search--inline",(function(t){a.$selection.off("keyup.search")})),this.$selection.on("keyup.search input",".select2-search--inline",(function(t){a.handleSearch(t)}))},n.prototype.createPlaceholder=function(t,e){this.$search.attr("placeholder",e.text)},n.prototype.update=function(t,e){this.$search.attr("placeholder",""),t.call(this,e),this.$selection.find(".select2-selection__rendered").append(this.$searchContainer),this.resizeSearch()},n.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var t=this.$search.val();this.trigger("query",{term:t})}this._keyUpPrevented=!1},n.prototype.searchRemoveChoice=function(t,e){this.trigger("unselect",{data:e}),this.trigger("open"),this.$search.val(e.text+" ")},n.prototype.resizeSearch=function(){this.$search.css("width","25px");var t="";""!==this.$search.attr("placeholder")?t=this.$selection.find(".select2-selection__rendered").innerWidth():t=.75*(this.$search.val().length+1)+"em";this.$search.css("width",t)},n})),e.define("select2/selection/eventRelay",["jquery"],(function(t){function e(){}return e.prototype.bind=function(e,i,n){var a=this,s=["open","opening","close","closing","select","selecting","unselect","unselecting"],o=["opening","closing","selecting","unselecting"];e.call(this,i,n),i.on("*",(function(e,i){if(-1!==t.inArray(e,s)){i=i||{};var n=t.Event("select2:"+e,{params:i});a.$element.trigger(n),-1!==t.inArray(e,o)&&(i.prevented=n.isDefaultPrevented())}}))},e})),e.define("select2/translation",["jquery","require"],(function(t,e){function i(t){this.dict=t||{}}return i.prototype.all=function(){return this.dict},i.prototype.get=function(t){return this.dict[t]},i.prototype.extend=function(e){this.dict=t.extend({},e.all(),this.dict)},i._cache={},i.loadPath=function(t){if(!(t in i._cache)){var n=e(t);i._cache[t]=n}return new i(i._cache[t])},i})),e.define("select2/diacritics",[],(function(){return{"":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"AA","":"AE","":"AE","":"AE","":"AO","":"AU","":"AV","":"AV","":"AY","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"DZ","":"DZ","":"Dz","":"Dz","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"F","":"F","":"F","":"F","":"F","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"J","":"J","":"J","":"J","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"LJ","":"Lj","":"M","":"M","":"M","":"M","":"M","":"M","":"M","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"NJ","":"Nj","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"OI","":"OO","":"OU","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"Q","":"Q","":"Q","":"Q","":"Q","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"TZ","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"VY","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"X","":"X","":"X","":"X","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"aa","":"ae","":"ae","":"ae","":"ao","":"au","":"av","":"av","":"ay","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"dz","":"dz","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"f","":"f","":"f","":"f","":"f","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"hv","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"j","":"j","":"j","":"j","":"j","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"lj","":"m","":"m","":"m","":"m","":"m","":"m","":"m","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"nj","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"oi","":"ou","":"oo","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"q","":"q","":"q","":"q","":"q","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"tz","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"vy","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"x","":"x","":"x","":"x","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""}})),e.define("select2/data/base",["../utils"],(function(t){function e(t,i){e.__super__.constructor.call(this)}return t.Extend(e,t.Observable),e.prototype.current=function(t){throw new Error("The `current` method must be defined in child classes.")},e.prototype.query=function(t,e){throw new Error("The `query` method must be defined in child classes.")},e.prototype.bind=function(t,e){},e.prototype.destroy=function(){},e.prototype.generateResultId=function(e,i){var n=e.id+"-result-";return n+=t.generateChars(4),null!=i.id?n+="-"+i.id.toString():n+="-"+t.generateChars(4),n},e})),e.define("select2/data/select",["./base","../utils","jquery"],(function(t,e,i){function n(t,e){this.$element=t,this.options=e,n.__super__.constructor.call(this)}return e.Extend(n,t),n.prototype.current=function(t){var e=[],n=this;this.$element.find(":selected").each((function(){var t=i(this),a=n.item(t);e.push(a)})),t(e)},n.prototype.select=function(t){var e=this;if(t.selected=!0,i(t.element).is("option"))return t.element.selected=!0,void this.$element.trigger("change");if(this.$element.prop("multiple"))this.current((function(n){var a=[];(t=[t]).push.apply(t,n);for(var s=0;s<t.length;s++){var o=t[s].id;-1===i.inArray(o,a)&&a.push(o)}e.$element.val(a),e.$element.trigger("change")}));else{var n=t.id;this.$element.val(n),this.$element.trigger("change")}},n.prototype.unselect=function(t){var e=this;if(this.$element.prop("multiple")){if(t.selected=!1,i(t.element).is("option"))return t.element.selected=!1,void this.$element.trigger("change");this.current((function(n){for(var a=[],s=0;s<n.length;s++){var o=n[s].id;o!==t.id&&-1===i.inArray(o,a)&&a.push(o)}e.$element.val(a),e.$element.trigger("change")}))}},n.prototype.bind=function(t,e){var i=this;this.container=t,t.on("select",(function(t){i.select(t.data)})),t.on("unselect",(function(t){i.unselect(t.data)}))},n.prototype.destroy=function(){this.$element.find("*").each((function(){i.removeData(this,"data")}))},n.prototype.query=function(t,e){var n=[],a=this;this.$element.children().each((function(){var e=i(this);if(e.is("option")||e.is("optgroup")){var s=a.item(e),o=a.matches(t,s);null!==o&&n.push(o)}})),e({results:n})},n.prototype.addOptions=function(t){e.appendMany(this.$element,t)},n.prototype.option=function(t){var e;t.children?(e=document.createElement("optgroup")).label=t.text:void 0!==(e=document.createElement("option")).textContent?e.textContent=t.text:e.innerText=t.text,t.id&&(e.value=t.id),t.disabled&&(e.disabled=!0),t.selected&&(e.selected=!0),t.title&&(e.title=t.title);var n=i(e),a=this._normalizeItem(t);return a.element=e,i.data(e,"data",a),n},n.prototype.item=function(t){var e={};if(null!=(e=i.data(t[0],"data")))return e;if(t.is("option"))e={id:t.val(),text:t.text(),disabled:t.prop("disabled"),selected:t.prop("selected"),title:t.prop("title")};else if(t.is("optgroup")){e={text:t.prop("label"),children:[],title:t.prop("title")};for(var n=t.children("option"),a=[],s=0;s<n.length;s++){var o=i(n[s]),r=this.item(o);a.push(r)}e.children=a}return(e=this._normalizeItem(e)).element=t[0],i.data(t[0],"data",e),e},n.prototype._normalizeItem=function(t){i.isPlainObject(t)||(t={id:t,text:t});return null!=(t=i.extend({},{text:""},t)).id&&(t.id=t.id.toString()),null!=t.text&&(t.text=t.text.toString()),null==t._resultId&&t.id&&null!=this.container&&(t._resultId=this.generateResultId(this.container,t)),i.extend({},{selected:!1,disabled:!1},t)},n.prototype.matches=function(t,e){return this.options.get("matcher")(t,e)},n})),e.define("select2/data/array",["./select","../utils","jquery"],(function(t,e,i){function n(t,e){var i=e.get("data")||[];n.__super__.constructor.call(this,t,e),this.addOptions(this.convertToOptions(i))}return e.Extend(n,t),n.prototype.select=function(t){var e=this.$element.find("option").filter((function(e,i){return i.value==t.id.toString()}));0===e.length&&(e=this.option(t),this.addOptions(e)),n.__super__.select.call(this,t)},n.prototype.convertToOptions=function(t){var n=this,a=this.$element.find("option"),s=a.map((function(){return n.item(i(this)).id})).get(),o=[];function r(t){return function(){return i(this).val()==t.id}}for(var l=0;l<t.length;l++){var c=this._normalizeItem(t[l]);if(i.inArray(c.id,s)>=0){var d=a.filter(r(c)),u=this.item(d),h=(i.extend(!0,{},u,c),this.option(u));d.replaceWith(h)}else{var p=this.option(c);if(c.children){var f=this.convertToOptions(c.children);e.appendMany(p,f)}o.push(p)}}return o},n})),e.define("select2/data/ajax",["./array","../utils","jquery"],(function(t,e,i){function n(e,i){this.ajaxOptions=this._applyDefaults(i.get("ajax")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),t.__super__.constructor.call(this,e,i)}return e.Extend(n,t),n.prototype._applyDefaults=function(t){var e={data:function(t){return{q:t.term}},transport:function(t,e,n){var a=i.ajax(t);return a.then(e),a.fail(n),a}};return i.extend({},e,t,!0)},n.prototype.processResults=function(t){return t},n.prototype.query=function(t,e){var n=this;null!=this._request&&(i.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var a=i.extend({type:"GET"},this.ajaxOptions);function s(){var s=a.transport(a,(function(a){var s=n.processResults(a,t);n.options.get("debug")&&window.console&&console.error&&(s&&s.results&&i.isArray(s.results)||console.error("Select2: The AJAX results did not return an array in the `results` key of the response.")),e(s)}),(function(){}));n._request=s}"function"==typeof a.url&&(a.url=a.url(t)),"function"==typeof a.data&&(a.data=a.data(t)),this.ajaxOptions.delay&&""!==t.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(s,this.ajaxOptions.delay)):s()},n})),e.define("select2/data/tags",["jquery"],(function(t){function e(e,i,n){var a=n.get("tags"),s=n.get("createTag");if(void 0!==s&&(this.createTag=s),e.call(this,i,n),t.isArray(a))for(var o=0;o<a.length;o++){var r=a[o],l=this._normalizeItem(r),c=this.option(l);this.$element.append(c)}}return e.prototype.query=function(t,e,i){var n=this;this._removeOldTags(),null!=e.term&&null==e.page?t.call(this,e,(function t(a,s){for(var o=a.results,r=0;r<o.length;r++){var l=o[r],c=null!=l.children&&!t({results:l.children},!0);if(l.text===e.term||c)return!s&&(a.data=o,void i(a))}if(s)return!0;var d=n.createTag(e);if(null!=d){var u=n.option(d);u.attr("data-select2-tag",!0),n.addOptions([u]),n.insertTag(o,d)}a.results=o,i(a)})):t.call(this,e,i)},e.prototype.createTag=function(e,i){var n=t.trim(i.term);return""===n?null:{id:n,text:n}},e.prototype.insertTag=function(t,e,i){e.unshift(i)},e.prototype._removeOldTags=function(e){this._lastTag;this.$element.find("option[data-select2-tag]").each((function(){this.selected||t(this).remove()}))},e})),e.define("select2/data/tokenizer",["jquery"],(function(t){function e(t,e,i){var n=i.get("tokenizer");void 0!==n&&(this.tokenizer=n),t.call(this,e,i)}return e.prototype.bind=function(t,e,i){t.call(this,e,i),this.$search=e.dropdown.$search||e.selection.$search||i.find(".select2-search__field")},e.prototype.query=function(t,e,i){var n=this;e.term=e.term||"";var a=this.tokenizer(e,this.options,(function(t){n.select(t)}));a.term!==e.term&&(this.$search.length&&(this.$search.val(a.term),this.$search.focus()),e.term=a.term),t.call(this,e,i)},e.prototype.tokenizer=function(e,i,n,a){for(var s=n.get("tokenSeparators")||[],o=i.term,r=0,l=this.createTag||function(t){return{id:t.term,text:t.term}};r<o.length;){var c=o[r];if(-1!==t.inArray(c,s)){var d=o.substr(0,r);a(l(t.extend({},i,{term:d}))),o=o.substr(r+1)||"",r=0}else r++}return{term:o}},e})),e.define("select2/data/minimumInputLength",[],(function(){function t(t,e,i){this.minimumInputLength=i.get("minimumInputLength"),t.call(this,e,i)}return t.prototype.query=function(t,e,i){e.term=e.term||"",e.term.length<this.minimumInputLength?this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:e.term,params:e}}):t.call(this,e,i)},t})),e.define("select2/data/maximumInputLength",[],(function(){function t(t,e,i){this.maximumInputLength=i.get("maximumInputLength"),t.call(this,e,i)}return t.prototype.query=function(t,e,i){e.term=e.term||"",this.maximumInputLength>0&&e.term.length>this.maximumInputLength?this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:e.term,params:e}}):t.call(this,e,i)},t})),e.define("select2/data/maximumSelectionLength",[],(function(){function t(t,e,i){this.maximumSelectionLength=i.get("maximumSelectionLength"),t.call(this,e,i)}return t.prototype.query=function(t,e,i){var n=this;this.current((function(a){var s=null!=a?a.length:0;n.maximumSelectionLength>0&&s>=n.maximumSelectionLength?n.trigger("results:message",{message:"maximumSelected",args:{maximum:n.maximumSelectionLength}}):t.call(n,e,i)}))},t})),e.define("select2/dropdown",["jquery","./utils"],(function(t,e){function i(t,e){this.$element=t,this.options=e,i.__super__.constructor.call(this)}return e.Extend(i,e.Observable),i.prototype.render=function(){var e=t('<span class="select2-dropdown"><span class="select2-results"></span></span>');return e.attr("dir",this.options.get("dir")),this.$dropdown=e,e},i.prototype.position=function(t,e){},i.prototype.destroy=function(){this.$dropdown.remove()},i})),e.define("select2/dropdown/search",["jquery","../utils"],(function(t,e){function i(){}return i.prototype.render=function(e){var i=e.call(this),n=t('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /></span>');return this.$searchContainer=n,this.$search=n.find("input"),i.prepend(n),i},i.prototype.bind=function(e,i,n){var a=this;e.call(this,i,n),this.$search.on("keydown",(function(t){a.trigger("keypress",t),a._keyUpPrevented=t.isDefaultPrevented()})),this.$search.on("input",(function(e){t(this).off("keyup")})),this.$search.on("keyup input",(function(t){a.handleSearch(t)})),i.on("open",(function(){a.$search.attr("tabindex",0),a.$search.focus(),window.setTimeout((function(){a.$search.focus()}),0)})),i.on("close",(function(){a.$search.attr("tabindex",-1),a.$search.val("")})),i.on("results:all",(function(t){null!=t.query.term&&""!==t.query.term||(a.showSearch(t)?a.$searchContainer.removeClass("select2-search--hide"):a.$searchContainer.addClass("select2-search--hide"))}))},i.prototype.handleSearch=function(t){if(!this._keyUpPrevented){var e=this.$search.val();this.trigger("query",{term:e})}this._keyUpPrevented=!1},i.prototype.showSearch=function(t,e){return!0},i})),e.define("select2/dropdown/hidePlaceholder",[],(function(){function t(t,e,i,n){this.placeholder=this.normalizePlaceholder(i.get("placeholder")),t.call(this,e,i,n)}return t.prototype.append=function(t,e){e.results=this.removePlaceholder(e.results),t.call(this,e)},t.prototype.normalizePlaceholder=function(t,e){return"string"==typeof e&&(e={id:"",text:e}),e},t.prototype.removePlaceholder=function(t,e){for(var i=e.slice(0),n=e.length-1;n>=0;n--){var a=e[n];this.placeholder.id===a.id&&i.splice(n,1)}return i},t})),e.define("select2/dropdown/infiniteScroll",["jquery"],(function(t){function e(t,e,i,n){this.lastParams={},t.call(this,e,i,n),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return e.prototype.append=function(t,e){this.$loadingMore.remove(),this.loading=!1,t.call(this,e),this.showLoadingMore(e)&&this.$results.append(this.$loadingMore)},e.prototype.bind=function(e,i,n){var a=this;e.call(this,i,n),i.on("query",(function(t){a.lastParams=t,a.loading=!0})),i.on("query:append",(function(t){a.lastParams=t,a.loading=!0})),this.$results.on("scroll",(function(){var e=t.contains(document.documentElement,a.$loadingMore[0]);!a.loading&&e&&(a.$results.offset().top+a.$results.outerHeight(!1)+50>=a.$loadingMore.offset().top+a.$loadingMore.outerHeight(!1)&&a.loadMore())}))},e.prototype.loadMore=function(){this.loading=!0;var e=t.extend({},{page:1},this.lastParams);e.page++,this.trigger("query:append",e)},e.prototype.showLoadingMore=function(t,e){return e.pagination&&e.pagination.more},e.prototype.createLoadingMore=function(){var e=t('<li class="option load-more" role="treeitem"></li>'),i=this.options.get("translations").get("loadingMore");return e.html(i(this.lastParams)),e},e})),e.define("select2/dropdown/attachBody",["jquery","../utils"],(function(t,e){function i(t,e,i){this.$dropdownParent=i.get("dropdownParent")||document.body,t.call(this,e,i)}return i.prototype.bind=function(t,e,i){var n=this,a=!1;t.call(this,e,i),e.on("open",(function(){n._showDropdown(),n._attachPositioningHandler(e),a||(a=!0,e.on("results:all",(function(){n._positionDropdown(),n._resizeDropdown()})),e.on("results:append",(function(){n._positionDropdown(),n._resizeDropdown()})))})),e.on("close",(function(){n._hideDropdown(),n._detachPositioningHandler(e)})),this.$dropdownContainer.on("mousedown",(function(t){t.stopPropagation()}))},i.prototype.position=function(t,e,i){e.attr("class",i.attr("class")),e.removeClass("select2"),e.addClass("select2-container--open"),e.css({position:"absolute",top:-999999}),this.$container=i},i.prototype.render=function(e){var i=t("<span></span>"),n=e.call(this);return i.append(n),this.$dropdownContainer=i,i},i.prototype._hideDropdown=function(t){this.$dropdownContainer.detach()},i.prototype._attachPositioningHandler=function(i){var n=this,a="scroll.select2."+i.id,s="resize.select2."+i.id,o="orientationchange.select2."+i.id,r=this.$container.parents().filter(e.hasScroll);r.each((function(){t(this).data("select2-scroll-position",{x:t(this).scrollLeft(),y:t(this).scrollTop()})})),r.on(a,(function(e){var i=t(this).data("select2-scroll-position");t(this).scrollTop(i.y)})),t(window).on(a+" "+s+" "+o,(function(t){n._positionDropdown(),n._resizeDropdown()}))},i.prototype._detachPositioningHandler=function(i){var n="scroll.select2."+i.id,a="resize.select2."+i.id,s="orientationchange.select2."+i.id;this.$container.parents().filter(e.hasScroll).off(n),t(window).off(n+" "+a+" "+s)},i.prototype._positionDropdown=function(){var e=t(window),i=this.$dropdown.hasClass("select2-dropdown--above"),n=this.$dropdown.hasClass("select2-dropdown--below"),a=null,s=(this.$container.position(),this.$container.offset());s.bottom=s.top+this.$container.outerHeight(!1);var o={height:this.$container.outerHeight(!1)};o.top=s.top,o.bottom=s.top+o.height;var r=this.$dropdown.outerHeight(!1),l=e.scrollTop(),c=e.scrollTop()+e.height(),d=l<s.top-r,u=c>s.bottom+r,h={left:s.left,top:o.bottom};i||n||(a="below"),u||!d||i?!d&&u&&i&&(a="below"):a="above",("above"==a||i&&"below"!==a)&&(h.top=o.top-r),null!=a&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+a),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+a)),this.$dropdownContainer.css(h)},i.prototype._resizeDropdown=function(){this.$dropdownContainer.width();var t={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(t.minWidth=t.width,t.width="auto"),this.$dropdown.css(t)},i.prototype._showDropdown=function(t){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},i})),e.define("select2/dropdown/minimumResultsForSearch",[],(function(){function t(e){for(var i=0,n=0;n<e.length;n++){var a=e[n];a.children?i+=t(a.children):i++}return i}function e(t,e,i,n){this.minimumResultsForSearch=i.get("minimumResultsForSearch"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=1/0),t.call(this,e,i,n)}return e.prototype.showSearch=function(e,i){return!(t(i.data.results)<this.minimumResultsForSearch)&&e.call(this,i)},e})),e.define("select2/dropdown/selectOnClose",[],(function(){function t(){}return t.prototype.bind=function(t,e,i){var n=this;t.call(this,e,i),e.on("close",(function(){n._handleSelectOnClose()}))},t.prototype._handleSelectOnClose=function(){var t=this.getHighlightedResults();t.length<1||this.trigger("select",{data:t.data("data")})},t})),e.define("select2/dropdown/closeOnSelect",[],(function(){function t(){}return t.prototype.bind=function(t,e,i){var n=this;t.call(this,e,i),e.on("select",(function(t){n._selectTriggered(t)})),e.on("unselect",(function(t){n._selectTriggered(t)}))},t.prototype._selectTriggered=function(t,e){var i=e.originalEvent;i&&i.ctrlKey||this.trigger("close")},t})),e.define("select2/i18n/en",[],(function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(t){var e=t.input.length-t.maximum,i="Please delete "+e+" character";return 1!=e&&(i+="s"),i},inputTooShort:function(t){return"Please enter "+(t.minimum-t.input.length)+" or more characters"},loadingMore:function(){return"Loading more results"},maximumSelected:function(t){var e="You can only select "+t.maximum+" item";return 1!=t.maximum&&(e+="s"),e},noResults:function(){return"No results found"},searching:function(){return"Searching"}}})),e.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],(function(t,e,i,n,a,s,o,r,l,c,d,u,h,p,f,m,g,v,b,y,_,x,w,C,k,$,S,T,I){function D(){this.reset()}return D.prototype.apply=function(u){if(null==(u=t.extend({},this.defaults,u)).dataAdapter){if(null!=u.ajax?u.dataAdapter=f:null!=u.data?u.dataAdapter=p:u.dataAdapter=h,u.minimumInputLength>0&&(u.dataAdapter=c.Decorate(u.dataAdapter,v)),u.maximumInputLength>0&&(u.dataAdapter=c.Decorate(u.dataAdapter,b)),u.maximumSelectionLength>0&&(u.dataAdapter=c.Decorate(u.dataAdapter,y)),u.tags&&(u.dataAdapter=c.Decorate(u.dataAdapter,m)),null==u.tokenSeparators&&null==u.tokenizer||(u.dataAdapter=c.Decorate(u.dataAdapter,g)),null!=u.query){var I=e(u.amdBase+"compat/query");u.dataAdapter=c.Decorate(u.dataAdapter,I)}if(null!=u.initSelection){var D=e(u.amdBase+"compat/initSelection");u.dataAdapter=c.Decorate(u.dataAdapter,D)}}if(null==u.resultsAdapter&&(u.resultsAdapter=i,null!=u.ajax&&(u.resultsAdapter=c.Decorate(u.resultsAdapter,C)),null!=u.placeholder&&(u.resultsAdapter=c.Decorate(u.resultsAdapter,w)),u.selectOnClose&&(u.resultsAdapter=c.Decorate(u.resultsAdapter,S))),null==u.dropdownAdapter){if(u.multiple)u.dropdownAdapter=_;else{var A=c.Decorate(_,x);u.dropdownAdapter=A}if(0!==u.minimumResultsForSearch&&(u.dropdownAdapter=c.Decorate(u.dropdownAdapter,$)),u.closeOnSelect&&(u.dropdownAdapter=c.Decorate(u.dropdownAdapter,T)),null!=u.dropdownCssClass||null!=u.dropdownCss||null!=u.adaptDropdownCssClass){var P=e(u.amdBase+"compat/dropdownCss");u.dropdownAdapter=c.Decorate(u.dropdownAdapter,P)}u.dropdownAdapter=c.Decorate(u.dropdownAdapter,k)}if(null==u.selectionAdapter){if(u.multiple?u.selectionAdapter=a:u.selectionAdapter=n,null!=u.placeholder&&(u.selectionAdapter=c.Decorate(u.selectionAdapter,s)),u.allowClear&&(u.selectionAdapter=c.Decorate(u.selectionAdapter,o)),u.multiple&&(u.selectionAdapter=c.Decorate(u.selectionAdapter,r)),null!=u.containerCssClass||null!=u.containerCss||null!=u.adaptContainerCssClass){var O=e(u.amdBase+"compat/containerCss");u.selectionAdapter=c.Decorate(u.selectionAdapter,O)}u.selectionAdapter=c.Decorate(u.selectionAdapter,l)}if("string"==typeof u.language)if(u.language.indexOf("-")>0){var E=u.language.split("-")[0];u.language=[u.language,E]}else u.language=[u.language];if(t.isArray(u.language)){var M=new d;u.language.push("en");for(var L=u.language,j=0;j<L.length;j++){var R=L[j],N={};try{N=d.loadPath(R)}catch(t){try{R=this.defaults.amdLanguageBase+R,N=d.loadPath(R)}catch(t){u.debug&&window.console&&console.warn&&console.warn('Select2: The language file for "'+R+'" could not be automatically loaded. A fallback will be used instead.');continue}}M.extend(N)}u.translations=M}else{var B=d.loadPath(this.defaults.amdLanguageBase+"en"),F=new d(u.language);F.extend(B),u.translations=F}return u},D.prototype.reset=function(){function e(t){return t.replace(/[^\u0000-\u007E]/g,(function(t){return u[t]||t}))}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:c.escapeMarkup,language:I,matcher:function i(n,a){if(""===t.trim(n.term))return a;if(a.children&&a.children.length>0){for(var s=t.extend(!0,{},a),o=a.children.length-1;o>=0;o--){null==i(n,a.children[o])&&s.children.splice(o,1)}return s.children.length>0?s:i(n,s)}var r=e(a.text).toUpperCase(),l=e(n.term).toUpperCase();return r.indexOf(l)>-1?a:null},minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,sorter:function(t){return t},templateResult:function(t){return t.text},templateSelection:function(t){return t.text},theme:"default",width:"resolve"}},D.prototype.set=function(e,i){var n={};n[t.camelCase(e)]=i;var a=c._convertData(n);t.extend(this.defaults,a)},new D})),e.define("select2/options",["require","jquery","./defaults","./utils"],(function(t,e,i,n){function a(e,a){if(this.options=e,null!=a&&this.fromElement(a),this.options=i.apply(this.options),a&&a.is("input")){var s=t(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=n.Decorate(this.options.dataAdapter,s)}}return a.prototype.fromElement=function(t){var i=["select2"];null==this.options.multiple&&(this.options.multiple=t.prop("multiple")),null==this.options.disabled&&(this.options.disabled=t.prop("disabled")),null==this.options.language&&(t.prop("lang")?this.options.language=t.prop("lang").toLowerCase():t.closest("[lang]").prop("lang")&&(this.options.language=t.closest("[lang]").prop("lang"))),null==this.options.dir&&(t.prop("dir")?this.options.dir=t.prop("dir"):t.closest("[dir]").prop("dir")?this.options.dir=t.closest("[dir]").prop("dir"):this.options.dir="ltr"),t.prop("disabled",this.options.disabled),t.prop("multiple",this.options.multiple),t.data("select2Tags")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.'),t.data("data",t.data("select2Tags")),t.data("tags",!0)),t.data("ajaxUrl")&&(this.options.debug&&window.console&&console.warn&&console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2."),t.attr("ajax--url",t.data("ajaxUrl")),t.data("ajax--url",t.data("ajaxUrl")));var a={};a=e.fn.jquery&&"1."==e.fn.jquery.substr(0,2)&&t[0].dataset?e.extend(!0,{},t[0].dataset,t.data()):t.data();var s=e.extend(!0,{},a);for(var o in s=n._convertData(s))e.inArray(o,i)>-1||(e.isPlainObject(this.options[o])?e.extend(this.options[o],s[o]):this.options[o]=s[o]);return this},a.prototype.get=function(t){return this.options[t]},a.prototype.set=function(t,e){this.options[t]=e},a})),e.define("select2/core",["jquery","./options","./utils","./keys"],(function(t,e,i,n){var a=function(t,i){null!=t.data("select2")&&t.data("select2").destroy(),this.$element=t,this.id=this._generateId(t),i=i||{},this.options=new e(i,t),a.__super__.constructor.call(this);var n=t.attr("tabindex")||0;t.data("old-tabindex",n),t.attr("tabindex","-1");var s=this.options.get("dataAdapter");this.dataAdapter=new s(t,this.options);var o=this.render();this._placeContainer(o);var r=this.options.get("selectionAdapter");this.selection=new r(t,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,o);var l=this.options.get("dropdownAdapter");this.dropdown=new l(t,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,o);var c=this.options.get("resultsAdapter");this.results=new c(t,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var d=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current((function(t){d.trigger("selection:update",{data:t})})),t.addClass("select2-hidden-accessible"),t.attr("aria-hidden","true"),this._syncAttributes(),t.data("select2",this)};return i.Extend(a,i.Observable),a.prototype._generateId=function(t){return"select2-"+(null!=t.attr("id")?t.attr("id"):null!=t.attr("name")?t.attr("name")+"-"+i.generateChars(2):i.generateChars(4))},a.prototype._placeContainer=function(t){t.insertAfter(this.$element);var e=this._resolveWidth(this.$element,this.options.get("width"));null!=e&&t.css("width",e)},a.prototype._resolveWidth=function(t,e){var i=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if("resolve"==e){var n=this._resolveWidth(t,"style");return null!=n?n:this._resolveWidth(t,"element")}if("element"==e){var a=t.outerWidth(!1);return a<=0?"auto":a+"px"}if("style"==e){var s=t.attr("style");if("string"!=typeof s)return null;for(var o=s.split(";"),r=0,l=o.length;r<l;r+=1){var c=o[r].replace(/\s/g,"").match(i);if(null!==c&&c.length>=1)return c[1]}return null}return e},a.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},a.prototype._registerDomEvents=function(){var e=this;this.$element.on("change.select2",(function(){e.dataAdapter.current((function(t){e.trigger("selection:update",{data:t})}))})),this._sync=i.bind(this._syncAttributes,this),this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._sync);var n=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=n?(this._observer=new n((function(i){t.each(i,e._sync)})),this._observer.observe(this.$element[0],{attributes:!0,subtree:!1})):this.$element[0].addEventListener&&this.$element[0].addEventListener("DOMAttrModified",e._sync,!1)},a.prototype._registerDataEvents=function(){var t=this;this.dataAdapter.on("*",(function(e,i){t.trigger(e,i)}))},a.prototype._registerSelectionEvents=function(){var e=this,i=["toggle"];this.selection.on("toggle",(function(){e.toggleDropdown()})),this.selection.on("*",(function(n,a){-1===t.inArray(n,i)&&e.trigger(n,a)}))},a.prototype._registerDropdownEvents=function(){var t=this;this.dropdown.on("*",(function(e,i){t.trigger(e,i)}))},a.prototype._registerResultsEvents=function(){var t=this;this.results.on("*",(function(e,i){t.trigger(e,i)}))},a.prototype._registerEvents=function(){var t=this;this.on("open",(function(){t.$container.addClass("select2-container--open")})),this.on("close",(function(){t.$container.removeClass("select2-container--open")})),this.on("enable",(function(){t.$container.removeClass("select2-container--disabled")})),this.on("disable",(function(){t.$container.addClass("select2-container--disabled")})),this.on("focus",(function(){t.$container.addClass("select2-container--focus")})),this.on("blur",(function(){t.$container.removeClass("select2-container--focus")})),this.on("query",(function(e){t.isOpen()||t.trigger("open"),this.dataAdapter.query(e,(function(i){t.trigger("results:all",{data:i,query:e})}))})),this.on("query:append",(function(e){this.dataAdapter.query(e,(function(i){t.trigger("results:append",{data:i,query:e})}))})),this.on("keypress",(function(e){var i=e.which;t.isOpen()?i===n.ENTER?(t.trigger("results:select"),e.preventDefault()):i===n.SPACE&&e.ctrlKey?(t.trigger("results:toggle"),e.preventDefault()):i===n.UP?(t.trigger("results:previous"),e.preventDefault()):i===n.DOWN?(t.trigger("results:next"),e.preventDefault()):i!==n.ESC&&i!==n.TAB||(t.close(),e.preventDefault()):(i===n.ENTER||i===n.SPACE||(i===n.DOWN||i===n.UP)&&e.altKey)&&(t.open(),e.preventDefault())}))},a.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled")),this.options.get("disabled")?(this.isOpen()&&this.close(),this.trigger("disable")):this.trigger("enable")},a.prototype.trigger=function(t,e){var i=a.__super__.trigger,n={open:"opening",close:"closing",select:"selecting",unselect:"unselecting"};if(t in n){var s=n[t],o={prevented:!1,name:t,args:e};if(i.call(this,s,o),o.prevented)return void(e.prevented=!0)}i.call(this,t,e)},a.prototype.toggleDropdown=function(){this.options.get("disabled")||(this.isOpen()?this.close():this.open())},a.prototype.open=function(){this.isOpen()||(this.trigger("query",{}),this.trigger("open"))},a.prototype.close=function(){this.isOpen()&&this.trigger("close")},a.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},a.prototype.enable=function(t){this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.'),null!=t&&0!==t.length||(t=[!0]);var e=!t[0];this.$element.prop("disabled",e)},a.prototype.data=function(){this.options.get("debug")&&arguments.length>0&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.');var t=[];return this.dataAdapter.current((function(e){t=e})),t},a.prototype.val=function(e){if(this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),null==e||0===e.length)return this.$element.val();var i=e[0];t.isArray(i)&&(i=t.map(i,(function(t){return t.toString()}))),this.$element.val(i).trigger("change")},a.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._sync),null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&this.$element[0].removeEventListener("DOMAttrModified",this._sync,!1),this._sync=null,this.$element.off(".select2"),this.$element.attr("tabindex",this.$element.data("old-tabindex")),this.$element.removeClass("select2-hidden-accessible"),this.$element.attr("aria-hidden","false"),this.$element.removeData("select2"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null},a.prototype.render=function(){var e=t('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return e.attr("dir",this.options.get("dir")),this.$container=e,this.$container.addClass("select2-container--"+this.options.get("theme")),e.data("element",this.$element),e},a})),e.define("jquery.select2",["jquery","require","./select2/core","./select2/defaults"],(function(t,e,i,n){if(e("jquery.mousewheel"),null==t.fn.select2){var a=["open","close","destroy"];t.fn.select2=function(e){if("object"==typeof(e=e||{}))return this.each((function(){var n=t.extend({},e,!0);new i(t(this),n)})),this;if("string"==typeof e){var n=this.data("select2");null==n&&window.console&&console.error&&console.error("The select2('"+e+"') method was called on an element that is not using Select2.");var s=Array.prototype.slice.call(arguments,1),o=n[e](s);return t.inArray(e,a)>-1?this:o}throw new Error("Invalid arguments for Select2: "+e)}}return null==t.fn.select2.defaults&&(t.fn.select2.defaults=n),i})),e.define("jquery.mousewheel",["jquery"],(function(t){return t})),{define:e.define,require:e.require}}(),i=e.require("jquery.select2");return t.fn.select2.amd=e,i})),ogame.chat={socket:null,connected:!1,connecting:!1,timeout:null,retryInterval:5e3,playerId:null,associationId:null,data:{association:{}},playernames:{},playerList:null,isLoadingPlayerList:!1,playerListSelector:new Array,initConnection:function(){console.log("ogame.chat init");var t=ogame.chat;(t.connecting||t.connected||t.isMobile)&&t.socket.disconnect(),t.connecting=!0;try{t.socket=io.connect("/chat",nodeParams),t.socket.on("connect",(function(){clearTimeout(this.timeout),t.socket.emit("authorize",session,(function(e){t.connecting=!1,e?t.connected=!0:t.socket.disconnect()}))})),t.socket.on("chat",(function(e){t.messageReceived(e)})),t.socket.on("disconnect",(function(){t.connected=!1,t.connecting=!1}))}catch(e){t.connecting=!1}},initialize:function(){var t=ogame.chat;loadScript(nodeUrl,t.initConnection),$(".new_msg_count[data-playerid]").each((function(){t.saveMessageCounter($(this).data("new-messages"),$(this).data("playerid"))})),this.updateTotalNewChatCounter(),$(".js_playerlist").on("click",".playerlist_item",(function(){if(!$(this).hasClass("nothingThere")){var e=$(this).data("msgid");e?t.loadChatLogWithPlayer(this,e):t.loadChatLogWithPlayer(this)}})),$(".js_playerlist").on("click",".openAssociationChat",(function(){var e=$(this).data("msgid");e?t.loadChatLogWithAssociation(this,e):t.loadChatLogWithAssociation(this)})),$("#chatMsgList").on("click",".msg",(function(){var e=$(this).data("playerid"),i=$(this).data("associationid");if(void 0!==e&&e>0){t.saveMessageCounter(0,e),ogame.messagemarker.setPartnerId(e),ogame.messagemarker.updateNewMarker(),ogame.chat.updateTotalNewChatCounter(),(n=$(".playerlist .playerlist_item[data-playerId="+e+"]").data("msgid"))?t.loadChatLogWithPlayer(this,n):t.loadChatLogWithPlayer(this)}else{var n=$(".playerlist .playerlist_item[data-associationId="+i+"]").data("msgid");t.saveMessageCounterAssociation(0,i),n?t.loadChatLogWithAssociation(this,n):t.loadChatLogWithAssociation(this)}})),$(".chat").on("click",".sys_msg",(function(t){var e=$(this).data("foreign-player-id"),i=$(this).data("foreign-association-id"),n={playerId:e,associationId:i,ajax:1};console.log("chatLoadMoreMessages()"),$.ajax({url:chatUrlLoadMoreMessages,type:"POST",dataType:"html",data:n,success:function(t){$(".chat").each((function(n,a){(void 0!==e&&e==$(a).data("foreign-player-id")||void 0!==i&&i==$(a).data("foreign-association-id"))&&$(a).html(t)}))},error:function(t,e,i){}})})),$("body").on("click",".js_openChat",(function(){t.loadChatLogWithPlayer(this)})),"string"!=typeof $.cookie("maximizeId")&&"number"!=typeof $.cookie("maximizeId")||($('#chatMsgList .msg[data-playerid="'+$.cookie("maximizeId")+'"]').trigger("click"),$.cookie("maximizeId",null))},getTotalNewChatCounter:function(){return ogame.messagecounter.sumNewChatMessages},updateTotalNewChatCounter:function(){var t=0;return $(".msg .new_msg_count").length>0?$(".msg .new_msg_count").each((function(){t+=Number($(this).data("new-messages"))})):$("#chatBarPlayerList .new_msg_count").length>0&&$("#chatBarPlayerList .new_msg_count").each((function(){t+=Number($(this).data("new-messages"))})),ogame.messagecounter.initialize(ogame.messagecounter.type_chat,ogame.chat.playerId),ogame.messagecounter.sumNewChatMessages!==t&&(ogame.messagecounter.initChatCounter(t),ogame.messagecounter.sumNewChatMessages=t,ogame.messagecounter.update()),t},retryConnection:function(){var t=ogame.chat;setTimeout((function(){t.initConnection()}),5e3)},sendMessage:function(t,e,i,n){var a=ogame.chat;if(0!=$.trim(i).length){if(t>0)var s={playerId:t,text:i,mode:1,ajax:1};else s={associationId:e,text:i,mode:3,ajax:1};void 0!==n&&void 0!==n.id&&(s.msg2reply=n.id),o()}else r("TEXT_EMPTY");function o(){console.log("v()"),$.ajax({url:chatUrl,type:"POST",dataType:"json",data:s,success:function(e){!function(e){switch(e.status){case"NOT_AUTHORIZED":o();break;case"OK":!function(e){void 0!==e.refAuthor&&void 0!==e.refContent?$refData={author:e.refAuthor,text:e.refContent}:$refData=0;void 0!==e.targetId?a.addChatItem(e.targetId,0,e.text,e.id,!1,$refData,e.date):a.addChatItem(t,e.targetAssociationId,e.text,e.id,!1,$refData,e.date)}(e),ogame.chat.cleanupUrl();break;default:r(e.status)}}(e)},error:function(t,e,i){}})}function r(t){void 0!==chatLoca[t]?errorBoxNotify(LocalizationStrings.error,chatLoca[t],LocalizationStrings.ok):errorBoxNotify(LocalizationStrings.error,t,LocalizationStrings.ok)}},messageReceived:function(t){var e=ogame.chat;if(void 0!==t.refAuthor&&void 0!==t.refText?$refData={author:t.refAuhtor,text:t.refText}:$refData=0,void 0!==t.senderName&&void 0!==t.senderId&&(e.playernames[t.senderId]=t.senderName),$(".chat_bar_list").length&&(void 0!==t.associationId&&t.associationId>0?void 0===e.data.association[t.associationId]?e.loadChatLogWithAssociation(t.associationId,null,(function(){e.addChatItem(t.senderId,t.associationId,t.text,t.id,!0,$refData,t.date)}),!1):e.addChatItem(t.senderId,t.associationId,t.text,t.id,!0,$refData,t.date):void 0===e.data[t.senderId]?e.loadChatLogWithPlayer(t.senderId,null,(function(){e.addChatItem(t.senderId,0,t.text,t.id,!0,$refData,t.date)}),!1):e.addChatItem(t.senderId,0,t.text,t.id,!0,$refData,t.date)),void 0!==t.associationId&&t.associationId>0)if($('.chat_bar_list_item.open[data-associationid="'+t.associationId+'"]').length<=0){var i=$('.new_msg_count[data-associationid="'+t.associationId+'"]').data("new-messages");isNaN(i)&&(i=0),i++,e.saveMessageCounterAssociation(i,t.associationId),e.updateTotalNewChatCounter()}else{var n={associationId:t.associationId,mode:4,ajax:1,updateUnread:1};console.log("chatUrl()"),$.ajax({url:chatUrl,type:"POST",data:n,success:function(t){},error:function(t,e,i){}})}else if(void 0!==t.senderId&&t.senderId>0)if(ogame.messagemarker.setPartnerId(t.senderId),e.isOpen(t.senderId))e.saveMessageCounter(0,$(this).data("playerid")),ogame.messagemarker.updateNewMarker();else{ogame.messagecounter.initialize(ogame.messagecounter.type_chat,t.senderId);i=parseInt(ogame.messagecounter.newChats[t.senderId]);isNaN(i)&&(i=0),i++,e.saveMessageCounter(i,t.senderId),ogame.messagemarker.updateNewMarker()}},cleanupUrl:function(){var t=window.location.href;if(t.indexOf("&")>0){var e=t.indexOf("?"),i=t.substring(0,e)+"?page=chat";window.history.pushState({},"",i)}},saveMessageCounter:function(t,e){if(isNaN(e)||0===e)return!1;$('.new_msg_count[data-playerid="'+e+'"]').data("new-messages",t),ogame.messagecounter.newChats[e]=t},saveMessageCounterAssociation:function(t,e){if(isNaN(e)||0===e)return!1;$('.new_msg_count[data-associationid="'+e+'"]').data("new-messages",t),$('.new_msg_count[data-associationid="'+e+'"]').text(t),ogame.messagemarker.updateNewMarker()},isOpen:function(t){var e=!1,i=$(".chatContent").data("chatplayerid");return"undefined"!=i&&i==t?e=!0:$(".chat_box").each((function(){$(this).attr("data-playerid")==t&&"block"==$(this).css("display")&&(e=!0)})),e},loadChatLogWithPlayer:function(t,e,i,n){var a=ogame.chat;void 0===n&&(n=!0);var s={playerId:"number"==typeof t?t:$(t).attr("data-playerId"),mode:2,ajax:1,updateUnread:n?1:0};"number"==typeof e&&(s.msg2reply=e),console.log("chatUrl POST()"),$.ajax({url:chatUrl,type:"POST",data:s,success:function(e){e=JSON.parse(e),a.data[e.playerId]={playerstatus:e.playerstatus,playerName:e.playerName,playerId:e.playerId,chatItems:e.chatItems,chatItemsByDateAsc:e.chatItemsByDateAsc},"function"==typeof i?i():$(t).parents("#chatBarPlayerList").length||"chat"!=$("body")[0].id?a.showChat(e):a.showChatHistory(e);var n=$(".chat_bar_list").find("[data-playerid='"+e.playerId+"']");a.updateCustomScrollbar(n.find(".chat_box_ctn"))},error:function(t,e,i){}})},loadChatLogWithAssociation:function(t,e,i,n){var a=ogame.chat;void 0===n&&(n=!0);var s={associationId:"number"==typeof t?t:$(t).attr("data-associationid"),mode:4,ajax:1,updateUnread:n?1:0};"number"==typeof e&&(s.msg2reply=e),console.log("chaturl POST()"),$.ajax({url:chatUrl,type:"POST",data:s,success:function(e){e=JSON.parse(e),a.data.association[e.associationId]={playerstatus:e.playerstatus,associationName:e.associationName,associationId:e.associationId,chatItems:e.chatItems,chatItemsByDateAsc:e.chatItemsByDateAsc},"function"==typeof i?i():$(t).parents("#chatBarPlayerList").length||"chat"!=$("body")[0].id?a.showChat(e):a.showChatHistory(e);var n=$(".chat_bar_list").find("[data-associationid='"+e.associationId+"']");a.updateCustomScrollbar(n.find(".chat_box_ctn"))},error:function(t,e,i){}})},initChat:function(t,e){ogame.chat.playerId=t,ogame.chat.isMobile=e,ogame.chat.initPlayerlist(),ogame.chat.initialize(),ogame.chat.toggleVisibility(),ogame.chat.setVisibilityState(),ogame.chat.initMaximize(),ogame.chat.getInMaxChat()},getLastChatItemData:function(){ogame.chat;var t=null;return $(".chat_box_ctn .mCustomScrollBox .mCSB_container").each((function(){var e=$(this).children("ul.chat").children("li:last");(null===t||e.attr("data-chat-id")>t.attr("data-chat-id"))&&(t=e)})),null===t&&$("ul.largeChat").each((function(){var e=$(this).children("li:last");(null===t||e.attr("data-chat-id")>t.attr("data-chat-id"))&&(t=e)})),null===t?null:{date:t.children(".msg_head").find(".msg_date").html(),text:t.find(".msg_content").html()}},addChatItem:function(t,e,i,n,a,s,o){var r,l=ogame.chat;r=e>0?$(".chat_bar_list").find("[data-associationid='"+e+"']"):$(".chat_bar_list").find("[data-playerid='"+t+"']");var c={};if(c.date=o,c.newClass="new",a?(void 0!==l.data[t]?c.playerName=l.data[t].playerName:c.playerName=l.playernames[t],c.altClass=""):(c.playerName=playerName,c.altClass="odd"),c.chatID=n,c.chatContent=i,"object"==typeof s&&(c.refData=s),!r.length){var d=l.createChatBarContainer(t);l.updateChatBar(d),r=$(".chat_bar_list").find("[data-playerid='"+t+"']")}var u=l.createChatItem(c),h=l.getLastChatItemData();if(null!==h&&(c.date!=h.date||c.chatContent!=h.text)){r.find(".chat").append(u),l.updateCustomScrollbar(r.find(".chat_box_ctn"));var p=$(".js_chatHistory");!p.length||p.data("chatplayerid")!=t&&p.data("associationid")!=e||(p.find(".chat.clearfix").append(u.clone()),l.updateCustomScrollbar($(".largeChatContainer")))}},addToMoreBox:function(t){var e=ogame.chat,i=t.length;i&&$(".more_chat_bar_items").length<1&&$(".chat_bar_list").append(e.createMoreBox("more_chat_bar_items"));for(var n=$(".more_chat_bar_items .more_items"),a=$(".more_chat_bar_items .chat_box"),s=0;s<=i;s++)n.append(t.pop());e.updateCustomScrollbar(a)},createChatBarContainer:function(t){var e=ogame.chat;if(t){var i=e.data[t];e.data.playerId=t;var n=$('<li class="chat_bar_list_item open" data-playerid="'+t+'"></li>');return n.append('<span class="playerstatus '+i.playerstatus+'"></span>'),n.append('<span class="cb_playername">'+i.playerName+"</span>"),n.append('<span class="icon icon_close fright"></span>'),n.prepend(e.createChatBox(t)),n}},createChatBarContainerForAssociations:function(t){var e=ogame.chat;if(t){var i=e.data.association[t];e.data.associationId=t;var n=$('<li class="chat_bar_list_item open" data-associationId="'+t+'"></li>');return n.append('<span class="playerstatus '+i.playerstatus+'"></span>'),n.append('<span class="cb_playername">'+i.associationName+"</span>"),n.append('<span class="icon icon_close fright"></span>'),n.prepend(e.createChatBoxForAssociations(t)),n}},closeChatBox:function(t,e){var i=$(".chat_bar_list_item");$.each(i,(function(i,n){(void 0!==t&&$(n).data("playerid")==t||void 0!==e&&$(n).data("associationid")==e)&&($(n).addClass("outOfChatbar"),$(n).removeClass("open"))}))},getVisibleChats:function(){return"undefined"==typeof visibleChats&&(visibleChats={chatbar:!1,players:[],associations:[]}),visibleChats},getVisibleChatPlayerIds:function(){for(var t=ogame.chat.getVisibleChats(),e={},i=0,n=0;n<t.players.length;n++)-1==$.inArray(t.players[n].partnerId,e)&&(e[i]=t.players[n].partnerId,i++);return e},getVisibleChatAssociationIds:function(){for(var t=ogame.chat.getVisibleChats(),e={},i=0,n=0;n<t.associations.length;n++)-1==$.inArray(t.associations[n].partnerId,e)&&(e[i]=t.associations[n],i++);return e},setVisibilityState:function(){for(var t=ogame.chat,e=t.getVisibleChatPlayerIds(),i=t.getVisibleChatAssociationIds(),n=$("#chatBar .chat_bar_list .chat_bar_list_item"),a=0;a<n.length;a++){var s=n.get(a),o=$(s).data("playerid"),r=$(s).data("associationid");if(void 0===o||t.isInJson(o,e))if(void 0===r||t.isInJson(r,i)){if(s.style.display="inline",$(s).hasClass("open"))$(s).find("div.chat_box")[0].style.display="inline",t.updateCustomScrollbar($(s).find(".chat_box_ctn"),1)}else t.closeChatBox(0,r);else t.closeChatBox(o,0)}},isInJson:function(t,e){var i=null;return $.isEmptyObject(e)&&(i=!1),!1!==i&&$.each(e,(function(e,n){n==t&&(i=!0)})),i},toggleVisibility:function(){$(".chat_bar_list_item .icon_close").on("click",(function(t){var e=$(this).parent().data("playerid"),i=$(this).closest(".chat_box");i.length||((i=$(this).parent()[0]).style.display="none"),e>0&&(console.log("toggleVisibilityChat()"),$.ajax({type:"POST",url:"/game/index.php?page=ajaxChatToggleVisibility",data:{from:playerId,to:e,showState:0},success:function(t){},error:function(t,e,i){}}))})),$(".cb_playerlist_box .playerlist_item").on("click",(function(){var t=$(this).data("playerid");t&&(console.log("cb_playerlist_box()"),$.ajax({type:"POST",url:"/game/index.php?page=ajaxChatToggleVisibility",data:{from:playerId,to:t,showState:1},success:function(t){},error:function(t,e,i){}}))}))},initMaximize:function(){$(".chat_bar_list").on("click.chatBar",".chat_box .chat_box_title .icon_maximize",(function(){var t=$(this).parent(),e=$(t).parent().data("playerid");$.cookie("maximizeId",e),$(".chat_bar_list_item.open .chat_box_title .icon_close").trigger("click"),window.location=bigChatLink+"&playerId="+e}))},getInMaxChat:function(){var t=location.href;"undefined"==typeof bigChatLink&&(bigChatLink=""),bigChatLink==t&&null!==$.cookie("maximizeId")&&$("#chatMsgList .msg[data-playerId="+$.cookie("maximizeId")+"]").trigger("click"),$.cookie("maximizeId",null)},createChatBox:function(t){var e=ogame.chat;if(t){var i=e.data[t],n=$('<div class="chat_box_title"></div>');n.append('<span class="icon icon_close fright"></span>'),n.append('<span class="icon icon_maximize fright"></span>');for(var a=$('<div class="chat_box_ctn"><ul class="chat clearfix"></ul></div>'),s={},o=0;o<i.chatItemsByDateAsc.length;o++)s=i.chatItems[i.chatItemsByDateAsc[o]],a.find(".chat").append(e.createChatItem(s));var r=$('<div class="chat_box" data-playerid="'+t+'"></div>');return r.append(n),r.append(a),r.append('<textarea name="text" class="chat_box_textarea"></textarea>'),r}},createChatBoxForAssociations:function(t){var e=ogame.chat;if(t){var i=e.data.association[t],n=$('<div class="chat_box_title"></div>');n.append('<span class="icon icon_close fright"></span>'),n.append('<span class="icon icon_maximize fright"></span>');for(var a=$('<div class="chat_box_ctn"><ul class="chat clearfix"></ul></div>'),s={},o=0;o<i.chatItemsByDateAsc.length;o++)s=i.chatItems[i.chatItemsByDateAsc[o]],a.find(".chat").append(e.createChatItem(s));var r=$('<div class="chat_box" data-associationId="'+t+'"></div>');return r.append(n),r.append(a),r.append('<textarea name="text" class="chat_box_textarea"></textarea>'),r}},createChatItem:function(t){if(t){var e=$('<div class="msg_head"></div>');e.append('<span class="msg_date fright">'+getFormatedDate(t.date,"[d].[m].[Y] <span>[H]:[i]:[s]</span>")+"</span>"),e.append('<span class="msg_title blue_txt '+t.newClass+'">'+t.playerName+"</span>");var i=$('<li class="chat_msg '+t.altClass+'" data-chat-id="'+t.chatID+'"></li>');if(i.append(e),void 0!==t.refData){var n=$('<div class="referenceMsg"></div>'),a='<div class="refAuthor">'+t.refData.author+"</div>",s='<div class="refText new">'+t.refData.text+"</div>";n.append(a),n.append(s),i.append(n)}return i.append('<span class="msg_content">'+t.chatContent+"</span>"),i.append('<div class="speechbubble_arrow"></div>'),i}console.warn("no chatItem given")},createMoreBox:function(t){var e=$('<li class="chat_bar_list_item '+t+'">'+chatLoca.MORE_USERS+'<span class="icon icon_close fright"></span></li>');return e.prepend($('<div class="chat_box"><ul class="more_items clearfix"></ul></div>')),e},filterPlayerlist:function(){var t,e,i,n=[],a=$("#playerlistFilters").find('input[type="checkbox"]');(a.each((function(){n.push($(this).attr("id"))})),$(".playerlist_item").show(),t=!1,a.each((function(){$(this).prop("checked")&&(t=!0)})),t)&&$(".playerlist_item").filter((function(){e=!1,i=$(this),$.each(n,(function(t,n){"off"===i.data(n)&&$("#"+n).prop("checked")&&(e=!0)})),!0===e?i.hide():i.show()}))},initChatBar:function(t){console.log("initChatBar() called, setting up click handlers for player:",t);var e=ogame.chat;ogame.chat.playerId=t,$("html").off(".chatBar"),$(window).resize((function(){e.updateChatBar()})),$(".chat_bar_list").on("click.chatBar","#chatBarPlayerList",(function(t){console.log("chatBarPlayerList clicked, target:",$(t.target).attr("id"),$(t.target).attr("class")),"chatBarPlayerList"===$(t.target).attr("id")||$(t.target).hasClass("onlineCount")?(console.log("Toggling cb_playerlist_box"),$(".cb_playerlist_box").toggle(),e.updateCustomScrollbar($(".scrollContainer"),!0),console.log("cb_playerlist_box toggled, visible:",$(".cb_playerlist_box").is(":visible"))):console.log("Click ignored - wrong target")})).on("click.chatBar",".chat_bar_list_item",(function(t){t.stopPropagation(),isNaN($(this).data("playerid"))?isNaN($(this).data("associationid")>0)||e.saveMessageCounterAssociation(0,$(this).data("associationid")):(ogame.messagemarker.toggle(ogame.messagemarker.action_remove,ogame.messagemarker.type_chattab,$(this).data("playerid")),ogame.messagemarker.toggle(ogame.messagemarker.action_remove,ogame.messagemarker.type_chatbar,$(this).data("playerid")),e.saveMessageCounter(0,$(this).data("playerid")),ogame.messagemarker.setPartnerId($(this).data("playerid")),ogame.messagemarker.updateNewMarker(),ogame.chat.updateTotalNewChatCounter()),console.log("chatUrl POST chatBarListRead()"),$.ajax({url:chatUrl,type:"POST",dataType:"json",data:{playerId:$(this).data("playerid"),action:"chatBarListRead"},success:function(t){},error:function(t,e,i){}}),$(this).closest(".more_items").length?e.swapChatBarItem($(this)):e.toggleChatBox($(t.target),$(this)),e.updateVisibleState()})).on("click.chatBar",".chat_bar_list_item > .icon_close",(function(t){t.stopPropagation();var i=$(this).closest(".chat_bar_list_item");ogame.chat.closeChatBox(i.attr("data-playerid"),i.attr("data-associationid")),i.remove("open"),e.updateChatBar()})).on("keyup.chatBar",".chat_box_textarea",(function(t){if(!t.ctrlKey&&10!=t.keyCode||13!=t.keyCode)$.trim($(this).val().length>0)&&(t.preventDefault(),e.submitChatBarMsg($(t.currentTarget),t.which,t.shiftKey,t.delegateTarget.scrollHeight));else{t.preventDefault();var i=$(this).val();$(this).val(i+"\n")}})).on("click.chatBar",".chat_box_textarea",(function(t){ogame.messagemarker.toggle(ogame.messagemarker.action_remove,ogame.messagemarker.type_chattab,$(this).parent().parent().parent().data("playerid")),ogame.messagemarker.toggle(ogame.messagemarker.action_remove,ogame.messagemarker.type_chatbar,$(this).parent().parent().parent().data("playerid")),$(this).data("playerid")>0?e.saveMessageCounter(0,$(this).data("playerid")):$(this).data("associationid")>0&&e.saveMessageCounterAssociation(0,$(this).data("associationid"))}))},initPlayerlist:function(){var t=ogame.chat,e=ogame.tools;$(".js_accordion").accordion({collapsible:!0,heightStyle:"content"}),$(".playerlist_item:odd").addClass("odd"),e.addHover(".playerlist_item, .msg, .playerlist_top_box .playerlist"),$(".js_playerlist").on("click.playerList",".pl_filter_set",(function(){t.filterPlayerlist()})),t.filterPlayerlist()},showChat:function(t){var e,i=!1,n=ogame.chat;($(".chat_bar_list_item").each((function(){var e=$(this);(void 0!==t.playerId&&e.data("playerid")===t.playerId||void 0!==t.associationId&&e.data("associationid")===t.associationId)&&(i=!0,e.hasClass("outOfChatbar")&&e.removeClass("outOfChatbar"),e.hasClass("open")?e.fadeTo("400",.3).fadeTo("400",1):(e.click(),e[0].style.display="inline"),e.find("textarea").focus())})),i)||(e=void 0!==t.playerId?n.createChatBarContainer(t.playerId):n.createChatBarContainerForAssociations(t.associationId),n.updateChatBar(e))},showChatHistory:function(t){var e=$(".js_chatHistory"),i=t.data;e.length&&e.remove(),$("#chatList").remove(),$(i).insertAfter("#planet"),$("li.playerlist_item").removeClass("active"),$("li.playerlist_item[data-playerid='"+t.playerId+"']").addClass("active"),initBBCodeEditor(locaKeys,itemNames,!1,".new_msg_textarea",2e3,!0)},submitChatBarMsg:function(t,e,i,n){var a=ogame.chat,s=parseInt($(".chat_box_textarea").css("max-height")),o=parseInt($(".chat_box_textarea").css("padding-top"))+parseInt($(".chat_box_textarea").css("padding-bottom"));13===e&&i?n<=s+o&&t.css("height",n-o):13===e&&(void 0!==t.parent(".chat_box").data("playerid")?a.sendMessage(t.parent(".chat_box").data("playerid"),0,t.val()):void 0!==t.parent(".chat_box").data("associationid")&&a.sendMessage(0,t.parent(".chat_box").data("associationid"),t.val()),t.val(""))},swapChatBarItem:function(t){var e=ogame.chat,i=$(".more_chat_bar_items").prev();i.removeClass("open").find(".icon_close").hide().end().find(".chat_box").hide(),i.remove(),t.addClass("open").find(".icon_close").show().end().find(".chat_box").show().end().insertBefore(".more_chat_bar_items"),e.addToMoreBox([i]),e.updateChatBar(),e.updateCustomScrollbar(t.find(".chat_box_ctn"))},toggleChatBox:function(t,e){var i=ogame.chat;if(!t.parents(".chat_box").length||t.hasClass("icon_close")){var n=e.children(".chat_box");if(n.is(":visible"))n.hide(),e.removeClass("open");else{e.hasClass("more_chat_bar_items")||(e.addClass("open"),i.updateChatBar()),n.show();var a=n.find(".chat_box_ctn");e.hasClass("more_chat_bar_items")&&(a=n),i.updateCustomScrollbar(a),n.find("textarea").focus()}ogame.messagecounter.resetCounterByType(ogame.messagecounter.type_chat)}},handleTooMuchWindows:function(t,e,i,n,a,s){var o=ogame.chat,r=!0,l=[];$($(".chat_bar_list > .chat_bar_list_item").get().reverse()).each((function(){var o=$(this);if(r){if(o.hasClass("more_chat_bar_items")||"chatBarPlayerList"===o.attr("id"))return;o.hasClass("open")?t--:e--,o.removeClass("open").find(".icon_close").hide().end().find(".chat_box").hide(),l.push(o),o.remove(),widthTotal=n*e+i*t+a,r=widthTotal>=s}})),o.addToMoreBox(l)},getItemFromMorelist2Chatbar:function(){var t=$(".more_items .chat_bar_list_item").first().remove(),e=ogame.chat;t.addClass("open").find(".icon_close").show().end().find(".chat_box").show().end().insertBefore(".more_chat_bar_items"),$(".more_items .chat_bar_list_item").length<=0&&$(".more_chat_bar_items").remove(),e.updateCustomScrollbar($(".more_chat_bar_items>.chat_box")),e.updateCustomScrollbar(t.find(".chat_box_ctn"))},updateChatBar:function(t){var e=ogame.chat,i=$(".chat_bar_list > .chat_bar_list_item.open").length,n=$(".more_chat_bar_items").length,a=$(".chat_bar_list").children().length-i-n,s=$("body").innerWidth();t&&i++;var o=190*a+270*i+190*n;o>=s?e.handleTooMuchWindows(i,a,270,190,190,s):o+270<=s&&$(".more_chat_bar_items").length>0&&e.getItemFromMorelist2Chatbar(),t&&(t.insertAfter("#chatBarPlayerList"),e.updateCustomScrollbar(t.find(".chat_box_ctn")))},updateCustomScrollbar:function(t,e){t&&0!=t.length&&(t.hasClass("mCustomScrollbar")?t.mCustomScrollbar("update"):t.mCustomScrollbar({theme:"ogame"}),!0!==e&&t.mCustomScrollbar("scrollTo","bottom",{scrollInertia:0}),t.each((function(){$(this).height()+"px"==$(this).css("max-height")&&$(this).addClass("scrollbarPresent")})))},updateVisibleState:function(){var t={chatbar:!1,players:[],associations:[]};$(".chat_bar_list>.chat_bar_list_item").each((function(){var e=$(this);"chatBarPlayerList"===e.attr("id")&&e.children(".cb_playerlist_box").is(":visible")?t.chatbar=!0:e.data("playerid")&&e.children(".chat_box").is(":visible")?t.players.push(e.data("playerid")):e.data("associationid")&&e.children(".chat_box").is(":visible")&&t.associations.push(e.data("associationid"))})),$.cookie("visibleChats",JSON.stringify(t),{expires:7})},showPlayerList:function(t){var e=ogame.chat;-1===$.inArray(t,e.playerListSelector)&&e.playerListSelector.push(t),!1===e.isLoadingPlayerList&&null===e.playerList?(e.isLoadingPlayerList=!0,console.log("showPlayerList() - Loading online buddies..."),$.ajax({url:"/buddies/online",type:"GET",dataType:"json",success:function(t){console.log("showPlayerList() - AJAX response received:",t),console.log("showPlayerList() - response.success:",t.success,"buddies count:",t.buddies?t.buddies.length:"undefined");var i='<div class="js_playerlist pl_container contentbox fleft">';i+='<h2 class="header"><span class="c-right"></span><span class="c-left"></span>Player list</h2>',i+='<div class="content">',i+='<div class="playerlist_box js_accordion ui-accordion ui-widget ui-helper-reset" role="tablist">',i+='<h3 class="ui-accordion-header ui-corner-top ui-state-default ui-accordion-header-active ui-state-active ui-accordion-icons" role="tab">',i+='<span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-s"></span>Buddies</h3>',i+='<div class="ui-accordion-content ui-corner-bottom ui-helper-reset ui-widget-content ui-accordion-content-active" role="tabpanel">',i+='<div class="playerlist_top_box"></div>',i+='<div class="scrollContainer"><ul class="playerlist">',t.success&&t.buddies&&t.buddies.length>0?t.buddies.forEach((function(t,e){i+='<li class="playerlist_item '+(e%2==0?"":"odd")+'" data-playerid="'+t.id+'">',i+='<p class="playername">',i+='<span class="playerstatus tooltip online" data-tooltip-title="online"></span>',i+=t.username+"</p>",i+='<span class="new_msg_count noMessage" data-playerid="'+t.id+'" data-new-messages="0">0</span>',i+='<span class="chatstatus cs_active fright"></span>',i+="</li>"})):i+='<li class="no_buddies">No buddies online</li>',i+="</ul></div></div></div>",i+="</div>",i+='<div class="footer"><div class="c-right"></div><div class="c-left"></div></div>',i+="</div>",e.playerList=i,e.isLoadingPlayerList=!1,console.log("showPlayerList() - playerList set, calling _showPlayerList()"),e._showPlayerList()},error:function(t,i,n){console.error("showPlayerList() - Error loading buddies:",i,n),e.isLoadingPlayerList=!1,e.playerList='<div class="content"><p>Error loading buddies</p></div>',e._showPlayerList()}})):(console.log("showPlayerList() - Using cached player list"),e._showPlayerList())},_showPlayerList:function(){var t=ogame.chat;$.each(t.playerListSelector,(function(e,i){$(i).html(t.playerList)}))}},inventoryObj={currentPage:null,currentItems:null,currentItem:null,currentCategory:null,initalizeSlider:function(t,e,i,n,a,s,o,r,l){if((inventoryObj.currentItems!=t||void 0!==s)&&0!=s){inventoryObj.currentItems=t,a=a||"slideIn",o=o||"tooltipHTML js_hideTipOnMobile",void 0===r&&(r=!0),void 0===l&&(l=!0),$("#"+e+"Box").remove(".anythingSlider");var c=[],d=0;for(var u in t){if(void 0===(w=t[u]).hide||!w.hide){if("shop"==inventoryObj.currentPage||"inventory"==inventoryObj.currentPage){var h=d%inventoryObj.itemsPerSlide;c[d+h%3*2-2*Math.floor(h/3)]=w}else c[d]=w;d++}}for(var p=0,f=0,m=$('<ul id="'+e+'" />'),g=c.length;f<g;f++)if(void 0!==c[f]){var v,b,y,_,x,w=c[f];if(f%inventoryObj.itemsPerSlide==0){var C=$('<li class="slide_'+p+'" />').appendTo(m);p++}"shop"==inventoryObj.currentPage?(v=getNumberFormatShort(w.costs,null)+" "+loca.currency[w.currency],b="price"):(v=getNumberFormatShort(w.amount),b="amount"),_=r?w.imageLarge+"-75x.png":w.imageLarge+"-100x.png",x=w.canBeActivated||w.canBeBoughtAndActivated?"enabled":"disabled",y=w.isReduced?'<div class="sale_badge '+x+'"></div>':"";var k=null!=w.timeLeft?" js_is_active ":"",S="",T=w.title;-1!=e.indexOf("js_activeItemSlider")&&(T="",S=null!=w.timeLeft?'<span class="js_duration undermark" data-total-duration="'+w.totalTime+'">'+w.timeLeft+"</span>":"");var I="";null!=w.timeLeft&&-1!=e.indexOf("js_activeItemSlider")&&(I='<div class="pusher"></div>');var D="";-1!=$.inArray(birthdayCategory,w.category)&&(D='<div class="event_active_hint"></div>'),C.append('<div class="item_img r_'+w.rarity+'" style="background-image: url(/img/icons/items/'+_+');"><div class="item_img_box">'+D+'<div class="activation '+x+k+'"></div><a href="javascript:void(0);" tabindex="1" title="'+T+'" class="detail_button '+o+" "+a+'" ref="'+w.ref+'">'+y+'<span class="ecke"><span class="level '+b+'">'+v+"</span></span></a></div>"+S+I+"</div>")}else C.append('<div class="item_img"><div class="empty border5px"></div></div>');if($("#"+e+"Box").prepend(m),f%inventoryObj.itemsPerSlide!=0)for(var A=f%inventoryObj.itemsPerSlide;A<inventoryObj.itemsPerSlide;A++)$("#"+e+" li:last").append('<div class="item_img"><div class="empty border5px"></div></div>');return mySlider=$("#"+e).anythingSlider({startStopped:!0,buildStartStop:!1,expand:!0,resizeContents:!1,theme:"default",infiniteSlides:!1,autoPlay:!1,easing:"swing",resizeContents:!0,stopAtEnd:!0,playRtl:isRTLEnabled,hashTags:!0,buildNavigation:l,onInitialized:function(t,e){if(isMobile){var i=0,n=0,a="ontouchend"in document,s=a?"touchstart":"mousedown",o=a?"touchmove":"mousemove",r=a?"touchend":"mouseup";e.$window.bind(s,(function(t){n=(new Date).getTime(),i=t.originalEvent.touches?t.originalEvent.touches[0].pageX:t.pageX})).bind(r,(function(t){n=0,i=0})).bind(o,(function(t){var a=t.originalEvent.touches?t.originalEvent.touches[0].pageX:t.pageX,s=0===i?0:Math.abs(a-i),o=(new Date).getTime();0!==n&&o-n<1e3&&s>50&&(a<i&&e.goForward(),a>i&&e.goBack(),n=0,i=0)}))}}})}},initShop:function(){var t=this;$(window).unbind(".shop"),$(document).undelegate(".slideIn","click.shop").delegate(".slideIn","click.shop",(function(){t.currentItem==$(this).attr("ref")?(t.currentItem=null,$.bbq.pushState({item:""})):(t.currentItem=$(this).attr("ref"),$.bbq.pushState({item:$(this).attr("ref")}))})),$("button.to_shop").bind("click.shop",(function(){$.bbq.pushState({page:"shop"})})),$("button.to_inventory").bind("click.shop",(function(){$.bbq.pushState({page:"inventory"})})),$("button.buyResourcesLink").bind("click",(function(){reload_page($(this).data("link"))})),$(".to_shop, .to_inventory").hover((function(){$(this).addClass("hover")}),(function(){$(this).removeClass("hover")})),$(".categoryFilter li a").bind("click.shop",(function(){$.bbq.pushState({category:$(this).attr("rel")})})),$(window).unbind("hashchange.shop").bind("hashchange.shop",(function(e){t.onHashChange($.deparam.fragment(e.fragment))})),t.onHashChange($.deparam.fragment()),inventoryObj.refreshResources()},onHashChange:function(t){if(void 0!==t.page){var e=this.currentPage!=t.page;if(e&&("inventory"==t.page?(this.openInventory(),$(".planetlink, .moonlink").fragment({page:t.inventory})):(this.openShop(),$(".planetlink, .moonlink").fragment({page:t.shop})),this.updateCategoryAmount()),void 0!==t.category){if((t.category!=this.currentCategory||e)&&this.changeCategory(t.category),void 0===t.item||""==t.item&&null!=this.currentItem)$("#itemDetails a.close_details").click(),$(".planetlink, .moonlink").fragment({item:""});else if(this.currentItem!=t.item){var i=$(".slideIn[ref='"+t.item+"']");i.length?i.click():gfSlider.slideIn(getElementByIdWithCache("detail"),t.item),$(".planetlink, .moonlink").fragment({item:t.item})}}else $.bbq.pushState({category:$(".categoryFilter a:first").attr("rel")})}else{var n={page:"shop",category:$(".categoryFilter a:first").attr("rel")};if(void 0!==t.item&&""!=t.item){var a=inventoryObj.items_shop[t.item];a.category.length>0&&(n.category=a.category[a.category.length-1])}$.bbq.pushState(n)}},initShopDetails:function(){var t=$.deparam.querystring().page;$(document).undelegate("#itemDetails .close_details","click").delegate("#itemDetails .close_details","click",(function(){$("a.slideIn[ref="+$(this).attr("ref")+"]:first").click()})).undelegate("#itemDetails a.item.build-it","click").delegate("#itemDetails a.item.build-it","click",(function(){return $.ajax({url:$(this).attr("rel"),data:{ajax:1,token:buyToken},type:"POST",dataType:"json",error:function(){fadeBox(translation.buyError,!0)},success:function(t){buyToken=t.newToken,t.error?fadeBox(t.message,!0):(fadeBox(t.message,!1),inventoryObj.refreshResources(),inventoryObj.refreshItemData(t.item))}}),!1})).undelegate("#itemDetails a.item.build-it_disabled.dm","click").delegate("#itemDetails a.item.build-it_disabled.dm","click",(function(){errorBoxDecision(LocalizationStrings.error,loca.buyDMDecision,LocalizationStrings.yes,LocalizationStrings.no,(function(){$("a.dm_button").length>0?$("a.dm_button").click():window.location.href=$("#darkmatter_box a").attr("href")}))})).undelegate("#itemDetails a.activateItem.build-it","click").delegate("#itemDetails a.activateItem.build-it","click",(function(){var e=$(this);function i(){$.ajax({url:e.attr("rel"),data:{ajax:1,token:activateToken,referrerPage:t},type:"POST",dataType:"json",error:function(){fadeBox(translation.buyError,!0),$("#itemDetails a.activateItem").removeClass("build-it").addClass("build-it_disabled")},success:function(t){if(activateToken=t.newToken,t.error)fadeBox(t.message,!0),$("#itemDetails a.activateItem").removeClass("build-it").addClass("build-it_disabled");else{if(t.message.reload)return void(location.href=getRedirectLink());fadeBox((t=t.message).message,!1),inventoryObj.refreshResources(),inventoryObj.refreshItemData(t.item)}}})}return e.hasClass("isUpgrade")?errorBoxDecision(LocalizationStrings.activateItem.upgradeItemQuestionHeader,LocalizationStrings.activateItem.upgradeItemQuestion,LocalizationStrings.yes,LocalizationStrings.no,i):i(),!1})).undelegate("#itemDetails a.buyAndActivate.build-it","click").delegate("#itemDetails a.buyAndActivate.build-it","click",(function(){var e=$(this);function i(){$.ajax({url:e.attr("rel"),data:{ajax:1,token:activateToken,referrerPage:t},type:"POST",dataType:"json",error:function(){fadeBox(translation.buyError,!0),$("#itemDetails a.activateItem").removeClass("build-it").addClass("build-it_disabled")},success:function(t){if(activateToken=t.newToken,t.error)fadeBox(t.message,!0),$("#itemDetails a.activateItem").removeClass("build-it").addClass("build-it_disabled");else{if(t.message.reload)return void(location.href=getRedirectLink());fadeBox((t=t.message).message,!1),inventoryObj.refreshResources(),inventoryObj.refreshItemData(t.item)}}})}return e.hasClass("isUpgrade")?errorBoxDecision(LocalizationStrings.activateItem.upgradeItemQuestionHeader,LocalizationStrings.activateItem.upgradeItemQuestion,LocalizationStrings.yes,LocalizationStrings.no,i):i(),!1}))},refreshResources:function(){getAjaxResourcebox((function(t){$(".to_dark_matter .level").text(t.darkmatter.resources.actualFormat)}))},refreshItemData:function(t){var e=t.ref;if(changeTooltip($(".detail_button[ref='"+e+"']"),t.title),$(".detail_button[ref='"+e+"'] span.amount, #itemDetails[data-uuid='"+e+"'] span.amount").html(tsdpkt(t.amount)),void 0!==inventoryObj.items_inventory&&(0==inventoryObj.items_inventory.length?inventoryObj.items_inventory={}:t.amount<=0?delete inventoryObj.items_inventory[e]:inventoryObj.items_inventory[e]=t),void 0!==inventoryObj.items_shop&&(0==inventoryObj.items_shop.length&&(inventoryObj.items_shop={}),inventoryObj.items_shop[e]=t),changeTooltip($('#itemDetails[data-uuid="'+e+'"] a.activateItem, #itemDetails[data-uuid="'+e+'"] a.buyAndActivate'),t.activationTitle),t.hasEnoughCurrency?$('#itemDetails[data-uuid="'+e+'"] a.item').addClass("build-it").removeClass("build-it_disabled"):$('#itemDetails[data-uuid="'+e+'"] a.item').removeClass("build-it").addClass("build-it_disabled"),t.amount>0?($('#itemDetails[data-uuid="'+e+'"] a.activateItem').show(),$('#itemDetails[data-uuid="'+e+'"] a.buyAndActivate').hide(),t.canBeActivated?$('#itemDetails[data-uuid="'+e+'"] a.activateItem').removeClass("build-it_disabled").addClass("build-it"):$('#itemDetails[data-uuid="'+e+'"] a.activateItem').addClass("build-it_disabled").removeClass("build-it")):($('#itemDetails[data-uuid="'+e+'"] a.activateItem').hide(),$('#itemDetails[data-uuid="'+e+'"] a.buyAndActivate').show(),t.canBeBoughtAndActivated&&t.hasEnoughCurrency?$('#itemDetails[data-uuid="'+e+'"] a.buyAndActivate').removeClass("build-it_disabled").addClass("build-it"):$('#itemDetails[data-uuid="'+e+'"] a.buyAndActivate').addClass("build-it_disabled").removeClass("build-it")),isMobile){var i="";$('#itemDetails[data-uuid="'+e+'"] a.activateItem:visible,#itemDetails[data-uuid="'+e+'"] a.buyAndActivate:visible').hasClass("build-it_disabled")&&(i+=t.activationTitle),t.buyTitle.length&&t.buyTitle!=t.activationTitle&&(i+=t.buyTitle),$('#itemDetails[data-uuid="'+e+'"] .info_txt').text(i)}t.timeLeft>0&&t.extendable?($('#itemDetails[data-uuid="'+e+'"] a.activateItem span').html(loca.extend),$('#itemDetails[data-uuid="'+e+'"] a.buyAndActivate span').html(loca.buyAndExtend)):($('#itemDetails[data-uuid="'+e+'"] a.activateItem span').html(loca.activate),$('#itemDetails[data-uuid="'+e+'"] a.buyAndActivate span').html(loca.buyAndActivate)),t.isAnUpgrade?$('#itemDetails[data-uuid="'+e+'"] a.activateItem, #itemDetails[data-uuid="'+e+'"] a.buyAndActivate').addClass("isUpgrade"):$('#itemDetails[data-uuid="'+e+'"] a.activateItem, #itemDetails[data-uuid="'+e+'"] a.buyAndActivate').removeClass("isUpgrade"),!0===this.inShop&&this.changeCategory($(".categoryFilter a.active").attr("rel")),this.updateCategoryAmount()},boughtItemHint:function(){$(".to_inventory .bought_item_notice").show().fadeOut(1e3)},openShop:function(){this.currentPage="shop",$("#js_inventorySliderBox").hide(),$("#js_shopSliderBox").show(),$(".to_inventory").removeClass("active"),$(".to_shop").addClass("active"),$("#buttonz h2").text(loca.LOCA_PREMIUM_SHOP),isMobile&&$(".js_shopCurrentPage").html(loca.shopText)},openInventory:function(){this.currentPage="inventory",$("#js_shopSliderBox").hide(),$("#js_inventorySliderBox").show(),$(".to_shop").removeClass("active"),$(".to_inventory").addClass("active"),$("#buttonz h2").text(loca.LOCA_PREMIUM_INVENTORY),isMobile&&$(".js_shopCurrentPage").html(loca.inventoryText)},changeCategory:function(t){inventoryObj.currentCategory=t,$(".planetlink, .moonlink").fragment({category:t}),$(".categoryFilter li, .categoryFilter li a").removeClass("active"),$('.categoryFilter li a[rel="'+t+'"]').addClass("active").parent().addClass("active"),$(".anythingSlider").remove();var e=function(e,i){var n=[],a=[],s=0;$.each(e,(function(e){null!=this.category&&(-1!=("$"+this.category.join("$")+"$").toLowerCase().indexOf("$"+t+"$")&&(n[inventoryObj.item_orders[t][this.ref]]=this,inventoryObj.item_orders[t][this.ref]>s&&(s=inventoryObj.item_orders[t][this.ref])))}));for(var o=0;o<=s;++o)n[o]&&(a[o]=n[o]);inventoryObj.initalizeSlider(a,i,340,340,null,null,null,!1)};"shop"==inventoryObj.currentPage?e(inventoryObj.items_shop,"js_shopSlider"):"inventory"==inventoryObj.currentPage&&e(inventoryObj.items_inventory,"js_inventorySlider")},updateCategoryAmount:function(){var t;if("shop"==inventoryObj.currentPage)t=inventoryObj.items_shop;else{if("inventory"!=inventoryObj.currentPage)return;t=inventoryObj.items_inventory}var e=$(".categoryFilter");e.find(".amount").text(0),$.each(t,(function(t){if(null!=this.category)for(var i in this.category){var n,a=this.category[i],s=e.find('a[rel="'+a+'"] .amount');"shop"==inventoryObj.currentPage?n=1:"inventory"==inventoryObj.currentPage&&(n=this.amount),s.text(tsdpkt(getValue(s.text())+n))}})),$.each(e.find("li"),(function(t){var i=inventoryObj.currentPage.slice(0,1).toUpperCase()+inventoryObj.currentPage.slice(1);$(this).hasClass("in"+i)?$(this).show():($(this).hide(),e.find("li:visible .active").length||e.find("li:visible:first a").click())}))}};var Spinners={version:"3.0.0"};function initShowMessage(){var t=$('.overlayDiv[data-page="showmessage"]');$(".answerHeadline",t).click((function(){$(this).toggleClass("open"),$(this).hasClass("open")?($(".answerForm",t).show(),$(".textWrapper",t).addClass("textWrapperSmall"),$(".textWrapper",t).removeClass("textWrapper")):($(".answerForm",t).hide(),$(".textWrapperSmall",t).addClass("textWrapper"),$(".textWrapperSmall",t).removeClass("textWrapperSmall"))})),$(".note > div:first-child",t).addClass("newMessage"),$(".info:odd",t).css("margin-left","40px"),$("div.note p:first").after('<span class="seperator">'),$(".answerHeadline",t).hover((function(){$(this).addClass("pushable")}),(function(){$(this).removeClass("pushable")})),$(".melden",t).click((function(){manageErrorbox($(this).attr("rel"),1)}))}function initNetworkAjax(){var t=$(".reiter");if(!$.isFunction(e))var e=function(){t.removeClass("active"),$(this).addClass("active"),ajaxLoad($(this).attr("id"),1)};t.off("click"),t.click(e),$("#checkAll").off("click").click((function(){$(".checker").prop("checked",$(this).is(":checked"))})),$(".overlay").click((function(){var t=$(this).attr("id");markAsRead(t)})),$("#messageContent select").change((function(){void 0===$("select option:selected").attr("id")?($(".buttonOK").hide(),mod=""):($(".buttonOK").show(),mod=$("select option:selected").attr("id"))})),$(".del").click((function(){mod=$(this).attr("id")})),$(".underlined").click((function(){$(".buttonOK").hide()})),reduceMsgCount(aktCat)}function MessageSlider(t){var e=this;e.htmlobject=t;var i=document.documentElement.clientHeight-160;this.open=function(){this.inAction||(e.startTime=(new Date).getTime(),e.inAction=!0,e.slideInStep())},this.slideInStep=function(){time=(new Date).getTime(),height=parseInt(e.currHeight*((time-e.startTime)/500)),height<e.currHeight?(e.htmlobject.style.height=height+"px",window.setTimeout(e.slideInStep,10)):(e.htmlobject.style.height=e.currHeight+"px",e.inAction=!1)},this.close=function(){e.inAction||(e.startTime=(new Date).getTime(),e.inAction=!0,e.htmlobject.style.height="0px",e.inAction=!1)},e.inAction=!1,document.getElementById("messages")?e.currHeight=Math.min(document.getElementById("messages").offsetHeight,i):e.currHeight=i}function closeDetails(t,e){var i=$("#fleet"+t);i.children(".openDetails").children().children().attr("src","/img/icons/de1e5f629d9e47d283488eee0c0ede.gif"),i.children(".quantity").show(),i.removeClass("detailsOpened"),i.addClass("detailsClosed"),currentMovementTabExtensionStates[t]=[0,e],updateCookieStatus(currentMovementTabExtensionStates)}function openDetails(t,e){var i=$("#fleet"+t);i.children(".openDetails").children().children().attr("src","/img/icons/577565fadab7780b0997a76d0dca9b.gif"),i.children(".quantity").hide(),i.removeClass("detailsClosed"),i.addClass("detailsOpened"),currentMovementTabExtensionStates[t]=[1,e],updateCookieStatus(currentMovementTabExtensionStates)}function updateCookieStatus(t){var e=JSON.stringify(t),i=JSON.stringify({expires:Math.round((new Date).getTime()/1e3)+604800});$.cookie("tabBoxFleets",e,i)}function openCloseDetails(t,e){"fleetDetails detailsOpened"==$("#fleet"+t).attr("class")?closeDetails(t,e):openDetails(t,e)}function hideTipsOnTabChange(){$("select").ogameDropDown("hide"),Tipped.hideAll()}function changeTooltip(t,e){var i=$(t);0!=i.length&&(removeTooltip(i),i.attr("title",e),initTooltips(i))}function removeTooltip(t){$(t).each((function(){$(this).data("tooltipLoaded")&&($(this).data("tooltipLoaded",!1),Tipped.remove($(this)[0]))}))}function getTooltipOptions(t){var e=$(t),i={skin:"cloud",maxWidth:400,closeButton:!1,hideOn:[{element:"self",event:"mouseleave"},{element:"tooltip",event:"mouseenter"}]};return-1!==window.location.href.indexOf("galaxy")&&(i.maxWidth=400),e.hasClass("tooltipPremium")&&(i.skin="premium"),e.hasClass("tooltipLeft")?i.hook={target:"leftmiddle",tooltip:"righttop"}:e.hasClass("tooltipRight")?i.hook={target:"rightmiddle",tooltip:"lefttop"}:e.hasClass("tooltipBottom")&&(i.hook={target:"bottommiddle",tooltip:"topmiddle"}),e.data("tooltip-width")&&(i.maxWidth=e.data("tooltip-width")),(isMobile||e.hasClass("tooltipClose"))&&(i.hideOthers=!0,i.hideOn=!1),i.afterUpdate=function(t,i){if(isMobile&&e.data("tooltip-button")){var n=$(document.createElement("div")).addClass("tooltipButton");$(document.createElement("a")).addClass("btn_blue").attr("href","javascript:void(0);").html(e.data("tooltip-button")).bind("click",(function(t){$(i).not("a")&&$(i).find("a").length&&(i=$(i).find("a")[0]);var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),i.dispatchEvent(e)})).appendTo(n),$(t).append(n)}if(isMobile||e.hasClass("tooltipClose")){var a=$(document.createElement("div")).addClass("close-tooltip");$(t).prepend(a)}Tipped.refresh(i)},i}function getTooltipSelector(t){var e=".tooltipPremium, .tooltip, .tooltipRight, .tooltipLeft, .tooltipBottom, .tooltipClose, .tooltipHTML, .tooltipRel, .tooltipAJAX, .tooltipCustom, .markItUpButton a";if(void 0===t)t=e;else if("string"==typeof t&&!t.match(/\.tooltip/)){var n=e.split(", "),a=t;for(i in n)t+=", "+a+" "+n[i]}return t}function sanitizeTooltip(t){return t.replace(/<\s*script/g,"&lt;script")}function initTooltips(t){function e(t){var e={},i=t.split("|"),n=$(document.createElement("h1")).html(i[0]),a=$(document.createElement("div")).addClass("splitLine");if(void 0!==i[2]&&void 0!==i[3]){var s=$(document.createElement("h1")).html(i[2]),o=$(document.createElement("div")).addClass("splitLine");e=$(document.createElement("div")).css("display","none").addClass("htmlTooltip").append(n).append(a).append(i[1]+"</br>").append(s).append(o).append(i[3])}else e=$(document.createElement("div")).css("display","none").addClass("htmlTooltip").append(n).append(a).append(i[1]);return e[0]}function i(t){var i=$(t);if(!i.data("tooltipLoaded"))if(i.data("tooltipLoaded",!0),isMobile&&i.hasClass("js_hideTipOnMobile"))i.attr("title","");else{var n=getTooltipOptions(i);if(i.hasClass("tooltipCustom")&&(0!=n.hideOn&&(n.hideOn=[{element:"self",event:"mouseleave"},{element:"tooltip",event:"mouseleave"}]),n.afterUpdate=function(t){$(t).find(".tooltipCustom").each((function(t,n){var a=getTooltipOptions(i);$(this).hasClass("tooltipHTML")?(a.inline=!0,a.hideOthers=!1,Tipped.create(this,e(sanitizeTooltip($(this).attr("title"))),a)):(a.hideOthers=!1,Tipped.create(this,sanitizeTooltip($(this).attr("title")),a))}))}),i.hasClass("tooltipHTML")){if(void 0===i.attr("title")||0==i.attr("title").trim().length)return;Tipped.create(i[0],e(sanitizeTooltip(i.attr("title"))),n)}else{if(i.hasClass("tooltipRel"))return n.inline=!0,void Tipped.create(i[0],i.attr("rel"),n);i.hasClass("tooltipAJAX")?$.get(i.attr("rel"),{},(function(t){Tipped.create(i[0],t,n)})):void 0!==i.attr("title")&&0!=i.attr("title").trim().length&&Tipped.create(i[0],sanitizeTooltip(i.attr("title")),n)}}}initTooltipSkins(),t=getTooltipSelector(t),removeTooltip(t),$(document).undelegate(t,"touchstart.tooltipClick").delegate(t,"touchstart.tooltipClick",(function(t){if(Tipped.visible(this)){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),this.dispatchEvent(e),t.preventDefault(),t.stopPropagation()}})),"string"==typeof t?$(document).undelegate(t,"mouseenter.tooltipLoad touchstart.tooltipLoad").delegate(t,"mouseenter.tooltipLoad touchstart.tooltipLoad",(function(t){i(this)})):$(t).each((function(){i(this)}))}function initTooltipSkins(){jQuery.extend(Tipped.Skins,{cloud:{border:{size:1,color:[{position:0,color:"#44576b"},{position:1,color:"#2f3b47"}]},background:{color:[{position:0,color:"#303a46"},{position:.49,color:"#242d38"},{position:.81,color:"#10181f"},{position:1,color:"#0d1014"}]},offset:{x:0,y:-1,mouse:{x:-12,y:-12}},stem:{height:6,width:11,offset:{x:5,y:5},spacing:0}},premium:{border:{size:1,color:[{position:0,color:"#000"},{position:1,color:"#000"}]},background:{color:[{position:0,color:"#a3e4f0"},{position:.15,color:"#1cbad7"},{position:1,color:"#0f78b1"}]},offset:{x:0,y:-1,mouse:{x:-12,y:-12}},stem:{height:6,width:11,offset:{x:5,y:5},spacing:0}}})}function initTrader(){var t=!1;void 0!==(e=$.deparam.fragment()).animation&&"false"==e.animation&&(t=!0);var e,i={$link:null,$panel:null,close:function(){this.$panel.hide()},setPanel:function(){this.$panel=$("#js_togglePanel"+traderObj.traderId.replace(/#div_trader/,""))},init:function(t){var e=$(t+" .selectWrapper");if(t=t.replace(/#div_trader/,""),e){this.$link=$("#js_toggleLink"+t),this.$panel=$("#js_togglePanel"+t);var n=this.$panel;n.hide(),this.$link.unbind("click.selectLink").bind("click.selectLink",(function(e){return t=traderObj.traderId.replace(/#div_trader/,""),$(this).hasClass("honor")||n.find("ul.active").has("li").length&&n.toggle(),!1})),$(".selectWrapper .source").unbind("click.selectPlanetOrMoon").bind("click.selectPlanetOrMoon",(function(t){i.selectPlanetOrMoon(this)})),$("#"+n.attr("id")).find("li").unbind("click.selectSource").bind("click.selectSource",(function(t){return traderObj.selectSource(this),!1})),i.outerClick(e,n);var a=null;e.unbind("mouseout.closeSelect").bind("mouseout.closeSelect",(function(t){var s=(t=t||window.event).relatedTarget?t.relatedTarget:t.toElement;s==e||i.isChildOf(s,e)||(a=setTimeout((function(){n.hide()}),8e3))})).unbind("mouseover.clearTimeout").bind("mouseover.clearTimeout",(function(){a&&clearTimeout(a)}))}},isChildOf:function(t,e){for(e=e[0];t&&t!=e;)t=t.parentNode;return t==e},outerClick:function(t,e){$("body").bind("click.outerClick",(function(i){i||(i=window.event),$(i.target).closest(".selectWrapper")!=t&&0!=e.is(":visible")&&e.toggle()}))},selectPlanetOrMoon:function(t){var e;if($(t).hasClass("selected"))return!1;var i="",n=null;if($(t).hasClass("js_honor")){$(traderObj.traderId+" .selectWrapper .source").removeClass("selected"),$(traderObj.traderId+" .js_honor").addClass("selected"),$(traderObj.traderId+" .toggleLink").addClass("honor");i='<img height="18" src="/img/icons/f35675179214f8f6f0f8d75740d7db.png" alt="'+loca.honorPoints+'"/><span class="option_source">'+loca.honorPoints+"</span>";return $(traderObj.traderId+" .js_valSourcePlanet").html(i),$(traderObj.traderId+" .normalResource").hide(),$(traderObj.traderId+" .honorResource").show(),!1}var a=$(traderObj.traderId+" .togglePanel"),s="planet";if($(t).hasClass("js_moon")){var o=0;for(e in s="moon",traderObj.planets)traderObj.planets[e].isMoon&&o++;if(0==o)return!1}var r=traderObj.planets[traderObj.current.planet];return a.find("ul").hide().removeClass("active"),a.find("ul."+s).show().addClass("active"),$(traderObj.traderId+" .toggleLink").removeClass("honor"),$(traderObj.traderId+" .selectWrapper .source").removeClass("selected"),$(traderObj.traderId+" .js_"+s).addClass("selected"),n=($(t).hasClass("js_moon")?r.isMoon:!r.isMoon)?traderObj.current.planet:null!=r.otherPlanet&&void 0!==traderObj.planets[r.otherPlanet]?r.otherPlanet:a.find("ul."+s+" li:first").attr("id"),$(traderObj.traderId+" .normalResource").show(),$(traderObj.traderId+" .honorResource").hide(),a.find("ul li#"+n).click(),!1},setToggleLink:function(t){var e=traderObj.traderId.replace(/#div_trader/,""),i=$(t).find("span"),n=traderObj.planets[$(t).attr("id")].name;n!=i.text()&&i.attr("title",n.replace(/\|/g,"&#124;")),this.$link=$("#js_toggleLink"+e),this.$link.html($(t).html())}};traderObj={traderBGPos:{"#div_traderResources":"0px 0px","#div_traderAuctioneer":"-546px 0px","#div_traderScrap":"0px -220px","#div_traderImportExport":"-546px -220px"},timer:500,planets:{},honorOutput:0,price:0,deficit:0,priceImportExport:0,sumResources:0,traderId:null,resources:["Metal","Crystal","Deuterium"],current:{planet:currentPlanetId,resource:"",sliderValue:""},barXPos:-180,barYPos:0,percentPaid:0,switchingTrader:!1,checkOverbidden:function(){0==playerBid||playerBid>=getValue($(".detail_value.currentSum").html())?$(".overbid_text").hide():$(".overbid_text").show()},refresh:function(){var t=traderObj.traderId;if("#"+$(this).closest(".div_trader").attr("id")===t){var e=$(this).attr("class");(e=!!new RegExp(/\b(js_slider\w*)\b/).test(e)&&RegExp.$1)&&(traderObj.current.sliderValue=$(this).slider("value"),traderObj.current.resource=e.replace("js_slider","").toLowerCase(),"honor"==traderObj.current.resource?traderObj.honorOutput=traderObj.current.sliderValue:traderObj.planets[traderObj.current.planet].output[traderObj.current.resource]=traderObj.current.sliderValue,formatNumber($(t+" .js_amount.js_"+traderObj.current.resource),traderObj.current.sliderValue),"#div_traderAuctioneer"==t?(traderObj.price=getValue($(t+" .js_price").html()),traderObj.sumAuctioneer(),traderObj.checkOverbidden()):"#div_traderImportExport"==t&&traderObj.sumImportExport())}},resetValues:function(t,e){for(var n in t=t||traderObj.traderId,e=e||!1,traderObj.planets)for(var a in traderObj.planets[n].output)traderObj.planets[n].output[a]=0;traderObj.honorOutput=0,$(".js_amount").val(0),"#div_traderAuctioneer"==traderObj.traderId?traderObj.sumAuctioneer():"#div_traderImportExport"==traderObj.traderId&&traderObj.sumImportExport(),e&&(t=t.replace(/#div_trader/,""),$("#js_togglePanel"+t).find("li#"+currentPlanetId).click()),i.close()},resetMaxAmount:function(t,e){var n=traderObj.traderId,a=traderObj.resources;for(var s in traderObj.planets)for(var o=0;o<a.length;o++){var r=a[o].toLowerCase();traderObj.planets[s].input[r]=t[s][r]}for(var l=0;l<a.length;l++){r=a[l].toLowerCase();var c=traderObj.planets[traderObj.current.planet].input[r];$(n+" .max_planet_"+r).html(number_format(c,0))}honorScore=e,$(n+" .max_planet_honor").html(number_format(Math.max(0,e),0)),i.close()},selectSource:function(t){traderObj.current.planet=$(t).attr("id"),i.close(),i.setToggleLink($(t));for(var e=traderObj.traderId,n=traderObj.current.planet,a=traderObj.resources,s=0;s<a.length;s++){var o=a[s].toLowerCase(),r=traderObj.planets[n].input[o];if("#div_traderImportExport"==e){var l=traderObj.priceImportExport/multiplier[o]-traderObj.sumResources+traderObj.planets[n].output[o];Math.min(r,l)}$(e+" .max_planet_"+o).html(number_format(r,0)),$(e+" .js_amount.js_"+o).val(number_format(traderObj.planets[n].output[o],0))}},selectTrader:function(e,n,a){n=n||traderObj.timer,$.bbq.pushState({page:e,animation:"false"}),$(".planetlink, .moonlink").fragment({page:e,animation:"false"}),traderObj.traderId="#div_"+e;var s=traderObj.traderId,o=$(".back_to_overview"),r=function(){"#div_traderAuctioneer"!=s&&"#div_traderImportExport"!=s||traderObj.resetValues(null,!0);var r=function(){$("#traderOverview").find(".c-left, .c-right").addClass("c-small"),o.show(),"#div_traderAuctioneer"==s||"#div_traderImportExport"==s?(o.addClass("left"),o.removeClass("right")):"#div_traderResources"!=s&&"#div_traderScrap"!=s||(o.addClass("right"),o.removeClass("left")),$("#planet #header_text h2").html(loca[e]).parent().show()};animation&&!t?($("#traderOverview").find(".c-left, .c-right").hide(),$("#planet").animate({backgroundPosition:traderObj.traderBGPos[s],height:"250px"},n,(function(){$("#planet").addClass("detail"),$("#traderOverview").find(".c-left, .c-right").show(),r(),"#div_traderResources"==s&&showTradeNowButton()}))):(t=!1,$("#planet").css("background-position",traderObj.traderBGPos[s]).css("height","250px"),r(),"#div_traderResources"==s&&showTradeNowButton()),i.setPanel(),$("#planet").addClass("detail"),$(".js_trader").hide(),$(s).show(),"#div_traderResources"==s&&void 0!==a&&$(s+" .ui-tabs").tabs("option","active",a),traderObj.switchingTrader=!1};if(0==$(traderObj.traderId).length){var l=e.toLowerCase().replace(/^trader/,"");$.ajax({url:traderUrl,type:"POST",data:{show:l,ajax:1},beforeSend:function(){$("#loadingOverlay").addClass(l).show()},success:function(t){$("#inhalt").append(t),$("#loadingOverlay").hide().removeClass(l),r()},error:function(){fadeBox(loca.error,!0),$("#loadingOverlay").hide().removeClass(l)}})}else r()},submitAuction:function(){var t=traderObj.traderId;getValue($(t+" .js_auctioneerSum").html());if(!$(t+" .right_box .pay").hasClass("disabled")&&traderObj.price>0&&traderObj.deficit<=0){$(t+" .right_box .pay").addClass("disabled");var e={planets:{},honor:traderObj.honorOutput};for(var i in traderObj.planets)e.planets[i]=traderObj.planets[i].output;$.ajax({url:auctionUrl,type:"POST",data:{bid:e,token:auctioneerToken,ajax:1},dataType:"json",success:function(e){auctioneerToken=e.newToken,fadeBox(e.message,e.error),e.error||(traderObj.resetValues(t,!1),traderObj.resetMaxAmount(e.planetResources,e.honor),traderObj.reloadResources())},error:function(){fadeBox(loca.error,!0)}})}return!1},submitImportExport:function(){if(!$(traderObj.traderId+" .right_box .pay").hasClass("disabled")){$(traderObj.traderId+" .right_box .pay").addClass("disabled");var t={planets:{},honor:traderObj.honorOutput};for(planetId in traderObj.planets)t.planets[planetId]=traderObj.planets[planetId].output;$.ajax({url:importUrl,type:"POST",data:{action:"trade",bid:t,token:importToken,ajax:1},dataType:"json",success:function(t){if(importToken=t.newToken,fadeBox(t.message,t.error),!t.error){for(planetId in traderObj.planets)traderObj.planets[planetId].output={metal:0,crystal:0,deuterium:0};$(traderObj.traderId+" .bargain_overlay").show(),$(traderObj.traderId+" .payment").hide(),$(traderObj.traderId+" .image_140px a").addClass("slideIn"),traderObj.reloadResources(),traderObj.updateImportItem(t.item),traderObj.refresh()}},error:function(){fadeBox(loca.error,!0)}})}return!1},reloadResources:function(t){getAjaxResourcebox(t)},changeImportItem:function(){return $(traderObj.traderId+" .import_bargain.change").hasClass("disabled")?darkMatter<importChangeCost&&errorBoxDecision(LocalizationStrings.error,loca.errorNotEnoughDM,LocalizationStrings.yes,LocalizationStrings.no,redirectPremium):($(traderObj.traderId+" .import_bargain.change").addClass("disabled"),$.ajax({url:importUrl,type:"POST",data:{action:"bargain",token:importToken,ajax:1},dataType:"json",success:function(t){importToken=t.newToken,fadeBox(t.message,t.error),t.error||(traderObj.updateImportItem(t.item),traderObj.reloadResources((function(){t.item.offersLeft>0&&darkMatter>=importChangeCost?$(traderObj.traderId+" .import_bargain.change").removeClass("disabled"):$(traderObj.traderId+" .import_bargain.change").addClass("disabled")})),traderObj.refresh())},error:function(){fadeBox(loca.error,!0)}})),!1},updateImportItem:function(t){$(traderObj.traderId+" .got_item_text").html(t.itemText),$(traderObj.traderId+" .bargain_text").html(t.bargainText),$(traderObj.traderId+" .bargain_cost").html(t.bargainCostText),importChangeCost=t.bargainCost,$(traderObj.traderId+" .image_140px img").attr("src","/img/icons/items/"+t.image+"-140x.png"),removeTooltip($(traderObj.traderId+" .image_140px a")),$(traderObj.traderId+" .image_140px a").attr("ref",t.uuid).removeClass("tooltip").addClass("tooltipHTML").attr("title",t.tooltip),initTooltips($(traderObj.traderId+" .image_140px a")),$(traderObj.traderId+" .detail_button .amount").text(t.amount)},takeImportItem:function(){return $(traderObj.traderId+" .import_bargain.take").hasClass("disabled")||($(traderObj.traderId+" .import_bargain.change").addClass("disabled"),$(traderObj.traderId+" .import_bargain.take").addClass("disabled"),$(traderObj.traderId+" .import_bargain.change").addClass("hidden"),$(traderObj.traderId+" .import_bargain.take").addClass("hidden"),$(traderObj.traderId+" .bargain_cost").addClass("hidden"),$.ajax({url:importUrl,type:"POST",data:{action:"takeItem",token:importToken,ajax:1},dataType:"json",success:function(t){if(importToken=t.newToken,fadeBox(t.message,t.error),!t.error){var e=t.item.ref;changeTooltip($(".detail_button[ref='"+e+"']"),t.item.title),$(".detail_button[ref='"+e+"'] span.amount, #itemDetails[data-uuid='"+e+"'] span.amount").html(tsdpkt(t.item.amount)),t.item.canBeActivated?$('#itemDetails[data-uuid="'+e+'"] a.activateItem').removeClass("build-it_disabled").addClass("build-it"):$('#itemDetails[data-uuid="'+e+'"] a.activateItem').addClass("build-it_disabled").removeClass("build-it"),0==t.item.newOffer?$(traderObj.traderId+" .bargain_text").html(t.item.noOfferMessage):traderObj.resetImport(t.item.newOffer)}},error:function(){fadeBox(loca.error,!0)}})),!1},resetImport:function(t){importChangeCost=t.bargainCost,darkMatter>=importChangeCost?$(traderObj.traderId+" .import_bargain.change").removeClass("disabled"):$(traderObj.traderId+" .import_bargain.change").addClass("disabled"),$(traderObj.traderId+" .import_bargain.take").removeClass("disabled"),$(traderObj.traderId+" .import_bargain.change").removeClass("hidden"),$(traderObj.traderId+" .import_bargain.take").removeClass("hidden"),$(traderObj.traderId+" .bargain_cost").removeClass("hidden"),$(traderObj.traderId+" .bargain_overlay").hide(),$(traderObj.traderId+" .payment").show(),$(traderObj.traderId+" .image_140px img").attr("src","/cdn/img/trader/container_"+t.rarity+".jpg"),$(traderObj.traderId+" .image_140px a").removeClass("slideIn").attr("ref","").removeClass("tooltipHTML").addClass("tooltip").removeClass("r_common_140px").removeClass("r_uncommon_140px").removeClass("r_rare_140px").removeClass("r_epic_140px").removeClass("r_buddy_140px").addClass("r_"+t.rarity+"_140px"),changeTooltip($(traderObj.traderId+" .image_140px a"),t.tooltip),$(traderObj.traderId+" .js_import_price").removeClass("green_text").text(number_format(t.price,0)),$(traderObj.traderId+" .image_140px .amount").text("?"),traderObj.priceImportExport=getValue($(".js_import_price").html()),traderObj.resetValues(null,!0),traderObj.init()},sumAuctioneer:function(){traderObj.traderId;var t=traderObj.price;0==t?$("#div_traderAuctioneer .js_amount").attr("disabled","disabled"):$("#div_traderAuctioneer .js_amount").removeAttr("disabled");var e=0;for(var i in traderObj.planets){var n=traderObj.planets[i].output;e+=parseInt(n.metal)*multiplier.metal+parseInt(n.crystal)*multiplier.crystal+parseInt(n.deuterium)*multiplier.deuterium}e+=parseInt(traderObj.honorOutput)*multiplier.honor,e=Math.floor(e),traderObj.deficit=Number(auctioneer.calculateDeficit())-Number(e),traderObj.deficit>0?$(" .js_deficit").html(number_format(traderObj.deficit,0)):$(" .js_deficit").html(number_format(0,0)),e>0?$("#div_traderAuctioneer .js_auctioneerSum").html("+ "+number_format(e,0)):$("#div_traderAuctioneer .js_auctioneerSum").html(""),$("#div_traderAuctioneer .js_alreadyBidden").html(number_format(Math.floor(playerBid+e),0)),t>0&&traderObj.deficit<=0?$("#div_traderAuctioneer .right_box .pay").removeClass("disabled"):$("#div_traderAuctioneer .right_box .pay").addClass("disabled")},sumImportExport:function(){var t=traderObj.traderId,e=0,i=0,n=0;for(var a in traderObj.sumResources=0,traderObj.planets){var s=traderObj.planets[a].output;e+=parseInt(s.metal)*multiplier.metal,i+=parseInt(s.crystal)*multiplier.crystal,n+=parseInt(s.deuterium)*multiplier.deuterium}var o=traderObj.honorOutput*multiplier.honor;traderObj.sumResources+=e+i+n+o,traderObj.sumResources>=traderObj.priceImportExport&&(traderObj.sumResources=traderObj.priceImportExport),$(t+" .js_sum_price").html(number_format(Math.floor(traderObj.sumResources),0)),traderObj.sumResources>=traderObj.priceImportExport?($(t+" .js_import_price").addClass("green_text"),$(t+" .right_box .pay").removeClass("disabled")):($(t+" .js_import_price").removeClass("green_text"),$(t+" .right_box .pay").addClass("disabled"))},updateValues:function(t){var e=traderObj.traderId;if(e==="#"+t.closest(".div_trader").attr("id")){var i=t.attr("class");if(i=!!new RegExp(/\b(js_slider\w*)\b/).test(i)&&RegExp.$1){var n,a,s,o=traderObj.current.planet;-1!=i.indexOf("More")?(s=i.replace("More",""),n="More"):-1!=i.indexOf("Max")&&(s=i.replace("Max",""),n="Max"),traderObj.current.resource=s.replace("js_slider","").toLowerCase()||null;var r=traderObj.current.resource,l=0;l="honor"==r?Math.max(0,honorScore):traderObj.planets[o].input[r],a=getValue($(e+" ."+s+"Input").val()),"More"==n?("#div_traderImportExport"==e?traderObj.sumResources<=traderObj.priceImportExport-1e3*multiplier[r]?a+=1e3:traderObj.sumResources<traderObj.priceImportExport&&(a+=Math.ceil((traderObj.priceImportExport-traderObj.sumResources)/multiplier[r])):"#div_traderAuctioneer"==e&&traderObj.price>0&&(a+=1e3),a>=l&&(a=Math.max(0,l))):"Max"==n&&("#div_traderImportExport"==e?0==traderObj.sumResources?a=Math.min(l,Math.ceil(traderObj.priceImportExport/multiplier[r])):traderObj.sumResources.isBetween(0,traderObj.priceImportExport-1)&&(a=Math.min(l,a+Math.ceil((traderObj.priceImportExport-traderObj.sumResources)/multiplier[r])),a=Math.max(0,a)):"#div_traderAuctioneer"==e&&traderObj.price>0&&(a=Math.min(l,Math.ceil(getValue($(e+" .js_deficit").html())/multiplier[r]+a))),"honor"==r&&a<0&&(a=0)),$(e+" .js_amount."+s+"Input").val(number_format(a,0)),"honor"==r?traderObj.honorOutput=a:traderObj.planets[o].output[r]=a,"#div_traderImportExport"==e?traderObj.sumImportExport():"#div_traderAuctioneer"==e&&traderObj.price>0&&(traderObj.sumAuctioneer(),traderObj.checkOverbidden())}}},updateValuesInputCanged:function(t){var e=traderObj.traderId;if(e==="#"+t.closest(".div_trader").attr("id")){var i=t.attr("class");if(i=!!new RegExp(/\b(js_slider\w*)\b/).test(i)&&RegExp.$1){var n=i.replace("Input",""),a=n.replace("js_slider","").toLowerCase(),s=traderObj.current.planet,o=0;o="honor"==a?Math.max(0,honorScore):parseInt(traderObj.planets[s].input[a]);var r=0;if("#div_traderImportExport"==e){var l=0;for(var c in traderObj.planets){var d=traderObj.planets[c].output;"metal"!=a&&(l+=Math.floor(parseInt(d.metal)*multiplier.metal)),"crystal"!=a&&(l+=Math.floor(parseInt(d.crystal)*multiplier.crystal)),"deuterium"!=a&&(l+=Math.floor(parseInt(d.deuterium)*multiplier.deuterium))}r=Math.min(getValue(t.val()),Math.ceil((traderObj.priceImportExport-l)/multiplier[a]))}else"#div_traderAuctioneer"==e&&(r=getValue(t.val()));r=Math.min(r,o),traderObj.planets[s].output[a]=r,"honor"==a?traderObj.honorOutput=r:traderObj.planets[s].output[a]=r,"#div_traderImportExport"==e?traderObj.sumImportExport():"#div_traderAuctioneer"==e&&(traderObj.sumAuctioneer(),traderObj.checkOverbidden()),formatNumber(e+" .js_amount."+n+"Input",r)}}},init:function(){$(".honorResource").hide(),$("#menuTable a.trader").unbind("click.gotoTrader").bind("click.gotoTrader",(function(t){t.preventDefault(),traderObj.switchTrader("traderResources")})),$(window).unbind("hashchange.switchTrader").bind("hashchange.switchTrader",(function(t){var e=$.deparam.fragment(t.fragment);void 0===e.page||""==e.page&&null!=traderObj.traderId?traderObj.returnToOverview():traderObj.switchTrader(e.page)})),$(".small_back_to_overview").unbind("mouseenter").unbind("mouseout").bind("mouseenter",(function(){$("#header_text").css("background-position","0 -250px")})).bind("mouseout",(function(){$("#header_text").css("background-position","0 0")}))},initSliderTrader:function(t){$(t+" .js_valButton").unbind("click.valControl"),$(t+" .js_amount").unbind("keyup.inputVal"),i.init(t),$(t+" .js_valButton").bind("click.valControl",(function(t){traderObj.updateValues($(this)),t.stopPropagation()})),$(t+" .js_amount").bind("keyup.inputVal",(function(t){traderObj.updateValuesInputCanged($(this)),t.stopPropagation()}))},initImportExport:function(){traderObj.planets=planetResources,traderObj.priceImportExport=getValue($(".js_import_price").html()),traderObj.initSliderTrader("#div_traderImportExport"),$("#div_traderImportExport .right_box .pay").bind("click",(function(){traderObj.submitImportExport()})),$("#div_traderImportExport .import_bargain.change").bind("click",(function(){traderObj.changeImportItem()})),$("#div_traderImportExport .import_bargain.take").bind("click",(function(){traderObj.takeImportItem()}))},switchTrader:function(e){traderObj.switchingTrader||(traderObj.switchingTrader=!0,Tipped.hideAll(),$("#planet .close_details:visible").click(),"#div_"+e!=traderObj.traderId&&(null!=traderObj.traderId||""==e||null==e?(traderObj.returnToOverview(),animation&&!t?setTimeout((function(){traderObj.selectTrader(e)}),500):traderObj.selectTrader(e)):traderObj.selectTrader(e)))},returnToOverview:function(){Tipped.hideAll(),$("#planet #header_text h2").empty().parent().hide(),$("#traderOverview").find(".c-left, .c-right").hide();var e=traderObj.traderId;e&&($(e).hide(),$("#callTrader").hide(),animation&&!t?($("#planet h2").hide(),$("#planet").animate({backgroundPosition:"-273px 0px",height:"470px"},500,(function(){$("#planet h2").show(),$("#planet").removeClass("detail"),$("#traderOverview").find(".c-left, .c-right").show(),$(".js_trader").show()}))):($("#planet").removeClass("detail").css("background-position","-273px 0px").css("height","470px"),$(".js_trader").show()),$("#planet a").show(),$("#planet .back_to_overview").hide(),removeTooltip($("#planet .back_to_overview")),$("#traderOverview").find(".c-left, .c-right").removeClass("c-small"),traderObj.traderId=null,traderObj.switchingTrader=!1)}},breakerObj={costs:null,offer:null,ships:{},locked:!1,lastTechId:null,initialize:function(){this.offer=parseInt($(".scrap_offer_amount").html()),this.costs=breakerCosts;var t=this;$("#js_anythingSliderShips, #js_anythingSliderDefense").anythingSlider({startStopped:!0,buildStartStop:!1,expand:!0,resizeContents:!1,theme:"default",infiniteSlides:!1,autoPlay:!1,easing:"swing",resizeContents:!0,stopAtEnd:!0,playRtl:isRTLEnabled,buildNavigation:!1,onInitialized:function(t,e){if(isMobile){var i=0,n=0,a="ontouchend"in document,s=a?"touchstart":"mousedown",o=a?"touchmove":"mousemove",r=a?"touchend":"mouseup";e.$window.bind(s,(function(t){n=(new Date).getTime(),i=t.originalEvent.touches?t.originalEvent.touches[0].pageX:t.pageX})).bind(r,(function(t){n=0,i=0})).bind(o,(function(t){t.preventDefault();var a=t.originalEvent.touches?t.originalEvent.touches[0].pageX:t.pageX,s=0===i?0:Math.abs(a-i),o=(new Date).getTime();0!==n&&o-n<1e3&&s>50&&(a<i&&e.goForward(),a>i&&e.goBack(),n=0,i=0)}))}}}),$("#js_anythingSliderDefense").parent().parent().hide(),$(".scrap_defense").bind("click.tabDefense",(function(){$(".scrap_ships").removeClass("selected"),$(this).addClass("selected"),$("#js_anythingSliderShips").parent().parent().hide(),$("#js_anythingSliderDefense").parent().parent().show()})),$(".scrap_ships").bind("click.tabShips",(function(){$(".scrap_defense").removeClass("selected"),$(this).addClass("selected"),$("#js_anythingSliderDefense").parent().parent().hide(),$("#js_anythingSliderShips").parent().parent().show()})),$(".buildingimg a").each((function(){var e=$(this).attr("ref").substr(6,3),i=$(this).find(".level"),n=i.contents().filter((function(){return 3==this.nodeType}));t.ships[e]=n.text().replace(/^\s+|\s+$/g,""),n.remove(),i.append(tsdpkt(t.ships[e]))})),$("#js_scrapBargain").unbind("click").bind("click",(function(){return $(this).hasClass("disabled")||t.bargain(t),!1})),$("#js_scrapScrapIT").unbind("click").bind("click",(function(){return $(this).hasClass("disabled")||t.trade(t),!1})),$("input.ship_amount").unbind("focus").bind("focus",(function(){t.lastTechId=$(this).attr("name").substr(2,3),$(this).val("")})),$("input.ship_amount").unbind("keyup change").bind("keyup change",(function(e){t.lastTechId=$(this).attr("name").substr(2,3),formatNumber(this,$(this).val());var i=$(this);clearTimeout(i.data("timer")),i.data("timer",setTimeout((function(){i.removeData("timer"),t.updateResources(t)}),300))})),$(".buildingimg a").unbind("click").bind("click",(function(){return!1})),$(".js_maxShips").unbind("click").bind("click",(function(){isMobile||$($(this).attr("ref")).focus();var e=t.ships[$(this).attr("ref").substr(6,3)];return $($(this).attr("ref")).val(tsdpkt(e)).trigger("change"),t.updateResources(t),!1})),$(".sendAll").unbind("click").bind("click",(function(){$(".anythingSlider ul:visible input").each((function(){t.lastTechId=$(this).attr("name").substr(2,3);var e=t.ships[t.lastTechId];$(this).val(tsdpkt(e))})),t.updateResources(t,(function(e){e.error&&($(".anythingSlider ul:visible input").val(""),$("#div_traderScrap .resource_amount").text(0),t.checkShips(t))}))})),$(".sendNone").unbind("click").bind("click",(function(){$(".anythingSlider ul:visible input").each((function(){t.lastTechId=$(this).attr("name").substr(2,3),$(this).val("")})),t.updateResources(t)})),$("#js_bargainCost").text(tsdpkt(this.costs)),this.checkMoney(this),this.checkShips(this),this.updateBargain(this)},bargain:function(t){$("#js_scrapBargain").addClass("disabled"),$.ajax({url:breakerCallLink,type:"POST",dataType:"json",data:{bargain:1,token:breakerToken},beforeSend:function(){t.lock(t)},success:function(e){t.unlock(t),breakerToken=e.newToken,fadeBox(e.message,e.error),e.error||(t.costs=e.bargainPrice,t.offer=e.percentage,darkMatter=e.resources.dm,t.updateBargain(t),t.updateResources(t),traderObj.reloadResources((function(){t.checkMoney(t),Tipped.show($("#js_scrapBargain")[0])}))),$(".scrap_trader_quote").text(e.quote)},error:function(){t.unlock(t)}})},trade:function(t){t.lock(t);var e,i,n=t.getTradeArray();errorBoxDecision(loca.breaker,(e=loca.breakerQuestion+'<br/><br/><div style="text-align: left; margin-left: 30px">',i=0,$.each(n,(function(t){e+=this+"x "+loca.shipNames[t]+", ",++i%2==0&&(e+="<br/>")})),e=e.replace(/, (<br\/>)?$/,""),e+="</div>"),LocalizationStrings.yes,LocalizationStrings.no,(function(){$.ajax({url:breakerCallLink,type:"POST",dataType:"json",data:{lastTechId:t.lastTechId,finishTrade:1,trade:n,token:breakerToken},success:function(e){t.unlock(t),breakerToken=e.newToken,e.error?fadeBox(e.message,!0):(fadeBox(e.message,!1),t.offer=e.percentage,t.costs=e.bargainPrice,t.resetForm(),t.updateBargain(t),$("#js_scrapAmountMetal").html(0),$("#js_scrapAmountCrystal").html(0),$("#js_scrapAmountDeuterium").html(0),traderObj.reloadResources((function(){t.updateShips(t)}))),$(".scrap_trader_quote").text(e.quote)},error:function(){t.unlock(t),fadeBox(loca.error,!0)}})}),(function(){t.unlock(t)}))},updateResources:function(t,e){t.locked||$.ajax({url:breakerCallLink,type:"POST",dataType:"json",data:{lastTechId:t.lastTechId,trade:t.getTradeArray(),token:breakerToken},beforeSend:function(){t.lock(t)},success:function(i){breakerToken=i.newToken,i.error&&fadeBox(i.message,!0),t.locked=!1;var n=!1;for(var a in i.techAmount)$("#ship_"+a).val(tsdpkt(i.techAmount[a])),n||$("#ship_"+a).val()==t.ships[a]||(n=!0);$("#js_scrapAmountMetal").html(tsdpkt(i.resources.metal)),$("#js_scrapAmountCrystal").html(tsdpkt(i.resources.crystal)),$("#js_scrapAmountDeuterium").html(tsdpkt(i.resources.deuterium)),t.notFirstOffer||($(".scrap_trader_quote").text(loca.breakerFirstOffer),t.notFirstOffer=!0),n?t.updateShips(t):t.unlock(t),"function"==typeof e&&e(i)},error:function(){t.unlock(t)}})},updateShips:function(t){$.ajax({url:techUrl,type:"POST",dataType:"json",beforeSend:function(){t.lock(t)},success:function(e){$("#div_traderScrap .item").each((function(){var i=$(this).attr("id").substr(6,3);if(void 0!==e[i]){var n=0;null!=e[i]&&(n=getValue(e[i])),t.ships[i]=n;var a=$(this).find(".level");if(a.contents().filter((function(){return 3==this.nodeType})).remove(),a.append(tsdpkt(n)),null!=e[i]){var s=$("#button"+i);s.removeClass("on").removeClass("off"),n>0?s.addClass("on"):s.addClass("off")}}})),t.unlock(t)},error:function(){t.unlock(t)}})},getTradeArray:function(){var t={};return $("input.ship_amount").each((function(){var e=$(this).attr("name").substr(2,3);0!=getValue($(this).val())&&(t[e]=getValue($(this).val()))})),t},resetForm:function(){$("input.ship_amount").each((function(){$(this).val("0")})),removeTooltip($("#js_scrapBargain")),$("#js_scrapBargain").removeClass("tooltip").removeAttr("title")},checkMoney:function(t){darkMatter<t.costs?$("#js_scrapBargain").addClass("disabled"):breakerMaximumPercent<=t.offer?($("#js_scrapBargain").addClass("disabled").addClass("tooltip").attr("title",loca.infoMaxBargain),initTooltips($("#js_scrapBargain"))):$("#js_scrapBargain").removeClass("disabled")},checkShips:function(t){var e=!1;$("input.ship_amount").each((function(){$(this).val().length>0&&getValue($(this).val())>0&&(e=!0)})),e?$("#js_scrapScrapIT").removeClass("disabled"):$("#js_scrapScrapIT").addClass("disabled")},updateBargain:function(t){$(".scrap_offer_amount").css("height",t.offer/100*$(".scrap_offer_amount").parent().css("height").replace("px","")),$(".scrap_offer_amount").html(t.offer+"%"),$(".js_bargainCost").text(tsdpkt(t.costs))},lock:function(t){$("#js_scrapBargain").addClass("disabled"),$("#js_scrapScrapIT").addClass("disabled"),t.locked=!0},unlock:function(t){t.locked=!1,t.checkShips(t),t.checkMoney(t)}},auctioneer={socket:null,connected:!1,timeout:null,retryInterval:5e3,historyShown:!1,initConnection:function(){try{var t=auctioneer;this.socket=new io.connect("/auctioneer",nodeParams),console.log("auctioneer ioConnect()"),this.socket.on("connect",(function(){t.connected=!0,clearTimeout(this.timeout)})),this.socket.on("disconnect",(function(){t.connected=!1,t.retryConnection()})),this.socket.on("new auction",(function(e){auctionId=e.auctionId;var i=$("#div_traderAuctioneer .detail_value.currentPlayer").html();i=null==e.oldAuction.player?loca.auctionNotSold:'<a href="'+e.oldAuction.player.link+'">'+e.oldAuction.player.name+"</a>",removeTooltip($("#div_traderAuctioneer .image_140px .detail_button"));var n=$("#div_traderAuctioneer .image_140px .detail_button").attr("title"),a='                        <li class="'+($(".auction_history li:first").hasClass("even")?"odd":"even")+'" style="display: none">                            <a href="javascript:void(0);"                               class="slideIn"                               ref="'+e.oldAuction.item.uuid+'">                                <img height="30" width="30"                                     src="/img/icons/items/'+e.oldAuction.item.imageSmall+'-small.png"                                     alt="" title="'+n+'"                                     class="item_img tooltipHTML tooltipLeft r_'+e.oldAuction.item.rarity+'"/>                            </a>                            <span class="detail sum">'+number_format(e.oldAuction.sum,0)+'</span>                            <span class="detail player">'+i+'</span>                            <span class="detail date_time">'+e.oldAuction.time+"</span>                        </li>";$(".auction_history .history_content ul").prepend(a),$(".auction_history .history_content li:first").slideDown("slow"),$("#div_traderAuctioneer .auction_history li").length>3&&($(".auction_history .history_content li:last").slideUp("slow",(function(){$(".auction_history .history_content li:eq(21)").remove();var t=$(".auction_history .history_content li:eq(3)");t.addClass("more_auctions_li"),auctioneer.historyShown&&t.show()})),$("#div_traderAuctioneer .auction_history .more").show()),$("#div_traderAuctioneer .image_140px .detail_button").attr("ref",e.item.uuid).attr("title","").removeClass("r_common_140px").removeClass("r_uncommon_140px").removeClass("r_rare_140px").removeClass("r_epic_140px").addClass("r_"+e.item.rarity+"_140px"),$("#div_traderAuctioneer .image_140px img").attr("src","/img/icons/items/"+e.item.image+"-140x.png"),$("#div_traderAuctioneer .left_header h2").html(loca.auctionRunning),t.setItemTooltip($("#div_traderAuctioneer .image_140px .detail_button")),t.setData({price:1e3,sum:0,player:null,bids:0,info:e.info}),$("#div_traderAuctioneer .js_alreadyBidden").html(number_format(0,0)),$(".noAuctionOverlay").hide(),traderObj.resetValues("#div_traderAuctioneer",!1),traderObj.checkOverbidden()})),this.socket.on("new bid",(function(e){e.player.id==playerId&&(playerBid=e.sum,AuctionIdOflastPlayerBid=e.auctionId,$("#div_traderAuctioneer .js_alreadyBidden").html(number_format(Math.floor(playerBid),0))),t.setData({price:e.price,sum:e.sum,player:e.player,bids:e.bids}),traderObj.checkOverbidden()})),this.socket.on("auction finished",(function(e){t.setData({price:0,player:e.player,bids:e.bids,info:e.info}),traderObj.resetValues("#div_traderAuctioneer",!1),$("#div_traderAuctioneer .js_alreadyBidden").html(number_format(0,0)),$("#div_traderAuctioneer .js_auctioneerSum").html(""),$("#div_traderAuctioneer .left_header h2").html(loca.auctionFinished),null!=e.player&&e.player.id==playerId&&t.setItemTooltip($("#div_traderAuctioneer .image_140px .detail_button")),$(".noAuctionOverlay").show(),traderObj.checkOverbidden()})),this.socket.on("timeLeft",(function(e){t.setData({info:e})}))}catch(t){}},setItemTooltip:function(t){$.ajax({url:detailUrl,data:{getDetails:1,type:$(t).attr("ref"),ajax:1},dataType:"json",success:function(e){changeTooltip(t,e.title),$("#itemDetails[data-uuid='"+$(t).attr("ref")+"'] .amount,a.detail_button[ref='"+$(t).attr("ref")+"'] .amount").html(tsdpkt(e.amount))},error:function(){fadeBox(loca.error,!0)}})},initialize:function(){traderObj.initSliderTrader("#div_traderAuctioneer"),traderObj.planets=planetResources,traderObj.price=getValue($(".js_price").html()),$("#div_traderAuctioneer .right_box .pay").bind("click",(function(){traderObj.submitAuction()})),$("#div_traderAuctioneer .auction_history .more").bind("click",(function(){auctioneer.historyShown?$(this).text("["+loca.auctionShowMore+"]"):$(this).text("["+loca.auctionShowLess+"]"),auctioneer.historyShown=!auctioneer.historyShown,$("#div_traderAuctioneer .auction_history .more_auctions_li").slideToggle("slow")})),traderObj.sumAuctioneer(),traderObj.checkOverbidden(),this.initCountdown(),loadScript(nodeUrl,this.initConnection)},retryConnection:function(){var t=this;setTimeout((function(){t.initConnection()}),5e3)},setData:function(t){var e=!1;void 0!==t.player&&(null==t.player?($("#div_traderAuctioneer .detail_value.currentPlayer").text(""),$("#div_traderAuctioneer .detail_value.currentPlayer").attr("href","")):($("#div_traderAuctioneer .detail_value.currentPlayer").text(t.player.name),$("#div_traderAuctioneer .detail_value.currentPlayer").attr("href",t.player.link),$("#div_traderAuctioneer .detail_value.currentPlayer").attr("data-player-id",t.player.id),$("#div_traderAuctioneer .detail_value.currentPlayer").data("playerId",t.player.id)),e=!0),void 0!==t.price&&(traderObj.price=t.price,$("#div_traderAuctioneer .js_price").html(number_format(Math.floor(t.price),0)),e=!0),void 0!==t.sum&&($("#div_traderAuctioneer .detail_value.currentSum").html(number_format(Math.floor(t.sum),0)),e=!0),void 0!==t.bids&&($("#div_traderAuctioneer .detail_value.numberOfBids").html(number_format(t.bids,0)),e=!0),void 0!==t.info&&$.trim($("#div_traderAuctioneer .auction_info").html())!=t.info&&($("#div_traderAuctioneer .auction_info").html(t.info),this.initCountdown(),e=!0),e&&(this.flash(),traderObj.sumAuctioneer())},initCountdown:function(){"object"==typeof this.nextAuctionTimer&&timerHandler.removeCallback(this.nextAuctionTimer.timer),$(".nextAuction").length>0&&(this.nextAuctionTimer=new simpleCountdown($(".nextAuction").get(0),$(".nextAuction").text()))},flash:function(){"#div_traderAuctioneer"==traderObj.traderId&&$("#div_traderAuctioneer .overlay").fadeIn("normal",(function(){$(this).fadeOut("normal")}))},calculateDeficit:function(){var t=0;return t=0==Math.floor(traderObj.price)?0:auctionId!=AuctionIdOflastPlayerBid?Math.floor(traderObj.price):Math.floor(traderObj.price)-Math.floor(playerBid),Math.floor(t)}},$(".js_trader").hover((function(){var t=$(this).attr("id").replace("js_trader","").toLowerCase();$(this).addClass(t+"_link_hover")}),(function(){var t=$(this).attr("id").replace("js_trader","").toLowerCase();$(".trader_link").each((function(e,i){$(this).removeClass(t+"_link_hover")}))})),$(".right_box .pay, .value-control, .ui-slider-handle, .bargain, .scrap_it, .source").hover((function(){$(this).addClass("hover")}),(function(){$(this).removeClass("hover")})),traderObj.init(),$(document).undelegate(".js_trader","click").delegate(".js_trader","click",(function(){var t=$(this).attr("id").replace("js_","");traderObj.switchTrader(t)})).undelegate("#planet .js_backToOverview","click").delegate("#planet .js_backToOverview","click",(function(){$.bbq.pushState({page:"",animation:""}),$(".planetlink, .moonlink").fragment({page:"",animation:""})})),void 0!==(e=$.deparam.fragment()).page&&""!=e.page&&traderObj.selectTrader(e.page,void 0,e.tab)}!function(t){function e(t){return t*Math.PI/180}function i(t){this.element=t}function n(e,i){e&&(this.element=e,l.remove(e),l.removeDetached(),this._position=0,this._state="stopped",this.setOptions(t.extend({color:"#000",dashes:12,radius:5,height:5,width:1.8,opacity:1,padding:3,rotation:700},i||{})),this.drawPosition(0),l.add(this))}var a,s={scroll:function(t,e){if(!e)return t;var i=t.slice(0,e);return t.slice(e,t.length).concat(i)},isElement:function(t){return t&&1==t.nodeType},element:{isAttached:function(t){for(;t&&t.parentNode;)t=t.parentNode;return!!t&&!!t.body}}},o=function(i,n){var a=(l=t.extend({top:0,left:0,width:0,height:0,radius:0},n||{})).left,s=l.top,o=l.width,r=l.height,l=l.radius;i.beginPath(),i.moveTo(a+l,s),i.arc(a+o-l,s+l,l,e(-90),e(0),!1),i.arc(a+o-l,s+r-l,l,e(0),e(90),!1),i.arc(a+l,s+r-l,l,e(90),e(180),!1),i.arc(a+l,s+l,l,e(-180),e(-90),!1),i.closePath(),i.fill()},r=function(){function t(t){var i=[];if(0==t.indexOf("#")&&(t=t.substring(1)),""!=(t=t.toLowerCase()).replace(e,""))return null;for(3==t.length?(i[0]=t.charAt(0)+t.charAt(0),i[1]=t.charAt(1)+t.charAt(1),i[2]=t.charAt(2)+t.charAt(2)):(i[0]=t.substring(0,2),i[1]=t.substring(2,4),i[2]=t.substring(4)),t=0;t<i.length;t++)i[t]=parseInt(i[t],16);return i.red=i[0],i.green=i[1],i.blue=i[2],i}var e=RegExp("[0123456789abcdef]","g");return{hex2rgb:t,hex2fill:function(e,i){void 0===i&&(i=1);var n=i,a=t(e);return a[3]=n,a.opacity=n,"rgba("+a.join()+")"},rgb2hex:function(){function t(t,e,i){return t=t.toString(i||10),Array(e-t.length).join("0")+t}return function(e,i,n){return"#"+t(e,2,16)+t(i,2,16)+t(n,2,16)}}()}}();t.extend(Spinners,{enabled:!1,support:{canvas:(a=t("<canvas>")[0],!!a.getContext&&!!a.getContext("2d"))},init:function(){(this.support.canvas||window.G_vmlCanvasManager&&window.attachEvent&&-1===navigator.userAgent.indexOf("Opera"))&&(window.G_vmlCanvasManager&&window.G_vmlCanvasManager.init_(document),this.enabled=!0)},create:function(t,e){return i.create(t,e),this.get(t)},get:function(t){return new i(t)},play:function(t){return this.get(t).play(),this},pause:function(t){return this.get(t).pause(),this},toggle:function(t){return this.get(t).toggle(),this},stop:function(t){return this.get(t).stop(),this},remove:function(t){return this.get(t).remove(),this},removeDetached:function(){return l.removeDetached(),this},center:function(t){return this.get(t).center(),this},setOptions:function(t,e){return this.get(t).setOptions(e),this},getDimensions:function(t){return{width:t=2*l.get(t)[0].getLayout().workspace.radius,height:t}}});var l={spinners:[],get:function(e){if(e){var i=[];return t.each(this.spinners,(function(n,a){a&&(s.isElement(e)?a.element==e:t(a.element).is(e))&&i.push(a)})),i}},add:function(t){this.spinners.push(t)},remove:function(e){t(t.map(this.spinners,(function(i){if(s.isElement(e)?i.element==e:t(i.element).is(e))return i.element}))).each(t.proxy((function(t,e){this.removeByElement(e)}),this))},removeByElement:function(e){var i=this.get(e)[0];i&&(i.remove(),this.spinners=t.grep(this.spinners,(function(t){return t.element!=e})))},removeDetached:function(){t.each(this.spinners,t.proxy((function(t,e){e&&e.element&&!s.element.isAttached(e.element)&&this.remove(e.element)}),this))}};t.extend(i,{create:function(e,i){if(e){var a=i||{},o=[];return s.isElement(e)?o.push(new n(e,a)):t(e).each((function(t,e){o.push(new n(e,a))})),o}}}),t.extend(i.prototype,{items:function(){return l.get(this.element)},play:function(){return t.each(this.items(),(function(t,e){e.play()})),this},stop:function(){return t.each(this.items(),(function(t,e){e.stop()})),this},pause:function(){return t.each(this.items(),(function(t,e){e.pause()})),this},toggle:function(){return t.each(this.items(),(function(t,e){e.toggle()})),this},center:function(){return t.each(this.items(),(function(t,e){e.center()})),this},setOptions:function(e){return t.each(this.items(),(function(t,i){i.setOptions(e)})),this},remove:function(){return l.remove(this.element),this}}),t.extend(n.prototype,{setOptions:function(e){this.options=t.extend({},this.options,e||{}),this.options.radii&&(e=this.options.radii,this.options.radius=Math.min(e[0],e[1]),this.options.height=Math.max(e[0],e[1])-this.options.radius),this.options.dashWidth&&(this.options.width=this.options.dashWidth),this.options.speed&&(this.options.duration=1e3*this.options.speed);e=this._state;var i=this._position;switch(this._layout=null,this.build(),i&&i>=this.options.dashes-1&&(this._position=this.options.dashes-1),e){case"playing":this.play();break;case"paused":case"stopped":this.drawPosition(this._position)}this._centered&&this.center()},remove:function(){this.canvas&&(this.pause(),t(this.canvas).remove(),this.ctx=this.canvas=null)},build:function(){this.remove();var e=this.getLayout().workspace.radius;return t(document.body).append(this.canvas=t("<canvas>").attr({width:2*e,height:2*e}).css({zoom:1})),window.G_vmlCanvasManager&&G_vmlCanvasManager.initElement(this.canvas[0]),this.ctx=this.canvas[0].getContext("2d"),this.ctx.globalAlpha=this.options.opacity,t(this.element).append(this.canvas),this.ctx.translate(e,e),this},drawPosition:function(t){var i=this.getLayout().workspace,n=(t=s.scroll(i.opacities,-1*t),i.radius),a=e(360/(i=this.options.dashes));for(this.ctx.clearRect(-1*n,-1*n,2*n,2*n),n=0;n<i;n++)this.drawDash(t[n],this.options.color),this.ctx.rotate(a)},drawDash:function(t,e){this.ctx.fillStyle=r.hex2fill(e,t);var i=(a=this.getLayout()).workspace.radius,n=a.dash.position,a=a.dash.dimensions;o(this.ctx,{top:n.top-i,left:n.left-i,width:a.width,height:a.height,radius:Math.min(a.height,a.width)/2})},_nextPosition:function(){var e=this.options.rotation/this.options.dashes;this.nextPosition(),this._playTimer=window.setTimeout(t.proxy(this._nextPosition,this),e)},nextPosition:function(){this._position==this.options.dashes-1&&(this._position=-1),this._position++,this.drawPosition(this._position)},play:function(){if("playing"!=this._state){this._state="playing";var e=this.options.rotation/this.options.dashes;return this._playTimer=window.setTimeout(t.proxy(this._nextPosition,this),e),this}},pause:function(){if("paused"!=this._state)return this._pause(),this._state="paused",this},_pause:function(){this._playTimer&&(window.clearTimeout(this._playTimer),this._playTimer=null)},stop:function(){if("stopped"!=this._state)return this._pause(),this._position=0,this.drawPosition(0),this._state="stopped",this},toggle:function(){return this["playing"==this._state?"pause":"play"](),this},getLayout:function(){if(this._layout)return this._layout;for(var t=(s=this.options).dashes,e=s.width,i=s.radius,n=s.radius+s.height,a=Math.max(e,n),s=(a=Math.ceil(Math.max(a,Math.sqrt(n*n+e/2*(e/2)))),a+=s.padding),o=1/t,r=[],l=0;l<t;l++)r.push((l+1)*o);return this._layout={workspace:{radius:s,opacities:r},dash:{position:{top:a-n,left:a-e/2},dimensions:{width:e,height:n-i}}}},center:function(){var e=2*this.getLayout().workspace.radius;t(this.element.parentNode).css({position:"relative"}),t(this.element).css({position:"absolute",height:e+"px",width:e+"px",top:"50%",left:"50%",marginLeft:-.5*e+"px",marginTop:-.5*e+"px"}),this._centered=!0}}),Spinners.init(),Spinners.enabled||(i.create=function(){return[]})}(jQuery),ogame.messagecounter={countData:{chat:0,messages:0,buddy:0},newChats:Array(),type_chat:10,type_message:11,type_buddy:12,currentLinkSelector:null,currentType:0,currentPlayer:null,sumNewChatMessages:0,initialize:function(t,e){var i=ogame.messagecounter;if(void 0===e&&t!==i.type_chat&&(i.currentPlayer=0),void 0===e&&t==i.type_chat)return!1;switch(void 0!==e&&(i.currentPlayer=e),i.currentType=t,t){case i.type_chat:i.currentLinkSelector=$("a.comm_menu.chat");break;case i.type_message:i.currentLinkSelector=$("a.comm_menu.messages");break;case i.type_buddy:i.currentLinkSelector=$("a.comm_menu.buddies");break;default:return!1}i.update()},initChatCounter:function(t){var e=ogame.messagecounter;e.currentLinkSelector=$("a.comm_menu.chat"),e.currentType=e.type_chat,e.setCount(t),e.update()},update:function(t){var e,i=ogame.messagecounter;e=void 0===t?chatLoca.X_NEW_CHATS:t,changeTooltip(i.currentLinkSelector,e.replace("#+#",i.getCount()))},resetCounterByType:function(t,e){var i,n=ogame.messagecounter.getIconSelectorByType(t);i=void 0===e?chatLoca.X_NEW_CHATS:e,changeTooltip(n,i.replace("#+#",0))},getCountSelectorByType:function(t){var e=ogame.messagecounter,i="";switch(t){case e.type_chat:i=$("a.comm_menu.chat .new_msg_count");break;case e.type_message:i=$("a.comm_menu.messages .new_msg_count");break;case e.type_buddy:i=$("a.comm_menu.buddies .new_msg_count")}return i},getIconSelectorByType:function(t){var e=ogame.messagecounter,i="";switch(t){case e.type_chat:i=$("a.comm_menu.chat");break;case e.type_message:i=$("a.comm_menu.messages");break;case e.type_buddy:i=$("a.comm_menu.buddies")}return i},getCounterHtml:function(t){return'<span class="new_msg_count">'+t+"</span>"},getCount:function(){var t=ogame.messagecounter;switch(t.currentType){case t.type_chat:return t.countData.chat;case t.type_message:return t.countData.messages;case t.type_buddy:return t.countData.buddy}},setCount:function(t){var e=ogame.messagecounter;switch(e.currentType){case e.type_chat:e.countData.chat=t;break;case e.type_message:e.countData.messages=t;break;case e.type_buddy:e.countData.buddy=t}},updateCountData:function(){var t=ogame.messagecounter;if(t.isOpen())t.setCount(0);else{if(t.shouldAddCounter())var e=1;else{e=t.getCountSelectorByType(t.currentType).html();e=parseInt(e)+1}t.setCount(e)}},shouldAddCounter:function(){var t=ogame.messagecounter,e=!1;return void 0===t.getCountSelectorByType(t.currentType).html()&&(e=!0),e},setNewCounter:function(t,e){t.html(e)},isOpen:function(){var t=ogame.messagecounter,e=!1;switch(t.currentType){case t.type_chat:e=ogame.chat.isOpen(t.currentPlayer);break;case t.type_message:e=location.href.indexOf("page=messages")>-1;break;case t.type_buddy:e=location.href.indexOf("page=buddies")>-1}return e}},ogame.messagemarker={type_chatbar:10,type_chattab:11,action_remove:20,action_add:21,currentCount:"",currentSelector:"",currentPlayernameObject:"",currentListPlayernameObject:"",currentPartnerId:"",currentListItemSelector:"",totalNewMessages:0,playerlist:new Array,newsInitialized:!1,effect:"none",initialize:function(){$(".new_msg_count[data-playerid]").each((function(){var t=ogame.messagemarker,e=$(this).data("playerid");e&&-1===$.inArray(e,t.playerlist)&&(t.playerlist.push(e),t.setPartnerId(e),t.updateNewMarker())})),ogame.messagemarker.effect="highlight"},initMarker:function(t){var e=ogame.messagemarker,i=0;return $.each(t,(function(t,n){e.setPartnerId(n);var a=$('.new_msg_count[data-playerid="'+n+'"]').data("new-messages");null!=a&&a>0&&(e.setSelectorByType(e.type_chatbar),e.mark(e.currentSelector,e.currentPlayernameObject,a),e.mark(e.currentListItemSelector,e.currentListPlayernameObject,a),e.setSelectorByType(e.type_chattab),e.mark(e.currentSelector,e.currentPlayernameObject,a)),i+=1})),i},setCounter:function(t,e){this.setPartnerId(t),$('.new_msg_count[data-playerid="'+this.currentPartnerId+'"]').data("new-messages",e),this.updateNewMarker()},toggle:function(t,e,i,n){this.setPartnerId(i),this.currentCount=parseInt($('.new_msg_count[data-playerid="'+this.currentPartnerId+'"]').data("new-messages")),t===this.action_add&&this.updateNewMarker(),t===this.action_remove&&this.removeNewMarker()},mark:function(t,e,i){$('.playerlist_item[data-playerid="'+this.currentPartnerId+'"] .playername').css("font-weight","bold"),$('.cb_playername[data-playerid="'+this.currentPartnerId+'"]').css("font-weight","bold")},addNewMarker:function(){var t=!1;$(this.currentSelector).find(".newMsgMarker").length||(this.mark(this.currentSelector,this.currentPlayernameObject,this.currentCount),t=!0),$(this.currentListItemSelector).find(".newMsgMarker").length||(this.mark(this.currentListItemSelector,this.currentListPlayernameObject,this.currentCount),t=!0),t||this.updateNewMarker()},removeNewMarker:function(){$('.playerlist_item[data-playerid="'+this.currentPartnerId+'"] .playername').css("font-weight","normal"),$('.cb_playername[data-playerid="'+this.currentPartnerId+'"]').css("font-weight","normal")},updateNewMarker:function(){var t=parseInt($('.new_msg_count[data-playerid="'+this.currentPartnerId+'"]').data("new-messages")),e=$(".new_msg_count.totalChatMessages").text(),i=ogame.chat.updateTotalNewChatCounter();0===t?isNaN(this.currentPartnerId)?$(".new_msg_count.totalMessages.news").text(t).addClass("noMessage"):($('.new_msg_count[data-playerid="'+this.currentPartnerId+'"]').text(t).addClass("noMessage"),0===i?$(".new_msg_count.totalChatMessages").text(i).addClass("noMessage"):e!=i&&$(".new_msg_count.totalChatMessages").text(i).removeClass("noMessage").effect(ogame.messagemarker.effect,{},500)):isNaN(this.currentPartnerId)?isNaN(t)?$(".new_msg_count.totalMessages.news").text(0).addClass("noMessage"):$(".new_msg_count.totalMessages.news").text(t).removeClass("noMessage").effect(ogame.messagemarker.effect,{},500):($('.msg[data-playerid="'+this.currentPartnerId+'"]').addClass("msg_new"),$('.new_msg_count[data-playerid="'+this.currentPartnerId+'"]').text(t).removeClass("noMessage").effect(ogame.messagemarker.effect,{},500),e!=i&&$(".new_msg_count.totalChatMessages").text(i).removeClass("noMessage").effect(ogame.messagemarker.effect,{},500))},setSelectorByType:function(t){selector="",t==this.type_chatbar&&(selector='ul.chat_bar_list li.chat_bar_list_item[data-playerid="'+this.currentPartnerId+'"]'),t==this.type_chattab&&(selector='ul#chatMsgList li.msg[data-playerid="'+this.currentPartnerId+'"]'),this.currentListItemSelector='.js_playerlist ul.playerlist li.playerlist_item[data-playerid="'+this.currentPartnerId+'"]',this.currentSelector=selector,this.currentPlayernameObject=$(selector).find(".cb_playername"),this.currentListPlayernameObject=$(this.currentListItemSelector).find(".playername")},setPartnerId:function(t){this.currentPartnerId=t}},ogame.messages={data:{initActions:{"tabs-nfFleets":"initTabFleets","tabs-nfCommunication":"initTabCommunication","subtabs-nfCommunicationMessages":"initSubTabMessages"}},addMessage:function(t,e,i){if(!1!==i&&(i=!0),"true"===t.attr("aria-selected"))if(e){var n=$("#"+t.attr("aria-controls")).find(".tab_inner"),a=!1;i&&(a=!0),ogame.messages.createMessageItem(e,n,a)}else console.warn("addMessage: msgData is ",e);else console.warn("addMessage: not correct Tab, aria-selected = ",t.attr("aria-selected"),t)},createMessageItem:function(t,e,i){var n={};for(var a in t){var s=t[a];n[a]=s.msgID}var o=JSON.stringify(n);$.ajax({url:"?page=messages",type:"POST",dataType:"html",data:{messageId:o,tabid:this.getCurrentMessageTab(),action:121,ajax:1},success:function(t){if(i)e.prepend(t);else{var n=e.find(".favoriteCount");n.length>0?$(t).insertBefore(n):e.append(t)}},error:function(t,e,i){}})},createBroadcastMsgItem:function(t){if(t){var e=$('<div class="msg_head"></div>');e.append('<span class="msg_title blue_txt">'+t.title+"</span>"),e.append('<span class="msg_date fright">'+t.date+"</span><br>"),e.append('<span class="msg_sender_label">'+loca.LOCA_WRITE_MSG_FROM+": </span>"),e.append('<span class="msg_sender">'+t.senderName+"</span>");var i=$('<div class="msg_actions clearfix"></div>');i.append('<a class="fright txt_link overlay" href="'+t.detailURL+'" data-overlay-title="'+loca.broadcasts+'">'+loca.details+"</a>"),i.append('<a class="fright txt_link comments_link overlay" href="'+t.commentsURL+'" data-overlay-title="'+loca.broadcasts+'">'+t.commentsCount+' <span class="comments"></span></a></a>');var n=$('<li class="msg '+t.newClass+'" data-msg-id="'+t.msgID+'"></li>');return n.append('<div class="msg_status"></div>'),n.append(e),n.append('<span class="msg_content">'+t.msgContent+"</span>"),n.append(i),n}console.warn("createMessageItem: msgData is missing!")},createRecipient:function(t,e,i){var n;($(".input_replacement").each((function(){new RegExp($(this).data("recipient-cat")).test(e)&&(n=$(this))})),void 0!==n)&&(0===n.children(".recipient_txt").filter((function(){return $(this).data("recipient-id")===t})).length&&(n.hasClass("focus")||n.addClass("focus"),n.append('<div class="recipient_txt" data-recipient-id="'+t+'" data-recipient-cat="'+e+'">'+i+'<a role="button" class="remove_recipient"></a></div>')))},doInitAction:function(t){return"function"==typeof ogame.messages[ogame.messages.data.initActions[t]]?ogame.messages[ogame.messages.data.initActions[t]]():console.warn("These is no function defined for action: ",t)},initCombatReportDetails:function(){$("select").length>0&&$("select").ogameDropDown()},initDetailMessages:function(t){$(".detail_list_el:nth-of-type(4n + 3), .detail_list_el:nth-of-type(4n + 4)").addClass("odd");var e=$(window).height()-200;$(".detail_msg_ctn").css("height",e),$(".detail_msg_ctn").mCustomScrollbar({theme:"ogame"}),t&&($("#scrollToComments").on("click",(function(){$(".detail_msg_ctn").mCustomScrollbar("scrollTo","bottom")})),initBBCodeEditor(locaKeys,itemNames,!1,".comment_textarea",2e3)),$("#messages ul.pagination").on("click","li.p_li a",(function(){var t=$(this).data("tabid"),e=$(this).data("messageid");console.log("initDetailMessages()"),$.post("?page=messages",{tabid:t,messageId:e,ajax:1},(function(t){$(t).find("#messages .ui-dialog");$(".overlayDiv").html(t)}))}))},initMessages:function(){$(".js_tabs .tabs_btn_img").each((function(){$(this).attr("rel")&&$(this).attr("href",$(this).attr("rel"))})),ogame.messages.initTabs($(".js_tabs"));var t=ogame.messages.getCurrentMessageTab();$("#contentWrapper #buttonz div.js_tabs.tabs_wrap.ui-tabs").on("click","ul li.list_item",(function(){ogame.messages.getCurrentMessageTab()})),$("body").on("click",".msg_actions .icon_not_favorited",(function(e){var i=$(this).parents("li.msg").data("msg-id")||$(this).parents("div.detail_msg").data("msg-id");$.ajax({type:"POST",url:"?page=messages",dataType:"json",data:{tabid:t,messageId:i,action:101,ajax:1},success:function(t){if(1==t[i].result){$(e.target).removeClass("icon_not_favorited").addClass("icon_favorited"),changeTooltip($(e.target),loca.DELETE_FAV);var n=$(".favoriteTabFreeSlotCount");n.html(parseInt(n.html())-1)}else"undefined"!==t[i].reason?fadeBox(t[i].reason,1):fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)},error:function(){}})})).on("click",".msg_actions .icon_favorited",(function(e){var i=$(this).parents("li.msg").data("msg-id")||$(this).parents("div.detail_msg").data("msg-id");$.ajax({type:"POST",url:"?page=messages",dataType:"json",data:{tabid:t,messageId:i,action:102,ajax:1},success:function(t){if(1==t[i].result){$(e.target).removeClass("icon_favorited").addClass("icon_not_favorited"),changeTooltip($(e.target),loca.ADD_FAV);var n=$(".favoriteTabFreeSlotCount");n.html(parseInt(n.html())+1)}else"undefined"!==t[i].reason?fadeBox(t[i].reason,1):fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)},error:function(){}})})).on("click",".js_actionKill",(function(t){var e=$(this).parents("li.msg").data("msg-id");console.log(e),console.log("this is the message id"),$.ajax({type:"POST",url:"",dataType:"json",data:{messageId:e,action:103,ajax:1},success:function(i){1==i[e]?$(t.target).parents("li.msg").remove():fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)},error:function(){}})})).on("click",".js_actionKillAll",(function(t){console.log(ogame.messages.getCurrentMessageTab())})).on("click",".js_actionKillDetail",(function(t){var e=$(".overlayDiv .detail_msg").data("msg-id");$.ajax({type:"POST",url:"?page=messages",dataType:"json",data:{messageId:e,action:103,ajax:1},success:function(t){1==t[e]?location.reload():fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)},error:function(){}})})).on("click",".js_actionRevive",(function(e){var i=$(this).parents("li.msg").data("msg-id");void 0===i&&(i=$(this).parents("div.detail_msg").data("msg-id")),$.ajax({type:"POST",url:"?page=messages",dataType:"json",data:{tabid:t,messageId:i,action:104,ajax:1},success:function(t){1==t[i]?($(e.target).parents("li.msg").remove(),$(e.target).parents("div.ui-dialog").remove(),$("li.msg[data-msg-id="+i+"]").remove()):fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)},error:function(){}})})).on("click",".js_actionReviveAll",(function(t){$.ajax({type:"POST",url:"?page=messages",dataType:"json",data:{tabid:ogame.messages.getCurrentMessageTab(),messageId:-1,action:104,ajax:1},success:function(t){1==t.result?location.reload():fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)},error:function(){}})})).on("click",".js_actionDelete",(function(e){var i=$(this).parents("li.msg").data("msg-id");$.ajax({type:"POST",url:"?page=messages",dataType:"json",data:{tabid:t,messageId:i,action:105,ajax:1},success:function(t){1==t[i]?$(e.target).parents("li.msg").remove():fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)},error:function(){}})})).on("click",".js_actionDeleteAll",(function(t){$(this).parents("li.msg").data("msg-id");$.ajax({type:"POST",url:"?page=messages",dataType:"json",data:{tabid:ogame.messages.getCurrentMessageTab(),messageId:-1,action:105,ajax:1},success:function(t){1==t.result?location.reload():fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)},error:function(){}})})).on("click",".paginator",(function(t){var e=$(this).data("tab"),i=$(this).data("page"),n=$(this).closest('div[class^="ui-tabs-panel"]');$.ajax({type:"POST",url:"?page=messages",dataType:"html",data:{messageId:-1,tabid:e,action:107,pagination:i,ajax:1},success:function(t){n.html(t)},error:function(){}})})).on("click",".jumpToAllianceApplications",(function(t){location.href="index.php?page=alliance&tab=applications"}))},selectCurrentMessageTab:function(){var t=$(".subtabs .ui-state-active:visible");return t.length||(t=$(".js_tabs .ui-state-active:visible")),t},getCurrentMessageTab:function(){var t=$(".subtabs .ui-state-active:visible").attr("data-tabid");return t||(t=$(".js_tabs .ui-state-active:visible").attr("data-tabid")),t},getCurrentEarliestMessage:function(){return $(".ui-tabs-panel .tab_inner .msg:visible").last().attr("data-msg-id")},initCommentForm:function(){ogame.messages.initWriteNewMsgBox($("#newCommentForm")),$("#newCommentForm").on("click",".js_send_comment",(function(t){t.preventDefault();var e=$(this).closest("form"),i=e.find("input[name=messageId]").val();$.ajax({type:"POST",url:e.attr("action"),dataType:"json",data:{messageId:i,ajax:1,action:108,text:e.find("textarea[name=text]").val()},success:function(t){fadeBox(t.message,t.error),e.find("textarea[name=text]").val(""),e.parent().after('<li class="msg"><div class="msg_status"></div><div class="msg_head">'+t.commentheader+'</div><div class="msg_content">'+t.commentcontent+"</div></li>"),$("#scrollToComments").text(t.commentcount)},error:function(t){}})}))},initShareReportOverlay:function(){ogame.messages.initWriteNewMsgBox($("#newSharedReportForm")),$("#newSharedReportForm").on("click",".js_send_msg_share",(function(t){t.preventDefault();var e=$(this).closest("form"),i=e.find("input[name=messageId]").val(),n=e.find("li.select2-selection__choice"),a=[];n.each((function(){a.push($(this).attr("title"))})),$.ajax({type:"POST",url:e.attr("action"),dataType:"json",data:{messageId:i,empfaenger:a,ajax:1,action:106,text:e.find("textarea[name=text]").val()},success:function(t){fadeBox(t.message,t.error),e.closest('div[class^="overlayDiv"').remove()},error:function(t){}})}))},initSubTabMessages:function(){$(".js_accordion").accordion({collapsible:!0,heightStyle:"content",active:!1}),ogame.messages.initWriteNewMsgBox($("#newMsgForm")),$("html").off(".subtabmessages"),$("#newMsgForm").on("click.subtabmessages",".js_send_msg",(function(t){t.preventDefault();var e=$(this).parents("form"),i={};$(".input_replacement").children().each((function(){void 0===i[$(this).data("recipient-cat")]&&(i[$(this).data("recipient-cat")]=[]),i[$(this).data("recipient-cat")].push($(this).data("recipient-id"))})),$.ajax({type:"POST",url:e.attr("action"),dataType:"json",data:{empfaenger:i,text:e.find(".new_msg_textarea").val()},success:function(t){fadeBox(t.message,t.error),t.error||ogame.messages.sendSubtabMsg($(".new_msg_textarea").val(),i)},error:function(){}})}))},initTabCommunication:function(){console.info("-------------initTabCommunication"),ogame.messages.initTabs($(".js_subtabs_communication"))},initTabFleets:function(){console.info("-------------initTabFleets"),ogame.messages.initTabs($(".js_subtabs_fleets"),ogame.messages.initTrash)},initTabs:function(t,e){t.tabs({beforeLoad:function(){$(".ajax_load_shadow").show()},load:function(t,i){console.info("load",i.tab.attr("id")),ogame.messages.doInitAction(i.tab.attr("id")),$(".ajax_load_shadow").hide(),"function"==typeof e&&e(i.tab)},create:function(t,e){ogame.messages.doInitAction(e.tab.attr("id"))}})},initTrash:function(t){t&&($(".js_active_tab").html(t.data("subtabname")),"subtabs-nfFleetTrash"===t.attr("id")?($(".trash_box").addClass("trash_open"),$(".in_trash").show(),$(".not_in_trash").hide()):($(".trash_box").removeClass("trash_open"),$(".in_trash").hide(),$(".not_in_trash").show()))},initWriteNewMsgBox:function(t){initBBCodeEditor(locaKeys,itemNames,!1,".new_msg_textarea",2e3),$("html").off(".writeNewMsgBox"),$("html").on("click.writeNewMsgBox",(function(t){$(".new_msg_label").hasClass("open")&&$(t.target).parents(".recipient_select_box").length<1&&($(".input_replacement").removeClass("focus"),$(".new_msg_label").removeClass("open"),$(".new_msg_label").siblings(".recipient_select_box").hide())})),t.on("click.writeNewMsgBox",".input_replacement",(function(t){t.stopPropagation(),ogame.messages.toggleRecipientSelectBox($(t.target).data("recipient-cat"))})).on("click.writeNewMsgBox",".new_msg_label",(function(t){t.stopPropagation(),ogame.messages.toggleRecipientSelectBox($(t.currentTarget).data("recipient-cat"))})).on("click.writeNewMsgBox",".recipient_select_box .ally_rank",(function(){ogame.messages.toggleRecipientSelection($(this))})).on("click.writeNewMsgBox",".remove_recipient",(function(){ogame.messages.removeRecipient($(this).closest(".recipient_txt").data("recipient-id"))}))},removeRecipient:function(t){$(".ally_rank").filter((function(){$(this).data("recipient-id")===t&&$(this).removeClass("selected")})),$(".recipient_txt").filter((function(){$(this).data("recipient-id")===t&&$(this).remove()}))},sendSubtabMsg:function(t,e){if(t)if(e){var i={};i.date=getFormatedDate(serverTime.getTime(),"[d].[m].[Y] <span>[H]:[i]:[s]</span>"),i.newClass="msg_new",i.title=e,i.senderName="100011",i.msgID="111",i.msgContent=t,i.commentsURL="",i.detailURL="",i.commentsCount=0;var n=array(i);ogame.messages.addMessage($("#subtabs-nfCommunicationMessages"),n)}else console.warn("sendSubtabMsg: msg had no recipients");else console.warn("sendSubtabMsg: msg was empty")},toggleRecipientSelectBox:function(t){$(".input_replacement").filter((function(){$(this).data("recipient-cat")!==t||$(this).hasClass("focus")||$(this).addClass("focus")})),$(".new_msg_label").filter((function(){var e=$(this);if(e.data("recipient-cat")===t)if(e.hasClass("open"))e.removeClass("open").siblings(".recipient_select_box").hide();else{var i=e.siblings(".recipient_select_box"),n=i.find(".scroll_box");$(".new_msg_label").removeClass("open").siblings(".recipient_select_box").hide(),e.addClass("open"),i.show(),n.hasClass("mCustomScrollbar")?n.mCustomScrollbar("update"):n.mCustomScrollbar()}}))},toggleRecipientSelection:function(t){var e=t.data("recipient-cat"),i=t.data("recipient-id");t.hasClass("always_selected")||(t.hasClass("complete_ally")?ogame.messages.toggleSelectAllRecipients(e):t.hasClass("selected")?ogame.messages.removeRecipient(i):(ogame.messages.createRecipient(i,e,t.html()),t.addClass("selected")))},toggleSelectAllRecipients:function(t){var e=$(".complete_ally").hasClass("selected"),i=e?"255":"1",n=e?"loca.founder":"loca.completeAlliance";$(".input_replacement").children().remove(),ogame.messages.createRecipient(i,t,n),$(".recipient_list").filter((function(){$(this).data("recipient-cat")===t&&$(this).find(".ally_rank").each((function(){$(this).hasClass("always_selected")||(e?$(this).removeClass("selected"):$(this).addClass("selected"))}))}))}},ogame.messages.combatreport={data:[{combatReportId:$(".detailReport").attr("data-combatreportid")}],loca:[{weapon:"",shield:"",cover:""}],getCombatValueByCombatMember:function(){var t=ogame.messages.combatreport,e=t.data.activeMember,i={armorPercentage:0,weaponPercentage:0,shieldPercentage:0},n=0;return $.each(t.data.combatArray,(function(a,s){t.check(!0,e,{values:{is:{0:"all"}}})?(i.armorPercentage+=s.armorPercentage,i.weaponPercentage+=s.weaponPercentage,i.shieldPercentage+=s.shieldPercentage,n++):s.ownerName==e&&(i.armorPercentage=s.armorPercentage,i.weaponPercentage=s.weaponPercentage,i.shieldPercentage=s.shieldPercentage,n=1)})),i.armorPercentage=Math.round(i.armorPercentage/n),i.weaponPercentage=Math.round(i.weaponPercentage/n),i.shieldPercentage=Math.round(i.shieldPercentage/n),i},setCombatValue:function(){var t=ogame.messages.combatreport,e=t.getCombatValueByCombatMember();$("."+t.data.combatside+"Weapon").text(t.loca.weapon+" "+e.weaponPercentage+"%"),$("."+t.data.combatside+"Shield").text(t.loca.shield+" "+e.shieldPercentage+"%"),$("."+t.data.combatside+"Cover").text(t.loca.cover+" "+e.armorPercentage+"%")},setCombatLoca:function(t,e,i){var n=ogame.messages.combatreport;n.loca.weapon=t,n.loca.shield=e,n.loca.cover=i},isActive:function(t,e){var i=ogame.messages.combatreport;for(var n in e)if("length"!=n&&i.check(!0,e[n][t]))return"on";return i.check(!0,e[t])?"on":"off"},setActiveFlag4Fleet:function(t,e){var i=ogame.messages.combatreport,n=i.getAllShipClasses(t);$.each(n,(function(t,n){var a=i.getShipIdByClass(n),s=i.isActive(a,e),o=i.getShipSelectors(a);if(i.changeShipState(s,o.ship),"off"==s){var r=o.shipCount,l=o.loss,c={ships:{},losses:{}};c.ships[r]=0,c.losses[l]="",i.setShipCount(c)}i.toggleShipShowState(o.ship)}))},search4Class:function(t,e){for(var i in t){if($("."+t[i]+e)[0])return t[i]+e}return!1},getShipSelectors:function(t){var e=ogame.messages.combatreport,i=e.search4Class(["military","civil","defense"],t);return{ship:"."+e.data.combatside+" ."+i,shipCount:"."+e.data.combatside+" ."+i+" .ecke",loss:"."+e.data.combatside+" ."+i+" .lost_ships"}},getShipIdByClass:function(t){var e=t.length;return t.substr(e-3)},changeShipState:function(t,e){$(e).hasClass("off")&&"off"!=t&&$(e).removeClass("off"),$(e).hasClass("on")&&"on"!=t&&$(e).removeClass("on"),$(e).hasClass(t)||$(e).addClass(t)},toggleShipShowState:function(t){$(t).hasClass("off")&&$(t).parent().hide(),$(t).hasClass("on")&&$(t).parent().show()},getShipsByMembers:function(t){var e=ogame.messages.combatreport,i=[];return e.check(!0,e.data.combatArray.shipDetails)?void 0!==i[e.data.combatArray.ownerName]?$.extend(i[e.data.combatArray.ownerName],e.data.combatArray.shipDetails):i[e.data.combatArray.ownerName]=e.data.combatArray.shipDetails:$.each(e.data.combatArray,(function(t,e){"object"==typeof e&&void 0!==e.shipDetails?void 0!==i[e.ownerName]?$.extend(i[e.ownerName],e.shipDetails):i[e.ownerName]=e.shipDetails:void 0===i[e.ownerName]&&(i[e.ownerName]={})})),"all"==t?i:i[t]},getShipsByMembersAndCoords:function(t,e,i){var n=ogame.messages.combatreport,a=[];return n.check(!0,n.data.combatArray.shipDetails)?void 0!==a[n.data.combatArray.ownerName]?$.extend(a[n.data.combatArray.ownerName],n.data.combatArray.shipDetails):a[n.data.combatArray.ownerName]=n.data.combatArray.shipDetails:$.each(n.data.combatArray,(function(n,s){0!==e?"object"==typeof s&&void 0!==s.shipDetails&&s.ownerCoordinates===e&&s.ownerName==t&&s.ownerPlanetType==i&&(void 0!==a[s.ownerName]?$.extend(a[s.ownerName],s.shipDetails):a[s.ownerName]=s.shipDetails):"object"==typeof s&&void 0!==s.shipDetails&&(void 0!==a[s.ownerName]?$.extend(a[s.ownerName],s.shipDetails):a[s.ownerName]=s.shipDetails)})),"all"==t?a:a[t]},getShipCountArray:function(t,e){var i=ogame.messages.combatreport,n=!i.check(!0,e,{types:{0:"isEmpty"}}),a={},s={};for(var o in t){var r=i.getShipSelectors(o);if(a[r.shipCount]=parseInt(t[o]),!n){var l=r.loss;i.check(!0,e[o])&&(s[l]=parseInt(e[o]))}}return{ships:a,losses:s}},setShipCount4All:function(t){var e=ogame.messages.combatreport,i=t.ships,n=e.check(!0,t.losses)?t.losses:{},a={};for(var s in i){var o=i[s],r=e.check(!0,n,{types:{0:"isEmpty"}})&&e.check(!0,n[s])?n[s]:{};a[s]=e.getShipCountArray(o,r)}var l={},c={};for(var d in a){var u=a[d].ships,h=a[d].losses;for(var p in u)e.check(!0,l[p])?l[p]=l[p]+u[p]:l[p]=u[p];for(var p in h)e.check(!0,c[p])?c[p]=c[p]+h[p]:c[p]=h[p]}var f={ships:l,losses:c};e.setShipCount(f)},setShipCountByActiveMember:function(t,e,i,n,a){n=n||0,a=a||1;var s=ogame.messages.combatreport,o={},r={};for(var l in e){var c=e[l].ownerName,d=e[l].ownerCoordinates,u=e[l].ownerPlanetType;if(c==i){for(var h in t.ships[l])0!==n?n==d&&a==u&&(o.hasOwnProperty(h)?o[h]=o[h]+t.ships[l][h]:o[h]=t.ships[l][h]):o.hasOwnProperty(h)?o[h]=o[h]+t.ships[l][h]:o[h]=t.ships[l][h];if(s.check(!0,t.losses))for(var h in t.losses[l])0!==n?n==d&&a==u&&(r.hasOwnProperty(h)?r[h]=r[h]+parseInt(t.losses[l][h]):r[h]=parseInt(t.losses[l][h])):r.hasOwnProperty(h)?r[h]=r[h]+parseInt(t.losses[l][h]):r[h]=parseInt(t.losses[l][h])}}if(s.check(!0,o,{types:{0:"isEmpty"}})){var p=s.getShipCountArray(o,r);s.setShipCount(p)}},setShipCount:function(t){var e=ogame.messages.combatreport.data.combatside,i=t.ships,n=t.losses;if($.isEmptyObject(i))$("."+e+" .ecke").text("0");else for(var a in i)$(a).text(i[a].toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."));if($.isEmptyObject(n))$("."+e+" .lost_ships").text("-");else for(var a in n)$(a).text("-"+n[a].toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."))},getAllShipClasses:function(t){var e=t.map((function(){return $(this).attr("class")})).get().join(),i=[];return $.each(e.split(","),(function(t,e){var n=e.split(" ");i.push(n[1])})),i},displayShipData:function(t,e,i,n,a,s){a=void 0!==a?a:0;var o=ogame.messages.combatreport;o.check(!0,t,{values:{isNot:{0:"all"}}})?o.setShipCountByActiveMember(i,n,t,a,s):o.setShipCount4All(o.data.combatRounds[e][o.data.combatRounds[e].length-1])},initCombatText:function(t){var e=ogame.messages.combatreport,i=t.combatRounds.length-1;$(".combat_round_list .round_id").find("a").removeClass("active"),$(".combat_round_list .round_id[data-round="+i+"]").find("a").addClass("active"),e.loadDataBySelectedRound(t.attackerJSON,t.defenderJSON,i)},setCombatText:function(t,e,i){var n=".statistic_attacker",a=".statistic_defender",s=".hits",o=".strength",r=".absorbed",l=0,c=0,d=0,u=0,h=0,p=0;if(ogame.messages.combatreport.check(!0,t,{length:i}))for(var f in t)l+=parseInt(t[f].statistic.hits),c+=parseInt(t[f].statistic.absorbedDamage),d+=parseInt(t[f].statistic.fullStrength),u+=parseInt(e[f].statistic.hits),h+=parseInt(e[f].statistic.absorbedDamage),p+=parseInt(e[f].statistic.fullStrength);else l=parseInt(t[i].statistic.hits),c=parseInt(t[i].statistic.absorbedDamage),d=parseInt(t[i].statistic.fullStrength),u=parseInt(e[i].statistic.hits),h=parseInt(e[i].statistic.absorbedDamage),p=parseInt(e[i].statistic.fullStrength);$(n+s).text(l.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")),$(n+r).text(c.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")),$(n+o).text(d.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")),$(a+s).text(u.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")),$(a+r).text(h.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")),$(a+o).text(p.toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."))},setCombatArray:function(t,e){var i=jQuery.extend(!0,{},t),n=ogame.messages.combatreport;n.data.combatside=e,n.data.memberSelection=!1,$("#"+n.data.combatside+"_select_combatreport").find(":selected").length>0&&(n.data.memberSelection=!0),n.data.memberSelection?n.data.activeMember=""+$("#"+n.data.combatside+"_select_combatreport").find(":selected").val():n.data.activeMember=""+$("#"+n.data.combatside+"_select_combatreport").data("memberName"),n.data.activeMember=n.data.activeMember.split("|",1)[0],n.data.combatArray=i.member,n.data.combatRounds=[],n.data.combatRounds[e]=i.combatRounds},setCombatside:function(t){ogame.messages.combatreport.data.combatside=t},check:function(t,e,i){var n=!1,a=0,s=0,o=0,r=0,l=!1;if(0!=(i=null!=i&&void 0!==i&&"object"==typeof i&&i)){var c=null!=i.values&&void 0!==i.values&&"object"==typeof i.values?i.values:{},d=null!=i.types&&void 0!==i.types&&"object"==typeof i.types?i.types:{},u=null!=i.length&&void 0!==i.length&&i.length;if(!jQuery.isEmptyObject(c))for(m in c){var h=c[m];if("is"==m&&!jQuery.isEmptyObject(h))for(var p in h)e!=h[p]&&(a+=1);if("isNot"==m&&!jQuery.isEmptyObject(h))for(var f in h)e==h[f]&&(a+=1)}if(!jQuery.isEmptyObject(d))for(var m in d.isEmpty&&jQuery.isEmptyObject(e)&&(s+=1),d)typeof e==d[m]&&(s+=1);if("object"==typeof e)for(var m in e)void 0!==e[m]&&(r+=1);else r=(e+"").length;!1!==u&&"number"==typeof u&&"number"==typeof r&&(r!=u&&(o+=1),l=!0)}void 0!==e&&null!=e||(s+=1);var g=a+s;return 0!=l&&(g+=o),0==g&&(n=!0),t?n:{success:n,allErrors:g,valueErrors:a,typeErrors:s,type:typeof e,length:r,lengthChecked:l,lengthError:o}},loadData:function(t,e){var i=ogame.messages.combatreport;i.setCombatArray(t,e),i.loadDataBySelectedCombatMember(t,e),i.setCombatValue()},loadDataBySelectedRound:function(t,e,i){var n=ogame.messages.combatreport,a=parseInt(i),s=$(".attacker .participant_select option:selected").val(),o=$(".defender .participant_select option:selected").val(),r=$(".attacker .participant_select option:selected").data("coords"),l=$(".defender .participant_select option:selected").data("coords"),c=[],d=[];if(void 0!==r?(ids=s.split("|")[1].split(":"),c.push(ids),s=s.split("|")[0]):"all"!=s&&void 0!==s?(r=0,$(".attacker .participant_select option").each((function(){s==$(this).val().split("|")[0]&&void 0!==$(this).val().split("|")[1]&&c.push($(this).val().split("|")[1].split(":"))}))):c=[],void 0!==l?(ids=o.split("|")[1].split(":"),d.push(ids),o=o.split("|")[0]):"all"!=o&&void 0!==o?(l=0,$(".defender .participant_select option").each((function(){o==$(this).val().split("|")[0]&&void 0!==$(this).val().split("|")[1]&&d.push($(this).val().split("|")[1].split(":"))}))):d=[],c.length>0)for(var u in t)if("combatRounds"==u)for(var h in t[u][a])if("ships"==h)for(var p in t[u][a][h]){-1==$.inArray(p,c[0])&&delete t[u][a][h][p]}if(d.length>0)for(var u in e)if("combatRounds"==u)for(var h in e[u][a])if("ships"==h)for(var p in e[u][a][h]){-1==$.inArray(p,d[0])&&delete e[u][a][h][p]}var f=t.combatRounds,m=e.combatRounds;n.check(!0,f,{length:i})&&(a-=1),a+="",n.setCombatside("attacker"),n.setShipCount4All(f[a]),n.setCombatside("defender"),n.setShipCount4All(m[a]),n.data.memberSelection,n.setCombatText(f,m,i)},resetDropDowns:function(){$("#attacker_select_combatreport").val("all").ogameDropDown("refresh"),$("#defender_select_combatreport").val("all").ogameDropDown("refresh")},loadDataBySelectedCombatMember:function(t,e,i,n){var a=jQuery.extend(!0,{},t);i=i||0,n=n||1;var s=ogame.messages.combatreport;s.setCombatArray(a,e);var o=$("."+s.data.combatside+" .buildingimg"),r=$("."+s.data.combatside+" .defenseimg");o=$.merge(o,r);var l=s.getShipsByMembersAndCoords(s.data.activeMember,i,n);s.setActiveFlag4Fleet(o,l),s.displayShipData(s.data.activeMember,s.data.combatside,a.combatRounds[a.combatRounds.length-1],a.member,i,n),s.setCombatValue()}},$((function(){initTooltips()}));var TimerHandler=function(t,e){void 0===t&&(t=1e3),this._interval=t,this._callbacks=new Array,this._intervalId=null,this._lastId=0,this.pageReloadAlreadyTriggered=!1,this.checkEventsAlreadyQueued=!1,0!=e&&this.startTimer()};TimerHandler.prototype.appendCallback=function(t){var e=this._lastId++;return this._callbacks[e]=t,e},TimerHandler.prototype.removeCallback=function(t){this._callbacks[t]=null},TimerHandler.prototype.startTimer=function(){var t=this;this._intervalId=window.setInterval((function(){t._timer()}),this._interval)},TimerHandler.prototype.stopTimer=function(){window.clearInterval(this._intervalId)},TimerHandler.prototype._timer=function(){for(var t in this._callbacks)null!=this._callbacks[t]&&this._callbacks[t]()};var TimerHandler=function(t,e){void 0===t&&(t=1e3),this._interval=t,this._callbacks=new Array,this._intervalId=null,this._lastId=0,this.pageReloadAlreadyTriggered=!1,this.checkEventsAlreadyQueued=!1,0!=e&&this.startTimer()};TimerHandler.prototype.appendCallback=function(t){var e=this._lastId++;return this._callbacks[e]=t,e},TimerHandler.prototype.removeCallback=function(t){this._callbacks[t]=null},TimerHandler.prototype.startTimer=function(){var t=this;this._intervalId=window.setInterval((function(){t._timer()}),this._interval)},TimerHandler.prototype.stopTimer=function(){window.clearInterval(this._intervalId)},TimerHandler.prototype._timer=function(){for(var t in this._callbacks)null!=this._callbacks[t]&&this._callbacks[t]()},document.createElement("canvas").getContext||function(){function t(){}function e(t){this.type_=t,this.r1_=this.y1_=this.x1_=this.r0_=this.y0_=this.x0_=0,this.colors_=[]}function i(t,e,i){!function(t){for(var e=0;e<3;e++)for(var i=0;i<2;i++)if(!isFinite(t[e][i])||isNaN(t[e][i]))return!1;return!0}(e)||(t.m_=e,i&&(t.lineScale_=g(m(e[0][0]*e[1][1]-e[0][1]*e[1][0]))))}function n(t,e,i,n){t.currentPath_.push({type:"bezierCurveTo",cp1x:e.x,cp1y:e.y,cp2x:i.x,cp2y:i.y,x:n.x,y:n.y}),t.currentX_=n.x,t.currentY_=n.y}function a(t){this.m_=[[1,0,0],[0,1,0],[0,0,1]],this.mStack_=[],this.aStack_=[],this.currentPath_=[],this.fillStyle=this.strokeStyle="#000",this.lineWidth=1,this.lineJoin="miter",this.lineCap="butt",this.miterLimit=1*v,this.globalAlpha=1,this.canvas=t;var e=t.ownerDocument.createElement("div");e.style.width=t.clientWidth+"px",e.style.height=t.clientHeight+"px",e.style.overflow="hidden",e.style.position="absolute",t.appendChild(e),this.element_=e,this.lineScale_=this.arcScaleY_=this.arcScaleX_=1}function s(t){var e,i=1;if("rgb"==(t=String(t)).substring(0,3)){var n=t.indexOf("(",3),a=t.indexOf(")",n+1),s=t.substring(n+1,a).split(",");e="#";for(var o=0;o<3;o++)e+=x[Number(s[o])];4==s.length&&"a"==t.substr(3,1)&&(i=s[3])}else e=t;return{color:e,alpha:i}}function o(t,e){e.fillStyle=t.fillStyle,e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.shadowBlur=t.shadowBlur,e.shadowColor=t.shadowColor,e.shadowOffsetX=t.shadowOffsetX,e.shadowOffsetY=t.shadowOffsetY,e.strokeStyle=t.strokeStyle,e.globalAlpha=t.globalAlpha,e.arcScaleX_=t.arcScaleX_,e.arcScaleY_=t.arcScaleY_,e.lineScale_=t.lineScale_}function r(t,e){for(var i=[[1,0,0],[0,1,0],[0,0,1]],n=0;n<3;n++)for(var a=0;a<3;a++){for(var s=0,o=0;o<3;o++)s+=t[n][o]*e[o][a];i[n][a]=s}return i}function l(t){var e=t.srcElement;e.firstChild&&(e.firstChild.style.width=e.clientWidth+"px",e.firstChild.style.height=e.clientHeight+"px")}function c(t){var e=t.srcElement;switch(t.propertyName){case"width":e.style.width=e.attributes.width.nodeValue+"px",e.getContext().clearRect();break;case"height":e.style.height=e.attributes.height.nodeValue+"px",e.getContext().clearRect()}}function d(){return this.context_||(this.context_=new a(this))}var u=Math,h=u.round,p=u.sin,f=u.cos,m=u.abs,g=u.sqrt,v=10,b=v/2,y=Array.prototype.slice,_={init:function(t){if(/MSIE/.test(navigator.userAgent)&&!window.opera){var e=t||document;e.createElement("canvas"),e.attachEvent("onreadystatechange",function(t,e){var i=y.call(arguments,2);return function(){return t.apply(e,i.concat(y.call(arguments)))}}(this.init_,this,e))}},init_:function(t){if(t.namespaces.g_vml_||t.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML"),t.namespaces.g_o_||t.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML"),!t.styleSheets.ex_canvas_){var e=t.createStyleSheet();e.owningElement.id="ex_canvas_",e.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}g_vml_\\:*{behavior:url(#default#VML)}g_o_\\:*{behavior:url(#default#VML)}"}for(var i=t.getElementsByTagName("canvas"),n=0;n<i.length;n++)this.initElement(i[n])},initElement:function(t){if(!t.getContext){t.getContext=d,t.innerHTML="",t.attachEvent("onpropertychange",c),t.attachEvent("onresize",l);var e=t.attributes;e.width&&e.width.specified?t.style.width=e.width.nodeValue+"px":t.width=t.clientWidth,e.height&&e.height.specified?t.style.height=e.height.nodeValue+"px":t.height=t.clientHeight}return t}};_.init();for(var x=[],w=0;w<16;w++)for(var C=0;C<16;C++)x[16*w+C]=w.toString(16)+C.toString(16);var k=a.prototype;k.clearRect=function(){this.element_.innerHTML=""},k.beginPath=function(){this.currentPath_=[]},k.moveTo=function(t,e){var i=this.getCoords_(t,e);this.currentPath_.push({type:"moveTo",x:i.x,y:i.y}),this.currentX_=i.x,this.currentY_=i.y},k.lineTo=function(t,e){var i=this.getCoords_(t,e);this.currentPath_.push({type:"lineTo",x:i.x,y:i.y}),this.currentX_=i.x,this.currentY_=i.y},k.bezierCurveTo=function(t,e,i,a,s,o){var r=this.getCoords_(s,o);n(this,this.getCoords_(t,e),this.getCoords_(i,a),r)},k.quadraticCurveTo=function(t,e,i,a){var s=this.getCoords_(t,e),o=this.getCoords_(i,a),r={x:this.currentX_+.6666666666666666*(s.x-this.currentX_),y:this.currentY_+.6666666666666666*(s.y-this.currentY_)};n(this,r,{x:r.x+(o.x-this.currentX_)/3,y:r.y+(o.y-this.currentY_)/3},o)},k.arc=function(t,e,i,n,a,s){i*=v;var o=s?"at":"wa",r=t+f(n)*i-b,l=e+p(n)*i-b,c=t+f(a)*i-b,d=e+p(a)*i-b;r==c&&!s&&(r+=.125);var u=this.getCoords_(t,e),h=this.getCoords_(r,l),m=this.getCoords_(c,d);this.currentPath_.push({type:o,x:u.x,y:u.y,radius:i,xStart:h.x,yStart:h.y,xEnd:m.x,yEnd:m.y})},k.rect=function(t,e,i,n){this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+n),this.lineTo(t,e+n),this.closePath()},k.strokeRect=function(t,e,i,n){var a=this.currentPath_;this.beginPath(),this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+n),this.lineTo(t,e+n),this.closePath(),this.stroke(),this.currentPath_=a},k.fillRect=function(t,e,i,n){var a=this.currentPath_;this.beginPath(),this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+n),this.lineTo(t,e+n),this.closePath(),this.fill(),this.currentPath_=a},k.createLinearGradient=function(t,i,n,a){var s=new e("gradient");return s.x0_=t,s.y0_=i,s.x1_=n,s.y1_=a,s},k.createRadialGradient=function(t,i,n,a,s,o){var r=new e("gradientradial");return r.x0_=t,r.y0_=i,r.r0_=n,r.x1_=a,r.y1_=s,r.r1_=o,r},k.drawImage=function(t){var e,i,n,a,s,o,r,l,c=t.runtimeStyle.width,d=t.runtimeStyle.height;t.runtimeStyle.width="auto",t.runtimeStyle.height="auto";var p=t.width,f=t.height;if(t.runtimeStyle.width=c,t.runtimeStyle.height=d,3==arguments.length)e=arguments[1],i=arguments[2],s=o=0,r=n=p,l=a=f;else if(5==arguments.length)e=arguments[1],i=arguments[2],n=arguments[3],a=arguments[4],s=o=0,r=p,l=f;else{if(9!=arguments.length)throw Error("Invalid number of arguments");s=arguments[1],o=arguments[2],r=arguments[3],l=arguments[4],e=arguments[5],i=arguments[6],n=arguments[7],a=arguments[8]}var m=this.getCoords_(e,i),g=[];if(g.push(" <g_vml_:group",' coordsize="',10*v,",",10*v,'"',' coordorigin="0,0"',' style="width:',10,"px;height:",10,"px;position:absolute;"),1!=this.m_[0][0]||this.m_[0][1]){var b=[];b.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",h(m.x/v),",","Dy=",h(m.y/v),"");var y=m,_=this.getCoords_(e+n,i),x=this.getCoords_(e,i+a),w=this.getCoords_(e+n,i+a);y.x=u.max(y.x,_.x,x.x,w.x),y.y=u.max(y.y,_.y,x.y,w.y),g.push("padding:0 ",h(y.x/v),"px ",h(y.y/v),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",b.join(""),", sizingmethod='clip');")}else g.push("top:",h(m.y/v),"px;left:",h(m.x/v),"px;");g.push(' ">','<g_vml_:image src="',t.src,'"',' style="width:',v*n,"px;"," height:",v*a,'px;"',' cropleft="',s/p,'"',' croptop="',o/f,'"',' cropright="',(p-s-r)/p,'"',' cropbottom="',(f-o-l)/f,'"'," />","</g_vml_:group>"),this.element_.insertAdjacentHTML("BeforeEnd",g.join(""))},k.stroke=function(t){var e=[],i=s(t?this.fillStyle:this.strokeStyle),n=i.color,a=i.alpha*this.globalAlpha;e.push("<g_vml_:shape",' filled="',!!t,'"',' style="position:absolute;width:',10,"px;height:",10,'px;"',' coordorigin="0 0" coordsize="',10*v," ",10*v,'"',' stroked="',!t,'"',' path="');for(var o={x:null,y:null},r={x:null,y:null},l=0;l<this.currentPath_.length;l++){var c=this.currentPath_[l];switch(c.type){case"moveTo":e.push(" m ",h(c.x),",",h(c.y));break;case"lineTo":e.push(" l ",h(c.x),",",h(c.y));break;case"close":e.push(" x "),c=null;break;case"bezierCurveTo":e.push(" c ",h(c.cp1x),",",h(c.cp1y),",",h(c.cp2x),",",h(c.cp2y),",",h(c.x),",",h(c.y));break;case"at":case"wa":e.push(" ",c.type," ",h(c.x-this.arcScaleX_*c.radius),",",h(c.y-this.arcScaleY_*c.radius)," ",h(c.x+this.arcScaleX_*c.radius),",",h(c.y+this.arcScaleY_*c.radius)," ",h(c.xStart),",",h(c.yStart)," ",h(c.xEnd),",",h(c.yEnd))}c&&((null==o.x||c.x<o.x)&&(o.x=c.x),(null==r.x||c.x>r.x)&&(r.x=c.x),(null==o.y||c.y<o.y)&&(o.y=c.y),(null==r.y||c.y>r.y)&&(r.y=c.y))}if(e.push(' ">'),t)if("object"==typeof this.fillStyle){var d=this.fillStyle,p=0,f={x:0,y:0},m=0,g=1;if("gradient"==d.type_){var b=d.x1_/this.arcScaleX_,y=d.y1_/this.arcScaleY_,_=this.getCoords_(d.x0_/this.arcScaleX_,d.y0_/this.arcScaleY_),x=this.getCoords_(b,y);(p=180*Math.atan2(x.x-_.x,x.y-_.y)/Math.PI)<0&&(p+=360),p<1e-6&&(p=0)}else{_=this.getCoords_(d.x0_,d.y0_);var w=r.x-o.x,C=r.y-o.y;f={x:(_.x-o.x)/w,y:(_.y-o.y)/C},w/=this.arcScaleX_*v,C/=this.arcScaleY_*v;var k=u.max(w,C);m=2*d.r0_/k,g=2*d.r1_/k-m}var $=d.colors_;$.sort((function(t,e){return t.offset-e.offset}));var S=$.length,T=$[0].color,I=$[S-1].color,D=$[0].alpha*this.globalAlpha,A=$[S-1].alpha*this.globalAlpha,P=[];for(l=0;l<S;l++){var O=$[l];P.push(O.offset*g+m+" "+O.color)}e.push('<g_vml_:fill type="',d.type_,'"',' method="none" focus="100%"',' color="',T,'"',' color2="',I,'"',' colors="',P.join(","),'"',' opacity="',A,'"',' g_o_:opacity2="',D,'"',' angle="',p,'"',' focusposition="',f.x,",",f.y,'" />')}else e.push('<g_vml_:fill color="',n,'" opacity="',a,'" />');else{var E=this.lineScale_*this.lineWidth;E<1&&(a*=E),e.push("<g_vml_:stroke",' opacity="',a,'"',' joinstyle="',this.lineJoin,'"',' miterlimit="',this.miterLimit,'"',' endcap="',function(t){switch(t){case"butt":return"flat";case"round":return"round";default:return"square"}}(this.lineCap),'"',' weight="',E,'px"',' color="',n,'" />')}e.push("</g_vml_:shape>"),this.element_.insertAdjacentHTML("beforeEnd",e.join(""))},k.fill=function(){this.stroke(!0)},k.closePath=function(){this.currentPath_.push({type:"close"})},k.getCoords_=function(t,e){var i=this.m_;return{x:v*(t*i[0][0]+e*i[1][0]+i[2][0])-b,y:v*(t*i[0][1]+e*i[1][1]+i[2][1])-b}},k.save=function(){var t={};o(this,t),this.aStack_.push(t),this.mStack_.push(this.m_),this.m_=r([[1,0,0],[0,1,0],[0,0,1]],this.m_)},k.restore=function(){o(this.aStack_.pop(),this),this.m_=this.mStack_.pop()},k.translate=function(t,e){i(this,r([[1,0,0],[0,1,0],[t,e,1]],this.m_),!1)},k.rotate=function(t){var e=f(t),n=p(t);i(this,r([[e,n,0],[-n,e,0],[0,0,1]],this.m_),!1)},k.scale=function(t,e){this.arcScaleX_*=t,this.arcScaleY_*=e,i(this,r([[t,0,0],[0,e,0],[0,0,1]],this.m_),!0)},k.transform=function(t,e,n,a,s,o){i(this,r([[t,e,0],[n,a,0],[s,o,1]],this.m_),!0)},k.setTransform=function(t,e,n,a,s,o){i(this,[[t,e,0],[n,a,0],[s,o,1]],!0)},k.clip=function(){},k.arcTo=function(){},k.createPattern=function(){return new t},e.prototype.addColorStop=function(t,e){e=s(e),this.colors_.push({offset:t,color:e.color,alpha:e.alpha})},G_vmlCanvasManager=_,CanvasRenderingContext2D=a,CanvasGradient=e,CanvasPattern=t}(),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}((function(t){function e(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},t.extend(this._defaults,this.regional[""]),this.regional.en=t.extend(!0,{},this.regional[""]),this.regional["en-US"]=t.extend(!0,{},this.regional.en),this.dpDiv=i(t("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function i(e){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.on("mouseout",i,(function(){t(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).removeClass("ui-datepicker-next-hover")})).on("mouseover",i,n)}function n(){t.datepicker._isDisabledDatepicker(h.inline?h.dpDiv.parent()[0]:h.input[0])||(t(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),t(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).addClass("ui-datepicker-next-hover"))}function a(e,i){for(var n in t.extend(e,i),i)null==i[n]&&(e[n]=i[n]);return e}function s(t){return function(){var e=this.element.val();t.apply(this,arguments),this._refresh(),e!==this.element.val()&&this._trigger("change")}}t.ui=t.ui||{},t.ui.version="1.12.1";var o=0,r=Array.prototype.slice;t.cleanData=function(e){return function(i){var n,a,s;for(s=0;null!=(a=i[s]);s++)try{(n=t._data(a,"events"))&&n.remove&&t(a).triggerHandler("remove")}catch(t){}e(i)}}(t.cleanData),t.widget=function(e,i,n){var a,s,o,r={},l=e.split(".")[0],c=l+"-"+(e=e.split(".")[1]);return n||(n=i,i=t.Widget),t.isArray(n)&&(n=t.extend.apply(null,[{}].concat(n))),t.expr[":"][c.toLowerCase()]=function(e){return!!t.data(e,c)},t[l]=t[l]||{},a=t[l][e],s=t[l][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new s(t,e)},t.extend(s,a,{version:n.version,_proto:t.extend({},n),_childConstructors:[]}),(o=new i).options=t.widget.extend({},o.options),t.each(n,(function(e,n){return t.isFunction(n)?void(r[e]=function(){function t(){return i.prototype[e].apply(this,arguments)}function a(t){return i.prototype[e].apply(this,t)}return function(){var e,i=this._super,s=this._superApply;return this._super=t,this._superApply=a,e=n.apply(this,arguments),this._super=i,this._superApply=s,e}}()):void(r[e]=n)})),s.prototype=t.widget.extend(o,{widgetEventPrefix:a&&o.widgetEventPrefix||e},r,{constructor:s,namespace:l,widgetName:e,widgetFullName:c}),a?(t.each(a._childConstructors,(function(e,i){var n=i.prototype;t.widget(n.namespace+"."+n.widgetName,s,i._proto)})),delete a._childConstructors):i._childConstructors.push(s),t.widget.bridge(e,s),s},t.widget.extend=function(e){for(var i,n,a=r.call(arguments,1),s=0,o=a.length;o>s;s++)for(i in a[s])n=a[s][i],a[s].hasOwnProperty(i)&&void 0!==n&&(e[i]=t.isPlainObject(n)?t.isPlainObject(e[i])?t.widget.extend({},e[i],n):t.widget.extend({},n):n);return e},t.widget.bridge=function(e,i){var n=i.prototype.widgetFullName||e;t.fn[e]=function(a){var s="string"==typeof a,o=r.call(arguments,1),l=this;return s?this.length||"instance"!==a?this.each((function(){var i,s=t.data(this,n);return"instance"===a?(l=s,!1):s?t.isFunction(s[a])&&"_"!==a.charAt(0)?(i=s[a].apply(s,o))!==s&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0:t.error("no such method '"+a+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+a+"'")})):l=void 0:(o.length&&(a=t.widget.extend.apply(null,[a].concat(o))),this.each((function(){var e=t.data(this,n);e?(e.option(a||{}),e._init&&e._init()):t.data(this,n,new i(a,this))}))),l}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(e,i){i=t(i||this.defaultElement||this)[0],this.element=t(i),this.uuid=o++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),this.classesElementLookup={},i!==this&&(t.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===i&&this.destroy()}}),this.document=t(i.style?i.ownerDocument:i.document||i),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){var e=this;this._destroy(),t.each(this.classesElementLookup,(function(t,i){e._removeClass(i,t)})),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var n,a,s,o=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(o={},n=e.split("."),e=n.shift(),n.length){for(a=o[e]=t.widget.extend({},this.options[e]),s=0;n.length-1>s;s++)a[n[s]]=a[n[s]]||{},a=a[n[s]];if(e=n.pop(),1===arguments.length)return void 0===a[e]?null:a[e];a[e]=i}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];o[e]=i}return this._setOptions(o),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return"classes"===t&&this._setOptionClasses(e),this.options[t]=e,"disabled"===t&&this._setOptionDisabled(e),this},_setOptionClasses:function(e){var i,n,a;for(i in e)a=this.classesElementLookup[i],e[i]!==this.options.classes[i]&&a&&a.length&&(n=t(a.get()),this._removeClass(a,i),n.addClass(this._classes({element:n,keys:i,classes:e,add:!0})))},_setOptionDisabled:function(t){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!t),t&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(e){function i(i,s){var o,r;for(r=0;i.length>r;r++)o=a.classesElementLookup[i[r]]||t(),o=e.add?t(t.unique(o.get().concat(e.element.get()))):t(o.not(e.element).get()),a.classesElementLookup[i[r]]=o,n.push(i[r]),s&&e.classes[i[r]]&&n.push(e.classes[i[r]])}var n=[],a=this;return e=t.extend({element:this.element,classes:this.options.classes||{}},e),this._on(e.element,{remove:"_untrackClassesElement"}),e.keys&&i(e.keys.match(/\S+/g)||[],!0),e.extra&&i(e.extra.match(/\S+/g)||[]),n.join(" ")},_untrackClassesElement:function(e){var i=this;t.each(i.classesElementLookup,(function(n,a){-1!==t.inArray(e.target,a)&&(i.classesElementLookup[n]=t(a.not(e.target).get()))}))},_removeClass:function(t,e,i){return this._toggleClass(t,e,i,!1)},_addClass:function(t,e,i){return this._toggleClass(t,e,i,!0)},_toggleClass:function(t,e,i,n){n="boolean"==typeof n?n:i;var a="string"==typeof t||null===t,s={extra:a?e:i,keys:a?t:e,element:a?this.element:t,add:n};return s.element.toggleClass(this._classes(s),n),this},_on:function(e,i,n){var a,s=this;"boolean"!=typeof e&&(n=i,i=e,e=!1),n?(i=a=t(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,a=this.widget()),t.each(n,(function(n,o){function r(){return e||!0!==s.options.disabled&&!t(this).hasClass("ui-state-disabled")?("string"==typeof o?s[o]:o).apply(s,arguments):void 0}"string"!=typeof o&&(r.guid=o.guid=o.guid||r.guid||t.guid++);var l=n.match(/^([\w:-]*)\s*(.*)$/),c=l[1]+s.eventNamespace,d=l[2];d?a.on(c,d,r):i.on(c,r)}))},_off:function(e,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.off(i).off(i),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){var i=this;return setTimeout((function(){return("string"==typeof t?i[t]:t).apply(i,arguments)}),e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){this._addClass(t(e.currentTarget),null,"ui-state-hover")},mouseleave:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){this._addClass(t(e.currentTarget),null,"ui-state-focus")},focusout:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-focus")}})},_trigger:function(e,i,n){var a,s,o=this.options[e];if(n=n||{},(i=t.Event(i)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],s=i.originalEvent)for(a in s)a in i||(i[a]=s[a]);return this.element.trigger(i,n),!(t.isFunction(o)&&!1===o.apply(this.element[0],[i].concat(n))||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},(function(e,i){t.Widget.prototype["_"+e]=function(n,a,s){"string"==typeof a&&(a={effect:a});var o,r=a?!0===a||"number"==typeof a?i:a.effect||i:e;"number"==typeof(a=a||{})&&(a={duration:a}),o=!t.isEmptyObject(a),a.complete=s,a.delay&&n.delay(a.delay),o&&t.effects&&t.effects.effect[r]?n[e](a):r!==e&&n[r]?n[r](a.duration,a.easing,s):n.queue((function(i){t(this)[e](),s&&s.call(n[0]),i()}))}})),t.widget,function(){function e(t,e,i){return[parseFloat(t[0])*(d.test(t[0])?e/100:1),parseFloat(t[1])*(d.test(t[1])?i/100:1)]}function i(e,i){return parseInt(t.css(e,i),10)||0}var n,a=Math.max,s=Math.abs,o=/left|center|right/,r=/top|center|bottom/,l=/[\+\-]\d+(\.[\d]+)?%?/,c=/^\w+/,d=/%$/,u=t.fn.position;t.position={scrollbarWidth:function(){if(void 0!==n)return n;var e,i,a=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),s=a.children()[0];return t("body").append(a),e=s.offsetWidth,a.css("overflow","scroll"),e===(i=s.offsetWidth)&&(i=a[0].clientWidth),a.remove(),n=e-i},getScrollInfo:function(e){var i=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),n=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),a="scroll"===i||"auto"===i&&e.width<e.element[0].scrollWidth;return{width:"scroll"===n||"auto"===n&&e.height<e.element[0].scrollHeight?t.position.scrollbarWidth():0,height:a?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),n=t.isWindow(i[0]),a=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:n,isDocument:a,offset:!n&&!a?t(e).offset():{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:i.outerWidth(),height:i.outerHeight()}}},t.fn.position=function(n){if(!n||!n.of)return u.apply(this,arguments);n=t.extend({},n);var d,h,p,f,m,g,v=t(n.of),b=t.position.getWithinInfo(n.within),y=t.position.getScrollInfo(b),_=(n.collision||"flip").split(" "),x={};return g=function(e){var i=e[0];return 9===i.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}(v),v[0].preventDefault&&(n.at="left top"),h=g.width,p=g.height,f=g.offset,m=t.extend({},f),t.each(["my","at"],(function(){var t,e,i=(n[this]||"").split(" ");1===i.length&&(i=o.test(i[0])?i.concat(["center"]):r.test(i[0])?["center"].concat(i):["center","center"]),i[0]=o.test(i[0])?i[0]:"center",i[1]=r.test(i[1])?i[1]:"center",t=l.exec(i[0]),e=l.exec(i[1]),x[this]=[t?t[0]:0,e?e[0]:0],n[this]=[c.exec(i[0])[0],c.exec(i[1])[0]]})),1===_.length&&(_[1]=_[0]),"right"===n.at[0]?m.left+=h:"center"===n.at[0]&&(m.left+=h/2),"bottom"===n.at[1]?m.top+=p:"center"===n.at[1]&&(m.top+=p/2),d=e(x.at,h,p),m.left+=d[0],m.top+=d[1],this.each((function(){var o,r,l=t(this),c=l.outerWidth(),u=l.outerHeight(),g=i(this,"marginLeft"),w=i(this,"marginTop"),C=c+g+i(this,"marginRight")+y.width,k=u+w+i(this,"marginBottom")+y.height,$=t.extend({},m),S=e(x.my,l.outerWidth(),l.outerHeight());"right"===n.my[0]?$.left-=c:"center"===n.my[0]&&($.left-=c/2),"bottom"===n.my[1]?$.top-=u:"center"===n.my[1]&&($.top-=u/2),$.left+=S[0],$.top+=S[1],o={marginLeft:g,marginTop:w},t.each(["left","top"],(function(e,i){t.ui.position[_[e]]&&t.ui.position[_[e]][i]($,{targetWidth:h,targetHeight:p,elemWidth:c,elemHeight:u,collisionPosition:o,collisionWidth:C,collisionHeight:k,offset:[d[0]+S[0],d[1]+S[1]],my:n.my,at:n.at,within:b,elem:l})})),n.using&&(r=function(t){var e=f.left-$.left,i=e+h-c,o=f.top-$.top,r=o+p-u,d={target:{element:v,left:f.left,top:f.top,width:h,height:p},element:{element:l,left:$.left,top:$.top,width:c,height:u},horizontal:0>i?"left":e>0?"right":"center",vertical:0>r?"top":o>0?"bottom":"middle"};c>h&&h>s(e+i)&&(d.horizontal="center"),u>p&&p>s(o+r)&&(d.vertical="middle"),d.important=a(s(e),s(i))>a(s(o),s(r))?"horizontal":"vertical",n.using.call(this,t,d)}),l.offset(t.extend($,{using:r}))}))},t.ui.position={fit:{left:function(t,e){var i,n=e.within,s=n.isWindow?n.scrollLeft:n.offset.left,o=n.width,r=t.left-e.collisionPosition.marginLeft,l=s-r,c=r+e.collisionWidth-o-s;e.collisionWidth>o?l>0&&0>=c?(i=t.left+l+e.collisionWidth-o-s,t.left+=l-i):t.left=c>0&&0>=l?s:l>c?s+o-e.collisionWidth:s:l>0?t.left+=l:c>0?t.left-=c:t.left=a(t.left-r,t.left)},top:function(t,e){var i,n=e.within,s=n.isWindow?n.scrollTop:n.offset.top,o=e.within.height,r=t.top-e.collisionPosition.marginTop,l=s-r,c=r+e.collisionHeight-o-s;e.collisionHeight>o?l>0&&0>=c?(i=t.top+l+e.collisionHeight-o-s,t.top+=l-i):t.top=c>0&&0>=l?s:l>c?s+o-e.collisionHeight:s:l>0?t.top+=l:c>0?t.top-=c:t.top=a(t.top-r,t.top)}},flip:{left:function(t,e){var i,n,a=e.within,o=a.offset.left+a.scrollLeft,r=a.width,l=a.isWindow?a.scrollLeft:a.offset.left,c=t.left-e.collisionPosition.marginLeft,d=c-l,u=c+e.collisionWidth-r-l,h="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];0>d?(0>(i=t.left+h+p+f+e.collisionWidth-r-o)||s(d)>i)&&(t.left+=h+p+f):u>0&&(((n=t.left-e.collisionPosition.marginLeft+h+p+f-l)>0||u>s(n))&&(t.left+=h+p+f))},top:function(t,e){var i,n,a=e.within,o=a.offset.top+a.scrollTop,r=a.height,l=a.isWindow?a.scrollTop:a.offset.top,c=t.top-e.collisionPosition.marginTop,d=c-l,u=c+e.collisionHeight-r-l,h="top"===e.my[1]?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,p="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,f=-2*e.offset[1];0>d?(0>(n=t.top+h+p+f+e.collisionHeight-r-o)||s(d)>n)&&(t.top+=h+p+f):u>0&&(((i=t.top-e.collisionPosition.marginTop+h+p+f-l)>0||u>s(i))&&(t.top+=h+p+f))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}}}(),t.ui.position,t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo((function(e){return function(i){return!!t.data(i,e)}})):function(e,i,n){return!!t.data(e,n[3])}}),t.fn.extend({disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.on(t+".ui-disableSelection",(function(t){t.preventDefault()}))}}(),enableSelection:function(){return this.off(".ui-disableSelection")}});var l="ui-effects-",c="ui-effects-style",d="ui-effects-animated",u=t;t.effects={effect:{}},function(t,e){function i(t,e,i){var n=d[e.type]||{};return null==t?i||!e.def?null:e.def:(t=n.floor?~~t:parseFloat(t),isNaN(t)?e.def:n.mod?(t+n.mod)%n.mod:0>t?0:t>n.max?n.max:t)}function n(i){var n=l(),a=n._rgba=[];return i=i.toLowerCase(),p(r,(function(t,s){var o,r=s.re.exec(i),l=r&&s.parse(r),d=s.space||"rgba";return l?(o=n[d](l),n[c[d].cache]=o[c[d].cache],a=n._rgba=o._rgba,!1):e})),a.length?("0,0,0,0"===a.join()&&t.extend(a,s.transparent),n):s[i]}function a(t,e,i){return 1>6*(i=(i+1)%1)?t+6*(e-t)*i:1>2*i?e:2>3*i?t+6*(e-t)*(2/3-i):t}var s,o=/^([\-+])=\s*(\d+\.?\d*)/,r=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],l=t.Color=function(e,i,n,a){return new t.Color.fn.parse(e,i,n,a)},c={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},d={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},u=l.support={},h=t("<p>")[0],p=t.each;h.style.cssText="background-color:rgba(1,1,1,.5)",u.rgba=h.style.backgroundColor.indexOf("rgba")>-1,p(c,(function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}})),l.fn=t.extend(l.prototype,{parse:function(a,o,r,d){if(a===e)return this._rgba=[null,null,null,null],this;(a.jquery||a.nodeType)&&(a=t(a).css(o),o=e);var u=this,h=t.type(a),f=this._rgba=[];return o!==e&&(a=[a,o,r,d],h="array"),"string"===h?this.parse(n(a)||s._default):"array"===h?(p(c.rgba.props,(function(t,e){f[e.idx]=i(a[e.idx],e)})),this):"object"===h?(p(c,a instanceof l?function(t,e){a[e.cache]&&(u[e.cache]=a[e.cache].slice())}:function(e,n){var s=n.cache;p(n.props,(function(t,e){if(!u[s]&&n.to){if("alpha"===t||null==a[t])return;u[s]=n.to(u._rgba)}u[s][e.idx]=i(a[t],e,!0)})),u[s]&&0>t.inArray(null,u[s].slice(0,3))&&(u[s][3]=1,n.from&&(u._rgba=n.from(u[s])))}),this):e},is:function(t){var i=l(t),n=!0,a=this;return p(c,(function(t,s){var o,r=i[s.cache];return r&&(o=a[s.cache]||s.to&&s.to(a._rgba)||[],p(s.props,(function(t,i){return null!=r[i.idx]?n=r[i.idx]===o[i.idx]:e}))),n})),n},_space:function(){var t=[],e=this;return p(c,(function(i,n){e[n.cache]&&t.push(i)})),t.pop()},transition:function(t,e){var n=l(t),a=n._space(),s=c[a],o=0===this.alpha()?l("transparent"):this,r=o[s.cache]||s.to(o._rgba),u=r.slice();return n=n[s.cache],p(s.props,(function(t,a){var s=a.idx,o=r[s],l=n[s],c=d[a.type]||{};null!==l&&(null===o?u[s]=l:(c.mod&&(l-o>c.mod/2?o+=c.mod:o-l>c.mod/2&&(o-=c.mod)),u[s]=i((l-o)*e+o,a)))})),this[a](u)},blend:function(e){if(1===this._rgba[3])return this;var i=this._rgba.slice(),n=i.pop(),a=l(e)._rgba;return l(t.map(i,(function(t,e){return(1-n)*a[e]+n*t})))},toRgbaString:function(){var e="rgba(",i=t.map(this._rgba,(function(t,e){return null==t?e>2?1:0:t}));return 1===i[3]&&(i.pop(),e="rgb("),e+i.join()+")"},toHslaString:function(){var e="hsla(",i=t.map(this.hsla(),(function(t,e){return null==t&&(t=e>2?1:0),e&&3>e&&(t=Math.round(100*t)+"%"),t}));return 1===i[3]&&(i.pop(),e="hsl("),e+i.join()+")"},toHexString:function(e){var i=this._rgba.slice(),n=i.pop();return e&&i.push(~~(255*n)),"#"+t.map(i,(function(t){return 1===(t=(t||0).toString(16)).length?"0"+t:t})).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,c.hsla.to=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e,i,n=t[0]/255,a=t[1]/255,s=t[2]/255,o=t[3],r=Math.max(n,a,s),l=Math.min(n,a,s),c=r-l,d=r+l,u=.5*d;return e=l===r?0:n===r?60*(a-s)/c+360:a===r?60*(s-n)/c+120:60*(n-a)/c+240,i=0===c?0:.5>=u?c/d:c/(2-d),[Math.round(e)%360,i,u,null==o?1:o]},c.hsla.from=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/360,i=t[1],n=t[2],s=t[3],o=.5>=n?n*(1+i):n+i-n*i,r=2*n-o;return[Math.round(255*a(r,o,e+1/3)),Math.round(255*a(r,o,e)),Math.round(255*a(r,o,e-1/3)),s]},p(c,(function(n,a){var s=a.props,r=a.cache,c=a.to,d=a.from;l.fn[n]=function(n){if(c&&!this[r]&&(this[r]=c(this._rgba)),n===e)return this[r].slice();var a,o=t.type(n),u="array"===o||"object"===o?n:arguments,h=this[r].slice();return p(s,(function(t,e){var n=u["object"===o?t:e.idx];null==n&&(n=h[e.idx]),h[e.idx]=i(n,e)})),d?((a=l(d(h)))[r]=h,a):l(h)},p(s,(function(e,i){l.fn[e]||(l.fn[e]=function(a){var s,r=t.type(a),l="alpha"===e?this._hsla?"hsla":"rgba":n,c=this[l](),d=c[i.idx];return"undefined"===r?d:("function"===r&&(a=a.call(this,d),r=t.type(a)),null==a&&i.empty?this:("string"===r&&((s=o.exec(a))&&(a=d+parseFloat(s[2])*("+"===s[1]?1:-1))),c[i.idx]=a,this[l](c)))})}))})),l.hook=function(e){var i=e.split(" ");p(i,(function(e,i){t.cssHooks[i]={set:function(e,a){var s,o,r="";if("transparent"!==a&&("string"!==t.type(a)||(s=n(a)))){if(a=l(s||a),!u.rgba&&1!==a._rgba[3]){for(o="backgroundColor"===i?e.parentNode:e;(""===r||"transparent"===r)&&o&&o.style;)try{r=t.css(o,"backgroundColor"),o=o.parentNode}catch(t){}a=a.blend(r&&"transparent"!==r?r:"_default")}a=a.toRgbaString()}try{e.style[i]=a}catch(t){}}},t.fx.step[i]=function(e){e.colorInit||(e.start=l(e.elem,i),e.end=l(e.end),e.colorInit=!0),t.cssHooks[i].set(e.elem,e.start.transition(e.end,e.pos))}}))},l.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor"),t.cssHooks.borderColor={expand:function(t){var e={};return p(["Top","Right","Bottom","Left"],(function(i,n){e["border"+n+"Color"]=t})),e}},s=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(u),function(){function e(e){var i,n,a=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,s={};if(a&&a.length&&a[0]&&a[a[0]])for(n=a.length;n--;)"string"==typeof a[i=a[n]]&&(s[t.camelCase(i)]=a[i]);else for(i in a)"string"==typeof a[i]&&(s[i]=a[i]);return s}function i(e,i){var n,s,o={};for(n in i)s=i[n],e[n]!==s&&(a[n]||(t.fx.step[n]||!isNaN(parseFloat(s)))&&(o[n]=s));return o}var n=["add","remove","toggle"],a={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};t.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],(function(e,i){t.fx.step[i]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(u.style(t.elem,i,t.end),t.setAttr=!0)}})),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.effects.animateClass=function(a,s,o,r){var l=t.speed(s,o,r);return this.queue((function(){var s,o=t(this),r=o.attr("class")||"",c=l.children?o.find("*").addBack():o;c=c.map((function(){return{el:t(this),start:e(this)}})),s=function(){t.each(n,(function(t,e){a[e]&&o[e+"Class"](a[e])}))},s(),c=c.map((function(){return this.end=e(this.el[0]),this.diff=i(this.start,this.end),this})),o.attr("class",r),c=c.map((function(){var e=this,i=t.Deferred(),n=t.extend({},l,{queue:!1,complete:function(){i.resolve(e)}});return this.el.animate(this.diff,n),i.promise()})),t.when.apply(t,c.get()).done((function(){s(),t.each(arguments,(function(){var e=this.el;t.each(this.diff,(function(t){e.css(t,"")}))})),l.complete.call(o[0])}))}))},t.fn.extend({addClass:function(e){return function(i,n,a,s){return n?t.effects.animateClass.call(this,{add:i},n,a,s):e.apply(this,arguments)}}(t.fn.addClass),removeClass:function(e){return function(i,n,a,s){return arguments.length>1?t.effects.animateClass.call(this,{remove:i},n,a,s):e.apply(this,arguments)}}(t.fn.removeClass),toggleClass:function(e){return function(i,n,a,s,o){return"boolean"==typeof n||void 0===n?a?t.effects.animateClass.call(this,n?{add:i}:{remove:i},a,s,o):e.apply(this,arguments):t.effects.animateClass.call(this,{toggle:i},n,a,s)}}(t.fn.toggleClass),switchClass:function(e,i,n,a,s){return t.effects.animateClass.call(this,{add:i,remove:e},n,a,s)}})}(),function(){function e(e,i,n,a){return t.isPlainObject(e)&&(i=e,e=e.effect),e={effect:e},null==i&&(i={}),t.isFunction(i)&&(a=i,n=null,i={}),("number"==typeof i||t.fx.speeds[i])&&(a=n,n=i,i={}),t.isFunction(n)&&(a=n,n=null),i&&t.extend(e,i),n=n||i.duration,e.duration=t.fx.off?0:"number"==typeof n?n:n in t.fx.speeds?t.fx.speeds[n]:t.fx.speeds._default,e.complete=a||i.complete,e}function i(e){return!(e&&"number"!=typeof e&&!t.fx.speeds[e])||("string"==typeof e&&!t.effects.effect[e]||(!!t.isFunction(e)||"object"==typeof e&&!e.effect))}function n(t,e){var i=e.outerWidth(),n=e.outerHeight(),a=/^rect\((-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto)\)$/.exec(t)||["",0,i,n,0];return{top:parseFloat(a[1])||0,right:"auto"===a[2]?i:parseFloat(a[2]),bottom:"auto"===a[3]?n:parseFloat(a[3]),left:parseFloat(a[4])||0}}t.expr&&t.expr.filters&&t.expr.filters.animated&&(t.expr.filters.animated=function(e){return function(i){return!!t(i).data(d)||e(i)}}(t.expr.filters.animated)),!1!==t.uiBackCompat&&t.extend(t.effects,{save:function(t,e){for(var i=0,n=e.length;n>i;i++)null!==e[i]&&t.data(l+e[i],t[0].style[e[i]])},restore:function(t,e){for(var i,n=0,a=e.length;a>n;n++)null!==e[n]&&(i=t.data(l+e[n]),t.css(e[n],i))},setMode:function(t,e){return"toggle"===e&&(e=t.is(":hidden")?"show":"hide"),e},createWrapper:function(e){if(e.parent().is(".ui-effects-wrapper"))return e.parent();var i={width:e.outerWidth(!0),height:e.outerHeight(!0),float:e.css("float")},n=t("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),a={width:e.width(),height:e.height()},s=document.activeElement;try{s.id}catch(t){s=document.body}return e.wrap(n),(e[0]===s||t.contains(e[0],s))&&t(s).trigger("focus"),n=e.parent(),"static"===e.css("position")?(n.css({position:"relative"}),e.css({position:"relative"})):(t.extend(i,{position:e.css("position"),zIndex:e.css("z-index")}),t.each(["top","left","bottom","right"],(function(t,n){i[n]=e.css(n),isNaN(parseInt(i[n],10))&&(i[n]="auto")})),e.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),e.css(a),n.css(i).show()},removeWrapper:function(e){var i=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),(e[0]===i||t.contains(e[0],i))&&t(i).trigger("focus")),e}}),t.extend(t.effects,{version:"1.12.1",define:function(e,i,n){return n||(n=i,i="effect"),t.effects.effect[e]=n,t.effects.effect[e].mode=i,n},scaledDimensions:function(t,e,i){if(0===e)return{height:0,width:0,outerHeight:0,outerWidth:0};var n="horizontal"!==i?(e||100)/100:1,a="vertical"!==i?(e||100)/100:1;return{height:t.height()*a,width:t.width()*n,outerHeight:t.outerHeight()*a,outerWidth:t.outerWidth()*n}},clipToBox:function(t){return{width:t.clip.right-t.clip.left,height:t.clip.bottom-t.clip.top,left:t.clip.left,top:t.clip.top}},unshift:function(t,e,i){var n=t.queue();e>1&&n.splice.apply(n,[1,0].concat(n.splice(e,i))),t.dequeue()},saveStyle:function(t){t.data(c,t[0].style.cssText)},restoreStyle:function(t){t[0].style.cssText=t.data(c)||"",t.removeData(c)},mode:function(t,e){var i=t.is(":hidden");return"toggle"===e&&(e=i?"show":"hide"),(i?"hide"===e:"show"===e)&&(e="none"),e},getBaseline:function(t,e){var i,n;switch(t[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=t[0]/e.height}switch(t[1]){case"left":n=0;break;case"center":n=.5;break;case"right":n=1;break;default:n=t[1]/e.width}return{x:n,y:i}},createPlaceholder:function(e){var i,n=e.css("position"),a=e.position();return e.css({marginTop:e.css("marginTop"),marginBottom:e.css("marginBottom"),marginLeft:e.css("marginLeft"),marginRight:e.css("marginRight")}).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()),/^(static|relative)/.test(n)&&(n="absolute",i=t("<"+e[0].nodeName+">").insertAfter(e).css({display:/^(inline|ruby)/.test(e.css("display"))?"inline-block":"block",visibility:"hidden",marginTop:e.css("marginTop"),marginBottom:e.css("marginBottom"),marginLeft:e.css("marginLeft"),marginRight:e.css("marginRight"),float:e.css("float")}).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).addClass("ui-effects-placeholder"),e.data(l+"placeholder",i)),e.css({position:n,left:a.left,top:a.top}),i},removePlaceholder:function(t){var e=l+"placeholder",i=t.data(e);i&&(i.remove(),t.removeData(e))},cleanUp:function(e){t.effects.restoreStyle(e),t.effects.removePlaceholder(e)},setTransition:function(e,i,n,a){return a=a||{},t.each(i,(function(t,i){var s=e.cssUnit(i);s[0]>0&&(a[i]=s[0]*n+s[1])})),a}}),t.fn.extend({effect:function(){function i(e){function i(){t.isFunction(l)&&l.call(o[0]),t.isFunction(e)&&e()}var o=t(this);n.mode=u.shift(),!1===t.uiBackCompat||s?"none"===n.mode?(o[c](),i()):a.call(o[0],n,(function(){o.removeData(d),t.effects.cleanUp(o),"hide"===n.mode&&o.hide(),i()})):(o.is(":hidden")?"hide"===c:"show"===c)?(o[c](),i()):a.call(o[0],n,i)}var n=e.apply(this,arguments),a=t.effects.effect[n.effect],s=a.mode,o=n.queue,r=o||"fx",l=n.complete,c=n.mode,u=[],h=function(e){var i=t(this),n=t.effects.mode(i,c)||s;i.data(d,!0),u.push(n),s&&("show"===n||n===s&&"hide"===n)&&i.show(),s&&"none"===n||t.effects.saveStyle(i),t.isFunction(e)&&e()};return t.fx.off||!a?c?this[c](n.duration,l):this.each((function(){l&&l.call(this)})):!1===o?this.each(h).each(i):this.queue(r,h).queue(r,i)},show:function(t){return function(n){if(i(n))return t.apply(this,arguments);var a=e.apply(this,arguments);return a.mode="show",this.effect.call(this,a)}}(t.fn.show),hide:function(t){return function(n){if(i(n))return t.apply(this,arguments);var a=e.apply(this,arguments);return a.mode="hide",this.effect.call(this,a)}}(t.fn.hide),toggle:function(t){return function(n){if(i(n)||"boolean"==typeof n)return t.apply(this,arguments);var a=e.apply(this,arguments);return a.mode="toggle",this.effect.call(this,a)}}(t.fn.toggle),cssUnit:function(e){var i=this.css(e),n=[];return t.each(["em","px","%","pt"],(function(t,e){i.indexOf(e)>0&&(n=[parseFloat(i),e])})),n},cssClip:function(t){return t?this.css("clip","rect("+t.top+"px "+t.right+"px "+t.bottom+"px "+t.left+"px)"):n(this.css("clip"),this)},transfer:function(e,i){var n=t(this),a=t(e.to),s="fixed"===a.css("position"),o=t("body"),r=s?o.scrollTop():0,l=s?o.scrollLeft():0,c=a.offset(),d={top:c.top-r,left:c.left-l,height:a.innerHeight(),width:a.innerWidth()},u=n.offset(),h=t("<div class='ui-effects-transfer'></div>").appendTo("body").addClass(e.className).css({top:u.top-r,left:u.left-l,height:n.innerHeight(),width:n.innerWidth(),position:s?"fixed":"absolute"}).animate(d,e.duration,e.easing,(function(){h.remove(),t.isFunction(i)&&i()}))}}),t.fx.step.clip=function(e){e.clipInit||(e.start=t(e.elem).cssClip(),"string"==typeof e.end&&(e.end=n(e.end,e.elem)),e.clipInit=!0),t(e.elem).cssClip({top:e.pos*(e.end.top-e.start.top)+e.start.top,right:e.pos*(e.end.right-e.start.right)+e.start.right,bottom:e.pos*(e.end.bottom-e.start.bottom)+e.start.bottom,left:e.pos*(e.end.left-e.start.left)+e.start.left})}}(),function(){var e={};t.each(["Quad","Cubic","Quart","Quint","Expo"],(function(t,i){e[i]=function(e){return Math.pow(e,t+2)}})),t.extend(e,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,i=4;((e=Math.pow(2,--i))-1)/11>t;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*e-2)/22-t,2)}}),t.each(e,(function(e,i){t.easing["easeIn"+e]=i,t.easing["easeOut"+e]=function(t){return 1-i(1-t)},t.easing["easeInOut"+e]=function(t){return.5>t?i(2*t)/2:1-i(-2*t+2)/2}}))}();t.effects;t.effects.define("blind","hide",(function(e,i){var n={up:["bottom","top"],vertical:["bottom","top"],down:["top","bottom"],left:["right","left"],horizontal:["right","left"],right:["left","right"]},a=t(this),s=e.direction||"up",o=a.cssClip(),r={clip:t.extend({},o)},l=t.effects.createPlaceholder(a);r.clip[n[s][0]]=r.clip[n[s][1]],"show"===e.mode&&(a.cssClip(r.clip),l&&l.css(t.effects.clipToBox(r)),r.clip=o),l&&l.animate(t.effects.clipToBox(r),e.duration,e.easing),a.animate(r,{queue:!1,duration:e.duration,easing:e.easing,complete:i})})),t.effects.define("bounce",(function(e,i){var n,a,s,o=t(this),r=e.mode,l="hide"===r,c="show"===r,d=e.direction||"up",u=e.distance,h=e.times||5,p=2*h+(c||l?1:0),f=e.duration/p,m=e.easing,g="up"===d||"down"===d?"top":"left",v="up"===d||"left"===d,b=0,y=o.queue().length;for(t.effects.createPlaceholder(o),s=o.css(g),u||(u=o["top"===g?"outerHeight":"outerWidth"]()/3),c&&((a={opacity:1})[g]=s,o.css("opacity",0).css(g,v?2*-u:2*u).animate(a,f,m)),l&&(u/=Math.pow(2,h-1)),(a={})[g]=s;h>b;b++)(n={})[g]=(v?"-=":"+=")+u,o.animate(n,f,m).animate(a,f,m),u=l?2*u:u/2;l&&((n={opacity:0})[g]=(v?"-=":"+=")+u,o.animate(n,f,m)),o.queue(i),t.effects.unshift(o,y,p+1)})),t.effects.define("clip","hide",(function(e,i){var n,a={},s=t(this),o=e.direction||"vertical",r="both"===o,l=r||"horizontal"===o,c=r||"vertical"===o;n=s.cssClip(),a.clip={top:c?(n.bottom-n.top)/2:n.top,right:l?(n.right-n.left)/2:n.right,bottom:c?(n.bottom-n.top)/2:n.bottom,left:l?(n.right-n.left)/2:n.left},t.effects.createPlaceholder(s),"show"===e.mode&&(s.cssClip(a.clip),a.clip=n),s.animate(a,{queue:!1,duration:e.duration,easing:e.easing,complete:i})})),t.effects.define("drop","hide",(function(e,i){var n,a=t(this),s="show"===e.mode,o=e.direction||"left",r="up"===o||"down"===o?"top":"left",l="up"===o||"left"===o?"-=":"+=",c="+="===l?"-=":"+=",d={opacity:0};t.effects.createPlaceholder(a),n=e.distance||a["top"===r?"outerHeight":"outerWidth"](!0)/2,d[r]=l+n,s&&(a.css(d),d[r]=c+n,d.opacity=1),a.animate(d,{queue:!1,duration:e.duration,easing:e.easing,complete:i})})),t.effects.define("explode","hide",(function(e,i){function n(){v.push(this),v.length===d*u&&(h.css({visibility:"visible"}),t(v).remove(),i())}var a,s,o,r,l,c,d=e.pieces?Math.round(Math.sqrt(e.pieces)):3,u=d,h=t(this),p="show"===e.mode,f=h.show().css("visibility","hidden").offset(),m=Math.ceil(h.outerWidth()/u),g=Math.ceil(h.outerHeight()/d),v=[];for(a=0;d>a;a++)for(r=f.top+a*g,c=a-(d-1)/2,s=0;u>s;s++)o=f.left+s*m,l=s-(u-1)/2,h.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-s*m,top:-a*g}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:m,height:g,left:o+(p?l*m:0),top:r+(p?c*g:0),opacity:p?0:1}).animate({left:o+(p?0:l*m),top:r+(p?0:c*g),opacity:p?1:0},e.duration||500,e.easing,n)})),t.effects.define("fade","toggle",(function(e,i){var n="show"===e.mode;t(this).css("opacity",n?0:1).animate({opacity:n?1:0},{queue:!1,duration:e.duration,easing:e.easing,complete:i})})),t.effects.define("fold","hide",(function(e,i){var n=t(this),a=e.mode,s="show"===a,o="hide"===a,r=e.size||15,l=/([0-9]+)%/.exec(r),c=!!e.horizFirst?["right","bottom"]:["bottom","right"],d=e.duration/2,u=t.effects.createPlaceholder(n),h=n.cssClip(),p={clip:t.extend({},h)},f={clip:t.extend({},h)},m=[h[c[0]],h[c[1]]],g=n.queue().length;l&&(r=parseInt(l[1],10)/100*m[o?0:1]),p.clip[c[0]]=r,f.clip[c[0]]=r,f.clip[c[1]]=0,s&&(n.cssClip(f.clip),u&&u.css(t.effects.clipToBox(f)),f.clip=h),n.queue((function(i){u&&u.animate(t.effects.clipToBox(p),d,e.easing).animate(t.effects.clipToBox(f),d,e.easing),i()})).animate(p,d,e.easing).animate(f,d,e.easing).queue(i),t.effects.unshift(n,g,4)})),t.effects.define("highlight","show",(function(e,i){var n=t(this),a={backgroundColor:n.css("backgroundColor")};"hide"===e.mode&&(a.opacity=0),t.effects.saveStyle(n),n.css({backgroundImage:"none",backgroundColor:e.color||"#ffff99"}).animate(a,{queue:!1,duration:e.duration,easing:e.easing,complete:i})})),t.effects.define("size",(function(e,i){var n,a,s,o=t(this),r=["fontSize"],l=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],c=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],d=e.mode,u="effect"!==d,h=e.scale||"both",p=e.origin||["middle","center"],f=o.css("position"),m=o.position(),g=t.effects.scaledDimensions(o),v=e.from||g,b=e.to||t.effects.scaledDimensions(o,0);t.effects.createPlaceholder(o),"show"===d&&(s=v,v=b,b=s),a={from:{y:v.height/g.height,x:v.width/g.width},to:{y:b.height/g.height,x:b.width/g.width}},("box"===h||"both"===h)&&(a.from.y!==a.to.y&&(v=t.effects.setTransition(o,l,a.from.y,v),b=t.effects.setTransition(o,l,a.to.y,b)),a.from.x!==a.to.x&&(v=t.effects.setTransition(o,c,a.from.x,v),b=t.effects.setTransition(o,c,a.to.x,b))),("content"===h||"both"===h)&&a.from.y!==a.to.y&&(v=t.effects.setTransition(o,r,a.from.y,v),b=t.effects.setTransition(o,r,a.to.y,b)),p&&(n=t.effects.getBaseline(p,g),v.top=(g.outerHeight-v.outerHeight)*n.y+m.top,v.left=(g.outerWidth-v.outerWidth)*n.x+m.left,b.top=(g.outerHeight-b.outerHeight)*n.y+m.top,b.left=(g.outerWidth-b.outerWidth)*n.x+m.left),o.css(v),("content"===h||"both"===h)&&(l=l.concat(["marginTop","marginBottom"]).concat(r),c=c.concat(["marginLeft","marginRight"]),o.find("*[width]").each((function(){var i=t(this),n=t.effects.scaledDimensions(i),s={height:n.height*a.from.y,width:n.width*a.from.x,outerHeight:n.outerHeight*a.from.y,outerWidth:n.outerWidth*a.from.x},o={height:n.height*a.to.y,width:n.width*a.to.x,outerHeight:n.height*a.to.y,outerWidth:n.width*a.to.x};a.from.y!==a.to.y&&(s=t.effects.setTransition(i,l,a.from.y,s),o=t.effects.setTransition(i,l,a.to.y,o)),a.from.x!==a.to.x&&(s=t.effects.setTransition(i,c,a.from.x,s),o=t.effects.setTransition(i,c,a.to.x,o)),u&&t.effects.saveStyle(i),i.css(s),i.animate(o,e.duration,e.easing,(function(){u&&t.effects.restoreStyle(i)}))}))),o.animate(b,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){var e=o.offset();0===b.opacity&&o.css("opacity",v.opacity),u||(o.css("position","static"===f?"relative":f).offset(e),t.effects.saveStyle(o)),i()}})})),t.effects.define("scale",(function(e,i){var n=t(this),a=e.mode,s=parseInt(e.percent,10)||(0===parseInt(e.percent,10)||"effect"!==a?0:100),o=t.extend(!0,{from:t.effects.scaledDimensions(n),to:t.effects.scaledDimensions(n,s,e.direction||"both"),origin:e.origin||["middle","center"]},e);e.fade&&(o.from.opacity=1,o.to.opacity=0),t.effects.effect.size.call(this,o,i)})),t.effects.define("puff","hide",(function(e,i){var n=t.extend(!0,{},e,{fade:!0,percent:parseInt(e.percent,10)||150});t.effects.effect.scale.call(this,n,i)})),t.effects.define("pulsate","show",(function(e,i){var n=t(this),a=e.mode,s="show"===a,o=s||"hide"===a,r=2*(e.times||5)+(o?1:0),l=e.duration/r,c=0,d=1,u=n.queue().length;for((s||!n.is(":visible"))&&(n.css("opacity",0).show(),c=1);r>d;d++)n.animate({opacity:c},l,e.easing),c=1-c;n.animate({opacity:c},l,e.easing),n.queue(i),t.effects.unshift(n,u,r+1)})),t.effects.define("shake",(function(e,i){var n=1,a=t(this),s=e.direction||"left",o=e.distance||20,r=e.times||3,l=2*r+1,c=Math.round(e.duration/l),d="up"===s||"down"===s?"top":"left",u="up"===s||"left"===s,h={},p={},f={},m=a.queue().length;for(t.effects.createPlaceholder(a),h[d]=(u?"-=":"+=")+o,p[d]=(u?"+=":"-=")+2*o,f[d]=(u?"-=":"+=")+2*o,a.animate(h,c,e.easing);r>n;n++)a.animate(p,c,e.easing).animate(f,c,e.easing);a.animate(p,c,e.easing).animate(h,c/2,e.easing).queue(i),t.effects.unshift(a,m,l+1)})),t.effects.define("slide","show",(function(e,i){var n,a,s=t(this),o={up:["bottom","top"],down:["top","bottom"],left:["right","left"],right:["left","right"]},r=e.mode,l=e.direction||"left",c="up"===l||"down"===l?"top":"left",d="up"===l||"left"===l,u=e.distance||s["top"===c?"outerHeight":"outerWidth"](!0),h={};t.effects.createPlaceholder(s),n=s.cssClip(),a=s.position()[c],h[c]=(d?-1:1)*u+a,h.clip=s.cssClip(),h.clip[o[l][1]]=h.clip[o[l][0]],"show"===r&&(s.cssClip(h.clip),s.css(c,h[c]),h.clip=n,h[c]=a),s.animate(h,{queue:!1,duration:e.duration,easing:e.easing,complete:i})})),!1!==t.uiBackCompat&&t.effects.define("transfer",(function(e,i){t(this).transfer(e,i)})),t.ui.focusable=function(e,i){var n,a,s,o,r,l=e.nodeName.toLowerCase();return"area"===l?(a=(n=e.parentNode).name,!(!e.href||!a||"map"!==n.nodeName.toLowerCase())&&((s=t("img[usemap='#"+a+"']")).length>0&&s.is(":visible"))):(/^(input|select|textarea|button|object)$/.test(l)?(o=!e.disabled)&&((r=t(e).closest("fieldset")[0])&&(o=!r.disabled)):o="a"===l&&e.href||i,o&&t(e).is(":visible")&&function(t){for(var e=t.css("visibility");"inherit"===e;)e=(t=t.parent()).css("visibility");return"hidden"!==e}(t(e)))},t.extend(t.expr[":"],{focusable:function(e){return t.ui.focusable(e,null!=t.attr(e,"tabindex"))}}),t.ui.focusable,t.fn.form=function(){return"string"==typeof this[0].form?this.closest("form"):t(this[0].form)},t.ui.formResetMixin={_formResetHandler:function(){var e=t(this);setTimeout((function(){var i=e.data("ui-form-reset-instances");t.each(i,(function(){this.refresh()}))}))},_bindFormResetHandler:function(){if(this.form=this.element.form(),this.form.length){var t=this.form.data("ui-form-reset-instances")||[];t.length||this.form.on("reset.ui-form-reset",this._formResetHandler),t.push(this),this.form.data("ui-form-reset-instances",t)}},_unbindFormResetHandler:function(){if(this.form.length){var e=this.form.data("ui-form-reset-instances");e.splice(t.inArray(this,e),1),e.length?this.form.data("ui-form-reset-instances",e):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset")}}},"1.7"===t.fn.jquery.substring(0,3)&&(t.each(["Width","Height"],(function(e,i){function n(e,i,n,s){return t.each(a,(function(){i-=parseFloat(t.css(e,"padding"+this))||0,n&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),s&&(i-=parseFloat(t.css(e,"margin"+this))||0)})),i}var a="Width"===i?["Left","Right"]:["Top","Bottom"],s=i.toLowerCase(),o={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+i]=function(e){return void 0===e?o["inner"+i].call(this):this.each((function(){t(this).css(s,n(this,e)+"px")}))},t.fn["outer"+i]=function(e,a){return"number"!=typeof e?o["outer"+i].call(this,e):this.each((function(){t(this).css(s,n(this,e,!0,a)+"px")}))}})),t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},t.ui.escapeSelector=function(){var t=/([!"#$%&'()*+,.\/:;<=>?@[\]^`{|}~])/g;return function(e){return e.replace(t,"\\$1")}}(),t.fn.labels=function(){var e,i,n,a,s;return this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(a=this.eq(0).parents("label"),(n=this.attr("id"))&&(s=(e=this.eq(0).parents().last()).add(e.length?e.siblings():this.siblings()),i="label[for='"+t.ui.escapeSelector(n)+"']",a=a.add(s.find(i).addBack(i))),this.pushStack(a))},t.fn.scrollParent=function(e){var i=this.css("position"),n="absolute"===i,a=e?/(auto|scroll|hidden)/:/(auto|scroll)/,s=this.parents().filter((function(){var e=t(this);return(!n||"static"!==e.css("position"))&&a.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))})).eq(0);return"fixed"!==i&&s.length?s:t(this[0].ownerDocument||document)},t.extend(t.expr[":"],{tabbable:function(e){var i=t.attr(e,"tabindex"),n=null!=i;return(!n||i>=0)&&t.ui.focusable(e,n)}}),t.fn.extend({uniqueId:function(){var t=0;return function(){return this.each((function(){this.id||(this.id="ui-id-"+ ++t)}))}}(),removeUniqueId:function(){return this.each((function(){/^ui-id-\d+$/.test(this.id)&&t(this).removeAttr("id")}))}}),t.widget("ui.accordion",{version:"1.12.1",options:{active:0,animate:{},classes:{"ui-accordion-header":"ui-corner-top","ui-accordion-header-collapsed":"ui-corner-all","ui-accordion-content":"ui-corner-bottom"},collapsible:!1,event:"click",header:"> li > :first-child, > :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var e=this.options;this.prevShow=this.prevHide=t(),this._addClass("ui-accordion","ui-widget ui-helper-reset"),this.element.attr("role","tablist"),e.collapsible||!1!==e.active&&null!=e.active||(e.active=0),this._processPanels(),0>e.active&&(e.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():t()}},_createIcons:function(){var e,i,n=this.options.icons;n&&(e=t("<span>"),this._addClass(e,"ui-accordion-header-icon","ui-icon "+n.header),e.prependTo(this.headers),i=this.active.children(".ui-accordion-header-icon"),this._removeClass(i,n.header)._addClass(i,null,n.activeHeader)._addClass(this.headers,"ui-accordion-icons"))},_destroyIcons:function(){this._removeClass(this.headers,"ui-accordion-icons"),this.headers.children(".ui-accordion-header-icon").remove()},_destroy:function(){var t;this.element.removeAttr("role"),this.headers.removeAttr("role aria-expanded aria-selected aria-controls tabIndex").removeUniqueId(),this._destroyIcons(),t=this.headers.next().css("display","").removeAttr("role aria-hidden aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&t.css("height","")},_setOption:function(t,e){return"active"===t?void this._activate(e):("event"===t&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(e)),this._super(t,e),"collapsible"!==t||e||!1!==this.options.active||this._activate(0),void("icons"===t&&(this._destroyIcons(),e&&this._createIcons())))},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",t),this._toggleClass(null,"ui-state-disabled",!!t),this._toggleClass(this.headers.add(this.headers.next()),null,"ui-state-disabled",!!t)},_keydown:function(e){if(!e.altKey&&!e.ctrlKey){var i=t.ui.keyCode,n=this.headers.length,a=this.headers.index(e.target),s=!1;switch(e.keyCode){case i.RIGHT:case i.DOWN:s=this.headers[(a+1)%n];break;case i.LEFT:case i.UP:s=this.headers[(a-1+n)%n];break;case i.SPACE:case i.ENTER:this._eventHandler(e);break;case i.HOME:s=this.headers[0];break;case i.END:s=this.headers[n-1]}s&&(t(e.target).attr("tabIndex",-1),t(s).attr("tabIndex",0),t(s).trigger("focus"),e.preventDefault())}},_panelKeyDown:function(e){e.keyCode===t.ui.keyCode.UP&&e.ctrlKey&&t(e.currentTarget).prev().trigger("focus")},refresh:function(){var e=this.options;this._processPanels(),!1===e.active&&!0===e.collapsible||!this.headers.length?(e.active=!1,this.active=t()):!1===e.active?this._activate(0):this.active.length&&!t.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(e.active=!1,this.active=t()):this._activate(Math.max(0,e.active-1)):e.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var t=this.headers,e=this.panels;this.headers=this.element.find(this.options.header),this._addClass(this.headers,"ui-accordion-header ui-accordion-header-collapsed","ui-state-default"),this.panels=this.headers.next().filter(":not(.ui-accordion-content-active)").hide(),this._addClass(this.panels,"ui-accordion-content","ui-helper-reset ui-widget-content"),e&&(this._off(t.not(this.headers)),this._off(e.not(this.panels)))},_refresh:function(){var e,i=this.options,n=i.heightStyle,a=this.element.parent();this.active=this._findActive(i.active),this._addClass(this.active,"ui-accordion-header-active","ui-state-active")._removeClass(this.active,"ui-accordion-header-collapsed"),this._addClass(this.active.next(),"ui-accordion-content-active"),this.active.next().show(),this.headers.attr("role","tab").each((function(){var e=t(this),i=e.uniqueId().attr("id"),n=e.next(),a=n.uniqueId().attr("id");e.attr("aria-controls",a),n.attr("aria-labelledby",i)})).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(i.event),"fill"===n?(e=a.height(),this.element.siblings(":visible").each((function(){var i=t(this),n=i.css("position");"absolute"!==n&&"fixed"!==n&&(e-=i.outerHeight(!0))})),this.headers.each((function(){e-=t(this).outerHeight(!0)})),this.headers.next().each((function(){t(this).height(Math.max(0,e-t(this).innerHeight()+t(this).height()))})).css("overflow","auto")):"auto"===n&&(e=0,this.headers.next().each((function(){var i=t(this).is(":visible");i||t(this).show(),e=Math.max(e,t(this).css("height","").height()),i||t(this).hide()})).height(e))},_activate:function(e){var i=this._findActive(e)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return"number"==typeof e?this.headers.eq(e):t()},_setupEvents:function(e){var i={keydown:"_keydown"};e&&t.each(e.split(" "),(function(t,e){i[e]="_eventHandler"})),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(e){var i,n,a=this.options,s=this.active,o=t(e.currentTarget),r=o[0]===s[0],l=r&&a.collapsible,c=l?t():o.next(),d=s.next(),u={oldHeader:s,oldPanel:d,newHeader:l?t():o,newPanel:c};e.preventDefault(),r&&!a.collapsible||!1===this._trigger("beforeActivate",e,u)||(a.active=!l&&this.headers.index(o),this.active=r?t():o,this._toggle(u),this._removeClass(s,"ui-accordion-header-active","ui-state-active"),a.icons&&(i=s.children(".ui-accordion-header-icon"),this._removeClass(i,null,a.icons.activeHeader)._addClass(i,null,a.icons.header)),r||(this._removeClass(o,"ui-accordion-header-collapsed")._addClass(o,"ui-accordion-header-active","ui-state-active"),a.icons&&(n=o.children(".ui-accordion-header-icon"),this._removeClass(n,null,a.icons.header)._addClass(n,null,a.icons.activeHeader)),this._addClass(o.next(),"ui-accordion-content-active")))},_toggle:function(e){var i=e.newPanel,n=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=n,this.options.animate?this._animate(i,n,e):(n.hide(),i.show(),this._toggleComplete(e)),n.attr({"aria-hidden":"true"}),n.prev().attr({"aria-selected":"false","aria-expanded":"false"}),i.length&&n.length?n.prev().attr({tabIndex:-1,"aria-expanded":"false"}):i.length&&this.headers.filter((function(){return 0===parseInt(t(this).attr("tabIndex"),10)})).attr("tabIndex",-1),i.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(t,e,i){var n,a,s,o=this,r=0,l=t.css("box-sizing"),c=t.length&&(!e.length||t.index()<e.index()),d=this.options.animate||{},u=c&&d.down||d,h=function(){o._toggleComplete(i)};return"number"==typeof u&&(s=u),"string"==typeof u&&(a=u),a=a||u.easing||d.easing,s=s||u.duration||d.duration,e.length?t.length?(n=t.show().outerHeight(),e.animate(this.hideProps,{duration:s,easing:a,step:function(t,e){e.now=Math.round(t)}}),void t.hide().animate(this.showProps,{duration:s,easing:a,complete:h,step:function(t,i){i.now=Math.round(t),"height"!==i.prop?"content-box"===l&&(r+=i.now):"content"!==o.options.heightStyle&&(i.now=Math.round(n-e.outerHeight()-r),r=0)}})):e.animate(this.hideProps,s,a,h):t.animate(this.showProps,s,a,h)},_toggleComplete:function(t){var e=t.oldPanel,i=e.prev();this._removeClass(e,"ui-accordion-content-active"),this._removeClass(i,"ui-accordion-header-active")._addClass(i,"ui-accordion-header-collapsed"),e.length&&(e.parent()[0].className=e.parent()[0].className),this._trigger("activate",null,t)}}),t.ui.safeActiveElement=function(t){var e;try{e=t.activeElement}catch(i){e=t.body}return e||(e=t.body),e.nodeName||(e=t.body),e},t.widget("ui.menu",{version:"1.12.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(t){t.preventDefault()},"click .ui-menu-item":function(e){var i=t(e.target),n=t(t.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(e),e.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(e):!this.element.is(":focus")&&n.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){if(!this.previousFilter){var i=t(e.target).closest(".ui-menu-item"),n=t(e.currentTarget);i[0]===n[0]&&(this._removeClass(n.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(e,n))}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var i=this.active||this.element.find(this.options.items).eq(0);e||this.focus(t,i)},blur:function(e){this._delay((function(){!t.contains(this.element[0],t.ui.safeActiveElement(this.document[0]))&&this.collapseAll(e)}))},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){this._closeOnDocumentClick(t)&&this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){var e=this.element.find(".ui-menu-item").removeAttr("role aria-disabled").children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),e.children().each((function(){var e=t(this);e.data("ui-menu-submenu-caret")&&e.remove()}))},_keydown:function(e){var i,n,a,s,o=!0;switch(e.keyCode){case t.ui.keyCode.PAGE_UP:this.previousPage(e);break;case t.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case t.ui.keyCode.HOME:this._move("first","first",e);break;case t.ui.keyCode.END:this._move("last","last",e);break;case t.ui.keyCode.UP:this.previous(e);break;case t.ui.keyCode.DOWN:this.next(e);break;case t.ui.keyCode.LEFT:this.collapse(e);break;case t.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case t.ui.keyCode.ENTER:case t.ui.keyCode.SPACE:this._activate(e);break;case t.ui.keyCode.ESCAPE:this.collapse(e);break;default:o=!1,n=this.previousFilter||"",s=!1,a=e.keyCode>=96&&105>=e.keyCode?""+(e.keyCode-96):String.fromCharCode(e.keyCode),clearTimeout(this.filterTimer),a===n?s=!0:a=n+a,i=this._filterMenuItems(a),(i=s&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i).length||(a=String.fromCharCode(e.keyCode),i=this._filterMenuItems(a)),i.length?(this.focus(e,i),this.previousFilter=a,this.filterTimer=this._delay((function(){delete this.previousFilter}),1e3)):delete this.previousFilter}o&&e.preventDefault()},_activate:function(t){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(t):this.select(t))},refresh:function(){var e,i,n,a,s=this,o=this.options.icons.submenu,r=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),i=r.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each((function(){var e=t(this),i=e.prev(),n=t("<span>").data("ui-menu-submenu-caret",!0);s._addClass(n,"ui-menu-icon","ui-icon "+o),i.attr("aria-haspopup","true").prepend(n),e.attr("aria-labelledby",i.attr("id"))})),this._addClass(i,"ui-menu","ui-widget ui-widget-content ui-front"),(e=r.add(this.element).find(this.options.items)).not(".ui-menu-item").each((function(){var e=t(this);s._isDivider(e)&&s._addClass(e,"ui-menu-divider","ui-widget-content")})),a=(n=e.not(".ui-menu-item, .ui-menu-divider")).children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(n,"ui-menu-item")._addClass(a,"ui-menu-item-wrapper"),e.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!t.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(t,e){if("icons"===t){var i=this.element.find(".ui-menu-icon");this._removeClass(i,null,this.options.icons.submenu)._addClass(i,null,e.submenu)}this._super(t,e)},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",t+""),this._toggleClass(null,"ui-state-disabled",!!t)},focus:function(t,e){var i,n,a;this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),n=this.active.children(".ui-menu-item-wrapper"),this._addClass(n,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",n.attr("id")),a=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(a,null,"ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay((function(){this._close()}),this.delay),(i=e.children(".ui-menu")).length&&t&&/^mouse/.test(t.type)&&this._startOpening(i),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})},_scrollIntoView:function(e){var i,n,a,s,o,r;this._hasScroll()&&(i=parseFloat(t.css(this.activeMenu[0],"borderTopWidth"))||0,n=parseFloat(t.css(this.activeMenu[0],"paddingTop"))||0,a=e.offset().top-this.activeMenu.offset().top-i-n,s=this.activeMenu.scrollTop(),o=this.activeMenu.height(),r=e.outerHeight(),0>a?this.activeMenu.scrollTop(s+a):a+r>o&&this.activeMenu.scrollTop(s+a-o+r))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",t,{item:this.active}),this.active=null)},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay((function(){this._close(),this._open(t)}),this.delay))},_open:function(e){var i=t.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(e,i){clearTimeout(this.timer),this.timer=this._delay((function(){var n=i?this.element:t(e&&e.target).closest(this.element.find(".ui-menu"));n.length||(n=this.element),this._close(n),this.blur(e),this._removeClass(n.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=n}),this.delay)},_close:function(t){t||(t=this.active?this.active.parent():this.element),t.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(e){return!t(e.target).closest(".ui-menu").length},_isDivider:function(t){return!/[^\-\u2014\u2013\s]/.test(t.text())},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();e&&e.length&&(this._open(e.parent()),this._delay((function(){this.focus(t,e)})))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(t,e,i){var n;this.active&&(n="first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[t+"All"](".ui-menu-item").eq(0)),n&&n.length&&this.active||(n=this.activeMenu.find(this.options.items)[e]()),this.focus(i,n)},nextPage:function(e){var i,n,a;return this.active?void(this.isLastItem()||(this._hasScroll()?(n=this.active.offset().top,a=this.element.height(),this.active.nextAll(".ui-menu-item").each((function(){return 0>(i=t(this)).offset().top-n-a})),this.focus(e,i)):this.focus(e,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(e)},previousPage:function(e){var i,n,a;return this.active?void(this.isFirstItem()||(this._hasScroll()?(n=this.active.offset().top,a=this.element.height(),this.active.prevAll(".ui-menu-item").each((function(){return(i=t(this)).offset().top-n+a>0})),this.focus(e,i)):this.focus(e,this.activeMenu.find(this.options.items).first()))):void this.next(e)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||t(e.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,i)},_filterMenuItems:function(e){var i=e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),n=RegExp("^"+i,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter((function(){return n.test(t.trim(t(this).children(".ui-menu-item-wrapper").text()))}))}}),t.widget("ui.autocomplete",{version:"1.12.1",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var e,i,n,a=this.element[0].nodeName.toLowerCase(),s="textarea"===a,o="input"===a;this.isMultiLine=s||!o&&this._isContentEditable(this.element),this.valueMethod=this.element[s||o?"val":"text"],this.isNewMenu=!0,this._addClass("ui-autocomplete-input"),this.element.attr("autocomplete","off"),this._on(this.element,{keydown:function(a){if(this.element.prop("readOnly"))return e=!0,n=!0,void(i=!0);e=!1,n=!1,i=!1;var s=t.ui.keyCode;switch(a.keyCode){case s.PAGE_UP:e=!0,this._move("previousPage",a);break;case s.PAGE_DOWN:e=!0,this._move("nextPage",a);break;case s.UP:e=!0,this._keyEvent("previous",a);break;case s.DOWN:e=!0,this._keyEvent("next",a);break;case s.ENTER:this.menu.active&&(e=!0,a.preventDefault(),this.menu.select(a));break;case s.TAB:this.menu.active&&this.menu.select(a);break;case s.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(a),a.preventDefault());break;default:i=!0,this._searchTimeout(a)}},keypress:function(n){if(e)return e=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&n.preventDefault());if(!i){var a=t.ui.keyCode;switch(n.keyCode){case a.PAGE_UP:this._move("previousPage",n);break;case a.PAGE_DOWN:this._move("nextPage",n);break;case a.UP:this._keyEvent("previous",n);break;case a.DOWN:this._keyEvent("next",n)}}},input:function(t){return n?(n=!1,void t.preventDefault()):void this._searchTimeout(t)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(t),void this._change(t))}}),this._initSource(),this.menu=t("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._addClass(this.menu.element,"ui-autocomplete","ui-front"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay((function(){delete this.cancelBlur,this.element[0]!==t.ui.safeActiveElement(this.document[0])&&this.element.trigger("focus")}))},menufocus:function(e,i){var n,a;return this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type))?(this.menu.blur(),void this.document.one("mousemove",(function(){t(e.target).trigger(e.originalEvent)}))):(a=i.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",e,{item:a})&&e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(a.value),void((n=i.item.attr("aria-label")||a.value)&&t.trim(n).length&&(this.liveRegion.children().hide(),t("<div>").text(n).appendTo(this.liveRegion))))},menuselect:function(e,i){var n=i.item.data("ui-autocomplete-item"),a=this.previous;this.element[0]!==t.ui.safeActiveElement(this.document[0])&&(this.element.trigger("focus"),this.previous=a,this._delay((function(){this.previous=a,this.selectedItem=n}))),!1!==this._trigger("select",e,{item:n})&&this._value(n.value),this.term=this._value(),this.close(e),this.selectedItem=n}}),this.liveRegion=t("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),"source"===t&&this._initSource(),"appendTo"===t&&this.menu.element.appendTo(this._appendTo()),"disabled"===t&&e&&this.xhr&&this.xhr.abort()},_isEventTargetInWidget:function(e){var i=this.menu.element[0];return e.target===this.element[0]||e.target===i||t.contains(i,e.target)},_closeOnClickOutside:function(t){this._isEventTargetInWidget(t)||this.close()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(".ui-front, dialog")),e.length||(e=this.document[0].body),e},_initSource:function(){var e,i,n=this;t.isArray(this.options.source)?(e=this.options.source,this.source=function(i,n){n(t.ui.autocomplete.filter(e,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(e,a){n.xhr&&n.xhr.abort(),n.xhr=t.ajax({url:i,data:e,dataType:"json",success:function(t){a(t)},error:function(){a([])}})}):this.source=this.options.source},_searchTimeout:function(t){clearTimeout(this.searching),this.searching=this._delay((function(){var e=this.term===this._value(),i=this.menu.element.is(":visible"),n=t.altKey||t.ctrlKey||t.metaKey||t.shiftKey;(!e||e&&!i&&!n)&&(this.selectedItem=null,this.search(null,t))}),this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):!1!==this._trigger("search",e)?this._search(t):void 0},_search:function(t){this.pending++,this._addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:t},this._response())},_response:function(){var e=++this.requestIndex;return t.proxy((function(t){e===this.requestIndex&&this.__response(t),this.pending--,this.pending||this._removeClass("ui-autocomplete-loading")}),this)},__response:function(t){t&&(t=this._normalize(t)),this._trigger("response",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger("open")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this._off(this.document,"mousedown"),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",t))},_change:function(t){this.previous!==this._value()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:t.map(e,(function(e){return"string"==typeof e?{label:e,value:e}:t.extend({},e,{label:e.label||e.value,value:e.value||e.label})}))},_suggest:function(e){var i=this.menu.element.empty();this._renderMenu(i,e),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(t.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(),this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(e,i){var n=this;t.each(i,(function(t,i){n._renderItemData(e,i)}))},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-autocomplete-item",e)},_renderItem:function(e,i){return t("<li>").append(t("<div>").text(i.label)).appendTo(e)},_move:function(t,e){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[t](e):void this.search(null,e)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(t,e),e.preventDefault())},_isContentEditable:function(t){if(!t.length)return!1;var e=t.prop("contentEditable");return"inherit"===e?this._isContentEditable(t.parent()):"true"===e}}),t.extend(t.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,i){var n=RegExp(t.ui.autocomplete.escapeRegex(i),"i");return t.grep(e,(function(t){return n.test(t.label||t.value||t)}))}}),t.widget("ui.autocomplete",t.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(t){return t+(t>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.children().hide(),t("<div>").text(i).appendTo(this.liveRegion))}}),t.ui.autocomplete;var h,p=/ui-corner-([a-z]){2,6}/g;t.widget("ui.controlgroup",{version:"1.12.1",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:!0,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar"),this.refresh()},_destroy:function(){this._callChildMethod("destroy"),this.childWidgets.removeData("ui-controlgroup-data"),this.element.removeAttr("role"),this.options.items.controlgroupLabel&&this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()},_initWidgets:function(){var e=this,i=[];t.each(this.options.items,(function(n,a){var s,o={};return a?"controlgroupLabel"===n?((s=e.element.find(a)).each((function(){var e=t(this);e.children(".ui-controlgroup-label-contents").length||e.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")})),e._addClass(s,null,"ui-widget ui-widget-content ui-state-default"),void(i=i.concat(s.get()))):void(t.fn[n]&&(o=e["_"+n+"Options"]?e["_"+n+"Options"]("middle"):{classes:{}},e.element.find(a).each((function(){var a=t(this),s=a[n]("instance"),r=t.widget.extend({},o);if("button"!==n||!a.parent(".ui-spinner").length){s||(s=a[n]()[n]("instance")),s&&(r.classes=e._resolveClassesValues(r.classes,s)),a[n](r);var l=a[n]("widget");t.data(l[0],"ui-controlgroup-data",s||a[n]("instance")),i.push(l[0])}})))):void 0})),this.childWidgets=t(t.unique(i)),this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(e){this.childWidgets.each((function(){var i=t(this).data("ui-controlgroup-data");i&&i[e]&&i[e]()}))},_updateCornerClass:function(t,e){var i=this._buildSimpleOptions(e,"label").classes.label;this._removeClass(t,null,"ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all"),this._addClass(t,null,i)},_buildSimpleOptions:function(t,e){var i="vertical"===this.options.direction,n={classes:{}};return n.classes[e]={middle:"",first:"ui-corner-"+(i?"top":"left"),last:"ui-corner-"+(i?"bottom":"right"),only:"ui-corner-all"}[t],n},_spinnerOptions:function(t){var e=this._buildSimpleOptions(t,"ui-spinner");return e.classes["ui-spinner-up"]="",e.classes["ui-spinner-down"]="",e},_buttonOptions:function(t){return this._buildSimpleOptions(t,"ui-button")},_checkboxradioOptions:function(t){return this._buildSimpleOptions(t,"ui-checkboxradio-label")},_selectmenuOptions:function(t){var e="vertical"===this.options.direction;return{width:!!e&&"auto",classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(e?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(e?"top":"left")},last:{"ui-selectmenu-button-open":e?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(e?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[t]}},_resolveClassesValues:function(e,i){var n={};return t.each(e,(function(a){var s=i.options.classes[a]||"";s=t.trim(s.replace(p,"")),n[a]=(s+" "+e[a]).replace(/\s+/g," ")})),n},_setOption:function(t,e){return"direction"===t&&this._removeClass("ui-controlgroup-"+this.options.direction),this._super(t,e),"disabled"===t?void this._callChildMethod(e?"disable":"enable"):void this.refresh()},refresh:function(){var e,i=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction),"horizontal"===this.options.direction&&this._addClass(null,"ui-helper-clearfix"),this._initWidgets(),e=this.childWidgets,this.options.onlyVisible&&(e=e.filter(":visible")),e.length&&(t.each(["first","last"],(function(t,n){var a=e[n]().data("ui-controlgroup-data");if(a&&i["_"+a.widgetName+"Options"]){var s=i["_"+a.widgetName+"Options"](1===e.length?"only":n);s.classes=i._resolveClassesValues(s.classes,a),a.element[a.widgetName](s)}else i._updateCornerClass(e[n](),n)})),this._callChildMethod("refresh"))}}),t.widget("ui.checkboxradio",[t.ui.formResetMixin,{version:"1.12.1",options:{disabled:null,label:null,icon:!0,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var e,i,n=this,a=this._super()||{};return this._readType(),i=this.element.labels(),this.label=t(i[i.length-1]),this.label.length||t.error("No label found for checkboxradio widget"),this.originalLabel="",this.label.contents().not(this.element[0]).each((function(){n.originalLabel+=3===this.nodeType?t(this).text():this.outerHTML})),this.originalLabel&&(a.label=this.originalLabel),null!=(e=this.element[0].disabled)&&(a.disabled=e),a},_create:function(){var t=this.element[0].checked;this._bindFormResetHandler(),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled),this._setOption("disabled",this.options.disabled),this._addClass("ui-checkboxradio","ui-helper-hidden-accessible"),this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget"),"radio"===this.type&&this._addClass(this.label,"ui-checkboxradio-radio-label"),this.options.label&&this.options.label!==this.originalLabel?this._updateLabel():this.originalLabel&&(this.options.label=this.originalLabel),this._enhance(),t&&(this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active"),this.icon&&this._addClass(this.icon,null,"ui-state-hover")),this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var e=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type,"input"===e&&/radio|checkbox/.test(this.type)||t.error("Can't create checkboxradio on element.nodeName="+e+" and element.type="+this.type)},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var e=this.element[0].name,i="input[name='"+t.ui.escapeSelector(e)+"']";return e?(this.form.length?t(this.form[0].elements).filter(i):t(i).filter((function(){return 0===t(this).form().length}))).not(this.element):t([])},_toggleClasses:function(){var e=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",e),this.options.icon&&"checkbox"===this.type&&this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",e)._toggleClass(this.icon,null,"ui-icon-blank",!e),"radio"===this.type&&this._getRadioGroup().each((function(){var e=t(this).checkboxradio("instance");e&&e._removeClass(e.label,"ui-checkboxradio-checked","ui-state-active")}))},_destroy:function(){this._unbindFormResetHandler(),this.icon&&(this.icon.remove(),this.iconSpace.remove())},_setOption:function(t,e){return"label"!==t||e?(this._super(t,e),"disabled"===t?(this._toggleClass(this.label,null,"ui-state-disabled",e),void(this.element[0].disabled=e)):void this.refresh()):void 0},_updateIcon:function(e){var i="ui-icon ui-icon-background ";this.options.icon?(this.icon||(this.icon=t("<span>"),this.iconSpace=t("<span> </span>"),this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")),"checkbox"===this.type?(i+=e?"ui-icon-check ui-state-checked":"ui-icon-blank",this._removeClass(this.icon,null,e?"ui-icon-blank":"ui-icon-check")):i+="ui-icon-blank",this._addClass(this.icon,"ui-checkboxradio-icon",i),e||this._removeClass(this.icon,null,"ui-icon-check ui-state-checked"),this.icon.prependTo(this.label).after(this.iconSpace)):void 0!==this.icon&&(this.icon.remove(),this.iconSpace.remove(),delete this.icon)},_updateLabel:function(){var t=this.label.contents().not(this.element[0]);this.icon&&(t=t.not(this.icon[0])),this.iconSpace&&(t=t.not(this.iconSpace[0])),t.remove(),this.label.append(this.options.label)},refresh:function(){var t=this.element[0].checked,e=this.element[0].disabled;this._updateIcon(t),this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",t),null!==this.options.label&&this._updateLabel(),e!==this.options.disabled&&this._setOptions({disabled:e})}}]),t.ui.checkboxradio,t.widget("ui.button",{version:"1.12.1",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:!0},_getCreateOptions:function(){var t,e=this._super()||{};return this.isInput=this.element.is("input"),null!=(t=this.element[0].disabled)&&(e.disabled=t),this.originalLabel=this.isInput?this.element.val():this.element.html(),this.originalLabel&&(e.label=this.originalLabel),e},_create:function(){!this.option.showLabel&!this.options.icon&&(this.options.showLabel=!0),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled||!1),this.hasTitle=!!this.element.attr("title"),this.options.label&&this.options.label!==this.originalLabel&&(this.isInput?this.element.val(this.options.label):this.element.html(this.options.label)),this._addClass("ui-button","ui-widget"),this._setOption("disabled",this.options.disabled),this._enhance(),this.element.is("a")&&this._on({keyup:function(e){e.keyCode===t.ui.keyCode.SPACE&&(e.preventDefault(),this.element[0].click?this.element[0].click():this.element.trigger("click"))}})},_enhance:function(){this.element.is("button")||this.element.attr("role","button"),this.options.icon&&(this._updateIcon("icon",this.options.icon),this._updateTooltip())},_updateTooltip:function(){this.title=this.element.attr("title"),this.options.showLabel||this.title||this.element.attr("title",this.options.label)},_updateIcon:function(e,i){var n="iconPosition"!==e,a=n?this.options.iconPosition:i,s="top"===a||"bottom"===a;this.icon?n&&this._removeClass(this.icon,null,this.options.icon):(this.icon=t("<span>"),this._addClass(this.icon,"ui-button-icon","ui-icon"),this.options.showLabel||this._addClass("ui-button-icon-only")),n&&this._addClass(this.icon,null,i),this._attachIcon(a),s?(this._addClass(this.icon,null,"ui-widget-icon-block"),this.iconSpace&&this.iconSpace.remove()):(this.iconSpace||(this.iconSpace=t("<span> </span>"),this._addClass(this.iconSpace,"ui-button-icon-space")),this._removeClass(this.icon,null,"ui-wiget-icon-block"),this._attachIconSpace(a))},_destroy:function(){this.element.removeAttr("role"),this.icon&&this.icon.remove(),this.iconSpace&&this.iconSpace.remove(),this.hasTitle||this.element.removeAttr("title")},_attachIconSpace:function(t){this.icon[/^(?:end|bottom)/.test(t)?"before":"after"](this.iconSpace)},_attachIcon:function(t){this.element[/^(?:end|bottom)/.test(t)?"append":"prepend"](this.icon)},_setOptions:function(t){var e=void 0===t.showLabel?this.options.showLabel:t.showLabel,i=void 0===t.icon?this.options.icon:t.icon;e||i||(t.showLabel=!0),this._super(t)},_setOption:function(t,e){"icon"===t&&(e?this._updateIcon(t,e):this.icon&&(this.icon.remove(),this.iconSpace&&this.iconSpace.remove())),"iconPosition"===t&&this._updateIcon(t,e),"showLabel"===t&&(this._toggleClass("ui-button-icon-only",null,!e),this._updateTooltip()),"label"===t&&(this.isInput?this.element.val(e):(this.element.html(e),this.icon&&(this._attachIcon(this.options.iconPosition),this._attachIconSpace(this.options.iconPosition)))),this._super(t,e),"disabled"===t&&(this._toggleClass(null,"ui-state-disabled",e),this.element[0].disabled=e,e&&this.element.blur())},refresh:function(){var t=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOptions({disabled:t}),this._updateTooltip()}}),!1!==t.uiBackCompat&&(t.widget("ui.button",t.ui.button,{options:{text:!0,icons:{primary:null,secondary:null}},_create:function(){this.options.showLabel&&!this.options.text&&(this.options.showLabel=this.options.text),!this.options.showLabel&&this.options.text&&(this.options.text=this.options.showLabel),this.options.icon||!this.options.icons.primary&&!this.options.icons.secondary?this.options.icon&&(this.options.icons.primary=this.options.icon):this.options.icons.primary?this.options.icon=this.options.icons.primary:(this.options.icon=this.options.icons.secondary,this.options.iconPosition="end"),this._super()},_setOption:function(t,e){return"text"===t?void this._super("showLabel",e):("showLabel"===t&&(this.options.text=e),"icon"===t&&(this.options.icons.primary=e),"icons"===t&&(e.primary?(this._super("icon",e.primary),this._super("iconPosition","beginning")):e.secondary&&(this._super("icon",e.secondary),this._super("iconPosition","end"))),void this._superApply(arguments))}}),t.fn.button=function(e){return function(){return!this.length||this.length&&"INPUT"!==this[0].tagName||this.length&&"INPUT"===this[0].tagName&&"checkbox"!==this.attr("type")&&"radio"!==this.attr("type")?e.apply(this,arguments):(t.ui.checkboxradio||t.error("Checkboxradio widget missing"),0===arguments.length?this.checkboxradio({icon:!1}):this.checkboxradio.apply(this,arguments))}}(t.fn.button),t.fn.buttonset=function(){return t.ui.controlgroup||t.error("Controlgroup widget missing"),"option"===arguments[0]&&"items"===arguments[1]&&arguments[2]?this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]]):"option"===arguments[0]&&"items"===arguments[1]?this.controlgroup.apply(this,[arguments[0],"items.button"]):("object"==typeof arguments[0]&&arguments[0].items&&(arguments[0].items={button:arguments[0].items}),this.controlgroup.apply(this,arguments))}),t.ui.button,t.extend(t.ui,{datepicker:{version:"1.12.1"}}),t.extend(e.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return a(this._defaults,t||{}),this},_attachDatepicker:function(e,i){var n,a,s;a="div"===(n=e.nodeName.toLowerCase())||"span"===n,e.id||(this.uuid+=1,e.id="dp"+this.uuid),(s=this._newInst(t(e),a)).settings=t.extend({},i||{}),"input"===n?this._connectDatepicker(e,s):a&&this._inlineDatepicker(e,s)},_newInst:function(e,n){return{id:e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:n,dpDiv:n?i(t("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,i){var n=t(e);i.append=t([]),i.trigger=t([]),n.hasClass(this.markerClassName)||(this._attachments(n,i),n.addClass(this.markerClassName).on("keydown",this._doKeyDown).on("keypress",this._doKeyPress).on("keyup",this._doKeyUp),this._autoSize(i),t.data(e,"datepicker",i),i.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,i){var n,a,s,o=this._get(i,"appendText"),r=this._get(i,"isRTL");i.append&&i.append.remove(),o&&(i.append=t("<span class='"+this._appendClass+"'>"+o+"</span>"),e[r?"before":"after"](i.append)),e.off("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),("focus"===(n=this._get(i,"showOn"))||"both"===n)&&e.on("focus",this._showDatepicker),("button"===n||"both"===n)&&(a=this._get(i,"buttonText"),s=this._get(i,"buttonImage"),i.trigger=t(this._get(i,"buttonImageOnly")?t("<img/>").addClass(this._triggerClass).attr({src:s,alt:a,title:a}):t("<button type='button'></button>").addClass(this._triggerClass).html(s?t("<img/>").attr({src:s,alt:a,title:a}):a)),e[r?"before":"after"](i.trigger),i.trigger.on("click",(function(){return t.datepicker._datepickerShowing&&t.datepicker._lastInput===e[0]?t.datepicker._hideDatepicker():t.datepicker._datepickerShowing&&t.datepicker._lastInput!==e[0]?(t.datepicker._hideDatepicker(),t.datepicker._showDatepicker(e[0])):t.datepicker._showDatepicker(e[0]),!1})))},_autoSize:function(t){if(this._get(t,"autoSize")&&!t.inline){var e,i,n,a,s=new Date(2009,11,20),o=this._get(t,"dateFormat");o.match(/[DM]/)&&(e=function(t){for(i=0,n=0,a=0;t.length>a;a++)t[a].length>i&&(i=t[a].length,n=a);return n},s.setMonth(e(this._get(t,o.match(/MM/)?"monthNames":"monthNamesShort"))),s.setDate(e(this._get(t,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-s.getDay())),t.input.attr("size",this._formatDate(t,s).length)}},_inlineDatepicker:function(e,i){var n=t(e);n.hasClass(this.markerClassName)||(n.addClass(this.markerClassName).append(i.dpDiv),t.data(e,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(e),i.dpDiv.css("display","block"))},_dialogDatepicker:function(e,i,n,s,o){var r,l,c,d,u,h=this._dialogInst;return h||(this.uuid+=1,r="dp"+this.uuid,this._dialogInput=t("<input type='text' id='"+r+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.on("keydown",this._doKeyDown),t("body").append(this._dialogInput),(h=this._dialogInst=this._newInst(this._dialogInput,!1)).settings={},t.data(this._dialogInput[0],"datepicker",h)),a(h.settings,s||{}),i=i&&i.constructor===Date?this._formatDate(h,i):i,this._dialogInput.val(i),this._pos=o?o.length?o:[o.pageX,o.pageY]:null,this._pos||(l=document.documentElement.clientWidth,c=document.documentElement.clientHeight,d=document.documentElement.scrollLeft||document.body.scrollLeft,u=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[l/2-100+d,c/2-150+u]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),h.settings.onSelect=n,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),t.blockUI&&t.blockUI(this.dpDiv),t.data(this._dialogInput[0],"datepicker",h),this},_destroyDatepicker:function(e){var i,n=t(e),a=t.data(e,"datepicker");n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),t.removeData(e,"datepicker"),"input"===i?(a.append.remove(),a.trigger.remove(),n.removeClass(this.markerClassName).off("focus",this._showDatepicker).off("keydown",this._doKeyDown).off("keypress",this._doKeyPress).off("keyup",this._doKeyUp)):("div"===i||"span"===i)&&n.removeClass(this.markerClassName).empty(),h===a&&(h=null))},_enableDatepicker:function(e){var i,n,a=t(e),s=t.data(e,"datepicker");a.hasClass(this.markerClassName)&&("input"===(i=e.nodeName.toLowerCase())?(e.disabled=!1,s.trigger.filter("button").each((function(){this.disabled=!1})).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&((n=a.children("."+this._inlineClass)).children().removeClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=t.map(this._disabledInputs,(function(t){return t===e?null:t})))},_disableDatepicker:function(e){var i,n,a=t(e),s=t.data(e,"datepicker");a.hasClass(this.markerClassName)&&("input"===(i=e.nodeName.toLowerCase())?(e.disabled=!0,s.trigger.filter("button").each((function(){this.disabled=!0})).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&((n=a.children("."+this._inlineClass)).children().addClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=t.map(this._disabledInputs,(function(t){return t===e?null:t})),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;this._disabledInputs.length>e;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(e){try{return t.data(e,"datepicker")}catch(t){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,i,n){var s,o,r,l,c=this._getInst(e);return 2===arguments.length&&"string"==typeof i?"defaults"===i?t.extend({},t.datepicker._defaults):c?"all"===i?t.extend({},c.settings):this._get(c,i):null:(s=i||{},"string"==typeof i&&((s={})[i]=n),void(c&&(this._curInst===c&&this._hideDatepicker(),o=this._getDateDatepicker(e,!0),r=this._getMinMaxDate(c,"min"),l=this._getMinMaxDate(c,"max"),a(c.settings,s),null!==r&&void 0!==s.dateFormat&&void 0===s.minDate&&(c.settings.minDate=this._formatDate(c,r)),null!==l&&void 0!==s.dateFormat&&void 0===s.maxDate&&(c.settings.maxDate=this._formatDate(c,l)),"disabled"in s&&(s.disabled?this._disableDatepicker(e):this._enableDatepicker(e)),this._attachments(t(e),c),this._autoSize(c),this._setDate(c,o),this._updateAlternate(c),this._updateDatepicker(c))))},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var i=this._getInst(t);i&&(this._setDate(i,e),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(t,e){var i=this._getInst(t);return i&&!i.inline&&this._setDateFromField(i,e),i?this._getDate(i):null},_doKeyDown:function(e){var i,n,a,s=t.datepicker._getInst(e.target),o=!0,r=s.dpDiv.is(".ui-datepicker-rtl");if(s._keyEvent=!0,t.datepicker._datepickerShowing)switch(e.keyCode){case 9:t.datepicker._hideDatepicker(),o=!1;break;case 13:return(a=t("td."+t.datepicker._dayOverClass+":not(."+t.datepicker._currentClass+")",s.dpDiv))[0]&&t.datepicker._selectDay(e.target,s.selectedMonth,s.selectedYear,a[0]),(i=t.datepicker._get(s,"onSelect"))?(n=t.datepicker._formatDate(s),i.apply(s.input?s.input[0]:null,[n,s])):t.datepicker._hideDatepicker(),!1;case 27:t.datepicker._hideDatepicker();break;case 33:t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(s,"stepBigMonths"):-t.datepicker._get(s,"stepMonths"),"M");break;case 34:t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(s,"stepBigMonths"):+t.datepicker._get(s,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&t.datepicker._clearDate(e.target),o=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&t.datepicker._gotoToday(e.target),o=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,r?1:-1,"D"),o=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(s,"stepBigMonths"):-t.datepicker._get(s,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,-7,"D"),o=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,r?-1:1,"D"),o=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(s,"stepBigMonths"):+t.datepicker._get(s,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,7,"D"),o=e.ctrlKey||e.metaKey;break;default:o=!1}else 36===e.keyCode&&e.ctrlKey?t.datepicker._showDatepicker(this):o=!1;o&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var i,n,a=t.datepicker._getInst(e.target);return t.datepicker._get(a,"constrainInput")?(i=t.datepicker._possibleChars(t.datepicker._get(a,"dateFormat")),n=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),e.ctrlKey||e.metaKey||" ">n||!i||i.indexOf(n)>-1):void 0},_doKeyUp:function(e){var i=t.datepicker._getInst(e.target);if(i.input.val()!==i.lastVal)try{t.datepicker.parseDate(t.datepicker._get(i,"dateFormat"),i.input?i.input.val():null,t.datepicker._getFormatConfig(i))&&(t.datepicker._setDateFromField(i),t.datepicker._updateAlternate(i),t.datepicker._updateDatepicker(i))}catch(t){}return!0},_showDatepicker:function(e){var i,n,s,o,r,l,c;("input"!==(e=e.target||e).nodeName.toLowerCase()&&(e=t("input",e.parentNode)[0]),t.datepicker._isDisabledDatepicker(e)||t.datepicker._lastInput===e)||(i=t.datepicker._getInst(e),t.datepicker._curInst&&t.datepicker._curInst!==i&&(t.datepicker._curInst.dpDiv.stop(!0,!0),i&&t.datepicker._datepickerShowing&&t.datepicker._hideDatepicker(t.datepicker._curInst.input[0])),!1!==(s=(n=t.datepicker._get(i,"beforeShow"))?n.apply(e,[e,i]):{})&&(a(i.settings,s),i.lastVal=null,t.datepicker._lastInput=e,t.datepicker._setDateFromField(i),t.datepicker._inDialog&&(e.value=""),t.datepicker._pos||(t.datepicker._pos=t.datepicker._findPos(e),t.datepicker._pos[1]+=e.offsetHeight),o=!1,t(e).parents().each((function(){return!(o|="fixed"===t(this).css("position"))})),r={left:t.datepicker._pos[0],top:t.datepicker._pos[1]},t.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),t.datepicker._updateDatepicker(i),r=t.datepicker._checkOffset(i,r,o),i.dpDiv.css({position:t.datepicker._inDialog&&t.blockUI?"static":o?"fixed":"absolute",display:"none",left:r.left+"px",top:r.top+"px"}),i.inline||(l=t.datepicker._get(i,"showAnim"),c=t.datepicker._get(i,"duration"),i.dpDiv.css("z-index",function(t){for(var e,i;t.length&&t[0]!==document;){if(("absolute"===(e=t.css("position"))||"relative"===e||"fixed"===e)&&(i=parseInt(t.css("zIndex"),10),!isNaN(i)&&0!==i))return i;t=t.parent()}return 0}(t(e))+1),t.datepicker._datepickerShowing=!0,t.effects&&t.effects.effect[l]?i.dpDiv.show(l,t.datepicker._get(i,"showOptions"),c):i.dpDiv[l||"show"](l?c:null),t.datepicker._shouldFocusInput(i)&&i.input.trigger("focus"),t.datepicker._curInst=i)))},_updateDatepicker:function(e){this.maxRows=4,h=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e);var i,a=this._getNumberOfMonths(e),s=a[1],o=e.dpDiv.find("."+this._dayOverClass+" a");o.length>0&&n.apply(o.get(0)),e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),s>1&&e.dpDiv.addClass("ui-datepicker-multi-"+s).css("width",17*s+"em"),e.dpDiv[(1!==a[0]||1!==a[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===t.datepicker._curInst&&t.datepicker._datepickerShowing&&t.datepicker._shouldFocusInput(e)&&e.input.trigger("focus"),e.yearshtml&&(i=e.yearshtml,setTimeout((function(){i===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),i=e.yearshtml=null}),0))},_shouldFocusInput:function(t){return t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&!t.input.is(":focus")},_checkOffset:function(e,i,n){var a=e.dpDiv.outerWidth(),s=e.dpDiv.outerHeight(),o=e.input?e.input.outerWidth():0,r=e.input?e.input.outerHeight():0,l=document.documentElement.clientWidth+(n?0:t(document).scrollLeft()),c=document.documentElement.clientHeight+(n?0:t(document).scrollTop());return i.left-=this._get(e,"isRTL")?a-o:0,i.left-=n&&i.left===e.input.offset().left?t(document).scrollLeft():0,i.top-=n&&i.top===e.input.offset().top+r?t(document).scrollTop():0,i.left-=Math.min(i.left,i.left+a>l&&l>a?Math.abs(i.left+a-l):0),i.top-=Math.min(i.top,i.top+s>c&&c>s?Math.abs(s+r):0),i},_findPos:function(e){for(var i,n=this._getInst(e),a=this._get(n,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||t.expr.filters.hidden(e));)e=e[a?"previousSibling":"nextSibling"];return[(i=t(e).offset()).left,i.top]},_hideDatepicker:function(e){var i,n,a,s,o=this._curInst;!o||e&&o!==t.data(e,"datepicker")||this._datepickerShowing&&(i=this._get(o,"showAnim"),n=this._get(o,"duration"),a=function(){t.datepicker._tidyDialog(o)},t.effects&&(t.effects.effect[i]||t.effects[i])?o.dpDiv.hide(i,t.datepicker._get(o,"showOptions"),n,a):o.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?n:null,a),i||a(),this._datepickerShowing=!1,(s=this._get(o,"onClose"))&&s.apply(o.input?o.input[0]:null,[o.input?o.input.val():"",o]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),t.blockUI&&(t.unblockUI(),t("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(t.datepicker._curInst){var i=t(e.target),n=t.datepicker._getInst(i[0]);(i[0].id!==t.datepicker._mainDivId&&0===i.parents("#"+t.datepicker._mainDivId).length&&!i.hasClass(t.datepicker.markerClassName)&&!i.closest("."+t.datepicker._triggerClass).length&&t.datepicker._datepickerShowing&&(!t.datepicker._inDialog||!t.blockUI)||i.hasClass(t.datepicker.markerClassName)&&t.datepicker._curInst!==n)&&t.datepicker._hideDatepicker()}},_adjustDate:function(e,i,n){var a=t(e),s=this._getInst(a[0]);this._isDisabledDatepicker(a[0])||(this._adjustInstDate(s,i+("M"===n?this._get(s,"showCurrentAtPos"):0),n),this._updateDatepicker(s))},_gotoToday:function(e){var i,n=t(e),a=this._getInst(n[0]);this._get(a,"gotoCurrent")&&a.currentDay?(a.selectedDay=a.currentDay,a.drawMonth=a.selectedMonth=a.currentMonth,a.drawYear=a.selectedYear=a.currentYear):(i=new Date,a.selectedDay=i.getDate(),a.drawMonth=a.selectedMonth=i.getMonth(),a.drawYear=a.selectedYear=i.getFullYear()),this._notifyChange(a),this._adjustDate(n)},_selectMonthYear:function(e,i,n){var a=t(e),s=this._getInst(a[0]);s["selected"+("M"===n?"Month":"Year")]=s["draw"+("M"===n?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(s),this._adjustDate(a)},_selectDay:function(e,i,n,a){var s,o=t(e);t(a).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||((s=this._getInst(o[0])).selectedDay=s.currentDay=t("a",a).html(),s.selectedMonth=s.currentMonth=i,s.selectedYear=s.currentYear=n,this._selectDate(e,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear)))},_clearDate:function(e){var i=t(e);this._selectDate(i,"")},_selectDate:function(e,i){var n,a=t(e),s=this._getInst(a[0]);i=null!=i?i:this._formatDate(s),s.input&&s.input.val(i),this._updateAlternate(s),(n=this._get(s,"onSelect"))?n.apply(s.input?s.input[0]:null,[i,s]):s.input&&s.input.trigger("change"),s.inline?this._updateDatepicker(s):(this._hideDatepicker(),this._lastInput=s.input[0],"object"!=typeof s.input[0]&&s.input.trigger("focus"),this._lastInput=null)},_updateAlternate:function(e){var i,n,a,s=this._get(e,"altField");s&&(i=this._get(e,"altFormat")||this._get(e,"dateFormat"),n=this._getDate(e),a=this.formatDate(i,n,this._getFormatConfig(e)),t(s).val(a))},noWeekends:function(t){var e=t.getDay();return[e>0&&6>e,""]},iso8601Week:function(t){var e,i=new Date(t.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),e=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((e-i)/864e5)/7)+1},parseDate:function(e,i,n){if(null==e||null==i)throw"Invalid arguments";if(""===(i="object"==typeof i?""+i:i+""))return null;var a,s,o,r,l=0,c=(n?n.shortYearCutoff:null)||this._defaults.shortYearCutoff,d="string"!=typeof c?c:(new Date).getFullYear()%100+parseInt(c,10),u=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,h=(n?n.dayNames:null)||this._defaults.dayNames,p=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,f=(n?n.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,v=-1,b=-1,y=!1,_=function(t){var i=e.length>a+1&&e.charAt(a+1)===t;return i&&a++,i},x=function(t){var e=_(t),n="@"===t?14:"!"===t?20:"y"===t&&e?4:"o"===t?3:2,a=RegExp("^\\d{"+("y"===t?n:1)+","+n+"}"),s=i.substring(l).match(a);if(!s)throw"Missing number at position "+l;return l+=s[0].length,parseInt(s[0],10)},w=function(e,n,a){var s=-1,o=t.map(_(e)?a:n,(function(t,e){return[[e,t]]})).sort((function(t,e){return-(t[1].length-e[1].length)}));if(t.each(o,(function(t,e){var n=e[1];return i.substr(l,n.length).toLowerCase()===n.toLowerCase()?(s=e[0],l+=n.length,!1):void 0})),-1!==s)return s+1;throw"Unknown name at position "+l},C=function(){if(i.charAt(l)!==e.charAt(a))throw"Unexpected literal at position "+l;l++};for(a=0;e.length>a;a++)if(y)"'"!==e.charAt(a)||_("'")?C():y=!1;else switch(e.charAt(a)){case"d":v=x("d");break;case"D":w("D",u,h);break;case"o":b=x("o");break;case"m":g=x("m");break;case"M":g=w("M",p,f);break;case"y":m=x("y");break;case"@":m=(r=new Date(x("@"))).getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case"!":m=(r=new Date((x("!")-this._ticksTo1970)/1e4)).getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case"'":_("'")?C():y=!0;break;default:C()}if(i.length>l&&(o=i.substr(l),!/^\s+/.test(o)))throw"Extra/unparsed characters found in date: "+o;if(-1===m?m=(new Date).getFullYear():100>m&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(d>=m?0:-100)),b>-1)for(g=1,v=b;!((s=this._getDaysInMonth(m,g-1))>=v);)g++,v-=s;if((r=this._daylightSavingAdjust(new Date(m,g-1,v))).getFullYear()!==m||r.getMonth()+1!==g||r.getDate()!==v)throw"Invalid date";return r},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864e9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(t,e,i){if(!e)return"";var n,a=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,s=(i?i.dayNames:null)||this._defaults.dayNames,o=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,l=function(e){var i=t.length>n+1&&t.charAt(n+1)===e;return i&&n++,i},c=function(t,e,i){var n=""+e;if(l(t))for(;i>n.length;)n="0"+n;return n},d=function(t,e,i,n){return l(t)?n[e]:i[e]},u="",h=!1;if(e)for(n=0;t.length>n;n++)if(h)"'"!==t.charAt(n)||l("'")?u+=t.charAt(n):h=!1;else switch(t.charAt(n)){case"d":u+=c("d",e.getDate(),2);break;case"D":u+=d("D",e.getDay(),a,s);break;case"o":u+=c("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=c("m",e.getMonth()+1,2);break;case"M":u+=d("M",e.getMonth(),o,r);break;case"y":u+=l("y")?e.getFullYear():(10>e.getFullYear()%100?"0":"")+e.getFullYear()%100;break;case"@":u+=e.getTime();break;case"!":u+=1e4*e.getTime()+this._ticksTo1970;break;case"'":l("'")?u+="'":h=!0;break;default:u+=t.charAt(n)}return u},_possibleChars:function(t){var e,i="",n=!1,a=function(i){var n=t.length>e+1&&t.charAt(e+1)===i;return n&&e++,n};for(e=0;t.length>e;e++)if(n)"'"!==t.charAt(e)||a("'")?i+=t.charAt(e):n=!1;else switch(t.charAt(e)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":a("'")?i+="'":n=!0;break;default:i+=t.charAt(e)}return i},_get:function(t,e){return void 0!==t.settings[e]?t.settings[e]:this._defaults[e]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var i=this._get(t,"dateFormat"),n=t.lastVal=t.input?t.input.val():null,a=this._getDefaultDate(t),s=a,o=this._getFormatConfig(t);try{s=this.parseDate(i,n,o)||a}catch(t){n=e?"":n}t.selectedDay=s.getDate(),t.drawMonth=t.selectedMonth=s.getMonth(),t.drawYear=t.selectedYear=s.getFullYear(),t.currentDay=n?s.getDate():0,t.currentMonth=n?s.getMonth():0,t.currentYear=n?s.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(e,i,n){var a=null==i||""===i?n:"string"==typeof i?function(i){try{return t.datepicker.parseDate(t.datepicker._get(e,"dateFormat"),i,t.datepicker._getFormatConfig(e))}catch(t){}for(var n=(i.toLowerCase().match(/^c/)?t.datepicker._getDate(e):null)||new Date,a=n.getFullYear(),s=n.getMonth(),o=n.getDate(),r=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=r.exec(i);l;){switch(l[2]||"d"){case"d":case"D":o+=parseInt(l[1],10);break;case"w":case"W":o+=7*parseInt(l[1],10);break;case"m":case"M":s+=parseInt(l[1],10),o=Math.min(o,t.datepicker._getDaysInMonth(a,s));break;case"y":case"Y":a+=parseInt(l[1],10),o=Math.min(o,t.datepicker._getDaysInMonth(a,s))}l=r.exec(i)}return new Date(a,s,o)}(i):"number"==typeof i?isNaN(i)?n:function(t){var e=new Date;return e.setDate(e.getDate()+t),e}(i):new Date(i.getTime());return(a=a&&"Invalid Date"==""+a?n:a)&&(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)),this._daylightSavingAdjust(a)},_daylightSavingAdjust:function(t){return t?(t.setHours(t.getHours()>12?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var n=!e,a=t.selectedMonth,s=t.selectedYear,o=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=o.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=o.getMonth(),t.drawYear=t.selectedYear=t.currentYear=o.getFullYear(),a===t.selectedMonth&&s===t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(n?"":this._formatDate(t))},_getDate:function(t){return!t.currentYear||t.input&&""===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay))},_attachHandlers:function(e){var i=this._get(e,"stepMonths"),n="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map((function(){var e={prev:function(){t.datepicker._adjustDate(n,-i,"M")},next:function(){t.datepicker._adjustDate(n,+i,"M")},hide:function(){t.datepicker._hideDatepicker()},today:function(){t.datepicker._gotoToday(n)},selectDay:function(){return t.datepicker._selectDay(n,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return t.datepicker._selectMonthYear(n,this,"M"),!1},selectYear:function(){return t.datepicker._selectMonthYear(n,this,"Y"),!1}};t(this).on(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])}))},_generateHTML:function(t){var e,i,n,a,s,o,r,l,c,d,u,h,p,f,m,g,v,b,y,_,x,w,C,k,$,S,T,I,D,A,P,O,E,M,L,j,R,N,B,F=new Date,H=this._daylightSavingAdjust(new Date(F.getFullYear(),F.getMonth(),F.getDate())),z=this._get(t,"isRTL"),W=this._get(t,"showButtonPanel"),U=this._get(t,"hideIfNoPrevNext"),q=this._get(t,"navigationAsDateFormat"),Y=this._getNumberOfMonths(t),V=this._get(t,"showCurrentAtPos"),G=this._get(t,"stepMonths"),K=1!==Y[0]||1!==Y[1],X=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),Q=this._getMinMaxDate(t,"min"),J=this._getMinMaxDate(t,"max"),Z=t.drawMonth-V,tt=t.drawYear;if(0>Z&&(Z+=12,tt--),J)for(e=this._daylightSavingAdjust(new Date(J.getFullYear(),J.getMonth()-Y[0]*Y[1]+1,J.getDate())),e=Q&&Q>e?Q:e;this._daylightSavingAdjust(new Date(tt,Z,1))>e;)0>--Z&&(Z=11,tt--);for(t.drawMonth=Z,t.drawYear=tt,i=this._get(t,"prevText"),i=q?this.formatDate(i,this._daylightSavingAdjust(new Date(tt,Z-G,1)),this._getFormatConfig(t)):i,n=this._canAdjustMonth(t,-1,tt,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(z?"e":"w")+"'>"+i+"</span></a>":U?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(z?"e":"w")+"'>"+i+"</span></a>",a=this._get(t,"nextText"),a=q?this.formatDate(a,this._daylightSavingAdjust(new Date(tt,Z+G,1)),this._getFormatConfig(t)):a,s=this._canAdjustMonth(t,1,tt,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+a+"'><span class='ui-icon ui-icon-circle-triangle-"+(z?"w":"e")+"'>"+a+"</span></a>":U?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+a+"'><span class='ui-icon ui-icon-circle-triangle-"+(z?"w":"e")+"'>"+a+"</span></a>",o=this._get(t,"currentText"),r=this._get(t,"gotoCurrent")&&t.currentDay?X:H,o=q?this.formatDate(o,r,this._getFormatConfig(t)):o,l=t.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(t,"closeText")+"</button>",c=W?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(z?l:"")+(this._isInRange(t,r)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(z?"":l)+"</div>":"",d=parseInt(this._get(t,"firstDay"),10),d=isNaN(d)?0:d,u=this._get(t,"showWeek"),h=this._get(t,"dayNames"),p=this._get(t,"dayNamesMin"),f=this._get(t,"monthNames"),m=this._get(t,"monthNamesShort"),g=this._get(t,"beforeShowDay"),v=this._get(t,"showOtherMonths"),b=this._get(t,"selectOtherMonths"),y=this._getDefaultDate(t),_="",w=0;Y[0]>w;w++){for(C="",this.maxRows=4,k=0;Y[1]>k;k++){if($=this._daylightSavingAdjust(new Date(tt,Z,t.selectedDay)),S=" ui-corner-all",T="",K){if(T+="<div class='ui-datepicker-group",Y[1]>1)switch(k){case 0:T+=" ui-datepicker-group-first",S=" ui-corner-"+(z?"right":"left");break;case Y[1]-1:T+=" ui-datepicker-group-last",S=" ui-corner-"+(z?"left":"right");break;default:T+=" ui-datepicker-group-middle",S=""}T+="'>"}for(T+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+S+"'>"+(/all|left/.test(S)&&0===w?z?s:n:"")+(/all|right/.test(S)&&0===w?z?n:s:"")+this._generateMonthYearHeader(t,Z,tt,Q,J,w>0||k>0,f,m)+"</div><table class='ui-datepicker-calendar'><thead><tr>",I=u?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",x=0;7>x;x++)I+="<th scope='col'"+((x+d+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+h[D=(x+d)%7]+"'>"+p[D]+"</span></th>";for(T+=I+"</tr></thead><tbody>",A=this._getDaysInMonth(tt,Z),tt===t.selectedYear&&Z===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,A)),P=(this._getFirstDayOfMonth(tt,Z)-d+7)%7,O=Math.ceil((P+A)/7),E=K&&this.maxRows>O?this.maxRows:O,this.maxRows=E,M=this._daylightSavingAdjust(new Date(tt,Z,1-P)),L=0;E>L;L++){for(T+="<tr>",j=u?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(M)+"</td>":"",x=0;7>x;x++)R=g?g.apply(t.input?t.input[0]:null,[M]):[!0,""],B=(N=M.getMonth()!==Z)&&!b||!R[0]||Q&&Q>M||J&&M>J,j+="<td class='"+((x+d+6)%7>=5?" ui-datepicker-week-end":"")+(N?" ui-datepicker-other-month":"")+(M.getTime()===$.getTime()&&Z===t.selectedMonth&&t._keyEvent||y.getTime()===M.getTime()&&y.getTime()===$.getTime()?" "+this._dayOverClass:"")+(B?" "+this._unselectableClass+" ui-state-disabled":"")+(N&&!v?"":" "+R[1]+(M.getTime()===X.getTime()?" "+this._currentClass:"")+(M.getTime()===H.getTime()?" ui-datepicker-today":""))+"'"+(N&&!v||!R[2]?"":" title='"+R[2].replace(/'/g,"&#39;")+"'")+(B?"":" data-handler='selectDay' data-event='click' data-month='"+M.getMonth()+"' data-year='"+M.getFullYear()+"'")+">"+(N&&!v?"&#xa0;":B?"<span class='ui-state-default'>"+M.getDate()+"</span>":"<a class='ui-state-default"+(M.getTime()===H.getTime()?" ui-state-highlight":"")+(M.getTime()===X.getTime()?" ui-state-active":"")+(N?" ui-priority-secondary":"")+"' href='#'>"+M.getDate()+"</a>")+"</td>",M.setDate(M.getDate()+1),M=this._daylightSavingAdjust(M);T+=j+"</tr>"}++Z>11&&(Z=0,tt++),C+=T+="</tbody></table>"+(K?"</div>"+(Y[0]>0&&k===Y[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"")}_+=C}return _+=c,t._keyEvent=!1,_},_generateMonthYearHeader:function(t,e,i,n,a,s,o,r){var l,c,d,u,h,p,f,m,g=this._get(t,"changeMonth"),v=this._get(t,"changeYear"),b=this._get(t,"showMonthAfterYear"),y="<div class='ui-datepicker-title'>",_="";if(s||!g)_+="<span class='ui-datepicker-month'>"+o[e]+"</span>";else{for(l=n&&n.getFullYear()===i,c=a&&a.getFullYear()===i,_+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",d=0;12>d;d++)(!l||d>=n.getMonth())&&(!c||a.getMonth()>=d)&&(_+="<option value='"+d+"'"+(d===e?" selected='selected'":"")+">"+r[d]+"</option>");_+="</select>"}if(b||(y+=_+(!s&&g&&v?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",s||!v)y+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(u=this._get(t,"yearRange").split(":"),h=(new Date).getFullYear(),p=function(t){var e=t.match(/c[+\-].*/)?i+parseInt(t.substring(1),10):t.match(/[+\-].*/)?h+parseInt(t,10):parseInt(t,10);return isNaN(e)?h:e},f=p(u[0]),m=Math.max(f,p(u[1]||"")),f=n?Math.max(f,n.getFullYear()):f,m=a?Math.min(m,a.getFullYear()):m,t.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";m>=f;f++)t.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";t.yearshtml+="</select>",y+=t.yearshtml,t.yearshtml=null}return y+=this._get(t,"yearSuffix"),b&&(y+=(!s&&g&&v?"":"&#xa0;")+_),y+"</div>"},_adjustInstDate:function(t,e,i){var n=t.selectedYear+("Y"===i?e:0),a=t.selectedMonth+("M"===i?e:0),s=Math.min(t.selectedDay,this._getDaysInMonth(n,a))+("D"===i?e:0),o=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(n,a,s)));t.selectedDay=o.getDate(),t.drawMonth=t.selectedMonth=o.getMonth(),t.drawYear=t.selectedYear=o.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,"min"),n=this._getMinMaxDate(t,"max"),a=i&&i>e?i:e;return n&&a>n?n:a},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,n){var a=this._getNumberOfMonths(t),s=this._daylightSavingAdjust(new Date(i,n+(0>e?e:a[0]*a[1]),1));return 0>e&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(t,s)},_isInRange:function(t,e){var i,n,a=this._getMinMaxDate(t,"min"),s=this._getMinMaxDate(t,"max"),o=null,r=null,l=this._get(t,"yearRange");return l&&(i=l.split(":"),n=(new Date).getFullYear(),o=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(o+=n),i[1].match(/[+\-].*/)&&(r+=n)),(!a||e.getTime()>=a.getTime())&&(!s||e.getTime()<=s.getTime())&&(!o||e.getFullYear()>=o)&&(!r||r>=e.getFullYear())},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return{shortYearCutoff:e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,n){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var a=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(n,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),a,this._getFormatConfig(t))}}),t.fn.datepicker=function(e){if(!this.length)return this;t.datepicker.initialized||(t(document).on("mousedown",t.datepicker._checkExternalClick),t.datepicker.initialized=!0),0===t("#"+t.datepicker._mainDivId).length&&t("body").append(t.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!==e&&"getDate"!==e&&"widget"!==e?"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i)):this.each((function(){"string"==typeof e?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this].concat(i)):t.datepicker._attachDatepicker(this,e)})):t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i))},t.datepicker=new e,t.datepicker.initialized=!1,t.datepicker.uuid=(new Date).getTime(),t.datepicker.version="1.12.1",t.datepicker,t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var f=!1;t(document).on("mouseup",(function(){f=!1})),t.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.on("mousedown."+this.widgetName,(function(t){return e._mouseDown(t)})).on("click."+this.widgetName,(function(i){return!0===t.data(i.target,e.widgetName+".preventClickEvent")?(t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0})),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!f){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var i=this,n=1===e.which,a=!("string"!=typeof this.options.cancel||!e.target.nodeName)&&t(e.target).closest(this.options.cancel).length;return!(n&&!a&&this._mouseCapture(e))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout((function(){i.mouseDelayMet=!0}),this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(e),!this._mouseStarted)?(e.preventDefault(),!0):(!0===t.data(e.target,this.widgetName+".preventClickEvent")&&t.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return i._mouseMove(t)},this._mouseUpDelegate=function(t){return i._mouseUp(t)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),f=!0,!0))}},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||9>document.documentMode)&&!e.button)return this._mouseUp(e);if(!e.which)if(e.originalEvent.altKey||e.originalEvent.ctrlKey||e.originalEvent.metaKey||e.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,e),this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,f=!1,e.preventDefault()},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),t.ui.plugin={add:function(e,i,n){var a,s=t.ui[e].prototype;for(a in n)s.plugins[a]=s.plugins[a]||[],s.plugins[a].push([i,n[a]])},call:function(t,e,i,n){var a,s=t.plugins[e];if(s&&(n||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(a=0;s.length>a;a++)t.options[s[a][0]]&&s[a][1].apply(t.element,i)}},t.ui.safeBlur=function(e){e&&"body"!==e.nodeName.toLowerCase()&&t(e).trigger("blur")},t.widget("ui.draggable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this._addClass("ui-draggable"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(e){var i=this.options;return!(this.helper||i.disabled||t(e.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(e),!!this.handle&&(this._blurActiveElement(e),this._blockFrames(!0===i.iframeFix?"iframe":i.iframeFix),!0))},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map((function(){var e=t(this);return t("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]}))},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var i=t.ui.safeActiveElement(this.document[0]);t(e.target).closest(i).length||t.ui.safeBlur(i)},_mouseStart:function(e){var i=this.options;return this.helper=this._createHelper(e),this._addClass(this.helper,"ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter((function(){return"fixed"===t(this).css("position")})).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),!1===this._trigger("start",e)?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(e,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var n=this._uiHash();if(!1===this._trigger("drag",e,n))return this._mouseUp(new t.Event("mouseup",e)),!1;this.position=n.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var i=this,n=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(n=t.ui.ddmanager.drop(this,e)),this.dropped&&(n=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!n||"valid"===this.options.revert&&n||!0===this.options.revert||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),(function(){!1!==i._trigger("stop",e)&&i._clear()})):!1!==this._trigger("stop",e)&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.trigger("focus"),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp(new t.Event("mouseup",{target:this.element[0]})):this._clear(),this},_getHandle:function(e){return!this.options.handle||!!t(e.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(e){var i=this.options,n=t.isFunction(i.helper),a=n?t(i.helper.apply(this.element[0],[e])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return a.parents("body").length||a.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),n&&a[0]===this.element[0]&&this._setPositionRelative(),a[0]===this.element[0]||/(fixed|absolute)/.test(a.css("position"))||a.css("position","absolute"),a},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,n,a=this.options,s=this.document[0];return this.relativeContainer=null,a.containment?"window"===a.containment?void(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===a.containment?void(this.containment=[0,0,t(s).width()-this.helperProportions.width-this.margins.left,(t(s).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):a.containment.constructor===Array?void(this.containment=a.containment):("parent"===a.containment&&(a.containment=this.helper[0].parentNode),void((n=(i=t(a.containment))[0])&&(e=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(e?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i))):void(this.containment=null)},_convertPositionTo:function(t,e){e||(e=this.position);var i="absolute"===t?1:-1,n=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:n?0:this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:n?0:this.offset.scroll.left)*i}},_generatePosition:function(t,e){var i,n,a,s,o=this.options,r=this._isRootNode(this.scrollParent[0]),l=t.pageX,c=t.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(this.relativeContainer?(n=this.relativeContainer.offset(),i=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):i=this.containment,t.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(c=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(c=i[3]+this.offset.click.top)),o.grid&&(a=o.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,c=i?a-this.offset.click.top>=i[1]||a-this.offset.click.top>i[3]?a:a-this.offset.click.top>=i[1]?a-o.grid[1]:a+o.grid[1]:a,s=o.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,l=i?s-this.offset.click.left>=i[0]||s-this.offset.click.left>i[2]?s:s-this.offset.click.left>=i[0]?s-o.grid[0]:s+o.grid[0]:s),"y"===o.axis&&(l=this.originalPageX),"x"===o.axis&&(c=this.originalPageY)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(e,i,n){return n=n||this._uiHash(),t.ui.plugin.call(this,e,[i,n,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),n.offset=this.positionAbs),t.Widget.prototype._trigger.call(this,e,i,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i,n){var a=t.extend({},i,{item:n.element});n.sortables=[],t(n.options.connectToSortable).each((function(){var i=t(this).sortable("instance");i&&!i.options.disabled&&(n.sortables.push(i),i.refreshPositions(),i._trigger("activate",e,a))}))},stop:function(e,i,n){var a=t.extend({},i,{item:n.element});n.cancelHelperRemoval=!1,t.each(n.sortables,(function(){var t=this;t.isOver?(t.isOver=0,n.cancelHelperRemoval=!0,t.cancelHelperRemoval=!1,t._storedCSS={position:t.placeholder.css("position"),top:t.placeholder.css("top"),left:t.placeholder.css("left")},t._mouseStop(e),t.options.helper=t.options._helper):(t.cancelHelperRemoval=!0,t._trigger("deactivate",e,a))}))},drag:function(e,i,n){t.each(n.sortables,(function(){var a=!1,s=this;s.positionAbs=n.positionAbs,s.helperProportions=n.helperProportions,s.offset.click=n.offset.click,s._intersectsWith(s.containerCache)&&(a=!0,t.each(n.sortables,(function(){return this.positionAbs=n.positionAbs,this.helperProportions=n.helperProportions,this.offset.click=n.offset.click,this!==s&&this._intersectsWith(this.containerCache)&&t.contains(s.element[0],this.element[0])&&(a=!1),a}))),a?(s.isOver||(s.isOver=1,n._parent=i.helper.parent(),s.currentItem=i.helper.appendTo(s.element).data("ui-sortable-item",!0),s.options._helper=s.options.helper,s.options.helper=function(){return i.helper[0]},e.target=s.currentItem[0],s._mouseCapture(e,!0),s._mouseStart(e,!0,!0),s.offset.click.top=n.offset.click.top,s.offset.click.left=n.offset.click.left,s.offset.parent.left-=n.offset.parent.left-s.offset.parent.left,s.offset.parent.top-=n.offset.parent.top-s.offset.parent.top,n._trigger("toSortable",e),n.dropped=s.element,t.each(n.sortables,(function(){this.refreshPositions()})),n.currentItem=n.element,s.fromOutside=n),s.currentItem&&(s._mouseDrag(e),i.position=s.position)):s.isOver&&(s.isOver=0,s.cancelHelperRemoval=!0,s.options._revert=s.options.revert,s.options.revert=!1,s._trigger("out",e,s._uiHash(s)),s._mouseStop(e,!0),s.options.revert=s.options._revert,s.options.helper=s.options._helper,s.placeholder&&s.placeholder.remove(),i.helper.appendTo(n._parent),n._refreshOffsets(e),i.position=n._generatePosition(e,!0),n._trigger("fromSortable",e),n.dropped=!1,t.each(n.sortables,(function(){this.refreshPositions()})))}))}}),t.ui.plugin.add("draggable","cursor",{start:function(e,i,n){var a=t("body"),s=n.options;a.css("cursor")&&(s._cursor=a.css("cursor")),a.css("cursor",s.cursor)},stop:function(e,i,n){var a=n.options;a._cursor&&t("body").css("cursor",a._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,i,n){var a=t(i.helper),s=n.options;a.css("opacity")&&(s._opacity=a.css("opacity")),a.css("opacity",s.opacity)},stop:function(e,i,n){var a=n.options;a._opacity&&t(i.helper).css("opacity",a._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(t,e,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(e,i,n){var a=n.options,s=!1,o=n.scrollParentNotHidden[0],r=n.document[0];o!==r&&"HTML"!==o.tagName?(a.axis&&"x"===a.axis||(n.overflowOffset.top+o.offsetHeight-e.pageY<a.scrollSensitivity?o.scrollTop=s=o.scrollTop+a.scrollSpeed:e.pageY-n.overflowOffset.top<a.scrollSensitivity&&(o.scrollTop=s=o.scrollTop-a.scrollSpeed)),a.axis&&"y"===a.axis||(n.overflowOffset.left+o.offsetWidth-e.pageX<a.scrollSensitivity?o.scrollLeft=s=o.scrollLeft+a.scrollSpeed:e.pageX-n.overflowOffset.left<a.scrollSensitivity&&(o.scrollLeft=s=o.scrollLeft-a.scrollSpeed))):(a.axis&&"x"===a.axis||(e.pageY-t(r).scrollTop()<a.scrollSensitivity?s=t(r).scrollTop(t(r).scrollTop()-a.scrollSpeed):t(window).height()-(e.pageY-t(r).scrollTop())<a.scrollSensitivity&&(s=t(r).scrollTop(t(r).scrollTop()+a.scrollSpeed))),a.axis&&"y"===a.axis||(e.pageX-t(r).scrollLeft()<a.scrollSensitivity?s=t(r).scrollLeft(t(r).scrollLeft()-a.scrollSpeed):t(window).width()-(e.pageX-t(r).scrollLeft())<a.scrollSensitivity&&(s=t(r).scrollLeft(t(r).scrollLeft()+a.scrollSpeed)))),!1!==s&&t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(n,e)}}),t.ui.plugin.add("draggable","snap",{start:function(e,i,n){var a=n.options;n.snapElements=[],t(a.snap.constructor!==String?a.snap.items||":data(ui-draggable)":a.snap).each((function(){var e=t(this),i=e.offset();this!==n.element[0]&&n.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:i.top,left:i.left})}))},drag:function(e,i,n){var a,s,o,r,l,c,d,u,h,p,f=n.options,m=f.snapTolerance,g=i.offset.left,v=g+n.helperProportions.width,b=i.offset.top,y=b+n.helperProportions.height;for(h=n.snapElements.length-1;h>=0;h--)c=(l=n.snapElements[h].left-n.margins.left)+n.snapElements[h].width,u=(d=n.snapElements[h].top-n.margins.top)+n.snapElements[h].height,l-m>v||g>c+m||d-m>y||b>u+m||!t.contains(n.snapElements[h].item.ownerDocument,n.snapElements[h].item)?(n.snapElements[h].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,e,t.extend(n._uiHash(),{snapItem:n.snapElements[h].item})),n.snapElements[h].snapping=!1):("inner"!==f.snapMode&&(a=m>=Math.abs(d-y),s=m>=Math.abs(u-b),o=m>=Math.abs(l-v),r=m>=Math.abs(c-g),a&&(i.position.top=n._convertPositionTo("relative",{top:d-n.helperProportions.height,left:0}).top),s&&(i.position.top=n._convertPositionTo("relative",{top:u,left:0}).top),o&&(i.position.left=n._convertPositionTo("relative",{top:0,left:l-n.helperProportions.width}).left),r&&(i.position.left=n._convertPositionTo("relative",{top:0,left:c}).left)),p=a||s||o||r,"outer"!==f.snapMode&&(a=m>=Math.abs(d-b),s=m>=Math.abs(u-y),o=m>=Math.abs(l-g),r=m>=Math.abs(c-v),a&&(i.position.top=n._convertPositionTo("relative",{top:d,left:0}).top),s&&(i.position.top=n._convertPositionTo("relative",{top:u-n.helperProportions.height,left:0}).top),o&&(i.position.left=n._convertPositionTo("relative",{top:0,left:l}).left),r&&(i.position.left=n._convertPositionTo("relative",{top:0,left:c-n.helperProportions.width}).left)),!n.snapElements[h].snapping&&(a||s||o||r||p)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,e,t.extend(n._uiHash(),{snapItem:n.snapElements[h].item})),n.snapElements[h].snapping=a||s||o||r||p)}}),t.ui.plugin.add("draggable","stack",{start:function(e,i,n){var a,s=n.options,o=t.makeArray(t(s.stack)).sort((function(e,i){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(i).css("zIndex"),10)||0)}));o.length&&(a=parseInt(t(o[0]).css("zIndex"),10)||0,t(o).each((function(e){t(this).css("zIndex",a+e)})),this.css("zIndex",a+o.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,i,n){var a=t(i.helper),s=n.options;a.css("zIndex")&&(s._zIndex=a.css("zIndex")),a.css("zIndex",s.zIndex)},stop:function(e,i,n){var a=n.options;a._zIndex&&t(i.helper).css("zIndex",a._zIndex)}}),t.ui.draggable,t.widget("ui.resizable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(t){return parseFloat(t)||0},_isNumber:function(t){return!isNaN(parseFloat(t))},_hasScroll:function(e,i){if("hidden"===t(e).css("overflow"))return!1;var n=i&&"left"===i?"scrollLeft":"scrollTop",a=!1;return e[n]>0||(e[n]=1,a=e[n]>0,e[n]=0,a)},_create:function(){var e,i=this.options,n=this;this._addClass("ui-resizable"),t.extend(this,{_aspectRatio:!!i.aspectRatio,aspectRatio:i.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:i.helper||i.ghost||i.animate?i.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(t("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,e={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(e),this.originalElement.css("margin",0),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css(e),this._proportionallyResize()),this._setupHandles(),i.autoHide&&t(this.element).on("mouseenter",(function(){i.disabled||(n._removeClass("ui-resizable-autohide"),n._handles.show())})).on("mouseleave",(function(){i.disabled||n.resizing||(n._addClass("ui-resizable-autohide"),n._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var e,i=function(e){t(e).removeData("resizable").removeData("ui-resizable").off(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_setOption:function(t,e){if("handles"===(this._super(t,e),t))this._removeHandles(),this._setupHandles()},_setupHandles:function(){var e,i,n,a,s,o=this.options,r=this;if(this.handles=o.handles||(t(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=t(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),n=this.handles.split(","),this.handles={},i=0;n.length>i;i++)a="ui-resizable-"+(e=t.trim(n[i])),s=t("<div>"),this._addClass(s,"ui-resizable-handle "+a),s.css({zIndex:o.zIndex}),this.handles[e]=".ui-resizable-"+e,this.element.append(s);this._renderAxis=function(e){var i,n,a,s;for(i in e=e||this.element,this.handles)this.handles[i].constructor===String?this.handles[i]=this.element.children(this.handles[i]).first().show():(this.handles[i].jquery||this.handles[i].nodeType)&&(this.handles[i]=t(this.handles[i]),this._on(this.handles[i],{mousedown:r._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(n=t(this.handles[i],this.element),s=/sw|ne|nw|se|n|s/.test(i)?n.outerHeight():n.outerWidth(),a=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),e.css(a,s),this._proportionallyResize()),this._handles=this._handles.add(this.handles[i])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",(function(){r.resizing||(this.className&&(s=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),r.axis=s&&s[1]?s[1]:"se")})),o.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._handles.remove()},_mouseCapture:function(e){var i,n,a=!1;for(i in this.handles)((n=t(this.handles[i])[0])===e.target||t.contains(n,e.target))&&(a=!0);return!this.options.disabled&&a},_mouseStart:function(e){var i,n,a,s=this.options,o=this.element;return this.resizing=!0,this._renderProxy(),i=this._num(this.helper.css("left")),n=this._num(this.helper.css("top")),s.containment&&(i+=t(s.containment).scrollLeft()||0,n+=t(s.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:n},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:o.width(),height:o.height()},this.originalSize=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()},this.sizeDiff={width:o.outerWidth()-o.width(),height:o.outerHeight()-o.height()},this.originalPosition={left:i,top:n},this.originalMousePosition={left:e.pageX,top:e.pageY},this.aspectRatio="number"==typeof s.aspectRatio?s.aspectRatio:this.originalSize.width/this.originalSize.height||1,a=t(".ui-resizable-"+this.axis).css("cursor"),t("body").css("cursor","auto"===a?this.axis+"-resize":a),this._addClass("ui-resizable-resizing"),this._propagate("start",e),!0},_mouseDrag:function(e){var i,n,a=this.originalMousePosition,s=this.axis,o=e.pageX-a.left||0,r=e.pageY-a.top||0,l=this._change[s];return this._updatePrevProperties(),!!l&&(i=l.apply(this,[e,o,r]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(i=this._updateRatio(i,e)),i=this._respectSize(i,e),this._updateCache(i),this._propagate("resize",e),n=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),t.isEmptyObject(n)||(this._updatePrevProperties(),this._trigger("resize",e,this.ui()),this._applyChanges()),!1)},_mouseStop:function(e){this.resizing=!1;var i,n,a,s,o,r,l,c=this.options,d=this;return this._helper&&(a=(n=(i=this._proportionallyResizeElements).length&&/textarea/i.test(i[0].nodeName))&&this._hasScroll(i[0],"left")?0:d.sizeDiff.height,s=n?0:d.sizeDiff.width,o={width:d.helper.width()-s,height:d.helper.height()-a},r=parseFloat(d.element.css("left"))+(d.position.left-d.originalPosition.left)||null,l=parseFloat(d.element.css("top"))+(d.position.top-d.originalPosition.top)||null,c.animate||this.element.css(t.extend(o,{top:l,left:r})),d.helper.height(d.size.height),d.helper.width(d.size.width),this._helper&&!c.animate&&this._proportionallyResize()),t("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(t.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(t.height=this.size.height+"px"),this.helper.css(t),t},_updateVirtualBoundaries:function(t){var e,i,n,a,s,o=this.options;s={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||t)&&(e=s.minHeight*this.aspectRatio,n=s.minWidth/this.aspectRatio,i=s.maxHeight*this.aspectRatio,a=s.maxWidth/this.aspectRatio,e>s.minWidth&&(s.minWidth=e),n>s.minHeight&&(s.minHeight=n),s.maxWidth>i&&(s.maxWidth=i),s.maxHeight>a&&(s.maxHeight=a)),this._vBoundaries=s},_updateCache:function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,i=this.size,n=this.axis;return this._isNumber(t.height)?t.width=t.height*this.aspectRatio:this._isNumber(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===n&&(t.left=e.left+(i.width-t.width),t.top=null),"nw"===n&&(t.top=e.top+(i.height-t.height),t.left=e.left+(i.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,i=this.axis,n=this._isNumber(t.width)&&e.maxWidth&&e.maxWidth<t.width,a=this._isNumber(t.height)&&e.maxHeight&&e.maxHeight<t.height,s=this._isNumber(t.width)&&e.minWidth&&e.minWidth>t.width,o=this._isNumber(t.height)&&e.minHeight&&e.minHeight>t.height,r=this.originalPosition.left+this.originalSize.width,l=this.originalPosition.top+this.originalSize.height,c=/sw|nw|w/.test(i),d=/nw|ne|n/.test(i);return s&&(t.width=e.minWidth),o&&(t.height=e.minHeight),n&&(t.width=e.maxWidth),a&&(t.height=e.maxHeight),s&&c&&(t.left=r-e.minWidth),n&&c&&(t.left=r-e.maxWidth),o&&d&&(t.top=l-e.minHeight),a&&d&&(t.top=l-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_getPaddingPlusBorderDimensions:function(t){for(var e=0,i=[],n=[t.css("borderTopWidth"),t.css("borderRightWidth"),t.css("borderBottomWidth"),t.css("borderLeftWidth")],a=[t.css("paddingTop"),t.css("paddingRight"),t.css("paddingBottom"),t.css("paddingLeft")];4>e;e++)i[e]=parseFloat(n[e])||0,i[e]+=parseFloat(a[e])||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t,e=0,i=this.helper||this.element;this._proportionallyResizeElements.length>e;e++)t=this._proportionallyResizeElements[e],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(t)),t.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var e=this.element,i=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||t("<div style='overflow:hidden;'></div>"),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var i=this.originalSize;return{left:this.originalPosition.left+e,width:i.width-e}},n:function(t,e,i){var n=this.originalSize;return{top:this.originalPosition.top+i,height:n.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(e,i,n){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,i,n]))},sw:function(e,i,n){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,i,n]))},ne:function(e,i,n){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,i,n]))},nw:function(e,i,n){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,i,n]))}},_propagate:function(e,i){t.ui.plugin.call(this,e,[i,this.ui()]),"resize"!==e&&this._trigger(e,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),t.ui.plugin.add("resizable","animate",{stop:function(e){var i=t(this).resizable("instance"),n=i.options,a=i._proportionallyResizeElements,s=a.length&&/textarea/i.test(a[0].nodeName),o=s&&i._hasScroll(a[0],"left")?0:i.sizeDiff.height,r=s?0:i.sizeDiff.width,l={width:i.size.width-r,height:i.size.height-o},c=parseFloat(i.element.css("left"))+(i.position.left-i.originalPosition.left)||null,d=parseFloat(i.element.css("top"))+(i.position.top-i.originalPosition.top)||null;i.element.animate(t.extend(l,d&&c?{top:d,left:c}:{}),{duration:n.animateDuration,easing:n.animateEasing,step:function(){var n={width:parseFloat(i.element.css("width")),height:parseFloat(i.element.css("height")),top:parseFloat(i.element.css("top")),left:parseFloat(i.element.css("left"))};a&&a.length&&t(a[0]).css({width:n.width,height:n.height}),i._updateCache(n),i._propagate("resize",e)}})}}),t.ui.plugin.add("resizable","containment",{start:function(){var e,i,n,a,s,o,r,l=t(this).resizable("instance"),c=l.options,d=l.element,u=c.containment,h=u instanceof t?u.get(0):/parent/.test(u)?d.parent().get(0):u;h&&(l.containerElement=t(h),/document/.test(u)||u===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight}):(e=t(h),i=[],t(["Top","Right","Left","Bottom"]).each((function(t,n){i[t]=l._num(e.css("padding"+n))})),l.containerOffset=e.offset(),l.containerPosition=e.position(),l.containerSize={height:e.innerHeight()-i[3],width:e.innerWidth()-i[1]},n=l.containerOffset,a=l.containerSize.height,s=l.containerSize.width,o=l._hasScroll(h,"left")?h.scrollWidth:s,r=l._hasScroll(h)?h.scrollHeight:a,l.parentData={element:h,left:n.left,top:n.top,width:o,height:r}))},resize:function(e){var i,n,a,s,o=t(this).resizable("instance"),r=o.options,l=o.containerOffset,c=o.position,d=o._aspectRatio||e.shiftKey,u={top:0,left:0},h=o.containerElement,p=!0;h[0]!==document&&/static/.test(h.css("position"))&&(u=l),c.left<(o._helper?l.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-l.left:o.position.left-u.left),d&&(o.size.height=o.size.width/o.aspectRatio,p=!1),o.position.left=r.helper?l.left:0),c.top<(o._helper?l.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-l.top:o.position.top),d&&(o.size.width=o.size.height*o.aspectRatio,p=!1),o.position.top=o._helper?l.top:0),a=o.containerElement.get(0)===o.element.parent().get(0),s=/relative|absolute/.test(o.containerElement.css("position")),a&&s?(o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top):(o.offset.left=o.element.offset().left,o.offset.top=o.element.offset().top),i=Math.abs(o.sizeDiff.width+(o._helper?o.offset.left-u.left:o.offset.left-l.left)),n=Math.abs(o.sizeDiff.height+(o._helper?o.offset.top-u.top:o.offset.top-l.top)),i+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-i,d&&(o.size.height=o.size.width/o.aspectRatio,p=!1)),n+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-n,d&&(o.size.width=o.size.height*o.aspectRatio,p=!1)),p||(o.position.left=o.prevPosition.left,o.position.top=o.prevPosition.top,o.size.width=o.prevSize.width,o.size.height=o.prevSize.height)},stop:function(){var e=t(this).resizable("instance"),i=e.options,n=e.containerOffset,a=e.containerPosition,s=e.containerElement,o=t(e.helper),r=o.offset(),l=o.outerWidth()-e.sizeDiff.width,c=o.outerHeight()-e.sizeDiff.height;e._helper&&!i.animate&&/relative/.test(s.css("position"))&&t(this).css({left:r.left-a.left-n.left,width:l,height:c}),e._helper&&!i.animate&&/static/.test(s.css("position"))&&t(this).css({left:r.left-a.left-n.left,width:l,height:c})}}),t.ui.plugin.add("resizable","alsoResize",{start:function(){var e=t(this).resizable("instance").options;t(e.alsoResize).each((function(){var e=t(this);e.data("ui-resizable-alsoresize",{width:parseFloat(e.width()),height:parseFloat(e.height()),left:parseFloat(e.css("left")),top:parseFloat(e.css("top"))})}))},resize:function(e,i){var n=t(this).resizable("instance"),a=n.options,s=n.originalSize,o=n.originalPosition,r={height:n.size.height-s.height||0,width:n.size.width-s.width||0,top:n.position.top-o.top||0,left:n.position.left-o.left||0};t(a.alsoResize).each((function(){var e=t(this),n=t(this).data("ui-resizable-alsoresize"),a={},s=e.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];t.each(s,(function(t,e){var i=(n[e]||0)+(r[e]||0);i&&i>=0&&(a[e]=i||null)})),e.css(a)}))},stop:function(){t(this).removeData("ui-resizable-alsoresize")}}),t.ui.plugin.add("resizable","ghost",{start:function(){var e=t(this).resizable("instance"),i=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:i.height,width:i.width,margin:0,left:0,top:0}),e._addClass(e.ghost,"ui-resizable-ghost"),!1!==t.uiBackCompat&&"string"==typeof e.options.ghost&&e.ghost.addClass(this.options.ghost),e.ghost.appendTo(e.helper)},resize:function(){var e=t(this).resizable("instance");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=t(this).resizable("instance");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),t.ui.plugin.add("resizable","grid",{resize:function(){var e,i=t(this).resizable("instance"),n=i.options,a=i.size,s=i.originalSize,o=i.originalPosition,r=i.axis,l="number"==typeof n.grid?[n.grid,n.grid]:n.grid,c=l[0]||1,d=l[1]||1,u=Math.round((a.width-s.width)/c)*c,h=Math.round((a.height-s.height)/d)*d,p=s.width+u,f=s.height+h,m=n.maxWidth&&p>n.maxWidth,g=n.maxHeight&&f>n.maxHeight,v=n.minWidth&&n.minWidth>p,b=n.minHeight&&n.minHeight>f;n.grid=l,v&&(p+=c),b&&(f+=d),m&&(p-=c),g&&(f-=d),/^(se|s|e)$/.test(r)?(i.size.width=p,i.size.height=f):/^(ne)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.top=o.top-h):/^(sw)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.left=o.left-u):((0>=f-d||0>=p-c)&&(e=i._getPaddingPlusBorderDimensions(this)),f-d>0?(i.size.height=f,i.position.top=o.top-h):(f=d-e.height,i.size.height=f,i.position.top=o.top+s.height-f),p-c>0?(i.size.width=p,i.position.left=o.left-u):(p=c-e.width,i.size.width=p,i.position.left=o.left+s.width-p))}}),t.ui.resizable,t.widget("ui.dialog",{version:"1.12.1",options:{appendTo:"body",autoOpen:!0,buttons:[],classes:{"ui-dialog":"ui-corner-all","ui-dialog-titlebar":"ui-corner-all"},closeOnEscape:!0,closeText:"Close",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var i=t(this).css(e).offset().top;0>i&&t(this).css("top",e.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),null==this.options.title&&null!=this.originalTitle&&(this.options.title=this.originalTitle),this.options.disabled&&(this.options.disabled=!1),this._createWrapper(),this.element.show().removeAttr("title").appendTo(this.uiDialog),this._addClass("ui-dialog-content","ui-widget-content"),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&t.fn.draggable&&this._makeDraggable(),this.options.resizable&&t.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var e=this.options.appendTo;return e&&(e.jquery||e.nodeType)?t(e):this.document.find(e||"body").eq(0)},_destroy:function(){var t,e=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().css(this.originalCss).detach(),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),(t=e.parent.children().eq(e.index)).length&&t[0]!==this.element[0]?t.before(this.element):e.parent.append(this.element)},widget:function(){return this.uiDialog},disable:t.noop,enable:t.noop,close:function(e){var i=this;this._isOpen&&!1!==this._trigger("beforeClose",e)&&(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),this.opener.filter(":focusable").trigger("focus").length||t.ui.safeBlur(t.ui.safeActiveElement(this.document[0])),this._hide(this.uiDialog,this.options.hide,(function(){i._trigger("close",e)})))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,i){var n=!1,a=this.uiDialog.siblings(".ui-front:visible").map((function(){return+t(this).css("z-index")})).get(),s=Math.max.apply(null,a);return s>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",s+1),n=!0),n&&!i&&this._trigger("focus",e),n},open:function(){var e=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=t(t.ui.safeActiveElement(this.document[0])),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,(function(){e._focusTabbable(),e._trigger("focus")})),this._makeFocusTarget(),void this._trigger("open"))},_focusTabbable:function(){var t=this._focusedElement;t||(t=this.element.find("[autofocus]")),t.length||(t=this.element.find(":tabbable")),t.length||(t=this.uiDialogButtonPane.find(":tabbable")),t.length||(t=this.uiDialogTitlebarClose.filter(":tabbable")),t.length||(t=this.uiDialog),t.eq(0).trigger("focus")},_keepFocus:function(e){function i(){var e=t.ui.safeActiveElement(this.document[0]);this.uiDialog[0]===e||t.contains(this.uiDialog[0],e)||this._focusTabbable()}e.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=t("<div>").hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._addClass(this.uiDialog,"ui-dialog","ui-widget ui-widget-content ui-front"),this._on(this.uiDialog,{keydown:function(e){if(this.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===t.ui.keyCode.ESCAPE)return e.preventDefault(),void this.close(e);if(e.keyCode===t.ui.keyCode.TAB&&!e.isDefaultPrevented()){var i=this.uiDialog.find(":tabbable"),n=i.filter(":first"),a=i.filter(":last");e.target!==a[0]&&e.target!==this.uiDialog[0]||e.shiftKey?e.target!==n[0]&&e.target!==this.uiDialog[0]||!e.shiftKey||(this._delay((function(){a.trigger("focus")})),e.preventDefault()):(this._delay((function(){n.trigger("focus")})),e.preventDefault())}},mousedown:function(t){this._moveToTop(t)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var e;this.uiDialogTitlebar=t("<div>"),this._addClass(this.uiDialogTitlebar,"ui-dialog-titlebar","ui-widget-header ui-helper-clearfix"),this._on(this.uiDialogTitlebar,{mousedown:function(e){t(e.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.trigger("focus")}}),this.uiDialogTitlebarClose=t("<button type='button'></button>").button({label:t("<a>").text(this.options.closeText).html(),icon:"ui-icon-closethick",showLabel:!1}).appendTo(this.uiDialogTitlebar),this._addClass(this.uiDialogTitlebarClose,"ui-dialog-titlebar-close"),this._on(this.uiDialogTitlebarClose,{click:function(t){t.preventDefault(),this.close(t)}}),e=t("<span>").uniqueId().prependTo(this.uiDialogTitlebar),this._addClass(e,"ui-dialog-title"),this._title(e),this.uiDialogTitlebar.prependTo(this.uiDialog),this.uiDialog.attr({"aria-labelledby":e.attr("id")})},_title:function(t){this.options.title?t.text(this.options.title):t.html("&#160;")},_createButtonPane:function(){this.uiDialogButtonPane=t("<div>"),this._addClass(this.uiDialogButtonPane,"ui-dialog-buttonpane","ui-widget-content ui-helper-clearfix"),this.uiButtonSet=t("<div>").appendTo(this.uiDialogButtonPane),this._addClass(this.uiButtonSet,"ui-dialog-buttonset"),this._createButtons()},_createButtons:function(){var e=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),t.isEmptyObject(i)||t.isArray(i)&&!i.length?void this._removeClass(this.uiDialog,"ui-dialog-buttons"):(t.each(i,(function(i,n){var a,s;n=t.isFunction(n)?{click:n,text:i}:n,n=t.extend({type:"button"},n),a=n.click,s={icon:n.icon,iconPosition:n.iconPosition,showLabel:n.showLabel,icons:n.icons,text:n.text},delete n.click,delete n.icon,delete n.iconPosition,delete n.showLabel,delete n.icons,"boolean"==typeof n.text&&delete n.text,t("<button></button>",n).button(s).appendTo(e.uiButtonSet).on("click",(function(){a.apply(e.element[0],arguments)}))})),this._addClass(this.uiDialog,"ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function e(t){return{position:t.position,offset:t.offset}}var i=this,n=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(n,a){i._addClass(t(this),"ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",n,e(a))},drag:function(t,n){i._trigger("drag",t,e(n))},stop:function(a,s){var o=s.offset.left-i.document.scrollLeft(),r=s.offset.top-i.document.scrollTop();n.position={my:"left top",at:"left"+(o>=0?"+":"")+o+" top"+(r>=0?"+":"")+r,of:i.window},i._removeClass(t(this),"ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",a,e(s))}})},_makeResizable:function(){function e(t){return{originalPosition:t.originalPosition,originalSize:t.originalSize,position:t.position,size:t.size}}var i=this,n=this.options,a=n.resizable,s=this.uiDialog.css("position"),o="string"==typeof a?a:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:n.maxWidth,maxHeight:n.maxHeight,minWidth:n.minWidth,minHeight:this._minHeight(),handles:o,start:function(n,a){i._addClass(t(this),"ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",n,e(a))},resize:function(t,n){i._trigger("resize",t,e(n))},stop:function(a,s){var o=i.uiDialog.offset(),r=o.left-i.document.scrollLeft(),l=o.top-i.document.scrollTop();n.height=i.uiDialog.height(),n.width=i.uiDialog.width(),n.position={my:"left top",at:"left"+(r>=0?"+":"")+r+" top"+(l>=0?"+":"")+l,of:i.window},i._removeClass(t(this),"ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",a,e(s))}}).css("position",s)},_trackFocus:function(){this._on(this.widget(),{focusin:function(e){this._makeFocusTarget(),this._focusedElement=t(e.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var e=this._trackingInstances(),i=t.inArray(this,e);-1!==i&&e.splice(i,1)},_trackingInstances:function(){var t=this.document.data("ui-dialog-instances");return t||(t=[],this.document.data("ui-dialog-instances",t)),t},_minHeight:function(){var t=this.options;return"auto"===t.height?t.minHeight:Math.min(t.minHeight,t.height)},_position:function(){var t=this.uiDialog.is(":visible");t||this.uiDialog.show(),this.uiDialog.position(this.options.position),t||this.uiDialog.hide()},_setOptions:function(e){var i=this,n=!1,a={};t.each(e,(function(t,e){i._setOption(t,e),t in i.sizeRelatedOptions&&(n=!0),t in i.resizableRelatedOptions&&(a[t]=e)})),n&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",a)},_setOption:function(e,i){var n,a,s=this.uiDialog;"disabled"!==e&&(this._super(e,i),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:t("<a>").text(""+this.options.closeText).html()}),"draggable"===e&&((n=s.is(":data(ui-draggable)"))&&!i&&s.draggable("destroy"),!n&&i&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&((a=s.is(":data(ui-resizable)"))&&!i&&s.resizable("destroy"),a&&"string"==typeof i&&s.resizable("option","handles",i),a||!1===i||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var t,e,i,n=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),n.minWidth>n.width&&(n.width=n.minWidth),t=this.uiDialog.css({height:"auto",width:n.width}).outerHeight(),e=Math.max(0,n.minHeight-t),i="number"==typeof n.maxHeight?Math.max(0,n.maxHeight-t):"none","auto"===n.height?this.element.css({minHeight:e,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,n.height-t)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map((function(){var e=t(this);return t("<div>").css({position:"absolute",width:e.outerWidth(),height:e.outerHeight()}).appendTo(e.parent()).offset(e.offset())[0]}))},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(e){return!!t(e.target).closest(".ui-dialog").length||!!t(e.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var e=!0;this._delay((function(){e=!1})),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(t){e||this._allowInteraction(t)||(t.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=t("<div>").appendTo(this._appendTo()),this._addClass(this.overlay,null,"ui-widget-overlay ui-front"),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var t=this.document.data("ui-dialog-overlays")-1;t?this.document.data("ui-dialog-overlays",t):(this._off(this.document,"focusin"),this.document.removeData("ui-dialog-overlays")),this.overlay.remove(),this.overlay=null}}}),!1!==t.uiBackCompat&&t.widget("ui.dialog",t.ui.dialog,{options:{dialogClass:""},_createWrapper:function(){this._super(),this.uiDialog.addClass(this.options.dialogClass)},_setOption:function(t,e){"dialogClass"===t&&this.uiDialog.removeClass(this.options.dialogClass).addClass(e),this._superApply(arguments)}}),t.ui.dialog,t.widget("ui.droppable",{version:"1.12.1",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,i=this.options,n=i.accept;this.isover=!1,this.isout=!0,this.accept=t.isFunction(n)?n:function(t){return t.is(n)},this.proportions=function(){return arguments.length?void(e=arguments[0]):e||(e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight})},this._addToManager(i.scope),i.addClasses&&this._addClass("ui-droppable")},_addToManager:function(e){t.ui.ddmanager.droppables[e]=t.ui.ddmanager.droppables[e]||[],t.ui.ddmanager.droppables[e].push(this)},_splice:function(t){for(var e=0;t.length>e;e++)t[e]===this&&t.splice(e,1)},_destroy:function(){var e=t.ui.ddmanager.droppables[this.options.scope];this._splice(e)},_setOption:function(e,i){if("accept"===e)this.accept=t.isFunction(i)?i:function(t){return t.is(i)};else if("scope"===e){var n=t.ui.ddmanager.droppables[this.options.scope];this._splice(n),this._addToManager(i)}this._super(e,i)},_activate:function(e){var i=t.ui.ddmanager.current;this._addActiveClass(),i&&this._trigger("activate",e,this.ui(i))},_deactivate:function(e){var i=t.ui.ddmanager.current;this._removeActiveClass(),i&&this._trigger("deactivate",e,this.ui(i))},_over:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this._addHoverClass(),this._trigger("over",e,this.ui(i)))},_out:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this._removeHoverClass(),this._trigger("out",e,this.ui(i)))},_drop:function(e,i){var n=i||t.ui.ddmanager.current,a=!1;return!(!n||(n.currentItem||n.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each((function(){var i=t(this).droppable("instance");return i.options.greedy&&!i.options.disabled&&i.options.scope===n.options.scope&&i.accept.call(i.element[0],n.currentItem||n.element)&&m(n,t.extend(i,{offset:i.element.offset()}),i.options.tolerance,e)?(a=!0,!1):void 0})),!a&&(!!this.accept.call(this.element[0],n.currentItem||n.element)&&(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",e,this.ui(n)),this.element)))},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}});var m=t.ui.intersect=function(){function t(t,e,i){return t>=e&&e+i>t}return function(e,i,n,a){if(!i.offset)return!1;var s=(e.positionAbs||e.position.absolute).left+e.margins.left,o=(e.positionAbs||e.position.absolute).top+e.margins.top,r=s+e.helperProportions.width,l=o+e.helperProportions.height,c=i.offset.left,d=i.offset.top,u=c+i.proportions().width,h=d+i.proportions().height;switch(n){case"fit":return s>=c&&u>=r&&o>=d&&h>=l;case"intersect":return s+e.helperProportions.width/2>c&&u>r-e.helperProportions.width/2&&o+e.helperProportions.height/2>d&&h>l-e.helperProportions.height/2;case"pointer":return t(a.pageY,d,i.proportions().height)&&t(a.pageX,c,i.proportions().width);case"touch":return(o>=d&&h>=o||l>=d&&h>=l||d>o&&l>h)&&(s>=c&&u>=s||r>=c&&u>=r||c>s&&r>u);default:return!1}}}();t.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(e,i){var n,a,s=t.ui.ddmanager.droppables[e.options.scope]||[],o=i?i.type:null,r=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(n=0;s.length>n;n++)if(!(s[n].options.disabled||e&&!s[n].accept.call(s[n].element[0],e.currentItem||e.element))){for(a=0;r.length>a;a++)if(r[a]===s[n].element[0]){s[n].proportions().height=0;continue t}s[n].visible="none"!==s[n].element.css("display"),s[n].visible&&("mousedown"===o&&s[n]._activate.call(s[n],i),s[n].offset=s[n].element.offset(),s[n].proportions({width:s[n].element[0].offsetWidth,height:s[n].element[0].offsetHeight}))}},drop:function(e,i){var n=!1;return t.each((t.ui.ddmanager.droppables[e.options.scope]||[]).slice(),(function(){this.options&&(!this.options.disabled&&this.visible&&m(e,this,this.options.tolerance,i)&&(n=this._drop.call(this,i)||n),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))})),n},dragStart:function(e,i){e.element.parentsUntil("body").on("scroll.droppable",(function(){e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)}))},drag:function(e,i){e.options.refreshPositions&&t.ui.ddmanager.prepareOffsets(e,i),t.each(t.ui.ddmanager.droppables[e.options.scope]||[],(function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var n,a,s,o=m(e,this,this.options.tolerance,i),r=!o&&this.isover?"isout":o&&!this.isover?"isover":null;r&&(this.options.greedy&&(a=this.options.scope,(s=this.element.parents(":data(ui-droppable)").filter((function(){return t(this).droppable("instance").options.scope===a}))).length&&((n=t(s[0]).droppable("instance")).greedyChild="isover"===r)),n&&"isover"===r&&(n.isover=!1,n.isout=!0,n._out.call(n,i)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,i),n&&"isout"===r&&(n.isout=!1,n.isover=!0,n._over.call(n,i)))}}))},dragStop:function(e,i){e.element.parentsUntil("body").off("scroll.droppable"),e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)}},!1!==t.uiBackCompat&&t.widget("ui.droppable",t.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}}),t.ui.droppable,t.widget("ui.progressbar",{version:"1.12.1",options:{classes:{"ui-progressbar":"ui-corner-all","ui-progressbar-value":"ui-corner-left","ui-progressbar-complete":"ui-corner-right"},max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.attr({role:"progressbar","aria-valuemin":this.min}),this._addClass("ui-progressbar","ui-widget ui-widget-content"),this.valueDiv=t("<div>").appendTo(this.element),this._addClass(this.valueDiv,"ui-progressbar-value","ui-widget-header"),this._refreshValue()},_destroy:function(){this.element.removeAttr("role aria-valuemin aria-valuemax aria-valuenow"),this.valueDiv.remove()},value:function(t){return void 0===t?this.options.value:(this.options.value=this._constrainedValue(t),void this._refreshValue())},_constrainedValue:function(t){return void 0===t&&(t=this.options.value),this.indeterminate=!1===t,"number"!=typeof t&&(t=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,t))},_setOptions:function(t){var e=t.value;delete t.value,this._super(t),this.options.value=this._constrainedValue(e),this._refreshValue()},_setOption:function(t,e){"max"===t&&(e=Math.max(this.min,e)),this._super(t,e)},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",t),this._toggleClass(null,"ui-state-disabled",!!t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var e=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||e>this.min).width(i.toFixed(0)+"%"),this._toggleClass(this.valueDiv,"ui-progressbar-complete",null,e===this.options.max)._toggleClass("ui-progressbar-indeterminate",null,this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=t("<div>").appendTo(this.valueDiv),this._addClass(this.overlayDiv,"ui-progressbar-overlay"))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":e}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),e===this.options.max&&this._trigger("complete")}}),t.widget("ui.selectable",t.ui.mouse,{version:"1.12.1",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e=this;this._addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){e.elementPos=t(e.element[0]).offset(),e.selectees=t(e.options.filter,e.element[0]),e._addClass(e.selectees,"ui-selectee"),e.selectees.each((function(){var i=t(this),n=i.offset(),a={left:n.left-e.elementPos.left,top:n.top-e.elementPos.top};t.data(this,"selectable-item",{element:this,$element:i,left:a.left,top:a.top,right:a.left+i.outerWidth(),bottom:a.top+i.outerHeight(),startselected:!1,selected:i.hasClass("ui-selected"),selecting:i.hasClass("ui-selecting"),unselecting:i.hasClass("ui-unselecting")})}))},this.refresh(),this._mouseInit(),this.helper=t("<div>"),this._addClass(this.helper,"ui-selectable-helper")},_destroy:function(){this.selectees.removeData("selectable-item"),this._mouseDestroy()},_mouseStart:function(e){var i=this,n=this.options;this.opos=[e.pageX,e.pageY],this.elementPos=t(this.element[0]).offset(),this.options.disabled||(this.selectees=t(n.filter,this.element[0]),this._trigger("start",e),t(n.appendTo).append(this.helper),this.helper.css({left:e.pageX,top:e.pageY,width:0,height:0}),n.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each((function(){var n=t.data(this,"selectable-item");n.startselected=!0,e.metaKey||e.ctrlKey||(i._removeClass(n.$element,"ui-selected"),n.selected=!1,i._addClass(n.$element,"ui-unselecting"),n.unselecting=!0,i._trigger("unselecting",e,{unselecting:n.element}))})),t(e.target).parents().addBack().each((function(){var n,a=t.data(this,"selectable-item");return a?(n=!e.metaKey&&!e.ctrlKey||!a.$element.hasClass("ui-selected"),i._removeClass(a.$element,n?"ui-unselecting":"ui-selected")._addClass(a.$element,n?"ui-selecting":"ui-unselecting"),a.unselecting=!n,a.selecting=n,a.selected=n,n?i._trigger("selecting",e,{selecting:a.element}):i._trigger("unselecting",e,{unselecting:a.element}),!1):void 0})))},_mouseDrag:function(e){if(this.dragged=!0,!this.options.disabled){var i,n=this,a=this.options,s=this.opos[0],o=this.opos[1],r=e.pageX,l=e.pageY;return s>r&&(i=r,r=s,s=i),o>l&&(i=l,l=o,o=i),this.helper.css({left:s,top:o,width:r-s,height:l-o}),this.selectees.each((function(){var i=t.data(this,"selectable-item"),c=!1,d={};i&&i.element!==n.element[0]&&(d.left=i.left+n.elementPos.left,d.right=i.right+n.elementPos.left,d.top=i.top+n.elementPos.top,d.bottom=i.bottom+n.elementPos.top,"touch"===a.tolerance?c=!(d.left>r||s>d.right||d.top>l||o>d.bottom):"fit"===a.tolerance&&(c=d.left>s&&r>d.right&&d.top>o&&l>d.bottom),c?(i.selected&&(n._removeClass(i.$element,"ui-selected"),i.selected=!1),i.unselecting&&(n._removeClass(i.$element,"ui-unselecting"),i.unselecting=!1),i.selecting||(n._addClass(i.$element,"ui-selecting"),i.selecting=!0,n._trigger("selecting",e,{selecting:i.element}))):(i.selecting&&((e.metaKey||e.ctrlKey)&&i.startselected?(n._removeClass(i.$element,"ui-selecting"),i.selecting=!1,n._addClass(i.$element,"ui-selected"),i.selected=!0):(n._removeClass(i.$element,"ui-selecting"),i.selecting=!1,i.startselected&&(n._addClass(i.$element,"ui-unselecting"),i.unselecting=!0),n._trigger("unselecting",e,{unselecting:i.element}))),i.selected&&(e.metaKey||e.ctrlKey||i.startselected||(n._removeClass(i.$element,"ui-selected"),i.selected=!1,n._addClass(i.$element,"ui-unselecting"),i.unselecting=!0,n._trigger("unselecting",e,{unselecting:i.element})))))})),!1}},_mouseStop:function(e){var i=this;return this.dragged=!1,t(".ui-unselecting",this.element[0]).each((function(){var n=t.data(this,"selectable-item");i._removeClass(n.$element,"ui-unselecting"),n.unselecting=!1,n.startselected=!1,i._trigger("unselected",e,{unselected:n.element})})),t(".ui-selecting",this.element[0]).each((function(){var n=t.data(this,"selectable-item");i._removeClass(n.$element,"ui-selecting")._addClass(n.$element,"ui-selected"),n.selecting=!1,n.selected=!0,n.startselected=!0,i._trigger("selected",e,{selected:n.element})})),this._trigger("stop",e),this.helper.remove(),!1}}),t.widget("ui.selectmenu",[t.ui.formResetMixin,{version:"1.12.1",defaultElement:"<select>",options:{appendTo:null,classes:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"},disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:!1,change:null,close:null,focus:null,open:null,select:null},_create:function(){var e=this.element.uniqueId().attr("id");this.ids={element:e,button:e+"-button",menu:e+"-menu"},this._drawButton(),this._drawMenu(),this._bindFormResetHandler(),this._rendered=!1,this.menuItems=t()},_drawButton:function(){var e,i=this,n=this._parseOption(this.element.find("option:selected"),this.element[0].selectedIndex);this.labels=this.element.labels().attr("for",this.ids.button),this._on(this.labels,{click:function(t){this.button.focus(),t.preventDefault()}}),this.element.hide(),this.button=t("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element),this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget"),e=t("<span>").appendTo(this.button),this._addClass(e,"ui-selectmenu-icon","ui-icon "+this.options.icons.button),this.buttonItem=this._renderButtonItem(n).appendTo(this.button),!1!==this.options.width&&this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",(function(){i._rendered||i._refreshMenu()}))},_drawMenu:function(){var e=this;this.menu=t("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=t("<div>").append(this.menu),this._addClass(this.menuWrap,"ui-selectmenu-menu","ui-front"),this.menuWrap.appendTo(this._appendTo()),this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(t,i){t.preventDefault(),e._setSelection(),e._select(i.item.data("ui-selectmenu-item"),t)},focus:function(t,i){var n=i.item.data("ui-selectmenu-item");null!=e.focusIndex&&n.index!==e.focusIndex&&(e._trigger("focus",t,{item:n}),e.isOpen||e._select(n,t)),e.focusIndex=n.index,e.button.attr("aria-activedescendant",e.menuItems.eq(n.index).attr("id"))}}).menu("instance"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{})),null===this.options.width&&this._resizeButton()},_refreshMenu:function(){var t,e=this.element.find("option");this.menu.empty(),this._parseOptions(e),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper"),this._rendered=!0,e.length&&(t=this._getSelectedItem(),this.menuInstance.focus(null,t),this._setAria(t.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(t){this.options.disabled||(this._rendered?(this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.menuItems.length&&(this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",t)))},_position:function(){this.menuWrap.position(t.extend({of:this.button},this.options.position))},close:function(t){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",t))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderButtonItem:function(e){var i=t("<span>");return this._setText(i,e.label),this._addClass(i,"ui-selectmenu-text"),i},_renderMenu:function(e,i){var n=this,a="";t.each(i,(function(i,s){var o;s.optgroup!==a&&(o=t("<li>",{text:s.optgroup}),n._addClass(o,"ui-selectmenu-optgroup","ui-menu-divider"+(s.element.parent("optgroup").prop("disabled")?" ui-state-disabled":"")),o.appendTo(e),a=s.optgroup),n._renderItemData(e,s)}))},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-selectmenu-item",e)},_renderItem:function(e,i){var n=t("<li>"),a=t("<div>",{title:i.element.attr("title")});return i.disabled&&this._addClass(n,null,"ui-state-disabled"),this._setText(a,i.label),n.append(a).appendTo(e)},_setText:function(t,e){e?t.text(e):t.html("&#160;")},_move:function(t,e){var i,n,a=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex).parent("li"):(i=this.menuItems.eq(this.element[0].selectedIndex).parent("li"),a+=":not(.ui-state-disabled)"),(n="first"===t||"last"===t?i["first"===t?"prevAll":"nextAll"](a).eq(-1):i[t+"All"](a).eq(0)).length&&this.menuInstance.focus(e,n)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li")},_toggle:function(t){this[this.isOpen?"close":"open"](t)},_setSelection:function(){var t;this.range&&(window.getSelection?((t=window.getSelection()).removeAllRanges(),t.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(e){this.isOpen&&(t(e.target).closest(".ui-selectmenu-menu, #"+t.ui.escapeSelector(this.ids.button)).length||this.close(e))}},_buttonEvents:{mousedown:function(){var t;window.getSelection?(t=window.getSelection()).rangeCount&&(this.range=t.getRangeAt(0)):this.range=document.selection.createRange()},click:function(t){this._setSelection(),this._toggle(t)},keydown:function(e){var i=!0;switch(e.keyCode){case t.ui.keyCode.TAB:case t.ui.keyCode.ESCAPE:this.close(e),i=!1;break;case t.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(e);break;case t.ui.keyCode.UP:e.altKey?this._toggle(e):this._move("prev",e);break;case t.ui.keyCode.DOWN:e.altKey?this._toggle(e):this._move("next",e);break;case t.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(e):this._toggle(e);break;case t.ui.keyCode.LEFT:this._move("prev",e);break;case t.ui.keyCode.RIGHT:this._move("next",e);break;case t.ui.keyCode.HOME:case t.ui.keyCode.PAGE_UP:this._move("first",e);break;case t.ui.keyCode.END:case t.ui.keyCode.PAGE_DOWN:this._move("last",e);break;default:this.menu.trigger(e),i=!1}i&&e.preventDefault()}},_selectFocusedItem:function(t){var e=this.menuItems.eq(this.focusIndex).parent("li");e.hasClass("ui-state-disabled")||this._select(e.data("ui-selectmenu-item"),t)},_select:function(t,e){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=t.index,this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(t)),this._setAria(t),this._trigger("select",e,{item:t}),t.index!==i&&this._trigger("change",e,{item:t}),this.close(e)},_setAria:function(t){var e=this.menuItems.eq(t.index).attr("id");this.button.attr({"aria-labelledby":e,"aria-activedescendant":e}),this.menu.attr("aria-activedescendant",e)},_setOption:function(t,e){if("icons"===t){var i=this.button.find("span.ui-icon");this._removeClass(i,null,this.options.icons.button)._addClass(i,null,e.button)}this._super(t,e),"appendTo"===t&&this.menuWrap.appendTo(this._appendTo()),"width"===t&&this._resizeButton()},_setOptionDisabled:function(t){this._super(t),this.menuInstance.option("disabled",t),this.button.attr("aria-disabled",t),this._toggleClass(this.button,null,"ui-state-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(".ui-front, dialog")),e.length||(e=this.document[0].body),e},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen),this._removeClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"closed":"open"))._addClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var t=this.options.width;return!1===t?void this.button.css("width",""):(null===t&&(t=this.element.show().outerWidth(),this.element.hide()),void this.button.outerWidth(t))},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){var t=this._super();return t.disabled=this.element.prop("disabled"),t},_parseOptions:function(e){var i=this,n=[];e.each((function(e,a){n.push(i._parseOption(t(a),e))})),this.items=n},_parseOption:function(t,e){var i=t.parent("optgroup");return{element:t,index:e,value:t.val(),label:t.text(),optgroup:i.attr("label")||"",disabled:i.prop("disabled")||t.prop("disabled")}},_destroy:function(){this._unbindFormResetHandler(),this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.labels.attr("for",this.ids.element)}}]),t.widget("ui.slider",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,i,n=this.options,a=this.element.find(".ui-slider-handle"),s=[];for(i=n.values&&n.values.length||1,a.length>i&&(a.slice(i).remove(),a=a.slice(0,i)),e=a.length;i>e;e++)s.push("<span tabindex='0'></span>");this.handles=a.add(t(s.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each((function(e){t(this).data("ui-slider-handle-index",e).attr("tabIndex",0)}))},_createRange:function(){var e=this.options;e.range?(!0===e.range&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:t.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=t("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),("min"===e.range||"max"===e.range)&&this._addClass(this.range,"ui-slider-range-"+e.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(e){var i,n,a,s,o,r,l,c=this,d=this.options;return!d.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(i),a=this._valueMax()-this._valueMin()+1,this.handles.each((function(e){var i=Math.abs(n-c.values(e));(a>i||a===i&&(e===c._lastChangedValue||c.values(e)===d.min))&&(a=i,s=t(this),o=e)})),!1!==this._start(e,o)&&(this._mouseSliding=!0,this._handleIndex=o,this._addClass(s,null,"ui-state-active"),s.trigger("focus"),r=s.offset(),l=!t(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:e.pageX-r.left-s.width()/2,top:e.pageY-r.top-s.height()/2-(parseInt(s.css("borderTopWidth"),10)||0)-(parseInt(s.css("borderBottomWidth"),10)||0)+(parseInt(s.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,o,n),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,i,n,a,s;return"horizontal"===this.orientation?(e=this.elementSize.width,i=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,i=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),(n=i/e)>1&&(n=1),0>n&&(n=0),"vertical"===this.orientation&&(n=1-n),a=this._valueMax()-this._valueMin(),s=this._valueMin()+n*a,this._trimAlignValue(s)},_uiHash:function(t,e,i){var n={handle:this.handles[t],handleIndex:t,value:void 0!==e?e:this.value()};return this._hasMultipleValues()&&(n.value=void 0!==e?e:this.values(t),n.values=i||this.values()),n},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(t,e){return this._trigger("start",t,this._uiHash(e))},_slide:function(t,e,i){var n,a=this.value(),s=this.values();this._hasMultipleValues()&&(n=this.values(e?0:1),a=this.values(e),2===this.options.values.length&&!0===this.options.range&&(i=0===e?Math.min(n,i):Math.max(n,i)),s[e]=i),i!==a&&(!1!==this._trigger("slide",t,this._uiHash(e,i,s))&&(this._hasMultipleValues()?this.values(e,i):this.value(i)))},_stop:function(t,e){this._trigger("stop",t,this._uiHash(e))},_change:function(t,e){this._keySliding||this._mouseSliding||(this._lastChangedValue=e,this._trigger("change",t,this._uiHash(e)))},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),void this._change(null,0)):this._value()},values:function(e,i){var n,a,s;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(i),this._refreshValue(),void this._change(null,e);if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this._hasMultipleValues()?this._values(e):this.value();for(n=this.options.values,a=arguments[0],s=0;n.length>s;s+=1)n[s]=this._trimAlignValue(a[s]),this._change(null,s);this._refreshValue()},_setOption:function(e,i){var n,a=0;switch("range"===e&&!0===this.options.range&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),t.isArray(this.options.values)&&(a=this.options.values.length),this._super(e,i),e){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(i),this.handles.css("horizontal"===i?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),n=a-1;n>=0;n--)this._change(null,n);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(t){this._super(t),this._toggleClass(null,"ui-state-disabled",!!t)},_value:function(){var t=this.options.value;return this._trimAlignValue(t)},_values:function(t){var e,i,n;if(arguments.length)return e=this.options.values[t],this._trimAlignValue(e);if(this._hasMultipleValues()){for(i=this.options.values.slice(),n=0;i.length>n;n+=1)i[n]=this._trimAlignValue(i[n]);return i}return[]},_trimAlignValue:function(t){if(this._valueMin()>=t)return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,i=(t-this._valueMin())%e,n=t-i;return 2*Math.abs(i)>=e&&(n+=i>0?e:-e),parseFloat(n.toFixed(5))},_calculateNewMax:function(){var t=this.options.max,e=this._valueMin(),i=this.options.step;(t=Math.round((t-e)/i)*i+e)>this.options.max&&(t-=i),this.max=parseFloat(t.toFixed(this._precision()))},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=""+t,i=e.indexOf(".");return-1===i?0:e.length-i-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(t){"vertical"===t&&this.range.css({width:"",left:""}),"horizontal"===t&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var e,i,n,a,s,o=this.options.range,r=this.options,l=this,c=!this._animateOff&&r.animate,d={};this._hasMultipleValues()?this.handles.each((function(n){i=(l.values(n)-l._valueMin())/(l._valueMax()-l._valueMin())*100,d["horizontal"===l.orientation?"left":"bottom"]=i+"%",t(this).stop(1,1)[c?"animate":"css"](d,r.animate),!0===l.options.range&&("horizontal"===l.orientation?(0===n&&l.range.stop(1,1)[c?"animate":"css"]({left:i+"%"},r.animate),1===n&&l.range[c?"animate":"css"]({width:i-e+"%"},{queue:!1,duration:r.animate})):(0===n&&l.range.stop(1,1)[c?"animate":"css"]({bottom:i+"%"},r.animate),1===n&&l.range[c?"animate":"css"]({height:i-e+"%"},{queue:!1,duration:r.animate}))),e=i})):(n=this.value(),a=this._valueMin(),s=this._valueMax(),i=s!==a?(n-a)/(s-a)*100:0,d["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[c?"animate":"css"](d,r.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:i+"%"},r.animate),"max"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:100-i+"%"},r.animate),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:i+"%"},r.animate),"max"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:100-i+"%"},r.animate))},_handleEvents:{keydown:function(e){var i,n,a,s=t(e.target).data("ui-slider-handle-index");switch(e.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(e.preventDefault(),!this._keySliding&&(this._keySliding=!0,this._addClass(t(e.target),null,"ui-state-active"),!1===this._start(e,s)))return}switch(a=this.options.step,i=n=this._hasMultipleValues()?this.values(s):this.value(),e.keyCode){case t.ui.keyCode.HOME:n=this._valueMin();break;case t.ui.keyCode.END:n=this._valueMax();break;case t.ui.keyCode.PAGE_UP:n=this._trimAlignValue(i+(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(i-(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(i===this._valueMax())return;n=this._trimAlignValue(i+a);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(i===this._valueMin())return;n=this._trimAlignValue(i-a)}this._slide(e,s,n)},keyup:function(e){var i=t(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,i),this._change(e,i),this._removeClass(t(e.target),null,"ui-state-active"))}}}),t.widget("ui.sortable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,i){return t>=e&&e+i>t},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),"handle"===t&&this._setHandleClassName()},_setHandleClassName:function(){var e=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),t.each(this.items,(function(){e._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")}))},_destroy:function(){this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(e,i){var n=null,a=!1,s=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(e),t(e.target).parents().each((function(){return t.data(this,s.widgetName+"-item")===s?(n=t(this),!1):void 0})),t.data(e.target,s.widgetName+"-item")===s&&(n=t(e.target)),!!n&&(!(this.options.handle&&!i&&(t(this.options.handle,n).find("*").addBack().each((function(){this===e.target&&(a=!0)})),!a))&&(this.currentItem=n,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(e,i,n){var a,s,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(s=this.document.find("body"),this.storedCursor=s.css("cursor"),s.css("cursor",o.cursor),this.storedStylesheet=t("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(s)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!n)for(a=this.containers.length-1;a>=0;a--)this.containers[a]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var i,n,a,s,o=this.options,r=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+o.scrollSpeed:e.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+o.scrollSpeed:e.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(e.pageY-this.document.scrollTop()<o.scrollSensitivity?r=this.document.scrollTop(this.document.scrollTop()-o.scrollSpeed):this.window.height()-(e.pageY-this.document.scrollTop())<o.scrollSensitivity&&(r=this.document.scrollTop(this.document.scrollTop()+o.scrollSpeed)),e.pageX-this.document.scrollLeft()<o.scrollSensitivity?r=this.document.scrollLeft(this.document.scrollLeft()-o.scrollSpeed):this.window.width()-(e.pageX-this.document.scrollLeft())<o.scrollSensitivity&&(r=this.document.scrollLeft(this.document.scrollLeft()+o.scrollSpeed))),!1!==r&&t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(a=(n=this.items[i]).item[0],(s=this._intersectsWithPointer(n))&&n.instance===this.currentContainer&&a!==this.currentItem[0]&&this.placeholder[1===s?"next":"prev"]()[0]!==a&&!t.contains(this.placeholder[0],a)&&("semi-dynamic"!==this.options.type||!t.contains(this.element[0],a))){if(this.direction=1===s?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(n))break;this._rearrange(e,n),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var n=this,a=this.placeholder.offset(),s=this.options.axis,o={};s&&"x"!==s||(o.left=a.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),s&&"y"!==s||(o.top=a.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(o,parseInt(this.options.revert,10)||500,(function(){n._clear(e)}))}else this._clear(e,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new t.Event("mouseup",{target:null})),"original"===this.options.helper?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),n=[];return e=e||{},t(i).each((function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);i&&n.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))})),!n.length&&e.key&&n.push(e.key+"="),n.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),n=[];return e=e||{},i.each((function(){n.push(t(e.item||this).attr(e.attribute||"id")||"")})),n},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,n=this.positionAbs.top,a=n+this.helperProportions.height,s=t.left,o=s+t.width,r=t.top,l=r+t.height,c=this.offset.click.top,d=this.offset.click.left,u="x"===this.options.axis||n+c>r&&l>n+c,h="y"===this.options.axis||e+d>s&&o>e+d,p=u&&h;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?p:e+this.helperProportions.width/2>s&&o>i-this.helperProportions.width/2&&n+this.helperProportions.height/2>r&&l>a-this.helperProportions.height/2},_intersectsWithPointer:function(t){var e,i,n="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),a="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width);return!!(n&&a)&&(e=this._getDragVerticalDirection(),i=this._getDragHorizontalDirection(),this.floating?"right"===i||"down"===e?2:1:e&&("down"===e?2:1))},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),n=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return this.floating&&a?"right"===a&&i||"left"===a&&!i:n&&("down"===n&&e||"up"===n&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){function i(){r.push(this)}var n,a,s,o,r=[],l=[],c=this._connectWith();if(c&&e)for(n=c.length-1;n>=0;n--)for(a=(s=t(c[n],this.document[0])).length-1;a>=0;a--)(o=t.data(s[a],this.widgetFullName))&&o!==this&&!o.options.disabled&&l.push([t.isFunction(o.options.items)?o.options.items.call(o.element):t(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(l.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=l.length-1;n>=0;n--)l[n][0].each(i);return t(r)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,(function(t){for(var i=0;e.length>i;i++)if(e[i]===t.item[0])return!1;return!0}))},_refreshItems:function(e){this.items=[],this.containers=[this];var i,n,a,s,o,r,l,c,d=this.items,u=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],h=this._connectWith();if(h&&this.ready)for(i=h.length-1;i>=0;i--)for(n=(a=t(h[i],this.document[0])).length-1;n>=0;n--)(s=t.data(a[n],this.widgetFullName))&&s!==this&&!s.options.disabled&&(u.push([t.isFunction(s.options.items)?s.options.items.call(s.element[0],e,{item:this.currentItem}):t(s.options.items,s.element),s]),this.containers.push(s));for(i=u.length-1;i>=0;i--)for(o=u[i][1],n=0,c=(r=u[i][0]).length;c>n;n++)(l=t(r[n])).data(this.widgetName+"-item",o),d.push({item:l,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(e){var i,n,a,s;for(this.floating=!!this.items.length&&("x"===this.options.axis||this._isFloating(this.items[0].item)),this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset()),i=this.items.length-1;i>=0;i--)(n=this.items[i]).instance!==this.currentContainer&&this.currentContainer&&n.item[0]!==this.currentItem[0]||(a=this.options.toleranceElement?t(this.options.toleranceElement,n.item):n.item,e||(n.width=a.outerWidth(),n.height=a.outerHeight()),s=a.offset(),n.left=s.left,n.top=s.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)s=this.containers[i].element.offset(),this.containers[i].containerCache.left=s.left,this.containers[i].containerCache.top=s.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(e){var i,n=(e=e||this).options;n.placeholder&&n.placeholder.constructor!==String||(i=n.placeholder,n.placeholder={element:function(){var n=e.currentItem[0].nodeName.toLowerCase(),a=t("<"+n+">",e.document[0]);return e._addClass(a,"ui-sortable-placeholder",i||e.currentItem[0].className)._removeClass(a,"ui-sortable-helper"),"tbody"===n?e._createTrPlaceholder(e.currentItem.find("tr").eq(0),t("<tr>",e.document[0]).appendTo(a)):"tr"===n?e._createTrPlaceholder(e.currentItem,a):"img"===n&&a.attr("src",e.currentItem.attr("src")),i||a.css("visibility","hidden"),a},update:function(t,a){(!i||n.forcePlaceholderSize)&&(a.height()||a.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),a.width()||a.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(n.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),n.placeholder.update(e,e.placeholder)},_createTrPlaceholder:function(e,i){var n=this;e.children().each((function(){t("<td>&#160;</td>",n.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(i)}))},_contactContainers:function(e){var i,n,a,s,o,r,l,c,d,u,h=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!t.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(h&&t.contains(this.containers[i].element[0],h.element[0]))continue;h=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",e,this._uiHash(this)),this.containers[i].containerCache.over=0);if(h)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(a=1e4,s=null,o=(d=h.floating||this._isFloating(this.currentItem))?"left":"top",r=d?"width":"height",u=d?"pageX":"pageY",n=this.items.length-1;n>=0;n--)t.contains(this.containers[p].element[0],this.items[n].item[0])&&this.items[n].item[0]!==this.currentItem[0]&&(l=this.items[n].item.offset()[o],c=!1,e[u]-l>this.items[n][r]/2&&(c=!0),a>Math.abs(e[u]-l)&&(a=Math.abs(e[u]-l),s=this.items[n],this.direction=c?"up":"down"));if(!s&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return void(this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash()),this.currentContainer.containerCache.over=1));s?this._rearrange(e,s,null,!0):this._rearrange(e,null,this.containers[p].element,!0),this._trigger("change",e,this._uiHash()),this.containers[p]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(e){var i=this.options,n=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return n.parents("body").length||t("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(n[0]),n[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!n[0].style.width||i.forceHelperSize)&&n.width(this.currentItem.width()),(!n[0].style.height||i.forceHelperSize)&&n.height(this.currentItem.height()),n},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,n,a=this.options;"parent"===a.containment&&(a.containment=this.helper[0].parentNode),("document"===a.containment||"window"===a.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===a.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===a.containment?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(a.containment)||(e=t(a.containment)[0],i=t(a.containment).offset(),n="hidden"!==t(e).css("overflow"),this.containment=[i.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,i.left+(n?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(n?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,i){i||(i=this.position);var n="absolute"===e?1:-1,a="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(a[0].tagName);return{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:a.scrollTop())*n,left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:a.scrollLeft())*n}},_generatePosition:function(e){var i,n,a=this.options,s=e.pageX,o=e.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),a.grid&&(i=this.originalPageY+Math.round((o-this.originalPageY)/a.grid[1])*a.grid[1],o=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-a.grid[1]:i+a.grid[1]:i,n=this.originalPageX+Math.round((s-this.originalPageX)/a.grid[0])*a.grid[0],s=this.containment?n-this.offset.click.left>=this.containment[0]&&n-this.offset.click.left<=this.containment[2]?n:n-this.offset.click.left>=this.containment[0]?n-a.grid[0]:n+a.grid[0]:n)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:r.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:r.scrollLeft())}},_rearrange:function(t,e,i,n){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var a=this.counter;this._delay((function(){a===this.counter&&this.refreshPositions(!n)}))},_clear:function(t,e){function i(t,e,i){return function(n){i._trigger(t,n,e._uiHash(e))}}this.reverting=!1;var n,a=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)("auto"===this._storedCSS[n]||"static"===this._storedCSS[n])&&(this._storedCSS[n]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&a.push((function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))})),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||a.push((function(t){this._trigger("update",t,this._uiHash())})),this!==this.currentContainer&&(e||(a.push((function(t){this._trigger("remove",t,this._uiHash())})),a.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),a.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),n=this.containers.length-1;n>=0;n--)e||a.push(i("deactivate",this,this.containers[n])),this.containers[n].containerCache.over&&(a.push(i("out",this,this.containers[n])),this.containers[n].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(n=0;a.length>n;n++)a[n].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===t.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}}),t.widget("ui.spinner",{version:"1.12.1",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all","ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var e=this._super(),i=this.element;return t.each(["min","max","step"],(function(t,n){var a=i.attr(n);null!=a&&a.length&&(e[n]=a)})),e},_events:{keydown:function(t){this._start(t)&&this._keydown(t)&&t.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",t)))},mousewheel:function(t,e){if(e){if(!this.spinning&&!this._start(t))return!1;this._spin((e>0?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay((function(){this.spinning&&this._stop(t)}),100),t.preventDefault()}},"mousedown .ui-spinner-button":function(e){function i(){this.element[0]===t.ui.safeActiveElement(this.document[0])||(this.element.trigger("focus"),this.previous=n,this._delay((function(){this.previous=n})))}var n;n=this.element[0]===t.ui.safeActiveElement(this.document[0])?this.previous:this.element.val(),e.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay((function(){delete this.cancelBlur,i.call(this)})),!1!==this._start(e)&&this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){return t(e.currentTarget).hasClass("ui-state-active")?!1!==this._start(e)&&void this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e):void 0},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>")},_draw:function(){this._enhance(),this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content"),this._addClass("ui-spinner-input"),this.element.attr("role","spinbutton"),this.buttons=this.uiSpinner.children("a").attr("tabIndex",-1).attr("aria-hidden",!0).button({classes:{"ui-button":""}}),this._removeClass(this.buttons,"ui-corner-all"),this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up"),this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down"),this.buttons.first().button({icon:this.options.icons.up,showLabel:!1}),this.buttons.last().button({icon:this.options.icons.down,showLabel:!1}),this.buttons.height()>Math.ceil(.5*this.uiSpinner.height())&&this.uiSpinner.height()>0&&this.uiSpinner.height(this.uiSpinner.height())},_keydown:function(e){var i=this.options,n=t.ui.keyCode;switch(e.keyCode){case n.UP:return this._repeat(null,1,e),!0;case n.DOWN:return this._repeat(null,-1,e),!0;case n.PAGE_UP:return this._repeat(null,i.page,e),!0;case n.PAGE_DOWN:return this._repeat(null,-i.page,e),!0}return!1},_start:function(t){return!(!this.spinning&&!1===this._trigger("start",t))&&(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(t,e,i){t=t||500,clearTimeout(this.timer),this.timer=this._delay((function(){this._repeat(40,e,i)}),t),this._spin(e*this.options.step,i)},_spin:function(t,e){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+t*this._increment(this.counter)),this.spinning&&!1===this._trigger("spin",e,{value:i})||(this._value(i),this.counter++)},_increment:function(e){var i=this.options.incremental;return i?t.isFunction(i)?i(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=""+t,i=e.indexOf(".");return-1===i?0:e.length-i-1},_adjustValue:function(t){var e,i,n=this.options;return i=t-(e=null!==n.min?n.min:0),t=e+(i=Math.round(i/n.step)*n.step),t=parseFloat(t.toFixed(this._precision())),null!==n.max&&t>n.max?n.max:null!==n.min&&n.min>t?n.min:t},_stop:function(t){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",t))},_setOption:function(t,e){var i,n,a;return"culture"===t||"numberFormat"===t?(i=this._parse(this.element.val()),this.options[t]=e,void this.element.val(this._format(i))):(("max"===t||"min"===t||"step"===t)&&"string"==typeof e&&(e=this._parse(e)),"icons"===t&&(n=this.buttons.first().find(".ui-icon"),this._removeClass(n,null,this.options.icons.up),this._addClass(n,null,e.up),a=this.buttons.last().find(".ui-icon"),this._removeClass(a,null,this.options.icons.down),this._addClass(a,null,e.down)),void this._super(t,e))},_setOptionDisabled:function(t){this._super(t),this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!t),this.element.prop("disabled",!!t),this.buttons.button(t?"disable":"enable")},_setOptions:s((function(t){this._super(t)})),_parse:function(t){return"string"==typeof t&&""!==t&&(t=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t),""===t||isNaN(t)?null:t},_format:function(t){return""===t?"":window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):t},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var t=this.value();return null!==t&&t===this._adjustValue(t)},_value:function(t,e){var i;""!==t&&(null!==(i=this._parse(t))&&(e||(i=this._adjustValue(i)),t=this._format(i))),this.element.val(t),this._refresh()},_destroy:function(){this.element.prop("disabled",!1).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:s((function(t){this._stepUp(t)})),_stepUp:function(t){this._start()&&(this._spin((t||1)*this.options.step),this._stop())},stepDown:s((function(t){this._stepDown(t)})),_stepDown:function(t){this._start()&&(this._spin((t||1)*-this.options.step),this._stop())},pageUp:s((function(t){this._stepUp((t||1)*this.options.page)})),pageDown:s((function(t){this._stepDown((t||1)*this.options.page)})),value:function(t){return arguments.length?void s(this._value).call(this,t):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),!1!==t.uiBackCompat&&t.widget("ui.spinner",t.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml())},_uiSpinnerHtml:function(){return"<span>"},_buttonHtml:function(){return"<a></a><a></a>"}}),t.ui.spinner,t.widget("ui.tabs",{version:"1.12.1",delay:300,options:{active:null,classes:{"ui-tabs":"ui-corner-all","ui-tabs-nav":"ui-corner-all","ui-tabs-panel":"ui-corner-bottom","ui-tabs-tab":"ui-corner-top"},collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var t=/#.*$/;return function(e){var i,n;i=e.href.replace(t,""),n=location.href.replace(t,"");try{i=decodeURIComponent(i)}catch(t){}try{n=decodeURIComponent(n)}catch(t){}return e.hash.length>1&&i===n}}(),_create:function(){var e=this,i=this.options;this.running=!1,this._addClass("ui-tabs","ui-widget ui-widget-content"),this._toggleClass("ui-tabs-collapsible",null,i.collapsible),this._processTabs(),i.active=this._initialActive(),t.isArray(i.disabled)&&(i.disabled=t.unique(i.disabled.concat(t.map(this.tabs.filter(".ui-state-disabled"),(function(t){return e.tabs.index(t)})))).sort()),this.active=!1!==this.options.active&&this.anchors.length?this._findActive(i.active):t(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var e=this.options.active,i=this.options.collapsible,n=location.hash.substring(1);return null===e&&(n&&this.tabs.each((function(i,a){return t(a).attr("aria-controls")===n?(e=i,!1):void 0})),null===e&&(e=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===e||-1===e)&&(e=!!this.tabs.length&&0)),!1!==e&&(-1===(e=this.tabs.index(this.tabs.eq(e)))&&(e=!i&&0)),!i&&!1===e&&this.anchors.length&&(e=0),e},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):t()}},_tabKeydown:function(e){var i=t(t.ui.safeActiveElement(this.document[0])).closest("li"),n=this.tabs.index(i),a=!0;if(!this._handlePageNav(e)){switch(e.keyCode){case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:n++;break;case t.ui.keyCode.UP:case t.ui.keyCode.LEFT:a=!1,n--;break;case t.ui.keyCode.END:n=this.anchors.length-1;break;case t.ui.keyCode.HOME:n=0;break;case t.ui.keyCode.SPACE:return e.preventDefault(),clearTimeout(this.activating),void this._activate(n);case t.ui.keyCode.ENTER:return e.preventDefault(),clearTimeout(this.activating),void this._activate(n!==this.options.active&&n);default:return}e.preventDefault(),clearTimeout(this.activating),n=this._focusNextTab(n,a),e.ctrlKey||e.metaKey||(i.attr("aria-selected","false"),this.tabs.eq(n).attr("aria-selected","true"),this.activating=this._delay((function(){this.option("active",n)}),this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===t.ui.keyCode.UP&&(e.preventDefault(),this.active.trigger("focus"))},_handlePageNav:function(e){return e.altKey&&e.keyCode===t.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):e.altKey&&e.keyCode===t.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(e,i){for(var n=this.tabs.length-1;-1!==t.inArray((e>n&&(e=0),0>e&&(e=n),e),this.options.disabled);)e=i?e+1:e-1;return e},_focusNextTab:function(t,e){return t=this._findNextTab(t,e),this.tabs.eq(t).trigger("focus"),t},_setOption:function(t,e){return"active"===t?void this._activate(e):(this._super(t,e),"collapsible"===t&&(this._toggleClass("ui-tabs-collapsible",null,e),e||!1!==this.options.active||this._activate(0)),"event"===t&&this._setupEvents(e),void("heightStyle"===t&&this._setupHeightStyle(e)))},_sanitizeSelector:function(t){return t?t.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,i=this.tablist.children(":has(a[href])");e.disabled=t.map(i.filter(".ui-state-disabled"),(function(t){return i.index(t)})),this._processTabs(),!1!==e.active&&this.anchors.length?this.active.length&&!t.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=t()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=t()),this._refresh()},_refresh:function(){this._setOptionDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._addClass(this.active,"ui-tabs-active","ui-state-active"),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var e=this,i=this.tabs,n=this.anchors,a=this.panels;this.tablist=this._getList().attr("role","tablist"),this._addClass(this.tablist,"ui-tabs-nav","ui-helper-reset ui-helper-clearfix ui-widget-header"),this.tablist.on("mousedown"+this.eventNamespace,"> li",(function(e){t(this).is(".ui-state-disabled")&&e.preventDefault()})).on("focus"+this.eventNamespace,".ui-tabs-anchor",(function(){t(this).closest("li").is(".ui-state-disabled")&&this.blur()})),this.tabs=this.tablist.find("> li:has(a[href])").attr({role:"tab",tabIndex:-1}),this._addClass(this.tabs,"ui-tabs-tab","ui-state-default"),this.anchors=this.tabs.map((function(){return t("a",this)[0]})).attr({role:"presentation",tabIndex:-1}),this._addClass(this.anchors,"ui-tabs-anchor"),this.panels=t(),this.anchors.each((function(i,n){var a,s,o,r=t(n).uniqueId().attr("id"),l=t(n).closest("li"),c=l.attr("aria-controls");e._isLocal(n)?(o=(a=n.hash).substring(1),s=e.element.find(e._sanitizeSelector(a))):(a="#"+(o=l.attr("aria-controls")||t({}).uniqueId()[0].id),(s=e.element.find(a)).length||(s=e._createPanel(o)).insertAfter(e.panels[i-1]||e.tablist),s.attr("aria-live","polite")),s.length&&(e.panels=e.panels.add(s)),c&&l.data("ui-tabs-aria-controls",c),l.attr({"aria-controls":o,"aria-labelledby":r}),s.attr("aria-labelledby",r)})),this.panels.attr("role","tabpanel"),this._addClass(this.panels,"ui-tabs-panel","ui-widget-content"),i&&(this._off(i.not(this.tabs)),this._off(n.not(this.anchors)),this._off(a.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol, ul").eq(0)},_createPanel:function(e){return t("<div>").attr("id",e).data("ui-tabs-destroy",!0)},_setOptionDisabled:function(e){var i,n,a;for(t.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1),a=0;n=this.tabs[a];a++)i=t(n),!0===e||-1!==t.inArray(a,e)?(i.attr("aria-disabled","true"),this._addClass(i,null,"ui-state-disabled")):(i.removeAttr("aria-disabled"),this._removeClass(i,null,"ui-state-disabled"));this.options.disabled=e,this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!0===e)},_setupEvents:function(e){var i={};e&&t.each(e.split(" "),(function(t,e){i[e]="_eventHandler"})),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(t){t.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var i,n=this.element.parent();"fill"===e?(i=n.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each((function(){var e=t(this),n=e.css("position");"absolute"!==n&&"fixed"!==n&&(i-=e.outerHeight(!0))})),this.element.children().not(this.panels).each((function(){i-=t(this).outerHeight(!0)})),this.panels.each((function(){t(this).height(Math.max(0,i-t(this).innerHeight()+t(this).height()))})).css("overflow","auto")):"auto"===e&&(i=0,this.panels.each((function(){i=Math.max(i,t(this).height("").height())})).height(i))},_eventHandler:function(e){var i=this.options,n=this.active,a=t(e.currentTarget).closest("li"),s=a[0]===n[0],o=s&&i.collapsible,r=o?t():this._getPanelForTab(a),l=n.length?this._getPanelForTab(n):t(),c={oldTab:n,oldPanel:l,newTab:o?t():a,newPanel:r};e.preventDefault(),a.hasClass("ui-state-disabled")||a.hasClass("ui-tabs-loading")||this.running||s&&!i.collapsible||!1===this._trigger("beforeActivate",e,c)||(i.active=!o&&this.tabs.index(a),this.active=s?t():a,this.xhr&&this.xhr.abort(),l.length||r.length||t.error("jQuery UI Tabs: Mismatching fragment identifier."),r.length&&this.load(this.tabs.index(a),e),this._toggle(e,c))},_toggle:function(e,i){function n(){s.running=!1,s._trigger("activate",e,i)}function a(){s._addClass(i.newTab.closest("li"),"ui-tabs-active","ui-state-active"),o.length&&s.options.show?s._show(o,s.options.show,n):(o.show(),n())}var s=this,o=i.newPanel,r=i.oldPanel;this.running=!0,r.length&&this.options.hide?this._hide(r,this.options.hide,(function(){s._removeClass(i.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),a()})):(this._removeClass(i.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),r.hide(),a()),r.attr("aria-hidden","true"),i.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),o.length&&r.length?i.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter((function(){return 0===t(this).attr("tabIndex")})).attr("tabIndex",-1),o.attr("aria-hidden","false"),i.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(e){var i,n=this._findActive(e);n[0]!==this.active[0]&&(n.length||(n=this.active),i=n.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return!1===e?t():this.tabs.eq(e)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+t.ui.escapeSelector(e)+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.tablist.removeAttr("role").off(this.eventNamespace),this.anchors.removeAttr("role tabIndex").removeUniqueId(),this.tabs.add(this.panels).each((function(){t.data(this,"ui-tabs-destroy")?t(this).remove():t(this).removeAttr("role tabIndex aria-live aria-busy aria-selected aria-labelledby aria-hidden aria-expanded")})),this.tabs.each((function(){var e=t(this),i=e.data("ui-tabs-aria-controls");i?e.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):e.removeAttr("aria-controls")})),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(e){var i=this.options.disabled;!1!==i&&(void 0===e?i=!1:(e=this._getIndex(e),i=t.isArray(i)?t.map(i,(function(t){return t!==e?t:null})):t.map(this.tabs,(function(t,i){return i!==e?i:null}))),this._setOptionDisabled(i))},disable:function(e){var i=this.options.disabled;if(!0!==i){if(void 0===e)i=!0;else{if(e=this._getIndex(e),-1!==t.inArray(e,i))return;i=t.isArray(i)?t.merge([e],i).sort():[e]}this._setOptionDisabled(i)}},load:function(e,i){e=this._getIndex(e);var n=this,a=this.tabs.eq(e),s=a.find(".ui-tabs-anchor"),o=this._getPanelForTab(a),r={tab:a,panel:o},l=function(t,e){"abort"===e&&n.panels.stop(!1,!0),n._removeClass(a,"ui-tabs-loading"),o.removeAttr("aria-busy"),t===n.xhr&&delete n.xhr};this._isLocal(s[0])||(this.xhr=t.ajax(this._ajaxSettings(s,i,r)),this.xhr&&"canceled"!==this.xhr.statusText&&(this._addClass(a,"ui-tabs-loading"),o.attr("aria-busy","true"),this.xhr.done((function(t,e,a){setTimeout((function(){o.html(t),n._trigger("load",i,r),l(a,e)}),1)})).fail((function(t,e){setTimeout((function(){l(t,e)}),1)}))))},_ajaxSettings:function(e,i,n){var a=this;return{url:e.attr("href").replace(/#.*$/,""),beforeSend:function(e,s){return a._trigger("beforeLoad",i,t.extend({jqXHR:e,ajaxSettings:s},n))}}},_getPanelForTab:function(e){var i=t(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}}),!1!==t.uiBackCompat&&t.widget("ui.tabs",t.ui.tabs,{_processTabs:function(){this._superApply(arguments),this._addClass(this.tabs,"ui-tab")}}),t.ui.tabs,t.widget("ui.tooltip",{version:"1.12.1",options:{classes:{"ui-tooltip":"ui-corner-all ui-widget-shadow"},content:function(){var e=t(this).attr("title")||"";return t("<a>").text(e).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,track:!1,close:null,open:null},_addDescribedBy:function(e,i){var n=(e.attr("aria-describedby")||"").split(/\s+/);n.push(i),e.data("ui-tooltip-id",i).attr("aria-describedby",t.trim(n.join(" ")))},_removeDescribedBy:function(e){var i=e.data("ui-tooltip-id"),n=(e.attr("aria-describedby")||"").split(/\s+/),a=t.inArray(i,n);-1!==a&&n.splice(a,1),e.removeData("ui-tooltip-id"),(n=t.trim(n.join(" ")))?e.attr("aria-describedby",n):e.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.liveRegion=t("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this.disabledTitles=t([])},_setOption:function(e,i){var n=this;this._super(e,i),"content"===e&&t.each(this.tooltips,(function(t,e){n._updateContent(e.element)}))},_setOptionDisabled:function(t){this[t?"_disable":"_enable"]()},_disable:function(){var e=this;t.each(this.tooltips,(function(i,n){var a=t.Event("blur");a.target=a.currentTarget=n.element[0],e.close(a,!0)})),this.disabledTitles=this.disabledTitles.add(this.element.find(this.options.items).addBack().filter((function(){var e=t(this);return e.is("[title]")?e.data("ui-tooltip-title",e.attr("title")).removeAttr("title"):void 0})))},_enable:function(){this.disabledTitles.each((function(){var e=t(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))})),this.disabledTitles=t([])},open:function(e){var i=this,n=t(e?e.target:this.element).closest(this.options.items);n.length&&!n.data("ui-tooltip-id")&&(n.attr("title")&&n.data("ui-tooltip-title",n.attr("title")),n.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&n.parents().each((function(){var e,n=t(this);n.data("ui-tooltip-open")&&((e=t.Event("blur")).target=e.currentTarget=this,i.close(e,!0)),n.attr("title")&&(n.uniqueId(),i.parents[this.id]={element:this,title:n.attr("title")},n.attr("title",""))})),this._registerCloseHandlers(e,n),this._updateContent(n,e))},_updateContent:function(t,e){var i,n=this.options.content,a=this,s=e?e.type:null;return"string"==typeof n||n.nodeType||n.jquery?this._open(e,t,n):void((i=n.call(t[0],(function(i){a._delay((function(){t.data("ui-tooltip-open")&&(e&&(e.type=s),this._open(e,t,i))}))})))&&this._open(e,t,i))},_open:function(e,i,n){function a(t){c.of=t,o.is(":hidden")||o.position(c)}var s,o,r,l,c=t.extend({},this.options.position);if(n){if(s=this._find(i))return void s.tooltip.find(".ui-tooltip-content").html(n);i.is("[title]")&&(e&&"mouseover"===e.type?i.attr("title",""):i.removeAttr("title")),s=this._tooltip(i),o=s.tooltip,this._addDescribedBy(i,o.attr("id")),o.find(".ui-tooltip-content").html(n),this.liveRegion.children().hide(),(l=t("<div>").html(o.find(".ui-tooltip-content").html())).removeAttr("name").find("[name]").removeAttr("name"),l.removeAttr("id").find("[id]").removeAttr("id"),l.appendTo(this.liveRegion),this.options.track&&e&&/^mouse/.test(e.type)?(this._on(this.document,{mousemove:a}),a(e)):o.position(t.extend({of:i},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.track&&this.options.show&&this.options.show.delay&&(r=this.delayedShow=setInterval((function(){o.is(":visible")&&(a(c.of),clearInterval(r))}),t.fx.interval)),this._trigger("open",e,{tooltip:o})}},_registerCloseHandlers:function(e,i){var n={keyup:function(e){if(e.keyCode===t.ui.keyCode.ESCAPE){var n=t.Event(e);n.currentTarget=i[0],this.close(n,!0)}}};i[0]!==this.element[0]&&(n.remove=function(){this._removeTooltip(this._find(i).tooltip)}),e&&"mouseover"!==e.type||(n.mouseleave="close"),e&&"focusin"!==e.type||(n.focusout="close"),this._on(!0,i,n)},close:function(e){var i,n=this,a=t(e?e.currentTarget:this.element),s=this._find(a);return s?(i=s.tooltip,void(s.closing||(clearInterval(this.delayedShow),a.data("ui-tooltip-title")&&!a.attr("title")&&a.attr("title",a.data("ui-tooltip-title")),this._removeDescribedBy(a),s.hiding=!0,i.stop(!0),this._hide(i,this.options.hide,(function(){n._removeTooltip(t(this))})),a.removeData("ui-tooltip-open"),this._off(a,"mouseleave focusout keyup"),a[0]!==this.element[0]&&this._off(a,"remove"),this._off(this.document,"mousemove"),e&&"mouseleave"===e.type&&t.each(this.parents,(function(e,i){t(i.element).attr("title",i.title),delete n.parents[e]})),s.closing=!0,this._trigger("close",e,{tooltip:i}),s.hiding||(s.closing=!1)))):void a.removeData("ui-tooltip-open")},_tooltip:function(e){var i=t("<div>").attr("role","tooltip"),n=t("<div>").appendTo(i),a=i.uniqueId().attr("id");return this._addClass(n,"ui-tooltip-content"),this._addClass(i,"ui-tooltip","ui-widget ui-widget-content"),i.appendTo(this._appendTo(e)),this.tooltips[a]={element:e,tooltip:i}},_find:function(t){var e=t.data("ui-tooltip-id");return e?this.tooltips[e]:null},_removeTooltip:function(t){t.remove(),delete this.tooltips[t.attr("id")]},_appendTo:function(t){var e=t.closest(".ui-front, dialog");return e.length||(e=this.document[0].body),e},_destroy:function(){var e=this;t.each(this.tooltips,(function(i,n){var a=t.Event("blur"),s=n.element;a.target=a.currentTarget=s[0],e.close(a,!0),t("#"+i).remove(),s.data("ui-tooltip-title")&&(s.attr("title")||s.attr("title",s.data("ui-tooltip-title")),s.removeData("ui-tooltip-title"))})),this.liveRegion.remove()}}),!1!==t.uiBackCompat&&t.widget("ui.tooltip",t.ui.tooltip,{options:{tooltipClass:null},_tooltip:function(){var t=this._superApply(arguments);return this.options.tooltipClass&&t.tooltip.addClass(this.options.tooltipClass),t}}),t.ui.tooltip})),function(t,e,i){"use strict";t.anythingSlider=function(n,a){var s,o,r=this;r.el=n,r.$el=t(n).addClass("anythingBase").wrap('<div class="anythingSlider"><div class="anythingWindow" /></div>'),r.$el.data("AnythingSlider",r),r.init=function(){if(r.options=s=t.extend({},t.anythingSlider.defaults,a),r.initialized=!1,t.isFunction(s.onBeforeInitialize)&&r.$el.bind("before_initialize",s.onBeforeInitialize),r.$el.trigger("before_initialize",r),t('\x3c!--[if lte IE 8]><script>jQuery("body").addClass("as-oldie");<\/script><![endif]--\x3e').appendTo("body").remove(),r.$wrapper=r.$el.parent().closest("div.anythingSlider").addClass("anythingSlider-"+s.theme),r.$outer=r.$wrapper.parent(),r.$window=r.$el.closest("div.anythingWindow"),r.$win=t(e),r.$controls=t('<div class="anythingControls"></div>'),r.$nav=t('<ul class="thumbNav"><li><a><span></span></a></li></ul>'),r.$startStop=t('<a href="#" class="start-stop"></a>'),(s.buildStartStop||s.buildNavigation)&&r.$controls.appendTo(s.appendControlsTo&&t(s.appendControlsTo).length?t(s.appendControlsTo):r.$wrapper),s.buildNavigation&&r.$nav.appendTo(s.appendNavigationTo&&t(s.appendNavigationTo).length?t(s.appendNavigationTo):r.$controls),s.buildStartStop&&r.$startStop.appendTo(s.appendStartStopTo&&t(s.appendStartStopTo).length?t(s.appendStartStopTo):r.$controls),r.runTimes=t(".anythingBase").length,r.regex=s.hashTags?new RegExp("panel"+r.runTimes+"-(\\d+)","i"):null,1===r.runTimes&&r.makeActive(),r.flag=!1,s.autoPlayLocked&&(s.autoPlay=!0),r.playing=s.autoPlay,r.slideshow=!1,r.hovered=!1,r.panelSize=[],r.currentPage=r.targetPage=s.startPanel=parseInt(s.startPanel,10)||1,s.changeBy=parseInt(s.changeBy,10)||1,o=(s.mode||"h").toLowerCase().match(/(h|v|f)/),o=s.vertical?"v":(o||["h"])[0],s.mode="v"===o?"vertical":"f"===o?"fade":"horizontal","f"===o&&(s.showMultiple=1,s.infiniteSlides=!1),r.adj=s.infiniteSlides?0:1,r.adjustMultiple=0,s.playRtl&&r.$wrapper.addClass("rtl"),s.buildStartStop&&r.buildAutoPlay(),s.buildArrows&&r.buildNextBackButtons(),r.$lastPage=r.$targetPage=r.$currentPage,s.expand){if(!0===s.aspectRatio)s.aspectRatio=r.$el.width()/r.$el.height();else if("string"==typeof s.aspectRatio&&-1!==s.aspectRatio.indexOf(":")){var n=s.aspectRatio.split(":");s.aspectRatio=n[0]/n[1]}s.aspectRatio>0&&s.showMultiple>1&&(s.aspectRatio=s.aspectRatio*s.showMultiple)}r.updateSlider(),s.expand&&(r.$window.css({width:"100%",height:"100%"}),r.checkResize()),t.isFunction(t.easing[s.easing])||(s.easing="swing"),s.pauseOnHover&&r.$wrapper.hover((function(){r.playing&&(r.$el.trigger("slideshow_paused",r),r.clearTimer(!0))}),(function(){r.playing&&(r.$el.trigger("slideshow_unpaused",r),r.startStop(r.playing,!0))})),r.slideControls(!1),r.$wrapper.bind("mouseenter mouseleave",(function(e){t(this)["mouseenter"===e.type?"addClass":"removeClass"]("anythingSlider-hovered"),r.hovered="mouseenter"===e.type,r.slideControls(r.hovered)})),t(i).keyup((function(t){if(s.enableKeyboard&&r.$wrapper.hasClass("activeSlider")&&!t.target.tagName.match("TEXTAREA|INPUT|SELECT")){if("vertical"!==s.mode&&(38===t.which||40===t.which))return;switch(t.which){case 39:case 40:r.goForward();break;case 37:case 38:r.goBack()}}})),r.currentPage=(s.hashTags?r.gotoHash():"")||s.startPanel||1,r.gotoPage(r.currentPage,!1,null,-1);var l="slideshow_resized slideshow_paused slideshow_unpaused slide_init slide_begin slideshow_stop slideshow_start initialized swf_completed".split(" ");t.each("onSliderResize onShowPause onShowUnpause onSlideInit onSlideBegin onShowStop onShowStart onInitialized onSWFComplete".split(" "),(function(e,i){t.isFunction(s[i])&&r.$el.bind(l[e],s[i])})),t.isFunction(s.onSlideComplete)&&r.$el.bind("slide_complete",(function(){return setTimeout((function(){s.onSlideComplete(r)}),0),!1})),r.initialized=!0,r.$el.trigger("initialized",r),r.startStop(s.autoPlay)},r.updateSlider=function(){r.$el.children(".cloned").remove(),r.navTextVisible="hidden"!==r.$nav.find("span:first").css("visibility"),r.$nav.empty(),r.currentPage=r.currentPage||1,r.$items=r.$el.children(),r.pages=r.$items.length,r.dir="vertical"===s.mode?"top":"left",s.showMultiple=parseInt(s.showMultiple,10)||1,s.navigationSize=!1===s.navigationSize?0:parseInt(s.navigationSize,10)||0,r.$items.find("a").unbind("focus.AnythingSlider").bind("focus.AnythingSlider",(function(e){var i=t(this).closest(".panel"),n=r.$items.index(i)+r.adj;r.$items.find(".focusedLink").removeClass("focusedLink"),t(this).addClass("focusedLink"),r.$window.scrollLeft(0).scrollTop(0),-1!==n&&(n>=r.currentPage+s.showMultiple||n<r.currentPage)&&(r.gotoPage(n),e.preventDefault())})),s.showMultiple>1&&(s.showMultiple>r.pages&&(s.showMultiple=r.pages),r.adjustMultiple=s.infiniteSlides&&r.pages>1?0:s.showMultiple-1),r.$controls.add(r.$nav).add(r.$startStop).add(r.$forward).add(r.$back)[r.pages<=1?"hide":"show"](),r.pages>1&&r.buildNavigation(),"fade"!==s.mode&&s.infiniteSlides&&r.pages>1&&(r.$el.prepend(r.$items.filter(":last").clone().addClass("cloned")),s.showMultiple>1?r.$el.append(r.$items.filter(":lt("+s.showMultiple+")").clone().addClass("cloned multiple")):r.$el.append(r.$items.filter(":first").clone().addClass("cloned")),r.$el.find(".cloned").each((function(){t(this).find("a,input,textarea,select,button,area,form").attr({disabled:"disabled",name:""}),t(this).find("[id]")[t.fn.addBack?"addBack":"andSelf"]().removeAttr("id")}))),r.$items=r.$el.addClass(s.mode).children().addClass("panel"),r.setDimensions(),s.resizeContents?(r.$items.css("width",r.width),r.$wrapper.css("width",r.getDim(r.currentPage)[0]).add(r.$items).css("height",r.height)):r.$win.load((function(){r.setDimensions(),o=r.getDim(r.currentPage),r.$wrapper.css({width:o[0],height:o[1]}),r.setCurrentPage(r.currentPage,!1)})),r.currentPage>r.pages&&(r.currentPage=r.pages),r.setCurrentPage(r.currentPage,!1),r.$nav.find("a").eq(r.currentPage-1).addClass("cur"),"fade"===s.mode&&(o=r.$items.eq(r.currentPage-1),s.resumeOnVisible?o.css({opacity:1,visibility:"visible"}).siblings().css({opacity:0,visibility:"hidden"}):(r.$items.css("opacity",1),o.fadeIn(0).siblings().fadeOut(0)))},r.buildNavigation=function(){var e,i,n,a,o;s.buildNavigation&&r.pages>1&&(r.$items.filter(":not(.cloned)").each((function(l){o=t("<li/>"),i=(1===(n=l+1)?" first":"")+(n===r.pages?" last":""),e='<a class="panel'+n+(r.navTextVisible?'"':" "+s.tooltipClass+'" title="@"')+' href="#"><span>@</span></a>',t.isFunction(s.navigationFormatter)?"string"==typeof(a=s.navigationFormatter(n,t(this)))?o.html(e.replace(/@/g,a)):o=t("<li/>",a):o.html(e.replace(/@/g,n)),o.appendTo(r.$nav).addClass(i).data("index",n)})),r.$nav.children("li").bind(s.clickControls,(function(e){!r.flag&&s.enableNavigation&&(r.flag=!0,setTimeout((function(){r.flag=!1}),100),r.gotoPage(t(this).data("index"))),e.preventDefault()})),s.navigationSize&&s.navigationSize<r.pages&&(r.$controls.find(".anythingNavWindow").length||r.$nav.before('<ul><li class="prev"><a href="#"><span>'+s.backText+"</span></a></li></ul>").after('<ul><li class="next"><a href="#"><span>'+s.forwardText+"</span></a></li></ul>").wrap('<div class="anythingNavWindow"></div>'),r.navWidths=r.$nav.find("li").map((function(){return t(this).outerWidth(!0)+Math.ceil(parseInt(t(this).find("span").css("left"),10)/2||0)})).get(),r.navLeft=1,r.$nav.width(r.navWidth(1,r.pages+1)+25),r.$controls.find(".anythingNavWindow").width(r.navWidth(1,s.navigationSize+1)).end().find(".prev,.next").bind(s.clickControls,(function(e){r.flag||(r.flag=!0,setTimeout((function(){r.flag=!1}),200),r.navWindow(r.navLeft+s.navigationSize*(t(this).is(".prev")?-1:1))),e.preventDefault()}))))},r.navWidth=function(t,e){var i,n=Math.min(t,e),a=Math.max(t,e),s=0;for(i=n;i<a;i++)s+=r.navWidths[i-1]||0;return s},r.navWindow=function(t){if(s.navigationSize&&s.navigationSize<r.pages&&r.navWidths){var e=r.pages-s.navigationSize+1;(t=t<=1?1:t>1&&t<e?t:e)!==r.navLeft&&(r.$controls.find(".anythingNavWindow").animate({scrollLeft:r.navWidth(1,t),width:r.navWidth(t,t+s.navigationSize)},{queue:!1,duration:s.animationTime}),r.navLeft=t)}},r.buildNextBackButtons=function(){r.$forward=t('<span class="arrow forward"><a href="#"><span>'+s.forwardText+"</span></a></span>"),r.$back=t('<span class="arrow back"><a href="#"><span>'+s.backText+"</span></a></span>"),r.$back.bind(s.clickBackArrow,(function(t){s.enableArrows&&!r.flag&&(r.flag=!0,setTimeout((function(){r.flag=!1}),100),r.goBack()),t.preventDefault()})),r.$forward.bind(s.clickForwardArrow,(function(t){s.enableArrows&&!r.flag&&(r.flag=!0,setTimeout((function(){r.flag=!1}),100),r.goForward()),t.preventDefault()})),r.$back.add(r.$forward).find("a").bind("focusin focusout",(function(){t(this).toggleClass("hover")})),r.$back.appendTo(s.appendBackTo&&t(s.appendBackTo).length?t(s.appendBackTo):r.$wrapper),r.$forward.appendTo(s.appendForwardTo&&t(s.appendForwardTo).length?t(s.appendForwardTo):r.$wrapper),r.arrowWidth=r.$forward.width(),r.arrowRight=parseInt(r.$forward.css("right"),10),r.arrowLeft=parseInt(r.$back.css("left"),10)},r.buildAutoPlay=function(){r.$startStop.html("<span>"+(r.playing?s.stopText:s.startText)+"</span>").bind(s.clickSlideshow,(function(t){s.enableStartStop&&(r.startStop(!r.playing),r.makeActive(),r.playing&&!s.autoPlayDelayed&&r.goForward(!0,s.playRtl)),t.preventDefault()})).bind("focusin focusout",(function(){t(this).toggleClass("hover")}))},r.checkResize=function(t){var e=!!(i.hidden||i.webkitHidden||i.mozHidden||i.msHidden);clearTimeout(r.resizeTimer),r.resizeTimer=setTimeout((function(){var i=r.$outer.width(),n="BODY"===r.$outer[0].tagName?r.$win.height():r.$outer.height();e||r.lastDim[0]===i&&r.lastDim[1]===n||(r.setDimensions(),r.$el.trigger("slideshow_resized",r),r.gotoPage(r.currentPage,r.playing,null,-1)),void 0===t&&r.checkResize()}),e?2e3:500)},r.setDimensions=function(){r.$wrapper.find(".anythingWindow, .anythingBase, .panel")[t.fn.addBack?"addBack":"andSelf"]().css({width:"",height:""}),r.width=r.$el.width(),r.height=r.$el.height(),r.outerPad=[r.$wrapper.innerWidth()-r.$wrapper.width(),r.$wrapper.innerHeight()-r.$wrapper.height()];var e,i,n,a,o=0,l={width:"100%",height:"100%"},c=s.showMultiple>1&&"horizontal"===s.mode?r.width||r.$window.width()/s.showMultiple:r.$window.width(),d=s.showMultiple>1&&"vertical"===s.mode?r.height/s.showMultiple||r.$window.height()/s.showMultiple:r.$window.height();if(s.expand){if(r.lastDim=[r.$outer.width(),r.$outer.height()],e=r.lastDim[0]-r.outerPad[0],i=r.lastDim[1]-r.outerPad[1],s.aspectRatio&&s.aspectRatio<r.width){var u=i*s.aspectRatio;if(u<e)e=u;else{var h=e/s.aspectRatio;h<i&&(i=h)}}r.$wrapper.add(r.$window).css({width:e,height:i}),r.height=i=s.showMultiple>1&&"vertical"===s.mode?d:i,r.width=c=s.showMultiple>1&&"horizontal"===s.mode?e/s.showMultiple:e,r.$items.css({width:c,height:d})}r.$items.each((function(d){a=t(this),n=a.children(),s.resizeContents?(e=r.width,i=r.height,a.css({width:e,height:i}),n.length&&("EMBED"===n[0].tagName&&n.attr(l),"OBJECT"===n[0].tagName&&n.find("embed").attr(l),1===n.length&&n.css(l))):("vertical"===s.mode?(e=a.css("display","inline-block").width(),a.css("display","")):e=a.width()||r.width,1===n.length&&e>=c&&(e=n.width()>=c?c:n.width(),n.css("max-width",e)),a.css({width:e,height:""}),(i=1===n.length?n.outerHeight(!0):a.height())<=r.outerPad[1]&&(i=r.height),a.css("height",i)),r.panelSize[d]=[e,i,o],o+="vertical"===s.mode?i:e})),r.$el.css("vertical"===s.mode?"height":"width","fade"===s.mode?r.width:o)},r.getDim=function(t){var e,i,n=r.width,a=r.height;if(r.pages<1||isNaN(t))return[n,a];if(t=s.infiniteSlides&&r.pages>1?t:t-1,(i=r.panelSize[t])&&(n=i[0]||n,a=i[1]||a),s.showMultiple>1)for(i=1;i<s.showMultiple;i++)e=r.panelSize[t+i]?t+i:t,"vertical"===s.mode?(n=Math.max(n,r.panelSize[e][0]),a+=r.panelSize[e][1]):(n+=r.panelSize[e][0],a=Math.max(a,r.panelSize[e][1]));return[n,a]},r.goForward=function(t,e){r.gotoPage(r[s.allowRapidChange?"targetPage":"currentPage"]+s.changeBy*(e?-1:1),t)},r.goBack=function(t){r.gotoPage(r[s.allowRapidChange?"targetPage":"currentPage"]-s.changeBy,t)},r.gotoPage=function(e,i,n,a){if(!0!==i&&(i=!1,r.startStop(!1),r.makeActive()),/^[#|.]/.test(e)&&t(e).length&&(e=t(e).closest(".panel").index()+r.adj),1!==s.changeBy){var o=r.pages-r.adjustMultiple;e<1&&(e=s.stopAtEnd?1:s.infiniteSlides?r.pages+e:s.showMultiple>1-e?1:o),e>r.pages?e=s.stopAtEnd?r.pages:s.showMultiple>1-e?1:e-=o:e>=o&&(e=o)}r.pages<=1||(r.$lastPage=r.$currentPage,"number"!=typeof e&&(e=parseInt(e,10)||s.startPanel,r.setCurrentPage(e)),i&&s.isVideoPlaying(r)||(s.stopAtEnd&&!s.infiniteSlides&&e>r.pages-s.showMultiple&&(e=r.pages-s.showMultiple+1),r.exactPage=e,e>r.pages+1-r.adj&&(e=s.infiniteSlides||s.stopAtEnd?r.pages:1),e<r.adj&&(e=s.infiniteSlides||s.stopAtEnd?1:r.pages),s.infiniteSlides||(r.exactPage=e),r.currentPage=e>r.pages?r.pages:e<1?1:r.currentPage,r.$currentPage=r.$items.eq(r.currentPage-r.adj),r.targetPage=0===e?r.pages:e>r.pages?1:e,r.$targetPage=r.$items.eq(r.targetPage-r.adj),(a=void 0!==a?a:s.animationTime)>=0&&r.$el.trigger("slide_init",r),a>0&&!0===s.toggleControls&&r.slideControls(!0),s.buildNavigation&&r.setNavigation(r.targetPage),!0!==i&&(i=!1),(!i||s.stopAtEnd&&e===r.pages)&&r.startStop(!1),a>=0&&r.$el.trigger("slide_begin",r),setTimeout((function(t){var i,o=!0;s.allowRapidChange&&r.$wrapper.add(r.$el).add(r.$items).stop(!0,!0),s.resizeContents||(i=r.getDim(e),t={},r.$wrapper.width()!==i[0]&&(t.width=i[0]||r.width,o=!1),r.$wrapper.height()!==i[1]&&(t.height=i[1]||r.height,o=!1),o||r.$wrapper.filter(":not(:animated)").animate(t,{queue:!1,duration:a<0?0:a,easing:s.easing})),"fade"===s.mode?r.$lastPage[0]!==r.$targetPage[0]?(r.fadeIt(r.$lastPage,0,a),r.fadeIt(r.$targetPage,1,a,(function(){r.endAnimation(e,n,a)}))):r.endAnimation(e,n,a):((t={})[r.dir]=-r.panelSize[s.infiniteSlides&&r.pages>1?e:e-1][2],"vertical"!==s.mode||s.resizeContents||(t.width=i[0]),r.$el.filter(":not(:animated)").animate(t,{queue:!1,duration:a<0?0:a,easing:s.easing,complete:function(){r.endAnimation(e,n,a)}}))}),parseInt(s.delayBeforeAnimate,10)||0)))},r.endAnimation=function(t,e,i){0===t?(r.$el.css(r.dir,"fade"===s.mode?0:-r.panelSize[r.pages][2]),t=r.pages):t>r.pages&&(r.$el.css(r.dir,"fade"===s.mode?0:-r.panelSize[1][2]),t=1),r.exactPage=t,r.setCurrentPage(t,!1),"fade"===s.mode&&r.fadeIt(r.$items.not(":eq("+(t-r.adj)+")"),0,0),r.hovered||r.slideControls(!1),s.hashTags&&r.setHash(t),i>=0&&r.$el.trigger("slide_complete",r),"function"==typeof e&&e(r),s.autoPlayLocked&&!r.playing&&setTimeout((function(){r.startStop(!0)}),s.resumeDelay-(s.autoPlayDelayed?s.delay:0))},r.fadeIt=function(e,i,n,a){var o=e.filter(":not(:animated)"),r=n<0?0:n;s.resumeOnVisible?(1===i&&o.css("visibility","visible"),o.fadeTo(r,i,(function(){0===i&&o.css("visibility","hidden"),t.isFunction(a)&&a()}))):o[0===i?"fadeOut":"fadeIn"](r,a)},r.setCurrentPage=function(t,e){if(t=parseInt(t,10),!(r.pages<1||0===t||isNaN(t))){if(t>r.pages+1-r.adj&&(t=r.pages-r.adj),t<r.adj&&(t=1),s.buildArrows&&!s.infiniteSlides&&s.stopAtEnd&&(r.$forward[t===r.pages-r.adjustMultiple?"addClass":"removeClass"]("disabled"),r.$back[1===t?"addClass":"removeClass"]("disabled"),t===r.pages&&r.playing&&r.startStop()),!e){var i=r.getDim(t);r.$wrapper.css({width:i[0],height:i[1]}).add(r.$window).scrollLeft(0).scrollTop(0),r.$el.css(r.dir,"fade"===s.mode?0:-r.panelSize[s.infiniteSlides&&r.pages>1?t:t-1][2])}r.currentPage=t,r.$currentPage=r.$items.removeClass("activePage").eq(t-r.adj).addClass("activePage"),s.buildNavigation&&r.setNavigation(t)}},r.setNavigation=function(t){r.$nav.find(".cur").removeClass("cur").end().find("a").eq(t-1).addClass("cur")},r.makeActive=function(){r.$wrapper.hasClass("activeSlider")||(t(".activeSlider").removeClass("activeSlider"),r.$wrapper.addClass("activeSlider"))},r.gotoHash=function(){var i=e.location.hash,n=i.indexOf("&"),a=i.match(r.regex);return null!==a||/^#&/.test(i)||/#!?\//.test(i)||/\=/.test(i)?null!==a&&(a=s.hashTags?parseInt(a[1],10):null):(i=i.substring(0,n>=0?n:i.length),a=t(i).length&&t(i).closest(".anythingBase")[0]===r.el?r.$items.index(t(i).closest(".panel"))+r.adj:null),a},r.setHash=function(t){var i="panel"+r.runTimes+"-",n=e.location.hash;void 0!==n&&(e.location.hash=n.indexOf(i)>0?n.replace(r.regex,i+t):n+"&"+i+t)},r.slideControls=function(t){var e=t?"slideDown":"slideUp",i=t?0:s.animationTime,n=t?s.animationTime:0,a=t?1:0,o=t?0:1;s.toggleControls&&r.$controls.stop(!0,!0).delay(i)[e](s.animationTime/2).delay(n),s.buildArrows&&s.toggleArrows&&(!r.hovered&&r.playing&&(o=1,a=0),r.$forward.stop(!0,!0).delay(i).animate({right:r.arrowRight+o*r.arrowWidth,opacity:a},s.animationTime/2),r.$back.stop(!0,!0).delay(i).animate({left:r.arrowLeft+o*r.arrowWidth,opacity:a},s.animationTime/2))},r.clearTimer=function(t){r.timer&&(e.clearInterval(r.timer),!t&&r.slideshow&&(r.$el.trigger("slideshow_stop",r),r.slideshow=!1))},r.startStop=function(t,n){!0!==t&&(t=!1),r.playing=t,t&&!n&&(r.$el.trigger("slideshow_start",r),r.slideshow=!0),s.buildStartStop&&(r.$startStop.toggleClass("playing",t).find("span").html(t?s.stopText:s.startText),"hidden"===r.$startStop.find("span").css("visibility")&&r.$startStop.addClass(s.tooltipClass).attr("title",t?s.stopText:s.startText)),t?(r.clearTimer(!0),r.timer=e.setInterval((function(){i.hidden||i.webkitHidden||i.mozHidden||i.msHidden?s.autoPlayLocked||r.startStop():s.isVideoPlaying(r)?s.resumeOnVideoEnd||r.startStop():r.goForward(!0,s.playRtl)}),s.delay)):r.clearTimer()},r.init()},t.anythingSlider.defaults={theme:"default",mode:"horiz",expand:!1,resizeContents:!0,showMultiple:!1,easing:"swing",buildArrows:!0,buildNavigation:!0,buildStartStop:!0,toggleArrows:!1,toggleControls:!1,startText:"Start",stopText:"Stop",forwardText:"&raquo;",backText:"&laquo;",tooltipClass:"tooltip",enableArrows:!0,enableNavigation:!0,enableStartStop:!0,enableKeyboard:!0,startPanel:1,changeBy:1,hashTags:!0,infiniteSlides:!0,navigationFormatter:null,navigationSize:!1,autoPlay:!1,autoPlayLocked:!1,autoPlayDelayed:!1,pauseOnHover:!0,stopAtEnd:!1,playRtl:!1,delay:3e3,resumeDelay:15e3,animationTime:600,delayBeforeAnimate:0,clickForwardArrow:"click",clickBackArrow:"click",clickControls:"click focusin",clickSlideshow:"click",allowRapidChange:!1,resumeOnVideoEnd:!0,resumeOnVisible:!0,isVideoPlaying:function(t){return!1}},t.fn.anythingSlider=function(e,i){return this.each((function(){var n,a=t(this).data("AnythingSlider");(typeof e).match("object|undefined")?a?a.updateSlider():new t.anythingSlider(this,e):/\d/.test(e)&&!isNaN(e)&&a?(n="number"==typeof e?e:parseInt(t.trim(e),10))>=1&&n<=a.pages&&a.gotoPage(n,!1,i):/^[#|.]/.test(e)&&t(e).length&&a.gotoPage(e,!1,i)}))}}(jQuery,window,document),function(t,e){var i,n,a,s,o,r,l,c,d,u,h,p,f,m=Array.prototype.slice,g=decodeURIComponent,v=t.param,b=t.bbq=t.bbq||{},y=t.event.special,_="hashchange",x="querystring",w="fragment",C="elemUrlAttr",k="href",$="src",S=/^.*\?|#.*$/g,T={};function I(t){return"string"==typeof t}function D(t){var e=m.call(arguments,1);return function(){return t.apply(this,e.concat(m.call(arguments)))}}function A(e,a,o,r,l){var c,p,m,v,b;return r!==i?(b=(m=o.match(e?u:/^([^#?]*)\??([^#]*)(#?.*)/))[3]||"",2===l&&I(r)?p=r.replace(e?d:S,""):(v=s(m[2]),r=I(r)?s[e?w:x](r):r,p=2===l?r:1===l?t.extend({},r,v):t.extend({},v,r),p=n(p),e&&(p=p.replace(h,g))),c=m[1]+(e?f:p||!m[1]?"?":"")+p+b):c=a(o!==i?o:location.href),c}function P(t,e,n){return e===i||"boolean"==typeof e?(n=e,e=v[t?w:x]()):e=I(e)?e.replace(t?d:S,""):e,s(e,n)}function O(e,n,a,s){return I(a)||"object"==typeof a||(s=a,a=n,n=i),this.each((function(){var i=t(this),o=n||c()[(this.nodeName||"").toLowerCase()]||"",r=o&&i.attr(o)||"";i.attr(o,v[e](r,a,s))}))}v[x]=D(A,0,(function(t){return t.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")})),v[w]=a=D(A,1,(function(t){return t.replace(u,"$2")})),v.sorted=n=function(e,i){var n=[],a={};return t.each(v(e,i).split("&"),(function(t,e){var i=e.replace(/(?:%5B|=).*$/,""),s=a[i];s||(s=a[i]=[],n.push(i)),s.push(e)})),t.map(n.sort(),(function(t){return a[t]})).join("&")},a.noEscape=function(e){e=e||"";var i=t.map(e.split(""),encodeURIComponent);h=new RegExp(i.join("|"),"g")},a.noEscape(",/"),a.ajaxCrawlable=function(t){return t!==i&&(t?(d=/^.*(?:#!|#)/,u=/^([^#]*)(?:#!|#)?(.*)$/,f="#!"):(d=/^.*#/,u=/^([^#]*)#?(.*)$/,f="#"),p=!!t),p},a.ajaxCrawlable(0),t.deparam=s=function(e,n){var a={},s={true:!0,false:!1,null:null};return t.each(e.replace(/\+/g," ").split("&"),(function(e,o){var r,l=o.split("="),c=g(l[0]),d=a,u=0,h=c.split("]["),p=h.length-1;if(/\[/.test(h[0])&&/\]$/.test(h[p])?(h[p]=h[p].replace(/\]$/,""),p=(h=h.shift().split("[").concat(h)).length-1):p=0,2===l.length)if(r=g(l[1]),n&&(r=r&&!isNaN(r)?+r:"undefined"===r?i:s[r]!==i?s[r]:r),p)for(;u<=p;u++)d=d[c=""===h[u]?d.length:h[u]]=u<p?d[c]||(h[u+1]&&isNaN(h[u+1])?{}:[]):r;else t.isArray(a[c])?a[c].push(r):a[c]!==i?a[c]=[a[c],r]:a[c]=r;else c&&(a[c]=n?i:"")})),a},s[x]=D(P,0),s[w]=o=D(P,1),t[C]||(t[C]=function(e){return t.extend(T,e)})({a:k,base:k,iframe:$,img:$,input:$,form:"action",link:k,script:$}),c=t[C],t.fn[x]=D(O,x),t.fn[w]=D(O,w),b.pushState=r=function(t,e){I(t)&&/^#/.test(t)&&e===i&&(e=2);var n=t!==i,s=a(location.href,n?t:{},n?e:2);location.href=s},b.getState=l=function(t,e){return t===i||"boolean"==typeof t?o(t):o(e)[t]},b.removeState=function(e){var n={};e!==i&&(n=l(),t.each(t.isArray(e)?e:arguments,(function(t,e){delete n[e]}))),r(n,2)},y[_]=t.extend(y[_],{add:function(e){var n;function o(t){var e=t[w]=a();t.getState=function(t,n){return t===i||"boolean"==typeof t?s(e,t):s(e,n)[t]},n.apply(this,arguments)}if(t.isFunction(e))return n=e,o;n=e.handler,e.handler=o}})}(jQuery),function(t,e,i){var n,a="hashchange",s=document,o=t.event.special,r=s.documentMode,l="on"+a in e&&(r===i||r>7);function c(t){return"#"+(t=t||location.href).replace(/^[^#]*#?(.*)$/,"$1")}t.fn[a]=function(t){return t?this.bind(a,t):this.trigger(a)},t.fn[a].delay=50,o[a]=t.extend(o[a],{setup:function(){if(l)return!1;t(n.start)},teardown:function(){if(l)return!1;t(n.stop)}}),n=function(){var n,o,r,d={},u=c(),h=function(t){return t},p=h,f=h;function m(){var i=c(),s=f(u);i!==u?(p(u=i,s),t(e).trigger(a)):s!==u&&(location.href=location.href.replace(/#.*/,"")+s),n=setTimeout(m,t.fn[a].delay)}return d.start=function(){n||m()},d.stop=function(){n&&clearTimeout(n),n=i},null!==navigator.userAgent.match(/MSIE/i)&&!l&&(d.start=function(){o||(r=(r=t.fn[a].src)&&r+c(),o=t('<iframe tabindex="-1" title="empty"/>').hide().one("load",(function(){r||p(c()),m()})).attr("src",r||"javascript:0").insertAfter("body")[0].contentWindow,s.onpropertychange=function(){try{"title"===event.propertyName&&(o.document.title=s.title)}catch(t){}})},d.stop=h,f=function(){return c(o.location.href)},p=function(e,i){var n=o.document,r=t.fn[a].domain;e!==i&&(n.title=s.title,n.open(),r&&n.write('<script>document.domain="'+r+'"<\/script>'),n.close(),o.location.hash=e)}),d}()}(jQuery,this),function(t){function e(e){var i=(e||"").split(/ /),n={center:"50%",left:"0%",right:"100%",top:"0%",bottom:"100%"},a=function(t){var e=(n[i[t]]||i[t]||"50%").match(/^([+-]=)?([+-]?\d+(\.\d*)?)(.*)$/);i[t]=[e[1],parseFloat(e[2]),e[4]||"px"]};return 1==i.length&&t.inArray(i[0],["top","bottom"])>-1&&(i[1]=i[0],i[0]="50%"),a(0),a(1),i}function i(i){i.set||function(i){i.start=e(t(i.elem).css("backgroundPosition")),i.end=e(i.end);for(var n=0;n<i.end.length;n++)i.end[n][0]&&(i.end[n][1]=i.start[n][1]+("-="==i.end[n][0]?-1:1)*i.end[n][1]);i.set=!0}(i),t(i.elem).css("background-position",i.pos*(i.end[0][1]-i.start[0][1])+i.start[0][1]+i.end[0][2]+" "+(i.pos*(i.end[1][1]-i.start[1][1])+i.start[1][1]+i.end[1][2]))}!!t.Tween?t.Tween.propHooks.backgroundPosition={get:function(i){return e(t(i.elem).css(i.prop))},set:i}:t.fx.step.backgroundPosition=i}(jQuery),function(t){"use strict";t.colorpicker=new function(){this.regional=[],this.regional[""]={ok:"OK",cancel:"Cancel",none:"None",button:"Color",title:"Pick a color",transparent:"Transparent",hsvH:"H",hsvS:"S",hsvV:"V",rgbR:"R",rgbG:"G",rgbB:"B",labL:"L",labA:"a",labB:"b",hslH:"H",hslS:"S",hslL:"L",cmykC:"C",cmykM:"M",cmykY:"Y",cmykK:"K",alphaA:"A"},this.swatches=[],this.swatches.html={black:{r:0,g:0,b:0},dimgray:{r:.4117647058823529,g:.4117647058823529,b:.4117647058823529},gray:{r:.5019607843137255,g:.5019607843137255,b:.5019607843137255},darkgray:{r:.6627450980392157,g:.6627450980392157,b:.6627450980392157},silver:{r:.7529411764705882,g:.7529411764705882,b:.7529411764705882},lightgrey:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},gainsboro:{r:.8627450980392157,g:.8627450980392157,b:.8627450980392157},whitesmoke:{r:.9607843137254902,g:.9607843137254902,b:.9607843137254902},white:{r:1,g:1,b:1},rosybrown:{r:.7372549019607844,g:.5607843137254902,b:.5607843137254902},indianred:{r:.803921568627451,g:.3607843137254902,b:.3607843137254902},brown:{r:.6470588235294118,g:.16470588235294117,b:.16470588235294117},firebrick:{r:.6980392156862745,g:.13333333333333333,b:.13333333333333333},lightcoral:{r:.9411764705882353,g:.5019607843137255,b:.5019607843137255},maroon:{r:.5019607843137255,g:0,b:0},darkred:{r:.5450980392156862,g:0,b:0},red:{r:1,g:0,b:0},snow:{r:1,g:.9803921568627451,b:.9803921568627451},salmon:{r:.9803921568627451,g:.5019607843137255,b:.4470588235294118},mistyrose:{r:1,g:.8941176470588236,b:.8823529411764706},tomato:{r:1,g:.38823529411764707,b:.2784313725490196},darksalmon:{r:.9137254901960784,g:.5882352941176471,b:.47843137254901963},orangered:{r:1,g:.27058823529411763,b:0},coral:{r:1,g:.4980392156862745,b:.3137254901960784},lightsalmon:{r:1,g:.6274509803921569,b:.47843137254901963},sienna:{r:.6274509803921569,g:.3215686274509804,b:.17647058823529413},seashell:{r:1,g:.9607843137254902,b:.9333333333333333},chocolate:{r:.8235294117647058,g:.4117647058823529,b:.11764705882352941},saddlebrown:{r:.5450980392156862,g:.27058823529411763,b:.07450980392156863},sandybrown:{r:.9568627450980393,g:.6431372549019608,b:.3764705882352941},peachpuff:{r:1,g:.8549019607843137,b:.7254901960784313},peru:{r:.803921568627451,g:.5215686274509804,b:.24705882352941178},linen:{r:.9803921568627451,g:.9411764705882353,b:.9019607843137255},darkorange:{r:1,g:.5490196078431373,b:0},bisque:{r:1,g:.8941176470588236,b:.7686274509803922},burlywood:{r:.8705882352941177,g:.7215686274509804,b:.5294117647058824},tan:{r:.8235294117647058,g:.7058823529411765,b:.5490196078431373},antiquewhite:{r:.9803921568627451,g:.9215686274509803,b:.8431372549019608},navajowhite:{r:1,g:.8705882352941177,b:.6784313725490196},blanchedalmond:{r:1,g:.9215686274509803,b:.803921568627451},papayawhip:{r:1,g:.9372549019607843,b:.8352941176470589},orange:{r:1,g:.6470588235294118,b:0},moccasin:{r:1,g:.8941176470588236,b:.7098039215686275},wheat:{r:.9607843137254902,g:.8705882352941177,b:.7019607843137254},oldlace:{r:.9921568627450981,g:.9607843137254902,b:.9019607843137255},floralwhite:{r:1,g:.9803921568627451,b:.9411764705882353},goldenrod:{r:.8549019607843137,g:.6470588235294118,b:.12549019607843137},darkgoldenrod:{r:.7215686274509804,g:.5254901960784314,b:.043137254901960784},cornsilk:{r:1,g:.9725490196078431,b:.8627450980392157},gold:{r:1,g:.8431372549019608,b:0},palegoldenrod:{r:.9333333333333333,g:.9098039215686274,b:.6666666666666666},khaki:{r:.9411764705882353,g:.9019607843137255,b:.5490196078431373},lemonchiffon:{r:1,g:.9803921568627451,b:.803921568627451},darkkhaki:{r:.7411764705882353,g:.7176470588235294,b:.4196078431372549},beige:{r:.9607843137254902,g:.9607843137254902,b:.8627450980392157},lightgoldenrodyellow:{r:.9803921568627451,g:.9803921568627451,b:.8235294117647058},olive:{r:.5019607843137255,g:.5019607843137255,b:0},yellow:{r:1,g:1,b:0},lightyellow:{r:1,g:1,b:.8784313725490196},ivory:{r:1,g:1,b:.9411764705882353},olivedrab:{r:.4196078431372549,g:.5568627450980392,b:.13725490196078433},yellowgreen:{r:.6039215686274509,g:.803921568627451,b:.19607843137254902},darkolivegreen:{r:.3333333333333333,g:.4196078431372549,b:.1843137254901961},greenyellow:{r:.6784313725490196,g:1,b:.1843137254901961},lawngreen:{r:.48627450980392156,g:.9882352941176471,b:0},chartreuse:{r:.4980392156862745,g:1,b:0},darkseagreen:{r:.5607843137254902,g:.7372549019607844,b:.5607843137254902},forestgreen:{r:.13333333333333333,g:.5450980392156862,b:.13333333333333333},limegreen:{r:.19607843137254902,g:.803921568627451,b:.19607843137254902},lightgreen:{r:.5647058823529412,g:.9333333333333333,b:.5647058823529412},palegreen:{r:.596078431372549,g:.984313725490196,b:.596078431372549},darkgreen:{r:0,g:.39215686274509803,b:0},green:{r:0,g:.5019607843137255,b:0},lime:{r:0,g:1,b:0},honeydew:{r:.9411764705882353,g:1,b:.9411764705882353},mediumseagreen:{r:.23529411764705882,g:.7019607843137254,b:.44313725490196076},seagreen:{r:.1803921568627451,g:.5450980392156862,b:.3411764705882353},springgreen:{r:0,g:1,b:.4980392156862745},mintcream:{r:.9607843137254902,g:1,b:.9803921568627451},mediumspringgreen:{r:0,g:.9803921568627451,b:.6039215686274509},mediumaquamarine:{r:.4,g:.803921568627451,b:.6666666666666666},aquamarine:{r:.4980392156862745,g:1,b:.8313725490196079},turquoise:{r:.25098039215686274,g:.8784313725490196,b:.8156862745098039},lightseagreen:{r:.12549019607843137,g:.6980392156862745,b:.6666666666666666},mediumturquoise:{r:.2823529411764706,g:.8196078431372549,b:.8},darkslategray:{r:.1843137254901961,g:.30980392156862746,b:.30980392156862746},paleturquoise:{r:.6862745098039216,g:.9333333333333333,b:.9333333333333333},teal:{r:0,g:.5019607843137255,b:.5019607843137255},darkcyan:{r:0,g:.5450980392156862,b:.5450980392156862},darkturquoise:{r:0,g:.807843137254902,b:.8196078431372549},aqua:{r:0,g:1,b:1},cyan:{r:0,g:1,b:1},lightcyan:{r:.8784313725490196,g:1,b:1},azure:{r:.9411764705882353,g:1,b:1},cadetblue:{r:.37254901960784315,g:.6196078431372549,b:.6274509803921569},powderblue:{r:.6901960784313725,g:.8784313725490196,b:.9019607843137255},lightblue:{r:.6784313725490196,g:.8470588235294118,b:.9019607843137255},deepskyblue:{r:0,g:.7490196078431373,b:1},skyblue:{r:.5294117647058824,g:.807843137254902,b:.9215686274509803},lightskyblue:{r:.5294117647058824,g:.807843137254902,b:.9803921568627451},steelblue:{r:.27450980392156865,g:.5098039215686274,b:.7058823529411765},aliceblue:{r:.9411764705882353,g:.9725490196078431,b:1},dodgerblue:{r:.11764705882352941,g:.5647058823529412,b:1},slategray:{r:.4392156862745098,g:.5019607843137255,b:.5647058823529412},lightslategray:{r:.4666666666666667,g:.5333333333333333,b:.6},lightsteelblue:{r:.6901960784313725,g:.7686274509803922,b:.8705882352941177},cornflowerblue:{r:.39215686274509803,g:.5843137254901961,b:.9294117647058824},royalblue:{r:.2549019607843137,g:.4117647058823529,b:.8823529411764706},midnightblue:{r:.09803921568627451,g:.09803921568627451,b:.4392156862745098},lavender:{r:.9019607843137255,g:.9019607843137255,b:.9803921568627451},navy:{r:0,g:0,b:.5019607843137255},darkblue:{r:0,g:0,b:.5450980392156862},mediumblue:{r:0,g:0,b:.803921568627451},blue:{r:0,g:0,b:1},ghostwhite:{r:.9725490196078431,g:.9725490196078431,b:1},darkslateblue:{r:.2823529411764706,g:.23921568627450981,b:.5450980392156862},slateblue:{r:.41568627450980394,g:.35294117647058826,b:.803921568627451},mediumslateblue:{r:.4823529411764706,g:.40784313725490196,b:.9333333333333333},mediumpurple:{r:.5764705882352941,g:.4392156862745098,b:.8588235294117647},blueviolet:{r:.5411764705882353,g:.16862745098039217,b:.8862745098039215},indigo:{r:.29411764705882354,g:0,b:.5098039215686274},darkorchid:{r:.6,g:.19607843137254902,b:.8},darkviolet:{r:.5803921568627451,g:0,b:.8274509803921568},mediumorchid:{r:.7294117647058823,g:.3333333333333333,b:.8274509803921568},thistle:{r:.8470588235294118,g:.7490196078431373,b:.8470588235294118},plum:{r:.8666666666666667,g:.6274509803921569,b:.8666666666666667},violet:{r:.9333333333333333,g:.5098039215686274,b:.9333333333333333},purple:{r:.5019607843137255,g:0,b:.5019607843137255},darkmagenta:{r:.5450980392156862,g:0,b:.5450980392156862},magenta:{r:1,g:0,b:1},fuchsia:{r:1,g:0,b:1},orchid:{r:.8549019607843137,g:.4392156862745098,b:.8392156862745098},mediumvioletred:{r:.7803921568627451,g:.08235294117647059,b:.5215686274509804},deeppink:{r:1,g:.0784313725490196,b:.5764705882352941},hotpink:{r:1,g:.4117647058823529,b:.7058823529411765},palevioletred:{r:.8588235294117647,g:.4392156862745098,b:.5764705882352941},lavenderblush:{r:1,g:.9411764705882353,b:.9607843137254902},crimson:{r:.8627450980392157,g:.0784313725490196,b:.23529411764705882},pink:{r:1,g:.7529411764705882,b:.796078431372549},lightpink:{r:1,g:.7137254901960784,b:.7568627450980392}}};var e=0,i={full:["header","map","bar","hex","hsv","rgb","alpha","lab","cmyk","preview","swatches","footer"],popup:["map","bar","hex","hsv","rgb","alpha","preview","footer"],draggable:["header","map","bar","hex","hsv","rgb","alpha","preview","footer"],inline:["map","bar","hex","hsv","rgb","alpha","preview"]},n=function(t){var e=Math.round(t).toString(16);return 1===e.length&&(e="0"+e),e.toLowerCase()},a=function(t){var e,i;return(i=/^#?([a-fA-F0-9]{1,6})$/.exec(t))?(e=parseInt(i[1],16),new o((e>>16&255)/255,(e>>8&255)/255,(255&e)/255)):new o},s={header:function(e){var i=null;this.init=function(){var n;i=t((n='<span class="ui-dialog-title">'+(e.options.title||e._getRegional("title"))+"</span>",!e.inline&&e.options.showCloseButton&&(n+='<a href="#" class="ui-dialog-titlebar-close ui-corner-all" role="button"><span class="ui-icon ui-icon-closethick">close</span></a>'),'<div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix">'+n+"</div>")).prependTo(e.dialog);var a=t(".ui-dialog-titlebar-close",i);e._hoverable(a),e._focusable(a),a.click((function(t){t.preventDefault(),e.close()})),!e.inline&&e.options.draggable&&e.dialog.draggable({handle:i})}},map:function(e){var i,n,a,s,o=this,r=null;i=function(s){if(e.opened){var o=t(".ui-colorpicker-map-layer-pointer",r),l=o.offset(),c=o.width(),d=o.height(),u=s.pageX-l.left,h=s.pageY-l.top;u>=0&&u<c&&h>=0&&h<d&&(s.stopImmediatePropagation(),s.preventDefault(),r.unbind("mousedown",i),t(document).bind("mouseup",n),t(document).bind("mousemove",a),a(s))}},n=function(e){e.stopImmediatePropagation(),e.preventDefault(),t(document).unbind("mouseup",n),t(document).unbind("mousemove",a),r.bind("mousedown",i)},a=function(i){if(i.stopImmediatePropagation(),i.preventDefault(),i.pageX!==o.x||i.pageY!==o.y){o.x=i.pageX,o.y=i.pageY;var n=t(".ui-colorpicker-map-layer-pointer",r),a=n.offset(),s=n.width(),l=n.height(),c=i.pageX-a.left,d=i.pageY-a.top;switch(c=Math.max(0,Math.min(c/s,1)),d=Math.max(0,Math.min(d/l,1)),e.mode){case"h":e.color.setHSV(null,c,1-d);break;case"s":case"a":e.color.setHSV(c,null,1-d);break;case"v":e.color.setHSV(c,1-d,null);break;case"r":e.color.setRGB(null,1-d,c);break;case"g":e.color.setRGB(1-d,null,c);break;case"b":e.color.setRGB(c,1-d,null)}e._change()}},s=function(){return'<div class="ui-colorpicker-map ui-colorpicker-border"><span class="ui-colorpicker-map-layer-1">&nbsp;</span><span class="ui-colorpicker-map-layer-2">&nbsp;</span>'+(e.options.alpha?'<span class="ui-colorpicker-map-layer-alpha">&nbsp;</span>':"")+'<span class="ui-colorpicker-map-layer-pointer"><span class="ui-colorpicker-map-pointer"></span></span></div>'},this.update=function(){switch(e.mode){case"h":t(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 0",opacity:""}).show(),t(".ui-colorpicker-map-layer-2",r).hide();break;case"s":case"a":t(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 -260px",opacity:""}).show(),t(".ui-colorpicker-map-layer-2",r).css({"background-position":"0 -520px",opacity:""}).show();break;case"v":t(r).css("background-color","black"),t(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 -780px",opacity:""}).show(),t(".ui-colorpicker-map-layer-2",r).hide();break;case"r":t(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 -1040px",opacity:""}).show(),t(".ui-colorpicker-map-layer-2",r).css({"background-position":"0 -1300px",opacity:""}).show();break;case"g":t(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 -1560px",opacity:""}).show(),t(".ui-colorpicker-map-layer-2",r).css({"background-position":"0 -1820px",opacity:""}).show();break;case"b":t(".ui-colorpicker-map-layer-1",r).css({"background-position":"0 -2080px",opacity:""}).show(),t(".ui-colorpicker-map-layer-2",r).css({"background-position":"0 -2340px",opacity:""}).show()}o.repaint()},this.repaint=function(){var i=t(".ui-colorpicker-map-layer-pointer",r),n=0,a=0;switch(e.mode){case"h":n=e.color.getHSV().s*i.width(),a=(1-e.color.getHSV().v)*i.width(),t(r).css("background-color",e.color.copy().normalize().toCSS());break;case"s":case"a":n=e.color.getHSV().h*i.width(),a=(1-e.color.getHSV().v)*i.width(),t(".ui-colorpicker-map-layer-2",r).css("opacity",1-e.color.getHSV().s);break;case"v":n=e.color.getHSV().h*i.width(),a=(1-e.color.getHSV().s)*i.width(),t(".ui-colorpicker-map-layer-1",r).css("opacity",e.color.getHSV().v);break;case"r":n=e.color.getRGB().b*i.width(),a=(1-e.color.getRGB().g)*i.width(),t(".ui-colorpicker-map-layer-2",r).css("opacity",e.color.getRGB().r);break;case"g":n=e.color.getRGB().b*i.width(),a=(1-e.color.getRGB().r)*i.width(),t(".ui-colorpicker-map-layer-2",r).css("opacity",e.color.getRGB().g);break;case"b":n=e.color.getRGB().r*i.width(),a=(1-e.color.getRGB().g)*i.width(),t(".ui-colorpicker-map-layer-2",r).css("opacity",e.color.getRGB().b)}e.options.alpha&&t(".ui-colorpicker-map-layer-alpha",r).css("opacity",1-e.color.getAlpha()),t(".ui-colorpicker-map-pointer",r).css({left:n-7,top:a-7})},this.init=function(){(r=t(s()).appendTo(t(".ui-colorpicker-map-container",e.dialog))).bind("mousedown",i)}},bar:function(e){var i,n,a,s,o=this,r=null;i=function(s){if(e.opened){var o=t(".ui-colorpicker-bar-layer-pointer",r),l=o.offset(),c=o.width(),d=o.height(),u=s.pageX-l.left,h=s.pageY-l.top;u>=0&&u<c&&h>=0&&h<d&&(s.stopImmediatePropagation(),s.preventDefault(),r.unbind("mousedown",i),t(document).bind("mouseup",n),t(document).bind("mousemove",a),a(s))}},n=function(e){e.stopImmediatePropagation(),e.preventDefault(),t(document).unbind("mouseup",n),t(document).unbind("mousemove",a),r.bind("mousedown",i)},a=function(i){if(i.stopImmediatePropagation(),i.preventDefault(),i.pageY!==o.y){o.y=i.pageY;var n=t(".ui-colorpicker-bar-layer-pointer",r),a=n.offset(),s=n.height(),l=i.pageY-a.top;switch(l=Math.max(0,Math.min(l/s,1)),e.mode){case"h":e.color.setHSV(1-l,null,null);break;case"s":e.color.setHSV(null,1-l,null);break;case"v":e.color.setHSV(null,null,1-l);break;case"r":e.color.setRGB(1-l,null,null);break;case"g":e.color.setRGB(null,1-l,null);break;case"b":e.color.setRGB(null,null,1-l);break;case"a":e.color.setAlpha(1-l)}e._change()}},s=function(){var t='<div class="ui-colorpicker-bar ui-colorpicker-border"><span class="ui-colorpicker-bar-layer-1">&nbsp;</span><span class="ui-colorpicker-bar-layer-2">&nbsp;</span><span class="ui-colorpicker-bar-layer-3">&nbsp;</span><span class="ui-colorpicker-bar-layer-4">&nbsp;</span>';return e.options.alpha&&(t+='<span class="ui-colorpicker-bar-layer-alpha">&nbsp;</span><span class="ui-colorpicker-bar-layer-alphabar">&nbsp;</span>'),t+='<span class="ui-colorpicker-bar-layer-pointer"><span class="ui-colorpicker-bar-pointer"></span></span></div>'},this.update=function(){switch(e.mode){case"h":case"s":case"v":case"r":case"g":case"b":t(".ui-colorpicker-bar-layer-alpha",r).show(),t(".ui-colorpicker-bar-layer-alphabar",r).hide();break;case"a":t(".ui-colorpicker-bar-layer-alpha",r).hide(),t(".ui-colorpicker-bar-layer-alphabar",r).show()}switch(e.mode){case"h":t(".ui-colorpicker-bar-layer-1",r).css({"background-position":"0 0",opacity:""}).show(),t(".ui-colorpicker-bar-layer-2",r).hide(),t(".ui-colorpicker-bar-layer-3",r).hide(),t(".ui-colorpicker-bar-layer-4",r).hide();break;case"s":t(".ui-colorpicker-bar-layer-1",r).css({"background-position":"0 -260px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-2",r).css({"background-position":"0 -520px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-3",r).hide(),t(".ui-colorpicker-bar-layer-4",r).hide();break;case"v":t(".ui-colorpicker-bar-layer-1",r).css({"background-position":"0 -520px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-2",r).hide(),t(".ui-colorpicker-bar-layer-3",r).hide(),t(".ui-colorpicker-bar-layer-4",r).hide();break;case"r":t(".ui-colorpicker-bar-layer-1",r).css({"background-position":"0 -1560px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-2",r).css({"background-position":"0 -1300px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-3",r).css({"background-position":"0 -780px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-4",r).css({"background-position":"0 -1040px",opacity:""}).show();break;case"g":t(".ui-colorpicker-bar-layer-1",r).css({"background-position":"0 -2600px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-2",r).css({"background-position":"0 -2340px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-3",r).css({"background-position":"0 -1820px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-4",r).css({"background-position":"0 -2080px",opacity:""}).show();break;case"b":t(".ui-colorpicker-bar-layer-1",r).css({"background-position":"0 -3640px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-2",r).css({"background-position":"0 -3380px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-3",r).css({"background-position":"0 -2860px",opacity:""}).show(),t(".ui-colorpicker-bar-layer-4",r).css({"background-position":"0 -3120px",opacity:""}).show();break;case"a":t(".ui-colorpicker-bar-layer-1",r).hide(),t(".ui-colorpicker-bar-layer-2",r).hide(),t(".ui-colorpicker-bar-layer-3",r).hide(),t(".ui-colorpicker-bar-layer-4",r).hide()}o.repaint()},this.repaint=function(){var i=t(".ui-colorpicker-bar-layer-pointer",r),n=0;switch(e.mode){case"h":n=(1-e.color.getHSV().h)*i.height();break;case"s":n=(1-e.color.getHSV().s)*i.height(),t(".ui-colorpicker-bar-layer-2",r).css("opacity",1-e.color.getHSV().v),t(r).css("background-color",e.color.copy().normalize().toCSS());break;case"v":n=(1-e.color.getHSV().v)*i.height(),t(r).css("background-color",e.color.copy().normalize().toCSS());break;case"r":n=(1-e.color.getRGB().r)*i.height(),t(".ui-colorpicker-bar-layer-2",r).css("opacity",Math.max(0,e.color.getRGB().b-e.color.getRGB().g)),t(".ui-colorpicker-bar-layer-3",r).css("opacity",Math.max(0,e.color.getRGB().g-e.color.getRGB().b)),t(".ui-colorpicker-bar-layer-4",r).css("opacity",Math.min(e.color.getRGB().b,e.color.getRGB().g));break;case"g":n=(1-e.color.getRGB().g)*i.height(),t(".ui-colorpicker-bar-layer-2",r).css("opacity",Math.max(0,e.color.getRGB().b-e.color.getRGB().r)),t(".ui-colorpicker-bar-layer-3",r).css("opacity",Math.max(0,e.color.getRGB().r-e.color.getRGB().b)),t(".ui-colorpicker-bar-layer-4",r).css("opacity",Math.min(e.color.getRGB().r,e.color.getRGB().b));break;case"b":n=(1-e.color.getRGB().b)*i.height(),t(".ui-colorpicker-bar-layer-2",r).css("opacity",Math.max(0,e.color.getRGB().r-e.color.getRGB().g)),t(".ui-colorpicker-bar-layer-3",r).css("opacity",Math.max(0,e.color.getRGB().g-e.color.getRGB().r)),t(".ui-colorpicker-bar-layer-4",r).css("opacity",Math.min(e.color.getRGB().r,e.color.getRGB().g));break;case"a":n=(1-e.color.getAlpha())*i.height(),t(r).css("background-color",e.color.copy().normalize().toCSS())}"a"!==e.mode&&t(".ui-colorpicker-bar-layer-alpha",r).css("opacity",1-e.color.getAlpha()),t(".ui-colorpicker-bar-pointer",r).css("top",n-3)},this.init=function(){(r=t(s()).appendTo(t(".ui-colorpicker-bar-container",e.dialog))).bind("mousedown",i)}},preview:function(e){var i=null;this.init=function(){i=t('<div class="ui-colorpicker-preview ui-colorpicker-border"><div class="ui-colorpicker-preview-initial"><div class="ui-colorpicker-preview-initial-alpha"></div></div><div class="ui-colorpicker-preview-current"><div class="ui-colorpicker-preview-current-alpha"></div></div></div>').appendTo(t(".ui-colorpicker-preview-container",e.dialog)),t(".ui-colorpicker-preview-initial",i).click((function(){e.color=e.currentColor.copy(),e._change()}))},this.update=function(){e.options.alpha?t(".ui-colorpicker-preview-initial-alpha, .ui-colorpicker-preview-current-alpha",i).show():t(".ui-colorpicker-preview-initial-alpha, .ui-colorpicker-preview-current-alpha",i).hide(),this.repaint()},this.repaint=function(){t(".ui-colorpicker-preview-initial",i).css("background-color",e.currentColor.toCSS()).attr("title",e.currentColor.toHex()),t(".ui-colorpicker-preview-initial-alpha",i).css("opacity",1-e.currentColor.getAlpha()),t(".ui-colorpicker-preview-current",i).css("background-color",e.color.toCSS()).attr("title",e.color.toHex()),t(".ui-colorpicker-preview-current-alpha",i).css("opacity",1-e.color.getAlpha())}},hsv:function(e){var i,n=null;i=function(){var t="";return e.options.hsv&&(t+='<div class="ui-colorpicker-hsv-h"><input class="ui-colorpicker-mode" type="radio" value="h"/><label>'+e._getRegional("hsvH")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="360" size="10"/><span class="ui-colorpicker-unit">&deg;</span></div><div class="ui-colorpicker-hsv-s"><input class="ui-colorpicker-mode" type="radio" value="s"/><label>'+e._getRegional("hsvS")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-hsv-v"><input class="ui-colorpicker-mode" type="radio" value="v"/><label>'+e._getRegional("hsvV")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div>'),'<div class="ui-colorpicker-hsv">'+t+"</div>"},this.init=function(){n=t(i()).appendTo(t(".ui-colorpicker-hsv-container",e.dialog)),t(".ui-colorpicker-mode",n).click((function(){e.mode=t(this).val(),e._updateAllParts()})),t(".ui-colorpicker-number",n).bind("change keyup",(function(){e.color.setHSV(t(".ui-colorpicker-hsv-h .ui-colorpicker-number",n).val()/360,t(".ui-colorpicker-hsv-s .ui-colorpicker-number",n).val()/100,t(".ui-colorpicker-hsv-v .ui-colorpicker-number",n).val()/100),e._change()}))},this.repaint=function(){var i=e.color.getHSV();i.h*=360,i.s*=100,i.v*=100,t.each(i,(function(e,i){var a=t(".ui-colorpicker-hsv-"+e+" .ui-colorpicker-number",n);i=Math.round(i),a.val()!==i&&a.val(i)}))},this.update=function(){t(".ui-colorpicker-mode",n).each((function(){t(this).attr("checked",t(this).val()===e.mode)})),this.repaint()}},rgb:function(e){var i,n=null;i=function(){var t="";return e.options.rgb&&(t+='<div class="ui-colorpicker-rgb-r"><input class="ui-colorpicker-mode" type="radio" value="r"/><label>'+e._getRegional("rgbR")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div><div class="ui-colorpicker-rgb-g"><input class="ui-colorpicker-mode" type="radio" value="g"/><label>'+e._getRegional("rgbG")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div><div class="ui-colorpicker-rgb-b"><input class="ui-colorpicker-mode" type="radio" value="b"/><label>'+e._getRegional("rgbB")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>'),'<div class="ui-colorpicker-rgb">'+t+"</div>"},this.init=function(){n=t(i()).appendTo(t(".ui-colorpicker-rgb-container",e.dialog)),t(".ui-colorpicker-mode",n).click((function(){e.mode=t(this).val(),e._updateAllParts()})),t(".ui-colorpicker-number",n).bind("change keyup",(function(){e.color.setRGB(t(".ui-colorpicker-rgb-r .ui-colorpicker-number",n).val()/255,t(".ui-colorpicker-rgb-g .ui-colorpicker-number",n).val()/255,t(".ui-colorpicker-rgb-b .ui-colorpicker-number",n).val()/255),e._change()}))},this.repaint=function(){t.each(e.color.getRGB(),(function(e,i){var a=t(".ui-colorpicker-rgb-"+e+" .ui-colorpicker-number",n);i=Math.round(255*i),a.val()!==i&&a.val(i)}))},this.update=function(){t(".ui-colorpicker-mode",n).each((function(){t(this).attr("checked",t(this).val()===e.mode)})),this.repaint()}},lab:function(e){var i=null;this.init=function(){i=t(function(){var t="";return e.options.hsv&&(t+='<div class="ui-colorpicker-lab-l"><label>'+e._getRegional("labL")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/></div><div class="ui-colorpicker-lab-a"><label>'+e._getRegional("labA")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div><div class="ui-colorpicker-lab-b"><label>'+e._getRegional("labB")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div>'),'<div class="ui-colorpicker-lab">'+t+"</div>"}()).appendTo(t(".ui-colorpicker-lab-container",e.dialog)),t(".ui-colorpicker-number",i).on("change keyup",(function(n){e.color.setLAB(parseInt(t(".ui-colorpicker-lab-l .ui-colorpicker-number",i).val(),10)/100,(parseInt(t(".ui-colorpicker-lab-a .ui-colorpicker-number",i).val(),10)+128)/255,(parseInt(t(".ui-colorpicker-lab-b .ui-colorpicker-number",i).val(),10)+128)/255),e._change()}))},this.repaint=function(){var n=e.color.getLAB();n.l*=100,n.a=255*n.a-128,n.b=255*n.b-128,t.each(n,(function(e,n){var a=t(".ui-colorpicker-lab-"+e+" .ui-colorpicker-number",i);n=Math.round(n),a.val()!==n&&a.val(n)}))},this.update=function(){this.repaint()}},cmyk:function(e){var i=null;this.init=function(){i=t(function(){var t="";return e.options.hsv&&(t+='<div class="ui-colorpicker-cmyk-c"><label>'+e._getRegional("cmykC")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-cmyk-m"><label>'+e._getRegional("cmykM")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-cmyk-y"><label>'+e._getRegional("cmykY")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-cmyk-k"><label>'+e._getRegional("cmykK")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'),'<div class="ui-colorpicker-cmyk">'+t+"</div>"}()).appendTo(t(".ui-colorpicker-cmyk-container",e.dialog)),t(".ui-colorpicker-number",i).on("change keyup",(function(n){e.color.setCMYK(parseInt(t(".ui-colorpicker-cmyk-c .ui-colorpicker-number",i).val(),10)/100,parseInt(t(".ui-colorpicker-cmyk-m .ui-colorpicker-number",i).val(),10)/100,parseInt(t(".ui-colorpicker-cmyk-y .ui-colorpicker-number",i).val(),10)/100,parseInt(t(".ui-colorpicker-cmyk-k .ui-colorpicker-number",i).val(),10)/100),e._change()}))},this.repaint=function(){t.each(e.color.getCMYK(),(function(e,n){var a=t(".ui-colorpicker-cmyk-"+e+" .ui-colorpicker-number",i);n=Math.round(100*n),a.val()!==n&&a.val(n)}))},this.update=function(){this.repaint()}},alpha:function(e){var i,n=null;i=function(){var t="";return e.options.alpha&&(t+='<div class="ui-colorpicker-a"><input class="ui-colorpicker-mode" name="mode" type="radio" value="a"/><label>'+e._getRegional("alphaA")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'),'<div class="ui-colorpicker-alpha">'+t+"</div>"},this.init=function(){n=t(i()).appendTo(t(".ui-colorpicker-alpha-container",e.dialog)),t(".ui-colorpicker-mode",n).click((function(){e.mode=t(this).val(),e._updateAllParts()})),t(".ui-colorpicker-number",n).bind("change keyup",(function(){e.color.setAlpha(t(".ui-colorpicker-a .ui-colorpicker-number",n).val()/100),e._change()}))},this.update=function(){t(".ui-colorpicker-mode",n).each((function(){t(this).attr("checked",t(this).val()===e.mode)})),this.repaint()},this.repaint=function(){var i=t(".ui-colorpicker-a .ui-colorpicker-number",n),a=Math.round(100*e.color.getAlpha());i.is(":focus")||i.val()===a||i.val(a)}},hex:function(e){var i,s=null;i=function(){var t="";return e.options.alpha&&(t+='<input class="ui-colorpicker-hex-alpha" type="text" maxlength="2" size="2"/>'),'<div class="ui-colorpicker-hex"><label>#</label>'+(t+='<input class="ui-colorpicker-hex-input" type="text" maxlength="6" size="6"/>')+"</div>"},this.init=function(){s=t(i()).appendTo(t(".ui-colorpicker-hex-container",e.dialog)),t(".ui-colorpicker-hex-input",s).bind("change keydown keyup",(function(e,i,n){/[^a-fA-F0-9]/.test(t(this).val())&&t(this).val(t(this).val().replace(/[^a-fA-F0-9]/,""))})),t(".ui-colorpicker-hex-input",s).bind("change keyup",(function(){e.color=a(t(this).val()).setAlpha(e.color.getAlpha()),e._change()})),t(".ui-colorpicker-hex-alpha",s).bind("change keydown keyup",(function(){/[^a-fA-F0-9]/.test(t(this).val())&&t(this).val(t(this).val().replace(/[^a-fA-F0-9]/,""))})),t(".ui-colorpicker-hex-alpha",s).bind("change keyup",(function(){e.color.setAlpha(parseInt(t(".ui-colorpicker-hex-alpha",s).val(),16)/255),e._change()}))},this.update=function(){this.repaint()},this.repaint=function(){t(".ui-colorpicker-hex-input",s).is(":focus")||t(".ui-colorpicker-hex-input",s).val(e.color.toHex(!0)),t(".ui-colorpicker-hex-alpha",s).is(":focus")||t(".ui-colorpicker-hex-alpha",s).val(n(255*e.color.getAlpha()))}},swatches:function(e){var i=null;this.init=function(){i=t(function(){var i="";return t.each(e._getSwatches(),(function(t,e){var n=new o(e.r,e.g,e.b).toCSS();i+='<div class="ui-colorpicker-swatch" style="background-color:'+n+'" title="'+t+'"></div>'})),'<div class="ui-colorpicker-swatches ui-colorpicker-border" style="width:'+e.options.swatchesWidth+'px">'+i+"</div>"}()).appendTo(t(".ui-colorpicker-swatches-container",e.dialog)),t(".ui-colorpicker-swatch",i).click((function(){e.color=e._parseColor(t(this).css("background-color")),e._change()}))}},footer:function(i){var n=null,a="ui-colorpicker-special-transparent-"+e,s="ui-colorpicker-special-none-"+e;this.init=function(){n=t(function(){var t="";return(i.options.alpha||!i.inline&&i.options.showNoneButton)&&(t+='<div class="ui-colorpicker-buttonset">',i.options.alpha&&(t+='<input type="radio" name="ui-colorpicker-special" id="'+a+'" class="ui-colorpicker-special-transparent"/><label for="'+a+'">'+i._getRegional("transparent")+"</label>"),!i.inline&&i.options.showNoneButton&&(t+='<input type="radio" name="ui-colorpicker-special" id="'+s+'" class="ui-colorpicker-special-none"><label for="'+s+'">'+i._getRegional("none")+"</label>"),t+="</div>"),i.inline||(t+='<div class="ui-dialog-buttonset">',i.options.showCancelButton&&(t+='<button class="ui-colorpicker-cancel">'+i._getRegional("cancel")+"</button>"),t+='<button class="ui-colorpicker-ok">'+i._getRegional("ok")+"</button>",t+="</div>"),'<div class="ui-dialog-buttonpane ui-widget-content">'+t+"</div>"}()).appendTo(i.dialog),t(".ui-colorpicker-ok",n).button().click((function(){i.close()})),t(".ui-colorpicker-cancel",n).button().click((function(){i.color=i.currentColor.copy(),i._change(i.color.set),i.close()})),t(".ui-colorpicker-buttonset",n).buttonset(),t(".ui-colorpicker-special-color",n).click((function(){i._change()})),t("#"+s,n).click((function(){i._change(!1)})),t("#"+a,n).click((function(){i.color.setAlpha(0),i._change()}))},this.repaint=function(){i.color.set?0==i.color.getAlpha()?t(".ui-colorpicker-special-transparent",n).attr("checked",!0).button("refresh"):t("input",n).attr("checked",!1).button("refresh"):t(".ui-colorpicker-special-none",n).attr("checked",!0).button("refresh"),t(".ui-colorpicker-cancel",n).button(i.changed?"enable":"disable")},this.update=function(){}}},o=function(){var e={rgb:{r:0,g:0,b:0},hsv:{h:0,s:0,v:0},hsl:{h:0,s:0,l:0},lab:{l:0,a:0,b:0},cmyk:{c:0,m:0,y:0,k:1}},i=1,n=arguments,a=function(t){return isNaN(t)||null===t?0:("string"==typeof t&&(t=parseInt(t,10)),Math.max(0,Math.min(t,1)))},s=function(t){var e="0123456789abcdef",i=t%16;return e.charAt((t-i)/16)+e.charAt(i)},r=function(t){var e=t.r>.04045?Math.pow((t.r+.055)/1.055,2.4):t.r/12.92,i=t.g>.04045?Math.pow((t.g+.055)/1.055,2.4):t.g/12.92,n=t.b>.04045?Math.pow((t.b+.055)/1.055,2.4):t.b/12.92;return{x:.4124*e+.3576*i+.1805*n,y:.2126*e+.7152*i+.0722*n,z:.0193*e+.1192*i+.9505*n}},l=function(t){var e,i,n,a=Math.min(t.r,t.g,t.b),s=Math.max(t.r,t.g,t.b),o=s-a,r={h:0,s:0,v:s};return 0===o?(r.h=0,r.s=0):(r.s=o/s,e=((s-t.r)/6+o/2)/o,i=((s-t.g)/6+o/2)/o,n=((s-t.b)/6+o/2)/o,t.r===s?r.h=n-i:t.g===s?r.h=1/3+e-n:t.b===s&&(r.h=2/3+i-e),r.h<0?r.h+=1:r.h>1&&(r.h-=1)),r},c=function(t){var e,i,n,a=Math.min(t.r,t.g,t.b),s=Math.max(t.r,t.g,t.b),o=s-a,r={h:0,s:0,l:(s+a)/2};return 0===o?(r.h=0,r.s=0):(r.s=r.l<.5?o/(s+a):o/(2-s-a),e=((s-t.r)/6+o/2)/o,i=((s-t.g)/6+o/2)/o,n=((s-t.b)/6+o/2)/o,t.r===s?r.h=n-i:t.g===s?r.h=1/3+e-n:t.b===s&&(r.h=2/3+i-e),r.h<0?r.h+=1:r.h>1&&(r.h-=1)),r},d=function(t){var e=t.x/.95047,i=t.y,n=t.z/1.08883;return e=e>.008856?Math.pow(e,1/3):7.787*e+16/116,{l:(116*(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116)-16)/100,a:(500*(e-i)+128)/255,b:(200*(i-(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116))+128)/255}},u=function(t){return{c:1-t.r,m:1-t.g,y:1-t.b}},h=function(t){var e=1;return t.c<e&&(e=t.c),t.m<e&&(e=t.m),t.y<e&&(e=t.y),1==e?{c:0,m:0,y:0,k:1}:{c:(t.c-e)/(1-e),m:(t.m-e)/(1-e),y:(t.y-e)/(1-e),k:e}};this.set=!0,this.setAlpha=function(t){return null!==t&&(i=a(t)),this},this.getAlpha=function(){return i},this.setRGB=function(t,i,n){return e={rgb:this.getRGB()},null!==t&&(e.rgb.r=a(t)),null!==i&&(e.rgb.g=a(i)),null!==n&&(e.rgb.b=a(n)),this},this.setHSV=function(t,i,n){return e={hsv:this.getHSV()},null!==t&&(e.hsv.h=a(t)),null!==i&&(e.hsv.s=a(i)),null!==n&&(e.hsv.v=a(n)),this},this.setHSL=function(t,i,n){return e={hsl:this.getHSL()},null!==t&&(e.hsl.h=a(t)),null!==i&&(e.hsl.s=a(i)),null!==n&&(e.hsl.l=a(n)),this},this.setLAB=function(t,i,n){return e={lab:this.getLAB()},null!==t&&(e.lab.l=a(t)),null!==i&&(e.lab.a=a(i)),null!==n&&(e.lab.b=a(n)),this},this.setCMYK=function(t,i,n,s){return e={cmyk:this.getCMYK()},null!==t&&(e.cmyk.c=a(t)),null!==i&&(e.cmyk.m=a(i)),null!==n&&(e.cmyk.y=a(n)),null!==s&&(e.cmyk.k=a(s)),this},this.getRGB=function(){var i,n,s,o,r,l,c,d,u,h,p,f,m,g;return e.rgb||(e.rgb=e.lab?function(t){var e={r:3.2406*t.x+-1.5372*t.y+-.4986*t.z,g:-.9689*t.x+1.8758*t.y+.0415*t.z,b:.0557*t.x+-.204*t.y+1.057*t.z};return e.r=e.r>.0031308?1.055*Math.pow(e.r,1/2.4)-.055:12.92*e.r,e.g=e.g>.0031308?1.055*Math.pow(e.g,1/2.4)-.055:12.92*e.g,e.b=e.b>.0031308?1.055*Math.pow(e.b,1/2.4)-.055:12.92*e.b,e}((h=e.lab,p=100*h.l,f=255*h.a-128,m=255*h.b-128,(g={x:0,y:(p+16)/116,z:0}).x=f/500+g.y,g.z=g.y-m/200,g.x=Math.pow(g.x,3)>.008856?Math.pow(g.x,3):(g.x-16/116)/7.787,g.y=Math.pow(g.y,3)>.008856?Math.pow(g.y,3):(g.y-16/116)/7.787,g.z=Math.pow(g.z,3)>.008856?Math.pow(g.z,3):(g.z-16/116)/7.787,g.x*=.95047,g.y*=1,g.z*=1.08883,g)):e.hsv?(s=e.hsv,u={r:0,g:0,b:0},0===s.s?u.r=u.g=u.b=s.v:(o=1===s.h?0:6*s.h,r=Math.floor(o),l=s.v*(1-s.s),c=s.v*(1-s.s*(o-r)),d=s.v*(1-s.s*(1-(o-r))),0===r?(u.r=s.v,u.g=d,u.b=l):1===r?(u.r=c,u.g=s.v,u.b=l):2===r?(u.r=l,u.g=s.v,u.b=d):3===r?(u.r=l,u.g=c,u.b=s.v):4===r?(u.r=d,u.g=l,u.b=s.v):(u.r=s.v,u.g=l,u.b=c)),u):e.hsl?function(t){var e,i,n=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),6*i<1?t+6*(e-t)*i:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t};return 0===t.s?{r:t.l,g:t.l,b:t.l}:(i=t.l<.5?t.l*(1+t.s):t.l+t.s-t.s*t.l,{r:n(e=2*t.l-i,i,t.h+1/3),g:n(e,i,t.h),b:n(e,i,t.h-1/3)})}(e.hsl):e.cmyk?(n=e.cmyk,{r:1-(i={c:n.c*(1-n.k)+n.k,m:n.m*(1-n.k)+n.k,y:n.y*(1-n.k)+n.k}).c,g:1-i.m,b:1-i.y}):{r:0,g:0,b:0},e.rgb.r=a(e.rgb.r),e.rgb.g=a(e.rgb.g),e.rgb.b=a(e.rgb.b)),t.extend({},e.rgb)},this.getHSV=function(){return e.hsv||(e.hsv=e.lab?l(this.getRGB()):e.rgb?l(e.rgb):e.hsl||e.cmyk?l(this.getRGB()):{h:0,s:0,v:0},e.hsv.h=a(e.hsv.h),e.hsv.s=a(e.hsv.s),e.hsv.v=a(e.hsv.v)),t.extend({},e.hsv)},this.getHSL=function(){return e.hsl||(e.hsl=e.rgb?c(e.rgb):e.hsv||e.cmyk||e.hsv?c(this.getRGB()):{h:0,s:0,l:0},e.hsl.h=a(e.hsl.h),e.hsl.s=a(e.hsl.s),e.hsl.l=a(e.hsl.l)),t.extend({},e.hsl)},this.getCMYK=function(){return e.cmyk||(e.cmyk=e.rgb?h(u(e.rgb)):e.hsv||e.hsl||e.lab?h(u(this.getRGB())):{c:0,m:0,y:0,k:1},e.cmyk.c=a(e.cmyk.c),e.cmyk.m=a(e.cmyk.m),e.cmyk.y=a(e.cmyk.y),e.cmyk.k=a(e.cmyk.k)),t.extend({},e.cmyk)},this.getLAB=function(){return e.lab||(e.lab=e.rgb?d(r(e.rgb)):e.hsv||e.hsl||e.cmyk?d(r(this.getRGB())):{l:0,a:0,b:0},e.lab.l=a(e.lab.l),e.lab.a=a(e.lab.a),e.lab.b=a(e.lab.b)),t.extend({},e.lab)},this.getChannels=function(){return{r:this.getRGB().r,g:this.getRGB().g,b:this.getRGB().b,a:this.getAlpha(),h:this.getHSV().h,s:this.getHSV().s,v:this.getHSV().v,c:this.getCMYK().c,m:this.getCMYK().m,y:this.getCMYK().y,k:this.getCMYK().k,L:this.getLAB().l,A:this.getLAB().a,B:this.getLAB().b}},this.getSpaces=function(){return t.extend(!0,{},e)},this.setSpaces=function(t){return e=t,this},this.distance=function(t){var e,i="get"+"lab".toUpperCase(),n=this[i](),a=t[i](),s=0;for(e in n)s+=Math.pow(n[e]-a[e],2);return s},this.equals=function(t){var e=this.getRGB(),i=t.getRGB();return this.getAlpha()==t.getAlpha()&&e.r==i.r&&e.g==i.g&&e.b==i.b},this.limit=function(t){t-=1;var e=this.getRGB();this.setRGB(Math.round(e.r*t)/t,Math.round(e.g*t)/t,Math.round(e.b*t)/t)},this.toHex=function(){var t=this.getRGB();return s(255*t.r)+s(255*t.g)+s(255*t.b)},this.toCSS=function(){return"#"+this.toHex()},this.normalize=function(){return this.setHSV(null,1,1),this},this.copy=function(){var t=this.getSpaces(),e=this.getAlpha();return new o(t,e)},2==n.length&&(this.setSpaces(n[0]),this.setAlpha(0===n[1]?0:n[1]||1)),n.length>2&&(this.setRGB(n[0],n[1],n[2]),this.setAlpha(0===n[3]?0:n[3]||1))};t.widget("vanderlee.colorpicker",{options:{alpha:!1,altAlpha:!0,altField:"",altOnChange:!0,altProperties:"background-color",autoOpen:!1,buttonColorize:!1,buttonImage:"images/ui-colorpicker.png",buttonImageOnly:!1,buttonText:null,closeOnEscape:!0,closeOnOutside:!0,color:"#00FF00",colorFormat:"HEX",draggable:!0,duration:"fast",hsv:!0,inline:!0,layout:{map:[0,0,1,5],bar:[1,0,1,5],preview:[2,0,1,1],hsv:[2,1,1,1],rgb:[2,2,1,1],alpha:[2,3,1,1],hex:[2,4,1,1],lab:[3,1,1,1],cmyk:[3,2,1,2],swatches:[4,0,1,5]},limit:"",modal:!1,mode:"h",parts:"",regional:"",rgb:!0,showAnim:"fadeIn",showCancelButton:!0,showNoneButton:!1,showCloseButton:!0,showOn:"focus",showOptions:{},swatches:null,swatchesWidth:84,title:null,close:null,init:null,select:null,open:null},_create:function(){var i,n=this;return++e,n.widgetEventPrefix="color",n.opened=!1,n.generated=!1,n.inline=!1,n.changed=!1,n.dialog=null,n.button=null,n.image=null,n.overlay=null,n.mode=n.options.mode,"input"!==this.element[0].nodeName.toLowerCase()&&n.options.inline?(n.inline=!0,t(this.element).html('<div class="ui-colorpicker ui-colorpicker-inline ui-dialog ui-widget ui-widget-content ui-corner-all"></div>'),n.dialog=t(".ui-colorpicker",this.element),n._generate(),n.opened=!0):(n._setColor(n.element.val()),this._callback("init"),t("body").append('<div class="ui-colorpicker ui-colorpicker-dialog ui-dialog ui-widget ui-widget-content ui-corner-all" style="display: none;"></div>'),n.dialog=t(".ui-colorpicker:last"),t(document).delegate("html","touchstart click",(function(e){if(n.opened&&e.target!==n.element[0]&&!n.overlay)if(n.dialog.is(e.target)||n.dialog.has(e.target).length>0)n.element.blur();else{var i,a=t(e.target).parents();for(i=0;i<=a.length;++i)if(null!==n.button&&a[i]===n.button[0])return;n.options.closeOnOutside&&n.close()}})),t(document).keydown((function(t){27==t.keyCode&&n.opened&&n.options.closeOnEscape&&n.close()})),"focus"!==n.options.showOn&&"both"!==n.options.showOn||n.element.on("focus click",(function(){n.open()})),"button"!==n.options.showOn&&"both"!==n.options.showOn||(""!==n.options.buttonImage&&(i=n.options.buttonText||n._getRegional("button"),n.image=t("<img/>").attr({src:n.options.buttonImage,alt:i,title:i}),n._setImageBackground()),n.options.buttonImageOnly&&n.image?n.button=n.image:(n.button=t('<button type="button"></button>').html(n.image||n.options.buttonText).button(),n.image=n.image?t("img",n.button).first():null),n.button.insertAfter(n.element).click((function(){n[n.opened?"close":"open"]()}))),n.options.autoOpen&&n.open(),n.element.keydown((function(t){9===t.keyCode&&n.close()})).keyup((function(t){var e=n._parseColor(n.element.val());n.color.equals(e)||(n.color=e,n._change())}))),this},_setOption:function(e,i){var n=this;if("disabled"===e)i?n.dialog.addClass("ui-colorpicker-disabled"):n.dialog.removeClass("ui-colorpicker-disabled");t.Widget.prototype._setOption.apply(n,arguments)},_setImageBackground:function(){this.image&&this.options.buttonColorize&&this.image.css("background-color",this.color.set?this._formatColor("RGBA",this.color):"")},_setAltField:function(){if(this.options.altOnChange&&this.options.altField&&this.options.altProperties){var e,i,n=this.options.altProperties.split(",");for(e=0;e<=n.length;++e)switch(i=t.trim(n[e])){case"color":case"background-color":case"outline-color":case"border-color":t(this.options.altField).css(i,this.color.set?this.color.toCSS():"")}this.options.altAlpha&&t(this.options.altField).css("opacity",this.color.set?this.color.getAlpha():"")}},_setColor:function(t){this.color=this._parseColor(t),this.currentColor=this.color.copy(),this._setImageBackground(),this._setAltField()},setColor:function(t){this._setColor(t),this._change(this.color.set)},_generate:function(){var e,n,a=this;a._setColor(a.inline?a.options.color:a.element.val()),e="string"==typeof a.options.parts?i[a.options.parts]?i[a.options.parts]:i[a.inline?"inline":"popup"]:a.options.parts,a.parts={},t.each(e,(function(t,e){s[e]&&(a.parts[e]=new s[e](a))})),a.generated||(n=[],t.each(a.options.layout,(function(t,e){a.parts[t]&&n.push({part:t,pos:e})})),t(function(e,i){var n,a,s,o,r,l,c,d,u,h,p,f,m,g;for(e.sort((function(t,e){return t.pos[1]==e.pos[1]?t.pos[0]-e.pos[0]:t.pos[1]-e.pos[1]})),o=0,r=0,t.each(e,(function(t,e){o=Math.max(o,e.pos[0]+e.pos[2]),r=Math.max(r,e.pos[1]+e.pos[3])})),n=[],a=0;a<o;++a)n.push([]);for(c=[],l=[],t.each(e,(function(t,e){for(a=0;a<e.pos[2];a+=1)l[e.pos[0]+a]=!0;for(s=0;s<e.pos[3];s+=1)c[e.pos[1]+s]=!0})),h="",u=e[d=0],s=0;s<r;++s){for(h+="<tr>",a=0;a<o;a)if(void 0!==u&&a==u.pos[0]&&s==u.pos[1]){for(h+=i(u,a,s),f=0;f<u.pos[3];f+=1)for(p=0;p<u.pos[2];p+=1)n[a+p][s+f]=!0;a+=u.pos[2],u=e[++d]}else{for(m=0,g=!1;a<o&&void 0===n[a][s]&&(void 0===u||s<u.pos[1]||s==u.pos[1]&&a<u.pos[0]);)!0===l[a]&&(m+=1),g=!0,a+=1;m>0?h+='<td colspan="'+m+'"></td>':g||(a+=1)}h+="</tr>"}return'<table cellspacing="0" cellpadding="0" border="0"><tbody>'+h+"</tbody></table>"}(n,(function(t,e,i){var n=["ui-colorpicker-"+t.part+"-container"];return e>0&&n.push("ui-colorpicker-padding-left"),i>0&&n.push("ui-colorpicker-padding-top"),'<td  class="'+n.join(" ")+'"'+(t.pos[2]>1?' colspan="'+t.pos[2]+'"':"")+(t.pos[3]>1?' rowspan="'+t.pos[3]+'"':"")+' valign="top"></td>'}))).appendTo(a.dialog).addClass("ui-dialog-content ui-widget-content"),a._initAllParts(),a._updateAllParts(),a.generated=!0)},_effectGeneric:function(e,i,n,a,s){var o=this;t.effects&&t.effects[o.options.showAnim]?e[i](o.options.showAnim,o.options.showOptions,o.options.duration,s):(e["slideDown"===o.options.showAnim?n:"fadeIn"===o.options.showAnim?a:i](o.options.showAnim?o.options.duration:null,s),o.options.showAnim&&o.options.duration||s())},_effectShow:function(t,e){this._effectGeneric(t,"show","slideDown","fadeIn",e)},_effectHide:function(t,e){this._effectGeneric(t,"hide","slideUp","fadeOut",e)},open:function(){var e,i,n,a,s,o,r,l,c=this;c.opened||(c._generate(),e=c.element.offset(),i=t(window).height()+t(window).scrollTop(),n=t(window).width()+t(window).scrollLeft(),a=c.dialog.outerHeight(),s=c.dialog.outerWidth(),o=e.left,r=e.top+c.element.outerHeight(),o+s>n&&(o=Math.max(0,n-s)),r+a>i&&(r=e.top-a>=t(window).scrollTop()?e.top-a:Math.max(0,i-a)),c.dialog.css({left:o,top:r}),l=0,t(c.element[0]).parents().each((function(){var e=t(this).css("z-index");if(("number"==typeof e||"string"==typeof e)&&""!==e&&!isNaN(e))return l=parseInt(e),!1})),c.dialog.css("z-index",l+=2),c.overlay=c.options.modal?new t.ui.dialog.overlay(c):null,c._effectShow(this.dialog),c.opened=!0,c._callback("open",!0),t((function(){c._repaintAllParts()})))},close:function(){var t=this;t.currentColor=t.color.copy(),t.changed=!1,t._effectHide(t.dialog,(function(){t.dialog.empty(),t.generated=!1,t.opened=!1,t._callback("close",!0)})),t.overlay&&t.overlay.destroy()},destroy:function(){this.element.unbind(),null!==this.image&&this.image.remove(),null!==this.button&&this.button.remove(),null!==this.dialog&&this.dialog.remove(),this.overlay&&this.overlay.destroy()},_callback:function(t,e){var i,n,a=this;return a.color.set?(i={formatted:a._formatColor(a.options.colorFormat,a.color)},(n=a.color.getLAB()).a=2*n.a-1,n.b=2*n.b-1,!0===e&&(i.a=a.color.getAlpha(),i.rgb=a.color.getRGB(),i.hsv=a.color.getHSV(),i.cmyk=a.color.getCMYK(),i.hsl=a.color.getHSL(),i.lab=n),a._trigger(t,null,i)):a._trigger(t,null,{formatted:""})},_initAllParts:function(){t.each(this.parts,(function(t,e){e.init&&e.init()}))},_updateAllParts:function(){t.each(this.parts,(function(t,e){e.update&&e.update()}))},_repaintAllParts:function(){t.each(this.parts,(function(t,e){e.repaint&&e.repaint()}))},_change:function(t){switch(this.color.set=!1!==t,this.changed=!0,this.options.limit){case"websafe":this.color.limit(6);break;case"nibble":this.color.limit(16);break;case"binary":this.color.limit(2);break;case"name":var e=this._getSwatch(this._closestName(this.color));this.color.setRGB(e.r,e.g,e.b)}this.inline||(this.color.set?this.color.equals(this._parseColor(this.element.val()))||this.element.val(this._formatColor(this.options.colorFormat,this.color)):this.element.val(""),this._setImageBackground(),this._setAltField()),this.opened&&this._repaintAllParts(),this._callback("select")},_hoverable:function(t){t.hover((function(){t.addClass("ui-state-hover")}),(function(){t.removeClass("ui-state-hover")}))},_focusable:function(t){t.focus((function(){t.addClass("ui-state-focus")})).blur((function(){t.removeClass("ui-state-focus")}))},_getRegional:function(e){return void 0!==t.colorpicker.regional[this.options.regional][e]?t.colorpicker.regional[this.options.regional][e]:t.colorpicker.regional[""][e]},_getSwatches:function(){return"string"==typeof this.options.swatches?t.colorpicker.swatches[this.options.swatches]:t.isPlainObject(this.options.swatches)?t.colorpicker.swatches:t.colorpicker.swatches.html},_getSwatch:function(e){var i=this._getSwatches(),n=!1;return void 0!==i[e]?i[e]:(t.each(i,(function(t,i){return t.toLowerCase()!=e.toLowerCase()||(n=i,!1)})),n)},_parseColor:function(e){var i,n;return""==e?new o:(i=this._getSwatch(t.trim(e)))?new o(i.r,i.g,i.b):(n=/^rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(e))?new o(n[1]/255,n[2]/255,n[3]/255,parseFloat(n[4])):(n=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(e))?(new o).setHSL(n[1]/255,n[2]/255,n[3]/255).setAlpha(parseFloat(n[4])):(n=/^rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(e))?new o(n[1]/100,n[2]/100,n[3]/100,n[4]/100):(n=/^hsla?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(e))?(new o).setHSL(n[1]/100,n[2]/100,n[3]/100).setAlpha(n[4]/100):(n=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(e))?new o(parseInt(n[1],16)/255,parseInt(n[2],16)/255,parseInt(n[3],16)/255):(n=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(e))?new o(parseInt(n[1]+n[1],16)/255,parseInt(n[2]+n[2],16)/255,parseInt(n[3]+n[3],16)/255):a(e)},_exactName:function(e){var i=!1;return t.each(this._getSwatches(),(function(t,n){return!e.equals(new o(n.r,n.g,n.b))||(i=t,!1)})),i},_closestName:function(e){e.getRGB();var i,n=null,a=!1;return t.each(this._getSwatches(),(function(t,s){if((i=e.distance(new o(s.r,s.g,s.b)))<n||null===n){if(a=t,0==i)return!1;n=i}return!0})),a},_formatColor:function(e,i){var a=this,s=null,o={x:function(t){return n(255*t)},d:function(t){return Math.round(255*t)},f:function(t){return t},p:function(t){return 100*t}},r=i.getChannels();return t.isArray(e)||(e=[e]),t.each(e,(function(t,e){return a._formats[e]?!1===(s=a._formats[e](i,a)):(s=e.replace(/\\?[argbhsvcmykLAB][xdfp]/g,(function(t){return t.match(/^\\/)?t.slice(1):o[t.charAt(1)](r[t.charAt(0)])})),!1)})),s},_formats:{"#HEX":function(t,e){return e._formatColor("#rxgxbx",t)},"#HEX3":function(t,e){var i=e._formats.HEX3(t);return!1!==i&&"#"+i},HEX:function(t,e){return e._formatColor("rxgxbx",t)},HEX3:function(t,e){var i=t.getRGB(),n=Math.round(255*i.r),a=Math.round(255*i.g),s=Math.round(255*i.b);return n>>>4==(n&=15)&&a>>>4==(a&=15)&&s>>>4==(s&=15)&&n.toString(16)+a.toString(16)+s.toString(16)},RGB:function(t,e){return t.getAlpha()>=1&&e._formatColor("rgb(rd,gd,bd)",t)},RGBA:function(t,e){return e._formatColor("rgba(rd,gd,bd,af)",t)},"RGB%":function(t,e){return t.getAlpha()>=1&&e._formatColor("rgb(rp%,gp%,bp%)",t)},"RGBA%":function(t,e){return e._formatColor("rgba(rp%,gp%,bp%,af)",t)},HSL:function(t,e){return t.getAlpha()>=1&&e._formatColor("hsl(hd,sd,vd)",t)},HSLA:function(t,e){return e._formatColor("hsla(hd,sd,vd,af)",t)},"HSL%":function(t,e){return t.getAlpha()>=1&&e._formatColor("hsl(hp%,sp%,vp%)",t)},"HSLA%":function(t,e){return e._formatColor("hsla(hp%,sp%,vp%,af)",t)},NAME:function(t,e){return e._closestName(t)},EXACT:function(t,e){return e._exactName(t)}}})}(jQuery),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}((function(t){var e=/\+/g;function i(t){return t}function n(t){return decodeURIComponent(t.replace(e," "))}function a(t){0===t.indexOf('"')&&(t=t.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return s.json?JSON.parse(t):t}catch(t){}}var s=t.cookie=function(e,o,r){if(void 0!==o){if("number"==typeof(r=t.extend({},s.defaults,r)).expires){var l=r.expires,c=r.expires=new Date;c.setDate(c.getDate()+l)}return o=s.json?JSON.stringify(o):String(o),document.cookie=[s.raw?e:encodeURIComponent(e),"=",s.raw?o:encodeURIComponent(o),r.expires?"; expires="+r.expires.toUTCString():"",r.path?"; path="+r.path:"",r.domain?"; domain="+r.domain:"",r.secure?"; secure":""].join("")}for(var d=s.raw?i:n,u=document.cookie.split("; "),h=e?void 0:{},p=0,f=u.length;p<f;p++){var m=u[p].split("="),g=d(m.shift()),v=d(m.join("="));if(e&&e===g){h=a(v);break}e||(h[g]=a(v))}return h};s.defaults={},t.removeCookie=function(e,i){return void 0!==t.cookie(e)&&(t.cookie(e,"",t.extend({},i,{expires:-1})),!0)}})),function(e){function n(t){return function(t){return t.replace(new RegExp("^[\\s]+","g"),"")}(function(t){return t.replace(new RegExp("[\\s]+$","g"),"")}(t))}e.fn.dump=function(){return e.dump(this)},e.dump=function(a){var s=function(a,r){r||(r=0);var l="",c="";for(i=0;i<r;i++)c+="\t";switch(t=o(a),t){case"string":return'"'+a+'"';case"number":case"error":return a.toString();case"boolean":return a?"true":"false";case"date":return"Date: "+a.toLocaleString();case"array":l+="Array ( \n",e.each(a,(function(t,e){l+=c+"\t"+t+" => "+s(e,r+1)+"\n"})),l+=c+")";break;case"object":l+="Object { \n",e.each(a,(function(t,e){l+=c+"\t"+t+": "+s(e,r+1)+"\n"})),l+=c+"}";break;case"jquery":l+="jQuery Object { \n",e.each(a,(function(t,e){l+=c+"\t"+t+" = "+s(e,r+1)+"\n"})),l+=c+"}";break;case"regexp":return"RegExp: "+a.toString();case"document":case"domelement":l+="DOMElement [ \n"+c+"\tnodeName: "+a.nodeName+"\n"+c+"\tnodeValue: "+a.nodeValue+"\n"+c+"\tinnerHTML: [ \n",e.each(a.childNodes,(function(t,e){if(t<1)var i=0;"string"==o(e)?e.textContent.match(/[^\s]/)?l+=c+"\t\t"+(t-(i||0))+" = String: "+n(e.textContent)+"\n":i--:l+=c+"\t\t"+(t-(i||0))+" = "+s(e,r+2)+"\n"})),l+=c+"\t]\n"+c+"]";break;case"function":var d=a.toString().match(/^(.*)\(([^\)]*)\)/im);return d[1]=n(d[1].replace(new RegExp("[\\s]+","g")," ")),d[2]=n(d[2].replace(new RegExp("[\\s]+","g")," ")),d[1]+"("+d[2]+")";default:l+="N/A: "+t}return l},o=function(t){var e=typeof t;if("object"!=e)return e;switch(t){case null:return"null";case window:return"window";case document:return"document";case window.event:return"event"}if(t.jquery)return"jquery";switch(t.constructor){case Array:return"array";case Boolean:return"boolean";case Date:return"date";case Object:return"object";case RegExp:return"regexp";case ReferenceError:case Error:return"error"}switch(t.nodeType){case 1:return"domelement";case 3:return"string"}return"Unknown"};return s(a)}}(jQuery),function(){var t={getSelection:function(){var t=this.jquery?this[0]:this;return("selectionStart"in t&&function(){var e=t.selectionEnd-t.selectionStart;return{start:t.selectionStart,end:t.selectionEnd,length:e,text:t.value.substr(t.selectionStart,e)}}||document.selection&&function(){t.focus();var e=document.selection.createRange();if(null===e)return{start:0,end:t.value.length,length:0};var i=t.createTextRange(),n=i.duplicate();return i.moveToBookmark(e.getBookmark()),n.setEndPoint("EndToStart",i),{start:n.text.length,end:n.text.length+e.text.length,length:e.text.length,text:e.text}}||function(){return null})()},setSelection:function(){var t=this.jquery?this[0]:this,e=arguments[0]||{};return("selectionStart"in t&&function(){var i="object"==typeof e?e.start:e;return null!=i&&(t.selectionStart=i),null!=e.end&&(t.selectionEnd=e.end),t.focus(),this}||document.selection&&function(){t.focus();var i=document.selection.createRange();if(null===i)return this;var n="object"==typeof e?e.start:e;return null!=n&&(i.moveStart("character",-t.value.length),i.moveStart("character",n),i.collapse()),null!=e.end&&i.moveEnd("character",e.end-n),i.select(),this}||function(){return t.focus(),jQuery(t)})()},replaceSelection:function(){var t=this.jquery?this[0]:this,e=arguments[0]||"";return("selectionStart"in t&&function(){return t.value=t.value.substr(0,t.selectionStart)+e+t.value.substr(t.selectionEnd,t.value.length),this}||document.selection&&function(){return t.focus(),document.selection.createRange().text=e,this}||function(){return t.value+=e,jQuery(t)})()}};jQuery.each(t,(function(t){jQuery.fn[t]=this}))}(),function(t){t.fn.hoverIntent=function(e,i){var n,a,s,o,r={sensitivity:7,interval:100,timeout:0};r=t.extend(r,i?{over:e,out:i}:e);var l=function(t){n=t.pageX,a=t.pageY},c=function(e,i){if(i.hoverIntent_t=clearTimeout(i.hoverIntent_t),Math.abs(s-n)+Math.abs(o-a)<r.sensitivity)return t(i).unbind("mousemove",l),i.hoverIntent_s=1,r.over.apply(i,[e]);s=n,o=a,i.hoverIntent_t=setTimeout((function(){c(e,i)}),r.interval)},d=function(e){var i=jQuery.extend({},e),n=this;n.hoverIntent_t&&(n.hoverIntent_t=clearTimeout(n.hoverIntent_t)),"mouseenter"==e.type?(s=i.pageX,o=i.pageY,t(n).bind("mousemove",l),1!=n.hoverIntent_s&&(n.hoverIntent_t=setTimeout((function(){c(i,n)}),r.interval))):(t(n).unbind("mousemove",l),1==n.hoverIntent_s&&(n.hoverIntent_t=setTimeout((function(){!function(t,e){e.hoverIntent_t=clearTimeout(e.hoverIntent_t),e.hoverIntent_s=0,r.out.apply(e,[t])}(i,n)}),r.timeout)))};return this.bind("mouseenter",d).bind("mouseleave",d)}}(jQuery),function(t){function e(){}function i(t){s=[t]}function n(t,e,i){return t&&t.apply(e.context||e,i)}function a(t){return/\?/.test(t)?"&":"?"}var s,o="async",r="error",l="insertBefore",c="_jqjsp",d="on",u="onclick",h=d+r,p="onload",f="onreadystatechange",m="readyState",g="removeChild",v="<script>",b="success",y="timeout",_=window,x=t.Deferred,w=t("head")[0]||document.documentElement,C={},k=0,$={callback:c,url:location.href},S=_.opera,T=!!t("<div>").html("\x3c!--[if IE]><i><![endif]--\x3e").find("i").length;function I(d){var I,D,A,P,O,E=(d=t.extend({},$,d)).success,M=d.error,L=d.complete,j=d.dataFilter,R=d.callbackParameter,N=d.callback,B=d.cache,F=d.pageCache,H=d.charset,z=d.url,W=d.data,U=d.timeout,q=0,Y=e;if(x&&x((function(t){t.done(E).fail(M),E=t.resolve,M=t.reject})).promise(d),d.abort=function(){!q++&&Y()},!1===n(d.beforeSend,d,[d])||q)return d;function V(t){q++||(Y(),F&&(C[z]={s:[t]}),j&&(t=j.apply(d,[t])),n(E,d,[t,b,d]),n(L,d,[d,b]))}function G(t){q++||(Y(),F&&t!=y&&(C[z]=t),n(M,d,[d,t]),n(L,d,[d,t]))}return z=z||"",W=W?"string"==typeof W?W:t.param(W,d.traditional):"",z+=W?a(z)+W:"",R&&(z+=a(z)+encodeURIComponent(R)+"=?"),!B&&!F&&(z+=a(z)+"_"+(new Date).getTime()+"="),z=z.replace(/=\?(&|$)/,"="+N+"$1"),F&&(I=C[z])?I.s?V(I.s[0]):G(I):(_[N]=i,(A=t(v)[0]).id=c+k++,H&&(A.charset=H),S&&S.version()<11.6?(P=t(v)[0]).text="document.getElementById('"+A.id+"')."+h+"()":A[o]=o,T&&(A.htmlFor=A.id,A.event=u),A[p]=A[h]=A[f]=function(t){if(!A[m]||!/i/.test(A[m])){try{A[u]&&A[u]()}catch(t){}t=s,s=0,t?V(t[0]):G(r)}},A.src=z,Y=function(t){O&&clearTimeout(O),A[f]=A[p]=A[h]=null,w[g](A),P&&w[g](P)},w[l](A,D=w.firstChild),P&&w[l](P,D),O=U>0&&setTimeout((function(){G(y)}),U)),d}I.setup=function(e){t.extend($,e)},t.jsonp=I}(jQuery),function($){$.fn.markItUp=function(settings,extraSettings){var method,params,options,ctrlKey,shiftKey,altKey;ctrlKey=shiftKey=altKey=!1,"string"==typeof settings&&(method=settings,params=extraSettings),options={id:"",nameSpace:"",root:"",previewHandler:!1,previewInWindow:"",previewInElement:"",previewAutoRefresh:!0,previewPosition:"after",previewTemplatePath:"~/templates/preview.html",previewParser:!1,previewParserPath:"",previewParserVar:"data",resizeHandle:!0,beforeInsert:"",afterInsert:"",onEnter:{},onShiftEnter:{},onCtrlEnter:{},onTab:{},markupSet:[{}]},$.extend(options,settings,extraSettings),options.root||$("script").each((function(t,e){miuScript=$(e).get(0).src.match(/(.*)jquery\.markitup(\.pack)?\.js$/),null!==miuScript&&(options.root=miuScript[1])}));var uaMatch=function(t){t=t.toLowerCase();var e=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:e[1]||"",version:e[2]||"0"}},matched=uaMatch(navigator.userAgent),browser={};return matched.browser&&(browser[matched.browser]=!0,browser.version=matched.version),browser.chrome?browser.webkit=!0:browser.webkit&&(browser.safari=!0),this.each((function(){var $$,textarea,levels,scrollPosition,caretPosition,caretOffset,clicked,hash,header,footer,previewWindow,template,iFrame,abort;if($$=$(this),textarea=this,levels=[],abort=!1,scrollPosition=caretPosition=0,caretOffset=-1,options.previewParserPath=localize(options.previewParserPath),options.previewTemplatePath=localize(options.previewTemplatePath),method)switch(method){case"remove":remove();break;case"insert":markup(params);break;default:$.error("Method "+method+" does not exist on jQuery.markItUp")}else init();function localize(t,e){return e?t.replace(/("|')~\//g,"$1"+options.root):t.replace(/^~\//,options.root)}function init(){id="",nameSpace="",options.id?id='id="'+options.id+'"':$$.attr("id")&&(id='id="markItUp'+$$.attr("id").substr(0,1).toUpperCase()+$$.attr("id").substr(1)+'"'),options.nameSpace&&(nameSpace='class="'+options.nameSpace+'"'),$$.wrap("<div "+nameSpace+"></div>"),$$.wrap("<div "+id+' class="markItUp"></div>'),$$.wrap('<div class="markItUpContainer"></div>'),$$.addClass("markItUpEditor"),header=$('<div class="markItUpHeader"></div>').insertBefore($$);var t=$(dropMenus(options.markupSet[0],"miu_basic"));t.append('<li class="txt_link fright li_miu_advanced"><span class="toggle_miu_advanced show_miu_advanced awesome-button" role="button">'+locaKeys.moreopts+"</span></li>"),t.appendTo(header),$(dropMenus(options.markupSet[1],"miu_advanced")).appendTo(header).hide(),footer=$('<div class="markItUpFooter"></div>').insertAfter($$),!0===options.resizeHandle&&!0!==browser.safari&&(resizeHandle=$('<div class="markItUpResizeHandle"></div>').insertAfter($$).bind("mousedown.markItUp",(function(t){var e,i,n=$$.height(),a=t.clientY;e=function(t){return $$.css("height",Math.max(20,t.clientY+n-a)+"px"),!1},i=function(t){return $("html").unbind("mousemove.markItUp",e).unbind("mouseup.markItUp",i),!1},$("html").bind("mousemove.markItUp",e).bind("mouseup.markItUp",i)})),footer.append(resizeHandle)),$$.bind("keydown.markItUp",keyPressed).bind("keyup",keyPressed),$$.bind("insertion.markItUp",(function(t,e){!1!==e.target&&get(),textarea===$.markItUp.focused&&markup(e)})),$$.bind("focus.markItUp",(function(){$.markItUp.focused=this})),options.previewInElement&&refreshPreview()}function dropMenus(markupSet,mSetClass){mSetClass||(mSetClass="");var ul=$('<ul class="'+mSetClass+'"></ul>'),i=0;return $.each(markupSet,(function(){var button=this,t="",title,li,j;if(title=button.key?(button.name||"")+" [Ctrl+"+button.key+"]":button.name||"",key=button.key?'accesskey="'+button.key+'"':"",button.separator)li=$('<li class="markItUpSeparator">'+(button.separator||"")+"</li>").appendTo(ul);else{for(i++,j=levels.length-1;j>=0;j--)t+=levels[j]+"-";if(li=$('<li class="markItUpButton markItUpButton'+t+i+" "+(button.className||"")+'"><a href="" '+key+' title="'+title+'">'+(button.name||"")+"</a></li>").bind("contextmenu.markItUp",(function(){return!1})).appendTo(ul),isMobile?li.bind("click.markItUp",(function(){return $(header).find("ul ul").hide(),$(this).find("> ul").length?$(this).find("> ul").show():(button.call&&eval(button.call)(),setTimeout((function(){markup(button)}),1)),!1})):li.unbind("click.markItUp").bind("click.markItUp",(function(){if(button.call)eval(button.call)();else{var $innerUL=$(">ul",li);if($innerUL.length>0){$innerUL.parents(".ui-dialog").find(".ui-dialog-titlebar-close").on("click",(function(){$innerUL.hide()})),$innerUL.addClass("markItUpOutpost"),$("body").append($innerUL);var randomId=Math.ceil(1e4*Math.random());li.attr("id","markitUpDropdown"+randomId),$innerUL.attr("rel","markitUpDropdown"+randomId),$innerUL.find(">li").bind("click.markItUp",(function(){$innerUL.hide(),li.attr("data-opened",0)})),$(window).on("resize",(function(t){repositionDropdowns($innerUL,li)}))}else $innerUL=$('body>ul[rel="'+li.attr("id")+'"]');$("html").one("click.markItUp2",(function(){$innerUL.hide(),li.attr("data-opened",0)})),repositionDropdowns($innerUL,li),$innerUL.filter(":visible").length?($innerUL.hide(),li.attr("data-opened",0)):($innerUL.show(),li.attr("data-opened",1))}return setTimeout((function(){markup(button)}),1),!1})).bind("focusin.markItUp",(function(){$$.focus()})),button.dropMenu){levels.push(i),$(li).addClass("markItUpDropMenu").append(dropMenus(button.dropMenu));var dropDownArr=$('<span class="dropdown_arr"></span>');$(li).append(dropDownArr)}}})),levels.pop(),ul}function repositionDropdowns(t,e){var i,n=t.outerHeight(),a=Math.ceil(e.offset().top);i=a+e.height()+n+$("#siteFooter").outerHeight()>=$(window).innerHeight()+$(window).scrollTop()?a-n-2:a+29,t.css({top:i,left:Math.floor(e.offset().left)})}function magicMarkups(t){return t?t=(t=(t=t.toString()).replace(/\(\!\(([\s\S]*?)\)\!\)/g,(function(t,e){var i=e.split("|!|");return!0===altKey?void 0!==i[1]?i[1]:i[0]:void 0===i[1]?"":i[0]}))).replace(/\[\!\[([\s\S]*?)\]\!\]/g,(function(t,e){var i=e.split(":!:");return!0!==abort&&(value=prompt(i[0],i[1]?i[1]:""),null===value&&(abort=!0),value)})):""}function prepare(t){return $.isFunction(t)&&(t=t(hash)),magicMarkups(t)}function build(t){var e=prepare(clicked.openWith),i=prepare(clicked.placeHolder),n=prepare(clicked.replaceWith),a=prepare(clicked.closeWith),s=prepare(clicked.openBlockWith),o=prepare(clicked.closeBlockWith),r=clicked.multiline;if(""!==n)block=e+n+a;else if(""===selection&&""!==i)block=e+i+a;else{var l=[t=t||selection],c=[];!0===r&&(l=t.split(/\r?\n/));for(var d=0;d<l.length;d++){var u;line=l[d],(u=line.match(/ *$/))?c.push(e+line.replace(/ *$/g,"")+a+u):c.push(e+line+a)}block=c.join("\n")}return block=s+block+o,{block:block,openBlockWith:s,openWith:e,replaceWith:n,placeHolder:i,closeWith:a,closeBlockWith:o}}function markup(t){var e,i,n,a;if(hash=clicked=t,get(),$.extend(hash,{line:"",root:options.root,textarea:textarea,selection:selection||"",caretPosition:caretPosition,ctrlKey:ctrlKey,shiftKey:shiftKey,altKey:altKey}),prepare(options.beforeInsert),prepare(clicked.beforeInsert),(!0===ctrlKey&&!0===shiftKey||!0===t.multiline)&&prepare(clicked.beforeMultiInsert),$.extend(hash,{line:1}),!0===ctrlKey&&!0===shiftKey){for(lines=selection.split(/\r?\n/),i=0,n=lines.length,a=0;a<n;a++)""!==$.trim(lines[a])?($.extend(hash,{line:++i,selection:lines[a]}),lines[a]=build(lines[a]).block):lines[a]="";string={block:lines.join("\n")},start=caretPosition,e=string.block.length+(browser.opera?n-1:0)}else!0===ctrlKey?(string=build(selection),start=caretPosition+string.openWith.length,e=string.block.length-string.openWith.length-string.closeWith.length,e-=string.block.match(/ $/)?1:0,e-=fixIeBug(string.block)):!0===shiftKey?(string=build(selection),start=caretPosition,e=string.block.length,e-=fixIeBug(string.block)):(string=build(selection),start=caretPosition+string.block.length,e=0,start-=fixIeBug(string.block));""===selection&&""===string.replaceWith&&(caretOffset+=fixOperaBug(string.block),start=caretPosition+string.openBlockWith.length+string.openWith.length,e=string.block.length-string.openBlockWith.length-string.openWith.length-string.closeWith.length-string.closeBlockWith.length,caretOffset=$$.val().substring(caretPosition,$$.val().length).length,caretOffset-=fixOperaBug($$.val().substring(0,caretPosition))),$.extend(hash,{caretPosition:caretPosition,scrollPosition:scrollPosition}),string.block!==selection&&!1===abort?(insert(string.block),set(start,e)):caretOffset=-1,get(),$.extend(hash,{line:"",selection:selection}),(!0===ctrlKey&&!0===shiftKey||!0===t.multiline)&&prepare(clicked.afterMultiInsert),prepare(clicked.afterInsert),prepare(options.afterInsert),previewWindow&&options.previewAutoRefresh&&refreshPreview(),shiftKey=altKey=ctrlKey=abort=!1}function fixOperaBug(t){return browser.opera?t.length-t.replace(/\n*/g,"").length:0}function fixIeBug(t){return browser.msie?t.length-t.replace(/\r*/g,"").length:0}function insert(t){document.selection?document.selection.createRange().text=t:textarea.value=textarea.value.substring(0,caretPosition)+t+textarea.value.substring(caretPosition+selection.length,textarea.value.length)}function set(t,e){if(textarea.createTextRange){if(browser.opera&&browser.version>=9.5&&0==e)return!1;range=textarea.createTextRange(),range.collapse(!0),range.moveStart("character",t),range.moveEnd("character",e),range.select()}else textarea.setSelectionRange&&textarea.setSelectionRange(t,t+e);textarea.scrollTop=scrollPosition,textarea.focus()}function get(){if(textarea.focus(),scrollPosition=textarea.scrollTop,document.selection)if(selection=document.selection.createRange().text,browser.msie){var t=document.selection.createRange(),e=t.duplicate();for(e.moveToElementText(textarea),caretPosition=-1;e.inRange(t);)e.moveStart("character"),caretPosition++}else caretPosition=textarea.selectionStart;else caretPosition=textarea.selectionStart,selection=textarea.value.substring(caretPosition,textarea.selectionEnd);return selection}function preview(){"function"==typeof options.previewHandler?previewWindow=!0:options.previewInElement?previewWindow=$(options.previewInElement):!previewWindow||previewWindow.closed?options.previewInWindow?(previewWindow=window.open("","preview",options.previewInWindow),$(window).unload((function(){previewWindow.close()}))):(iFrame=$('<iframe class="markItUpPreviewFrame"></iframe>'),"after"==options.previewPosition?iFrame.insertAfter(footer):iFrame.insertBefore(header),previewWindow=iFrame[iFrame.length-1].contentWindow||frame[iFrame.length-1]):!0===altKey&&(iFrame?iFrame.remove():previewWindow.close(),previewWindow=iFrame=!1),options.previewAutoRefresh||refreshPreview(),options.previewInWindow&&previewWindow.focus()}function refreshPreview(){renderPreview()}function renderPreview(){if(options.previewHandler&&"function"==typeof options.previewHandler)options.previewHandler($$.val());else if(options.previewParser&&"function"==typeof options.previewParser){writeInPreview(localize(options.previewParser($$.val()),1))}else""!==options.previewParserPath?$.ajax({type:"POST",dataType:"text",global:!1,url:options.previewParserPath,data:options.previewParserVar+"="+encodeURIComponent($$.val()),success:function(t){writeInPreview(localize(t,1))}}):template||$.ajax({url:options.previewTemplatePath,dataType:"text",global:!1,success:function(t){writeInPreview(localize(t,1).replace(/<!-- content -->/g,$$.val()))}});return!1}function writeInPreview(t){if(options.previewInElement)$(options.previewInElement).html(t);else if(previewWindow&&previewWindow.document){try{sp=previewWindow.document.documentElement.scrollTop}catch(t){sp=0}previewWindow.document.open(),previewWindow.document.write(t),previewWindow.document.close(),previewWindow.document.documentElement.scrollTop=sp}}function keyPressed(t){if(shiftKey=t.shiftKey,altKey=t.altKey,ctrlKey=(!t.altKey||!t.ctrlKey)&&(t.ctrlKey||t.metaKey),"keydown"===t.type){if(!0===ctrlKey&&(li=$('a[accesskey="'+(13==t.keyCode?"\\n":String.fromCharCode(t.keyCode))+'"]',header).parent("li"),0!==li.length))return ctrlKey=!1,setTimeout((function(){li.triggerHandler("mouseup")}),1),!1;if(13===t.keyCode||10===t.keyCode)return!0===ctrlKey?(ctrlKey=!1,markup(options.onCtrlEnter),options.onCtrlEnter.keepDefault):!0===shiftKey?(shiftKey=!1,markup(options.onShiftEnter),options.onShiftEnter.keepDefault):(markup(options.onEnter),options.onEnter.keepDefault);if(9===t.keyCode)return 1!=shiftKey&&1!=ctrlKey&&1!=altKey&&(-1!==caretOffset?(get(),set(caretOffset=$$.val().length-caretOffset,0),caretOffset=-1,!1):(markup(options.onTab),options.onTab.keepDefault))}}function remove(){$$.unbind(".markItUp").removeClass("markItUpEditor"),$$.parent("div").parent("div.markItUp").parent("div").replaceWith($$),$$.data("markItUp",null)}}))},$.fn.markItUpRemove=function(){return this.each((function(){$(this).markItUp("remove")}))},$.markItUp=function(t){var e={target:!1};if($.extend(e,t),e.target)return $(e.target).each((function(){$(this).focus(),$(this).trigger("insertion",[e])}));$("textarea").trigger("insertion",[e])}}(jQuery),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}((function(t){function e(e){var o=e||window.event,r=l.call(arguments,1),c=0,u=0,h=0,p=0,f=0,m=0;if((e=t.event.fix(o)).type="mousewheel","detail"in o&&(h=-1*o.detail),"wheelDelta"in o&&(h=o.wheelDelta),"wheelDeltaY"in o&&(h=o.wheelDeltaY),"wheelDeltaX"in o&&(u=-1*o.wheelDeltaX),"axis"in o&&o.axis===o.HORIZONTAL_AXIS&&(u=-1*h,h=0),c=0===h?u:h,"deltaY"in o&&(c=h=-1*o.deltaY),"deltaX"in o&&(u=o.deltaX,0===h&&(c=-1*u)),0!==h||0!==u){if(1===o.deltaMode){var g=t.data(this,"mousewheel-line-height");c*=g,h*=g,u*=g}else if(2===o.deltaMode){var v=t.data(this,"mousewheel-page-height");c*=v,h*=v,u*=v}if(p=Math.max(Math.abs(h),Math.abs(u)),(!s||s>p)&&(s=p,n(o,p)&&(s/=40)),n(o,p)&&(c/=40,u/=40,h/=40),c=Math[c>=1?"floor":"ceil"](c/s),u=Math[u>=1?"floor":"ceil"](u/s),h=Math[h>=1?"floor":"ceil"](h/s),d.settings.normalizeOffset&&this.getBoundingClientRect){var b=this.getBoundingClientRect();f=e.clientX-b.left,m=e.clientY-b.top}return e.deltaX=u,e.deltaY=h,e.deltaFactor=s,e.offsetX=f,e.offsetY=m,e.deltaMode=0,r.unshift(e,c,u,h),a&&clearTimeout(a),a=setTimeout(i,200),(t.event.dispatch||t.event.handle).apply(this,r)}}function i(){s=null}function n(t,e){return d.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}var a,s,o=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],r="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(t.event.fixHooks)for(var c=o.length;c;)t.event.fixHooks[o[--c]]=t.event.mouseHooks;var d=t.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var i=r.length;i;)this.addEventListener(r[--i],e,!1);else this.onmousewheel=e;t.data(this,"mousewheel-line-height",d.getLineHeight(this)),t.data(this,"mousewheel-page-height",d.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var i=r.length;i;)this.removeEventListener(r[--i],e,!1);else this.onmousewheel=null;t.removeData(this,"mousewheel-line-height"),t.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var i=t(e),n=i["offsetParent"in t.fn?"offsetParent":"parent"]();return n.length||(n=t("body")),parseInt(n.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})})),function($){$.extend({tablesorter:new function(){var parsers=[],widgets=[];function benchmark(t,e){log(t+","+((new Date).getTime()-e.getTime())+"ms")}function log(t){"undefined"!=typeof console&&void 0!==console.debug?console.log(t):alert(t)}function buildParserCache(t,e){if(t.config.debug)var i="";if(0!=t.tBodies.length){var n=t.tBodies[0].rows;if(n[0])for(var a=[],s=n[0].cells.length,o=0;o<s;o++){var r=!1;$.metadata&&$(e[o]).metadata()&&$(e[o]).metadata().sorter?r=getParserById($(e[o]).metadata().sorter):t.config.headers[o]&&t.config.headers[o].sorter&&(r=getParserById(t.config.headers[o].sorter)),r||(r=detectParserForColumn(t,n,-1,o)),t.config.debug&&(i+="column:"+o+" parser:"+r.id+"\n"),a.push(r)}return t.config.debug&&log(i),a}}function detectParserForColumn(t,e,i,n){for(var a=parsers.length,s=!1,o=!1,r=!0;""==o&&r;)e[++i]?(s=getNodeFromRowAndCellIndex(e,i,n),o=trimAndGetNodeText(t.config,s),t.config.debug&&log("Checking if value was empty on row:"+i)):r=!1;for(var l=1;l<a;l++)if(parsers[l].is(o,t,s))return parsers[l];return parsers[0]}function getNodeFromRowAndCellIndex(t,e,i){return t[e].cells[i]}function trimAndGetNodeText(t,e){return $.trim(getElementText(t,e))}function getParserById(t){for(var e=parsers.length,i=0;i<e;i++)if(parsers[i].id.toLowerCase()==t.toLowerCase())return parsers[i];return!1}function buildCache(t){if(t.config.debug)var e=new Date;for(var i=t.tBodies[0]&&t.tBodies[0].rows.length||0,n=t.tBodies[0].rows[0]&&t.tBodies[0].rows[0].cells.length||0,a=t.config.parsers,s={row:[],normalized:[]},o=0;o<i;++o){var r=$(t.tBodies[0].rows[o]),l=[];if(r.hasClass(t.config.cssChildRow))s.row[s.row.length-1]=s.row[s.row.length-1].add(r);else{s.row.push(r);for(var c=0;c<n;++c)l.push(a[c].format(getElementText(t.config,r[0].cells[c]),t,r[0].cells[c]));l.push(s.normalized.length),s.normalized.push(l),l=null}}return t.config.debug&&benchmark("Building cache for "+i+" rows:",e),s}function getElementText(t,e){return e?(t.supportsTextContent||(t.supportsTextContent=e.textContent||!1),"simple"==t.textExtraction?t.supportsTextContent?e.textContent:e.childNodes[0]&&e.childNodes[0].hasChildNodes()?e.childNodes[0].innerHTML:e.innerHTML:"function"==typeof t.textExtraction?t.textExtraction(e):$(e).text()):""}function appendToTable(t,e){if(t.config.debug)var i=new Date;for(var n=e,a=n.row,s=n.normalized,o=s.length,r=s[0].length-1,l=$(t.tBodies[0]),c=[],d=0;d<o;d++){var u=s[d][r];if(c.push(a[u]),!t.config.appender)for(var h=a[u].length,p=0;p<h;p++)l[0].appendChild(a[u][p])}t.config.appender&&t.config.appender(t,c),c=null,t.config.debug&&benchmark("Rebuilt table:",i),applyWidget(t),setTimeout((function(){$(t).trigger("sortEnd")}),0)}function buildHeaders(t){if(t.config.debug)var e=new Date;$.metadata;var i=computeTableHeaderCellIndexes(t);return $tableHeaders=$(t.config.selectorHeaders,t).each((function(e){if(this.column=i[this.parentNode.rowIndex+"-"+this.cellIndex],this.order=formatSortingOrder(t.config.sortInitialOrder),this.count=this.order,(checkHeaderMetadata(this)||checkHeaderOptions(t,e))&&(this.sortDisabled=!0),checkHeaderOptionsSortingLocked(t,e)&&(this.order=this.lockedOrder=checkHeaderOptionsSortingLocked(t,e)),!this.sortDisabled){var n=$(this).addClass(t.config.cssHeader);t.config.onRenderHeader&&t.config.onRenderHeader.apply(n)}t.config.headerList[e]=this})),t.config.debug&&(benchmark("Built headers:",e),log($tableHeaders)),$tableHeaders}function computeTableHeaderCellIndexes(t){for(var e=[],i={},n=t.getElementsByTagName("THEAD")[0].getElementsByTagName("TR"),a=0;a<n.length;a++)for(var s=n[a].cells,o=0;o<s.length;o++){var r,l=s[o],c=l.parentNode.rowIndex,d=c+"-"+l.cellIndex,u=l.rowSpan||1,h=l.colSpan||1;void 0===e[c]&&(e[c]=[]);for(var p=0;p<e[c].length+1;p++)if(void 0===e[c][p]){r=p;break}i[d]=r;for(p=c;p<c+u;p++){void 0===e[p]&&(e[p]=[]);for(var f=e[p],m=r;m<r+h;m++)f[m]="x"}}return i}function checkCellColSpan(t,e,i){for(var n=[],a=t.tHead.rows,s=a[i].cells,o=0;o<s.length;o++){var r=s[o];r.colSpan>1?n=n.concat(checkCellColSpan(t,headerArr,i++)):(1==t.tHead.length||r.rowSpan>1||!a[i+1])&&n.push(r)}return n}function checkHeaderMetadata(t){return!(!$.metadata||!1!==$(t).metadata().sorter)}function checkHeaderOptions(t,e){return!(!t.config.headers[e]||!1!==t.config.headers[e].sorter)}function checkHeaderOptionsSortingLocked(t,e){return!(!t.config.headers[e]||!t.config.headers[e].lockedOrder)&&t.config.headers[e].lockedOrder}function applyWidget(t){for(var e=t.config.widgets,i=e.length,n=0;n<i;n++)getWidgetById(e[n]).format(t)}function getWidgetById(t){for(var e=widgets.length,i=0;i<e;i++)if(widgets[i].id.toLowerCase()==t.toLowerCase())return widgets[i]}function formatSortingOrder(t){return"Number"!=typeof t?"desc"==t.toLowerCase()?1:0:1==t?1:0}function isValueInArray(t,e){for(var i=e.length,n=0;n<i;n++)if(e[n][0]==t)return!0;return!1}function setHeadersCss(t,e,i,n){e.removeClass(n[0]).removeClass(n[1]);var a=[];e.each((function(t){this.sortDisabled||(a[this.column]=$(this))}));for(var s=i.length,o=0;o<s;o++)a[i[o][0]].addClass(n[i[o][1]])}function fixColumnWidth(t,e){if(t.config.widthFixed){var i=$("<colgroup>");$("tr:first td",t.tBodies[0]).each((function(){i.append($("<col>").css("width",$(this).width()))})),$(t).prepend(i)}}function updateHeaderSortCount(t,e){for(var i=t.config,n=e.length,a=0;a<n;a++){var s=e[a],o=i.headerList[s[0]];o.count=s[1],o.count++}}function multisort(table,sortList,cache){if(table.config.debug)var sortTime=new Date;for(var dynamicExp="var sortWrapper = function(a,b) {",l=sortList.length,i=0;i<l;i++){var c=sortList[i][0],order=sortList[i][1],s="text"==table.config.parsers[c].type?makeSortFunction("text",0==order?"asc":"desc",c):makeSortFunction("numeric",0==order?"asc":"desc",c),e="e"+i;dynamicExp+="var "+e+" = "+s,dynamicExp+="if("+e+") { return "+e+"; } ",dynamicExp+="else { "}var orgOrderCol=cache.normalized[0].length-1;dynamicExp+="return a["+orgOrderCol+"]-b["+orgOrderCol+"];";for(var i=0;i<l;i++)dynamicExp+="}; ";return dynamicExp+="return 0; ",dynamicExp+="}; ",table.config.debug&&benchmark("Evaling expression:"+dynamicExp,new Date),eval(dynamicExp),cache.normalized.sort(sortWrapper),table.config.debug&&benchmark("Sorting on "+sortList.toString()+" and dir "+order+" time:",sortTime),cache}function makeSortFunction(t,e,i){var n="a["+i+"]",a="b["+i+"]";return"text"==t&&"asc"==e?"("+n+" == "+a+" ? 0 : ("+n+" === null ? Number.POSITIVE_INFINITY : ("+a+" === null ? Number.NEGATIVE_INFINITY : ("+n+" < "+a+") ? -1 : 1 )));":"text"==t&&"desc"==e?"("+n+" == "+a+" ? 0 : ("+n+" === null ? Number.POSITIVE_INFINITY : ("+a+" === null ? Number.NEGATIVE_INFINITY : ("+a+" < "+n+") ? -1 : 1 )));":"numeric"==t&&"asc"==e?"("+n+" === null && "+a+" === null) ? 0 :("+n+" === null ? Number.POSITIVE_INFINITY : ("+a+" === null ? Number.NEGATIVE_INFINITY : "+n+" - "+a+"));":"numeric"==t&&"desc"==e?"("+n+" === null && "+a+" === null) ? 0 :("+n+" === null ? Number.POSITIVE_INFINITY : ("+a+" === null ? Number.NEGATIVE_INFINITY : "+a+" - "+n+"));":void 0}function makeSortText(t){return"((a["+t+"] < b["+t+"]) ? -1 : ((a["+t+"] > b["+t+"]) ? 1 : 0));"}function makeSortTextDesc(t){return"((b["+t+"] < a["+t+"]) ? -1 : ((b["+t+"] > a["+t+"]) ? 1 : 0));"}function makeSortNumeric(t){return"a["+t+"]-b["+t+"];"}function makeSortNumericDesc(t){return"b["+t+"]-a["+t+"];"}function sortText(t,e){return table.config.sortLocaleCompare?t.localeCompare(e):t<e?-1:t>e?1:0}function sortTextDesc(t,e){return table.config.sortLocaleCompare?e.localeCompare(t):e<t?-1:e>t?1:0}function sortNumeric(t,e){return t-e}function sortNumericDesc(t,e){return e-t}function getCachedSortType(t,e){return t[e].type}this.defaults={cssHeader:"header",cssAsc:"headerSortUp",cssDesc:"headerSortDown",cssChildRow:"expand-child",sortInitialOrder:"asc",sortMultiSortKey:"shiftKey",sortForce:null,sortAppend:null,sortLocaleCompare:!0,textExtraction:"simple",parsers:{},widgets:[],widgetZebra:{css:["even","odd"]},headers:{},widthFixed:!1,cancelSelection:!0,sortList:[],headerList:[],dateFormat:"us",decimal:"/.|,/g",onRenderHeader:null,selectorHeaders:"thead th",debug:!1},this.benchmark=benchmark,this.construct=function(t){return this.each((function(){if(this.tHead&&this.tBodies){var e,i,n,a;this.config={},a=$.extend(this.config,$.tablesorter.defaults,t),e=$(this),$.data(this,"tablesorter",a),i=buildHeaders(this),this.config.parsers=buildParserCache(this,i),n=buildCache(this);var s=[a.cssDesc,a.cssAsc];fixColumnWidth(this),i.click((function(t){var o=e[0].tBodies[0]&&e[0].tBodies[0].rows.length||0;if(!this.sortDisabled&&o>0){e.trigger("sortStart");$(this);var r=this.column;if(this.order=this.count++%2,this.lockedOrder&&(this.order=this.lockedOrder),t[a.sortMultiSortKey])if(isValueInArray(r,a.sortList))for(u=0;u<a.sortList.length;u++){var l=a.sortList[u],c=a.headerList[l[0]];l[0]==r&&(c.count=l[1],c.count++,l[1]=c.count%2)}else a.sortList.push([r,this.order]);else{if(a.sortList=[],null!=a.sortForce)for(var d=a.sortForce,u=0;u<d.length;u++)d[u][0]!=r&&a.sortList.push(d[u]);a.sortList.push([r,this.order])}return setTimeout((function(){setHeadersCss(e[0],i,a.sortList,s),appendToTable(e[0],multisort(e[0],a.sortList,n))}),1),!1}})).mousedown((function(){if(a.cancelSelection)return this.onselectstart=function(){return!1},!1})),e.bind("update",(function(){var t=this;setTimeout((function(){t.config.parsers=buildParserCache(t,i),n=buildCache(t)}),1)})).bind("updateCell",(function(t,e){var i=this.config,a=[e.parentNode.rowIndex-1,e.cellIndex];n.normalized[a[0]][a[1]]=i.parsers[a[1]].format(getElementText(i,e),e)})).bind("sorton",(function(t,e){$(this).trigger("sortStart"),a.sortList=e;var o=a.sortList;updateHeaderSortCount(this,o),setHeadersCss(this,i,o,s),appendToTable(this,multisort(this,o,n))})).bind("appendCache",(function(){appendToTable(this,n)})).bind("applyWidgetId",(function(t,e){getWidgetById(e).format(this)})).bind("applyWidgets",(function(){applyWidget(this)})),$.metadata&&$(this).metadata()&&$(this).metadata().sortlist&&(a.sortList=$(this).metadata().sortlist),a.sortList.length>0&&e.trigger("sorton",[a.sortList]),applyWidget(this)}}))},this.addParser=function(t){for(var e=parsers.length,i=!0,n=0;n<e;n++)parsers[n].id.toLowerCase()==t.id.toLowerCase()&&(i=!1);i&&parsers.push(t)},this.addWidget=function(t){widgets.push(t)},this.formatFloat=function(t){var e=parseFloat(t);return isNaN(e)?0:e},this.formatInt=function(t){var e=parseInt(t);return isNaN(e)?0:e},this.isDigit=function(t,e){return/^[-+]?\d*$/.test($.trim(t.replace(/[,.']/g,"")))},this.clearTableBody=function(t){if($.browser.msie){(function(){for(;this.firstChild;)this.removeChild(this.firstChild)}).apply(t.tBodies[0])}else t.tBodies[0].innerHTML=""}}}),$.fn.extend({tablesorter:$.tablesorter.construct});var ts=$.tablesorter;ts.addParser({id:"text",is:function(t){return!0},format:function(t){return $.trim(t.toLocaleLowerCase())},type:"text"}),ts.addParser({id:"digit",is:function(t,e){var i=e.config;return $.tablesorter.isDigit(t,i)},format:function(t){return $.tablesorter.formatFloat(t)},type:"numeric"}),ts.addParser({id:"currency",is:function(t){return/^[$?.]/.test(t)},format:function(t){return $.tablesorter.formatFloat(t.replace(new RegExp(/[$]/g),""))},type:"numeric"}),ts.addParser({id:"ipAddress",is:function(t){return/^\d{2,3}[\.]\d{2,3}[\.]\d{2,3}[\.]\d{2,3}$/.test(t)},format:function(t){for(var e=t.split("."),i="",n=e.length,a=0;a<n;a++){var s=e[a];2==s.length?i+="0"+s:i+=s}return $.tablesorter.formatFloat(i)},type:"numeric"}),ts.addParser({id:"url",is:function(t){return/^(https?|ftp|file):\/\/$/.test(t)},format:function(t){return jQuery.trim(t.replace(new RegExp(/(https?|ftp|file):\/\//),""))},type:"text"}),ts.addParser({id:"isoDate",is:function(t){return/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(t)},format:function(t){return $.tablesorter.formatFloat(""!=t?new Date(t.replace(new RegExp(/-/g),"/")).getTime():"0")},type:"numeric"}),ts.addParser({id:"percent",is:function(t){return/\%$/.test($.trim(t))},format:function(t){return $.tablesorter.formatFloat(t.replace(new RegExp(/%/g),""))},type:"numeric"}),ts.addParser({id:"usLongDate",is:function(t){return t.match(new RegExp(/^[A-Za-z]{3,10}\.? [0-9]{1,2}, ([0-9]{4}|'?[0-9]{2}) (([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(AM|PM)))$/))},format:function(t){return $.tablesorter.formatFloat(new Date(t).getTime())},type:"numeric"}),ts.addParser({id:"shortDate",is:function(t){return/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/.test(t)},format:function(t,e){var i=e.config;return t=t.replace(/\-/g,"/"),"us"==i.dateFormat?t=t.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$1/$2"):"uk"==i.dateFormat?t=t.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$2/$1"):"dd/mm/yy"!=i.dateFormat&&"dd-mm-yy"!=i.dateFormat||(t=t.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})/,"$1/$2/$3")),$.tablesorter.formatFloat(new Date(t).getTime())},type:"numeric"}),ts.addParser({id:"time",is:function(t){return/^(([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(am|pm)))$/.test(t)},format:function(t){return $.tablesorter.formatFloat(new Date("2000/01/01 "+t).getTime())},type:"numeric"}),ts.addParser({id:"metadata",is:function(t){return!1},format:function(t,e,i){var n=e.config,a=n.parserMetadataName?n.parserMetadataName:"sortValue";return $(i).metadata()[a]},type:"numeric"}),ts.addWidget({id:"zebra",format:function(t){if(t.config.debug)var e=new Date;var i,n,a=-1;$("tr:visible",t.tBodies[0]).each((function(e){(i=$(this)).hasClass(t.config.cssChildRow)||a++,n=a%2==0,i.removeClass(t.config.widgetZebra.css[n?0:1]).addClass(t.config.widgetZebra.css[n?1:0])})),t.config.debug&&$.tablesorter.benchmark("Applying Zebra widget",e)}})}(jQuery),function(t){"use strict";var e={init:function(i){var n=this;return n.data("jqv")&&null!=n.data("jqv")||(i=e._saveOptions(n,i),t(document).on("click",".formError",(function(){t(this).fadeOut(150,(function(){t(this).parent(".formErrorOuter").remove(),t(this).remove()}))}))),this},attach:function(i){var n,a=this;return(n=i?e._saveOptions(a,i):a.data("jqv")).validateAttribute=a.find("[data-validation-engine*=validate]").length?"data-validation-engine":"class",n.binded&&(a.on(n.validationEventTrigger,"["+n.validateAttribute+"*=validate]:not([type=checkbox]):not([type=radio]):not(.datepicker)",e._onFieldEvent),a.on("click","["+n.validateAttribute+"*=validate][type=checkbox],["+n.validateAttribute+"*=validate][type=radio]",e._onFieldEvent),a.on(n.validationEventTrigger,"["+n.validateAttribute+"*=validate][class*=datepicker]",{delay:300},e._onFieldEvent)),n.autoPositionUpdate&&t(window).bind("resize",{noAnimation:!0,formElem:a},e.updatePromptsPosition),a.on("click","a[data-validation-engine-skip], a[class*='validate-skip'], button[data-validation-engine-skip], button[class*='validate-skip'], input[data-validation-engine-skip], input[class*='validate-skip']",e._submitButtonClick),a.removeData("jqv_submitButton"),a.on("submit",e._onSubmitEvent),this},detach:function(){var i=this,n=i.data("jqv");return i.find("["+n.validateAttribute+"*=validate]").not("[type=checkbox]").off(n.validationEventTrigger,e._onFieldEvent),i.find("["+n.validateAttribute+"*=validate][type=checkbox],[class*=validate][type=radio]").off("click",e._onFieldEvent),i.off("submit",e._onSubmitEvent),i.removeData("jqv"),i.off("click","a[data-validation-engine-skip], a[class*='validate-skip'], button[data-validation-engine-skip], button[class*='validate-skip'], input[data-validation-engine-skip], input[class*='validate-skip']",e._submitButtonClick),i.removeData("jqv_submitButton"),n.autoPositionUpdate&&t(window).off("resize",e.updatePromptsPosition),this},validate:function(){var i=t(this),n=null;if(i.is("form")||i.hasClass("validationEngineContainer")){if(i.hasClass("validating"))return!1;i.addClass("validating");var a=i.data("jqv");n=e._validateFields(this);setTimeout((function(){i.removeClass("validating")}),100),n&&a.onSuccess?a.onSuccess():!n&&a.onFailure&&a.onFailure()}else if(i.is("form")||i.hasClass("validationEngineContainer"))i.removeClass("validating");else{var s=i.closest("form, .validationEngineContainer");a=s.data("jqv")?s.data("jqv"):t.validationEngine.defaults;(n=e._validateField(i,a))&&a.onFieldSuccess?a.onFieldSuccess():a.onFieldFailure&&a.InvalidFields.length>0&&a.onFieldFailure()}return a.onValidationComplete?!!a.onValidationComplete(s,n):n},updatePromptsPosition:function(i){if(i&&this==window)var n=i.data.formElem,a=i.data.noAnimation;else n=t(this.closest("form, .validationEngineContainer"));var s=n.data("jqv");return n.find("["+s.validateAttribute+"*=validate]").not(":disabled").each((function(){var i=t(this);s.prettySelect&&i.is(":hidden")&&(i=n.find("#"+s.usePrefix+i.attr("id")+s.useSuffix));var o=e._getPrompt(i),r=t(o).find(".formErrorContent").html();o&&e._updatePrompt(i,t(o),r,void 0,!1,s,a)})),this},showPrompt:function(t,i,n,a){var s=this.closest("form, .validationEngineContainer").data("jqv");return s||(s=e._saveOptions(this,s)),n&&(s.promptPosition=n),s.showArrow=1==a,e._showPrompt(this,t,i,!1,s),this},hide:function(){var i,n=t(this).closest("form, .validationEngineContainer").data("jqv"),a=n&&n.fadeDuration?n.fadeDuration:.3;return i=t(this).is("form")||t(this).hasClass("validationEngineContainer")?"parentForm"+e._getClassName(t(this).attr("id")):e._getClassName(t(this).attr("id"))+"formError",t("."+i).fadeTo(a,.3,(function(){t(this).parent(".formErrorOuter").remove(),t(this).remove()})),this},hideAll:function(){var e=this.data("jqv"),i=e?e.fadeDuration:300;return t(".formError").fadeTo(i,300,(function(){t(this).parent(".formErrorOuter").remove(),t(this).remove()})),this},_onFieldEvent:function(i){var n=t(this),a=n.closest("form, .validationEngineContainer").data("jqv");a.eventTrigger="field",window.setTimeout((function(){e._validateField(n,a),0==a.InvalidFields.length&&a.onFieldSuccess?a.onFieldSuccess():a.InvalidFields.length>0&&a.onFieldFailure&&a.onFieldFailure()}),i.data?i.data.delay:0)},_onSubmitEvent:function(){var i=t(this),n=i.data("jqv");if(i.data("jqv_submitButton")){var a=t("#"+i.data("jqv_submitButton"));if(a&&a.length>0&&(a.hasClass("validate-skip")||"true"==a.attr("data-validation-engine-skip")))return!0}n.eventTrigger="submit";var s=e._validateFields(i);return s&&n.ajaxFormValidation?(e._validateFormWithAjax(i,n),!1):n.onValidationComplete?!!n.onValidationComplete(i,s):s},_checkAjaxStatus:function(e){var i=!0;return t.each(e.ajaxValidCache,(function(t,e){if(!e)return i=!1,!1})),i},_checkAjaxFieldStatus:function(t,e){return 1==e.ajaxValidCache[t]},_validateFields:function(i){var n=i.data("jqv"),a=!1;i.trigger("jqv.form.validating");var s=null;if(i.find("["+n.validateAttribute+"*=validate]").not(":disabled").each((function(){var o=t(this),r=[];if(t.inArray(o.attr("name"),r)<0){if((a|=e._validateField(o,n))&&null==s&&(o.is(":hidden")&&n.prettySelect?s=o=i.find("#"+n.usePrefix+e._jqSelector(o.attr("id"))+n.useSuffix):(o.data("jqv-prompt-at")instanceof jQuery?o=o.data("jqv-prompt-at"):o.data("jqv-prompt-at")&&(o=t(o.data("jqv-prompt-at"))),s=o)),n.doNotShowAllErrosOnSubmit)return!1;if(r.push(o.attr("name")),1==n.showOneMessage&&a)return!1}})),i.trigger("jqv.form.result",[a]),a){if(n.scroll){var o=s.offset().top,r=s.offset().left,l=n.promptPosition;if("string"==typeof l&&-1!=l.indexOf(":")&&(l=l.substring(0,l.indexOf(":"))),"bottomRight"!=l&&"bottomLeft"!=l){var c=e._getPrompt(s);c&&(o=c.offset().top)}if(n.scrollOffset&&(o-=n.scrollOffset),n.isOverflown){var d=t(n.overflownDIV);if(!d.length)return!1;o+=d.scrollTop()+-parseInt(d.offset().top)-5,t(n.overflownDIV+":not(:animated)").animate({scrollTop:o},1100,(function(){n.focusFirstField&&s.focus()}))}else t("html, body").animate({scrollTop:o},1100,(function(){n.focusFirstField&&s.focus()})),t("html, body").animate({scrollLeft:r},1100)}else n.focusFirstField&&s.focus();return!1}return!0},_validateFormWithAjax:function(i,n){var a=i.serialize(),s=n.ajaxFormValidationMethod?n.ajaxFormValidationMethod:"GET",o=n.ajaxFormValidationURL?n.ajaxFormValidationURL:i.attr("action"),r=n.dataType?n.dataType:"json";t.ajax({type:s,url:o,cache:!1,dataType:r,data:a,form:i,methods:e,options:n,beforeSend:function(){return n.onBeforeAjaxFormValidation(i,n)},error:function(t,i){e._ajaxError(t,i)},success:function(a){if("json"==r&&!0!==a){for(var s=!1,o=0;o<a.length;o++){var l=a[o],c=l[0],d=t(t("#"+c)[0]);if(1==d.length){var u=l[2];if(1==l[1])if(""!=u&&u){if(n.allrules[u])(h=n.allrules[u].alertTextOk)&&(u=h);n.showPrompts&&e._showPrompt(d,u,"pass",!1,n,!0)}else e._closePrompt(d);else{var h;if(s|=!0,n.allrules[u])(h=n.allrules[u].alertText)&&(u=h);n.showPrompts&&e._showPrompt(d,u,"",!1,n,!0)}}}n.onAjaxFormComplete(!s,i,a,n)}else n.onAjaxFormComplete(!0,i,a,n)}})},_validateField:function(i,n,a){if(i.attr("id")||(i.attr("id","form-validation-field-"+t.validationEngine.fieldIdCounter),++t.validationEngine.fieldIdCounter),!n.validateNonVisibleFields&&(i.is(":hidden")&&!n.prettySelect||i.parent().is(":hidden")))return!1;var s=i.attr(n.validateAttribute),o=/validate\[(.*)\]/.exec(s);if(!o)return!1;var r=o[1].split(/\[|,|\]/),l=i.attr("name"),c="",d="",u=!1,h=!1;n.isError=!1,n.showArrow=!0,n.maxErrorsPerField>0&&(h=!0);for(var p=t(i.closest("form, .validationEngineContainer")),f=0;f<r.length;f++)r[f]=r[f].replace(" ",""),""===r[f]&&delete r[f];f=0;for(var m=0;f<r.length;f++){if(h&&m>=n.maxErrorsPerField){if(!u){var g=t.inArray("required",r);u=-1!=g&&g>=f}break}var v=void 0;switch(r[f]){case"required":u=!0,v=e._getErrorMessage(p,i,r[f],r,f,n,e._required);break;case"custom":v=e._getErrorMessage(p,i,r[f],r,f,n,e._custom);break;case"groupRequired":var b="["+n.validateAttribute+"*="+r[f+1]+"]",y=p.find(b).eq(0);y[0]!=i[0]&&(e._validateField(y,n,a),n.showArrow=!0),(v=e._getErrorMessage(p,i,r[f],r,f,n,e._groupRequired))&&(u=!0),n.showArrow=!1;break;case"ajax":(v=e._ajax(i,r,f,n))&&(d="load");break;case"minSize":v=e._getErrorMessage(p,i,r[f],r,f,n,e._minSize);break;case"maxSize":v=e._getErrorMessage(p,i,r[f],r,f,n,e._maxSize);break;case"min":v=e._getErrorMessage(p,i,r[f],r,f,n,e._min);break;case"max":v=e._getErrorMessage(p,i,r[f],r,f,n,e._max);break;case"past":v=e._getErrorMessage(p,i,r[f],r,f,n,e._past);break;case"future":v=e._getErrorMessage(p,i,r[f],r,f,n,e._future);break;case"dateRange":b="["+n.validateAttribute+"*="+r[f+1]+"]";n.firstOfGroup=p.find(b).eq(0),n.secondOfGroup=p.find(b).eq(1),(n.firstOfGroup[0].value||n.secondOfGroup[0].value)&&(v=e._getErrorMessage(p,i,r[f],r,f,n,e._dateRange)),v&&(u=!0),n.showArrow=!1;break;case"dateTimeRange":b="["+n.validateAttribute+"*="+r[f+1]+"]";n.firstOfGroup=p.find(b).eq(0),n.secondOfGroup=p.find(b).eq(1),(n.firstOfGroup[0].value||n.secondOfGroup[0].value)&&(v=e._getErrorMessage(p,i,r[f],r,f,n,e._dateTimeRange)),v&&(u=!0),n.showArrow=!1;break;case"maxCheckbox":i=t(p.find("input[name='"+l+"']")),v=e._getErrorMessage(p,i,r[f],r,f,n,e._maxCheckbox);break;case"minCheckbox":i=t(p.find("input[name='"+l+"']")),v=e._getErrorMessage(p,i,r[f],r,f,n,e._minCheckbox);break;case"equals":v=e._getErrorMessage(p,i,r[f],r,f,n,e._equals);break;case"funcCall":v=e._getErrorMessage(p,i,r[f],r,f,n,e._funcCall);break;case"creditCard":v=e._getErrorMessage(p,i,r[f],r,f,n,e._creditCard);break;case"condRequired":void 0!==(v=e._getErrorMessage(p,i,r[f],r,f,n,e._condRequired))&&(u=!0)}var _=!1;if("object"==typeof v)switch(v.status){case"_break":_=!0;break;case"_error":v=v.message;break;case"_error_no_prompt":return!0}if(_)break;"string"==typeof v&&(c+=v+"<br/>",n.isError=!0,m++)}!u&&!i.val()&&i.val().length<1&&(n.isError=!1);var x=i.prop("type"),w=i.data("promptPosition")||n.promptPosition;("radio"==x||"checkbox"==x)&&p.find("input[name='"+l+"']").size()>1&&(i=t("inline"===w?p.find("input[name='"+l+"'][type!=hidden]:last"):p.find("input[name='"+l+"'][type!=hidden]:first")),n.showArrow=!1),i.is(":hidden")&&n.prettySelect&&(i=p.find("#"+n.usePrefix+e._jqSelector(i.attr("id"))+n.useSuffix)),n.isError&&n.showPrompts?e._showPrompt(i,c,d,!1,n):e._closePrompt(i),i.trigger("jqv.field.result",[i,n.isError,c]);var C=t.inArray(i[0],n.InvalidFields);return-1==C?n.isError&&n.InvalidFields.push(i[0]):n.isError||n.InvalidFields.splice(C,1),e._handleStatusCssClasses(i,n),n.isError&&n.onFieldFailure&&n.onFieldFailure(i),!n.isError&&n.onFieldSuccess&&n.onFieldSuccess(i),n.isError},_handleStatusCssClasses:function(t,e){e.addSuccessCssClassToField&&t.removeClass(e.addSuccessCssClassToField),e.addFailureCssClassToField&&t.removeClass(e.addFailureCssClassToField),e.addSuccessCssClassToField&&!e.isError&&t.addClass(e.addSuccessCssClassToField),e.addFailureCssClassToField&&e.isError&&t.addClass(e.addFailureCssClassToField)},_getErrorMessage:function(i,n,a,s,o,r,l){var c=jQuery.inArray(a,s);"custom"!==a&&"funcCall"!==a||(a=a+"["+s[c+1]+"]",delete s[c]);var d,u=a,h=(n.attr("data-validation-engine")?n.attr("data-validation-engine"):n.attr("class")).split(" ");if(null!=(d="future"==a||"past"==a||"maxCheckbox"==a||"minCheckbox"==a?l(i,n,s,o,r):l(n,s,o,r))){var p=e._getCustomErrorMessage(t(n),h,u,r);p&&(d=p)}return d},_getCustomErrorMessage:function(t,i,n,a){var s=!1,o=/^custom\[.*\]$/.test(n)?e._validityProp.custom:e._validityProp[n];if(null!=o&&null!=(s=t.attr("data-errormessage-"+o)))return s;if(null!=(s=t.attr("data-errormessage")))return s;var r="#"+t.attr("id");if(void 0!==a.custom_error_messages[r]&&void 0!==a.custom_error_messages[r][n])s=a.custom_error_messages[r][n].message;else if(i.length>0)for(var l=0;l<i.length&&i.length>0;l++){var c="."+i[l];if(void 0!==a.custom_error_messages[c]&&void 0!==a.custom_error_messages[c][n]){s=a.custom_error_messages[c][n].message;break}}return s||void 0===a.custom_error_messages[n]||void 0===a.custom_error_messages[n].message||(s=a.custom_error_messages[n].message),s},_validityProp:{required:"value-missing",custom:"custom-error",groupRequired:"value-missing",ajax:"custom-error",minSize:"range-underflow",maxSize:"range-overflow",min:"range-underflow",max:"range-overflow",past:"type-mismatch",future:"type-mismatch",dateRange:"type-mismatch",dateTimeRange:"type-mismatch",maxCheckbox:"range-overflow",minCheckbox:"range-underflow",equals:"pattern-mismatch",funcCall:"custom-error",creditCard:"pattern-mismatch",condRequired:"value-missing"},_required:function(e,i,n,a,s){switch(e.prop("type")){case"text":case"password":case"textarea":case"file":case"select-one":case"select-multiple":default:var o=t.trim(e.val()),r=t.trim(e.attr("data-validation-placeholder"));if(!o||r&&o==r)return a.allrules[i[n]].alertText;break;case"radio":case"checkbox":if(s){if(!e.attr("checked"))return a.allrules[i[n]].alertTextCheckboxMultiple;break}var l=e.closest("form, .validationEngineContainer"),c=e.attr("name");if(0==l.find("input[name='"+c+"']:checked").size())return 1==l.find("input[name='"+c+"']:visible").size()?a.allrules[i[n]].alertTextCheckboxe:a.allrules[i[n]].alertTextCheckboxMultiple}},_groupRequired:function(i,n,a,s){var o="["+s.validateAttribute+"*="+n[a+1]+"]",r=!1;if(i.closest("form, .validationEngineContainer").find(o).each((function(){if(!e._required(t(this),n,a,s))return r=!0,!1})),!r)return s.allrules[n[a]].alertText},_custom:function(t,e,i,n){var a,s=e[i+1],o=n.allrules[s];if(o)if(o.regex){var r=o.regex;if(!r)return void alert("jqv:custom regex not found - "+s);if(!new RegExp(r).test(t.val()))return n.allrules[s].alertText}else{if(!o.func)return void alert("jqv:custom type not allowed "+s);if("function"!=typeof(a=o.func))return void alert("jqv:custom parameter 'function' is no function - "+s);if(!a(t,e,i,n))return n.allrules[s].alertText}else alert("jqv:custom rule not found - "+s)},_funcCall:function(t,e,i,n){var a,s=e[i+1];if(s.indexOf(".")>-1){for(var o=s.split("."),r=window;o.length;)r=r[o.shift()];a=r}else a=window[s]||n.customFunctions[s];if("function"==typeof a)return a(t,e,i,n)},_equals:function(e,i,n,a){var s=i[n+1];if(e.val()!=t("#"+s).val())return a.allrules.equals.alertText},_maxSize:function(t,e,i,n){var a=e[i+1];if(t.val().length>a){var s=n.allrules.maxSize;return"string"==typeof s.alertText2?s.alertText+min+s.alertText2:s.alertText}},_minSize:function(t,e,i,n){var a=e[i+1];if(t.val().length<a){var s=n.allrules.minSize;return"string"==typeof s.alertText2?s.alertText+a+s.alertText2:s.alertText}},_min:function(t,e,i,n){var a=parseFloat(e[i+1]);if(parseFloat(t.val())<a){var s=n.allrules.min;return s.alertText2?s.alertText+a+s.alertText2:s.alertText+a}},_max:function(t,e,i,n){var a=parseFloat(e[i+1]);if(parseFloat(t.val())>a){var s=n.allrules.max;return s.alertText2?s.alertText+a+s.alertText2:s.alertText+a}},_past:function(i,n,a,s,o){var r,l=a[s+1],c=t(i.find("input[name='"+l.replace(/^#+/,"")+"']"));if("now"==l.toLowerCase())r=new Date;else if(null!=c.val()){if(c.is(":disabled"))return;r=e._parseDate(c.val())}else r=e._parseDate(l);if(e._parseDate(n.val())>r){var d=o.allrules.past;return d.alertText2?d.alertText+e._dateToString(r)+d.alertText2:d.alertText+e._dateToString(r)}},_future:function(i,n,a,s,o){var r,l=a[s+1],c=t(i.find("input[name='"+l.replace(/^#+/,"")+"']"));if("now"==l.toLowerCase())r=new Date;else if(null!=c.val()){if(c.is(":disabled"))return;r=e._parseDate(c.val())}else r=e._parseDate(l);if(e._parseDate(n.val())<r){var d=o.allrules.future;return d.alertText2?d.alertText+e._dateToString(r)+d.alertText2:d.alertText+e._dateToString(r)}},_isDate:function(t){return new RegExp(/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$|^(?:(?:(?:0?[13578]|1[02])(\/|-)31)|(?:(?:0?[1,3-9]|1[0-2])(\/|-)(?:29|30)))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^(?:(?:0?[1-9]|1[0-2])(\/|-)(?:0?[1-9]|1\d|2[0-8]))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^(0?2(\/|-)29)(\/|-)(?:(?:0[48]00|[13579][26]00|[2468][048]00)|(?:\d\d)?(?:0[48]|[2468][048]|[13579][26]))$/).test(t)},_isDateTime:function(t){return new RegExp(/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])\s+(1[012]|0?[1-9]){1}:(0?[1-5]|[0-6][0-9]){1}:(0?[0-6]|[0-6][0-9]){1}\s+(am|pm|AM|PM){1}$|^(?:(?:(?:0?[13578]|1[02])(\/|-)31)|(?:(?:0?[1,3-9]|1[0-2])(\/|-)(?:29|30)))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^((1[012]|0?[1-9]){1}\/(0?[1-9]|[12][0-9]|3[01]){1}\/\d{2,4}\s+(1[012]|0?[1-9]){1}:(0?[1-5]|[0-6][0-9]){1}:(0?[0-6]|[0-6][0-9]){1}\s+(am|pm|AM|PM){1})$/).test(t)},_dateCompare:function(t,e){return new Date(t.toString())<new Date(e.toString())},_dateRange:function(t,i,n,a){return!a.firstOfGroup[0].value&&a.secondOfGroup[0].value||a.firstOfGroup[0].value&&!a.secondOfGroup[0].value?a.allrules[i[n]].alertText+a.allrules[i[n]].alertText2:e._isDate(a.firstOfGroup[0].value)&&e._isDate(a.secondOfGroup[0].value)&&e._dateCompare(a.firstOfGroup[0].value,a.secondOfGroup[0].value)?void 0:a.allrules[i[n]].alertText+a.allrules[i[n]].alertText2},_dateTimeRange:function(t,i,n,a){return!a.firstOfGroup[0].value&&a.secondOfGroup[0].value||a.firstOfGroup[0].value&&!a.secondOfGroup[0].value?a.allrules[i[n]].alertText+a.allrules[i[n]].alertText2:e._isDateTime(a.firstOfGroup[0].value)&&e._isDateTime(a.secondOfGroup[0].value)&&e._dateCompare(a.firstOfGroup[0].value,a.secondOfGroup[0].value)?void 0:a.allrules[i[n]].alertText+a.allrules[i[n]].alertText2},_maxCheckbox:function(t,e,i,n,a){var s=i[n+1],o=e.attr("name");if(t.find("input[name='"+o+"']:checked").size()>s)return a.showArrow=!1,a.allrules.maxCheckbox.alertText2?a.allrules.maxCheckbox.alertText+" "+s+" "+a.allrules.maxCheckbox.alertText2:a.allrules.maxCheckbox.alertText},_minCheckbox:function(t,e,i,n,a){var s=i[n+1],o=e.attr("name");if(t.find("input[name='"+o+"']:checked").size()<s)return a.showArrow=!1,a.allrules.minCheckbox.alertText+" "+s+" "+a.allrules.minCheckbox.alertText2},_creditCard:function(t,e,i,n){var a=!1,s=t.val().replace(/ +/g,"").replace(/-+/g,""),o=s.length;if(o>=14&&o<=16&&parseInt(s)>0){var r,l=0,c=(i=o-1,1),d=new String;do{r=parseInt(s.charAt(i)),d+=c++%2==0?2*r:r}while(--i>=0);for(i=0;i<d.length;i++)l+=parseInt(d.charAt(i));a=l%10==0}if(!a)return n.allrules.creditCard.alertText},_ajax:function(i,n,a,s){var o=n[a+1],r=s.allrules[o],l=r.extraData,c=r.extraDataDynamic,d={fieldId:i.attr("id"),fieldValue:i.val()};if("object"==typeof l)t.extend(d,l);else if("string"==typeof l){var u=l.split("&");for(a=0;a<u.length;a++){var h=u[a].split("=");h[0]&&h[0]&&(d[h[0]]=h[1])}}if(c){var p=String(c).split(",");for(a=0;a<p.length;a++){var f=p[a];if(t(f).length){var m=i.closest("form, .validationEngineContainer").find(f).val();f.replace("#",""),escape(m);d[f.replace("#","")]=m}}}if("field"==s.eventTrigger&&delete s.ajaxValidCache[i.attr("id")],!s.isError&&!e._checkAjaxFieldStatus(i.attr("id"),s))return t.ajax({type:s.ajaxFormValidationMethod,url:r.url,cache:!1,dataType:"json",data:d,field:i,rule:r,methods:e,options:s,beforeSend:function(){},error:function(t,i){e._ajaxError(t,i)},success:function(n){var a=n[0],o=t("#"+a).eq(0);if(1==o.length){var l=n[1],c=n[2];if(l){if(s.ajaxValidCache[a]=!0,c){if(s.allrules[c])(d=s.allrules[c].alertTextOk)&&(c=d)}else c=r.alertTextOk;s.showPrompts&&(c?e._showPrompt(o,c,"pass",!0,s):e._closePrompt(o)),"submit"==s.eventTrigger&&i.closest("form").submit()}else{var d;if(s.ajaxValidCache[a]=!1,s.isError=!0,c){if(s.allrules[c])(d=s.allrules[c].alertText)&&(c=d)}else c=r.alertText;s.showPrompts&&e._showPrompt(o,c,"",!0,s)}}o.trigger("jqv.field.result",[o,s.isError,c])}}),r.alertTextLoad},_ajaxError:function(t,e){0==t.status&&null==e?alert("The page is not served from a server! ajax call failed"):"undefined"!=typeof console&&console.log("Ajax error: "+t.status+" "+e)},_dateToString:function(t){return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()},_parseDate:function(t){var e=t.split("-");return e==t&&(e=t.split("/")),e==t?(e=t.split("."),new Date(e[2],e[1]-1,e[0])):new Date(e[0],e[1]-1,e[2])},_showPrompt:function(i,n,a,s,o,r){i.data("jqv-prompt-at")instanceof jQuery?i=i.data("jqv-prompt-at"):i.data("jqv-prompt-at")&&(i=t(i.data("jqv-prompt-at")));var l=e._getPrompt(i);r&&(l=!1),t.trim(n)&&(l?e._updatePrompt(i,l,n,a,s,o):e._buildPrompt(i,n,a,s,o))},_buildPrompt:function(i,n,a,s,o){var r=t("<div>");switch(r.addClass(e._getClassName(i.attr("id"))+"formError"),r.addClass("parentForm"+e._getClassName(i.closest("form, .validationEngineContainer").attr("id"))),r.addClass("formError"),a){case"pass":r.addClass("greenPopup");break;case"load":r.addClass("blackPopup")}s&&r.addClass("ajaxed");t("<div>").addClass("formErrorContent").html(n).appendTo(r);var l=i.data("promptPosition")||o.promptPosition;if(o.showArrow){var c=t("<div>").addClass("formErrorArrow");if("string"==typeof l)-1!=(h=l.indexOf(":"))&&(l=l.substring(0,h));switch(l){case"bottomLeft":case"bottomRight":r.find(".formErrorContent").before(c),c.addClass("formErrorArrowBottom").html('<div class="line1">\x3c!-- --\x3e</div><div class="line2">\x3c!-- --\x3e</div><div class="line3">\x3c!-- --\x3e</div><div class="line4">\x3c!-- --\x3e</div><div class="line5">\x3c!-- --\x3e</div><div class="line6">\x3c!-- --\x3e</div><div class="line7">\x3c!-- --\x3e</div><div class="line8">\x3c!-- --\x3e</div><div class="line9">\x3c!-- --\x3e</div><div class="line10">\x3c!-- --\x3e</div>');break;case"topLeft":case"topRight":c.html('<div class="line10">\x3c!-- --\x3e</div><div class="line9">\x3c!-- --\x3e</div><div class="line8">\x3c!-- --\x3e</div><div class="line7">\x3c!-- --\x3e</div><div class="line6">\x3c!-- --\x3e</div><div class="line5">\x3c!-- --\x3e</div><div class="line4">\x3c!-- --\x3e</div><div class="line3">\x3c!-- --\x3e</div><div class="line2">\x3c!-- --\x3e</div><div class="line1">\x3c!-- --\x3e</div>'),r.append(c)}}o.addPromptClass&&r.addClass(o.addPromptClass);var d=i.attr("data-required-class");if(void 0!==d)r.addClass(d);else if(o.prettySelect&&t("#"+i.attr("id")).next().is("select")){var u=t("#"+i.attr("id").substr(o.usePrefix.length).substring(o.useSuffix.length)).attr("data-required-class");void 0!==u&&r.addClass(u)}r.css({opacity:0}),"inline"===l?(r.addClass("inline"),void 0!==i.attr("data-prompt-target")&&t("#"+i.attr("data-prompt-target")).length>0?r.appendTo(t("#"+i.attr("data-prompt-target"))):i.after(r)):i.before(r);var h=e._calculatePosition(i,r,o);return r.css({position:"inline"===l?"relative":"absolute",top:h.callerTopPosition,left:h.callerleftPosition,marginTop:h.marginTopSize,opacity:0}).data("callerField",i),o.autoHidePrompt&&setTimeout((function(){r.animate({opacity:0},(function(){r.closest(".formErrorOuter").remove(),r.remove()}))}),o.autoHideDelay),r.animate({opacity:.87})},_updatePrompt:function(t,i,n,a,s,o,r){if(i){void 0!==a&&("pass"==a?i.addClass("greenPopup"):i.removeClass("greenPopup"),"load"==a?i.addClass("blackPopup"):i.removeClass("blackPopup")),s?i.addClass("ajaxed"):i.removeClass("ajaxed"),i.find(".formErrorContent").html(n);var l=e._calculatePosition(t,i,o),c={top:l.callerTopPosition,left:l.callerleftPosition,marginTop:l.marginTopSize};r?i.css(c):i.animate(c)}},_closePrompt:function(t){var i=e._getPrompt(t);i&&i.fadeTo("fast",0,(function(){i.parent(".formErrorOuter").remove(),i.remove()}))},closePrompt:function(t){return e._closePrompt(t)},_getPrompt:function(i){var n=t(i).closest("form, .validationEngineContainer").attr("id"),a=e._getClassName(i.attr("id"))+"formError",s=t("."+e._escapeExpression(a)+".parentForm"+e._getClassName(n))[0];if(s)return t(s)},_escapeExpression:function(t){return t.replace(/([#;&,\.\+\*\~':"\!\^$\[\]\(\)=>\|])/g,"\\$1")},isRTL:function(e){var i=t(document),n=t("body"),a=e&&e.hasClass("rtl")||e&&"rtl"===(e.attr("dir")||"").toLowerCase()||i.hasClass("rtl")||"rtl"===(i.attr("dir")||"").toLowerCase()||n.hasClass("rtl")||"rtl"===(n.attr("dir")||"").toLowerCase();return Boolean(a)},_calculatePosition:function(t,e,i){var n,a,s,o=t.width(),r=t.position().left,l=t.position().top;t.height();n=a=0,s=-e.height();var c=t.data("promptPosition")||i.promptPosition,d="",u="",h=0,p=0;switch("string"==typeof c&&-1!=c.indexOf(":")&&(d=c.substring(c.indexOf(":")+1),c=c.substring(0,c.indexOf(":")),-1!=d.indexOf(",")&&(u=d.substring(d.indexOf(",")+1),d=d.substring(0,d.indexOf(",")),p=parseInt(u),isNaN(p)&&(p=0)),h=parseInt(d),isNaN(d)&&(d=0)),c){default:case"topRight":a+=r+o-30,n+=l;break;case"topLeft":n+=l,a+=r;break;case"centerRight":n=l+4,s=0,a=r+t.outerWidth(!0)+5;break;case"centerLeft":a=r-(e.width()+2),n=l+4,s=0;break;case"bottomLeft":n=l+t.height()+5,s=0,a=r;break;case"bottomRight":a=r+o-30,n=l+t.height()+5,s=0;break;case"inline":a=0,n=0,s=0}return{callerTopPosition:(n+=p)+"px",callerleftPosition:(a+=h)+"px",marginTopSize:s+"px"}},_saveOptions:function(e,i){if(t.validationEngineLanguage)var n=t.validationEngineLanguage.allRules;else t.error("jQuery.validationEngine rules are not loaded, plz add localization files to the page");t.validationEngine.defaults.allrules=n;var a=t.extend(!0,{},t.validationEngine.defaults,i);return e.data("jqv",a),a},_getClassName:function(t){if(t)return t.replace(/:/g,"_").replace(/\./g,"_")},_jqSelector:function(t){return t.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1")},_condRequired:function(t,i,n,a){var s,o;for(s=n+1;s<i.length;s++)if((o=jQuery("#"+i[s]).first()).length&&null==e._required(o,["required"],0,a,!0))return e._required(t,["required"],0,a)},_submitButtonClick:function(e){var i=t(this);i.closest("form, .validationEngineContainer").data("jqv_submitButton",i.attr("id"))}};t.fn.validationEngine=function(i){var n=t(this);return n[0]?"string"==typeof i&&"_"!=i.charAt(0)&&e[i]?("showPrompt"!=i&&"hide"!=i&&"hideAll"!=i&&e.init.apply(n),e[i].apply(n,Array.prototype.slice.call(arguments,1))):"object"!=typeof i&&i?void t.error("Method "+i+" does not exist in jQuery.validationEngine"):(e.init.apply(n,arguments),e.attach.apply(n)):n},t.validationEngine={fieldIdCounter:0,defaults:{validationEventTrigger:"blur",scroll:!0,focusFirstField:!0,showPrompts:!0,validateNonVisibleFields:!1,promptPosition:"topRight",bindMethod:"bind",inlineAjax:!1,ajaxFormValidation:!1,ajaxFormValidationURL:!1,ajaxFormValidationMethod:"get",onAjaxFormComplete:t.noop,onBeforeAjaxFormValidation:t.noop,onValidationComplete:!1,doNotShowAllErrosOnSubmit:!1,custom_error_messages:{},binded:!0,showArrow:!0,isError:!1,maxErrorsPerField:!1,ajaxValidCache:{},autoPositionUpdate:!1,InvalidFields:[],onFieldSuccess:!1,onFieldFailure:!1,onSuccess:!1,onFailure:!1,validateAttribute:"class",addSuccessCssClassToField:"",addFailureCssClassToField:"",autoHidePrompt:!1,autoHideDelay:1e4,fadeDuration:.3,prettySelect:!1,addPromptClass:"",usePrefix:"",useSuffix:"",showOneMessage:!1}};var i={hook:"rightmiddle",hideOn:!1,skin:"cloud",hideOthers:!1};e._buildPrompt=function(t,e,n,a,s){t.data("promptText",e),Tipped.create(t[0],e,i),Tipped.show(t[0])},e._closePrompt=function(t){t.data("promptText",""),Tipped.remove(t[0])},e._updatePrompt=function(t,i,n,a,s,o,r){t.data("promptText")!=n&&(e._closePrompt(t),e._buildPrompt(t,n))},e._getPrompt=function(t){return Tipped.get(t[0])},t((function(){t.validationEngine.defaults.promptPosition=e.isRTL()?"topLeft":"topRight"}))}(jQuery),function(t){t.fn.wipetouch=function(e){var i={moveX:40,moveY:40,tapToClick:!1,preventDefault:!0,allowDiagonal:!1,preventDefaultWhenTriggering:!0,wipeLeft:!1,wipeRight:!1,wipeUp:!1,wipeDown:!1,wipeUpLeft:!1,wipeDownLeft:!1,wipeUpRight:!1,wipeDownRight:!1,wipeMove:!1,wipeTopLeft:!1,wipeBottomLeft:!1,wipeTopRight:!1,wipeBottomRight:!1};return e&&t.extend(i,e),this.each((function(){var e,n,a,s,o=!1,r=!1,l=!1,c=!1,d=!1;function u(d){f();var u=c||d.originalEvent.touches&&d.originalEvent.touches.length>0;!r&&u&&(i.preventDefault&&d.preventDefault(),i.allowDiagonal&&(i.wipeDownLeft||(i.wipeDownLeft=i.wipeBottomLeft),i.wipeDownRight||(i.wipeDownRight=i.wipeBottomRight),i.wipeUpLeft||(i.wipeUpLeft=i.wipeTopLeft),i.wipeUpRight||(i.wipeUpRight=i.wipeTopRight)),c?(e=d.pageX,n=d.pageY,t(this).bind("mousemove",p),t(this).one("mouseup",h)):(e=d.originalEvent.touches[0].pageX,n=d.originalEvent.touches[0].pageY,t(this).bind("touchmove",p)),o=(new Date).getTime(),a=e,s=n,r=!0,l=t(d.target))}function h(u){i.preventDefault&&u.preventDefault(),c?t(this).unbind("mousemove",p):t(this).unbind("touchmove",p),r?function(r){var u=(new Date).getTime(),h=o-u,p=a-e,g=s-n,v=Math.abs(p),b=Math.abs(g);if(v<15&&b<15&&h<100){if(d=!1,i.preventDefault)return f(),void l.trigger("click")}else if(c){var y=l.data("events");if(y){var _=y.click;_&&_.length>0&&(t.each(_,(function(t,e){d=e})),l.unbind("click"))}}var x=p>0,w=g>0,C=60*(v+b)/(h/6*h);C<1&&(C=1);C>5&&(C=5);var k={speed:parseInt(C),x:v,y:b,source:l};v>=i.moveX?i.allowDiagonal&&b>=i.moveY?m(x&&w?i.wipeDownRight:x&&!w?i.wipeUpRight:!x&&w?i.wipeDownLeft:i.wipeUpLeft,k,r):v>=b&&m(x?i.wipeRight:i.wipeLeft,k,r):b>=i.moveY&&b>v&&m(w?i.wipeDown:i.wipeUp,k,r);f()}(u):f()}function p(t){i.preventDefault&&t.preventDefault(),c&&!r&&u(t),r&&(c?(a=t.pageX,s=t.pageY):(a=t.originalEvent.touches[0].pageX,s=t.originalEvent.touches[0].pageY),i.wipeMove&&m(i.wipeMove,{curX:a,curY:s}))}function f(){e=!1,n=!1,o=!1,r=!1,d&&window.setTimeout((function(){l.bind("click",d),d=!1}),50)}function m(t,e,n){t&&(i.preventDefaultWhenTriggering&&n.preventDefault(),t(e))}"ontouchstart"in document.documentElement?(t(this).bind("touchstart",u),t(this).bind("touchend",h)):(c=!0,t(this).bind("mousedown",u),t(this).bind("mouseout mouseup",h))})),this}}(jQuery),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"undefined"!=typeof module&&module.exports?module.exports=t:t(jQuery,window,document)}((function(t){!function(e){var i="function"==typeof define&&define.amd,n="undefined"!=typeof module&&module.exports,a="https:"==document.location.protocol?"https:":"http:";i||(n?require("jquery-mousewheel")(t):t.event.special.mousewheel||t("head").append(decodeURI("%3Cscript src="+a+"//cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.13/jquery.mousewheel.min.js%3E%3C/script%3E"))),function(){var e,i="mCustomScrollbar",n="mCS",a=".mCustomScrollbar",s={setTop:0,setLeft:0,axis:"y",scrollbarPosition:"inside",scrollInertia:950,autoDraggerLength:!0,alwaysShowScrollbar:0,snapOffset:0,mouseWheel:{enable:!0,scrollAmount:"auto",axis:"y",deltaFactor:"auto",disableOver:["select","option","keygen","datalist","textarea"]},scrollButtons:{scrollType:"stepless",scrollAmount:"auto"},keyboard:{enable:!0,scrollType:"stepless",scrollAmount:"auto"},contentTouchScroll:25,documentTouchScroll:!0,advanced:{autoScrollOnFocus:"input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']",updateOnContentResize:!0,updateOnImageLoad:"auto",autoUpdateTimeout:60},theme:"light",callbacks:{onTotalScrollOffset:0,onTotalScrollBackOffset:0,alwaysTriggerOffsets:!0}},o=0,r={},l=window.attachEvent&&!window.addEventListener?1:0,c=!1,d=["mCSB_dragger_onDrag","mCSB_scrollTools_onDrag","mCS_img_loaded","mCS_disabled","mCS_destroyed","mCS_no_scrollbar","mCS-autoHide","mCS-dir-rtl","mCS_no_scrollbar_y","mCS_no_scrollbar_x","mCS_y_hidden","mCS_x_hidden","mCSB_draggerContainer","mCSB_buttonUp","mCSB_buttonDown","mCSB_buttonLeft","mCSB_buttonRight"],u={init:function(e){e=t.extend(!0,{},s,e);var i=h.call(this);if(e.live){var l=e.liveSelector||this.selector||a,c=t(l);if("off"===e.live)return void f(l);r[l]=setTimeout((function(){c.mCustomScrollbar(e),"once"===e.live&&c.length&&f(l)}),500)}else f(l);return e.setWidth=e.set_width?e.set_width:e.setWidth,e.setHeight=e.set_height?e.set_height:e.setHeight,e.axis=e.horizontalScroll?"x":m(e.axis),e.scrollInertia=e.scrollInertia>0&&e.scrollInertia<17?17:e.scrollInertia,"object"!=typeof e.mouseWheel&&1==e.mouseWheel&&(e.mouseWheel={enable:!0,scrollAmount:"auto",axis:"y",preventDefault:!1,deltaFactor:"auto",normalizeDelta:!1,invert:!1}),e.mouseWheel.scrollAmount=e.mouseWheelPixels?e.mouseWheelPixels:e.mouseWheel.scrollAmount,e.mouseWheel.normalizeDelta=e.advanced.normalizeMouseWheelDelta?e.advanced.normalizeMouseWheelDelta:e.mouseWheel.normalizeDelta,e.scrollButtons.scrollType=g(e.scrollButtons.scrollType),p(e),t(i).each((function(){var i=t(this);if(!i.data(n)){i.data(n,{idx:++o,opt:e,scrollRatio:{y:null,x:null},overflowed:null,contentReset:{y:null,x:null},bindEvents:!1,tweenRunning:!1,sequential:{},langDir:i.css("direction"),cbOffsets:null,trigger:null,poll:{size:{o:0,n:0},img:{o:0,n:0},change:{o:0,n:0}}});var a=i.data(n),s=a.opt,r=i.data("mcs-axis"),l=i.data("mcs-scrollbar-position"),c=i.data("mcs-theme");r&&(s.axis=r),l&&(s.scrollbarPosition=l),c&&(s.theme=c,p(s)),v.call(this),a&&s.callbacks.onCreate&&"function"==typeof s.callbacks.onCreate&&s.callbacks.onCreate.call(this),t("#mCSB_"+a.idx+"_container img:not(."+d[2]+")").addClass(d[2]),u.update.call(null,i)}}))},update:function(e,i){var a=e||h.call(this);return t(a).each((function(){var e=t(this);if(e.data(n)){var a=e.data(n),s=a.opt,o=t("#mCSB_"+a.idx+"_container"),r=t("#mCSB_"+a.idx),l=[t("#mCSB_"+a.idx+"_dragger_vertical"),t("#mCSB_"+a.idx+"_dragger_horizontal")];if(!o.length)return;a.tweenRunning&&G(e),i&&a&&s.callbacks.onBeforeUpdate&&"function"==typeof s.callbacks.onBeforeUpdate&&s.callbacks.onBeforeUpdate.call(this),e.hasClass(d[3])&&e.removeClass(d[3]),e.hasClass(d[4])&&e.removeClass(d[4]),r.css("max-height","none"),r.height()!==e.height()&&r.css("max-height",e.height()),y.call(this),"y"===s.axis||s.advanced.autoExpandHorizontalScroll||o.css("width",b(o)),a.overflowed=k.call(this),I.call(this),s.autoDraggerLength&&x.call(this),w.call(this),S.call(this);var c=[Math.abs(o[0].offsetTop),Math.abs(o[0].offsetLeft)];"x"!==s.axis&&(a.overflowed[0]?l[0].height()>l[0].parent().height()?$.call(this):(K(e,c[0].toString(),{dir:"y",dur:0,overwrite:"none"}),a.contentReset.y=null):($.call(this),"y"===s.axis?T.call(this):"yx"===s.axis&&a.overflowed[1]&&K(e,c[1].toString(),{dir:"x",dur:0,overwrite:"none"}))),"y"!==s.axis&&(a.overflowed[1]?l[1].width()>l[1].parent().width()?$.call(this):(K(e,c[1].toString(),{dir:"x",dur:0,overwrite:"none"}),a.contentReset.x=null):($.call(this),"x"===s.axis?T.call(this):"yx"===s.axis&&a.overflowed[0]&&K(e,c[0].toString(),{dir:"y",dur:0,overwrite:"none"}))),i&&a&&(2===i&&s.callbacks.onImageLoad&&"function"==typeof s.callbacks.onImageLoad?s.callbacks.onImageLoad.call(this):3===i&&s.callbacks.onSelectorChange&&"function"==typeof s.callbacks.onSelectorChange?s.callbacks.onSelectorChange.call(this):s.callbacks.onUpdate&&"function"==typeof s.callbacks.onUpdate&&s.callbacks.onUpdate.call(this)),Y.call(this)}}))},scrollTo:function(e,i){if(void 0!==e&&null!=e){var a=h.call(this);return t(a).each((function(){var a=t(this);if(a.data(n)){var s=a.data(n),o=s.opt,r={trigger:"external",scrollInertia:o.scrollInertia,scrollEasing:"mcsEaseInOut",moveDragger:!1,timeout:60,callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},l=t.extend(!0,{},r,i),c=U.call(this,e),d=l.scrollInertia>0&&l.scrollInertia<17?17:l.scrollInertia;c[0]=q.call(this,c[0],"y"),c[1]=q.call(this,c[1],"x"),l.moveDragger&&(c[0]*=s.scrollRatio.y,c[1]*=s.scrollRatio.x),l.dur=at()?0:d,setTimeout((function(){null!==c[0]&&void 0!==c[0]&&"x"!==o.axis&&s.overflowed[0]&&(l.dir="y",l.overwrite="all",K(a,c[0].toString(),l)),null!==c[1]&&void 0!==c[1]&&"y"!==o.axis&&s.overflowed[1]&&(l.dir="x",l.overwrite="none",K(a,c[1].toString(),l))}),l.timeout)}}))}},stop:function(){var e=h.call(this);return t(e).each((function(){var e=t(this);e.data(n)&&G(e)}))},disable:function(e){var i=h.call(this);return t(i).each((function(){var i=t(this);i.data(n)&&(i.data(n),Y.call(this,"remove"),T.call(this),e&&$.call(this),I.call(this,!0),i.addClass(d[3]))}))},destroy:function(){var e=h.call(this);return t(e).each((function(){var a=t(this);if(a.data(n)){var s=a.data(n),o=s.opt,r=t("#mCSB_"+s.idx),l=t("#mCSB_"+s.idx+"_container"),c=t(".mCSB_"+s.idx+"_scrollbar");o.live&&f(o.liveSelector||t(e).selector),Y.call(this,"remove"),T.call(this),$.call(this),a.removeData(n),Z(this,"mcs"),c.remove(),l.find("img."+d[2]).removeClass(d[2]),r.replaceWith(l.contents()),a.removeClass(i+" _"+n+"_"+s.idx+" "+d[6]+" "+d[7]+" "+d[5]+" "+d[3]).addClass(d[4])}}))}},h=function(){return"object"!=typeof t(this)||t(this).length<1?a:this},p=function(e){var i=["rounded","rounded-dark","rounded-dots","rounded-dots-dark"],n=["rounded-dots","rounded-dots-dark","3d","3d-dark","3d-thick","3d-thick-dark","inset","inset-dark","inset-2","inset-2-dark","inset-3","inset-3-dark"],a=["minimal","minimal-dark"],s=["minimal","minimal-dark"],o=["minimal","minimal-dark"];e.autoDraggerLength=!(t.inArray(e.theme,i)>-1)&&e.autoDraggerLength,e.autoExpandScrollbar=!(t.inArray(e.theme,n)>-1)&&e.autoExpandScrollbar,e.scrollButtons.enable=!(t.inArray(e.theme,a)>-1)&&e.scrollButtons.enable,e.autoHideScrollbar=t.inArray(e.theme,s)>-1||e.autoHideScrollbar,e.scrollbarPosition=t.inArray(e.theme,o)>-1?"outside":e.scrollbarPosition},f=function(t){r[t]&&(clearTimeout(r[t]),Z(r,t))},m=function(t){return"yx"===t||"xy"===t||"auto"===t?"yx":"x"===t||"horizontal"===t?"x":"y"},g=function(t){return"stepped"===t||"pixels"===t||"step"===t||"click"===t?"stepped":"stepless"},v=function(){var e=t(this),a=e.data(n),s=a.opt,o=s.autoExpandScrollbar?" "+d[1]+"_expand":"",r=["<div id='mCSB_"+a.idx+"_scrollbar_vertical' class='mCSB_scrollTools mCSB_"+a.idx+"_scrollbar mCS-"+s.theme+" mCSB_scrollTools_vertical"+o+"'><div class='"+d[12]+"'><div id='mCSB_"+a.idx+"_dragger_vertical' class='mCSB_dragger' style='position:absolute;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>","<div id='mCSB_"+a.idx+"_scrollbar_horizontal' class='mCSB_scrollTools mCSB_"+a.idx+"_scrollbar mCS-"+s.theme+" mCSB_scrollTools_horizontal"+o+"'><div class='"+d[12]+"'><div id='mCSB_"+a.idx+"_dragger_horizontal' class='mCSB_dragger' style='position:absolute;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>"],l="yx"===s.axis?"mCSB_vertical_horizontal":"x"===s.axis?"mCSB_horizontal":"mCSB_vertical",c="yx"===s.axis?r[0]+r[1]:"x"===s.axis?r[1]:r[0],u="yx"===s.axis?"<div id='mCSB_"+a.idx+"_container_wrapper' class='mCSB_container_wrapper' />":"",h=s.autoHideScrollbar?" "+d[6]:"",p="x"!==s.axis&&"rtl"===a.langDir?" "+d[7]:"";s.setWidth&&e.css("width",s.setWidth),s.setHeight&&e.css("height",s.setHeight),s.setLeft="y"!==s.axis&&"rtl"===a.langDir?"989999px":s.setLeft,e.addClass(i+" _"+n+"_"+a.idx+h+p).wrapInner("<div id='mCSB_"+a.idx+"' class='mCustomScrollBox mCS-"+s.theme+" "+l+"'><div id='mCSB_"+a.idx+"_container' class='mCSB_container' style='position:relative; top:"+s.setTop+"; left:"+s.setLeft+";' dir='"+a.langDir+"' /></div>");var f=t("#mCSB_"+a.idx),m=t("#mCSB_"+a.idx+"_container");"y"===s.axis||s.advanced.autoExpandHorizontalScroll||m.css("width",b(m)),"outside"===s.scrollbarPosition?("static"===e.css("position")&&e.css("position","relative"),e.css("overflow","visible"),f.addClass("mCSB_outside").after(c)):(f.addClass("mCSB_inside").append(c),m.wrap(u)),_.call(this);var g=[t("#mCSB_"+a.idx+"_dragger_vertical"),t("#mCSB_"+a.idx+"_dragger_horizontal")];g[0].css("min-height",g[0].height()),g[1].css("min-width",g[1].width())},b=function(e){var i=[e[0].scrollWidth,Math.max.apply(Math,e.children().map((function(){return t(this).outerWidth(!0)})).get())],n=e.parent().width();return i[0]>n?i[0]:i[1]>n?i[1]:"100%"},y=function(){var e=t(this).data(n),i=e.opt,a=t("#mCSB_"+e.idx+"_container");if(i.advanced.autoExpandHorizontalScroll&&"y"!==i.axis){a.css({width:"auto","min-width":0,"overflow-x":"scroll"});var s=Math.ceil(a[0].scrollWidth);3===i.advanced.autoExpandHorizontalScroll||2!==i.advanced.autoExpandHorizontalScroll&&s>a.parent().width()?a.css({width:s,"min-width":"100%","overflow-x":"inherit"}):a.css({"overflow-x":"inherit",position:"absolute"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:Math.ceil(a[0].getBoundingClientRect().right+.4)-Math.floor(a[0].getBoundingClientRect().left),"min-width":"100%",position:"relative"}).unwrap()}},_=function(){var e=t(this).data(n),i=e.opt,a=t(".mCSB_"+e.idx+"_scrollbar:first"),s=it(i.scrollButtons.tabindex)?"tabindex='"+i.scrollButtons.tabindex+"'":"",o=["<a href='#' class='"+d[13]+"' "+s+" />","<a href='#' class='"+d[14]+"' "+s+" />","<a href='#' class='"+d[15]+"' "+s+" />","<a href='#' class='"+d[16]+"' "+s+" />"],r=["x"===i.axis?o[2]:o[0],"x"===i.axis?o[3]:o[1],o[2],o[3]];i.scrollButtons.enable&&a.prepend(r[0]).append(r[1]).next(".mCSB_scrollTools").prepend(r[2]).append(r[3])},x=function(){var e=t(this).data(n),i=t("#mCSB_"+e.idx),a=t("#mCSB_"+e.idx+"_container"),s=[t("#mCSB_"+e.idx+"_dragger_vertical"),t("#mCSB_"+e.idx+"_dragger_horizontal")],o=[i.height()/a.outerHeight(!1),i.width()/a.outerWidth(!1)],r=[parseInt(s[0].css("min-height")),Math.round(o[0]*s[0].parent().height()),parseInt(s[1].css("min-width")),Math.round(o[1]*s[1].parent().width())],c=l&&r[1]<r[0]?r[0]:r[1],d=l&&r[3]<r[2]?r[2]:r[3];s[0].css({height:c,"max-height":s[0].parent().height()-10}).find(".mCSB_dragger_bar").css({"line-height":r[0]+"px"}),s[1].css({width:d,"max-width":s[1].parent().width()-10})},w=function(){var e=t(this).data(n),i=t("#mCSB_"+e.idx),a=t("#mCSB_"+e.idx+"_container"),s=[t("#mCSB_"+e.idx+"_dragger_vertical"),t("#mCSB_"+e.idx+"_dragger_horizontal")],o=[a.outerHeight(!1)-i.height(),a.outerWidth(!1)-i.width()],r=[o[0]/(s[0].parent().height()-s[0].height()),o[1]/(s[1].parent().width()-s[1].width())];e.scrollRatio={y:r[0],x:r[1]}},C=function(t,e,i){var n=i?d[0]+"_expanded":"",a=t.closest(".mCSB_scrollTools");"active"===e?(t.toggleClass(d[0]+" "+n),a.toggleClass(d[1]),t[0]._draggable=t[0]._draggable?0:1):t[0]._draggable||("hide"===e?(t.removeClass(d[0]),a.removeClass(d[1])):(t.addClass(d[0]),a.addClass(d[1])))},k=function(){var e=t(this).data(n),i=t("#mCSB_"+e.idx),a=t("#mCSB_"+e.idx+"_container"),s=null==e.overflowed?a.height():a.outerHeight(!1),o=null==e.overflowed?a.width():a.outerWidth(!1),r=a[0].scrollHeight,l=a[0].scrollWidth;return r>s&&(s=r),l>o&&(o=l),[s>i.height(),o>i.width()]},$=function(){var e=t(this),i=e.data(n),a=i.opt,s=t("#mCSB_"+i.idx),o=t("#mCSB_"+i.idx+"_container"),r=[t("#mCSB_"+i.idx+"_dragger_vertical"),t("#mCSB_"+i.idx+"_dragger_horizontal")];if(G(e),("x"!==a.axis&&!i.overflowed[0]||"y"===a.axis&&i.overflowed[0])&&(r[0].add(o).css("top",0),K(e,"_resetY")),"y"!==a.axis&&!i.overflowed[1]||"x"===a.axis&&i.overflowed[1]){var l=dx=0;"rtl"===i.langDir&&(l=s.width()-o.outerWidth(!1),dx=Math.abs(l/i.scrollRatio.x)),o.css("left",l),r[1].css("left",dx),K(e,"_resetX")}},S=function(){function e(){o=setTimeout((function(){t.event.special.mousewheel?(clearTimeout(o),E.call(i[0])):e()}),100)}var i=t(this),a=i.data(n),s=a.opt;if(!a.bindEvents){var o;if(A.call(this),s.contentTouchScroll&&P.call(this),O.call(this),s.mouseWheel.enable)e();N.call(this),F.call(this),s.advanced.autoScrollOnFocus&&B.call(this),s.scrollButtons.enable&&H.call(this),s.keyboard.enable&&z.call(this),a.bindEvents=!0}},T=function(){var e=t(this),i=e.data(n),a=i.opt,s=n+"_"+i.idx,o=".mCSB_"+i.idx+"_scrollbar",r=t("#mCSB_"+i.idx+",#mCSB_"+i.idx+"_container,#mCSB_"+i.idx+"_container_wrapper,"+o+" ."+d[12]+",#mCSB_"+i.idx+"_dragger_vertical,#mCSB_"+i.idx+"_dragger_horizontal,"+o+">a"),l=t("#mCSB_"+i.idx+"_container");a.advanced.releaseDraggableSelectors&&r.add(t(a.advanced.releaseDraggableSelectors)),a.advanced.extraDraggableSelectors&&r.add(t(a.advanced.extraDraggableSelectors)),i.bindEvents&&(t(document).add(t(!L()||top.document)).unbind("."+s),r.each((function(){t(this).unbind("."+s)})),clearTimeout(e[0]._focusTimeout),Z(e[0],"_focusTimeout"),clearTimeout(i.sequential.step),Z(i.sequential,"step"),clearTimeout(l[0].onCompleteTimeout),Z(l[0],"onCompleteTimeout"),i.bindEvents=!1)},I=function(e){var i=t(this),a=i.data(n),s=a.opt,o=t("#mCSB_"+a.idx+"_container_wrapper"),r=o.length?o:t("#mCSB_"+a.idx+"_container"),l=[t("#mCSB_"+a.idx+"_scrollbar_vertical"),t("#mCSB_"+a.idx+"_scrollbar_horizontal")],c=[l[0].find(".mCSB_dragger"),l[1].find(".mCSB_dragger")];"x"!==s.axis&&(a.overflowed[0]&&!e?(l[0].add(c[0]).add(l[0].children("a")).css("display","block"),r.removeClass(d[8]+" "+d[10])):(s.alwaysShowScrollbar?(2!==s.alwaysShowScrollbar&&c[0].css("display","none"),r.removeClass(d[10])):(l[0].css("display","none"),r.addClass(d[10])),r.addClass(d[8]))),"y"!==s.axis&&(a.overflowed[1]&&!e?(l[1].add(c[1]).add(l[1].children("a")).css("display","block"),r.removeClass(d[9]+" "+d[11])):(s.alwaysShowScrollbar?(2!==s.alwaysShowScrollbar&&c[1].css("display","none"),r.removeClass(d[11])):(l[1].css("display","none"),r.addClass(d[11])),r.addClass(d[9]))),a.overflowed[0]||a.overflowed[1]?i.removeClass(d[5]):i.addClass(d[5])},D=function(e){var i=e.type,n=e.target.ownerDocument!==document&&null!==frameElement?[t(frameElement).offset().top,t(frameElement).offset().left]:null,a=L()&&e.target.ownerDocument!==top.document&&null!==frameElement?[t(e.view.frameElement).offset().top,t(e.view.frameElement).offset().left]:[0,0];switch(i){case"pointerdown":case"MSPointerDown":case"pointermove":case"MSPointerMove":case"pointerup":case"MSPointerUp":return n?[e.originalEvent.pageY-n[0]+a[0],e.originalEvent.pageX-n[1]+a[1],!1]:[e.originalEvent.pageY,e.originalEvent.pageX,!1];case"touchstart":case"touchmove":case"touchend":var s=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],o=e.originalEvent.touches.length||e.originalEvent.changedTouches.length;return e.target.ownerDocument!==document?[s.screenY,s.screenX,o>1]:[s.pageY,s.pageX,o>1];default:return n?[e.pageY-n[0]+a[0],e.pageX-n[1]+a[1],!1]:[e.pageY,e.pageX,!1]}},A=function(){function e(t,e,n,a){if(p[0].idleTimer=d.scrollInertia<233?250:0,i.attr("id")===h[1])var s="x",l=(i[0].offsetLeft-e+a)*r.scrollRatio.x;else s="y",l=(i[0].offsetTop-t+n)*r.scrollRatio.y;K(o,l.toString(),{dir:s,drag:!0})}var i,a,s,o=t(this),r=o.data(n),d=r.opt,u=n+"_"+r.idx,h=["mCSB_"+r.idx+"_dragger_vertical","mCSB_"+r.idx+"_dragger_horizontal"],p=t("#mCSB_"+r.idx+"_container"),f=t("#"+h[0]+",#"+h[1]),m=d.advanced.releaseDraggableSelectors?f.add(t(d.advanced.releaseDraggableSelectors)):f,g=d.advanced.extraDraggableSelectors?t(!L()||top.document).add(t(d.advanced.extraDraggableSelectors)):t(!L()||top.document);f.bind("contextmenu."+u,(function(t){t.preventDefault()})).bind("mousedown."+u+" touchstart."+u+" pointerdown."+u+" MSPointerDown."+u,(function(e){if(e.stopImmediatePropagation(),e.preventDefault(),tt(e)){c=!0,l&&(document.onselectstart=function(){return!1}),j.call(p,!1),G(o);var n=(i=t(this)).offset(),r=D(e)[0]-n.top,u=D(e)[1]-n.left,h=i.height()+n.top,f=i.width()+n.left;h>r&&r>0&&f>u&&u>0&&(a=r,s=u),C(i,"active",d.autoExpandScrollbar)}})).bind("touchmove."+u,(function(t){t.stopImmediatePropagation(),t.preventDefault();var n=i.offset(),o=D(t)[0]-n.top,r=D(t)[1]-n.left;e(a,s,o,r)})),t(document).add(g).bind("mousemove."+u+" pointermove."+u+" MSPointerMove."+u,(function(t){if(i){var n=i.offset(),o=D(t)[0]-n.top,r=D(t)[1]-n.left;if(a===o&&s===r)return;e(a,s,o,r)}})).add(m).bind("mouseup."+u+" touchend."+u+" pointerup."+u+" MSPointerUp."+u,(function(){i&&(C(i,"active",d.autoExpandScrollbar),i=null),c=!1,l&&(document.onselectstart=null),j.call(p,!0)}))},P=function(){function i(t){if(!et(t)||c||D(t)[2])e=0;else{e=1,w=0,C=0,d=1,k.removeClass("mCS_touch_action");var i=A.offset();u=D(t)[0]-i.top,h=D(t)[1]-i.left,R=[D(t)[0],D(t)[1]]}}function a(t){if(et(t)&&!c&&!D(t)[2]&&(S.documentTouchScroll||t.preventDefault(),t.stopImmediatePropagation(),(!C||w)&&d)){g=Q();var e=I.offset(),i=D(t)[0]-e.top,n=D(t)[1]-e.left,a="mcsLinearOut";if(O.push(i),E.push(n),R[2]=Math.abs(D(t)[0]-R[0]),R[3]=Math.abs(D(t)[1]-R[1]),$.overflowed[0])var s=P[0].parent().height()-P[0].height(),o=u-i>0&&i-u>-s*$.scrollRatio.y&&(2*R[3]<R[2]||"yx"===S.axis);if($.overflowed[1])var r=P[1].parent().width()-P[1].width(),p=h-n>0&&n-h>-r*$.scrollRatio.x&&(2*R[2]<R[3]||"yx"===S.axis);o||p?(F||t.preventDefault(),w=1):(C=1,k.addClass("mCS_touch_action")),F&&t.preventDefault(),_="yx"===S.axis?[u-i,h-n]:"x"===S.axis?[null,h-n]:[u-i,null],A[0].idleTimer=250,$.overflowed[0]&&l(_[0],M,a,"y","all",!0),$.overflowed[1]&&l(_[1],M,a,"x",j,!0)}}function s(t){if(!et(t)||c||D(t)[2])e=0;else{e=1,t.stopImmediatePropagation(),G(k),m=Q();var i=I.offset();p=D(t)[0]-i.top,f=D(t)[1]-i.left,O=[],E=[]}}function o(t){if(et(t)&&!c&&!D(t)[2]){d=0,t.stopImmediatePropagation(),w=0,C=0,v=Q();var e=I.offset(),i=D(t)[0]-e.top,n=D(t)[1]-e.left;if(!(v-g>30)){var a="mcsEaseOut",s=2.5>(y=1e3/(v-m)),o=s?[O[O.length-2],E[E.length-2]]:[0,0];b=s?[i-o[0],n-o[1]]:[i-p,n-f];var u=[Math.abs(b[0]),Math.abs(b[1])];y=s?[Math.abs(b[0]/4),Math.abs(b[1]/4)]:[y,y];var h=[Math.abs(A[0].offsetTop)-b[0]*r(u[0]/y[0],y[0]),Math.abs(A[0].offsetLeft)-b[1]*r(u[1]/y[1],y[1])];_="yx"===S.axis?[h[0],h[1]]:"x"===S.axis?[null,h[1]]:[h[0],null],x=[4*u[0]+S.scrollInertia,4*u[1]+S.scrollInertia];var k=parseInt(S.contentTouchScroll)||0;_[0]=u[0]>k?_[0]:0,_[1]=u[1]>k?_[1]:0,$.overflowed[0]&&l(_[0],x[0],a,"y",j,!1),$.overflowed[1]&&l(_[1],x[1],a,"x",j,!1)}}}function r(t,e){var i=[1.5*e,2*e,e/1.5,e/2];return t>90?e>4?i[0]:i[3]:t>60?e>3?i[3]:i[2]:t>30?e>8?i[1]:e>6?i[0]:e>4?e:i[2]:e>8?e:i[3]}function l(t,e,i,n,a,s){t&&K(k,t.toString(),{dur:e,scrollEasing:i,dir:n,overwrite:a,drag:s})}var d,u,h,p,f,m,g,v,b,y,_,x,w,C,k=t(this),$=k.data(n),S=$.opt,T=n+"_"+$.idx,I=t("#mCSB_"+$.idx),A=t("#mCSB_"+$.idx+"_container"),P=[t("#mCSB_"+$.idx+"_dragger_vertical"),t("#mCSB_"+$.idx+"_dragger_horizontal")],O=[],E=[],M=0,j="yx"===S.axis?"none":"all",R=[],N=A.find("iframe"),B=["touchstart."+T+" pointerdown."+T+" MSPointerDown."+T,"touchmove."+T+" pointermove."+T+" MSPointerMove."+T,"touchend."+T+" pointerup."+T+" MSPointerUp."+T],F=void 0!==document.body.style.touchAction&&""!==document.body.style.touchAction;A.bind(B[0],(function(t){i(t)})).bind(B[1],(function(t){a(t)})),I.bind(B[0],(function(t){s(t)})).bind(B[2],(function(t){o(t)})),N.length&&N.each((function(){t(this).bind("load",(function(){L(this)&&t(this.contentDocument||this.contentWindow.document).bind(B[0],(function(t){i(t),s(t)})).bind(B[1],(function(t){a(t)})).bind(B[2],(function(t){o(t)}))}))}))},O=function(){function i(){return window.getSelection?window.getSelection().toString():document.selection&&"Control"!=document.selection.type?document.selection.createRange().text:0}function a(t,e,i){d.type=i&&s?"stepped":"stepless",d.scrollAmount=10,W(o,t,e,"mcsLinearOut",i?60:null)}var s,o=t(this),r=o.data(n),l=r.opt,d=r.sequential,u=n+"_"+r.idx,h=t("#mCSB_"+r.idx+"_container"),p=h.parent();h.bind("mousedown."+u,(function(){e||s||(s=1,c=!0)})).add(document).bind("mousemove."+u,(function(t){if(!e&&s&&i()){var n=h.offset(),o=D(t)[0]-n.top+h[0].offsetTop,c=D(t)[1]-n.left+h[0].offsetLeft;o>0&&o<p.height()&&c>0&&c<p.width()?d.step&&a("off",null,"stepped"):("x"!==l.axis&&r.overflowed[0]&&(0>o?a("on",38):o>p.height()&&a("on",40)),"y"!==l.axis&&r.overflowed[1]&&(0>c?a("on",37):c>p.width()&&a("on",39)))}})).bind("mouseup."+u+" dragend."+u,(function(){e||(s&&(s=0,a("off",null)),c=!1)}))},E=function(){function e(e,n){if(G(i),!R(i,e.target)){var o="auto"!==s.mouseWheel.deltaFactor?parseInt(s.mouseWheel.deltaFactor):l&&e.deltaFactor<100?100:e.deltaFactor||100,d=s.scrollInertia;if("x"===s.axis||"x"===s.mouseWheel.axis)var u="x",h=[Math.round(o*a.scrollRatio.x),parseInt(s.mouseWheel.scrollAmount)],p="auto"!==s.mouseWheel.scrollAmount?h[1]:h[0]>=r.width()?.9*r.width():h[0],f=Math.abs(t("#mCSB_"+a.idx+"_container")[0].offsetLeft),m=c[1][0].offsetLeft,g=c[1].parent().width()-c[1].width(),v="y"===s.mouseWheel.axis?e.deltaY||n:e.deltaX;else u="y",h=[Math.round(o*a.scrollRatio.y),parseInt(s.mouseWheel.scrollAmount)],p="auto"!==s.mouseWheel.scrollAmount?h[1]:h[0]>=r.height()?.9*r.height():h[0],f=Math.abs(t("#mCSB_"+a.idx+"_container")[0].offsetTop),m=c[0][0].offsetTop,g=c[0].parent().height()-c[0].height(),v=e.deltaY||n;"y"===u&&!a.overflowed[0]||"x"===u&&!a.overflowed[1]||((s.mouseWheel.invert||e.webkitDirectionInvertedFromDevice)&&(v=-v),s.mouseWheel.normalizeDelta&&(v=0>v?-1:1),(v>0&&0!==m||0>v&&m!==g||s.mouseWheel.preventDefault)&&(e.stopImmediatePropagation(),e.preventDefault()),e.deltaFactor<5&&!s.mouseWheel.normalizeDelta&&(p=e.deltaFactor,d=17),K(i,(f-v*p).toString(),{dir:u,dur:d}))}}if(t(this).data(n)){var i=t(this),a=i.data(n),s=a.opt,o=n+"_"+a.idx,r=t("#mCSB_"+a.idx),c=[t("#mCSB_"+a.idx+"_dragger_vertical"),t("#mCSB_"+a.idx+"_dragger_horizontal")],d=t("#mCSB_"+a.idx+"_container").find("iframe");d.length&&d.each((function(){t(this).bind("load",(function(){L(this)&&t(this.contentDocument||this.contentWindow.document).bind("mousewheel."+o,(function(t,i){e(t,i)}))}))})),r.bind("mousewheel."+o,(function(t,i){e(t,i)}))}},M=new Object,L=function(e){var i=!1,n=!1,a=null;if(void 0===e?n="#empty":void 0!==t(e).attr("id")&&(n=t(e).attr("id")),!1!==n&&void 0!==M[n])return M[n];if(e){try{a=(e.contentDocument||e.contentWindow.document).body.innerHTML}catch(t){}i=null!==a}else{try{a=top.document.body.innerHTML}catch(t){}i=null!==a}return!1!==n&&(M[n]=i),i},j=function(t){var e=this.find("iframe");if(e.length){var i=t?"auto":"none";e.css("pointer-events",i)}},R=function(e,i){var a=i.nodeName.toLowerCase(),s=e.data(n).opt.mouseWheel.disableOver,o=["select","textarea"];return t.inArray(a,s)>-1&&!(t.inArray(a,o)>-1&&!t(i).is(":focus"))},N=function(){var e,i=t(this),a=i.data(n),s=n+"_"+a.idx,o=t("#mCSB_"+a.idx+"_container"),r=o.parent();t(".mCSB_"+a.idx+"_scrollbar ."+d[12]).bind("mousedown."+s+" touchstart."+s+" pointerdown."+s+" MSPointerDown."+s,(function(i){c=!0,t(i.target).hasClass("mCSB_dragger")||(e=1)})).bind("touchend."+s+" pointerup."+s+" MSPointerUp."+s,(function(){c=!1})).bind("click."+s,(function(n){if(e&&(e=0,t(n.target).hasClass(d[12])||t(n.target).hasClass("mCSB_draggerRail"))){G(i);var s=t(this),l=s.find(".mCSB_dragger");if(s.parent(".mCSB_scrollTools_horizontal").length>0){if(!a.overflowed[1])return;var c="x",u=n.pageX>l.offset().left?-1:1,h=Math.abs(o[0].offsetLeft)-u*(.9*r.width())}else{if(!a.overflowed[0])return;c="y",u=n.pageY>l.offset().top?-1:1,h=Math.abs(o[0].offsetTop)-u*(.9*r.height())}K(i,h.toString(),{dir:c,scrollEasing:"mcsEaseInOut"})}}))},B=function(){var e=t(this),i=e.data(n),a=i.opt,s=n+"_"+i.idx,o=t("#mCSB_"+i.idx+"_container"),r=o.parent();o.bind("focusin."+s,(function(){var i=t(document.activeElement),n=o.find(".mCustomScrollBox").length,s=0;i.is(a.advanced.autoScrollOnFocus)&&(G(e),clearTimeout(e[0]._focusTimeout),e[0]._focusTimer=n?(s+17)*n:0,e[0]._focusTimeout=setTimeout((function(){var t=[nt(i)[0],nt(i)[1]],n=[o[0].offsetTop,o[0].offsetLeft],l=[n[0]+t[0]>=0&&n[0]+t[0]<r.height()-i.outerHeight(!1),n[1]+t[1]>=0&&n[0]+t[1]<r.width()-i.outerWidth(!1)],c="yx"!==a.axis||l[0]||l[1]?"all":"none";"x"===a.axis||l[0]||K(e,t[0].toString(),{dir:"y",scrollEasing:"mcsEaseInOut",overwrite:c,dur:s}),"y"===a.axis||l[1]||K(e,t[1].toString(),{dir:"x",scrollEasing:"mcsEaseInOut",overwrite:c,dur:s})}),e[0]._focusTimer))}))},F=function(){var e=t(this).data(n),i=n+"_"+e.idx,a=t("#mCSB_"+e.idx+"_container").parent();a.bind("scroll."+i,(function(){0===a.scrollTop()&&0===a.scrollLeft()||t(".mCSB_"+e.idx+"_scrollbar").css("visibility","hidden")}))},H=function(){var e=t(this),i=e.data(n),a=i.opt,s=i.sequential,o=n+"_"+i.idx,r=".mCSB_"+i.idx+"_scrollbar";t(r+">a").bind("contextmenu."+o,(function(t){t.preventDefault()})).bind("mousedown."+o+" touchstart."+o+" pointerdown."+o+" MSPointerDown."+o+" mouseup."+o+" touchend."+o+" pointerup."+o+" MSPointerUp."+o+" mouseout."+o+" pointerout."+o+" MSPointerOut."+o+" click."+o,(function(n){function o(t,i){s.scrollAmount=a.scrollButtons.scrollAmount,W(e,t,i)}if(n.preventDefault(),tt(n)){var r=t(this).attr("class");switch(s.type=a.scrollButtons.scrollType,n.type){case"mousedown":case"touchstart":case"pointerdown":case"MSPointerDown":if("stepped"===s.type)return;c=!0,i.tweenRunning=!1,o("on",r);break;case"mouseup":case"touchend":case"pointerup":case"MSPointerUp":case"mouseout":case"pointerout":case"MSPointerOut":if("stepped"===s.type)return;c=!1,s.dir&&o("off",r);break;case"click":if("stepped"!==s.type||i.tweenRunning)return;o("on",r)}}}))},z=function(){function e(e){function n(t,e){o.type=s.keyboard.scrollType,o.scrollAmount=s.keyboard.scrollAmount,"stepped"===o.type&&a.tweenRunning||W(i,t,e)}switch(e.type){case"blur":a.tweenRunning&&o.dir&&n("off",null);break;case"keydown":case"keyup":var r=e.keyCode?e.keyCode:e.which,l="on";if("x"!==s.axis&&(38===r||40===r)||"y"!==s.axis&&(37===r||39===r)){if((38===r||40===r)&&!a.overflowed[0]||(37===r||39===r)&&!a.overflowed[1])return;"keyup"===e.type&&(l="off"),t(document.activeElement).is(u)||(e.preventDefault(),e.stopImmediatePropagation(),n(l,r))}else if(33===r||34===r){if((a.overflowed[0]||a.overflowed[1])&&(e.preventDefault(),e.stopImmediatePropagation()),"keyup"===e.type){G(i);var h=34===r?-1:1;if("x"===s.axis||"yx"===s.axis&&a.overflowed[1]&&!a.overflowed[0])var p="x",f=Math.abs(c[0].offsetLeft)-h*(.9*d.width());else p="y",f=Math.abs(c[0].offsetTop)-h*(.9*d.height());K(i,f.toString(),{dir:p,scrollEasing:"mcsEaseInOut"})}}else if((35===r||36===r)&&!t(document.activeElement).is(u)&&((a.overflowed[0]||a.overflowed[1])&&(e.preventDefault(),e.stopImmediatePropagation()),"keyup"===e.type)){if("x"===s.axis||"yx"===s.axis&&a.overflowed[1]&&!a.overflowed[0])p="x",f=35===r?Math.abs(d.width()-c.outerWidth(!1)):0;else p="y",f=35===r?Math.abs(d.height()-c.outerHeight(!1)):0;K(i,f.toString(),{dir:p,scrollEasing:"mcsEaseInOut"})}}}var i=t(this),a=i.data(n),s=a.opt,o=a.sequential,r=n+"_"+a.idx,l=t("#mCSB_"+a.idx),c=t("#mCSB_"+a.idx+"_container"),d=c.parent(),u="input,textarea,select,datalist,keygen,[contenteditable='true']",h=c.find("iframe"),p=["blur."+r+" keydown."+r+" keyup."+r];h.length&&h.each((function(){t(this).bind("load",(function(){L(this)&&t(this.contentDocument||this.contentWindow.document).bind(p[0],(function(t){e(t)}))}))})),l.attr("tabindex","0").bind(p[0],(function(t){e(t)}))},W=function(e,i,a,s,o){function r(t){u.snapAmount&&(h.scrollAmount=u.snapAmount instanceof Array?"x"===h.dir[0]?u.snapAmount[1]:u.snapAmount[0]:u.snapAmount);var i="stepped"!==h.type,n=o||(t?i?m/1.5:g:1e3/60),a=t?i?7.5:40:2.5,l=[Math.abs(p[0].offsetTop),Math.abs(p[0].offsetLeft)],d=[c.scrollRatio.y>10?10:c.scrollRatio.y,c.scrollRatio.x>10?10:c.scrollRatio.x],f="x"===h.dir[0]?l[1]+h.dir[1]*(d[1]*a):l[0]+h.dir[1]*(d[0]*a),v="x"===h.dir[0]?l[1]+h.dir[1]*parseInt(h.scrollAmount):l[0]+h.dir[1]*parseInt(h.scrollAmount),b="auto"!==h.scrollAmount?v:f,y=s||(t?i?"mcsLinearOut":"mcsEaseInOut":"mcsLinear"),_=!!t;return t&&17>n&&(b="x"===h.dir[0]?l[1]:l[0]),K(e,b.toString(),{dir:h.dir[0],scrollEasing:y,dur:n,onComplete:_}),t?void(h.dir=!1):(clearTimeout(h.step),void(h.step=setTimeout((function(){r()}),n)))}function l(){clearTimeout(h.step),Z(h,"step"),G(e)}var c=e.data(n),u=c.opt,h=c.sequential,p=t("#mCSB_"+c.idx+"_container"),f="stepped"===h.type,m=u.scrollInertia<26?26:u.scrollInertia,g=u.scrollInertia<1?17:u.scrollInertia;switch(i){case"on":if(h.dir=[a===d[16]||a===d[15]||39===a||37===a?"x":"y",a===d[13]||a===d[15]||38===a||37===a?-1:1],G(e),it(a)&&"stepped"===h.type)return;r(f);break;case"off":l(),(f||c.tweenRunning&&h.dir)&&r(!0)}},U=function(e){var i=t(this).data(n).opt,a=[];return"function"==typeof e&&(e=e()),e instanceof Array?a=e.length>1?[e[0],e[1]]:"x"===i.axis?[null,e[0]]:[e[0],null]:(a[0]=e.y?e.y:e.x||"x"===i.axis?null:e,a[1]=e.x?e.x:e.y||"y"===i.axis?null:e),"function"==typeof a[0]&&(a[0]=a[0]()),"function"==typeof a[1]&&(a[1]=a[1]()),a},q=function(e,i){if(null!=e&&void 0!==e){var a=t(this),s=a.data(n),o=s.opt,r=t("#mCSB_"+s.idx+"_container"),l=r.parent(),c=typeof e;i||(i="x"===o.axis?"x":"y");var d="x"===i?r.outerWidth(!1)-l.width():r.outerHeight(!1)-l.height(),h="x"===i?r[0].offsetLeft:r[0].offsetTop,p="x"===i?"left":"top";switch(c){case"function":return e();case"object":if(!(m=e.jquery?e:t(e)).length)return;return"x"===i?nt(m)[1]:nt(m)[0];case"string":case"number":if(it(e))return Math.abs(e);if(-1!==e.indexOf("%"))return Math.abs(d*parseInt(e)/100);if(-1!==e.indexOf("-="))return Math.abs(h-parseInt(e.split("-=")[1]));if(-1!==e.indexOf("+=")){var f=h+parseInt(e.split("+=")[1]);return f>=0?0:Math.abs(f)}if(-1!==e.indexOf("px")&&it(e.split("px")[0]))return Math.abs(e.split("px")[0]);if("top"===e||"left"===e)return 0;if("bottom"===e)return Math.abs(l.height()-r.outerHeight(!1));if("right"===e)return Math.abs(l.width()-r.outerWidth(!1));if("first"===e||"last"===e){var m=r.find(":"+e);return"x"===i?nt(m)[1]:nt(m)[0]}return t(e).length?"x"===i?nt(t(e))[1]:nt(t(e))[0]:(r.css(p,e),void u.update.call(null,a[0]))}}},Y=function(e){function i(){return clearTimeout(h[0].autoUpdate),0===r.parents("html").length?void(r=null):void(h[0].autoUpdate=setTimeout((function(){return c.advanced.updateOnSelectorChange&&(l.poll.change.n=s(),l.poll.change.n!==l.poll.change.o)?(l.poll.change.o=l.poll.change.n,void o(3)):c.advanced.updateOnContentResize&&(l.poll.size.n=r[0].scrollHeight+r[0].scrollWidth+h[0].offsetHeight+r[0].offsetHeight+r[0].offsetWidth,l.poll.size.n!==l.poll.size.o)?(l.poll.size.o=l.poll.size.n,void o(1)):!c.advanced.updateOnImageLoad||"auto"===c.advanced.updateOnImageLoad&&"y"===c.axis||(l.poll.img.n=h.find("img").length,l.poll.img.n===l.poll.img.o)?void((c.advanced.updateOnSelectorChange||c.advanced.updateOnContentResize||c.advanced.updateOnImageLoad)&&i()):(l.poll.img.o=l.poll.img.n,void h.find("img").each((function(){a(this)})))}),c.advanced.autoUpdateTimeout))}function a(e){function i(t,e){return function(){return e.apply(t,arguments)}}function n(){this.onload=null,t(e).addClass(d[2]),o(2)}if(t(e).hasClass(d[2]))o();else{var a=new Image;a.onload=i(a,n),a.src=e.src}}function s(){!0===c.advanced.updateOnSelectorChange&&(c.advanced.updateOnSelectorChange="*");var t=0,e=h.find(c.advanced.updateOnSelectorChange);return c.advanced.updateOnSelectorChange&&e.length>0&&e.each((function(){t+=this.offsetHeight+this.offsetWidth})),t}function o(t){clearTimeout(h[0].autoUpdate),u.update.call(null,r[0],t)}var r=t(this),l=r.data(n),c=l.opt,h=t("#mCSB_"+l.idx+"_container");return e?(clearTimeout(h[0].autoUpdate),void Z(h[0],"autoUpdate")):void i()},V=function(t,e,i){return Math.round(t/e)*e-i},G=function(e){var i=e.data(n);t("#mCSB_"+i.idx+"_container,#mCSB_"+i.idx+"_container_wrapper,#mCSB_"+i.idx+"_dragger_vertical,#mCSB_"+i.idx+"_dragger_horizontal").each((function(){J.call(this)}))},K=function(e,i,a){function s(t){return l&&c.callbacks[t]&&"function"==typeof c.callbacks[t]}function o(){return[c.callbacks.alwaysTriggerOffsets||_>=x[0]+k,c.callbacks.alwaysTriggerOffsets||-$>=_]}function r(){var t=[p[0].offsetTop,p[0].offsetLeft],i=[b[0].offsetTop,b[0].offsetLeft],n=[p.outerHeight(!1),p.outerWidth(!1)],s=[h.height(),h.width()];e[0].mcs={content:p,top:t[0],left:t[1],draggerTop:i[0],draggerLeft:i[1],topPct:Math.round(100*Math.abs(t[0])/(Math.abs(n[0])-s[0])),leftPct:Math.round(100*Math.abs(t[1])/(Math.abs(n[1])-s[1])),direction:a.dir}}var l=e.data(n),c=l.opt,d={trigger:"internal",dir:"y",scrollEasing:"mcsEaseOut",drag:!1,dur:c.scrollInertia,overwrite:"all",callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},u=[(a=t.extend(d,a)).dur,a.drag?0:a.dur],h=t("#mCSB_"+l.idx),p=t("#mCSB_"+l.idx+"_container"),f=p.parent(),m=c.callbacks.onTotalScrollOffset?U.call(e,c.callbacks.onTotalScrollOffset):[0,0],g=c.callbacks.onTotalScrollBackOffset?U.call(e,c.callbacks.onTotalScrollBackOffset):[0,0];if(l.trigger=a.trigger,0===f.scrollTop()&&0===f.scrollLeft()||(t(".mCSB_"+l.idx+"_scrollbar").css("visibility","visible"),f.scrollTop(0).scrollLeft(0)),"_resetY"!==i||l.contentReset.y||(s("onOverflowYNone")&&c.callbacks.onOverflowYNone.call(e[0]),l.contentReset.y=1),"_resetX"!==i||l.contentReset.x||(s("onOverflowXNone")&&c.callbacks.onOverflowXNone.call(e[0]),l.contentReset.x=1),"_resetY"!==i&&"_resetX"!==i){if(!l.contentReset.y&&e[0].mcs||!l.overflowed[0]||(s("onOverflowY")&&c.callbacks.onOverflowY.call(e[0]),l.contentReset.x=null),!l.contentReset.x&&e[0].mcs||!l.overflowed[1]||(s("onOverflowX")&&c.callbacks.onOverflowX.call(e[0]),l.contentReset.x=null),c.snapAmount){var v=c.snapAmount instanceof Array?"x"===a.dir?c.snapAmount[1]:c.snapAmount[0]:c.snapAmount;i=V(i,v,c.snapOffset)}switch(a.dir){case"x":var b=t("#mCSB_"+l.idx+"_dragger_horizontal"),y="left",_=p[0].offsetLeft,x=[h.width()-p.outerWidth(!1),b.parent().width()-b.width()],w=[i,0===i?0:i/l.scrollRatio.x],k=m[1],$=g[1],S=k>0?k/l.scrollRatio.x:0,T=$>0?$/l.scrollRatio.x:0;break;case"y":b=t("#mCSB_"+l.idx+"_dragger_vertical"),y="top",_=p[0].offsetTop,x=[h.height()-p.outerHeight(!1),b.parent().height()-b.height()],w=[i,0===i?0:i/l.scrollRatio.y],k=m[0],$=g[0],S=k>0?k/l.scrollRatio.y:0,T=$>0?$/l.scrollRatio.y:0}w[1]<0||0===w[0]&&0===w[1]?w=[0,0]:w[1]>=x[1]?w=[x[0],x[1]]:w[0]=-w[0],e[0].mcs||(r(),s("onInit")&&c.callbacks.onInit.call(e[0])),clearTimeout(p[0].onCompleteTimeout),X(b[0],y,Math.round(w[1]),u[1],a.scrollEasing),!l.tweenRunning&&(0===_&&w[0]>=0||_===x[0]&&w[0]<=x[0])||X(p[0],y,Math.round(w[0]),u[0],a.scrollEasing,a.overwrite,{onStart:function(){a.callbacks&&a.onStart&&!l.tweenRunning&&(s("onScrollStart")&&(r(),c.callbacks.onScrollStart.call(e[0])),l.tweenRunning=!0,C(b),l.cbOffsets=o())},onUpdate:function(){a.callbacks&&a.onUpdate&&s("whileScrolling")&&(r(),c.callbacks.whileScrolling.call(e[0]))},onComplete:function(){if(a.callbacks&&a.onComplete){"yx"===c.axis&&clearTimeout(p[0].onCompleteTimeout);var t=p[0].idleTimer||0;p[0].onCompleteTimeout=setTimeout((function(){s("onScroll")&&(r(),c.callbacks.onScroll.call(e[0])),s("onTotalScroll")&&w[1]>=x[1]-S&&l.cbOffsets[0]&&(r(),c.callbacks.onTotalScroll.call(e[0])),s("onTotalScrollBack")&&w[1]<=T&&l.cbOffsets[1]&&(r(),c.callbacks.onTotalScrollBack.call(e[0])),l.tweenRunning=!1,p[0].idleTimer=0,C(b,"hide")}),t)}}})}},X=function(t,e,i,n,a,s,o){function r(){x.stop||(b||f.call(),b=Q()-v,l(),b>=x.time&&(x.time=b>x.time?b+h-(b-x.time):b+h-1,x.time<b+1&&(x.time=b+1)),x.time<n?x.id=p(r):g.call())}function l(){n>0?(x.currVal=u(x.time,y,w,n,a),_[e]=Math.round(x.currVal)+"px"):_[e]=i+"px",m.call()}function c(){h=1e3/60,x.time=b+h,p=window.requestAnimationFrame?window.requestAnimationFrame:function(t){return l(),setTimeout(t,.01)},x.id=p(r)}function d(){null!=x.id&&(window.requestAnimationFrame?window.cancelAnimationFrame(x.id):clearTimeout(x.id),x.id=null)}function u(t,e,i,n,a){switch(a){case"linear":case"mcsLinear":return i*t/n+e;case"mcsLinearOut":return t/=n,t--,i*Math.sqrt(1-t*t)+e;case"easeInOutSmooth":return 1>(t/=n/2)?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e;case"easeInOutStrong":return 1>(t/=n/2)?i/2*Math.pow(2,10*(t-1))+e:(t--,i/2*(2-Math.pow(2,-10*t))+e);case"easeInOut":case"mcsEaseInOut":return 1>(t/=n/2)?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e;case"easeOutSmooth":return t/=n,-i*(--t*t*t*t-1)+e;case"easeOutStrong":return i*(1-Math.pow(2,-10*t/n))+e;default:var s=(t/=n)*t,o=s*t;return e+i*(.499999999999997*o*s+-2.5*s*s+5.5*o+-6.5*s+4*t)}}t._mTween||(t._mTween={top:{},left:{}});var h,p,f=(o=o||{}).onStart||function(){},m=o.onUpdate||function(){},g=o.onComplete||function(){},v=Q(),b=0,y=t.offsetTop,_=t.style,x=t._mTween[e];"left"===e&&(y=t.offsetLeft);var w=i-y;x.stop=0,"none"!==s&&d(),c()},Q=function(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?Date.now():(new Date).getTime()},J=function(){var t=this;t._mTween||(t._mTween={top:{},left:{}});for(var e=["top","left"],i=0;i<e.length;i++){var n=e[i];t._mTween[n].id&&(window.requestAnimationFrame?window.cancelAnimationFrame(t._mTween[n].id):clearTimeout(t._mTween[n].id),t._mTween[n].id=null,t._mTween[n].stop=1)}},Z=function(t,e){try{delete t[e]}catch(i){t[e]=null}},tt=function(t){return!(t.which&&1!==t.which)},et=function(t){var e=t.originalEvent.pointerType;return!(e&&"touch"!==e&&2!==e)},it=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},nt=function(t){var e=t.parents(".mCSB_container");return[t.offset().top-e.offset().top,t.offset().left-e.offset().left]},at=function(){function t(){var t=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var e=0;e<t.length;e++)if(t[e]+"Hidden"in document)return t[e]+"Hidden";return null}var e=t();return!!e&&document[e]};t.fn[i]=function(e){return u[e]?u[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist"):u.init.apply(this,arguments)},t[i]=function(e){return u[e]?u[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist"):u.init.apply(this,arguments)},t[i].defaults=s,window[i]=!0,t(window).bind("load",(function(){t(a)[i](),t.extend(t.expr[":"],{mcsInView:t.expr[":"].mcsInView||function(e){var i,n,a=t(e),s=a.parents(".mCSB_container");if(s.length)return i=s.parent(),(n=[s[0].offsetTop,s[0].offsetLeft])[0]+nt(a)[0]>=0&&n[0]+nt(a)[0]<i.height()-a.outerHeight(!1)&&n[1]+nt(a)[1]>=0&&n[1]+nt(a)[1]<i.width()-a.outerWidth(!1)},mcsInSight:t.expr[":"].mcsInSight||function(e,i,n){var a,s,o,r,l=t(e),c=l.parents(".mCSB_container"),d="exact"===n[3]?[[1,0],[1,0]]:[[.9,.1],[.6,.4]];if(c.length)return a=[l.outerHeight(!1),l.outerWidth(!1)],o=[c[0].offsetTop+nt(l)[0],c[0].offsetLeft+nt(l)[1]],s=[c.parent()[0].offsetHeight,c.parent()[0].offsetWidth],r=[a[0]<s[0]?d[0]:d[1],a[1]<s[1]?d[0]:d[1]],o[0]-s[0]*r[0][0]<0&&o[0]+a[0]-s[0]*r[0][1]>=0&&o[1]-s[1]*r[1][0]<0&&o[1]+a[1]-s[1]*r[1][1]>=0},mcsOverflow:t.expr[":"].mcsOverflow||function(e){var i=t(e).data(n);if(i)return i.overflowed[0]||i.overflowed[1]}})}))}()}()}));var ogame=ogame||{};!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?t(require("jquery")):t(jQuery)}((function(t){var e=function(){if(t&&t.fn&&t.fn.select2&&t.fn.select2.amd)var e=t.fn.select2.amd;return function(){var t,i,n;e&&e.requirejs||(e?i=e:e={},function(e){var a,s,o,r,l={},c={},d={},u={},h=Object.prototype.hasOwnProperty,p=[].slice,f=/\.js$/;function m(t,e){return h.call(t,e)}function g(t,e){var i,n,a,s,o,r,l,c,u,h,p,m=e&&e.split("/"),g=d.map,v=g&&g["*"]||{};if(t&&"."===t.charAt(0))if(e){for(m=m.slice(0,m.length-1),o=(t=t.split("/")).length-1,d.nodeIdCompat&&f.test(t[o])&&(t[o]=t[o].replace(f,"")),t=m.concat(t),u=0;u<t.length;u+=1)if("."===(p=t[u]))t.splice(u,1),u-=1;else if(".."===p){if(1===u&&(".."===t[2]||".."===t[0]))break;u>0&&(t.splice(u-1,2),u-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((m||v)&&g){for(u=(i=t.split("/")).length;u>0;u-=1){if(n=i.slice(0,u).join("/"),m)for(h=m.length;h>0;h-=1)if((a=g[m.slice(0,h).join("/")])&&(a=a[n])){s=a,r=u;break}if(s)break;!l&&v&&v[n]&&(l=v[n],c=u)}!s&&l&&(s=l,r=c),s&&(i.splice(0,r,s),t=i.join("/"))}return t}function v(t,i){return function(){return s.apply(e,p.call(arguments,0).concat([t,i]))}}function b(t){return function(e){l[t]=e}}function y(t){if(m(c,t)){var i=c[t];delete c[t],u[t]=!0,a.apply(e,i)}if(!m(l,t)&&!m(u,t))throw new Error("No "+t);return l[t]}function _(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function x(t){return function(){return d&&d.config&&d.config[t]||{}}}o=function(t,e){var i,n=_(t),a=n[0];return t=n[1],a&&(i=y(a=g(a,e))),a?t=i&&i.normalize?i.normalize(t,function(t){return function(e){return g(e,t)}}(e)):g(t,e):(a=(n=_(t=g(t,e)))[0],t=n[1],a&&(i=y(a))),{f:a?a+"!"+t:t,n:t,pr:a,p:i}},r={require:function(t){return v(t)},exports:function(t){var e=l[t];return void 0!==e?e:l[t]={}},module:function(t){return{id:t,uri:"",exports:l[t],config:x(t)}}},a=function(t,i,n,a){var s,d,h,p,f,g,_=[],x=typeof n;if(a=a||t,"undefined"===x||"function"===x){for(i=!i.length&&n.length?["require","exports","module"]:i,f=0;f<i.length;f+=1)if("require"===(d=(p=o(i[f],a)).f))_[f]=r.require(t);else if("exports"===d)_[f]=r.exports(t),g=!0;else if("module"===d)s=_[f]=r.module(t);else if(m(l,d)||m(c,d)||m(u,d))_[f]=y(d);else{if(!p.p)throw new Error(t+" missing "+d);p.p.load(p.n,v(a,!0),b(d),{}),_[f]=l[d]}h=n?n.apply(l[t],_):void 0,t&&(s&&s.exports!==e&&s.exports!==l[t]?l[t]=s.exports:h===e&&g||(l[t]=h))}else t&&(l[t]=n)},t=i=s=function(t,i,n,l,c){if("string"==typeof t)return r[t]?r[t](i):y(o(t,i).f);if(!t.splice){if((d=t).deps&&s(d.deps,d.callback),!i)return;i.splice?(t=i,i=n,n=null):t=e}return i=i||function(){},"function"==typeof n&&(n=l,l=c),l?a(e,t,i,n):setTimeout((function(){a(e,t,i,n)}),4),s},s.config=function(t){return s(t)},t._defined=l,(n=function(t,e,i){e.splice||(i=e,e=[]),m(l,t)||m(c,t)||(c[t]=[t,e,i])}).amd={jQuery:!0}}(),e.requirejs=t,e.require=i,e.define=n)}(),e.define("almond",(function(){})),e.define("jquery",[],(function(){var e=t||$;return null==e&&console&&console.error&&console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page."),e})),e.define("select2/utils",["jquery"],(function(t){var e={};function i(t){var e=t.prototype,i=[];for(var n in e){"function"==typeof e[n]&&("constructor"!==n&&i.push(n))}return i}e.Extend=function(t,e){var i={}.hasOwnProperty;function n(){this.constructor=t}for(var a in e)i.call(e,a)&&(t[a]=e[a]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},e.Decorate=function(t,e){var n=i(e),a=i(t);function s(){var i=Array.prototype.unshift,n=e.prototype.constructor.length,a=t.prototype.constructor;n>0&&(i.call(arguments,t.prototype.constructor),a=e.prototype.constructor),a.apply(this,arguments)}e.displayName=t.displayName,s.prototype=new function(){this.constructor=s};for(var o=0;o<a.length;o++){var r=a[o];s.prototype[r]=t.prototype[r]}for(var l=function(t){var i=function(){};t in s.prototype&&(i=s.prototype[t]);var n=e.prototype[t];return function(){return Array.prototype.unshift.call(arguments,i),n.apply(this,arguments)}},c=0;c<n.length;c++){var d=n[c];s.prototype[d]=l(d)}return s};var n=function(){this.listeners={}};return n.prototype.on=function(t,e){this.listeners=this.listeners||{},t in this.listeners?this.listeners[t].push(e):this.listeners[t]=[e]},n.prototype.trigger=function(t){var e=Array.prototype.slice;this.listeners=this.listeners||{},t in this.listeners&&this.invoke(this.listeners[t],e.call(arguments,1)),"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},n.prototype.invoke=function(t,e){for(var i=0,n=t.length;i<n;i++)t[i].apply(this,e)},e.Observable=n,e.generateChars=function(t){for(var e="",i=0;i<t;i++){e+=Math.floor(36*Math.random()).toString(36)}return e},e.bind=function(t,e){return function(){t.apply(e,arguments)}},e._convertData=function(t){for(var e in t){var i=e.split("-"),n=t;if(1!==i.length){for(var a=0;a<i.length;a++){var s=i[a];(s=s.substring(0,1).toLowerCase()+s.substring(1))in n||(n[s]={}),a==i.length-1&&(n[s]=t[e]),n=n[s]}delete t[e]}}return t},e.hasScroll=function(e,i){var n=t(i),a=i.style.overflowX,s=i.style.overflowY;return(a!==s||"hidden"!==s&&"visible"!==s)&&("scroll"===a||"scroll"===s||(n.innerHeight()<i.scrollHeight||n.innerWidth()<i.scrollWidth))},e.escapeMarkup=function(t){var e={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!=typeof t?t:String(t).replace(/[&<>"'\/\\]/g,(function(t){return e[t]}))},e.appendMany=function(e,i){if("1.7"===t.fn.jquery.substr(0,3)){var n=t();t.map(i,(function(t){n=n.add(t)})),i=n}e.append(i)},e})),e.define("select2/results",["jquery","./utils"],(function(t,e){function i(t,e,n){this.$element=t,this.data=n,this.options=e,i.__super__.constructor.call(this)}return e.Extend(i,e.Observable),i.prototype.render=function(){var e=t('<ul class="select2-results__options" role="tree"></ul>');return this.options.get("multiple")&&e.attr("aria-multiselectable","true"),this.$results=e,e},i.prototype.clear=function(){this.$results.empty()},i.prototype.displayMessage=function(e){var i=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var n=t('<li role="treeitem" class="select2-results__option"></li>'),a=this.options.get("translations").get(e.message);n.append(i(a(e.args))),this.$results.append(n)},i.prototype.append=function(t){this.hideLoading();var e=[];if(null!=t.results&&0!==t.results.length){t.results=this.sort(t.results);for(var i=0;i<t.results.length;i++){var n=t.results[i],a=this.option(n);e.push(a)}this.$results.append(e)}else 0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"})},i.prototype.position=function(t,e){e.find(".select2-results").append(t)},i.prototype.sort=function(t){return this.options.get("sorter")(t)},i.prototype.setClasses=function(){var e=this;this.data.current((function(i){var n=t.map(i,(function(t){return t.id.toString()})),a=e.$results.find(".select2-results__option[aria-selected]");a.each((function(){var e=t(this),i=t.data(this,"data"),a=""+i.id;null!=i.element&&i.element.selected||null==i.element&&t.inArray(a,n)>-1?e.attr("aria-selected","true"):e.attr("aria-selected","false")}));var s=a.filter("[aria-selected=true]");s.length>0?s.first().trigger("mouseenter"):a.first().trigger("mouseenter")}))},i.prototype.showLoading=function(t){this.hideLoading();var e={disabled:!0,loading:!0,text:this.options.get("translations").get("searching")(t)},i=this.option(e);i.className+=" loading-results",this.$results.prepend(i)},i.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},i.prototype.option=function(e){var i=document.createElement("li");i.className="select2-results__option";var n={role:"treeitem","aria-selected":"false"};for(var a in e.disabled&&(delete n["aria-selected"],n["aria-disabled"]="true"),null==e.id&&delete n["aria-selected"],null!=e._resultId&&(i.id=e._resultId),e.title&&(i.title=e.title),e.children&&(n.role="group",n["aria-label"]=e.text,delete n["aria-selected"]),n){var s=n[a];i.setAttribute(a,s)}if(e.children){var o=t(i),r=document.createElement("strong");r.className="select2-results__group";t(r);this.template(e,r);for(var l=[],c=0;c<e.children.length;c++){var d=e.children[c],u=this.option(d);l.push(u)}var h=t("<ul></ul>",{class:"select2-results__options select2-results__options--nested"});h.append(l),o.append(r),o.append(h)}else this.template(e,i);return t.data(i,"data",e),i},i.prototype.bind=function(e,i){var n=this,a=e.id+"-results";this.$results.attr("id",a),e.on("results:all",(function(t){n.clear(),n.append(t.data),e.isOpen()&&n.setClasses()})),e.on("results:append",(function(t){n.append(t.data),e.isOpen()&&n.setClasses()})),e.on("query",(function(t){n.showLoading(t)})),e.on("select",(function(){e.isOpen()&&n.setClasses()})),e.on("unselect",(function(){e.isOpen()&&n.setClasses()})),e.on("open",(function(){n.$results.attr("aria-expanded","true"),n.$results.attr("aria-hidden","false"),n.setClasses(),n.ensureHighlightVisible()})),e.on("close",(function(){n.$results.attr("aria-expanded","false"),n.$results.attr("aria-hidden","true"),n.$results.removeAttr("aria-activedescendant")})),e.on("results:toggle",(function(){var t=n.getHighlightedResults();0!==t.length&&t.trigger("mouseup")})),e.on("results:select",(function(){var t=n.getHighlightedResults();if(0!==t.length){var e=t.data("data");"true"==t.attr("aria-selected")?n.trigger("close"):n.trigger("select",{data:e})}})),e.on("results:previous",(function(){var t=n.getHighlightedResults(),e=n.$results.find("[aria-selected]"),i=e.index(t);if(0!==i){var a=i-1;0===t.length&&(a=0);var s=e.eq(a);s.trigger("mouseenter");var o=n.$results.offset().top,r=s.offset().top,l=n.$results.scrollTop()+(r-o);0===a?n.$results.scrollTop(0):r-o<0&&n.$results.scrollTop(l)}})),e.on("results:next",(function(){var t=n.getHighlightedResults(),e=n.$results.find("[aria-selected]"),i=e.index(t)+1;if(!(i>=e.length)){var a=e.eq(i);a.trigger("mouseenter");var s=n.$results.offset().top+n.$results.outerHeight(!1),o=a.offset().top+a.outerHeight(!1),r=n.$results.scrollTop()+o-s;0===i?n.$results.scrollTop(0):o>s&&n.$results.scrollTop(r)}})),e.on("results:focus",(function(t){t.element.addClass("select2-results__option--highlighted")})),e.on("results:message",(function(t){n.displayMessage(t)})),t.fn.mousewheel&&this.$results.on("mousewheel",(function(t){var e=n.$results.scrollTop(),i=n.$results.get(0).scrollHeight-n.$results.scrollTop()+t.deltaY,a=t.deltaY>0&&e-t.deltaY<=0,s=t.deltaY<0&&i<=n.$results.height();a?(n.$results.scrollTop(0),t.preventDefault(),t.stopPropagation()):s&&(n.$results.scrollTop(n.$results.get(0).scrollHeight-n.$results.height()),t.preventDefault(),t.stopPropagation())})),this.$results.on("mouseup",".select2-results__option[aria-selected]",(function(e){var i=t(this),a=i.data("data");"true"!==i.attr("aria-selected")?n.trigger("select",{originalEvent:e,data:a}):n.options.get("multiple")?n.trigger("unselect",{originalEvent:e,data:a}):n.trigger("close")})),this.$results.on("mouseenter",".select2-results__option[aria-selected]",(function(e){var i=t(this).data("data");n.getHighlightedResults().removeClass("select2-results__option--highlighted"),n.trigger("results:focus",{data:i,element:t(this)})}))},i.prototype.getHighlightedResults=function(){return this.$results.find(".select2-results__option--highlighted")},i.prototype.destroy=function(){this.$results.remove()},i.prototype.ensureHighlightVisible=function(){var t=this.getHighlightedResults();if(0!==t.length){var e=this.$results.find("[aria-selected]").index(t),i=this.$results.offset().top,n=t.offset().top,a=this.$results.scrollTop()+(n-i),s=n-i;a-=2*t.outerHeight(!1),e<=2?this.$results.scrollTop(0):(s>this.$results.outerHeight()||s<0)&&this.$results.scrollTop(a)}},i.prototype.template=function(e,i){var n=this.options.get("templateResult"),a=this.options.get("escapeMarkup"),s=n(e);null==s?i.style.display="none":"string"==typeof s?i.innerHTML=a(s):t(i).append(s)},i})),e.define("select2/keys",[],(function(){return{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46}})),e.define("select2/selection/base",["jquery","../utils","../keys"],(function(t,e,i){function n(t,e){this.$element=t,this.options=e,n.__super__.constructor.call(this)}return e.Extend(n,e.Observable),n.prototype.render=function(){var e=t('<span class="select2-selection" role="combobox" aria-autocomplete="list" aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=this.$element.data("old-tabindex")?this._tabindex=this.$element.data("old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),e.attr("title",this.$element.attr("title")),e.attr("tabindex",this._tabindex),this.$selection=e,e},n.prototype.bind=function(t,e){var n=this,a=(t.id,t.id+"-results");this.container=t,this.$selection.on("focus",(function(t){n.trigger("focus",t)})),this.$selection.on("blur",(function(t){n.trigger("blur",t)})),this.$selection.on("keydown",(function(t){n.trigger("keypress",t),t.which===i.SPACE&&t.preventDefault()})),t.on("results:focus",(function(t){n.$selection.attr("aria-activedescendant",t.data._resultId)})),t.on("selection:update",(function(t){n.update(t.data)})),t.on("open",(function(){n.$selection.attr("aria-expanded","true"),n.$selection.attr("aria-owns",a),n._attachCloseHandler(t)})),t.on("close",(function(){n.$selection.attr("aria-expanded","false"),n.$selection.removeAttr("aria-activedescendant"),n.$selection.removeAttr("aria-owns"),n.$selection.focus(),n._detachCloseHandler(t)})),t.on("enable",(function(){n.$selection.attr("tabindex",n._tabindex)})),t.on("disable",(function(){n.$selection.attr("tabindex","-1")}))},n.prototype._attachCloseHandler=function(e){t(document.body).on("mousedown.select2."+e.id,(function(e){var i=t(e.target).closest(".select2");t(".select2.select2-container--open").each((function(){var e=t(this);this!=i[0]&&e.data("element").select2("close")}))}))},n.prototype._detachCloseHandler=function(e){t(document.body).off("mousedown.select2."+e.id)},n.prototype.position=function(t,e){e.find(".selection").append(t)},n.prototype.destroy=function(){this._detachCloseHandler(this.container)},n.prototype.update=function(t){throw new Error("The `update` method must be defined in child classes.")},n})),e.define("select2/selection/single",["jquery","./base","../utils","../keys"],(function(t,e,i,n){function a(){a.__super__.constructor.apply(this,arguments)}return i.Extend(a,e),a.prototype.render=function(){var t=a.__super__.render.call(this);return t.addClass("select2-selection--single"),t.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),t},a.prototype.bind=function(t,e){var i=this;a.__super__.bind.apply(this,arguments);var n=t.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",n),this.$selection.attr("aria-labelledby",n),this.$selection.on("mousedown",(function(t){1===t.which&&i.trigger("toggle",{originalEvent:t})})),this.$selection.on("focus",(function(t){})),this.$selection.on("blur",(function(t){})),t.on("selection:update",(function(t){i.update(t.data)}))},a.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},a.prototype.display=function(t){var e=this.options.get("templateSelection");return this.options.get("escapeMarkup")(e(t))},a.prototype.selectionContainer=function(){return t("<span></span>")},a.prototype.update=function(t){if(0!==t.length){var e=t[0],i=this.display(e),n=this.$selection.find(".select2-selection__rendered");n.empty().append(i),n.prop("title",e.title||e.text)}else this.clear()},a})),e.define("select2/selection/multiple",["jquery","./base","../utils"],(function(t,e,i){function n(t,e){n.__super__.constructor.apply(this,arguments)}return i.Extend(n,e),n.prototype.render=function(){var t=n.__super__.render.call(this);return t.addClass("select2-selection--multiple"),t.html('<ul class="select2-selection__rendered"></ul>'),t},n.prototype.bind=function(e,i){var a=this;n.__super__.bind.apply(this,arguments),this.$selection.on("click",(function(t){a.trigger("toggle",{originalEvent:t})})),this.$selection.on("click",".select2-selection__choice__remove",(function(e){var i=t(this).parent().data("data");a.trigger("unselect",{originalEvent:e,data:i})}))},n.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},n.prototype.display=function(t){var e=this.options.get("templateSelection");return this.options.get("escapeMarkup")(e(t))},n.prototype.selectionContainer=function(){return t('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>')},n.prototype.update=function(t){if(this.clear(),0!==t.length){for(var e=[],n=0;n<t.length;n++){var a=t[n],s=this.display(a),o=this.selectionContainer();o.append(s),o.prop("title",a.title||a.text),o.data("data",a),e.push(o)}var r=this.$selection.find(".select2-selection__rendered");i.appendMany(r,e)}},n})),e.define("select2/selection/placeholder",["../utils"],(function(t){function e(t,e,i){this.placeholder=this.normalizePlaceholder(i.get("placeholder")),t.call(this,e,i)}return e.prototype.normalizePlaceholder=function(t,e){return"string"==typeof e&&(e={id:"",text:e}),e},e.prototype.createPlaceholder=function(t,e){var i=this.selectionContainer();return i.html(this.display(e)),i.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),i},e.prototype.update=function(t,e){var i=1==e.length&&e[0].id!=this.placeholder.id;if(e.length>1||i)return t.call(this,e);this.clear();var n=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(n)},e})),e.define("select2/selection/allowClear",["jquery","../keys"],(function(t,e){function i(){}return i.prototype.bind=function(t,e,i){var n=this;t.call(this,e,i),null==this.placeholder&&this.options.get("debug")&&window.console&&console.error&&console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option."),this.$selection.on("mousedown",".select2-selection__clear",(function(t){n._handleClear(t)})),e.on("keypress",(function(t){n._handleKeyboardClear(t,e)}))},i.prototype._handleClear=function(t,e){if(!this.options.get("disabled")){var i=this.$selection.find(".select2-selection__clear");if(0!==i.length){e.stopPropagation();for(var n=i.data("data"),a=0;a<n.length;a++){var s={data:n[a]};if(this.trigger("unselect",s),s.prevented)return}this.$element.val(this.placeholder.id).trigger("change"),this.trigger("toggle")}}},i.prototype._handleKeyboardClear=function(t,i,n){n.isOpen()||i.which!=e.DELETE&&i.which!=e.BACKSPACE||this._handleClear(i)},i.prototype.update=function(e,i){if(e.call(this,i),!(this.$selection.find(".select2-selection__placeholder").length>0||0===i.length)){var n=t('<span class="select2-selection__clear">&times;</span>');n.data("data",i),this.$selection.find(".select2-selection__rendered").prepend(n)}},i})),e.define("select2/selection/search",["jquery","../utils","../keys"],(function(t,e,i){function n(t,e,i){t.call(this,e,i)}return n.prototype.render=function(e){var i=t('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /></li>');return this.$searchContainer=i,this.$search=i.find("input"),e.call(this)},n.prototype.bind=function(t,e,n){var a=this;t.call(this,e,n),e.on("open",(function(){a.$search.attr("tabindex",0),a.$search.focus()})),e.on("close",(function(){a.$search.attr("tabindex",-1),a.$search.val(""),a.$search.focus()})),e.on("enable",(function(){a.$search.prop("disabled",!1)})),e.on("disable",(function(){a.$search.prop("disabled",!0)})),this.$selection.on("focusin",".select2-search--inline",(function(t){a.trigger("focus",t)})),this.$selection.on("focusout",".select2-search--inline",(function(t){a.trigger("blur",t)})),this.$selection.on("keydown",".select2-search--inline",(function(t){if(t.stopPropagation(),a.trigger("keypress",t),a._keyUpPrevented=t.isDefaultPrevented(),t.which===i.BACKSPACE&&""===a.$search.val()){var e=a.$searchContainer.prev(".select2-selection__choice");if(e.length>0){var n=e.data("data");a.searchRemoveChoice(n),t.preventDefault()}}})),this.$selection.on("input",".select2-search--inline",(function(t){a.$selection.off("keyup.search")})),this.$selection.on("keyup.search input",".select2-search--inline",(function(t){a.handleSearch(t)}))},n.prototype.createPlaceholder=function(t,e){this.$search.attr("placeholder",e.text)},n.prototype.update=function(t,e){this.$search.attr("placeholder",""),t.call(this,e),this.$selection.find(".select2-selection__rendered").append(this.$searchContainer),this.resizeSearch()},n.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var t=this.$search.val();this.trigger("query",{term:t})}this._keyUpPrevented=!1},n.prototype.searchRemoveChoice=function(t,e){this.trigger("unselect",{data:e}),this.trigger("open"),this.$search.val(e.text+" ")},n.prototype.resizeSearch=function(){this.$search.css("width","25px");var t="";""!==this.$search.attr("placeholder")?t=this.$selection.find(".select2-selection__rendered").innerWidth():t=.75*(this.$search.val().length+1)+"em";this.$search.css("width",t)},n})),e.define("select2/selection/eventRelay",["jquery"],(function(t){function e(){}return e.prototype.bind=function(e,i,n){var a=this,s=["open","opening","close","closing","select","selecting","unselect","unselecting"],o=["opening","closing","selecting","unselecting"];e.call(this,i,n),i.on("*",(function(e,i){if(-1!==t.inArray(e,s)){i=i||{};var n=t.Event("select2:"+e,{params:i});a.$element.trigger(n),-1!==t.inArray(e,o)&&(i.prevented=n.isDefaultPrevented())}}))},e})),e.define("select2/translation",["jquery","require"],(function(t,e){function i(t){this.dict=t||{}}return i.prototype.all=function(){return this.dict},i.prototype.get=function(t){return this.dict[t]},i.prototype.extend=function(e){this.dict=t.extend({},e.all(),this.dict)},i._cache={},i.loadPath=function(t){if(!(t in i._cache)){var n=e(t);i._cache[t]=n}return new i(i._cache[t])},i})),e.define("select2/diacritics",[],(function(){return{"":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"AA","":"AE","":"AE","":"AE","":"AO","":"AU","":"AV","":"AV","":"AY","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"DZ","":"DZ","":"Dz","":"Dz","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"F","":"F","":"F","":"F","":"F","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"J","":"J","":"J","":"J","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"LJ","":"Lj","":"M","":"M","":"M","":"M","":"M","":"M","":"M","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"NJ","":"Nj","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"OI","":"OO","":"OU","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"Q","":"Q","":"Q","":"Q","":"Q","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"TZ","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"VY","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"X","":"X","":"X","":"X","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"aa","":"ae","":"ae","":"ae","":"ao","":"au","":"av","":"av","":"ay","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"dz","":"dz","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"f","":"f","":"f","":"f","":"f","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"hv","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"j","":"j","":"j","":"j","":"j","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"lj","":"m","":"m","":"m","":"m","":"m","":"m","":"m","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"nj","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"oi","":"ou","":"oo","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"q","":"q","":"q","":"q","":"q","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"tz","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"vy","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"x","":"x","":"x","":"x","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""}})),e.define("select2/data/base",["../utils"],(function(t){function e(t,i){e.__super__.constructor.call(this)}return t.Extend(e,t.Observable),e.prototype.current=function(t){throw new Error("The `current` method must be defined in child classes.")},e.prototype.query=function(t,e){throw new Error("The `query` method must be defined in child classes.")},e.prototype.bind=function(t,e){},e.prototype.destroy=function(){},e.prototype.generateResultId=function(e,i){var n=e.id+"-result-";return n+=t.generateChars(4),null!=i.id?n+="-"+i.id.toString():n+="-"+t.generateChars(4),n},e})),e.define("select2/data/select",["./base","../utils","jquery"],(function(t,e,i){function n(t,e){this.$element=t,this.options=e,n.__super__.constructor.call(this)}return e.Extend(n,t),n.prototype.current=function(t){var e=[],n=this;this.$element.find(":selected").each((function(){var t=i(this),a=n.item(t);e.push(a)})),t(e)},n.prototype.select=function(t){var e=this;if(t.selected=!0,i(t.element).is("option"))return t.element.selected=!0,void this.$element.trigger("change");if(this.$element.prop("multiple"))this.current((function(n){var a=[];(t=[t]).push.apply(t,n);for(var s=0;s<t.length;s++){var o=t[s].id;-1===i.inArray(o,a)&&a.push(o)}e.$element.val(a),e.$element.trigger("change")}));else{var n=t.id;this.$element.val(n),this.$element.trigger("change")}},n.prototype.unselect=function(t){var e=this;if(this.$element.prop("multiple")){if(t.selected=!1,i(t.element).is("option"))return t.element.selected=!1,void this.$element.trigger("change");this.current((function(n){for(var a=[],s=0;s<n.length;s++){var o=n[s].id;o!==t.id&&-1===i.inArray(o,a)&&a.push(o)}e.$element.val(a),e.$element.trigger("change")}))}},n.prototype.bind=function(t,e){var i=this;this.container=t,t.on("select",(function(t){i.select(t.data)})),t.on("unselect",(function(t){i.unselect(t.data)}))},n.prototype.destroy=function(){this.$element.find("*").each((function(){i.removeData(this,"data")}))},n.prototype.query=function(t,e){var n=[],a=this;this.$element.children().each((function(){var e=i(this);if(e.is("option")||e.is("optgroup")){var s=a.item(e),o=a.matches(t,s);null!==o&&n.push(o)}})),e({results:n})},n.prototype.addOptions=function(t){e.appendMany(this.$element,t)},n.prototype.option=function(t){var e;t.children?(e=document.createElement("optgroup")).label=t.text:void 0!==(e=document.createElement("option")).textContent?e.textContent=t.text:e.innerText=t.text,t.id&&(e.value=t.id),t.disabled&&(e.disabled=!0),t.selected&&(e.selected=!0),t.title&&(e.title=t.title);var n=i(e),a=this._normalizeItem(t);return a.element=e,i.data(e,"data",a),n},n.prototype.item=function(t){var e={};if(null!=(e=i.data(t[0],"data")))return e;if(t.is("option"))e={id:t.val(),text:t.text(),disabled:t.prop("disabled"),selected:t.prop("selected"),title:t.prop("title")};else if(t.is("optgroup")){e={text:t.prop("label"),children:[],title:t.prop("title")};for(var n=t.children("option"),a=[],s=0;s<n.length;s++){var o=i(n[s]),r=this.item(o);a.push(r)}e.children=a}return(e=this._normalizeItem(e)).element=t[0],i.data(t[0],"data",e),e},n.prototype._normalizeItem=function(t){i.isPlainObject(t)||(t={id:t,text:t});return null!=(t=i.extend({},{text:""},t)).id&&(t.id=t.id.toString()),null!=t.text&&(t.text=t.text.toString()),null==t._resultId&&t.id&&null!=this.container&&(t._resultId=this.generateResultId(this.container,t)),i.extend({},{selected:!1,disabled:!1},t)},n.prototype.matches=function(t,e){return this.options.get("matcher")(t,e)},n})),e.define("select2/data/array",["./select","../utils","jquery"],(function(t,e,i){function n(t,e){var i=e.get("data")||[];n.__super__.constructor.call(this,t,e),this.addOptions(this.convertToOptions(i))}return e.Extend(n,t),n.prototype.select=function(t){var e=this.$element.find("option").filter((function(e,i){return i.value==t.id.toString()}));0===e.length&&(e=this.option(t),this.addOptions(e)),n.__super__.select.call(this,t)},n.prototype.convertToOptions=function(t){var n=this,a=this.$element.find("option"),s=a.map((function(){return n.item(i(this)).id})).get(),o=[];function r(t){return function(){return i(this).val()==t.id}}for(var l=0;l<t.length;l++){var c=this._normalizeItem(t[l]);if(i.inArray(c.id,s)>=0){var d=a.filter(r(c)),u=this.item(d),h=(i.extend(!0,{},u,c),this.option(u));d.replaceWith(h)}else{var p=this.option(c);if(c.children){var f=this.convertToOptions(c.children);e.appendMany(p,f)}o.push(p)}}return o},n})),e.define("select2/data/ajax",["./array","../utils","jquery"],(function(t,e,i){function n(e,i){this.ajaxOptions=this._applyDefaults(i.get("ajax")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),t.__super__.constructor.call(this,e,i)}return e.Extend(n,t),n.prototype._applyDefaults=function(t){var e={data:function(t){return{q:t.term}},transport:function(t,e,n){var a=i.ajax(t);return a.then(e),a.fail(n),a}};return i.extend({},e,t,!0)},n.prototype.processResults=function(t){return t},n.prototype.query=function(t,e){var n=this;null!=this._request&&(i.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var a=i.extend({type:"GET"},this.ajaxOptions);function s(){var s=a.transport(a,(function(a){var s=n.processResults(a,t);n.options.get("debug")&&window.console&&console.error&&(s&&s.results&&i.isArray(s.results)||console.error("Select2: The AJAX results did not return an array in the `results` key of the response.")),e(s)}),(function(){}));n._request=s}"function"==typeof a.url&&(a.url=a.url(t)),"function"==typeof a.data&&(a.data=a.data(t)),this.ajaxOptions.delay&&""!==t.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(s,this.ajaxOptions.delay)):s()},n})),e.define("select2/data/tags",["jquery"],(function(t){function e(e,i,n){var a=n.get("tags"),s=n.get("createTag");if(void 0!==s&&(this.createTag=s),e.call(this,i,n),t.isArray(a))for(var o=0;o<a.length;o++){var r=a[o],l=this._normalizeItem(r),c=this.option(l);this.$element.append(c)}}return e.prototype.query=function(t,e,i){var n=this;this._removeOldTags(),null!=e.term&&null==e.page?t.call(this,e,(function t(a,s){for(var o=a.results,r=0;r<o.length;r++){var l=o[r],c=null!=l.children&&!t({results:l.children},!0);if(l.text===e.term||c)return!s&&(a.data=o,void i(a))}if(s)return!0;var d=n.createTag(e);if(null!=d){var u=n.option(d);u.attr("data-select2-tag",!0),n.addOptions([u]),n.insertTag(o,d)}a.results=o,i(a)})):t.call(this,e,i)},e.prototype.createTag=function(e,i){var n=t.trim(i.term);return""===n?null:{id:n,text:n}},e.prototype.insertTag=function(t,e,i){e.unshift(i)},e.prototype._removeOldTags=function(e){this._lastTag;this.$element.find("option[data-select2-tag]").each((function(){this.selected||t(this).remove()}))},e})),e.define("select2/data/tokenizer",["jquery"],(function(t){function e(t,e,i){var n=i.get("tokenizer");void 0!==n&&(this.tokenizer=n),t.call(this,e,i)}return e.prototype.bind=function(t,e,i){t.call(this,e,i),this.$search=e.dropdown.$search||e.selection.$search||i.find(".select2-search__field")},e.prototype.query=function(t,e,i){var n=this;e.term=e.term||"";var a=this.tokenizer(e,this.options,(function(t){n.select(t)}));a.term!==e.term&&(this.$search.length&&(this.$search.val(a.term),this.$search.focus()),e.term=a.term),t.call(this,e,i)},e.prototype.tokenizer=function(e,i,n,a){for(var s=n.get("tokenSeparators")||[],o=i.term,r=0,l=this.createTag||function(t){return{id:t.term,text:t.term}};r<o.length;){var c=o[r];if(-1!==t.inArray(c,s)){var d=o.substr(0,r);a(l(t.extend({},i,{term:d}))),o=o.substr(r+1)||"",r=0}else r++}return{term:o}},e})),e.define("select2/data/minimumInputLength",[],(function(){function t(t,e,i){this.minimumInputLength=i.get("minimumInputLength"),t.call(this,e,i)}return t.prototype.query=function(t,e,i){e.term=e.term||"",e.term.length<this.minimumInputLength?this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:e.term,params:e}}):t.call(this,e,i)},t})),e.define("select2/data/maximumInputLength",[],(function(){function t(t,e,i){this.maximumInputLength=i.get("maximumInputLength"),t.call(this,e,i)}return t.prototype.query=function(t,e,i){e.term=e.term||"",this.maximumInputLength>0&&e.term.length>this.maximumInputLength?this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:e.term,params:e}}):t.call(this,e,i)},t})),e.define("select2/data/maximumSelectionLength",[],(function(){function t(t,e,i){this.maximumSelectionLength=i.get("maximumSelectionLength"),t.call(this,e,i)}return t.prototype.query=function(t,e,i){var n=this;this.current((function(a){var s=null!=a?a.length:0;n.maximumSelectionLength>0&&s>=n.maximumSelectionLength?n.trigger("results:message",{message:"maximumSelected",args:{maximum:n.maximumSelectionLength}}):t.call(n,e,i)}))},t})),e.define("select2/dropdown",["jquery","./utils"],(function(t,e){function i(t,e){this.$element=t,this.options=e,i.__super__.constructor.call(this)}return e.Extend(i,e.Observable),i.prototype.render=function(){var e=t('<span class="select2-dropdown"><span class="select2-results"></span></span>');return e.attr("dir",this.options.get("dir")),this.$dropdown=e,e},i.prototype.position=function(t,e){},i.prototype.destroy=function(){this.$dropdown.remove()},i})),e.define("select2/dropdown/search",["jquery","../utils"],(function(t,e){function i(){}return i.prototype.render=function(e){var i=e.call(this),n=t('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /></span>');return this.$searchContainer=n,this.$search=n.find("input"),i.prepend(n),i},i.prototype.bind=function(e,i,n){var a=this;e.call(this,i,n),this.$search.on("keydown",(function(t){a.trigger("keypress",t),a._keyUpPrevented=t.isDefaultPrevented()})),this.$search.on("input",(function(e){t(this).off("keyup")})),this.$search.on("keyup input",(function(t){a.handleSearch(t)})),i.on("open",(function(){a.$search.attr("tabindex",0),a.$search.focus(),window.setTimeout((function(){a.$search.focus()}),0)})),i.on("close",(function(){a.$search.attr("tabindex",-1),a.$search.val("")})),i.on("results:all",(function(t){null!=t.query.term&&""!==t.query.term||(a.showSearch(t)?a.$searchContainer.removeClass("select2-search--hide"):a.$searchContainer.addClass("select2-search--hide"))}))},i.prototype.handleSearch=function(t){if(!this._keyUpPrevented){var e=this.$search.val();this.trigger("query",{term:e})}this._keyUpPrevented=!1},i.prototype.showSearch=function(t,e){return!0},i})),e.define("select2/dropdown/hidePlaceholder",[],(function(){function t(t,e,i,n){this.placeholder=this.normalizePlaceholder(i.get("placeholder")),t.call(this,e,i,n)}return t.prototype.append=function(t,e){e.results=this.removePlaceholder(e.results),t.call(this,e)},t.prototype.normalizePlaceholder=function(t,e){return"string"==typeof e&&(e={id:"",text:e}),e},t.prototype.removePlaceholder=function(t,e){for(var i=e.slice(0),n=e.length-1;n>=0;n--){var a=e[n];this.placeholder.id===a.id&&i.splice(n,1)}return i},t})),e.define("select2/dropdown/infiniteScroll",["jquery"],(function(t){function e(t,e,i,n){this.lastParams={},t.call(this,e,i,n),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return e.prototype.append=function(t,e){this.$loadingMore.remove(),this.loading=!1,t.call(this,e),this.showLoadingMore(e)&&this.$results.append(this.$loadingMore)},e.prototype.bind=function(e,i,n){var a=this;e.call(this,i,n),i.on("query",(function(t){a.lastParams=t,a.loading=!0})),i.on("query:append",(function(t){a.lastParams=t,a.loading=!0})),this.$results.on("scroll",(function(){var e=t.contains(document.documentElement,a.$loadingMore[0]);!a.loading&&e&&(a.$results.offset().top+a.$results.outerHeight(!1)+50>=a.$loadingMore.offset().top+a.$loadingMore.outerHeight(!1)&&a.loadMore())}))},e.prototype.loadMore=function(){this.loading=!0;var e=t.extend({},{page:1},this.lastParams);e.page++,this.trigger("query:append",e)},e.prototype.showLoadingMore=function(t,e){return e.pagination&&e.pagination.more},e.prototype.createLoadingMore=function(){var e=t('<li class="option load-more" role="treeitem"></li>'),i=this.options.get("translations").get("loadingMore");return e.html(i(this.lastParams)),e},e})),e.define("select2/dropdown/attachBody",["jquery","../utils"],(function(t,e){function i(t,e,i){this.$dropdownParent=i.get("dropdownParent")||document.body,t.call(this,e,i)}return i.prototype.bind=function(t,e,i){var n=this,a=!1;t.call(this,e,i),e.on("open",(function(){n._showDropdown(),n._attachPositioningHandler(e),a||(a=!0,e.on("results:all",(function(){n._positionDropdown(),n._resizeDropdown()})),e.on("results:append",(function(){n._positionDropdown(),n._resizeDropdown()})))})),e.on("close",(function(){n._hideDropdown(),n._detachPositioningHandler(e)})),this.$dropdownContainer.on("mousedown",(function(t){t.stopPropagation()}))},i.prototype.position=function(t,e,i){e.attr("class",i.attr("class")),e.removeClass("select2"),e.addClass("select2-container--open"),e.css({position:"absolute",top:-999999}),this.$container=i},i.prototype.render=function(e){var i=t("<span></span>"),n=e.call(this);return i.append(n),this.$dropdownContainer=i,i},i.prototype._hideDropdown=function(t){this.$dropdownContainer.detach()},i.prototype._attachPositioningHandler=function(i){var n=this,a="scroll.select2."+i.id,s="resize.select2."+i.id,o="orientationchange.select2."+i.id,r=this.$container.parents().filter(e.hasScroll);r.each((function(){t(this).data("select2-scroll-position",{x:t(this).scrollLeft(),y:t(this).scrollTop()})})),r.on(a,(function(e){var i=t(this).data("select2-scroll-position");t(this).scrollTop(i.y)})),t(window).on(a+" "+s+" "+o,(function(t){n._positionDropdown(),n._resizeDropdown()}))},i.prototype._detachPositioningHandler=function(i){var n="scroll.select2."+i.id,a="resize.select2."+i.id,s="orientationchange.select2."+i.id;this.$container.parents().filter(e.hasScroll).off(n),t(window).off(n+" "+a+" "+s)},i.prototype._positionDropdown=function(){var e=t(window),i=this.$dropdown.hasClass("select2-dropdown--above"),n=this.$dropdown.hasClass("select2-dropdown--below"),a=null,s=(this.$container.position(),this.$container.offset());s.bottom=s.top+this.$container.outerHeight(!1);var o={height:this.$container.outerHeight(!1)};o.top=s.top,o.bottom=s.top+o.height;var r=this.$dropdown.outerHeight(!1),l=e.scrollTop(),c=e.scrollTop()+e.height(),d=l<s.top-r,u=c>s.bottom+r,h={left:s.left,top:o.bottom};i||n||(a="below"),u||!d||i?!d&&u&&i&&(a="below"):a="above",("above"==a||i&&"below"!==a)&&(h.top=o.top-r),null!=a&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+a),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+a)),this.$dropdownContainer.css(h)},i.prototype._resizeDropdown=function(){this.$dropdownContainer.width();var t={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(t.minWidth=t.width,t.width="auto"),this.$dropdown.css(t)},i.prototype._showDropdown=function(t){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},i})),e.define("select2/dropdown/minimumResultsForSearch",[],(function(){function t(e){for(var i=0,n=0;n<e.length;n++){var a=e[n];a.children?i+=t(a.children):i++}return i}function e(t,e,i,n){this.minimumResultsForSearch=i.get("minimumResultsForSearch"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=1/0),t.call(this,e,i,n)}return e.prototype.showSearch=function(e,i){return!(t(i.data.results)<this.minimumResultsForSearch)&&e.call(this,i)},e})),e.define("select2/dropdown/selectOnClose",[],(function(){function t(){}return t.prototype.bind=function(t,e,i){var n=this;t.call(this,e,i),e.on("close",(function(){n._handleSelectOnClose()}))},t.prototype._handleSelectOnClose=function(){var t=this.getHighlightedResults();t.length<1||this.trigger("select",{data:t.data("data")})},t})),e.define("select2/dropdown/closeOnSelect",[],(function(){function t(){}return t.prototype.bind=function(t,e,i){var n=this;t.call(this,e,i),e.on("select",(function(t){n._selectTriggered(t)})),e.on("unselect",(function(t){n._selectTriggered(t)}))},t.prototype._selectTriggered=function(t,e){var i=e.originalEvent;i&&i.ctrlKey||this.trigger("close")},t})),e.define("select2/i18n/en",[],(function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(t){var e=t.input.length-t.maximum,i="Please delete "+e+" character";return 1!=e&&(i+="s"),i},inputTooShort:function(t){return"Please enter "+(t.minimum-t.input.length)+" or more characters"},loadingMore:function(){return"Loading more results"},maximumSelected:function(t){var e="You can only select "+t.maximum+" item";return 1!=t.maximum&&(e+="s"),e},noResults:function(){return"No results found"},searching:function(){return"Searching"}}})),e.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],(function(t,e,i,n,a,s,o,r,l,c,d,u,h,p,f,m,g,v,b,y,_,x,w,C,k,$,S,T,I){function D(){this.reset()}return D.prototype.apply=function(u){if(null==(u=t.extend({},this.defaults,u)).dataAdapter){if(null!=u.ajax?u.dataAdapter=f:null!=u.data?u.dataAdapter=p:u.dataAdapter=h,u.minimumInputLength>0&&(u.dataAdapter=c.Decorate(u.dataAdapter,v)),u.maximumInputLength>0&&(u.dataAdapter=c.Decorate(u.dataAdapter,b)),u.maximumSelectionLength>0&&(u.dataAdapter=c.Decorate(u.dataAdapter,y)),u.tags&&(u.dataAdapter=c.Decorate(u.dataAdapter,m)),null==u.tokenSeparators&&null==u.tokenizer||(u.dataAdapter=c.Decorate(u.dataAdapter,g)),null!=u.query){var I=e(u.amdBase+"compat/query");u.dataAdapter=c.Decorate(u.dataAdapter,I)}if(null!=u.initSelection){var D=e(u.amdBase+"compat/initSelection");u.dataAdapter=c.Decorate(u.dataAdapter,D)}}if(null==u.resultsAdapter&&(u.resultsAdapter=i,null!=u.ajax&&(u.resultsAdapter=c.Decorate(u.resultsAdapter,C)),null!=u.placeholder&&(u.resultsAdapter=c.Decorate(u.resultsAdapter,w)),u.selectOnClose&&(u.resultsAdapter=c.Decorate(u.resultsAdapter,S))),null==u.dropdownAdapter){if(u.multiple)u.dropdownAdapter=_;else{var A=c.Decorate(_,x);u.dropdownAdapter=A}if(0!==u.minimumResultsForSearch&&(u.dropdownAdapter=c.Decorate(u.dropdownAdapter,$)),u.closeOnSelect&&(u.dropdownAdapter=c.Decorate(u.dropdownAdapter,T)),null!=u.dropdownCssClass||null!=u.dropdownCss||null!=u.adaptDropdownCssClass){var P=e(u.amdBase+"compat/dropdownCss");u.dropdownAdapter=c.Decorate(u.dropdownAdapter,P)}u.dropdownAdapter=c.Decorate(u.dropdownAdapter,k)}if(null==u.selectionAdapter){if(u.multiple?u.selectionAdapter=a:u.selectionAdapter=n,null!=u.placeholder&&(u.selectionAdapter=c.Decorate(u.selectionAdapter,s)),u.allowClear&&(u.selectionAdapter=c.Decorate(u.selectionAdapter,o)),u.multiple&&(u.selectionAdapter=c.Decorate(u.selectionAdapter,r)),null!=u.containerCssClass||null!=u.containerCss||null!=u.adaptContainerCssClass){var O=e(u.amdBase+"compat/containerCss");u.selectionAdapter=c.Decorate(u.selectionAdapter,O)}u.selectionAdapter=c.Decorate(u.selectionAdapter,l)}if("string"==typeof u.language)if(u.language.indexOf("-")>0){var E=u.language.split("-")[0];u.language=[u.language,E]}else u.language=[u.language];if(t.isArray(u.language)){var M=new d;u.language.push("en");for(var L=u.language,j=0;j<L.length;j++){var R=L[j],N={};try{N=d.loadPath(R)}catch(t){try{R=this.defaults.amdLanguageBase+R,N=d.loadPath(R)}catch(t){u.debug&&window.console&&console.warn&&console.warn('Select2: The language file for "'+R+'" could not be automatically loaded. A fallback will be used instead.');continue}}M.extend(N)}u.translations=M}else{var B=d.loadPath(this.defaults.amdLanguageBase+"en"),F=new d(u.language);F.extend(B),u.translations=F}return u},D.prototype.reset=function(){function e(t){return t.replace(/[^\u0000-\u007E]/g,(function(t){return u[t]||t}))}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:c.escapeMarkup,language:I,matcher:function i(n,a){if(""===t.trim(n.term))return a;if(a.children&&a.children.length>0){for(var s=t.extend(!0,{},a),o=a.children.length-1;o>=0;o--){null==i(n,a.children[o])&&s.children.splice(o,1)}return s.children.length>0?s:i(n,s)}var r=e(a.text).toUpperCase(),l=e(n.term).toUpperCase();return r.indexOf(l)>-1?a:null},minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,sorter:function(t){return t},templateResult:function(t){return t.text},templateSelection:function(t){return t.text},theme:"default",width:"resolve"}},D.prototype.set=function(e,i){var n={};n[t.camelCase(e)]=i;var a=c._convertData(n);t.extend(this.defaults,a)},new D})),e.define("select2/options",["require","jquery","./defaults","./utils"],(function(t,e,i,n){function a(e,a){if(this.options=e,null!=a&&this.fromElement(a),this.options=i.apply(this.options),a&&a.is("input")){var s=t(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=n.Decorate(this.options.dataAdapter,s)}}return a.prototype.fromElement=function(t){var i=["select2"];null==this.options.multiple&&(this.options.multiple=t.prop("multiple")),null==this.options.disabled&&(this.options.disabled=t.prop("disabled")),null==this.options.language&&(t.prop("lang")?this.options.language=t.prop("lang").toLowerCase():t.closest("[lang]").prop("lang")&&(this.options.language=t.closest("[lang]").prop("lang"))),null==this.options.dir&&(t.prop("dir")?this.options.dir=t.prop("dir"):t.closest("[dir]").prop("dir")?this.options.dir=t.closest("[dir]").prop("dir"):this.options.dir="ltr"),t.prop("disabled",this.options.disabled),t.prop("multiple",this.options.multiple),t.data("select2Tags")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.'),t.data("data",t.data("select2Tags")),t.data("tags",!0)),t.data("ajaxUrl")&&(this.options.debug&&window.console&&console.warn&&console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2."),t.attr("ajax--url",t.data("ajaxUrl")),t.data("ajax--url",t.data("ajaxUrl")));var a={};a=e.fn.jquery&&"1."==e.fn.jquery.substr(0,2)&&t[0].dataset?e.extend(!0,{},t[0].dataset,t.data()):t.data();var s=e.extend(!0,{},a);for(var o in s=n._convertData(s))e.inArray(o,i)>-1||(e.isPlainObject(this.options[o])?e.extend(this.options[o],s[o]):this.options[o]=s[o]);return this},a.prototype.get=function(t){return this.options[t]},a.prototype.set=function(t,e){this.options[t]=e},a})),e.define("select2/core",["jquery","./options","./utils","./keys"],(function(t,e,i,n){var a=function(t,i){null!=t.data("select2")&&t.data("select2").destroy(),this.$element=t,this.id=this._generateId(t),i=i||{},this.options=new e(i,t),a.__super__.constructor.call(this);var n=t.attr("tabindex")||0;t.data("old-tabindex",n),t.attr("tabindex","-1");var s=this.options.get("dataAdapter");this.dataAdapter=new s(t,this.options);var o=this.render();this._placeContainer(o);var r=this.options.get("selectionAdapter");this.selection=new r(t,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,o);var l=this.options.get("dropdownAdapter");this.dropdown=new l(t,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,o);var c=this.options.get("resultsAdapter");this.results=new c(t,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var d=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current((function(t){d.trigger("selection:update",{data:t})})),t.addClass("select2-hidden-accessible"),t.attr("aria-hidden","true"),this._syncAttributes(),t.data("select2",this)};return i.Extend(a,i.Observable),a.prototype._generateId=function(t){return"select2-"+(null!=t.attr("id")?t.attr("id"):null!=t.attr("name")?t.attr("name")+"-"+i.generateChars(2):i.generateChars(4))},a.prototype._placeContainer=function(t){t.insertAfter(this.$element);var e=this._resolveWidth(this.$element,this.options.get("width"));null!=e&&t.css("width",e)},a.prototype._resolveWidth=function(t,e){var i=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if("resolve"==e){var n=this._resolveWidth(t,"style");return null!=n?n:this._resolveWidth(t,"element")}if("element"==e){var a=t.outerWidth(!1);return a<=0?"auto":a+"px"}if("style"==e){var s=t.attr("style");if("string"!=typeof s)return null;for(var o=s.split(";"),r=0,l=o.length;r<l;r+=1){var c=o[r].replace(/\s/g,"").match(i);if(null!==c&&c.length>=1)return c[1]}return null}return e},a.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},a.prototype._registerDomEvents=function(){var e=this;this.$element.on("change.select2",(function(){e.dataAdapter.current((function(t){e.trigger("selection:update",{data:t})}))})),this._sync=i.bind(this._syncAttributes,this),this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._sync);var n=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=n?(this._observer=new n((function(i){t.each(i,e._sync)})),this._observer.observe(this.$element[0],{attributes:!0,subtree:!1})):this.$element[0].addEventListener&&this.$element[0].addEventListener("DOMAttrModified",e._sync,!1)},a.prototype._registerDataEvents=function(){var t=this;this.dataAdapter.on("*",(function(e,i){t.trigger(e,i)}))},a.prototype._registerSelectionEvents=function(){var e=this,i=["toggle"];this.selection.on("toggle",(function(){e.toggleDropdown()})),this.selection.on("*",(function(n,a){-1===t.inArray(n,i)&&e.trigger(n,a)}))},a.prototype._registerDropdownEvents=function(){var t=this;this.dropdown.on("*",(function(e,i){t.trigger(e,i)}))},a.prototype._registerResultsEvents=function(){var t=this;this.results.on("*",(function(e,i){t.trigger(e,i)}))},a.prototype._registerEvents=function(){var t=this;this.on("open",(function(){t.$container.addClass("select2-container--open")})),this.on("close",(function(){t.$container.removeClass("select2-container--open")})),this.on("enable",(function(){t.$container.removeClass("select2-container--disabled")})),this.on("disable",(function(){t.$container.addClass("select2-container--disabled")})),this.on("focus",(function(){t.$container.addClass("select2-container--focus")})),this.on("blur",(function(){t.$container.removeClass("select2-container--focus")})),this.on("query",(function(e){t.isOpen()||t.trigger("open"),this.dataAdapter.query(e,(function(i){t.trigger("results:all",{data:i,query:e})}))})),this.on("query:append",(function(e){this.dataAdapter.query(e,(function(i){t.trigger("results:append",{data:i,query:e})}))})),this.on("keypress",(function(e){var i=e.which;t.isOpen()?i===n.ENTER?(t.trigger("results:select"),e.preventDefault()):i===n.SPACE&&e.ctrlKey?(t.trigger("results:toggle"),e.preventDefault()):i===n.UP?(t.trigger("results:previous"),e.preventDefault()):i===n.DOWN?(t.trigger("results:next"),e.preventDefault()):i!==n.ESC&&i!==n.TAB||(t.close(),e.preventDefault()):(i===n.ENTER||i===n.SPACE||(i===n.DOWN||i===n.UP)&&e.altKey)&&(t.open(),e.preventDefault())}))},a.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled")),this.options.get("disabled")?(this.isOpen()&&this.close(),this.trigger("disable")):this.trigger("enable")},a.prototype.trigger=function(t,e){var i=a.__super__.trigger,n={open:"opening",close:"closing",select:"selecting",unselect:"unselecting"};if(t in n){var s=n[t],o={prevented:!1,name:t,args:e};if(i.call(this,s,o),o.prevented)return void(e.prevented=!0)}i.call(this,t,e)},a.prototype.toggleDropdown=function(){this.options.get("disabled")||(this.isOpen()?this.close():this.open())},a.prototype.open=function(){this.isOpen()||(this.trigger("query",{}),this.trigger("open"))},a.prototype.close=function(){this.isOpen()&&this.trigger("close")},a.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},a.prototype.enable=function(t){this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.'),null!=t&&0!==t.length||(t=[!0]);var e=!t[0];this.$element.prop("disabled",e)},a.prototype.data=function(){this.options.get("debug")&&arguments.length>0&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.');var t=[];return this.dataAdapter.current((function(e){t=e})),t},a.prototype.val=function(e){if(this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),null==e||0===e.length)return this.$element.val();var i=e[0];t.isArray(i)&&(i=t.map(i,(function(t){return t.toString()}))),this.$element.val(i).trigger("change")},a.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._sync),null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&this.$element[0].removeEventListener("DOMAttrModified",this._sync,!1),this._sync=null,this.$element.off(".select2"),this.$element.attr("tabindex",this.$element.data("old-tabindex")),this.$element.removeClass("select2-hidden-accessible"),this.$element.attr("aria-hidden","false"),this.$element.removeData("select2"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null},a.prototype.render=function(){var e=t('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return e.attr("dir",this.options.get("dir")),this.$container=e,this.$container.addClass("select2-container--"+this.options.get("theme")),e.data("element",this.$element),e},a})),e.define("jquery.select2",["jquery","require","./select2/core","./select2/defaults"],(function(t,e,i,n){if(e("jquery.mousewheel"),null==t.fn.select2){var a=["open","close","destroy"];t.fn.select2=function(e){if("object"==typeof(e=e||{}))return this.each((function(){var n=t.extend({},e,!0);new i(t(this),n)})),this;if("string"==typeof e){var n=this.data("select2");null==n&&window.console&&console.error&&console.error("The select2('"+e+"') method was called on an element that is not using Select2.");var s=Array.prototype.slice.call(arguments,1),o=n[e](s);return t.inArray(e,a)>-1?this:o}throw new Error("Invalid arguments for Select2: "+e)}}return null==t.fn.select2.defaults&&(t.fn.select2.defaults=n),i})),e.define("jquery.mousewheel",["jquery"],(function(t){return t})),{define:e.define,require:e.require}}(),i=e.require("jquery.select2");return t.fn.select2.amd=e,i}));var Spinners={version:"3.0.0"},elem,messageId,senderId;function reloadRightmenu(t){$.get(t,{},displayRightmenu)}function displayRightmenu(t){$("#rechts").replaceWith(t),initPlanetSorting()}function ajaxFormSubmit(t,e,i,n){var a=$("#"+t).serialize();if("object"==typeof n)for(var s in n)n.hasOwnProperty(s)&&(a+="&"+s+"="+n[s]);var o=null;null!=i&&"function"==typeof i&&(o=i),$.ajax({type:"POST",url:e,data:a,success:o})}function initConnectionErrorFunction(){isMobile&&document.addEventListener("deviceready",(function(){$(document).ajaxError((function(t,e,i,n){HostApp.ShowNoConnectionScreen()}))}),!1)}function initAllianceInfo(){initConnectionErrorFunction(),initTooltips(),initOverlays(),initHideElements()}function initBBCodeEditor(t,e,i,n,a,s){var o;if(0!=(o=void 0===n||null==n?$("textarea:not(.markItUpEditor)"):$(n).filter(":not(.markItUpEditor)")).length){i=i||!1;for(var r=[],l=6;l<=30;l+=2)r.push({name:l,openWith:"[size="+l+"]",closeWith:"[/size]",placeHolder:"Text",className:"fontSize"+l});var c=[];$.each(e,(function(t,e){c.push({name:e,replaceWith:"[item]"+t+"[/item]"})}));var d=s?[{name:t.bold,key:"B",openWith:"[b]",closeWith:"[/b]",className:"bold"},{name:t.italic,key:"I",openWith:"[i]",closeWith:"[/i]",className:"italic"},{name:t.fontColor,afterInsert:f,openWith:"[color=%colorCode%]",closeWith:"[/color]",placeHolder:t.textPlaceHolder,className:"fontColor"},{name:t.fontSize,className:"fontSize",dropMenu:r},{name:t.list,openWith:"[*]",multiline:!0,openBlockWith:"[list]\n",closeBlockWith:"\n[/list]",className:"list",afterMultiInsert:p,placeHolder:t.textPlaceHolder},{name:t.coordinates,openWith:"[coordinates]",closeWith:"[/coordinates]",placeHolder:t.coordinatePlaceHolder,className:"coordinates"}]:[{name:t.bold,key:"B",openWith:"[b]",closeWith:"[/b]",className:"bold"},{name:t.italic,key:"I",openWith:"[i]",closeWith:"[/i]",className:"italic"},{name:t.fontColor,afterInsert:f,openWith:"[color=%colorCode%]",closeWith:"[/color]",placeHolder:t.textPlaceHolder,className:"fontColor"},{name:t.fontSize,className:"fontSize",dropMenu:r},{name:t.list,openWith:"[*]",multiline:!0,openBlockWith:"[list]\n",closeBlockWith:"\n[/list]",className:"list",afterMultiInsert:p,placeHolder:t.textPlaceHolder},{name:t.link,key:"L",openWith:"[url=[!["+t.link+":!:http://]!]]",closeWith:"[/url]",placeHolder:t.textPlaceHolder,className:"link"},{name:t.coordinates,openWith:"[coordinates]",closeWith:"[/coordinates]",placeHolder:t.coordinatePlaceHolder,className:"coordinates"}],u=s?[{name:t.underline,key:"U",openWith:"[u]",closeWith:"[/u]",className:"underline"},{name:t.stroke,key:"S",openWith:"[s]",closeWith:"[/s]",className:"strikeThrough"},{name:t.sub,openWith:"[sub]",closeWith:"[/sub]",className:"sub"},{name:t.sup,openWith:"[sup]",closeWith:"[/sup]",className:"sup"},{separator:"-"},{name:t.item,className:"item",dropMenu:c},{name:t.player,openWith:"[player]",closeWith:"[/player]",placeHolder:t.playerPlaceHolder,className:"player"},{separator:"-"},{name:t.alignLeft,openWith:"[align=left]",closeWith:"[/align]",className:"leftAlign"},{name:t.alignCenter,openWith:"[align=center]",closeWith:"[/align]",className:"centerAlign"},{name:t.alignRight,openWith:"[align=right]",closeWith:"[/align]",className:"rightAlign"},{name:t.alignJustify,openWith:"[align=justify]",closeWith:"[/align]",className:"justifyAlign"},{separator:"-"},{name:t.code,openWith:"[code]",closeWith:"[/code]",className:"code"},{separator:"-"},{name:t.email,key:"E",openWith:"[email=[!["+t.email+":!:]!]]",closeWith:"[/email]",placeHolder:t.textPlaceHolder,className:"email"},{name:t.preview,className:"preview",call:"preview"}]:[{name:t.underline,key:"U",openWith:"[u]",closeWith:"[/u]",className:"underline"},{name:t.stroke,key:"S",openWith:"[s]",closeWith:"[/s]",className:"strikeThrough"},{name:t.sub,openWith:"[sub]",closeWith:"[/sub]",className:"sub"},{name:t.sup,openWith:"[sup]",closeWith:"[/sup]",className:"sup"},{name:t.backgroundColor,afterInsert:f,openWith:"[background color=%colorCode%]",closeWith:"[/background]",placeHolder:t.textPlaceHolder,className:"backgroundColor"},{name:t.backgroundImage,afterInsert:function(e){var i=$(e.textarea),n=i.getSelection(),a=e.openWith,s=$("#backgroundImagePicker");s.is(":visible")&&s.dialog("close"),s.find("input:checked").prop("checked",!1),s.find(".url").val("http://").focus(),openOverlay(s,{type:"inline",title:t.backgroundImage,close:function(){var t=s.find(".url").val(),e=s.find(".repeatX:checked").length,o=s.find(".repeatY:checked").length,r="";e&&o?r="yes":e?r="yes-x":o&&(r="yes-y"),r.length&&(t+=" image-repeat="+r);var l=a.replace(/%image%/,t),c=7-t.length;n.start=n.start-c,n.end=n.end-c,i.val(i.val().replace(a,l)).setSelection(n)}});var o=i.siblings(".markItUpHeader").find("."+e.className);return s.parent().css("top",o.offset().top+o.height()).css("left",o.offset().left),e},openWith:"[background image=%image%]",closeWith:"[/background]",placeHolder:t.textPlaceHolder,className:"backgroundImage"},{separator:"-"},{name:t.item,className:"item",dropMenu:c},{name:t.player,openWith:"[player]",closeWith:"[/player]",placeHolder:t.playerPlaceHolder,className:"player"},{name:t.tooltip,openWith:'[tooltip position="top" text="[![Tooltip Text:!:Tooltip Text]!]"]',closeWith:"[/tooltip]",placeHolder:t.textPlaceHolder,className:"tooltip"},{separator:"-"},{name:t.alignLeft,openWith:"[align=left]",closeWith:"[/align]",className:"leftAlign"},{name:t.alignCenter,openWith:"[align=center]",closeWith:"[/align]",className:"centerAlign"},{name:t.alignRight,openWith:"[align=right]",closeWith:"[/align]",className:"rightAlign"},{name:t.alignJustify,openWith:"[align=justify]",closeWith:"[/align]",className:"justifyAlign"},{separator:"-"},{name:t.block,openWith:"[p]",closeWith:"[/p]",className:"block"},{name:t.code,openWith:"[code]",closeWith:"[/code]",className:"code"},{name:t.spoiler,openWith:"[spoiler]",closeWith:"[/spoiler]",className:"spoiler"},{separator:"-"},{name:t.hr,openWith:"[hr]",className:"hr"},{separator:"-"},{name:t.picture,key:"Z",replaceWith:"[img][!["+t.picture+":!:http://]!][/img]",className:"picture"},{name:t.email,key:"E",openWith:"[email=[!["+t.email+":!:]!]]",closeWith:"[/email]",placeHolder:t.textPlaceHolder,className:"email"},{name:t.preview,className:"preview",call:"preview"}];i||$.each(u,(function(t){"picture"!=this.className&&"backgroundImage"!=this.className||u.splice(t,1)})),isMobile&&($.each(d,(function(t){"fontColor"!=this.className&&"backgroundColor"!=this.className||d.splice(t,1)})),$.each(u,(function(t){"fontColor"!=this.className&&"backgroundColor"!=this.className||u.splice(t,1)})));var h={onShiftEnter:{keepDefault:!1,replaceWith:"\n"},onCtrlEnter:{keepDefault:!1,openWith:"\n[p]",closeWith:"[/p]"},onTab:{keepDefault:!1,replaceWith:"\t"},markupSet:[d,u],resizeHandle:!1,previewParserPath:bbcodePreviewUrl+"&imgAllowed="+(i?1:0),previewAutoRefresh:!0,previewParserVar:"text",previewInElement:$('<div class="miu_preview_container"></div>'),afterInsert:function(t){$(t.textarea).trigger("keyup")}};$.colorpicker.regional.custom=t.colorPicker,o.each((function(){var e=$(this);e.markItUp(h).after($('<input type="hidden" class="colorpicker"/>').colorpicker({color:"#000000",colorFormat:"#HEX",hsv:!1,parts:"popup",regional:"custom",showCancelButton:!1})),h.previewInElement.insertAfter(e),$(".miu_advanced .preview").hide();var i=$('<div class="miu_footer clearfix"></div>');i.append('<a role="button" class="fright txt_link btn_blue preview_link">'+t.preview+"</a>").append('<span class="fleft"><span class="cnt_chars">'+a+"</span> "+t.charsLeft+"</span>"),i.insertAfter(e),e.on("keyup.bbCodeEditor",(function(){e.val().length>a&&e.val(e.val().substr(0,a)),e.closest(".markItUpContainer").find(".cnt_chars").html(a-e.val().length)})),$(".miu_preview_container").hide(),$(".preview_link").on("click.bbCodeEditor",(function(){h.previewInElement.insertAfter($(event.target).closest(".markItUpContainer").find(".miu_footer")),$(event.target).closest(".markItUpContainer").find(".miu_preview_container").show(),$(event.target).closest(".markItUpContainer").find(".preview").click()})),isMobile?(e.siblings(".markItUpHeader").find("a").attr("title",""),e.siblings(".markItUpHeader").find("li:not(.markItUpDropMenu) a").bind("mouseup",(function(){e.focus()}))):e.siblings(".markItUpHeader").find("ul ul a").attr("title",""),0==$("#backgroundImagePicker").length&&($("body").append($('<div id="backgroundImagePicker" style="display: none;"><table><tr><td>'+t.backgroundImage+':</td><td><input type="text" class="url"/></td></tr><tr><td>'+t.backgroundImagePicker.repeatX+':</td><td><input type="checkbox" class="repeatX"/></td></tr><tr><td>'+t.backgroundImagePicker.repeatY+':</td><td><input type="checkbox" class="repeatY"/></td></tr></table><div><a href="javascript:void(0);" class="btn_blue">'+t.backgroundImagePicker.ok+"</a></div></div>")),$("#backgroundImagePicker").find("a").bind("click",(function(){$("#backgroundImagePicker").dialog("close")})))})),$(".toggle_miu_advanced").on("click.bbCodeEditor",(function(){$(".miu_advanced").is(":visible")?($(".miu_advanced").hide(),$(this).removeClass("hide_miu_advanced").addClass("show_miu_advanced")):($(".miu_advanced").show(),$(this).removeClass("show_miu_advanced").addClass("hide_miu_advanced"))}))}function p(t){if(0!=t.selection.length){var e=$(t.textarea),i=e.getSelection(),n=e.val().indexOf(t.openWith,i.start)+t.openWith.length,a={start:n,end:n+("string"==typeof t.placeHolder?t.placeHolder.length:0)};e.setSelection(a)}}function f(t){var e=t.openWith,i=$(t.textarea),n=i.getSelection();i.siblings(".colorpicker").val("").colorpicker("open").colorpicker("option","close",(function(t,a){var s=e.replace(/%colorCode%/,a.formatted),o=11-a.formatted.length;n.start=n.start-o,n.end=n.end-o,i.val(i.val().replace(e,s)).setSelection(n)}));var a=i.siblings(".markItUpHeader").find("."+t.className);return $(".ui-colorpicker:visible").css("top",a.offset().top+a.height()).css("left",a.offset().left),$(".ui-colorpicker").draggable(),$(".ui-colorpicker-rgb-r .ui-colorpicker-number").focus(),t}}function initBBCodes(){$(document).undelegate(".spoilerHeader","click").delegate(".spoilerHeader","click",(function(){var t=this;$(this).next(".spoilerText").toggle(0,(function(){Tipped.refresh(t)}))}))}function initInviteCodes(){$("#buddyinvite .code").click((function(){$(this).selectText()}))}function incrementBuddyCount(){var t=parseInt($("#buddyCount").text())+1;updateRequestCount(parseInt($("#newRequestCount").text())-1),updateBuddyCount(t)}function updateRequestCount(t){$("#newRequestCount").html(t)}function updateBuddyCount(t){$("#buddyCount").html(t)}function reportMessage(t,e,i){$.ajax({type:"POST",url:"?page=reportSpam_ajax",dataType:"json",data:{messageId:t,from:e,to:i},success:function(t){fadeBox(t.message,!t.result)},error:function(){}})}function reportAllyMessage(t,e){$.ajax({type:"POST",url:"?page=reportSpam_ajax",dataType:"json",data:{messageId:t,from:e},success:function(t){fadeBox(t.message,!t.result)},error:function(){}})}function reportAllyRoundMessage(t,e,i,n){elem=t,messageId=e,senderId=i,errorBoxDecision(LocalizationStrings.attention,n,LocalizationStrings.yes,LocalizationStrings.no,reportMessageCallback)}function reportMessageCallback(){elem.hide(),reportAllyMessage(messageId,senderId)}function requestsReady(){$(document).on("click",".acceptRequest",acceptRequest),$(document).on("click",".rejectRequest",rejectRequest),$(document).on("click",".cancelRequest",cancelRequest),$(document).on("click",".reportRequest",reportRequest)}function initBuddyRequestForm(){$(".overlayDiv .buddyRequest form").unbind("submit").bind("submit",(function(t){var e=$(this);t.preventDefault(),$.post(e.attr("action"),e.serialize(),"html").done((function(t){document.open(),document.write(t),document.close()})).fail((function(){var t=window.location.href;window.location=t.substring(0,t.indexOf("?"))+"?page=ingame&component=buddies"})).always((function(){return!1}))})),$(".buddyRequest").each((function(){var t=$(this),e=t.parents(".ui-dialog").find(".ui-dialog-title");e.find("span.buddyName").length||e.append($(document.createElement("span")).addClass("buddyName").text(" ("+t.attr("data-title")+")"))}))}function initBuyResourceOverlay(t,e,i){$(".close_buyResourceOverlay").on("click",(function(){$("#buyResourceOverlayBody").closest(".ui-dialog").find(".ui-icon-closethick").click()}));var n=function(){t&&e?errorBoxDecision(i.allNetworkAttention,i.slotWarning,i.allYes,i.allNo,sendDMAcceptanceForm):sendDMAcceptanceForm()};$("#premiumConfirmButton").on("click",(function(t){t.preventDefault(),n()})),$(document).on("ajaxShowOverlay",(function(t){$("#premiumConfirmButton").focus()})),$("#premiumConfirmButton").on("keyup",(function(t){t.stopPropagation(),13==t.keyCode&&n()}))}function sendDMAcceptanceForm(){$("#premiumAcceptForm").submit()}function openBuyResourceDialog(t){openOverlay(t,{class:"buyResourceDialog"})}function abortBuyResource(){$(".overlaydiv .abort_button").on("click",(function(){$(".overlaydiv").dialog("close")}))}function initBuyResources(){refreshBars("bar_container","filllevel_bar"),$(".fill_resource").on("click",".fillup",onChangeToPremium).on("click",".btn_premium",submitBuyRequest),$(".fillup").on("keyup",".resource_name input",handleInputForResourcePackages),initThousandSeparator()}function onChangeToPremium(t){var e=$(t.currentTarget).find(".btn_blue"),i=e.closest(".fillup"),n=e.closest(".fill_resource_ctn").find(".premium_bar");$(".fillup").removeClass("premium").parent().find(".current_stock span").removeClass("premium_txt").each((function(){var t=$(this);t.text(t.data("currentAmount"))})),$(".fill_resource .btn_premium").html(loca.fillUpResource).attr("class","btn_blue"),$(".premium_bar").css("width","0%").data("premiumPercent",0),"disabled"!==e.attr("disabled")&&(updateBuyTextAndActivatePackage(e,i),i.parent().find(".current_stock span").addClass("premium_txt").text(e.data("newValueFormatted")),n.data("premiumPercent",e.data("premiumPercent")),changeTooltip(n,"+"+tsdpkt(Math.floor(e.data("premiumValue")))),refreshBars("bar_container","filllevel_bar","premium_bar"))}function submitBuyRequest(t,e){let i=$(t.currentTarget),n={},a=!1;if($(".buy_resources.content_inner").hasClass("productionBasedPackages")&&0===i.data("sufficientDarkMatter"))return void redirectBuyPremium();void 0===e?e=!1:(i=e,e=!0);let s=parseInt(i.data("isCapped")),o=parseInt(i.data("productionLowered"));i.parents(".fillup").find(".resource_box").each((function(){let t=$(this),e=t.find(".resource_name > input").data("resourceType"),i=t.find(".resource_name input");n[e]=parseInt(i.val().split(LocalizationStrings.thousandSeperator).join("")),a=a||i.data("original")!==n[e]})),!1===a&&(n={}),o&&!0!==e?errorBoxDecision(loca.buyNow,loca.warnProductionLowered,loca.yes,loca.no,(function(){submitBuyRequest(t,i)})):1!==s||!1!==a?reallySubmitBuyRequest(i,n):errorBoxDecision(loca.buyNow,loca.warnCapped,loca.yes,loca.no,(function(){reallySubmitBuyRequest(i)}))}function reallySubmitBuyRequest(t,e){let i=t.data("premiumCosts"),n=t.data("itemuuid");$.ajax({url:buyResourcesLink,data:{itemUuid:n,costs:i,_token:token,userInputAmounts:e},type:"POST",dataType:"json",success:function(t){if(token=t.newAjaxToken,"failure"!==t.status)window.location.reload();else{let e=t.errors[0]||void 0;e&&e.message?fadeBox(e.message,!0):fadeBox(loca.error,!0)}},error:function(){}})}function handleInputForResourcePackages(t){let e;e="."===LocalizationStrings.thousandSeperator?new RegExp("\\"+LocalizationStrings.thousandSeperator,"g"):new RegExp(LocalizationStrings.thousandSeperator,"g");let i=$(t.target),n=parseInt(i.val().replace(e,""))||0,a=i.data("original"),s=!1;75!==t.which&&t.which>=65&&t.which<=90&&(n=0,s=!0),n>a&&(n=a,s=!0),!0===s&&i.val(tsdpkt(n)),updateCostsAfterUserModification(i)}function updateCostsAfterUserModification(t){let e=t.parents(".fillup"),i=e.find(".btn_wrap>a"),n=e.find(".premium_txt"),a=e.find(".resource_box"),s=0,o=$(".buy_resources").data("darkMatter");a.each((function(){let t=$(this).find(".resource_name input"),e=parseInt(t.val().split(LocalizationStrings.thousandSeperator).join(""))||0,n=0;t.data("original")>0&&(n=Math.round(t.data("originalPrice")*e/t.data("dailyProduction"))),e>0&&n<i.data("minPremiumCosts")&&(n=i.data("minPremiumCosts")),s+=n})),n.html(tsdpkt(s)),i.data("premiumCosts",s),o<s?(n.addClass("overmark"),i.data("sufficientDarkMatter",0)):(n.removeClass("overmark"),i.data("sufficientDarkMatter",1)),updateBuyTextAndActivatePackage(i,e)}function updatePercentageBasedPackages(t,e,i,n,a){if(t.isBuyable||(i.attr("disabled","disabled"),n.attr("disabled","disabled"),n.addClass("disabled")),i.data("premiumCosts",t.costs),i.data("premiumValue",t.resources),i.data("newValueFormatted",t.newValueFormatted),t.displayCosts?n.find(".fillup_cost .premium_txt").html(t.formattedCosts):n.find(".fillup_cost").addClass("overmark").html("-"),e===a){var s=i.data("buyButtonClass");!t.isCapped&&n.children("."+s).length&&(n.children("."+s).removeClass(s).addClass("fillup_100percent"),n.children(".fillup_txt").html(loca.fillUpTo))}}function updateProductionBasedPackages(t,e,i,n,a){t.isBuyable?a<t.displayCosts?(n.find(".fillup_cost .premium_txt").addClass("overmark").html(tsdpkt(t.displayCosts)),n.find(".btn_wrap>a").data("sufficientDarkMatter",0)):n.find(".fillup_cost .premium_txt").html(tsdpkt(t.displayCosts)):(i.attr("disabled","disabled"),n.attr("disabled","disabled"),n.addClass("disabled"),n.find(".fillup_cost").addClass("overmark").html("-")),i.data("premiumCosts",t.displayCosts),n.find(".resource_box").each((function(){let e=$(this);for(let n in t.amounts)if(e.find(".resource_img").hasClass(n)){let a=e.find(".resource_name");a.find("input").val(t.amounts[n]).data("original",t.amounts[n]),t.isResourceCapped[n]&&a.addClass("overmark"),t.isCapped?i.data("isCapped",1):i.data("isCapped",0)}}))}function updateBuyTextAndActivatePackage(t,e){t.html(!$(".buy_resources.content_inner").hasClass("productionBasedPackages")||t.data("sufficientDarkMatter")?loca.buyNow:loca.getDM).attr("class","btn_premium small"),e.addClass("premium")}!function(t){function e(t){return t*Math.PI/180}function i(t){this.element=t}function n(e,i){e&&(this.element=e,r.remove(e),r.removeDetached(),this._position=0,this._state="stopped",this.setOptions(t.extend({color:"#000",dashes:12,radius:5,height:5,width:1.8,opacity:1,padding:3,rotation:700},i||{})),this.drawPosition(0),r.add(this))}var a={scroll:function(t,e){if(!e)return t;var i=t.slice(0,e);return t.slice(e,t.length).concat(i)},isElement:function(t){return t&&1==t.nodeType},element:{isAttached:function(t){for(;t&&t.parentNode;)t=t.parentNode;return!!t&&!!t.body}}},s=function(i,n){var a=(l=t.extend({top:0,left:0,width:0,height:0,radius:0},n||{})).left,s=l.top,o=l.width,r=l.height,l=l.radius;i.beginPath(),i.moveTo(a+l,s),i.arc(a+o-l,s+l,l,e(-90),e(0),!1),i.arc(a+o-l,s+r-l,l,e(0),e(90),!1),i.arc(a+l,s+r-l,l,e(90),e(180),!1),i.arc(a+l,s+l,l,e(-180),e(-90),!1),i.closePath(),i.fill()},o=function(){function t(t){var i=[];if(0==t.indexOf("#")&&(t=t.substring(1)),""!=(t=t.toLowerCase()).replace(e,""))return null;for(3==t.length?(i[0]=t.charAt(0)+t.charAt(0),i[1]=t.charAt(1)+t.charAt(1),i[2]=t.charAt(2)+t.charAt(2)):(i[0]=t.substring(0,2),i[1]=t.substring(2,4),i[2]=t.substring(4)),t=0;t<i.length;t++)i[t]=parseInt(i[t],16);return i.red=i[0],i.green=i[1],i.blue=i[2],i}var e=RegExp("[0123456789abcdef]","g"),i=function(){function t(t,e,i){return t=t.toString(i||10),Array(e-t.length).join("0")+t}return function(e,i,n){return"#"+t(e,2,16)+t(i,2,16)+t(n,2,16)}}();return{hex2rgb:t,hex2fill:function(e,i){void 0===i&&(i=1);var n=i,a=t(e);return a[3]=n,a.opacity=n,"rgba("+a.join()+")"},rgb2hex:i}}();t.extend(Spinners,{enabled:!1,support:{canvas:function(){var e=t("<canvas>")[0];return!!e.getContext&&!!e.getContext("2d")}()},init:function(){(this.support.canvas||window.G_vmlCanvasManager&&window.attachEvent&&-1===navigator.userAgent.indexOf("Opera"))&&(window.G_vmlCanvasManager&&window.G_vmlCanvasManager.init_(document),this.enabled=!0)},create:function(t,e){return i.create(t,e),this.get(t)},get:function(t){return new i(t)},play:function(t){return this.get(t).play(),this},pause:function(t){return this.get(t).pause(),this},toggle:function(t){return this.get(t).toggle(),this},stop:function(t){return this.get(t).stop(),this},remove:function(t){return this.get(t).remove(),this},removeDetached:function(){return r.removeDetached(),this},center:function(t){return this.get(t).center(),this},setOptions:function(t,e){return this.get(t).setOptions(e),this},getDimensions:function(t){return{width:t=2*r.get(t)[0].getLayout().workspace.radius,height:t}}});var r={spinners:[],get:function(e){if(e){var i=[];return t.each(this.spinners,(function(n,s){s&&(a.isElement(e)?s.element==e:t(s.element).is(e))&&i.push(s)})),i}},add:function(t){this.spinners.push(t)},remove:function(e){t(t.map(this.spinners,(function(i){if(a.isElement(e)?i.element==e:t(i.element).is(e))return i.element}))).each(t.proxy((function(t,e){this.removeByElement(e)}),this))},removeByElement:function(e){var i=this.get(e)[0];i&&(i.remove(),this.spinners=t.grep(this.spinners,(function(t){return t.element!=e})))},removeDetached:function(){t.each(this.spinners,t.proxy((function(t,e){e&&e.element&&!a.element.isAttached(e.element)&&this.remove(e.element)}),this))}};t.extend(i,{create:function(e,i){if(e){var s=i||{},o=[];return a.isElement(e)?o.push(new n(e,s)):t(e).each((function(t,e){o.push(new n(e,s))})),o}}}),t.extend(i.prototype,{items:function(){return r.get(this.element)},play:function(){return t.each(this.items(),(function(t,e){e.play()})),this},stop:function(){return t.each(this.items(),(function(t,e){e.stop()})),this},pause:function(){return t.each(this.items(),(function(t,e){e.pause()})),this},toggle:function(){return t.each(this.items(),(function(t,e){e.toggle()})),this},center:function(){return t.each(this.items(),(function(t,e){e.center()})),this},setOptions:function(e){return t.each(this.items(),(function(t,i){i.setOptions(e)})),this},remove:function(){return r.remove(this.element),this}}),t.extend(n.prototype,{setOptions:function(e){this.options=t.extend({},this.options,e||{}),this.options.radii&&(e=this.options.radii,this.options.radius=Math.min(e[0],e[1]),this.options.height=Math.max(e[0],e[1])-this.options.radius),this.options.dashWidth&&(this.options.width=this.options.dashWidth),this.options.speed&&(this.options.duration=1e3*this.options.speed);e=this._state;var i=this._position;switch(this._layout=null,this.build(),i&&i>=this.options.dashes-1&&(this._position=this.options.dashes-1),e){case"playing":this.play();break;case"paused":case"stopped":this.drawPosition(this._position)}this._centered&&this.center()},remove:function(){this.canvas&&(this.pause(),t(this.canvas).remove(),this.ctx=this.canvas=null)},build:function(){this.remove();var e=this.getLayout().workspace.radius;return t(document.body).append(this.canvas=t("<canvas>").attr({width:2*e,height:2*e}).css({zoom:1})),window.G_vmlCanvasManager&&G_vmlCanvasManager.initElement(this.canvas[0]),this.ctx=this.canvas[0].getContext("2d"),this.ctx.globalAlpha=this.options.opacity,t(this.element).append(this.canvas),this.ctx.translate(e,e),this},drawPosition:function(t){var i=this.getLayout().workspace,n=(t=a.scroll(i.opacities,-1*t),i.radius),s=e(360/(i=this.options.dashes));for(this.ctx.clearRect(-1*n,-1*n,2*n,2*n),n=0;n<i;n++)this.drawDash(t[n],this.options.color),this.ctx.rotate(s)},drawDash:function(t,e){this.ctx.fillStyle=o.hex2fill(e,t);var i=(a=this.getLayout()).workspace.radius,n=a.dash.position,a=a.dash.dimensions;s(this.ctx,{top:n.top-i,left:n.left-i,width:a.width,height:a.height,radius:Math.min(a.height,a.width)/2})},_nextPosition:function(){var e=this.options.rotation/this.options.dashes;this.nextPosition(),this._playTimer=window.setTimeout(t.proxy(this._nextPosition,this),e)},nextPosition:function(){this._position==this.options.dashes-1&&(this._position=-1),this._position++,this.drawPosition(this._position)},play:function(){if("playing"!=this._state){this._state="playing";var e=this.options.rotation/this.options.dashes;return this._playTimer=window.setTimeout(t.proxy(this._nextPosition,this),e),this}},pause:function(){if("paused"!=this._state)return this._pause(),this._state="paused",this},_pause:function(){this._playTimer&&(window.clearTimeout(this._playTimer),this._playTimer=null)},stop:function(){if("stopped"!=this._state)return this._pause(),this._position=0,this.drawPosition(0),this._state="stopped",this},toggle:function(){return this["playing"==this._state?"pause":"play"](),this},getLayout:function(){if(this._layout)return this._layout;for(var t=(s=this.options).dashes,e=s.width,i=s.radius,n=s.radius+s.height,a=Math.max(e,n),s=(a=Math.ceil(Math.max(a,Math.sqrt(n*n+e/2*(e/2)))),a+=s.padding),o=1/t,r=[],l=0;l<t;l++)r.push((l+1)*o);return this._layout={workspace:{radius:s,opacities:r},dash:{position:{top:a-n,left:a-e/2},dimensions:{width:e,height:n-i}}}},center:function(){var e=2*this.getLayout().workspace.radius;t(this.element.parentNode).css({position:"relative"}),t(this.element).css({position:"absolute",height:e+"px",width:e+"px",top:"50%",left:"50%",marginLeft:-.5*e+"px",marginTop:-.5*e+"px"}),this._centered=!0}}),Spinners.init(),Spinners.enabled||(i.create=function(){return[]})}(jQuery),function(t,e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):t.Tipped=e(jQuery)}(this,(function($){var Tipped={};$.extend(Tipped,{version:"4.7.0"}),Tipped.Skins={base:{afterUpdate:!1,ajax:{},cache:!0,container:!1,containment:{selector:"viewport",padding:5},close:!1,detach:!0,fadeIn:200,fadeOut:200,showDelay:75,hideDelay:25,hideAfter:!1,hideOn:{element:"mouseleave"},hideOthers:!1,position:"top",inline:!1,offset:{x:0,y:0},onHide:!1,onShow:!1,padding:!0,radius:!0,shadow:!0,showOn:{element:"mousemove"},size:"medium",spinner:!0,stem:!0,target:"element",voila:!0},reset:{ajax:!1,hideOn:{element:"mouseleave",tooltip:"mouseleave"},showOn:{element:"mouseenter",tooltip:"mouseenter"}}},$.each("dark light gray red green blue lightyellow lightblue lightpink".split(" "),(function(t,e){Tipped.Skins[e]={}}));var Browser=(e=navigator.userAgent,{IE:!(!window.attachEvent||-1!==e.indexOf("Opera"))&&f("MSIE "),Opera:-1<e.indexOf("Opera")&&(!!window.opera&&opera.version&&parseFloat(opera.version())||7.55),WebKit:-1<e.indexOf("AppleWebKit/")&&f("AppleWebKit/"),Gecko:-1<e.indexOf("Gecko")&&-1===e.indexOf("KHTML")&&f("rv:"),MobileSafari:!!e.match(/Apple.*Mobile.*Safari/),Chrome:-1<e.indexOf("Chrome")&&f("Chrome/"),ChromeMobile:-1<e.indexOf("CrMo")&&f("CrMo/"),Android:-1<e.indexOf("Android")&&f("Android "),IEMobile:-1<e.indexOf("IEMobile")&&f("IEMobile/")}),e;function f(t){var i=new RegExp(t+"([\\d.]+)").exec(e);return!i||parseFloat(i[1])}var Support=(i=document.createElement("div"),j="Webkit Moz O ms Khtml".split(" "),{css:{animation:m("animation"),transform:m("transform"),prefixed:function(t){return m(t,"prefix")}},shadow:m("boxShadow")&&m("pointerEvents"),touch:function(){try{return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}catch(t){return!1}}()}),i,j;function m(t,e){var n=t.charAt(0).toUpperCase()+t.substr(1);return function(t,e){for(var n in t)if(void 0!==i.style[t[n]])return"prefix"!==e||t[n];return!1}((t+" "+j.join(n+" ")+n).split(" "),e)}var _slice=Array.prototype.slice,_={wrap:function(t,e){var i=t;return function(){var t=[$.proxy(i,this)].concat(_slice.call(arguments));return e.apply(this,t)}},isElement:function(t){return t&&1===t.nodeType},isText:function(t){return t&&3===t.nodeType},isDocumentFragment:function(t){return t&&11===t.nodeType},delay:function(t,e){var i=_slice.call(arguments,2);return setTimeout((function(){return t.apply(t,i)}),e)},defer:function(t){return _.delay.apply(this,[t,1].concat(_slice.call(arguments,1)))},pointer:function(t){return{x:t.pageX,y:t.pageY}},element:{isAttached:function(t){var e=function(t){for(var e=t;e&&e.parentNode;)e=e.parentNode;return e}(t);return!(!e||!e.body)}}};function degrees(t){return 180*t/Math.PI}function radian(t){return t*Math.PI/180}function sec(t){return 1/Math.cos(t)}function sfcc(t){return String.fromCharCode.apply(String,t.replace(" ","").split(","))}function deepExtend(t,e){for(var i in e)e[i]&&e[i].constructor&&e[i].constructor===Object?(t[i]=$.extend({},t[i])||{},deepExtend(t[i],e[i])):t[i]=e[i];return t}var getUID=(U=0,function(t){for(t=t||"_tipped-uid-",U++;document.getElementById(t+U);)U++;return t+U}),U,Position={positions:["topleft","topmiddle","topright","righttop","rightmiddle","rightbottom","bottomright","bottommiddle","bottomleft","leftbottom","leftmiddle","lefttop"],regex:{toOrientation:/^(top|left|bottom|right)(top|left|bottom|right|middle|center)$/,horizontal:/^(top|bottom)/,isCenter:/(middle|center)/,side:/^(top|bottom|left|right)/},toDimension:(X={top:"height",left:"width",bottom:"height",right:"width"},function(t){return X[t]}),isCenter:function(t){return!!t.toLowerCase().match(this.regex.isCenter)},isCorner:function(t){return!this.isCenter(t)},getOrientation:function(t){return t.toLowerCase().match(this.regex.horizontal)?"horizontal":"vertical"},getSide:function(t){var e=null,i=t.toLowerCase().match(this.regex.side);return i&&i[1]&&(e=i[1]),e},split:function(t){return t.toLowerCase().match(this.regex.toOrientation)},_flip:{top:"bottom",bottom:"top",left:"right",right:"left"},flip:function(t,e){var i=this.split(t);return e?this.inverseCornerPlane(this.flip(this.inverseCornerPlane(t))):this._flip[i[1]]+i[2]},inverseCornerPlane:function(t){if(Position.isCorner(t)){var e=this.split(t);return e[2]+e[1]}return t},adjustOffsetBasedOnPosition:function(t,e,i){var n=$.extend({},t),a={horizontal:"x",vertical:"y"},s=Position.getOrientation(e);if(s===Position.getOrientation(i))Position.getSide(e)!==Position.getSide(i)&&(n[{x:"y",y:"x"}[a[s]]]*=-1);else{var o=n.x;n.x=n.y,n.y=o;var r={top:{right:"x"},bottom:{left:"x"},left:{bottom:"y"},right:{top:"y"}}[Position.getSide(e)][Position.getSide(i)];r&&(n[r]*=-1),n[a[Position.getOrientation(i)]]=0}return n},getBoxFromPoints:function(t,e,i,n){var a=Math.min(t,i),s=Math.max(t,i),o=Math.min(e,n),r=Math.max(e,n);return{left:a,top:o,width:Math.max(s-a,0),height:Math.max(r-o,0)}},isPointWithinBox:function(t,e,i,n,a,s){var o=this.getBoxFromPoints(i,n,a,s);return t>=o.left&&t<=o.left+o.width&&e>=o.top&&e<=o.top+o.height},isPointWithinBoxLayout:function(t,e,i){return this.isPointWithinBox(t,e,i.position.left,i.position.top,i.position.left+i.dimensions.width,i.position.top+i.dimensions.height)},getDistance:function(t,e,i,n){return Math.sqrt(Math.pow(Math.abs(i-t),2)+Math.pow(Math.abs(n-e),2))},intersectsLine:function(t,e,i,n,a,s,o,r,l){return l?(f=((u=o-a)*(e-s)-(h=r-s)*(t-a))/(-u*(d=n-e)+(c=i-t)*h),0<=(p=(-d*(t-a)+c*(e-s))/(-u*d+c*h))&&p<=1&&0<=f&&f<=1&&{x:t+f*c,y:e+f*d}):Sa(t,e,a,s,o,r)!=Sa(i,n,a,s,o,r)&&Sa(t,e,i,n,a,s)!=Sa(t,e,i,n,o,r);var c,d,u,h,p,f}},X;function Sa(t,e,i,n,a,s){var o=(s-e)*(i-t)-(n-e)*(a-t);return 0<o||!(o<0)}var Bounds={viewport:function(){return Browser.MobileSafari||Browser.Android&&Browser.Gecko?{width:window.innerWidth,height:window.innerHeight}:{height:$(window).height(),width:$(window).width()}}},Mouse={_buffer:{pageX:0,pageY:0},_dimensions:{width:30,height:30},_shift:{x:2,y:10},getPosition:function(t){var e=this.getActualPosition(t);return{left:e.left-Math.round(.5*this._dimensions.width)+this._shift.x,top:e.top-Math.round(.5*this._dimensions.height)+this._shift.y}},getActualPosition:function(t){var e=t&&"number"===$.type(t.pageX)?t:this._buffer;return{left:e.pageX,top:e.pageY}},getDimensions:function(){return this._dimensions}},Color=(ub={_default:"#000000",aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},{toRGB:function(t){if(/^rgba?\(/.test(t))return function(t){return"#"+vb((t=t.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+))?\)$/))[1])+vb(t[2])+vb(t[3])}(t);ub[t]&&(t=ub[t]);var e=t.replace("#","");return/^(?:[0-9a-fA-F]{3}){1,2}$/.test(e)?(3==e.length&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)),"#"+e):ub._default}}),ub;function vb(t){return("0"+parseInt(t).toString(16)).slice(-2)}function Spin(){return this.initialize.apply(this,_slice.call(arguments))}function Visible(){return this.initialize.apply(this,_slice.call(arguments))}Spin.supported=Support.css.transform&&Support.css.animation,$.extend(Spin.prototype,{initialize:function(){this.options=$.extend({},arguments[0]||{}),this.build(),this.start()},build:function(){var t=2*(this.options.length+this.options.radius),e={height:t,width:t};this.element=$("<div>").addClass("tpd-spin").css(e),this.element.append(this._rotate=$("<div>").addClass("tpd-spin-rotate")),this.element.css({"margin-left":-.5*e.width,"margin-top":-.5*e.height});for(var i=this.options.lines,n=0;n<i;n++){var a,s;this._rotate.append(a=$("<div>").addClass("tpd-spin-frame").append(s=$("<div>").addClass("tpd-spin-line"))),s.css({"background-color":this.options.color,width:this.options.width,height:this.options.length,"margin-left":-.5*this.options.width,"border-radius":Math.round(.5*this.options.width)}),a.css({opacity:(1/i*(n+1)).toFixed(2)});var o={};o[Support.css.prefixed("transform")]="rotate("+360/i*(n+1)+"deg)",a.css(o)}},start:function(){var t={};t[Support.css.prefixed("animation")]="tpd-spin 1s infinite steps("+this.options.lines+")",this._rotate.css(t)},stop:function(){var t={};t[Support.css.prefixed("animation")]="none",this._rotate.css(t),this.element.detach()}}),$.extend(Visible.prototype,{initialize:function(t){return t="array"==$.type(t)?t:[t],this.elements=t,this._restore=[],$.each(t,$.proxy((function(t,e){var i=$(e).is(":visible");i||$(e).show(),this._restore.push({element:e,visible:i})}),this)),this},restore:function(){$.each(this._restore,(function(t,e){e.visible||$(e.element).show()})),this._restore=null}});var AjaxCache=(Qb=[],{get:function(t){for(var e=null,i=0;i<Qb.length;i++)Qb[i]&&Qb[i].url===t.url&&(Qb[i].type||"GET").toUpperCase()===(t.type||"GET").toUpperCase()&&$.param(Qb[i].data||{})===$.param(t.data||{})&&(e=Qb[i]);return e},set:function(t,e,i){var n=this.get(t);n||(n=$.extend({callbacks:{}},t),Qb.push(n)),n.callbacks[e]=i},remove:function(t){for(var e=0;e<Qb.length;e++)Qb[e]&&Qb[e].url===t&&delete Qb[e]},clear:function(){Qb=[]}}),Qb,Voila=function(t){function e(i,n,a){if(!(this instanceof e))return new e(i,n,a);var s=t.type(n),o="object"===s?n:{},r="function"===s?n:"function"===t.type(a)&&a;return this.options=t.extend({method:"onload"},o),this.deferred=new jQuery.Deferred,r&&this.always(r),this._processed=0,this.images=[],this._add(i),this}t.extend(e.prototype,{_add:function(e){var n="string"==t.type(e)?t(e):e instanceof jQuery||0<e.length?e:[e];t.each(n,t.proxy((function(e,n){var a=t(),s=t(n);(a=s.is("img")?a.add(s):a.add(s.find("img"))).each(t.proxy((function(e,n){this.images.push(new i(n,t.proxy((function(t){this._progress(t)}),this),t.proxy((function(t){this._progress(t)}),this),this.options))}),this))}),this)),this.images.length<1&&setTimeout(t.proxy((function(){this._resolve()}),this))},abort:function(){this._progress=this._notify=this._reject=this._resolve=function(){},t.each(this.images,(function(t,e){e.abort()})),this.images=[]},_progress:function(t){this._processed++,t.isLoaded||(this._broken=!0),this._notify(t),this._processed===this.images.length&&this[this._broken?"_reject":"_resolve"]()},_notify:function(t){this.deferred.notify(this,t)},_reject:function(){this.deferred.reject(this)},_resolve:function(){this.deferred.resolve(this)},always:function(t){return this.deferred.always(t),this},done:function(t){return this.deferred.done(t),this},fail:function(t){return this.deferred.fail(t),this},progress:function(t){return this.deferred.progress(t),this}});var i=function(t){function e(){return this.initialize.apply(this,Array.prototype.slice.call(arguments))}function i(){return this.initialize.apply(this,Array.prototype.slice.call(arguments))}return t.extend(e.prototype,{initialize:function(){this.options=t.extend({test:function(){},success:function(){},timeout:function(){},callAt:!1,intervals:[[0,0],[1e3,10],[2e3,50],[4e3,100],[2e4,500]]},arguments[0]||{}),this._test=this.options.test,this._success=this.options.success,this._timeout=this.options.timeout,this._ipos=0,this._time=0,this._delay=this.options.intervals[this._ipos][1],this._callTimeouts=[],this.poll(),this._createCallsAt()},poll:function(){this._polling=setTimeout(t.proxy((function(){if(this._test())this.success();else{if(this._time+=this._delay,this._time>=this.options.intervals[this._ipos][0]){if(!this.options.intervals[this._ipos+1])return void("function"==t.type(this._timeout)&&this._timeout());this._ipos++,this._delay=this.options.intervals[this._ipos][1]}this.poll()}}),this),this._delay)},success:function(){this.abort(),this._success()},_createCallsAt:function(){this.options.callAt&&t.each(this.options.callAt,t.proxy((function(e,i){var n=i[0],a=i[1],s=setTimeout(t.proxy((function(){a()}),this),n);this._callTimeouts.push(s)}),this))},_stopCallTimeouts:function(){t.each(this._callTimeouts,(function(t,e){clearTimeout(e)})),this._callTimeouts=[]},abort:function(){this._stopCallTimeouts(),this._polling&&(clearTimeout(this._polling),this._polling=null)}}),t.extend(i.prototype,{supports:{naturalWidth:"naturalWidth"in new Image},initialize:function(e,i,n){this.img=t(e)[0],this.successCallback=i,this.errorCallback=n,this.isLoaded=!1,this.options=t.extend({method:"onload",pollFallbackAfter:1e3},arguments[3]||{}),"onload"!=this.options.method&&this.supports.naturalWidth?this.poll():this.load()},poll:function(){this._poll=new e({test:t.proxy((function(){return 0<this.img.naturalWidth}),this),success:t.proxy((function(){this.success()}),this),timeout:t.proxy((function(){this.error()}),this),callAt:[[this.options.pollFallbackAfter,t.proxy((function(){this.load()}),this)]]})},load:function(){this._loading=setTimeout(t.proxy((function(){var e=new Image;(this._onloadImage=e).onload=t.proxy((function(){e.onload=function(){},this.supports.naturalWidth||(this.img.naturalWidth=e.width,this.img.naturalHeight=e.height,e.naturalWidth=e.width,e.naturalHeight=e.height),this.success()}),this),e.onerror=t.proxy(this.error,this),e.src=this.img.src}),this))},success:function(){this._calledSuccess||(this._calledSuccess=!0,this.abort(),this.waitForRender(t.proxy((function(){this.isLoaded=!0,this.successCallback(this)}),this)))},error:function(){this._calledError||(this._calledError=!0,this.abort(),this._errorRenderTimeout=setTimeout(t.proxy((function(){this.errorCallback&&this.errorCallback(this)}),this)))},abort:function(){this.stopLoading(),this.stopPolling(),this.stopWaitingForRender()},stopPolling:function(){this._poll&&(this._poll.abort(),this._poll=null)},stopLoading:function(){this._loading&&(clearTimeout(this._loading),this._loading=null),this._onloadImage&&(this._onloadImage.onload=function(){},this._onloadImage.onerror=function(){})},waitForRender:function(t){this._renderTimeout=setTimeout(t)},stopWaitingForRender:function(){this._renderTimeout&&(clearTimeout(this._renderTimeout),this._renderTimeout=null),this._errorRenderTimeout&&(clearTimeout(this._errorRenderTimeout),this._errorRenderTimeout=null)}}),i}(jQuery);return e}(jQuery);Tipped.Behaviors={hide:{showOn:{element:"mouseenter",tooltip:!1},hideOn:{element:"mouseleave",tooltip:"mouseenter"}},mouse:{showOn:{element:"mouseenter",tooltip:!1},hideOn:{element:"mouseleave",tooltip:"mouseenter"},target:"mouse",showDelay:100,fadeIn:0,hideDelay:0,fadeOut:0},sticky:{showOn:{element:"mouseenter",tooltip:"mouseenter"},hideOn:{element:"mouseleave",tooltip:"mouseleave"},showDelay:150,target:"mouse",fixed:!0}};var Options={create:Rc},Oc,Pc;function Rc(t){return Oc=Tipped.Skins.base,Pc=deepExtend($.extend({},Oc),Tipped.Skins.reset),(Rc=Uc)(t)}function Sc(t){return t.match(/^(top|left|bottom|right)$/)&&(t+="middle"),t.replace("center","middle").replace(" ",""),t}function Tc(t){var e;return t.behavior&&(e=Tipped.Behaviors[t.behavior])?deepExtend($.extend({},e),t):t}function Uc(t){var e=t.skin?t.skin:Tooltips.options.defaultSkin,i=$.extend({},Tipped.Skins[e]||{});i.skin||(i.skin=Tooltips.options.defaultSkin||"dark");var n,a=deepExtend($.extend({},Pc),Tc(i)),s=deepExtend($.extend({},a),Tc(t));if(s.ajax){Pc.ajax;var o=Oc.ajax;"boolean"===$.type(s.ajax)&&(s.ajax={}),s.ajax=deepExtend($.extend({},o),s.ajax)}var r=r=s.position&&s.position.target||"string"===$.type(s.position)&&s.position||Pc.position&&Pc.position.target||"string"===$.type(Pc.position)&&Pc.position||Oc.position&&Oc.position.target||Oc.position;r=Sc(r);var l,c=s.position&&s.position.tooltip||Pc.position&&Pc.position.tooltip||Oc.position&&Oc.position.tooltip||Tooltips.Position.getInversedPosition(r);if(c=Sc(c),s.position?"string"===$.type(s.position)?(s.position=Sc(s.position),n={target:s.position,tooltip:Tooltips.Position.getTooltipPositionFromTarget(s.position)}):(n={tooltip:c,target:r},s.position.tooltip&&(n.tooltip=Sc(s.position.tooltip)),s.position.target&&(n.target=Sc(s.position.target))):n={tooltip:c,target:r},Position.isCorner(n.target)&&Position.getOrientation(n.target)!==Position.getOrientation(n.tooltip)&&(n.target=Position.inverseCornerPlane(n.target)),"mouse"===s.target){var d=Position.getOrientation(n.target);n.target="horizontal"===d?n.target.replace(/(left|right)/,"middle"):n.target.replace(/(top|bottom)/,"middle")}if(s.position=n,"mouse"===s.target?(l=$.extend({},Oc.offset),$.extend(l,Tipped.Skins.reset.offset||{}),t.skin&&$.extend(l,(Tipped.Skins[t.skin]||Tipped.Skins[Tooltips.options.defaultSkin]||{}).offset||{}),l=Position.adjustOffsetBasedOnPosition(Oc.offset,Oc.position,n.target,!0),t.offset&&(l=$.extend(l,t.offset||{}))):l={x:s.offset.x,y:s.offset.y},s.offset=l,s.hideOn&&"click-outside"===s.hideOn&&(s.hideOnClickOutside=!0,s.hideOn=!1,s.fadeOut=0),s.showOn){var u=s.showOn;"string"===$.type(u)&&(u={element:u}),s.showOn=u}if(s.hideOn){var h=s.hideOn;"string"===$.type(h)&&(h={element:h}),s.hideOn=h}return s.inline&&"string"!==$.type(s.inline)&&(s.inline=!1),Browser.IE&&Browser.IE<9&&$.extend(s,{fadeIn:0,fadeOut:0,hideDelay:0}),s.spinner&&(Spin.supported?"boolean"===$.type(s.spinner)&&(s.spinner=Pc.spinner||Oc.spinner||{}):s.spinner=!1),s.container||(s.container=document.body),s.containment&&"string"===$.type(s.containment)&&(s.containment={selector:s.containment,padding:Pc.containment&&Pc.containment.padding||Oc.padding&&Oc.containment.padding}),s.shadow&&(s.shadow=Support.shadow),s}function Skin(){this.initialize.apply(this,_slice.call(arguments))}function Stem(){this.initialize.apply(this,_slice.call(arguments))}$.extend(Skin.prototype,{initialize:function(t){this.tooltip=t,this.element=t._skin;var e,i,n,a,s=this.tooltip.options;this.tooltip._tooltip[(s.shadow?"remove":"add")+"Class"]("tpd-no-shadow")[(s.radius?"remove":"add")+"Class"]("tpd-no-radius")[(s.stem?"remove":"add")+"Class"]("tpd-no-stem");var o=Support.css.prefixed("borderTopLeftRadius");this.element.append(e=$("<div>").addClass("tpd-frames").append($("<div>").addClass("tpd-frame").append($("<div>").addClass("tpd-backgrounds").append(i=$("<div>").addClass("tpd-background").append(n=$("<div>").addClass("tpd-background-content")))))).append(a=$("<div>").addClass("tpd-spinner")),i.css({width:999,height:999,zoom:1}),this._css={border:parseFloat(i.css("border-top-width")),radius:parseFloat(o?i.css(o):0),padding:parseFloat(t._content.css("padding-top")),borderColor:i.css("border-top-color"),backgroundColor:n.css("background-color"),backgroundOpacity:n.css("opacity"),spinner:{dimensions:{width:a.innerWidth(),height:a.innerHeight()}}},a.remove(),e.remove(),this._side=Position.getSide(t.options.position.tooltip)||"top",this._vars={}},destroy:function(){this.frames&&($.each("top right bottom left".split(" "),$.proxy((function(t,e){this["stem_"+e]&&this["stem_"+e].destroy()}),this)),this.frames.remove(),this.frames=null)},build:function(){this.frames||(this.element.append(this.frames=$("<div>").addClass("tpd-frames")),$.each("top right bottom left".split(" "),$.proxy((function(t,e){this.insertFrame(e)}),this)),this._spinner||this.tooltip._tooltip.append(this._spinner=$("<div>").addClass("tpd-spinner").hide().append($("<div>").addClass("tpd-spinner-spin"))))},_frame:function(){var t,e=$("<div>").addClass("tpd-frame").append(t=$("<div>").addClass("tpd-backgrounds").append($("<div>").addClass("tpd-background-shadow"))).append($("<div>").addClass("tpd-shift-stem").append($("<div>").addClass("tpd-shift-stem-side tpd-shift-stem-side-before")).append($("<div>").addClass("tpd-stem")).append($("<div>").addClass("tpd-shift-stem-side tpd-shift-stem-side-after")));return $.each("top right bottom left".split(" "),$.proxy((function(e,i){t.append($("<div>").addClass("tpd-background-box tpd-background-box-"+i).append($("<div>").addClass("tpd-background-box-shift").append($("<div>").addClass("tpd-background-box-shift-further").append($("<div>").addClass("tpd-background").append($("<div>").addClass("tpd-background-title")).append($("<div>").addClass("tpd-background-content"))).append($("<div>").addClass("tpd-background tpd-background-loading")).append($("<div>").addClass("tpd-background-border-hack").hide()))))}),this)),e}(),_getFrame:function(t){var e=this._frame.clone();e.addClass("tpd-frame-"+t),e.find(".tpd-background-shadow").css({"border-radius":this._css.radius}),this.tooltip.options.stem&&e.find(".tpd-stem").attr("data-stem-position",t);var i=Math.max(this._css.radius-this._css.border,0);e.find(".tpd-background-title").css({"border-top-left-radius":i,"border-top-right-radius":i}),e.find(".tpd-background-content").css({"border-bottom-left-radius":i,"border-bottom-right-radius":i}),e.find(".tpd-background-loading").css({"border-radius":i});var n={backgroundColor:this._css.borderColor};return n["horizontal"===Position.getOrientation(t)?"height":"width"]=this._css.border+"px",n[{top:"bottom",bottom:"top",left:"right",right:"left"}[t]]=0,e.find(".tpd-shift-stem-side").css(n),e},insertFrame:function(t){var e=this["frame_"+t]=this._getFrame(t);if(this.frames.append(e),this.tooltip.options.stem){var i=e.find(".tpd-stem");this["stem_"+t]=new Stem(i,this,{})}},startLoading:function(){this.tooltip.supportsLoading&&(this.build(),this._spinner||this.tooltip.is("resize-to-content")||this.setDimensions(this._css.spinner.dimensions),this._spinner&&this._spinner.show())},stopLoading:function(){this.tooltip.supportsLoading&&this._spinner&&(this.build(),this._spinner.hide())},updateBackground:function(){var t=this._vars.frames[this._side],e=$.extend({},t.background.dimensions);if(this.tooltip.title&&!this.tooltip.is("loading")){this.element.find(".tpd-background-title, .tpd-background-content").show(),this.element.find(".tpd-background").css({"background-color":"transparent"});var i=$.extend({},e),n=Math.max(this._css.radius-this._css.border,0),a={"border-top-left-radius":n,"border-top-right-radius":n,"border-bottom-left-radius":n,"border-bottom-right-radius":n},s=new Visible(this.tooltip._tooltip),o=this.tooltip._titleWrapper.innerHeight();i.height-=o,this.element.find(".tpd-background-title").css({height:o,width:e.width}),a["border-top-left-radius"]=0,a["border-top-right-radius"]=0,s.restore(),this.element.find(".tpd-background-content").css(i).css(a),this.element.find(".tpd-background-loading").css({"background-color":this._css.backgroundColor})}else this.element.find(".tpd-background-title, .tpd-background-content").hide(),this.element.find(".tpd-background").css({"background-color":this._css.backgroundColor});this._css.border&&(this.element.find(".tpd-background").css({"border-color":"transparent"}),this.element.find(".tpd-background-border-hack").css({width:e.width,height:e.height,"border-radius":this._css.radius,"border-width":this._css.border,"border-color":this._css.borderColor}).show())},paint:function(){if(!this._paintedDimensions||this._paintedDimensions.width!==this._dimensions.width||this._paintedDimensions.height!==this._dimensions.height||this._paintedStemPosition!==this._stemPosition){this._paintedDimensions=this._dimensions,this._paintedStemPosition=this._stemPosition,this.element.removeClass("tpd-visible-frame-top tpd-visible-frame-bottom tpd-visible-frame-left tpd-visible-frame-right").addClass("tpd-visible-frame-"+this._side);var t=this._vars.frames[this._side],e=$.extend({},t.background.dimensions);this.element.find(".tpd-background").css(e),this.element.find(".tpd-background-shadow").css({width:e.width+2*this._css.border,height:e.height+2*this._css.border}),this.updateBackground(),this.element.find(".tpd-background-box-shift, .tpd-background-box-shift-further").removeAttr("style"),this.element.add(this.frames).add(this.tooltip._tooltip).css(t.dimensions);var i=this._side,n=this._vars.frames[i],a=this.element.find(".tpd-frame-"+this._side),s=this._vars.frames[i].dimensions;a.css(s),a.find(".tpd-backgrounds").css($.extend({},n.background.position,{width:s.width-n.background.position.left,height:s.height-n.background.position.top}));var o=Position.getOrientation(i);if(this.tooltip.options.stem)if(a.find(".tpd-shift-stem").css($.extend({},n.shift.dimensions,n.shift.position)),"vertical"===o){(l=a.find(".tpd-background-box-top, .tpd-background-box-bottom")).css({height:this._vars.cut,width:this._css.border}),a.find(".tpd-background-box-bottom").css({top:n.dimensions.height-this._vars.cut}).find(".tpd-background-box-shift").css({"margin-top":-1*n.dimensions.height+this._vars.cut});var r="right"===i?n.dimensions.width-n.stemPx-this._css.border:0;l.css({left:r}).find(".tpd-background-box-shift").css({"margin-left":-1*r}),a.find(".tpd-background-box-"+("left"==i?"left":"right")).hide(),"right"===i?a.find(".tpd-background-box-left").css({width:n.dimensions.width-n.stemPx-this._css.border}):a.find(".tpd-background-box-right").css({"margin-left":this._css.border}).find(".tpd-background-box-shift").css({"margin-left":-1*this._css.border}),(c=a.find(".tpd-background-box-"+this._side)).css({height:n.dimensions.height-2*this._vars.cut,"margin-top":this._vars.cut}),c.find(".tpd-background-box-shift").css({"margin-top":-1*this._vars.cut})}else{var l,c;(l=a.find(".tpd-background-box-left, .tpd-background-box-right")).css({width:this._vars.cut,height:this._css.border}),a.find(".tpd-background-box-right").css({left:n.dimensions.width-this._vars.cut}).find(".tpd-background-box-shift").css({"margin-left":-1*n.dimensions.width+this._vars.cut}),r="bottom"===i?n.dimensions.height-n.stemPx-this._css.border:0,l.css({top:r}).find(".tpd-background-box-shift").css({"margin-top":-1*r}),a.find(".tpd-background-box-"+("top"===i?"top":"bottom")).hide(),"bottom"===i?a.find(".tpd-background-box-top").css({height:n.dimensions.height-n.stemPx-this._css.border}):a.find(".tpd-background-box-bottom").css({"margin-top":this._css.border}).find(".tpd-background-box-shift").css({"margin-top":-1*this._css.border}),(c=a.find(".tpd-background-box-"+this._side)).css({width:n.dimensions.width-2*this._vars.cut,"margin-left":this._vars.cut}),c.find(".tpd-background-box-shift").css({"margin-left":-1*this._vars.cut})}var d=t.background,u=d.position,h=d.dimensions;this._spinner.css({top:u.top+this._css.border+(.5*h.height-.5*this._css.spinner.dimensions.height),left:u.left+this._css.border+(.5*h.width-.5*this._css.spinner.dimensions.width)})}},getVars:function(){this._css.padding,this._css.radius;var t=this._css.border,e=this._vars.maxStemHeight||0,i=$.extend({},this._dimensions||{}),n={frames:{},dimensions:i,maxStemHeight:e};n.cut=Math.max(this._css.border,this._css.radius)||0;var a={width:0,height:0},s=0,o=0;return this.tooltip.options.stem&&(a=this.stem_top.getMath().dimensions.outside,s=this.stem_top._css.offset,o=Math.max(a.height-this._css.border,0)),n.stemDimensions=a,n.stemOffset=s,$.each("top right bottom left".split(" "),$.proxy((function(e,s){var r="vertical"===Position.getOrientation(s),l={width:i.width+2*t,height:i.height+2*t},c=l[r?"height":"width"]-2*n.cut,d={dimensions:l,stemPx:o,position:{top:0,left:0},background:{dimensions:$.extend({},i),position:{top:0,left:0}}};switch((n.frames[s]=d).dimensions[r?"width":"height"]+=o,"top"!==s&&"left"!==s||(d.background.position[s]+=o),$.extend(d,{shift:{position:{top:0,left:0},dimensions:{width:r?a.height:c,height:r?c:a.height}}}),s){case"top":case"bottom":d.shift.position.left+=n.cut,"bottom"===s&&(d.shift.position.top+=l.height-t-o);break;case"left":case"right":d.shift.position.top+=n.cut,"right"===s&&(d.shift.position.left+=l.width-t-o)}}),this)),n.connections={},$.each(Position.positions,$.proxy((function(t,e){n.connections[e]=this.getConnectionLayout(e,n)}),this)),n},setDimensions:function(t){this.build();var e=this._dimensions;e&&e.width===t.width&&e.height===t.height||(this._dimensions=t,this._vars=this.getVars())},setSide:function(t){this._side=t,this._vars=this.getVars()},getConnectionLayout:function(t,e){var i=Position.getSide(t),n=Position.getOrientation(t),a=(e.dimensions,e.cut),s=this["stem_"+i],o=e.stemOffset,r=this.tooltip.options.stem?s.getMath().dimensions.outside.width:0,l=a+o+.5*r,c={stem:{}},d={left:0,right:0,up:0,down:0},u={top:0,left:0},h={top:0,left:0},p=e.frames[i];if(l=0,"horizontal"==n){var f=p.dimensions.width;this.tooltip.options.stem&&((f=p.shift.dimensions.width)-r<2*o&&(o=Math.floor(.5*(f-r))||0),l=a+o+.5*r);var m=f-2*o,g=o;switch((b=Position.split(t))[2]){case"left":d.right=m-r,u.left=l;break;case"middle":g+=Math.round(.5*m-.5*r),d.left=g-o,d.right=g-o,u.left=h.left=Math.round(.5*p.dimensions.width);break;case"right":g+=m-r,d.left=m-r,u.left=p.dimensions.width-l,h.left=p.dimensions.width}"bottom"===b[1]&&(u.top+=p.dimensions.height,h.top+=p.dimensions.height),$.extend(c.stem,{position:{left:g},before:{width:g},after:{left:g+r,width:f-g-r+1}})}else{var v=p.dimensions.height;this.tooltip.options.stem&&((v=p.shift.dimensions.height)-r<2*o&&(o=Math.floor(.5*(v-r))||0),l=a+o+.5*r);var b,y=v-2*o,_=o;switch((b=Position.split(t))[2]){case"top":d.down=y-r,u.top=l;break;case"middle":_+=Math.round(.5*y-.5*r),d.up=_-o,d.down=_-o,u.top=h.top=Math.round(.5*p.dimensions.height);break;case"bottom":_+=y-r,d.up=y-r,u.top=p.dimensions.height-l,h.top=p.dimensions.height}"right"===b[1]&&(u.left+=p.dimensions.width,h.left+=p.dimensions.width),$.extend(c.stem,{position:{top:_},before:{height:_},after:{top:_+r,height:v-_-r+1}})}return c.move=d,c.stem.connection=u,c.connection=h,c},setStemPosition:function(t,e){if(this._stemPosition!==t){this._stemPosition=t;var i=Position.getSide(t);this.setSide(i)}this.tooltip.options.stem&&this.setStemShift(t,e)},setStemShift:function(t,e){var i=this._shift,n=this._dimensions;if(!i||i.stemPosition!==t||i.shift.x!==e.x||i.shift.y!==e.y||!n||i.dimensions.width!==n.width||i.dimensions.height!==n.height){this._shift={stemPosition:t,shift:e,dimensions:n};var a=Position.getSide(t),s={horizontal:"x",vertical:"y"}[Position.getOrientation(t)],o={x:{left:"left",width:"width"},y:{left:"top",width:"height"}}[s],r=this["stem_"+a],l=deepExtend({},this._vars.connections[t].stem);e&&0!==e[s]&&(l.before[o.width]+=e[s],l.position[o.left]+=e[s],l.after[o.left]+=e[s],l.after[o.width]-=e[s]),r.element.css(l.position),r.element.siblings(".tpd-shift-stem-side-before").css(l.before),r.element.siblings(".tpd-shift-stem-side-after").css(l.after)}}}),$.extend(Stem.prototype,{initialize:function(t,e){this.element=$(t),this.element[0]&&(this.skin=e,this.element.removeClass("tpd-stem-reset"),this._css=$.extend({},e._css,{width:this.element.innerWidth(),height:this.element.innerHeight(),offset:parseFloat(this.element.css("margin-left")),spacing:parseFloat(this.element.css("margin-top"))}),this.element.addClass("tpd-stem-reset"),this.options=$.extend({},arguments[2]||{}),this._position=this.element.attr("data-stem-position")||"top",this._m=100,this.build())},destroy:function(){this.element.html("")},build:function(){this.destroy();var t=this._css.backgroundColor,e=-1<t.indexOf("rgba")&&parseFloat(t.replace(/^.*,(.+)\)/,"$1")),i=e&&e<1;this._useTransform=i&&Support.css.transform,this._css.border||(this._useTransform=!1),this[(this._useTransform?"build":"buildNo")+"Transform"]()},buildTransform:function(){this.element.append(this.spacer=$("<div>").addClass("tpd-stem-spacer").append(this.downscale=$("<div>").addClass("tpd-stem-downscale").append(this.transform=$("<div>").addClass("tpd-stem-transform").append(this.first=$("<div>").addClass("tpd-stem-side").append(this.border=$("<div>").addClass("tpd-stem-border")).append($("<div>").addClass("tpd-stem-border-corner")).append($("<div>").addClass("tpd-stem-triangle")))))),this.transform.append(this.last=this.first.clone().addClass("tpd-stem-side-inversed")),this.sides=this.first.add(this.last);var t=this.getMath(),e=t.dimensions,i=this._m,n=Position.getSide(this._position);if(this.element.find(".tpd-stem-spacer").css({width:u?e.inside.height:e.inside.width,height:u?e.inside.width:e.inside.height}),"top"===n||"left"===n){var a={};"top"===n?(a.bottom=0,a.top="auto"):"left"===n&&(a.right=0,a.left="auto"),this.element.find(".tpd-stem-spacer").css(a)}this.transform.css({width:e.inside.width*i,height:e.inside.height*i});var s=Support.css.prefixed("transform"),o={"background-color":"transparent","border-bottom-color":this._css.backgroundColor,"border-left-width":.5*e.inside.width*i,"border-bottom-width":e.inside.height*i};o[s]="translate("+t.border*i+"px, 0)",this.element.find(".tpd-stem-triangle").css(o);var r=this._css.borderColor;alpha=-1<r.indexOf("rgba")&&parseFloat(r.replace(/^.*,(.+)\)/,"$1")),alpha&&alpha<1?r=(r.substring(0,r.lastIndexOf(","))+")").replace("rgba","rgb"):alpha=1;var l={"background-color":"transparent","border-right-width":t.border*i,width:t.border*i,"margin-left":-2*t.border*i,"border-color":r,opacity:alpha};l[s]="skew("+t.skew+"deg) translate("+t.border*i+"px, "+-1*this._css.border*i+"px)",this.element.find(".tpd-stem-border").css(l),r=this._css.borderColor,alpha=-1<r.indexOf("rgba")&&parseFloat(r.replace(/^.*,(.+)\)/,"$1")),alpha&&alpha<1?r=(r.substring(0,r.lastIndexOf(","))+")").replace("rgba","rgb"):alpha=1;var c={width:t.border*i,"border-right-width":t.border*i,"border-right-color":r,background:r,opacity:alpha,"margin-left":-2*t.border*i};if(c[s]="skew("+t.skew+"deg) translate("+t.border*i+"px, "+(e.inside.height-this._css.border)*i+"px)",this.element.find(".tpd-stem-border-corner").css(c),this.setPosition(this._position),1<i){var d={};d[s]="scale("+1/i+","+1/i+")",this.downscale.css(d)}var u=/^(left|right)$/.test(this._position);this._css.border||this.element.find(".tpd-stem-border, .tpd-stem-border-corner").hide(),this.element.css({width:u?e.outside.height:e.outside.width,height:u?e.outside.width:e.outside.height})},buildNoTransform:function(){this.element.append(this.spacer=$("<div>").addClass("tpd-stem-spacer").append($("<div>").addClass("tpd-stem-notransform").append($("<div>").addClass("tpd-stem-border").append($("<div>").addClass("tpd-stem-border-corner")).append($("<div>").addClass("tpd-stem-border-center-offset").append($("<div>").addClass("tpd-stem-border-center-offset-inverse").append($("<div>").addClass("tpd-stem-border-center"))))).append($("<div>").addClass("tpd-stem-triangle"))));var t=this.getMath(),e=t.dimensions,i=/^(left|right)$/.test(this._position),n=/^(bottom)$/.test(this._position),a=/^(right)$/.test(this._position),s=Position.getSide(this._position);if(this.element.css({width:i?e.outside.height:e.outside.width,height:i?e.outside.width:e.outside.height}),this.element.find(".tpd-stem-notransform").add(this.element.find(".tpd-stem-spacer")).css({width:i?e.inside.height:e.inside.width,height:i?e.inside.width:e.inside.height}),"top"===s||"left"===s){var o={};"top"===s?(o.bottom=0,o.top="auto"):"left"===s&&(o.right=0,o.left="auto"),this.element.find(".tpd-stem-spacer").css(o)}this.element.find(".tpd-stem-border").css({width:"100%",background:"transparent"});var r={opacity:1};r[i?"height":"width"]="100%",r[i?"width":"height"]=this._css.border,r[n?"top":"bottom"]=0,$.extend(r,a?{left:0}:{right:0}),this.element.find(".tpd-stem-border-corner").css(r);var l={width:0,"background-color":"transparent",opacity:1},c=.5*e.inside.width+"px solid transparent",d={"background-color":"transparent"};if(e.inside.width,t.border,i)u={left:"auto",top:"50%","margin-top":-.5*e.inside.width,"border-top":c,"border-bottom":c},$.extend(l,u),l[a?"right":"left"]=0,l[a?"border-left":"border-right"]=e.inside.height+"px solid "+this._css.borderColor,$.extend(d,u),d[a?"border-left":"border-right"]=e.inside.height+"px solid "+this._css.backgroundColor,d[a?"right":"left"]=t.top,d[a?"left":"right"]="auto",this.element.find(".tpd-stem-border-center-offset").css({"margin-left":-1*this._css.border*(a?-1:1)}).find(".tpd-stem-border-center-offset-inverse").css({"margin-left":this._css.border*(a?-1:1)});else{var u={"margin-left":-.5*e.inside.width,"border-left":c,"border-right":c};$.extend(l,u),l[n?"border-top":"border-bottom"]=e.inside.height+"px solid "+this._css.borderColor,$.extend(d,u),d[n?"border-top":"border-bottom"]=e.inside.height+"px solid "+this._css.backgroundColor,d[n?"bottom":"top"]=t.top,d[n?"top":"bottom"]="auto",this.element.find(".tpd-stem-border-center-offset").css({"margin-top":-1*this._css.border*(n?-1:1)}).find(".tpd-stem-border-center-offset-inverse").css({"margin-top":this._css.border*(n?-1:1)})}this.element.find(".tpd-stem-border-center").css(l),this.element.find(".tpd-stem-border-corner").css({"background-color":this._css.borderColor}),this.element.find(".tpd-stem-triangle").css(d),this._css.border||this.element.find(".tpd-stem-border").hide()},setPosition:function(t){this._position=t,this.transform.attr("class","tpd-stem-transform tpd-stem-transform-"+t)},getMath:function(){var t=this._css.height,e=this._css.width,i=this._css.border;this._useTransform&&Math.floor(e)%2&&(e=Math.max(Math.floor(e)-1,0));var n=degrees(Math.atan(.5*e/t)),a=90-n,s={width:e+i/Math.cos((90-a)*Math.PI/180)*2,height:t+i/Math.cos((90-n)*Math.PI/180)};Math.max(i,this._css.radius),t=s.height,e=.5*s.width;var o=90-degrees(Math.atan(t/e)),r=i/Math.cos(o*Math.PI/180),l=180*Math.atan(t/e)/Math.PI,c=-1*(90-l),d=90-l,u=i*Math.tan(d*Math.PI/180),h=i/Math.cos((90-d)*Math.PI/180),p=$.extend({},s),f=$.extend({},s);f.height+=this._css.spacing,f.height=Math.ceil(f.height);var m=!0;return s.width<=2*i&&(m=!1),{enabled:m,outside:f,dimensions:{inside:p,outside:f},top:h,border:r,skew:c,corner:u}}});var Tooltips={tooltips:{},options:{defaultSkin:"dark",startingZIndex:999999},_emptyClickHandler:function(){},init:function(){this.reset(),this._resizeHandler=$.proxy(this.onWindowResize,this),$(window).bind("resize orientationchange",this._resizeHandler),Browser.MobileSafari&&$("body").bind("click",this._emptyClickHandler)},reset:function(){Tooltips.removeAll(),Delegations.removeAll(),this._resizeHandler&&$(window).unbind("resize orientationchange",this._resizeHandler),Browser.MobileSafari&&$("body").unbind("click",this._emptyClickHandler)},onWindowResize:function(){this._resizeTimer&&(window.clearTimeout(this._resizeTimer),this._resizeTimer=null),this._resizeTimer=_.delay($.proxy((function(){var t=this.getVisible();$.each(t,(function(t,e){e.clearUpdatedTo(),e.position()}))}),this),15)},_getTooltips:function(t,e){var i,n=[],a=[];if(_.isElement(t)?(i=$(t).data("tipped-uids"))&&(n=n.concat(i)):$(t).each((function(t,e){(i=$(e).data("tipped-uids"))&&(n=n.concat(i))})),!n[0]&&!e){var s=this.getTooltipByTooltipElement($(t).closest(".tpd-tooltip")[0]);s&&s.element&&(i=$(s.element).data("tipped-uids")||[])&&(n=n.concat(i))}return 0<n.length&&$.each(n,$.proxy((function(t,e){var i;(i=this.tooltips[e])&&a.push(i)}),this)),a},findElement:function(t){var e=[];return _.isElement(t)&&(e=this._getTooltips(t)),e[0]&&e[0].element},get:function(t){var e=$.extend({api:!1},arguments[1]||{}),i=[];return _.isElement(t)?i=this._getTooltips(t):t instanceof $?t.each($.proxy((function(t,e){var n=this._getTooltips(e,!0);0<n.length&&(i=i.concat(n))}),this)):"string"===$.type(t)&&$.each(this.tooltips,(function(e,n){n.element&&$(n.element).is(t)&&i.push(n)})),e.api&&$.each(i,(function(t,e){e.is("api",!0)})),i},getTooltipByTooltipElement:function(t){if(!t)return null;var e=null;return $.each(this.tooltips,(function(i,n){n.is("build")&&n._tooltip[0]===t&&(e=n)})),e},getBySelector:function(t){var e=[];return $.each(this.tooltips,(function(i,n){n.element&&$(n.element).is(t)&&e.push(n)})),e},getNests:function(){var t=[];return $.each(this.tooltips,(function(e,i){i.is("nest")&&t.push(i)})),t},show:function(t){$(this.get(t)).each((function(t,e){e.show(!1,!0)}))},hide:function(t){$(this.get(t)).each((function(t,e){e.hide()}))},toggle:function(t){$(this.get(t)).each((function(t,e){e.toggle()}))},hideAll:function(t){$.each(this.getVisible(),(function(e,i){t&&t===i||i.hide()}))},refresh:function(t){var e;e=t?$.grep(this.get(t),(function(t,e){return t.is("visible")})):this.getVisible(),$.each(e,(function(t,e){e.refresh()}))},getVisible:function(){var t=[];return $.each(this.tooltips,(function(e,i){i.visible()&&t.push(i)})),t},isVisibleByElement:function(t){var e=!1;return _.isElement(t)&&$.each(this.getVisible()||[],(function(i,n){if(n.element===t)return!(e=!0)})),e},getHighestTooltip:function(){var t,e=0;return $.each(this.tooltips,(function(i,n){n.zIndex>e&&(e=n.zIndex,t=n)})),t},resetZ:function(){this.getVisible().length<=1&&$.each(this.tooltips,(function(t,e){e.is("build")&&!e.options.zIndex&&e._tooltip.css({zIndex:e.zIndex=+Tooltips.options.startingZIndex})}))},clearAjaxCache:function(){$.each(this.tooltips,$.proxy((function(t,e){e.options.ajax&&(e._cache&&e._cache.xhr&&(e._cache.xhr.abort(),e._cache.xhr=null),e.is("updated",!1),e.is("updating",!1),e.is("sanitized",!1))}),this)),AjaxCache.clear()},add:function(t){this.tooltips[t.uid]=t},remove:function(t){var e=this._getTooltips(t);this.removeTooltips(e)},removeTooltips:function(t){t&&$.each(t,$.proxy((function(t,e){var i=e.uid;delete this.tooltips[i],e.remove()}),this))},removeDetached:function(){var t=this.getNests(),e=[];0<t.length&&$.each(t,(function(t,i){i.is("detached")&&(e.push(i),i.attach())})),$.each(this.tooltips,$.proxy((function(t,e){e.element&&!_.element.isAttached(e.element)&&this.remove(e.element)}),this)),$.each(e,(function(t,e){e.detach()}))},removeAll:function(){$.each(this.tooltips,$.proxy((function(t,e){e.element&&this.remove(e.element)}),this)),this.tooltips={}},setDefaultSkin:function(t){this.options.defaultSkin=t||"dark"},setStartingZIndex:function(t){this.options.startingZIndex=t||0}};function Tooltip(){this.initialize.apply(this,_slice.call(arguments))}Tooltips.Position={inversedPosition:{left:"right",right:"left",top:"bottom",bottom:"top",middle:"middle",center:"center"},getInversedPosition:function(t){var e=Position.split(t),i=e[1],n=e[2],a=Position.getOrientation(t),s=$.extend({horizontal:!0,vertical:!0},arguments[1]||{});return"horizontal"===a?(s.vertical&&(i=this.inversedPosition[i]),s.horizontal&&(n=this.inversedPosition[n])):(s.vertical&&(n=this.inversedPosition[n]),s.horizontal&&(i=this.inversedPosition[i])),i+n},getTooltipPositionFromTarget:function(t){var e=Position.split(t);return this.getInversedPosition(e[1]+this.inversedPosition[e[2]])}},$.extend(Tooltip.prototype,{supportsLoading:Support.css.transform&&Support.css.animation,initialize:function(element,content){if(this.element=element,this.element){var options;"object"!==$.type(content)||_.isElement(content)||_.isText(content)||_.isDocumentFragment(content)||content instanceof $?options=arguments[2]||{}:(options=content,content=null);var dataOptions=$(element).data("tipped-options");dataOptions&&(options=deepExtend($.extend({},options),eval("({"+dataOptions+"})"))),this.options=Options.create(options),this._cache={dimensions:{width:0,height:0},events:[],timers:{},layouts:{},is:{},fnCallFn:"",updatedTo:{}},this.queues={showhide:$({})};var title=$(element).attr("title")||$(element).data("tipped-restore-title");if(!content){var dt=$(element).attr("data-tipped");if(dt?content=dt:title&&(content=title),content){var SCRIPT_REGEX=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;content=content.replace(SCRIPT_REGEX,"")}}if(!(!content||content instanceof $&&!content[0])||this.options.ajax&&this.options.ajax.url||this.options.inline){title&&($(element).data("tipped-restore-title",title),$(element)[0].setAttribute("title","")),this.content=content,this.title=$(this.element).data("tipped-title"),"undefined"!=$.type(this.options.title)&&(this.title=this.options.title),this.zIndex=this.options.zIndex||+Tooltips.options.startingZIndex;var uids=$(element).data("tipped-uids");uids=uids||[];var uid=getUID();this.uid=uid,uids.push(uid),$(element).data("tipped-uids",uids);var parentTooltipElement=$(this.element).closest(".tpd-tooltip")[0],parentTooltip;parentTooltipElement&&(parentTooltip=Tooltips.getTooltipByTooltipElement(parentTooltipElement))&&parentTooltip.is("nest",!0);var target=this.options.target;this.target="mouse"===target?this.element:"element"!==target&&target?_.isElement(target)?target:target instanceof $&&target[0]?target[0]:this.element:this.element,this.options.inline&&(this.content=$("#"+this.options.inline)[0]),this.options.ajax&&(this.__content=this.content),"function"===$.type(this.content)&&(this._fn=this.content),this.preBuild(),Tooltips.add(this)}else this._aborted=!0}},remove:function(){this.unbind(),this.clearTimers(),this.restoreElementToMarker(),this.stopLoading(),this.abort(),this.is("build")&&this._tooltip&&(this._tooltip.remove(),this._tooltip=null);var t=$(this.element).data("tipped-uids")||[],e=$.inArray(this.uid,t);if(-1<e&&(t.splice(e,1),$(this.element).data("tipped-uids",t)),t.length<1){var i,n="tipped-restore-title";(i=$(this.element).data(n))&&(""!=!$(this.element)[0].getAttribute("title")&&$(this.element).attr("title",i),$(this.element).removeData(n)),$(this.element).removeData("tipped-uids")}var a=($(this.element).attr("class")||"").replace(/(tpd-delegation-uid-)\d+/g,"").replace(/^\s\s*/,"").replace(/\s\s*$/,"");$(this.element).attr("class",a)},detach:function(){this.options.detach&&!this.is("detached")&&(this._tooltip&&this._tooltip.detach(),this.is("detached",!0))},attach:function(){if(this.is("detached")){var t;if("string"===$.type(this.options.container)){var e=this.target;"mouse"===e&&(e=this.element),t=$($(e).closest(this.options.container).first())}else t=$(this.options.container);t[0]||(t=$(document.body)),t.append(this._tooltip),this.is("detached",!1)}},preBuild:function(){this.is("detached",!0);var t={left:"-10000px",top:"-10000px",opacity:0,zIndex:this.zIndex};this._tooltip=$("<div>").addClass("tpd-tooltip").addClass("tpd-skin-"+this.options.skin).addClass("tpd-size-"+this.options.size).css(t).hide(),this.createPreBuildObservers()},build:function(){this.is("build")||(this.attach(),this._tooltip.append(this._skin=$("<div>").addClass("tpd-skin")).append(this._contentWrapper=$("<div>").addClass("tpd-content-wrapper").append(this._contentSpacer=$("<div>").addClass("tpd-content-spacer").append(this._titleWrapper=$("<div>").addClass("tpd-title-wrapper").append(this._titleSpacer=$("<div>").addClass("tpd-title-spacer").append(this._titleRelative=$("<div>").addClass("tpd-title-relative").append(this._titleRelativePadder=$("<div>").addClass("tpd-title-relative-padder").append(this._title=$("<div>").addClass("tpd-title"))))).append(this._close=$("<div>").addClass("tpd-close").append($("<div>").addClass("tpd-close-icon").html("&times;")))).append(this._contentRelative=$("<div>").addClass("tpd-content-relative").append(this._contentRelativePadder=$("<div>").addClass("tpd-content-relative-padder").append(this._content=$("<div>").addClass("tpd-content"))).append(this._inner_close=$("<div>").addClass("tpd-close").append($("<div>").addClass("tpd-close-icon").html("&times;")))))),this.skin=new Skin(this),this._contentSpacer.css({"border-radius":Math.max(this.skin._css.radius-this.skin._css.border,0)}),this.createPostBuildObservers(),this.is("build",!0))},createPostBuildObservers:function(){this._tooltip.delegate(".tpd-close, .close-tooltip","click",$.proxy((function(t){t.stopPropagation(),t.preventDefault(),this.is("api",!1),this.hide(!0)}),this))},createPreBuildObservers:function(){this.bind(this.element,"mouseenter",this.setActive),this.bind(this._tooltip,Support.touch&&Browser.MobileSafari?"touchstart":"mouseenter",this.setActive),this.bind(this.element,"mouseleave",(function(t){this.setIdle(t)})),this.bind(this._tooltip,"mouseleave",(function(t){this.setIdle(t)})),this.options.showOn&&($.each(this.options.showOn,$.proxy((function(t,e){var i,n=!1;switch(t){case"element":i=this.element,this.options.hideOn&&this.options.showOn&&"click"===this.options.hideOn.element&&"click"===this.options.showOn.element&&(n=!0,this.is("toggleable",n));break;case"tooltip":i=this._tooltip;break;case"target":i=this.target}if(i&&e){var a=e;this.bind(i,a,"click"===e&&n?function(t){this.is("api",!1),this.toggle()}:function(t){this.is("api",!1),this.showDelayed()})}}),this)),Support.touch&&Browser.MobileSafari&&this.bind(this._tooltip,"touchend",(function(){this._tooltipTouchEndTime=(new Date).getTime()}))),this.options.hideOn&&$.each(this.options.hideOn,$.proxy((function(t,e){var i;switch(t){case"element":if(this.is("toggleable")&&"click"===e)return;i=this.element;break;case"tooltip":i=this._tooltip;break;case"target":i=this.target}if(i&&e){var n=e;Support.touch&&Browser.MobileSafari&&/^(target|element)/.test(t)&&/mouse(leave|out)/.test(n)?this.bind(i,n,(function(t){this._tooltipTouchEndTime&&/^mouse(leave|out)$/.test(t.type)&&(new Date).getTime()-this._tooltipTouchEndTime<450||(this.is("api",!1),this.hideDelayed())})):this.bind(i,n,(function(t){this.is("api",!1),this.hideDelayed()}))}}),this)),this.options.hideOnClickOutside&&($(this.element).addClass("tpd-hideOnClickOutside"),this.bind(document.documentElement,"click touchend",$.proxy((function(t){if(this.visible()){var e=$(t.target).closest(".tpd-tooltip, .tpd-hideOnClickOutside")[0];(!e||e&&e!==this._tooltip[0]&&e!==this.element)&&this.hide()}}),this))),"mouse"===this.options.target&&this.bind(this.element,"mouseenter mousemove",$.proxy((function(t){this._cache.event=t}),this));var t=!1;this.options.showOn&&"mouse"===this.options.target&&!this.options.fixed&&(t=!0),t&&this.bind(this.element,"mousemove",(function(t){this.is("build")&&(this.is("api",!1),this.position())}))}}),$.extend(Tooltip.prototype,{stop:function(){this._tooltip&&(this.queues.showhide.queue([]),this._tooltip.stop(1,0))},showDelayed:function(t){this.is("disabled")||(this.clearTimer("hide"),this.is("visible")||this.getTimer("show")||this.setTimer("show",$.proxy((function(){this.clearTimer("show"),this.show()}),this),this.options.showDelay||1))},show:function(){if(this.clearTimer("hide"),!this.visible()&&!this.is("disabled")&&$(this.target).is(":visible")){this.is("visible",!0),this.attach(),this.stop();var t=this.queues.showhide;this.is("updated")||this.is("updating")||t.queue($.proxy((function(t){this._onResizeDimensions={width:0,height:0},this.update($.proxy((function(e){if(e)return this.is("visible",!1),void this.detach();t()}),this))}),this)),t.queue($.proxy((function(t){this.is("sanitized")?(this.stopLoading(),this._contentWrapper.css({visibility:"visible"}),this.is("resize-to-content",!0),t()):(this._contentWrapper.css({visibility:"hidden"}),this.startLoading(),this.sanitize($.proxy((function(){this.stopLoading(),this._contentWrapper.css({visibility:"visible"}),this.is("resize-to-content",!0),t()}),this)))}),this)),t.queue($.proxy((function(t){this.position(),this.raise(),t()}),this)),t.queue($.proxy((function(t){if(this.is("updated")&&"function"===$.type(this.options.onShow)){var e=new Visible(this._tooltip);this.options.onShow(this._content[0],this.element),e.restore(),t()}else t()}),this)),t.queue($.proxy((function(t){this._show(this.options.fadeIn,(function(){t()}))}),this))}},_show:function(t,e){t=("number"===$.type(t)?t:this.options.fadeIn)||0,e=e||"function"==$.type(t)&&t,this.options.hideOthers&&Tooltips.hideAll(this),this._tooltip.fadeTo(t,1,$.proxy((function(){e&&e()}),this))},hideDelayed:function(){this.clearTimer("show"),this.getTimer("hide")||!this.visible()||this.is("disabled")||this.setTimer("hide",$.proxy((function(){this.clearTimer("hide"),this.hide()}),this),this.options.hideDelay||1)},hide:function(t,e){if(this.clearTimer("show"),this.visible()&&!this.is("disabled")){this.is("visible",!1),this.stop();var i=this.queues.showhide;i.queue($.proxy((function(t){this.abort(),t()}),this)),i.queue($.proxy((function(e){this._hide(t,e)}),this)),i.queue((function(t){Tooltips.resetZ(),t()})),i.queue($.proxy((function(t){this.clearUpdatedTo(),t()}),this)),"function"===$.type(this.options.afterHide)&&this.is("updated")&&i.queue($.proxy((function(t){this.options.afterHide(this._content[0],this.element),t()}),this)),this.options.cache||!this.options.ajax&&!this._fn||i.queue($.proxy((function(t){this.is("updated",!1),this.is("updating",!1),this.is("sanitized",!1),t()}),this)),"function"===$.type(e)&&i.queue((function(t){e(),t()})),i.queue($.proxy((function(t){this.detach(),t()}),this))}},_hide:function(t,e){e=e||"function"===$.type(t)&&t,this.attach(),this._tooltip.fadeTo(t?0:this.options.fadeOut,0,$.proxy((function(){this.stopLoading(),this.is("resize-to-content",!1),this._tooltip.hide(),e&&e()}),this))},toggle:function(){this.is("disabled")||this[this.visible()?"hide":"show"]()},raise:function(){if(this.is("build")&&!this.options.zIndex){var t=Tooltips.getHighestTooltip();t&&t!==this&&this.zIndex<=t.zIndex&&(this.zIndex=t.zIndex+1,this._tooltip.css({"z-index":this.zIndex}),this._tooltipShadow&&(this._tooltipShadow.css({"z-index":this.zIndex}),this.zIndex=t.zIndex+2,this._tooltip.css({"z-index":this.zIndex})))}}}),$.extend(Tooltip.prototype,{createElementMarker:function(t){!this.elementMarker&&this.content&&_.element.isAttached(this.content)&&($(this.content).data("tpd-restore-inline-display",$(this.content).css("display")),this.elementMarker=$("<div>").hide(),$(this.content).before($(this.elementMarker).hide()))},restoreElementToMarker:function(){var t;this.elementMarker&&this.content&&((t=$(this.content).data("tpd-restore-inline-display"))&&$(this.content).css({display:t}),$(this.elementMarker).before(this.content).remove())},startLoading:function(){this.is("loading")||(this.build(),this.is("loading",!0),this.options.spinner&&(this._tooltip.addClass("tpd-is-loading"),this.skin.startLoading(),this.is("resize-to-content")||(this.position(),this.raise(),this._show())))},stopLoading:function(){this.build(),this.is("loading",!1),this.options.spinner&&(this._tooltip.removeClass("tpd-is-loading"),this.skin.stopLoading())},abort:function(){this.abortAjax(),this.abortSanitize(),this.is("refreshed-before-sanitized",!1)},abortSanitize:function(){this._cache.voila&&(this._cache.voila.abort(),this._cache.voila=null)},abortAjax:function(){this._cache.xhr&&(this._cache.xhr.abort(),this._cache.xhr=null,this.is("updated",!1),this.is("updating",!1))},update:function(t){if(!this.is("updating")){this.is("updating",!0),this.build();var e=this.options.inline?"inline":this.options.ajax?"ajax":_.isElement(this.content)||_.isText(this.content)||_.isDocumentFragment(this.content)?"element":this._fn?"function":"html";switch(this._contentWrapper.css({visibility:"hidden"}),e){case"html":case"element":case"inline":if(this.is("updated"))return void(t&&t());this._update(this.content,t);break;case"function":if(this.is("updated"))return void(t&&t());var i=this._fn(this.element);if(!i)return this.is("updating",!1),void(t&&t(!0));this._update(i,t);break;case"ajax":var n=this.options.ajax||{},a=n.url||this.__content,s=n.dataType,o={url:a,data:n.data||{}};(e=n.type||"GET")&&$.extend(o,{type:e}),s&&$.extend(o,{dataType:s});var r,l=$.extend({},o,n);if(l.method&&delete(l=$.extend({},l)).method,$.each("complete error success".split(" "),$.proxy((function(e,i){l[i]||(l[i]="success"===i?function(t,e,i){return i.responseText}:function(){}),l[i]=_.wrap(l[i],$.proxy((function(e){var n=_slice.call(arguments,1),a=$.type("object"===n[0])?n[0]:n[2];if(!a.statusText||"abort"!==a.statusText){this.options.cache&&AjaxCache.set({url:l.url,type:l.type,data:l.data},i,n),this._cache.xhr=null;var s=e.apply(this,n);s&&this._update(s,t)}}),this))}),this)),this.options.cache&&(r=AjaxCache.get(l))&&r.callbacks.success)return void $.each(r.callbacks,$.proxy((function(t,e){"function"===$.type(l[t])&&l[t].apply(this,e)}),this));this.startLoading(),this._cache.xhr=$.ajax(l)}}},_update:function(t,e){var i={title:this.options.title,close:this.options.close};"string"===$.type(t)||_.isElement(t)||_.isText(t)||_.isDocumentFragment(t)||t instanceof $?i.content=t:$.extend(i,t),t=i.content;var n=i.title,a=i.close;this.content=t,this.title=n,this.close=a,this.createElementMarker(),(_.isElement(t)||t instanceof $)&&$(t).show(),this._content.html(this.content),this._title.html(n&&"string"===$.type(n)?n:""),this._titleWrapper[n?"show":"hide"](),this._close[(this.title||this.options.title)&&a?"show":"hide"]();var s=a&&!(this.options.title||this.title),o=a&&!(this.options.title||this.title)&&"overlap"!==a,r=a&&(this.options.title||this.title)&&"overlap"!==a;this._inner_close[s?"show":"hide"](),this._tooltip[(o?"add":"remove")+"Class"]("tpd-has-inner-close"),this._tooltip[(r?"add":"remove")+"Class"]("tpd-has-title-close"),this._content[(this.options.padding?"remove":"add")+"Class"]("tpd-content-no-padding"),this.finishUpdate(e)},sanitize:function(t){if(!this.options.voila||this._content.find("img").length<1)return this.is("sanitized",!0),void(t&&t());this._cache.voila=Voila(this._content,{method:"onload"},$.proxy((function(e){this._markImagesAsSanitized(e.images),this.is("refreshed-before-sanitized")?(this.is("refreshed-before-sanitized",!1),this.sanitize(t)):(this.is("sanitized",!0),t&&t())}),this))},_markImagesAsSanitized:function(t){$.each(t,(function(t,e){var i=e.img;$(i).data("completed-src",e.img.src)}))},_hasAllImagesSanitized:function(){var t=!0;return this._content.find("img").each((function(e,i){var n=$(i).data("completed-src");if(!n||i.src!==n)return t=!1})),t},refresh:function(){this.visible()&&(this.is("sanitized")?(this.is("refreshing",!0),this.clearTimer("refresh-spinner"),!this.options.voila||this._content.find("img").length<1||this._hasAllImagesSanitized()?(this.is("should-update-dimensions",!0),this.position(),this.is("refreshing",!1)):(this.is("sanitized",!1),this._contentWrapper.css({visibility:"hidden"}),this.startLoading(),this.sanitize($.proxy((function(){this._contentWrapper.css({visibility:"visible"}),this.stopLoading(),this.is("should-update-dimensions",!0),this.position(),this.is("refreshing",!1)}),this)))):this.is("refreshed-before-sanitized",!0))},finishUpdate:function(t){if(this.is("updated",!0),this.is("updating",!1),"function"===$.type(this.options.afterUpdate)){var e=this._contentWrapper.css("visibility");e&&this._contentWrapper.css({visibility:"visible"}),this.options.afterUpdate(this._content[0],this.element),e&&this._contentWrapper.css({visibility:"hidden"})}t&&t()}}),$.extend(Tooltip.prototype,{clearUpdatedTo:function(){this._cache.updatedTo={}},updateDimensionsToContent:function(t,e){this.skin.build();var i=this.is("loading"),n=this._cache.updatedTo;if((this._maxWidthPass||this.is("api")||this.is("should-update-dimensions")||n.stemPosition!==e||n.loading!==i)&&(!i||!this.is("resize-to-content"))){this._cache.updatedTo={type:this.is("resize-to-content")?"content":"spinner",loading:this.is("loading"),stemPosition:e},this.is("should-update-dimensions")&&this.is("should-update-dimensions",!1),t=t||this.options.position.target,e=e||this.options.position.tooltip;var a=Position.getSide(e),s=Position.getOrientation(e),o=this.skin._css.border;this._tooltip.addClass("tpd-tooltip-measuring");var r=this._tooltip.attr("style");this._tooltip.removeAttr("style");var l={top:o,right:o,bottom:o,left:o},c=0;if("vertical"===Position.getOrientation(e)){this.options.stem&&(l[a]=this.skin["stem_"+a].getMath().dimensions.outside.height);var d=this.getMouseRoom();d[Position._flip[a]]&&(l[a]+=d[Position._flip[a]]);var u=this.getContainmentLayout(e),h=this.getPaddingLine(t),p=!1;Position.isPointWithinBoxLayout(h.x1,h.y1,u)||Position.isPointWithinBoxLayout(h.x2,h.y2,u)?p=!0:$.each("top right bottom left".split(" "),$.proxy((function(t,e){var i=this.getSideLine(u,e);if(Position.intersectsLine(h.x1,h.y1,h.x2,h.y2,i.x1,i.y1,i.x2,i.y2))return!(p=!0)}),this)),p&&(c="left"===a?h.x1-u.position.left:u.position.left+u.dimensions.width-h.x1,l[a]+=c)}if(this.options.offset&&"vertical"===s){var f=Position.adjustOffsetBasedOnPosition(this.options.offset,this.options.position.target,t);0!==f.x&&(l.right+=Math.abs(f.x))}this.options.containment&&(c=this.options.containment.padding)&&($.each(l,(function(t,e){l[t]+=c})),"vertical"===s?l["left"===a?"left":"right"]-=c:l["top"===a?"top":"bottom"]-=c);var m=Bounds.viewport(),g={width:0,height:0};this.close&&"overlap"!==this.close&&!this.title&&(g=this._innerCloseDimensions||{width:this._inner_close.outerWidth(!0),height:this._inner_close.outerHeight(!0)},this._innerCloseDimensions=g),this._contentRelativePadder.css({"padding-right":g.width}),this._contentSpacer.css({width:m.width-l.left-l.right});var v={width:this._content.innerWidth()+g.width,height:Math.max(this._content.innerHeight(),g.height||0)},b={width:0,height:0};if(this.title){var y={width:0,height:0};this._titleWrapper.add(this._titleSpacer).css({width:"auto",height:"auto"}),this.close&&"overlap"!==this.close&&(y={width:this._close.outerWidth(!0),height:this._close.outerHeight(!0)},this._close.hide()),this._maxWidthPass&&v.width>this.options.maxWidth&&this._titleRelative.css({width:v.width}),this._titleRelativePadder.css({"padding-right":y.width});var _=parseFloat(this._titleWrapper.css("border-bottom-width"));(b={width:this.title?this._titleWrapper.innerWidth():0,height:Math.max(this.title?this._titleWrapper.innerHeight()+_:0,y.height+_)}).width>m.width-l.left-l.right&&(b.width=m.width-l.left-l.right,this._titleSpacer.css({width:b.width}),b.height=Math.max(this.title?this._titleWrapper.innerHeight()+_:0,y.height+_)),v.width=Math.max(b.width,v.width),v.height+=b.height,this._titleWrapper.css({height:Math.max(this.title?this._titleWrapper.innerHeight():0,y.height)}),this.close&&this._close.show()}if(this.options.stem){var x="vertical"===s?"height":"width",w=this.skin["stem_"+a].getMath().outside.width+2*this.skin._css.radius;v[x]<w&&(v[x]=w)}if(this._contentSpacer.css({width:v.width}),v.height!==Math.max(this._content.innerHeight(),g.height)+(this.title?this._titleRelative.outerHeight():0)&&v.width++,this.is("resize-to-content")||(v=this.skin._css.spinner.dimensions),this.setDimensions(v),l={top:o,right:o,bottom:o,left:o},this.options.stem){var C=Position.getSide(e);l[C]=this.skin.stem_top.getMath().dimensions.outside.height}this._contentSpacer.css({"margin-top":l.top,"margin-left":+l.left,width:v.width}),(this.title||this.close)&&this._titleWrapper.css({height:this._titleWrapper.innerHeight(),width:v.width}),this._tooltip.removeClass("tpd-tooltip-measuring"),this._tooltip.attr("style",r);var k=this._contentRelative.add(this._titleRelative);this.options.maxWidth&&v.width>this.options.maxWidth&&!this._maxWidthPass&&this.is("resize-to-content")&&(k.css({width:this.options.maxWidth}),this._maxWidthPass=!0,this.updateDimensionsToContent(t,e),this._maxWidthPass=!1,k.css({width:"auto"}))}},setDimensions:function(t){this.skin.setDimensions(t)},getContainmentSpace:function(t,e){var i=this.getContainmentLayout(t,e),n=this.getTargetLayout(),a=n.position,s=n.dimensions,o=i.position,r=i.dimensions,l={top:Math.max(a.top-o.top,0),bottom:Math.max(o.top+r.height-(a.top+s.height),0),left:Math.max(a.left-o.left,0),right:Math.max(o.left+r.width-(a.left+s.width),0)};return a.top>o.top+r.height&&(l.top-=a.top-(o.top+r.height)),a.top+s.height<o.top&&(l.bottom-=o.top-(a.top+s.height)),a.left>o.left+r.width&&o.left+r.width>=a.left&&(l.left-=a.left-(o.left+r.width)),a.left+s.width<o.left&&(l.right-=o.left-(a.left+s.width)),this._cache.layouts.containmentSpace=l},position:function(t){if(this.visible()){this.is("positioning",!0),this._cache.layouts={},this._cache.dimensions;var e=this.options.position.target,i=this.options.position.tooltip,n=i,a=e;this.updateDimensionsToContent(a,n);var s=deepExtend(this.getPositionBasedOnTarget(a,n)),o=[];if(this.options.containment){var r=!1,l={};if($.each("top right bottom left".split(" "),$.proxy((function(t,e){(l[e]=this.isSideWithinContainment(e,n,!0))&&(r=!0)}),this)),r||(s.contained=!0),s.contained)this.setPosition(s);else if(o.unshift({position:s,targetPosition:a,stemPosition:n}),a=Position.flip(e),n=Position.flip(i),l[Position.getSide(a)]?(this.updateDimensionsToContent(a,n),s=this.getPositionBasedOnTarget(a,n)):s.contained=!1,s.contained)this.setPosition(s,n);else{o.unshift({position:s,targetPosition:a,stemPosition:n});var c=e,d=this.getContainmentSpace(n,!0),u="horizontal"===Position.getOrientation(c)?["left","right"]:["top","bottom"],h=(d[u[0]]===d[u[1]]?"horizontal"===Position.getOrientation(c)?"left":"top":u[d[u[0]]>d[u[1]]?0:1])+Position.split(c)[1],p=Position.flip(h);if(a=h,n=p,l[Position.getSide(a)]?(this.updateDimensionsToContent(a,n),s=this.getPositionBasedOnTarget(a,n)):s.contained=!1,s.contained)this.setPosition(s,n);else{var f;o.unshift({position:s,targetPosition:a,stemPosition:n});var m=[];if($.each(o,(function(t,e){if(0<=e.position.top&&0<=e.position.left)f=e;else{var i=0<=e.position.top?1:Math.abs(e.position.top),n=0<=e.position.left?1:Math.abs(e.position.left);m.push({result:e,negativity:i*n})}})),!f){var g=m[m.length-1];$.each(m,(function(t,e){e.negativity<g.negativity&&(g=e)})),f=g.result}this.updateDimensionsToContent(f.targetPosition,f.stemPosition,!0),this.setPosition(f.position,f.stemPosition)}}}else this.setPosition(s);this._cache.dimensions=this.skin._vars.dimensions,this.skin.paint(),this.is("positioning",!1)}},getPositionBasedOnTarget:function(t,e){e=e||this.options.position.tooltip;var i,n=this.getTargetDimensions(),a={left:0,top:0},s={left:0,top:0},o=(Position.getSide(t),this.skin._vars),r=o.frames[Position.getSide(e)],l=Position.getOrientation(t),c=Position.split(t);if("horizontal"===l){switch(i=Math.floor(.5*n.width),c[2]){case"left":s.left=i;break;case"middle":a.left=n.width-i,s.left=a.left;break;case"right":a.left=n.width,s.left=n.width-i}"bottom"===c[1]&&(a.top=n.height,s.top=n.height)}else{switch(i=Math.floor(.5*n.height),c[2]){case"top":s.top=i;break;case"middle":a.top=n.height-i,s.top=a.top;break;case"bottom":s.top=n.height-i,a.top=n.height}"right"===c[1]&&(a.left=n.width,s.left=n.width)}var d=this.getTargetPosition(),u=$.extend({},n,{top:d.top,left:d.left,connection:a,max:s}),h={width:r.dimensions.width,height:r.dimensions.height,top:0,left:0,connection:o.connections[e].connection,stem:o.connections[e].stem};if(h.top=u.top+u.connection.top,h.left=u.left+u.connection.left,h.top-=h.connection.top,h.left-=h.connection.left,this.options.stem){var p=o.stemDimensions.width,f={stem:{top:h.top+h.stem.connection.top,left:h.left+h.stem.connection.left},connection:{top:u.top+u.connection.top,left:u.left+u.connection.left},max:{top:u.top+u.max.top,left:u.left+u.max.left}};if(!Position.isPointWithinBox(f.stem.left,f.stem.top,f.connection.left,f.connection.top,f.max.left,f.max.top)){f={stem:{top:h.top+h.stem.connection.top,left:h.left+h.stem.connection.left},connection:{top:u.top+u.connection.top,left:u.left+u.connection.left},max:{top:u.top+u.max.top,left:u.left+u.max.left}};var m={connection:Position.getDistance(f.stem.left,f.stem.top,f.connection.left,f.connection.top),max:Position.getDistance(f.stem.left,f.stem.top,f.max.left,f.max.top)},g=Math.min(m.connection,m.max),v=f[m.connection<=m.max?"connection":"max"],b="horizontal"===Position.getOrientation(e)?"left":"top";if(p<=Position.getDistance(f.connection.left,f.connection.top,f.max.left,f.max.top)){var y={top:0,left:0},_=v[b]<f.stem[b]?-1:1;y[b]=g*_,y[b]+=Math.floor(.5*p)*_,h.left+=y.left,h.top+=y.top}else{$.extend(f,{center:{top:Math.round(u.top+.5*n.height),left:Math.round(u.left+.5*n.left)}}),g=m[Position.getDistance(f.center.left,f.center.top,f.connection.left,f.connection.top)<=Position.getDistance(f.center.left,f.center.top,f.max.left,f.max.top)?"connection":"max"];var x={top:0,left:0};_=v[b]<f.stem[b]?-1:1,x[b]=g*_,h.left+=x.left,h.top+=x.top}}}if(this.options.offset){var w=$.extend({},this.options.offset);w=Position.adjustOffsetBasedOnPosition(w,this.options.position.target,t),h.top+=w.y,h.left+=w.x}var C=this.getContainment({top:h.top,left:h.left},e),k=C.horizontal&&C.vertical,S={x:0,y:0},T=Position.getOrientation(e);if(!C[T]){var I="horizontal"===T,D=I?["left","right"]:["up","down"],A=I?"x":"y",P=I?"left":"top",O=C.correction[A],E=this.getContainmentLayout(e),M=E.position[I?"left":"top"];if(0!==O){var L=o.connections[e].move,j=L[D[-1*O<0?0:1]],R=O<0?-1:1;if(O*R<=j&&h[P]+O>=M)h[P]+=O,S[A]=-1*O,k=!0;else if(Position.getOrientation(t)===Position.getOrientation(e)){if(h[P]+=j*R,S[A]=j*R*-1,h[P]<M){var N=M-h[P],B=L[D[0]]+L[D[1]];N=Math.min(N,B),h[P]+=N;var F=S[A]-N;F>=o.connections[e].move[D[0]]&&F<=o.connections[e].move[D[1]]&&(S[A]-=N)}var H=(C=this.getContainment({top:h.top,left:h.left},e)).correction[A],z=deepExtend({},h);this.options.offset&&(z.left-=this.options.offset.x,z.top-=this.options.offset.y),(f={stem:{top:z.top+h.stem.connection.top,left:z.left+h.stem.connection.left}}).stem[P]+=S[A];var W=this.getTargetLayout(),U=(p=o.stemDimensions.width,Math.floor(.5*p)),q=M+E.dimensions[I?"width":"height"];if("x"==A){var Y=W.position.left+U;0<H&&(Y+=W.dimensions.width-2*U),(H<0&&f.stem.left+H>=Y&&z.left+H>=M||0<H&&f.stem.left+H<=Y&&z.left+H<=q)&&(z.left+=H)}else{var V=W.position.top+U;0<H&&(V+=W.dimensions.height-2*U),(H<0&&f.stem.top+H>=V&&z.top+H>=M||0<H&&f.stem.top+H<=V&&z.top+H<=q)&&(z.top+=H)}h=z,this.options.offset&&(h.left+=this.options.offset.x,h.top+=this.options.offset.y)}}k=(C=this.getContainment({top:h.top,left:h.left},e)).horizontal&&C.vertical}return{top:h.top,left:h.left,contained:k,shift:S}},setPosition:function(t,e){var i=this._position;if(!i||i.top!==t.top||i.left!==t.left){var n;if(this.options.container!==document.body){if("string"===$.type(this.options.container)){var a=this.target;"mouse"===a&&(a=this.element),n=$($(a).closest(this.options.container).first())}else n=$(n);if(n[0]){var s=$(n).offset(),o=Math.round(s.top),r=Math.round(s.left),l=Math.round($(n).scrollTop()),c=Math.round($(n).scrollLeft());t.top-=o,t.top+=l,t.left-=r,t.left+=c}}this._position=t,this._tooltip.css({top:t.top,left:t.left})}this.skin.setStemPosition(e||this.options.position.tooltip,t.shift||{x:0,y:0})},getSideLine:function(t,e){var i=t.position.left,n=t.position.top,a=t.position.left,s=t.position.top;switch(e){case"top":a+=t.dimensions.width;break;case"bottom":n+=t.dimensions.height,a+=t.dimensions.width,s+=t.dimensions.height;break;case"left":s+=t.dimensions.height;break;case"right":i+=t.dimensions.width,a+=t.dimensions.width,s+=t.dimensions.height}return{x1:i,y1:n,x2:a,y2:s}},isSideWithinContainment:function(t,e,i){var n=this.getContainmentLayout(e,i),a=this.getTargetLayout(),s=this.getSideLine(a,t);if(Position.isPointWithinBoxLayout(s.x1,s.y1,n)||Position.isPointWithinBoxLayout(s.x2,s.y2,n))return!0;var o=!1;return $.each("top right bottom left".split(" "),$.proxy((function(t,e){var i=this.getSideLine(n,e);if(Position.intersectsLine(s.x1,s.y1,s.x2,s.y2,i.x1,i.y1,i.x2,i.y2))return!(o=!0)}),this)),o},getContainment:function(t,e){var i={horizontal:!0,vertical:!0,correction:{y:0,x:0}};if(this.options.containment){var n=this.getContainmentLayout(e),a=this.skin._vars.frames[Position.getSide(e)].dimensions;this.options.containment&&((t.left<n.position.left||t.left+a.width>n.position.left+n.dimensions.width)&&(i.horizontal=!1,t.left<n.position.left?i.correction.x=n.position.left-t.left:i.correction.x=n.position.left+n.dimensions.width-(t.left+a.width)),(t.top<n.position.top||t.top+a.height>n.position.top+n.dimensions.height)&&(i.vertical=!1,t.top<n.position.top?i.correction.y=n.position.top-t.top:i.correction.y=n.position.top+n.dimensions.height-(t.top+a.height)))}return i},getContainmentLayout:function(t,e){var i={top:$(window).scrollTop(),left:$(window).scrollLeft()},n=this.target;"mouse"===n&&(n=this.element);var a,s=$(n).closest(this.options.containment.selector).first()[0];a=s&&"viewport"!==this.options.containment.selector?{dimensions:{width:$(s).innerWidth(),height:$(s).innerHeight()},position:$(s).offset()}:{dimensions:Bounds.viewport(),position:i};var o=this.options.containment.padding;if(o&&!e){var r=Math.max(a.dimensions.height,a.dimensions.width);r<2*o&&(o=Math.max(Math.floor(.5*r),0)),o&&(a.dimensions.width-=2*o,a.dimensions.height-=2*o,a.position.top+=o,a.position.left+=o,"vertical"===Position.getOrientation(t)?(a.dimensions.width+=o,"left"===Position.getSide(t)&&(a.position.left-=o)):(a.dimensions.height+=o,"top"===Position.getSide(t)&&(a.position.top-=o)))}return this._cache.layouts.containmentLayout=a},getMouseRoom:function(){var t={top:0,left:0,right:0,bottom:0};if("mouse"===this.options.target&&!this.is("api")){var e=Mouse.getActualPosition(this._cache.event),i=$(this.element).offset(),n=$(this.element).innerWidth(),a=$(this.element).innerHeight();t={top:Math.max(0,e.top-i.top),bottom:Math.max(0,i.top+a-e.top),left:Math.max(0,e.left-i.left),right:Math.max(0,i.left+n-e.left)}}return t},getTargetPosition:function(){var t,e;return t="mouse"===this.options.target?this.is("api")?(e=$(this.element).offset(),{top:Math.round(e.top),left:Math.round(e.left)}):Mouse.getPosition(this._cache.event):(e=$(this.target).offset(),{top:Math.round(e.top),left:Math.round(e.left)}),this._cache.layouts.targetPosition=t},getTargetDimensions:function(){return this._cache.layouts.targetDimensions?this._cache.layouts.targetDimensions:(t="mouse"===this.options.target?Mouse.getDimensions():{width:$(this.target).innerWidth(),height:$(this.target).innerHeight()},this._cache.layouts.targetDimensions=t);var t},getTargetLayout:function(){if(this._cache.layouts.targetLayout)return this._cache.layouts.targetLayout;var t={position:this.getTargetPosition(),dimensions:this.getTargetDimensions()};return this._cache.layouts.targetLayout=t},getPaddingLine:function(t){var e=this.getTargetLayout(),i="left";if("vertical"===Position.getOrientation(t))return this.getSideLine(e,Position.getSide(t));if(Position.isCorner(t)){var n=Position.inverseCornerPlane(t);return i=Position.getSide(n),this.getSideLine(e,i)}var a=this.getSideLine(e,i),s=Math.round(.5*e.dimensions.width);return a.x1+=s,a.x2+=s,a}}),$.extend(Tooltip.prototype,{setActive:function(){this.is("active",!0),this.visible()&&this.raise(),this.options.hideAfter&&this.clearTimer("idle")},setIdle:function(){this.is("active",!1),this.options.hideAfter&&this.setTimer("idle",$.proxy((function(){this.clearTimer("idle"),this.is("active")||this.hide()}),this),this.options.hideAfter)}}),$.extend(Tooltip.prototype,{bind:function(t,e,i,n){var a=$.proxy(i,n||this);this._cache.events.push({element:t,eventName:e,handler:a}),$(t).bind(e,a)},unbind:function(){$.each(this._cache.events,(function(t,e){$(e.element).unbind(e.eventName,e.handler)})),this._cache.events=[]}}),$.extend(Tooltip.prototype,{disable:function(){this.is("disabled")||this.is("disabled",!0)},enable:function(){this.is("disabled")&&this.is("disabled",!1)}}),$.extend(Tooltip.prototype,{is:function(t,e){return"boolean"===$.type(e)&&(this._cache.is[t]=e),this._cache.is[t]},visible:function(){return this.is("visible")}}),$.extend(Tooltip.prototype,{setTimer:function(t,e,i){this._cache.timers[t]=_.delay(e,i)},getTimer:function(t){return this._cache.timers[t]},clearTimer:function(t){this._cache.timers[t]&&(clearTimeout(this._cache.timers[t]),delete this._cache.timers[t])},clearTimers:function(){$.each(this._cache.timers,(function(t,e){clearTimeout(e)})),this._cache.timers={}}}),$.extend(Tipped,{init:function(){Tooltips.init()},create:function(t,e){var i=$.extend({},arguments[2]||{}),n=[];return _.isElement(t)?n.push(new Tooltip(t,e,i)):$(t).each((function(t,a){n.push(new Tooltip(a,e,i))})),new Collection(n)},get:function(t){return new Collection(Tooltips.get(t))},findElement:function(t){return Tooltips.findElement(t)},hideAll:function(){return Tooltips.hideAll(),this},setDefaultSkin:function(t){return Tooltips.setDefaultSkin(t),this},visible:function(t){if(_.isElement(t))return Tooltips.isVisibleByElement(t);if("undefined"===$.type(t))return Tooltips.getVisible().length;var e=$(t),i=0;return $.each(e,(function(t,e){Tooltips.isVisibleByElement(e)&&i++})),i},clearAjaxCache:function(){return Tooltips.clearAjaxCache(),this},refresh:function(t,e,i){return Tooltips.refresh(t,e,i),this},setStartingZIndex:function(t){return Tooltips.setStartingZIndex(t),this},remove:function(t){return Tooltips.remove(t),this}}),$.each("show hide toggle disable enable".split(" "),(function(t,e){Tipped[e]=function(t){return this.get(t)[e](),this}})),$.extend(Tipped,{delegate:function(){Delegations.add.apply(Delegations,_slice.call(arguments))},undelegate:function(){Delegations.remove.apply(Delegations,_slice.call(arguments))}});var Delegations={_uid:0,_delegations:{},add:function(t,e,i){"object"!==$.type(e)||_.isElement(e)?i=i||{}:(i=e,e=null);var n=++this._uid,a=Options.create($.extend({},i));function s(t){$(this).addClass("tpd-delegation-uid-"+n);var a=new Tooltip(this,e,i);a._cache.event=t,a.setActive(),a.showDelayed()}this._delegations[n]={uid:n,selector:t,content:e,options:a},this._delegations[n].removeTitleHandler=$.proxy(this.removeTitle,this),$(document).delegate(t+":not(.tpd-delegation-uid-"+n+")","mouseenter",this._delegations[n].removeTitleHandler),this._delegations[n].handler=s,$(document).delegate(t+":not(.tpd-delegation-uid-"+n+")",a.showOn.element,s)},removeTitle:function(t){var e=t.currentTarget,i=$(e).attr("title");i&&($(e).data("tipped-restore-title",i),$(e)[0].setAttribute("title",""))},remove:function(t){$.each(this._delegations,$.proxy((function(e,i){i.selector===t&&($(document).undelegate(t+":not(.tpd-delegation-uid-"+e+")","mouseenter",i.removeTitleHandler).undelegate(t+":not(.tpd-delegation-uid-"+e+")",i.options.showOn.element,i.handler),delete this._delegations[e])}),this))},removeAll:function(){$.each(this._delegations,$.proxy((function(t,e){$(document).undelegate(e.selector+":not(.tpd-delegation-uid-"+t+")","mouseenter",e.removeTitleHandler).undelegate(e.selector+":not(.tpd-delegation-uid-"+t+")",e.options.showOn.element,e.handler),delete this._delegations[t]}),this))}};function Collection(){this.initialize.apply(this,_slice.call(arguments))}return $.extend(Collection.prototype,{initialize:function(t){return this.tooltips=t,this},items:function(){return $.each(this.tooltips,(function(t,e){e.is("api",!0)})),this.tooltips},refresh:function(t){return $.each(this._tooltips,(function(t,e){e.is("visible")&&e.refresh()})),this},remove:function(){return Tooltips.removeTooltips(this.tooltips),this.tooltips=[],this}}),$.each("show hide toggle disable enable".split(" "),(function(t,e){Collection.prototype[e]=function(){return $.each(this.tooltips,(function(t,i){i.is("api",!0),i[e]()})),this}})),Tipped.init(),Tipped})),$("[data-homepage-link]").on("click",(function(t){t.preventDefault(),errorBoxDecision(LocalizationStrings.attention,LocalizationStrings.redirectMessage,LocalizationStrings.yes,LocalizationStrings.no,(function(){window.location.href="redir.php?url="+encodeURIComponent(allyHome)}),!1,!1)})),ogame.buddies={initBuddyList:function(){$.tablesorter.addParser({id:"coordinates",is:function(t){return!1},format:function(t){var e=$.trim(t).slice(1,-1).split(":");return 16384*e[0]+32*e[1]+1*e[2]},type:"numeric"}),$.tablesorter.addParser({id:"commaDigit",is:function(t,e){var i=e.config;return jQuery.tablesorter.isDigit(t.replace(/\./g,""),i)},format:function(t){return jQuery.tablesorter.formatFloat(t.replace(/\./g,""))},type:"numeric"}),$(".content_table").tablesorter({widgets:["zebra"],headers:{0:{sorter:!1},2:{sorter:"commaDigit"},5:{sorter:"coordinates"},6:{sorter:!1}},cssHeader:"ct_sortable_title",cssAsc:"ct_sort_asc",cssDesc:"ct_sort_desc"}),$("#buddylist").off(".buddyList"),$("#buddylist").on("click.buddyList",".deleteBuddy",deleteBuddy),$("#chatContent").on("click.chat_info",".deleteBuddy",deleteBuddy)},initBuddies:function(){$(".zebra tr").mouseover((function(){$(this).addClass("over")})).mouseout((function(){$(this).removeClass("over")})),$(".js_accordion").accordion({collapsible:!0,heightStyle:"content"}),$(".js_tabs").tabs(),$(".js_scrollbar").mCustomScrollbar({theme:"ogame"})}},ogame.chat={socket:null,connected:!1,connecting:!1,timeout:null,retryInterval:5e3,playerId:null,associationId:null,data:{association:{}},playernames:{},playerList:null,isLoadingPlayerList:!1,playerListSelector:new Array,initConnection:function(){var t=ogame.chat;(t.connecting||t.connected||t.isMobile)&&this.socket&&t.socket.disconnect(),t.connecting=!0;try{t.socket=io.connect(":"+nodePort+"/chat",nodeParams),t.socket.on("connect",(function(){clearTimeout(this.timeout),t.socket.emit("authorize",session,(function(e){t.connecting=!1,e?t.connected=!0:t.socket.disconnect()}))})),t.socket.on("chat",(function(e){t.messageReceived(e)})),t.socket.on("disconnect",(function(){t.connected=!1,t.connecting=!1}))}catch(e){t.connecting=!1}},initialize:function(){if("undefined"!=typeof nodeUrl){var t=ogame.chat;loadScript(nodeUrl,t.initConnection),$(".new_msg_count[data-playerid]").each((function(){t.saveMessageCounter($(this).data("new-messages"),$(this).data("playerid"))})),this.updateTotalNewChatCounter(),$(".js_playerlist").on("click",".playerlist_item",(function(){if(!$(this).hasClass("nothingThere")){var e=$(this).data("msgid");e?t.loadChatLogWithPlayer(this,e):t.loadChatLogWithPlayer(this)}})),$(".js_playerlist").on("click",".openAssociationChat",(function(){var e=$(this).data("msgid");e?t.loadChatLogWithAssociation(this,e):t.loadChatLogWithAssociation(this)})),$("#chatMsgList").on("click",".msg",(function(){var e=$(this).data("playerid"),i=$(this).data("associationid");if(void 0!==e&&e>0){t.saveMessageCounter(0,e),ogame.messagemarker.setPartnerId(e),ogame.messagemarker.updateNewMarker(),ogame.chat.updateTotalNewChatCounter(),(n=$(".playerlist .playerlist_item[data-playerId="+e+"]").data("msgid"))?t.loadChatLogWithPlayer(this,n):t.loadChatLogWithPlayer(this)}else{var n=$(".playerlist .playerlist_item[data-associationId="+i+"]").data("msgid");t.saveMessageCounterAssociation(0,i),n?t.loadChatLogWithAssociation(this,n):t.loadChatLogWithAssociation(this)}})),$(".chat").on("click",".sys_msg",(function(t){var e=$(this).data("foreign-player-id"),i=$(this).data("foreign-association-id"),n={playerId:e,associationId:i,ajax:1};$.ajax({url:chatUrlLoadMoreMessages,type:"POST",dataType:"html",data:n,success:function(t){$(".chat").each((function(n,a){(void 0!==e&&e==$(a).data("foreign-player-id")||void 0!==i&&i==$(a).data("foreign-association-id"))&&$(a).html(t)}))},error:function(t,e,i){}})})),$("body").on("click",".js_openChat",(function(){t.loadChatLogWithPlayer(this)})),"string"!=typeof $.cookie("maximizeId")&&"number"!=typeof $.cookie("maximizeId")||($('#chatMsgList .msg[data-playerid="'+$.cookie("maximizeId")+'"]').trigger("click"),$.cookie("maximizeId",null))}},getTotalNewChatCounter:function(){return ogame.messagecounter.sumNewChatMessages},updateTotalNewChatCounter:function(){var t=0;return $(".msg .new_msg_count").length>0?$(".msg .new_msg_count").each((function(){t+=Number($(this).data("new-messages"))})):$("#chatBarPlayerList .new_msg_count").length>0&&$("#chatBarPlayerList .new_msg_count").each((function(){t+=Number($(this).data("new-messages"))})),ogame.messagecounter.initialize(ogame.messagecounter.type_chat,ogame.chat.playerId),ogame.messagecounter.sumNewChatMessages!==t&&(ogame.messagecounter.initChatCounter(t),ogame.messagecounter.sumNewChatMessages=t,ogame.messagecounter.update()),t},retryConnection:function(){var t=ogame.chat;setTimeout((function(){t.initConnection()}),5e3)},sendMessage:function(t,e,i,n){var a,s=ogame.chat;0!=$.trim(i).length?(a=t>0?{playerId:t,text:i,mode:1,ajax:1,_token:window.ajaxChatToken}:{associationId:e,text:i,mode:3,ajax:1,_token:window.ajaxChatToken},void 0!==n&&void 0!==n.id&&(a.msg2reply=n.id),o()):r("TEXT_EMPTY");function o(){$.ajax({url:chatUrl,type:"POST",dataType:"json",data:a,success:function(e){!function(e){switch(e.status){case"NOT_AUTHORIZED":o();break;case"OK":!function(e){void 0!==e.refAuthor&&void 0!==e.refContent?$refData={author:e.refAuthor,text:e.refContent}:$refData=0;void 0!==e.targetId?s.addChatItem(e.targetId,0,e.text,e.id,!1,$refData,e.date):s.addChatItem(t,e.targetAssociationId,e.text,e.id,!1,$refData,e.date)}(e),ogame.chat.cleanupUrl();break;default:r(e.status)}}(e),window.ajaxChatToken=e.newToken},error:function(t,e,i){}})}function r(t){void 0!==chatLoca[t]?errorBoxNotify(LocalizationStrings.error,chatLoca[t],LocalizationStrings.ok):errorBoxNotify(LocalizationStrings.error,t,LocalizationStrings.ok)}},messageReceived:function(t){var e=ogame.chat;if(void 0!==t.refAuthor&&void 0!==t.refText?$refData={author:t.refAuhtor,text:t.refText}:$refData=0,void 0!==t.senderName&&void 0!==t.senderId&&(e.playernames[t.senderId]=t.senderName),$(".chat_bar_list").length&&(void 0!==t.associationId&&t.associationId>0?void 0===e.data.association[t.associationId]?e.loadChatLogWithAssociation(t.associationId,null,(function(){e.addChatItem(t.senderId,t.associationId,t.text,t.id,!0,$refData,t.date)}),!1):e.addChatItem(t.senderId,t.associationId,t.text,t.id,!0,$refData,t.date):void 0===e.data[t.senderId]?e.loadChatLogWithPlayer(t.senderId,null,(function(){e.addChatItem(t.senderId,0,t.text,t.id,!0,$refData,t.date)}),!1):e.addChatItem(t.senderId,0,t.text,t.id,!0,$refData,t.date)),void 0!==t.associationId&&t.associationId>0)if($('.chat_bar_list_item.open[data-associationid="'+t.associationId+'"]').length<=0){var i=$('.new_msg_count[data-associationid="'+t.associationId+'"]').data("new-messages");isNaN(i)&&(i=0),i++,e.saveMessageCounterAssociation(i,t.associationId),e.updateTotalNewChatCounter()}else{var n={associationId:t.associationId,mode:4,ajax:1,updateUnread:1};$.ajax({url:chatUrl,type:"POST",data:n,success:function(t){},error:function(t,e,i){}})}else if(void 0!==t.senderId&&t.senderId>0)if(ogame.messagemarker.setPartnerId(t.senderId),e.isOpen(t.senderId))e.saveMessageCounter(0,$(this).data("playerid")),ogame.messagemarker.updateNewMarker();else{ogame.messagecounter.initialize(ogame.messagecounter.type_chat,t.senderId);i=parseInt(ogame.messagecounter.newChats[t.senderId]);isNaN(i)&&(i=0),i++,e.saveMessageCounter(i,t.senderId),ogame.messagemarker.updateNewMarker()}},cleanupUrl:function(){},saveMessageCounter:function(t,e){if(isNaN(e)||0===e)return!1;$('.new_msg_count[data-playerid="'+e+'"]').data("new-messages",t),ogame.messagecounter.newChats[e]=t},saveMessageCounterAssociation:function(t,e){if(isNaN(e)||0===e)return!1;$('.new_msg_count[data-associationid="'+e+'"]').data("new-messages",t),$('.new_msg_count[data-associationid="'+e+'"]').text(t),ogame.messagemarker.updateNewMarker()},isOpen:function(t){var e=!1,i=$(".chatContent").data("chatplayerid");return"undefined"!=i&&i==t?e=!0:$(".chat_box").each((function(){$(this).attr("data-playerid")==t&&"block"==$(this).css("display")&&(e=!0)})),e},loadChatLogWithPlayer:function(t,e,i,n){var a=ogame.chat;void 0===n&&(n=!0);var s={playerId:"number"==typeof t?t:$(t).attr("data-playerId"),mode:2,ajax:1,updateUnread:n?1:0};"number"==typeof e&&(s.msg2reply=e),$.ajax({url:chatUrl,type:"POST",data:s,success:function(e){e=JSON.parse(e),a.data[e.playerId]={playerstatus:e.playerstatus,playerName:e.playerName,playerId:e.playerId,chatItems:e.chatItems,chatItemsByDateAsc:e.chatItemsByDateAsc},"function"==typeof i?i():$(t).parents("#chatBarPlayerList").length||"chat"!=$("body")[0].id?a.showChat(e):a.showChatHistory(e);var n=$(".chat_bar_list").find("[data-playerid='"+e.playerId+"']");a.updateCustomScrollbar(n.find(".chat_box_ctn"))},error:function(t,e,i){}})},loadChatLogWithAssociation:function(t,e,i,n){var a=ogame.chat;void 0===n&&(n=!0);var s={associationId:"number"==typeof t?t:$(t).attr("data-associationid"),mode:4,ajax:1,updateUnread:n?1:0};"number"==typeof e&&(s.msg2reply=e),$.ajax({url:chatUrl,type:"POST",data:s,success:function(e){e=JSON.parse(e),a.data.association[e.associationId]={playerstatus:e.playerstatus,associationName:e.associationName,associationId:e.associationId,chatItems:e.chatItems,chatItemsByDateAsc:e.chatItemsByDateAsc},"function"==typeof i?i():$(t).parents("#chatBarPlayerList").length||"chat"!=$("body")[0].id?a.showChat(e):a.showChatHistory(e);var n=$(".chat_bar_list").find("[data-associationid='"+e.associationId+"']");a.updateCustomScrollbar(n.find(".chat_box_ctn"))},error:function(t,e,i){}})},initChat:function(t,e){ogame.chat.playerId=t,ogame.chat.isMobile=e,ogame.chat.initPlayerlist(),ogame.chat.initialize(),ogame.chat.toggleVisibility(),ogame.chat.setVisibilityState(),ogame.chat.initMaximize(),ogame.chat.getInMaxChat()},getLastChatItemData:function(){ogame.chat;var t=null;return $(".chat_box_ctn .mCustomScrollBox .mCSB_container").each((function(){var e=$(this).children("ul.chat").children("li:last");(null===t||e.attr("data-chat-id")>t.attr("data-chat-id"))&&(t=e)})),null===t&&$("ul.largeChat").each((function(){var e=$(this).children("li:last");(null===t||e.attr("data-chat-id")>t.attr("data-chat-id"))&&(t=e)})),null===t?null:{date:t.children(".msg_head").find(".msg_date").html(),text:t.find(".msg_content").html()}},addChatItem:function(t,e,i,n,a,s,o){var r,l=ogame.chat;r=e>0?$(".chat_bar_list").find("[data-associationid='"+e+"']"):$(".chat_bar_list").find("[data-playerid='"+t+"']");var c={};if(c.date=o,c.newClass="new",a?(void 0!==l.data[t]?c.playerName=l.data[t].playerName:c.playerName=l.playernames[t],c.altClass=""):(c.playerName=playerName,c.altClass="odd"),c.chatID=n,c.chatContent=i,"object"==typeof s&&(c.refData=s),!r.length){var d=l.createChatBarContainer(t);l.updateChatBar(d),r=$(".chat_bar_list").find("[data-playerid='"+t+"']")}var u=l.createChatItem(c),h=l.getLastChatItemData();if(null!==h&&(c.date!=h.date||c.chatContent!=h.text)){r.find(".chat").append(u),l.updateCustomScrollbar(r.find(".chat_box_ctn"));var p=$(".js_chatHistory");!p.length||p.data("chatplayerid")!=t&&p.data("associationid")!=e||(p.find(".chat.clearfix").append(u.clone()),l.updateCustomScrollbar($(".largeChatContainer")))}},addToMoreBox:function(t){var e=ogame.chat,i=t.length;i&&$(".more_chat_bar_items").length<1&&$(".chat_bar_list").append(e.createMoreBox("more_chat_bar_items"));for(var n=$(".more_chat_bar_items .more_items"),a=$(".more_chat_bar_items .chat_box"),s=0;s<=i;s++)n.append(t.pop());e.updateCustomScrollbar(a)},createChatBarContainer:function(t){var e=ogame.chat;if(t){var i=e.data[t];e.data.playerId=t;var n=$('<li class="chat_bar_list_item open" data-playerid="'+t+'"></li>');return n.append('<span class="playerstatus '+i.playerstatus+'"></span>'),n.append('<span class="cb_playername">'+i.playerName+"</span>"),n.append('<span class="icon icon_close fright"></span>'),n.prepend(e.createChatBox(t)),n}},createChatBarContainerForAssociations:function(t){var e=ogame.chat;if(t){var i=e.data.association[t];e.data.associationId=t;var n=$('<li class="chat_bar_list_item open" data-associationId="'+t+'"></li>');return n.append('<span class="playerstatus '+i.playerstatus+'"></span>'),n.append('<span class="cb_playername">'+i.associationName+"</span>"),n.append('<span class="icon icon_close fright"></span>'),n.prepend(e.createChatBoxForAssociations(t)),n}},closeChatBox:function(t,e){var i=$(".chat_bar_list_item");$.each(i,(function(i,n){(void 0!==t&&$(n).data("playerid")==t||void 0!==e&&$(n).data("associationid")==e)&&($(n).addClass("outOfChatbar"),$(n).removeClass("open"))}))},getVisibleChats:function(){return"undefined"==typeof visibleChats&&(visibleChats={chatbar:!1,players:[],associations:[]}),visibleChats},getVisibleChatPlayerIds:function(){for(var t=ogame.chat.getVisibleChats(),e={},i=0,n=0;n<t.players.length;n++)-1==$.inArray(t.players[n].partnerId,e)&&(e[i]=t.players[n].partnerId,i++);return e},getVisibleChatAssociationIds:function(){for(var t=ogame.chat.getVisibleChats(),e={},i=0,n=0;n<t.associations.length;n++)-1==$.inArray(t.associations[n].partnerId,e)&&(e[i]=t.associations[n],i++);return e},setVisibilityState:function(){for(var t=ogame.chat,e=t.getVisibleChatPlayerIds(),i=t.getVisibleChatAssociationIds(),n=$("#chatBar .chat_bar_list .chat_bar_list_item"),a=0;a<n.length;a++){var s=n.get(a),o=$(s).data("playerid"),r=$(s).data("associationid");if(void 0===o||t.isInJson(o,e))if(void 0===r||t.isInJson(r,i)){if(s.style.display="inline",$(s).hasClass("open"))$(s).find("div.chat_box")[0].style.display="inline",t.updateCustomScrollbar($(s).find(".chat_box_ctn"),1)}else t.closeChatBox(0,r);else t.closeChatBox(o,0)}},isInJson:function(t,e){var i=null;return $.isEmptyObject(e)&&(i=!1),!1!==i&&$.each(e,(function(e,n){n==t&&(i=!0)})),i},toggleVisibility:function(){$(".chat_bar_list_item .icon_close").on("click",(function(t){var e=$(this).parent().data("playerid"),i=$(this).closest(".chat_box");i.length||((i=$(this).parent()[0]).style.display="none"),e>0&&$.ajax({type:"POST",url:"/game/index.php?page=ajaxChatToggleVisibility",data:{from:playerId,to:e,showState:0},success:function(t){},error:function(t,e,i){}})})),$(".cb_playerlist_box .playerlist_item").on("click",(function(){var t=$(this).data("playerid");t&&$.ajax({type:"POST",url:"/game/index.php?page=ajaxChatToggleVisibility",data:{from:playerId,to:t,showState:1},success:function(t){},error:function(t,e,i){}})}))},initMaximize:function(){$(".chat_bar_list").on("click.chatBar",".chat_box .chat_box_title .icon_maximize",(function(){var t=$(this).parent(),e=$(t).parent().data("playerid");$.cookie("maximizeId",e),$(".chat_bar_list_item.open .chat_box_title .icon_close").trigger("click"),window.location=bigChatLink+"&playerId="+e}))},getInMaxChat:function(){var t=location.href;"undefined"==typeof bigChatLink&&(bigChatLink=""),bigChatLink==t&&null!==$.cookie("maximizeId")&&$("#chatMsgList .msg[data-playerId="+$.cookie("maximizeId")+"]").trigger("click"),$.cookie("maximizeId",null)},createChatBox:function(t){var e=ogame.chat;if(t){var i=e.data[t],n=$('<div class="chat_box_title"></div>');n.append('<span class="icon icon_close fright"></span>'),n.append('<span class="icon icon_maximize fright"></span>');for(var a=$('<div class="chat_box_ctn"><ul class="chat clearfix"></ul></div>'),s={},o=0;o<i.chatItemsByDateAsc.length;o++)s=i.chatItems[i.chatItemsByDateAsc[o]],a.find(".chat").append(e.createChatItem(s));var r=$('<div class="chat_box" data-playerid="'+t+'"></div>');return r.append(n),r.append(a),r.append('<textarea name="text" class="chat_box_textarea"></textarea>'),r}},createChatBoxForAssociations:function(t){var e=ogame.chat;if(t){var i=e.data.association[t],n=$('<div class="chat_box_title"></div>');n.append('<span class="icon icon_close fright"></span>'),n.append('<span class="icon icon_maximize fright"></span>');for(var a=$('<div class="chat_box_ctn"><ul class="chat clearfix"></ul></div>'),s={},o=0;o<i.chatItemsByDateAsc.length;o++)s=i.chatItems[i.chatItemsByDateAsc[o]],a.find(".chat").append(e.createChatItem(s));var r=$('<div class="chat_box" data-associationId="'+t+'"></div>');return r.append(n),r.append(a),r.append('<textarea name="text" class="chat_box_textarea"></textarea>'),r}},createChatItem:function(t){if(t){var e=$('<div class="msg_head"></div>');e.append('<span class="msg_date fright">'+getFormatedDate(t.date,"[d].[m].[Y] <span>[H]:[i]:[s]</span>")+"</span>"),e.append('<span class="msg_title blue_txt '+t.newClass+'">'+t.playerName+"</span>");var i=$('<li class="chat_msg '+t.altClass+'" data-chat-id="'+t.chatID+'"></li>');if(i.append(e),void 0!==t.refData){var n=$('<div class="referenceMsg"></div>'),a='<div class="refAuthor">'+t.refData.author+"</div>",s='<div class="refText new">'+t.refData.text+"</div>";n.append(a),n.append(s),i.append(n)}return i.append('<span class="msg_content">'+t.chatContent+"</span>"),i.append('<div class="speechbubble_arrow"></div>'),i}console.warn("no chatItem given")},createMoreBox:function(t){var e=$('<li class="chat_bar_list_item '+t+'">'+chatLoca.MORE_USERS+'<span class="icon icon_close fright"></span></li>');return e.prepend($('<div class="chat_box"><ul class="more_items clearfix"></ul></div>')),e},filterPlayerlist:function(){var t,e,i,n=[],a=$("#playerlistFilters").find('input[type="checkbox"]');(a.each((function(){n.push($(this).attr("id"))})),$(".playerlist_item").show(),t=!1,a.each((function(){$(this).prop("checked")&&(t=!0)})),t)&&$(".playerlist_item").filter((function(){e=!1,i=$(this),$.each(n,(function(t,n){"off"===i.data(n)&&$("#"+n).prop("checked")&&(e=!0)})),!0===e?i.hide():i.show()}))},initChatBar:function(t){var e=ogame.chat;ogame.chat.playerId=t,$("html").off(".chatBar"),$(window).resize((function(){e.updateChatBar()})),$(".chat_bar_list").on("click.chatBar","#chatBarPlayerList",(function(t){("chatBarPlayerList"===$(t.target).attr("id")||$(t.target).hasClass("onlineCount"))&&($(".cb_playerlist_box").toggle(),e.updateCustomScrollbar($(".scrollContainer"),!0),$.ajax({url:chatUrl,type:"POST",dataType:"json",data:{action:"toggleChatBar"},success:function(t){},error:function(t,e,i){}}))})).on("click.chatBar",".chat_bar_list_item",(function(t){t.stopPropagation(),isNaN($(this).data("playerid"))?isNaN($(this).data("associationid")>0)||e.saveMessageCounterAssociation(0,$(this).data("associationid")):(ogame.messagemarker.toggle(ogame.messagemarker.action_remove,ogame.messagemarker.type_chattab,$(this).data("playerid")),ogame.messagemarker.toggle(ogame.messagemarker.action_remove,ogame.messagemarker.type_chatbar,$(this).data("playerid")),e.saveMessageCounter(0,$(this).data("playerid")),ogame.messagemarker.setPartnerId($(this).data("playerid")),ogame.messagemarker.updateNewMarker(),ogame.chat.updateTotalNewChatCounter()),$.ajax({url:chatUrl,type:"POST",dataType:"json",data:{playerId:$(this).data("playerid"),action:"chatBarListRead"},success:function(t){},error:function(t,e,i){}}),$(this).closest(".more_items").length?e.swapChatBarItem($(this)):e.toggleChatBox($(t.target),$(this)),e.updateVisibleState()})).on("click.chatBar",".chat_bar_list_item > .icon_close",(function(t){t.stopPropagation();var i=$(this).closest(".chat_bar_list_item");ogame.chat.closeChatBox(i.attr("data-playerid"),i.attr("data-associationid")),i.remove("open"),e.updateChatBar()})).on("keyup.chatBar",".chat_box_textarea",(function(t){if(!t.ctrlKey&&10!=t.keyCode||13!=t.keyCode)$.trim($(this).val().length>0)&&(t.preventDefault(),e.submitChatBarMsg($(t.currentTarget),t.which,t.shiftKey,t.delegateTarget.scrollHeight));else{t.preventDefault();var i=$(this).val();$(this).val(i+"\n")}})).on("click.chatBar",".chat_box_textarea",(function(t){ogame.messagemarker.toggle(ogame.messagemarker.action_remove,ogame.messagemarker.type_chattab,$(this).parent().parent().parent().data("playerid")),ogame.messagemarker.toggle(ogame.messagemarker.action_remove,ogame.messagemarker.type_chatbar,$(this).parent().parent().parent().data("playerid")),$(this).data("playerid")>0?e.saveMessageCounter(0,$(this).data("playerid")):$(this).data("associationid")>0&&e.saveMessageCounterAssociation(0,$(this).data("associationid"))})).on("keydown.chatBar",".chat_box_textarea",(function(t){13==t.keyCode&&0==t.shiftKey&&t.preventDefault()}))},initPlayerlist:function(){var t=ogame.chat,e=ogame.tools;$(".js_accordion").accordion({collapsible:!0,heightStyle:"content"}),$(".playerlist_item:odd").addClass("odd"),e.addHover(".playerlist_item, .msg, .playerlist_top_box .playerlist"),$(".js_playerlist").on("click.playerList",".pl_filter_set",(function(){t.filterPlayerlist()})),t.filterPlayerlist()},showChat:function(t){var e,i=!1,n=ogame.chat;($(".chat_bar_list_item").each((function(){var e=$(this);(void 0!==t.playerId&&e.data("playerid")===t.playerId||void 0!==t.associationId&&e.data("associationid")===t.associationId)&&(i=!0,e.hasClass("outOfChatbar")&&e.removeClass("outOfChatbar"),e.hasClass("open")?e.fadeTo("400",.3).fadeTo("400",1):(e.click(),e[0].style.display="inline"),e.find("textarea").focus())})),i)||(e=void 0!==t.playerId?n.createChatBarContainer(t.playerId):n.createChatBarContainerForAssociations(t.associationId),n.updateChatBar(e))},showChatHistory:function(t){var e=$(".js_chatHistory"),i=t.data;e.length&&e.remove(),$("#chatList").remove(),$(i).insertAfter("#planet"),$("li.playerlist_item").removeClass("active"),$("li.playerlist_item[data-playerid='"+t.playerId+"']").addClass("active"),initBBCodeEditor(locaKeys,itemNames,!1,".new_msg_textarea",2e3,!0)},submitChatBarMsg:function(t,e,i,n){var a=ogame.chat,s=parseInt($(".chat_box_textarea").css("max-height")),o=parseInt($(".chat_box_textarea").css("padding-top"))+parseInt($(".chat_box_textarea").css("padding-bottom"));13===e&&i?n<=s+o&&t.css("height",n-o):13===e&&(void 0!==t.parent(".chat_box").data("playerid")?a.sendMessage(t.parent(".chat_box").data("playerid"),0,t.val()):void 0!==t.parent(".chat_box").data("associationid")&&a.sendMessage(0,t.parent(".chat_box").data("associationid"),t.val()),t.val(""))},swapChatBarItem:function(t){var e=ogame.chat,i=$(".more_chat_bar_items").prev();i.removeClass("open").find(".icon_close").hide().end().find(".chat_box").hide(),i.remove(),t.addClass("open").find(".icon_close").show().end().find(".chat_box").show().end().insertBefore(".more_chat_bar_items"),e.addToMoreBox([i]),e.updateChatBar(),e.updateCustomScrollbar(t.find(".chat_box_ctn"))},toggleChatBox:function(t,e){var i=ogame.chat;if(!t.parents(".chat_box").length||t.hasClass("icon_close")){var n=e.children(".chat_box");if(n.is(":visible"))n.hide(),e.removeClass("open");else{e.hasClass("more_chat_bar_items")||(e.addClass("open"),i.updateChatBar()),n.show();var a=n.find(".chat_box_ctn");e.hasClass("more_chat_bar_items")&&(a=n),i.updateCustomScrollbar(a),n.find("textarea").focus()}ogame.messagecounter.resetCounterByType(ogame.messagecounter.type_chat)}},handleTooMuchWindows:function(t,e,i,n,a,s){var o=ogame.chat,r=!0,l=[];$($(".chat_bar_list > .chat_bar_list_item").get().reverse()).each((function(){var o=$(this);if(r){if(o.hasClass("more_chat_bar_items")||"chatBarPlayerList"===o.attr("id"))return;o.hasClass("open")?t--:e--,o.removeClass("open").find(".icon_close").hide().end().find(".chat_box").hide(),l.push(o),o.remove(),widthTotal=n*e+i*t+a,r=widthTotal>=s}})),o.addToMoreBox(l)},getItemFromMorelist2Chatbar:function(){var t=$(".more_items .chat_bar_list_item").first().remove(),e=ogame.chat;t.addClass("open").find(".icon_close").show().end().find(".chat_box").show().end().insertBefore(".more_chat_bar_items"),$(".more_items .chat_bar_list_item").length<=0&&$(".more_chat_bar_items").remove(),e.updateCustomScrollbar($(".more_chat_bar_items>.chat_box")),e.updateCustomScrollbar(t.find(".chat_box_ctn"))},updateChatBar:function(t){var e=ogame.chat,i=$(".chat_bar_list > .chat_bar_list_item.open").length,n=$(".more_chat_bar_items").length,a=$(".chat_bar_list").children().length-i-n,s=$("body").innerWidth();t&&i++;var o=190*a+270*i+190*n;o>=s?e.handleTooMuchWindows(i,a,270,190,190,s):o+270<=s&&$(".more_chat_bar_items").length>0&&e.getItemFromMorelist2Chatbar(),t&&(t.insertAfter("#chatBarPlayerList"),e.updateCustomScrollbar(t.find(".chat_box_ctn")))},updateCustomScrollbar:function(t,e){t&&0!=t.length&&(t.hasClass("mCustomScrollbar")?t.mCustomScrollbar("update"):t.mCustomScrollbar({theme:"ogame"}),!0!==e&&t.mCustomScrollbar("scrollTo","bottom",{scrollInertia:0}),t.each((function(){$(this).height()+"px"==$(this).css("max-height")&&$(this).addClass("scrollbarPresent")})))},updateVisibleState:function(){var t={chatbar:!1,players:[],associations:[]};$(".chat_bar_list>.chat_bar_list_item").each((function(){var e=$(this);"chatBarPlayerList"===e.attr("id")&&e.children(".cb_playerlist_box").is(":visible")?t.chatbar=!0:e.data("playerid")&&e.children(".chat_box").is(":visible")?t.players.push(e.data("playerid")):e.data("associationid")&&e.children(".chat_box").is(":visible")&&t.associations.push(e.data("associationid"))})),$.cookie("visibleChats",JSON.stringify(t),{expires:7})},showPlayerList:function(t){var e=ogame.chat;window.deactivateChatBecauseOfLogout||(-1===$.inArray(t,e.playerListSelector)&&e.playerListSelector.push(t),!1===e.isLoadingPlayerList&&null===e.playerList?(e.isLoadingPlayerList=!0,console.log("showPlayerList() - Loading online buddies..."),$.ajax({url:"/buddies/online",type:"GET",dataType:"json",success:function(t){console.log("showPlayerList() - AJAX response received:",t),console.log("showPlayerList() - response.success:",t.success,"buddies count:",t.buddies?t.buddies.length:"undefined");var i='<div class="js_playerlist pl_container contentbox fleft">';i+='<h2 class="header"><span class="c-right"></span><span class="c-left"></span>Player list</h2>',i+='<div class="content">',i+='<div class="playerlist_box js_accordion ui-accordion ui-widget ui-helper-reset" role="tablist">',i+='<h3 class="ui-accordion-header ui-corner-top ui-state-default ui-accordion-header-active ui-state-active ui-accordion-icons" role="tab">',i+='<span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-s"></span>Buddies</h3>',i+='<div class="ui-accordion-content ui-corner-bottom ui-helper-reset ui-widget-content ui-accordion-content-active" role="tabpanel">',i+='<div class="playerlist_top_box"></div>',i+='<div class="scrollContainer"><ul class="playerlist">',t.success&&t.buddies&&t.buddies.length>0?t.buddies.forEach((function(t,e){var n=t.isOnline?"online":"offline",a=t.isOnline?"online":"offline";i+='<li class="playerlist_item '+(e%2==0?"":"odd")+'" data-playerid="'+t.id+'">',i+='<p class="playername">',i+='<span class="playerstatus tooltip '+n+'" data-tooltip-title="'+a+'"></span>',i+=t.username+"</p>",i+='<span class="new_msg_count noMessage" data-playerid="'+t.id+'" data-new-messages="0">0</span>',i+='<span class="chatstatus cs_active fright"></span>',i+="</li>"})):i+='<li class="no_buddies">No buddies</li>',i+="</ul></div></div></div>",i+='<div class="playerlist_box js_accordion ui-accordion ui-widget ui-helper-reset" role="tablist">',i+='<h3 class="ui-accordion-header ui-corner-top ui-state-default ui-accordion-icons" role="tab">',i+='<span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Alliance</h3>',i+='<div class="ui-accordion-content ui-corner-bottom ui-helper-reset ui-widget-content" role="tabpanel" style="display: none;">',i+='<div class="playerlist_top_box"></div>',i+='<div class="scrollContainer"><ul class="playerlist">',i+='<li class="no_buddies">Alliance chat not yet implemented</li>',i+="</ul></div></div></div>",i+='<div class="playerlist_box js_accordion ui-accordion ui-widget ui-helper-reset" role="tablist">',i+='<h3 class="ui-accordion-header ui-corner-top ui-state-default ui-accordion-icons" role="tab">',i+='<span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Strangers</h3>',i+='<div class="ui-accordion-content ui-corner-bottom ui-helper-reset ui-widget-content" role="tabpanel" style="display: none;">',i+='<div class="playerlist_top_box"></div>',i+='<div class="scrollContainer"><ul class="playerlist">',i+='<li class="no_buddies">Strangers list not yet implemented</li>',i+="</ul></div></div></div>",i+="</div>",i+='<div class="footer"><div class="c-right"></div><div class="c-left"></div></div>',i+="</div>",e.playerList=i,e.isLoadingPlayerList=!1,console.log("showPlayerList() - playerList set, calling _showPlayerList()"),e._showPlayerList()},error:function(t,i,n){console.error("showPlayerList() - Error loading buddies:",i,n),e.isLoadingPlayerList=!1,e.playerList='<div class="content"><p>Error loading buddies</p></div>',e._showPlayerList()}})):(console.log("showPlayerList() - Using cached player list"),e._showPlayerList()))},_showPlayerList:function(){var t=ogame.chat;$.each(t.playerListSelector,(function(e,i){$(i).html(t.playerList)}))}};let characterClassArr=["neutral","miner","warrior","explorer"],allianceClassArr=["neutral","warrior","trader","explorer"],characterClassBonuses={warrior:{109:2,110:2,111:2}},allianceClassBonuses={warrior:{109:1,110:1,111:1}};function isJsonString(t){try{JSON.parse(t)}catch(t){return!1}return!0}function isReportString(t){let[e,i,n,a]=t.split("-");return 50===t.length&&"sr"===e&&i===js_serverlang&&n===js_serverid&&!1!==t.match("/sr-"+js_serverlang+"-"+js_serverid+"[A-Z]{40}/g")&&40===a.length||(showNotification(combatSimLoca.LOCA_COMBATSIM_INVALID_DATA+" "+combatSimLoca.LOCA_COMBATSIM_INVALID_API,"warning"),!1)}function loadPlanetAction(t,e,i,n){let a={_token:token};t&&(a.planetId=t),$.ajax({url:simBackendUrl+"&action=loadPlanet",data:a,type:"POST",dataType:"json",success:function(t){"object"==typeof t.planetData?(token=t.newAjaxToken,fillData($(e.closest("fleet-content")[0]),t.planetData,i,n),showNotification(combatSimLoca.LOCA_COMBATSIM_PLANET_LOADED,"success")):(token=t.newAjaxToken,t.errors&&t.errors.length&&showNotification(t.errors[0].message,"error"))},error:function(){showNotification(combatSimLoca.LOCA_ERROR_DEFAULT,"error")}})}function loadSpyReport(t,e,i,n){if(!e||!e.length)return;let a={_token:token};t&&(a.reportHash=t),$.ajax({url:simBackendUrl+"&action=loadReport",data:a,type:"POST",dataType:"json",success:function(a){"object"==typeof a.planetData?(token=a.newAjaxToken,adjustResearchClassBonuses(a.planetData),fillData($(e.closest("fleet-content")[0]),a.planetData,i,n),$("fleet-content[data-participant-id=0][data-attack-type=2] input[name='apikey']").val(t),showNotification(a.message,"success"),simChanged(e)):(token=a.newAjaxToken,a.errors&&a.errors.length&&showNotification(a.errors[0].message,"error"))},error:function(){showNotification(combatSimLoca.LOCA_ERROR_DEFAULT,"error")}})}function adjustResearchClassBonuses(t){let e=findClassName(characterClassArr,t.characterClassId??0);characterClassBonuses[e]&&Object.keys(characterClassBonuses[e]).forEach((i=>{t.researches[i]>0&&(t.researches[i]=Math.max(0,t.researches[i]-characterClassBonuses[e][i]))})),e=findClassName(allianceClassArr,t.allianceClassId??0),allianceClassBonuses[e]&&Object.keys(allianceClassBonuses[e]).forEach((i=>{t.researches[i]>0&&(t.researches[i]=Math.max(0,t.researches[i]-allianceClassBonuses[e][i]))}))}function simChanged(t){$(t).attr("max")&&$(t).val(Math.min(parseInt($(t).attr("max")),parseInt($(t).val()))||0),$(t).attr("min")?$(t).val(Math.max(parseInt($(t).attr("min")),parseInt($(t).val()))||$(t).attr("min")):$(t).val(Math.max(0,$(t).val())),0===$("gradient-button button#saveCombatPlanning div.emoji").length&&$('<div class="emoji warningsign tooltipLeft" title="'+combatSimLoca.LOCA_COMBATSIM_DATA_CHANGED+'"></div>').insertBefore($("gradient-button button#saveCombatPlanning span")),combatSimChanged=!0,$("#showCombatResultShortInfo").prop("disabled",!0).data("target",""),$("#saveCombatPlanning").removeAttr("disabled"),$("#simulateCombatPlanning").prop("disabled",!0)}function switchSpaceObject(t){let e=$(t);if(e.hasClass("selected"))return!1;let i=$(e.closest("basic-data")[0]);i.find(".togglePanel ul").hide().removeClass("active"),i.find(".planetSelection div").removeClass("selected"),e.addClass("selected");let n="planet";e.hasClass("moon")&&(n="moon"),i.find(".togglePanel ul."+n).show().addClass("active");let a=i.find(".togglePanel").find("ul."+n+" li:first");i.find(".toggleLink").attr("data-selected-planetid",a.data("planetid")).data("selectedPlanetid",a.data("planetid")),i.find(".togglePanel").hide(),i.find(".togglePanel li").removeClass("selected"),i.find(".togglePanel ul #"+a.data("planetid")).addClass("selected"),i.find(".toggleLink").html(a.html())}function changeClass(t,e,i){let n=characterClassArr,a=characterClassBonuses;"allianceclass"===i&&(n=allianceClassArr,a=allianceClassBonuses);const s=findClassId(n,e),o=$(t).closest("class-selection"),r=o.find("input").first(),l=t.closest("fleet-content"),c=findClassName(n,""===r.data("classId")?0:parseInt(r.data("classId")));r.data("classId",s),r.attr("data-class-id",s),r.prop("checked",!1);o.find(i+"-icon").each(((t,e)=>{n.forEach((t=>{$(e).removeAttr(t)})),targetId=t+1,targetId===s&&(targetId=0),$(e).attr(n[targetId],!0)})),a[c]&&Object.keys(a[c]).forEach((t=>{const e=$(l).find(".technology-row input[name='amount["+t+"]']").first(),i=0===e.val().length?0:parseInt(e.val()),n=0===(e.attr("min")??"").length?0:parseInt(e.attr("min"));e.val(Math.max(0,i-a[c][t])),e.attr("min",Math.max(0,n-a[c][t]))})),a[e]&&Object.keys(a[e]).forEach((t=>{const i=$(l).find(".technology-row input[name='amount["+t+"]']").first(),n=0===i.val().length?0:parseInt(i.val()),s=0===(i.attr("min")??"").length?0:parseInt(i.attr("min"));i.val(n+a[e][t]),i.attr("min",s+a[e][t])})),simChanged(o)}function fillData(t,e,i,n){let a;changeClass(t.find("characterclass-icon"),characterClassArr[0],"characterclass"),changeClass(t.find("allianceclass-icon"),allianceClassArr[0],"allianceclass"),$.each(e.researches,(function(e,i){a=$(t.find(".technology-row input[name='amount["+e+"]']")[0]),a.val(i)}));let s=0;characterClassArr[parseInt(e.characterClassId)]&&(s=parseInt(e.characterClassId)),changeClass(t.find("characterclass-icon"),characterClassArr[s],"characterclass"),allianceClassArr[parseInt(e.allianceClassId)]&&(s=parseInt(e.allianceClassId)),changeClass(t.find("allianceclass-icon"),allianceClassArr[s],"allianceclass"),$.each(e.ships,(function(e,i){a=$(t.find(".technology-row input[name='amount["+e+"]']")[0]),a.val(i.amount),a=$(t.find(".technology-fullrow input[name='weapon["+e+"]']")[0]),a.val((Math.floor(1e4*i.weapon)/100).toFixed(2)),a=$(t.find(".technology-fullrow input[name='shield["+e+"]']")[0]),a.val((Math.floor(1e4*i.shield)/100).toFixed(2)),a=$(t.find(".technology-fullrow input[name='armor["+e+"]']")[0]),a.val((Math.floor(1e4*i.armor)/100).toFixed(2)),a=$(t.find(".technology-fullrow input[name='cargo["+e+"]']")[0]),a.val((Math.floor(1e4*i.cargo)/100).toFixed(2)),a=$(t.find(".technology-fullrow input[name='speed["+e+"]']")[0]),a.val((Math.floor(1e4*i.speed)/100).toFixed(2)),a=$(t.find(".technology-fullrow input[name='fuel["+e+"]']")[0]),a.val((Math.floor(1e4*i.fuel)/100).toFixed(2))})),a=$(t.find(".technology-fullrow input[name='classBonus[1]']")[0]),a.val((Math.floor(1e4*e.bonuses.characterClassBooster[1])/100).toFixed(2)),a=$(t.find(".technology-fullrow input[name='classBonus[2]']")[0]),a.val((Math.floor(1e4*e.bonuses.characterClassBooster[2])/100).toFixed(2)),a=$(t.find(".technology-fullrow input[name='classBonus[3]']")[0]),a.val((Math.floor(1e4*e.bonuses.characterClassBooster[3])/100).toFixed(2)),a=$(t.find("fleetspeed-section input[value='"+e.fleetspeed+"']")[0]),a.prop("checked",!0);let o={};"object"==typeof e.coords?(o[0]=e.coords.galaxy,o[1]=e.coords.system,o[2]=e.coords.position):o=e.coords.split(":"),$(t.find("coordinates-section input[name='galaxy']")[0]).val(o[0]),$(t.find("coordinates-section input[name='system']")[0]).val(o[1]),$(t.find("coordinates-section input[name='position']")[0]).val(o[2]),!0===i&&(t=$("combatsim-section[base-defender] fleet-content"),$.each(e.resources,(function(e,i){a=$(t.find(".resource-row input[name='resource["+e+"]']")[0]),a.val(i)})),$.each(e.ships,(function(e,i){a=$(t.find(".technology-row input[name='amount["+e+"]']")[0]),a.val(i.amount)})),$.each(e.defenses,(function(e,i){a=$(t.find(".technology-row input[name='amount["+e+"]']")[0]),a.val(i.amount),a=$(t.find(".technology-fullrow input[name='weapon["+e+"]']")[0]),a.val((Math.floor(1e4*i.weapon)/100).toFixed(2)),a=$(t.find(".technology-fullrow input[name='shield["+e+"]']")[0]),a.val((Math.floor(1e4*i.shield)/100).toFixed(2)),a=$(t.find(".technology-fullrow input[name='armor["+e+"]']")[0]),a.val((Math.floor(1e4*i.armor)/100).toFixed(2))})),a=$(t.find(".technology-fullrow input[name='special[11112]']")[0]),a.val((Math.floor(1e4*e.bonuses.lifeformProtection)/100).toFixed(2)),a=$(t.find(".technology-fullrow input[name='special[12112]']")[0]),a.val((Math.floor(1e4*e.bonuses.spaceDockExtender)/100).toFixed(2)),a=$(t.find(".technology-fullrow input[name='special[13112]']")[0]),a.val((Math.floor(1e4*e.bonuses.recycleAttackerFleet)/100).toFixed(2)),a=$(t.find(".technology-fullrow input[name='special[14112]']")[0]),a.val((Math.floor(1e4*e.bonuses.moonChanceIncrease)/100).toFixed(2)),a=$(t.find(".technology-fullrow input[name='denCapacity[22]']")[0]),a.val((Math.floor(1e4*e.bonuses.denCapacity.metal)/100).toFixed(2)),a=$(t.find(".technology-fullrow input[name='denCapacity[23]']")[0]),a.val((Math.floor(1e4*e.bonuses.denCapacity.crystal)/100).toFixed(2)),a=$(t.find(".technology-fullrow input[name='denCapacity[24]']")[0]),a.val((Math.floor(1e4*e.bonuses.denCapacity.deuterium)/100).toFixed(2)),$.each(e.missiles,(function(e,i){a=$(t.find(".technology-row input[name='amount["+e+"]']")[0]),a.val(i.amount)}))),simChanged(t)}function clearPlayer(t){let e=$(t).data("participantId"),i=$(t).data("attackType");$("fleet-content[data-participant-id="+e+"][data-attack-type="+i+"] fleetspeed-section input").prop("checked",!1),$("fleet-content[data-participant-id="+e+"][data-attack-type="+i+"] fleetspeed-section input[value='10']").prop("checked",!0);let n=$("fleet-content[data-participant-id="+e+"][data-attack-type="+i+"]");changeClass(n.find("characterclass-icon"),characterClassArr[0],"characterclass"),changeClass(n.find("allianceclass-icon"),allianceClassArr[0],"allianceclass"),n.find("research-section input").val(""),n.find("ship-section input").val(""),n.find("defense-section input").val(""),n.find("coordinates-section input").val(""),n.find("lifeform-data input").val(""),simChanged(t)}function clearTechnologies(t){let e=$(t).data("participantId"),i=$(t).data("attackType");$("fleet-content[data-participant-id="+e+"][data-attack-type="+i+"] ship-section input").val(""),$("fleet-content[data-participant-id="+e+"][data-attack-type="+i+"] defense-section input").val(""),simChanged(t)}function expandLifeforms(t){let e=$(t).closest("combatsim-section");"1"===e.attr("show-lifeform")?e.attr("show-lifeform","0"):e.attr("show-lifeform","1")}function showSpaceObjectSelection(t){$($(t).closest("basic-data")[0]).find(".js_togglePanel").toggle()}function selectSpaceObject(t){let e=$(t),i=e.closest("basic-data");i.find(".toggleLink").attr("data-selected-planetid",e.data("planetid")).data("selectedPlanetid",e.data("planetid")),i.find(".togglePanel").hide(),i.find(".togglePanel li").removeClass("selected"),i.find(".togglePanel ul #"+e.data("planetid")).addClass("selected"),i.find(".toggleLink").html(e.html())}function loadPlanetInfo(t){let e=$(t).closest("div.selectWrapper").find(".toggleLink").first(),i=$(t).data("attackType"),n=2===i&&$(t).data("participantId")===$("fleet-content[data-attack-type=2]").first().data("participantId");loadPlanetAction(e.data("selectedPlanetid"),$(t),n,i),simChanged(t)}function loadInfoParticipant(t){let e=$(t).closest("div.load_data").find("input").first(),i=e.data("attackType"),n=2===i&&e.data("participantId")===$("fleet-content[data-attack-type=2]").first().data("participantId");isJsonString(e.val())?fillData($(t).closest("fleet-content"),JSON.parse(e.val()),n,i):isReportString(e.val())&&loadSpyReport(e.val(),$(t),n,i)}function selectCharacterClass(t){let e="neutral";characterClassArr.forEach((i=>{t.attributes[i]&&(e=i)})),changeClass(t,e,"characterclass")}function selectAllianceClass(t){let e="neutral";allianceClassArr.forEach((i=>{t.attributes[i]&&(e=i)})),changeClass(t,e,"allianceclass")}function switchParticipant(t){if($(t).hasClass("active"))return;let e=$(t).data("attackType"),i=$(t).data("participantId"),n=$(t).closest("combatsim-section");$('participant-header[data-attack-type="'+e+'"]').removeClass("active"),$('participant-header[data-attack-type="'+e+'"][data-participant-id="'+i+'"]').addClass("active"),$('fleet-content[data-attack-type="'+e+'"]:not(fleet-content[base-defender])').hide(),$('fleet-content[data-attack-type="'+e+'"][data-participant-id="'+i+'"]').show(),$(n.find("fleet-section-clear .clearPlayer")).attr("data-participant-id",i).data("participantId",i).attr("data-attack-type",e).data("attackType",e),$(n.find("fleet-section-clear .clearTechnologies")).attr("data-participant-id",i).data("participantId",i).attr("data-attack-type",e).data("attackType",e)}function deleteRequest(t){let e=$(t).data("simulationId");if(0===e)return;let i=$("single-simulation[data-simulation-id="+e+"] .creation").html(),n=$("single-simulation[data-simulation-id="+e+"] .target span").html(),a=combatSimLoca.LOCA_COMBATSIM_DELETE_REQUEST.replace("#date#",i).replace("#target#",n);errorBoxDecision(combatSimLoca.LOCA_COMBATSIM_DELETE,a,jsloca.LOCA_ALL_YES,jsloca.LOCA_ALL_NO,(function(){deleteSim(e)}))}function deleteSim(t){let e={_token:token,simId:t};$.ajax({url:simBackendUrl+"&action=deleteSim",data:e,type:"POST",dataType:"json",success:function(t){token=t.newAjaxToken,"failure"!==t.status?"success"===t.status&&($("combatsim-list single-simulation[data-simulation-id="+t.simId+"]").remove(),showNotification(t.message,"success"),combatSimId===t.simId&&(combatSimId=0,loadSimDetails(),$("#deleteCombatPlanning").attr("disabled",!0).attr("data-simulation-id",0).data("simulationId",0),newCombatPlanning()),0===$("combatsim-list owned-sims single-simulation").length&&$("combatsim-list owned-sims").append('<div className="noentries">'+combatSimLoca.LOCA_COMBATSIM_NO_SIMS_FOUND+"</div>"),$("combatsim-list .entryCount .current").html($("combatsim-list single-simulation").length)):showNotification(t.errors[0].message,"error")},error:function(){showNotification(combatSimLoca.LOCA_ERROR_DEFAULT,"error")}})}function saveSimName(t){let e=$(t).data("simulationId");if(0===e||e!==combatSimId)return;let i=$("combatsim-name input[name=simulationName]").val(),n={_token:token,simId:e,simName:i};$.ajax({url:simBackendUrl+"&action=saveSimName",data:n,type:"POST",dataType:"json",success:function(t){token=t.newAjaxToken,"failure"!==t.status?"success"===t.status&&($("combatsim-list single-simulation[data-simulation-id="+t.simData.simId+"] .state span.simName").text(" - "+t.simData.simName),$("combatsim-shortinfo .shortName span").text(t.simData.simName),showNotification(t.message,"success")):showNotification(t.errors[0].message,"error")},error:function(){showNotification(combatSimLoca.LOCA_ERROR_DEFAULT,"error")}})}function filterPlayerNames(t){if($(t).val().length>=3){const e=Object.values(playerNames).filter((e=>e.name.toLowerCase().includes($(t).val().toLowerCase()))).filter((function(t){return this.count<5&&t.id>0&&(this.count++,!0)}),{count:0});showUsers(e)}}function loadSimInfo(t){let e=$(t).data("simulationId");if(!0===combatSimChanged){let t=$("single-simulation[data-simulation-id="+e+"] .creation").html(),i=$("single-simulation[data-simulation-id="+e+"] .target span").html(),n=combatSimLoca.LOCA_COMBATSIM_UNSAVED.replace("#date#",t).replace("#target#",i);errorBoxDecision(jsloca.LOCA_NOTIFY_WARNING,n,jsloca.LOCA_ALL_YES,jsloca.LOCA_ALL_NO,(function(){loadSim(e)}))}else loadSim(e)}function saveRequest(){let t=combatSimId;if(!0===combatSimProgress){let e=$("single-simulation[data-simulation-id="+t+"] .creation").html(),i=$("single-simulation[data-simulation-id="+t+"] .target span").html(),n=combatSimLoca.LOCA_COMBATSIM_RESULTS_ERASE.replace("#date#",e).replace("#target#",i);errorBoxDecision(jsloca.LOCA_NOTIFY_WARNING,n,jsloca.LOCA_ALL_YES,jsloca.LOCA_ALL_NO,(function(){saveSim()}))}else saveSim()}function saveSim(){let t,e,i,n,a=$("div#combatsim"),s={},o={},r=0,l=$(a.find("combatsim-section[base-defender] fleet-content")[0]),c=l.data("participantId");if(l=$('fleet-content[data-attack-type="2"][data-participant-id="'+c+'"]:not(fleet-content[base-defender])'),0===$(l.find("coordinates-section input[name='galaxy']")[0]).val().length||0===$(l.find("coordinates-section input[name='system']")[0]).val().length||0===$(l.find("coordinates-section input[name='position']")[0]).val().length)return void showNotification(combatSimLoca.LOCA_COMBATSIM_INVALID_TARGET,"warning");if(a.find("fleet-content").each((function(){if(t=$(this),e=t.data("participantId"),void 0===e)return;i=t.data("attackType"),n=1===i?s:o,n[e]||(n[e]={resources:{},researches:{},ships:{},defenses:{},missiles:{},bonuses:{},fleetspeed:10,allianceClassId:$(t.find("basic-data class-selection input.allianceClass")[0]).data("classId"),characterClassId:$(t.find("basic-data class-selection input.characterClass")[0]).data("classId"),coords:{galaxy:$(t.find("coordinates-section input[name='galaxy']")[0]).val(),system:$(t.find("coordinates-section input[name='system']")[0]).val(),position:$(t.find("coordinates-section input[name='position']")[0]).val()}});let a,c,d=$(t.find("fleetspeed-section")[0]);d.length&&(n[e].fleetspeed=d.find("input[name='speed["+i+"]["+e+"]']:checked").val()),$(t.find("research-section")[0]).find("input").each((function(){if(a=$(this).data("technologyId"),a>=100&&a<200){n[e].researches[a]=parseInt(0===$(this).val().length?0:$(this).val());const t=findClassName(characterClassArr,n[e].characterClassId);characterClassBonuses[t]&&characterClassBonuses[t][a]&&(n[e].researches[a]=Math.max(0,n[e].researches[a]-characterClassBonuses[t][a]));const i=findClassName(allianceClassArr,n[e].allianceClassId);allianceClassBonuses[i]&&allianceClassBonuses[i][a]&&(n[e].researches[a]=Math.max(0,n[e].researches[a]-allianceClassBonuses[i][a]))}}));let u=t.find("lifeform-data").first();$(t.find("ship-section")[0]).find("input").each((function(){a=$(this).data("technologyId"),a>=200&&a<300&&(r+=parseInt(0===$(this).val().length?0:$(this).val()),n[e].ships[a]={amount:parseInt(0===$(this).val().length?0:$(this).val()),weapon:u.find("input[name='weapon["+a+"]']").val()/100,shield:u.find("input[name='shield["+a+"]']").val()/100,armor:u.find("input[name='armor["+a+"]']").val()/100,cargo:u.find("input[name='cargo["+a+"]']").val()/100,speed:u.find("input[name='speed["+a+"]']").val()/100,fuel:u.find("input[name='fuel["+a+"]']").val()/100})})),t.find(".resource-row input").each((function(){$(this).data("resource")&&(n[e].resources[$(this).data("resource")]=parseInt(0===$(this).val().length?0:$(this).val()))})),u.find("characterclass-bonus input").each((function(){c=$(this).data("classId"),c>0&&(n[e].bonuses.characterClassBooster={1:parseFloat(0===u.find("input[name='classBonus[1]']").val().length?0:u.find("input[name='classBonus[1]']").val()/100),2:parseFloat(0===u.find("input[name='classBonus[2]']").val().length?0:u.find("input[name='classBonus[2]']").val()/100),3:parseFloat(0===u.find("input[name='classBonus[3]']").val().length?0:u.find("input[name='classBonus[3]']").val()/100)})})),$(t.find("defense-section")[0]).find("input").each((function(){a=$(this).data("technologyId"),a>=200&&a<300&&(r+=parseInt(0===$(this).val().length?0:$(this).val()),n[e].ships[a]={amount:parseInt(0===$(this).val().length?0:$(this).val()),weapon:l.find("lifeform-data input[name='weapon["+a+"]']").val()/100,shield:l.find("lifeform-data input[name='shield["+a+"]']").val()/100,armor:l.find("lifeform-data input[name='armor["+a+"]']").val()/100,cargo:l.find("lifeform-data input[name='cargo["+a+"]']").val()/100,speed:l.find("lifeform-data input[name='speed["+a+"]']").val()/100,fuel:l.find("lifeform-data input[name='fuel["+a+"]']").val()/100}),a>=400&&a<500&&(r+=parseInt(0===$(this).val().length?0:$(this).val()),n[e].defenses[a]={amount:parseInt(0===$(this).val().length?0:$(this).val()),weapon:u.find("input[name='weapon["+a+"]']").val()/100,shield:u.find("input[name='shield["+a+"]']").val()/100,armor:u.find("input[name='armor["+a+"]']").val()/100}),a>=500&&a<600&&(n[e].missiles[a]={amount:parseInt(0===$(this).val().length?0:$(this).val())}),n[e].bonuses.denCapacity={metal:parseFloat(0===u.find("input[name='denCapacity[22]']").val().length?0:u.find("input[name='denCapacity[22]']").val()/100),crystal:parseFloat(0===u.find("input[name='denCapacity[23]']").val().length?0:u.find("input[name='denCapacity[23]']").val()/100),deuterium:parseFloat(0===u.find("input[name='denCapacity[24]']").val().length?0:u.find("input[name='denCapacity[24]']").val()/100)},n[e].bonuses.lifeformProtection=parseFloat(0===u.find("input[name='special[11112]']").val().length?0:u.find("input[name='special[11112]']").val()/100),n[e].bonuses.moonChanceIncrease=parseFloat(0===u.find("input[name='special[12112]']").val().length?0:u.find("input[name='special[12112]']").val()/100),n[e].bonuses.recycleAttackerFleet=parseFloat(0===u.find("input[name='special[13112]']").val().length?0:u.find("input[name='special[13112]']").val()/100),n[e].bonuses.spaceDockExtender=parseFloat(0===u.find("input[name='special[14112]']").val().length?0:u.find("input[name='special[14112]']").val()/100)})),$(t.find("misc-section")[0]).length&&(n[e].engineerActive=$("#square-checkboxEngineer").is(":checked"),n[e].lootFood=$("#square-checkboxFoodLoot").is(":checked"),n[e].lootModifier=$("misc-section input[name=lootModifier]:checked").val()),1===i?s=n:o=n})),Object.keys(s).length+Object.keys(o).length>combatSimMaxParticipants)return void showNotification(combatSimLoca.LOCA_COMBATSIM_TOO_MUCH_PARTICIPANTS.replace("#number#",combatSimMaxParticipants),"error");if(r>combatSimMaxShips)return void showNotification(combatSimLoca.LOCA_COMBATSIM_TOO_MUCH_SHIPS.replace("#number#",combatSimMaxShips.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")),"error");let d={_token:token,simId:combatSimId,participants:JSON.stringify({attacker:s,defender:o})};$.ajax({url:simBackendUrl+"&action=saveSim",data:d,type:"POST",dataType:"json",success:function(t){if(token=t.newAjaxToken,"object"==typeof t.simData){combatSimChanged=!1;let e=combatSimId;$("gradient-button button#saveCombatPlanning div.emoji").remove(),$("#saveCombatPlanning").prop("disabled",!0),showNotification(t.message,"success"),$("combatsim-shortinfo .shortSimId span").html(t.simData.simId),$("combatsim-shortinfo .shortTarget span").html(t.simData.simName+" "+t.simData.target),$("combatsim-shortinfo .shortAttackerCount span").html(t.simData.attackerCount),$("combatsim-shortinfo .shortDefenderCount span").html(t.simData.defenderCount),$("combatsim-shortinfo .shortShipCount span").html(t.simData.shipCount),combatSimId=t.simData.simId,$("#deleteCombatPlanning").attr("data-simulation-id",combatSimId).data("simulationId",combatSimId),0===t.simData.isOwner?($("#deleteCombatPlanning").removeAttr("disabled"),$("#simulateCombatPlanning").removeAttr("disabled"),1===$("combatsim-list owned-sims .noentries").length&&$("combatsim-list owned-sims .noentries").remove()):($("#deleteCombatPlanning").prop("disabled",!0),$("#simulateCombatPlanning").prop("disabled",!0)),0===$("combatsim-list single-simulation[data-simulation-id="+t.simData.simId+"]").length?0===t.simData.isOwner&&$("combatsim-list owned-sims").append(t.simData.singleSimTemplate):($("combatsim-list single-simulation[data-simulation-id="+t.simData.simId+"] .target span").html(t.simData.target),$("combatsim-list single-simulation[data-simulation-id="+t.simData.simId+"] .attackerCount span").html(t.simData.attackerCount),$("combatsim-list single-simulation[data-simulation-id="+t.simData.simId+"] .defenderCount span").html(t.simData.defenderCount),$("combatsim-list single-simulation[data-simulation-id="+t.simData.simId+"] .shipCount span").html(t.simData.shipCount)),$("combatsim-list .entryCount .current").html($("combatsim-list owned-sims single-simulation").length),e!==combatSimId&&loadSimDetails()}"failure"===t.status&&(showNotification(t.errors[0].message,"error"),280001===t.errors[0].error&&(newCombatPlanning(),$("combatsim-list single-simulation[data-simulation-id="+d.simId+"]").remove()))},error:function(){showNotification(combatSimLoca.LOCA_ERROR_DEFAULT,"error")}})}function removeCombatSim(t){combatSimId===t&&(combatSimId=0,newCombatPlanning()),$(`combatsim-list single-simulation[data-simulation-id="${t}"]`).remove()}function changeCombatSimState(t,e){let i=$(`combatsim-section[overview] single-simulation[data-simulation-id='${t}'] .state .status`),n=$(`combatsim-section[overview] single-simulation[data-simulation-id='${t}'] sim-actions button.overlay`),a=$("#showCombatResultShortInfo");switch(n.hide(),e){case 1:i.text(jsloca.COMBATSIM_PENDING).removeClass("planning done").addClass("pending");break;case 2:i.text(jsloca.COMBATSIM_DONE).removeClass("planning pending").addClass("done"),n.show(),a.removeAttr("disabled").attr("data-target",n.data("target"));break;default:i.text(jsloca.COMBATSIM_PLANNING).removeClass("pending done").addClass("planning")}}function loadSim(t){let e={_token:token,simId:t};$.ajax({url:simBackendUrl+"&action=loadSim",data:e,type:"POST",dataType:"json",success:function(e){if(token=e.newAjaxToken,"success"===e.status){let t;newCombatPlanning(),$("combatsim-shortinfo .shortSimId span").html(e.simData.simId),$("combatsim-shortinfo .shortName span").html(e.simData.simName),$("combatsim-shortinfo .shortTarget span").html("["+e.simData.galaxy+":"+e.simData.system+":"+e.simData.position+"]"),$("combatsim-shortinfo .shortAttackerCount span").html(e.simData.attackerCount),$("combatsim-shortinfo .shortDefenderCount span").html(e.simData.defenderCount),$("combatsim-shortinfo .shortShipCount span").html(e.simData.shipCount),combatSimId=e.simData.simId,$("#deleteCombatPlanning").removeAttr("disabled").attr("data-simulation-id",combatSimId).data("simulationId",combatSimId),e.simData.attackerCount>1&&(t=$("combatsim-section[data-attack-type=1]").first(),Object.keys(e.simData.data.attacker).slice(1).forEach((e=>{addParticipant(t,e)}))),e.simData.defenderCount>1&&(t=$("combatsim-section[data-attack-type=2]").first(),Object.keys(e.simData.data.defender).slice(1).forEach((e=>{addParticipant(t,e)})));let i=1,n=!1;Object.keys(e.simData.data.attacker).forEach((t=>{adjustResearchClassBonuses(e.simData.data.attacker[t]),fillData($("fleet-content[data-participant-id="+t+"][data-attack-type=1]").first(),e.simData.data.attacker[t],n,i)})),i=2,n=!0,Object.keys(e.simData.data.defender).forEach((t=>{adjustResearchClassBonuses(e.simData.data.defender[t]);const a=e.simData.data.defender[t];!0===n&&(t=0,!0===a.engineerActive?$("#square-checkboxEngineer").attr("checked",!0):$("#square-checkboxEngineer").removeAttr("checked"),!0===a.lootFood?$("#square-checkboxFoodLoot").attr("checked",!0):$("#square-checkboxFoodLoot").removeAttr("checked"),$("fleet-content[base-defender] misc-section input[name='lootModifier']").removeAttr("checked"),$("#round-radioLootModifier"+Math.floor((a.lootModifier-.25)/.25)).attr("checked",!0)),fillData($("fleet-content[data-participant-id="+t+"][data-attack-type=2]").first(),a,n,i),n=!1})),combatSimChanged=!1,$("gradient-button button#saveCombatPlanning div.emoji").remove(),0===parseInt(e.simData.type)?($("#deleteCombatPlanning").removeAttr("disabled"),!0===e.simStateProgress?$("#simulateCombatPlanning").prop("disabled",!0):$("#simulateCombatPlanning").removeAttr("disabled")):($("#deleteCombatPlanning").prop("disabled",!0),$("#simulateCombatPlanning").prop("disabled",!0)),$("#saveCombatPlanning").prop("disabled",!0),loadSimDetails(),showNotification(e.message,"success")}else showNotification(e.errors[0].message,"error"),280001===e.errors[0].error&&(newCombatPlanning(),$("combatsim-list single-simulation[data-simulation-id="+t+"]").remove())},error:function(){showNotification(combatSimLoca.LOCA_ERROR_DEFAULT,"error")}})}function addParticipant(t,e=null){let i=t.data("attackType");if(t.attr("show-lifeform","0"),t.find("participants-headline").show(),t.find(".removeParticipantBtn").removeClass("disabled"),null===e&&(e=t.find("participants-headline participant-header").last().data("participantId")+1),$("participant-header").length>=combatSimMaxParticipants)return void showNotification(combatSimLoca.LOCA_COMBATSIM_TOO_MUCH_PARTICIPANTS.replace("#number#",combatSimMaxParticipants),"error");$(t.find("participant-header")).removeClass("active");let n=[{attackType:i,participantId:e}].map(participantHeaderTemplate).join("");t.find("participants-headline participant-header").last().clone(!0).attr("data-participant-id",$(n).data("participantId")).data("participantId",$(n).data("participantId")).attr("data-attack-type",$(n).data("attackType")).data("attackType",$(n).data("attackType")).addClass("active").html($(n).html()).insertAfter(t.find("participants-headline participant-header").last());let a=[{attackType:i,participantId:e}].map(fleetContentTemplate).join("");2===i&&(a=a.replace(/tabindex=\"(\d.*?)\"/g,(function(t,e){return'tabindex="'+(parseInt(e)+200)+'"'})));let s=t.find("fleet-content").last().clone(!0),o=$(a);$(t.find("fleet-content")).hide(),o.find("lifeform-data technology-icon[solarsatellite]").closest("div.technology-fullrow").hide(),o.find("lifeform-data technology-icon[resbuggy]").closest("div.technology-fullrow").hide(),s.attr("data-participant-id",o.data("participantId")).data("participantId",o.data("participantId")).attr("data-attack-type",o.data("attackType")).data("attackType",o.data("attackType")).html(o.html()).show().insertAfter(t.find("fleet-content").last()),t.find("participants-headline participant-header p").each((function(t,e){$(e).html(t+1)})),$(t.find("fleet-section-clear .clearPlayer")).attr("data-participant-id",e).data("participantId",e).attr("data-attack-type",i).data("attackType",i),$(t.find("fleet-section-clear .clearTechnologies")).attr("data-participant-id",e).data("participantId",e).attr("data-attack-type",i).data("attackType",i),simChanged(t)}function newCombatPlanning(){let t,e=0,i=$("div#combatsim");i.find("combatsim-section:not(combatsim-section[base-defender]):not(combatsim-section[overview])").each(((i,n)=>{const a=$(n);a.attr("show-lifeform","0"),t=$(a.find("thick-headline-background")[0]).data("attackType"),a.find("participants-headline participant-header").remove();let s=[{attackType:t,participantId:e}].map(participantHeaderTemplate).join("");a.find("participants-headline").hide().append(s),a.find("participants-headline participant-header p").each((function(t,e){$(e).html(t+1)}));let o=[{attackType:t,participantId:e}].map(fleetContentTemplate).join("");2===t&&(o=o.replace(/tabindex=\"(\d.*?)\"/g,(function(t,e){return'tabindex="'+(parseInt(e)+200)+'"'}))),a.find("fleet-content").remove();let r=$(o);2!==t&&(r.find("lifeform-data technology-icon[solarsatellite]").closest("div.technology-fullrow").hide(),r.find("lifeform-data technology-icon[resbuggy]").closest("div.technology-fullrow").hide()),r.insertBefore(a.find("fleet-section-clear")),$(a.find("fleet-section-clear .clearPlayer")).attr("data-participant-id",0).data("participantId",0).attr("data-attack-type",t).data("attackType",t),$(a.find("fleet-section-clear .clearTechnologies")).attr("data-participant-id",0).data("participantId",0).attr("data-attack-type",t).data("attackType",t)})),i.find("fleet-content[base-defender] misc-section input").removeAttr("checked"),i.find("fleet-content[base-defender] misc-section #round-radioLootModifier2").attr("checked",!0),i.find("combatsim-section[base-defender] basic-data .resource-row input").val(""),i.find("combatsim-section[base-defender] basic-data defense-section input").val(""),i.find("combatsim-section[base-defender] lifeform-data input").val(""),i.find("combatsim-section[base-defender] lifeform-data").hide(),i.find("combatsim-section[base-defender]").attr("show-lifeform","0"),combatSimChanged=!1,$("gradient-button button#saveCombatPlanning div.emoji").remove(),combatSimId=0,loadSimDetails(),$("#deleteCombatPlanning").attr("disabled",!0).attr("data-simulation-id",0).data("simulationId",0),$("combatsim-shortinfo div > span").html("-"),$("#showCombatResultShortInfo").prop("disabled",!0).attr("data-target",""),$("#saveCombatPlanning").prop("disabled",!0),$("#simulateCombatPlanning").prop("disabled",!0),$(".removeParticipantBtn").addClass("disabled")}function resetAnim(t){let e=$(t);e.find(".togglePanel").hide(),e.find("class-selection input").prop("checked",!1)}function invitePlayerToSim(t){let e=$(t).data("simulationId"),i=$(t).data("playerId");if($("shared-participant").length>=combatSimMaxParticipants)showNotification(combatSimLoca.LOCA_COMBATSIM_TOO_MUCH_PARTICIPANTS.replace("#number#",combatSimMaxParticipants),"error");else if(0!==combatSimId&&e===combatSimId){let t={_token:token,simId:e,playerId:i};$.ajax({url:simBackendUrl+"&action=invitePlayer",data:t,type:"POST",dataType:"json",success:function(t){token=t.newAjaxToken,"failure"!==t.status?"success"===t.status&&(showNotification(t.message,"success"),loadSimDetails()):showNotification(t.errors[0].message,"error")}})}}function removeParticipant(t){let e=$(t).data("simulationId"),i=$(t).data("playerId");if(0!==combatSimId&&e===combatSimId){let t={_token:token,simId:e,playerId:i};$.ajax({url:simBackendUrl+"&action=removePlayer",data:t,type:"POST",dataType:"json",success:function(t){token=t.newAjaxToken,"failure"!==t.status?"success"===t.status&&(showNotification(t.message,"success"),loadSimDetails()):showNotification(t.errors[0].message,"error")}})}}function loadSimDetails(){if(0===combatSimId)$("fleet-content[siminfo]").html('<div class="noentries">'+combatSimLoca.LOCA_COMBATSIM_NO_SIMS_FOUND+"</div>");else{let t={_token:token,simId:combatSimId};$.ajax({url:simInfoUrl,data:t,type:"POST",dataType:"json",success:function(t){if(token=t.newAjaxToken,$("fleet-content[siminfo]").html(t.content[t.target]),updateSimShortInfo($("combatsim-intro combatsim-shortinfo")),combatSimProgress){let t=$(`combatsim-section[overview] single-simulation[data-simulation-id='${combatSimId}'] sim-actions button.overlay`);$("#showCombatResultShortInfo").removeAttr("disabled").attr("data-target",t.data("target"))}}})}}function updateSimShortInfo(t){t&&t.length&&($("combatsim-shortinfo .shortSimId span").text(t.find(".shortSimId span").first().text()),$("combatsim-shortinfo .shortTarget span").text(t.find(".shortTarget span").first().text()),$("combatsim-shortinfo .shortAttackerCount span").text(t.find(".shortAttackerCount span").first().text()),$("combatsim-shortinfo .shortDefenderCount span").text(t.find(".shortDefenderCount span").first().text()),$("combatsim-shortinfo .shortShipCount span").text(t.find(".shortShipCount span").first().text()))}function joinCombatSim(t,e){let i={_token:token,simId:t,playerId:e};$.ajax({url:simBackendUrl+"&action=joinSim",data:i,type:"POST",dataType:"json",success:function(t){token=t.newAjaxToken,"failure"!==t.status?"success"===t.status&&(showNotification(t.message,"success"),window.open(combatSimUrl)):showNotification(t.errors[0].message,"error")},error:function(){}})}function startSimulation(t){let e={_token:token,simId:combatSimId};$.ajax({url:simBackendUrl+"&action=startSim",data:e,type:"POST",dataType:"json",success:function(t){token=t.newAjaxToken,"failure"!==t.status?"success"===t.status&&(loadSimDetails(),$("#simulateCombatPlanning").prop("disabled",!0),showNotification(t.message,"success")):showNotification(t.errors[0].message,"error")},error:function(){}})}function closeCombatSimResultOverlay(){$(".overlayDiv.combatSimResultOverlay").length&&$(".overlayDiv.combatSimResultOverlay").remove()}function getRoundData(t,e,i="attacker"){let n={},a={},s={};if("undefined"==typeof combatData)return s;let{combatRounds:o}=combatData;if(!o[t])return s;let r=o[t];return"all"!==e?(r[`${i}Ships`]&&r[`${i}Ships`][e]&&(n=r[`${i}Ships`][e]),r[`${i}Losses`]&&r[`${i}Losses`][e]&&(a=r[`${i}Losses`][e])):(r[`${i}ShipsTotal`]&&(n=r[`${i}ShipsTotal`]),r[`${i}LossesInThisRoundTotal`]&&(a=r[`${i}LossesInThisRoundTotal`])),Object.keys(n).map((t=>{s[t]||(s[t]={remaining:0,lost:0}),s[t].remaining=n[t]})),Object.keys(a).map((t=>{s[t]||(s[t]={remaining:0,lost:0}),s[t].lost=a[t]})),s}function selectRound(t){let e="all";$("#combatSimReport .attacker .participant_select").length&&(e=$("#combatSimReport .attacker .participant_select").val()),displayRoundData(t,e,"attacker");let i="all";$("#combatSimReport .defender .participant_select").length&&(i=$("#combatSimReport .defender .participant_select").val()),displayRoundData(t,i,"defender"),displayRoundStatistics(t),$(".selectRoundBtn").removeAttr("disabled"),$(`.selectRoundBtn[data-round-number=${t}]`).prop("disabled",!0)}function displayRoundData(t,e,i="attacker"){let n=getRoundData(t,e,i);$(`#combatSimRounds .combat_participant.${i} .military_ships > li`).hide().removeClass("even odd"),$(`#combatSimRounds .combat_participant.${i} .civil_ships > li`).hide().removeClass("even odd"),$(`#combatSimRounds .combat_participant.${i} .defence_techs > li`).hide().removeClass("even odd"),Object.keys(n).map((t=>{let{remaining:e,lost:a}=n[t];(e||a)&&($(`#${i}CombatSimTechRow_${t}`).show(),$(`#${i}CombatSimTechRow_${t} .detail_shipsleft`).text(e),$(`#${i}CombatSimTechRow_${t} .detail_shipslost`).text(-a))}));let a=0;"all"!==e&&(a=e),$(`.${i}CharacterClass characterclass-icon`).removeAttr(characterClassArr.join(" ")).attr(findClassName(characterClassArr,combatData[i][a].characterClassId),!0),$(`.${i}AllianceClass allianceclass-icon`).removeAttr(allianceClassArr.join(" ")).attr(findClassName(allianceClassArr,combatData[i][a].allianceClassId),!0);let s=0;$(`#combatSimRounds .combat_participant.${i} .military_ships li`).each((function(t,e){$(e).is(":visible")&&(s%2==0?$(e).addClass("odd"):$(e).addClass("even"),s++)})),$(`#combatSimRounds .combat_participant.${i} .combatShipsTitle`).show(),s||$(`#combatSimRounds .combat_participant.${i} .combatShipsTitle`).hide(),s=0,$(`#combatSimRounds .combat_participant.${i} .civil_ships li`).each((function(t,e){$(e).is(":visible")&&(s%2==0?$(e).addClass("odd"):$(e).addClass("even"),s++)})),$(`#combatSimRounds .combat_participant.${i} .civilShipsTitle`).show(),s||$(`#combatSimRounds .combat_participant.${i} .civilShipsTitle`).hide(),s=0,$(`#combatSimRounds .combat_participant.${i} .defence_techs li`).each((function(t,e){$(e).is(":visible")&&(s%2==0?$(e).addClass("odd"):$(e).addClass("even"),s++)})),$(`#combatSimRounds .combat_participant.${i} .defenceTechsTitle`).show(),s||$(`#combatSimRounds .combat_participant.${i} .defenceTechsTitle`).hide()}function getRoundStatistic(t){let e={absorbedDamageAttacker:0,absorbedDamageDefender:0,fullStrengthAttacker:0,fullStrengthDefender:0,hitsAttacker:0,hitsDefender:0};if("undefined"==typeof combatData)return e;let{combatRounds:i}=combatData;if(!i[t])return e;let n=i[t];return n.statistic&&(e=n.statistic),e}function displayRoundStatistics(t){let e=getRoundStatistic(t);Object.keys(e).map((t=>{$(`#${t}`).text(e[t])}))}function getCombatResearchPercentages(t,e="all"){let i={weaponPercentage:0,shieldPercentage:0,armorPercentage:0};if("undefined"==typeof combatData)return i;if(!combatData[t])return i;if("all"===e)combatData[t].map((t=>{t.weaponPercentage&&(i.weaponPercentage+=t.weaponPercentage),t.shieldPercentage&&(i.shieldPercentage+=t.shieldPercentage),t.armorPercentage&&(i.armorPercentage+=t.armorPercentage)})),i.weaponPercentage/=combatData[t].length,i.shieldPercentage/=combatData[t].length,i.armorPercentage/=combatData[t].length;else if(combatData[t]&&combatData[t][e]){let n=combatData[t][e];n.weaponPercentage&&(i.weaponPercentage=n.weaponPercentage),n.shieldPercentage&&(i.shieldPercentage=n.shieldPercentage),n.armorPercentage&&(i.armorPercentage=n.armorPercentage)}return i}function displayCombatResearchPercentages(t,e){let i=getCombatResearchPercentages(t,e);$(`#combatSimRounds .combat_participant.${t} .${t}Weapon span`).text(`${i.weaponPercentage}%`),$(`#combatSimRounds .combat_participant.${t} .${t}Shield span`).text(`${i.shieldPercentage}%`),$(`#combatSimRounds .combat_participant.${t} .${t}Cover span`).text(`${i.armorPercentage}%`)}function findClassName(t,e){return t[e]??t[0]}function findClassId(t,e){return Math.max(0,t.indexOf(e))}function formatTimeWrapper(t,e,i,n,a,s){let o={week:604800,day:86400,hour:3600,minute:60,second:1},r="";for(let s in o){let l=Math.floor(t/o[s]);e>0&&(l>0||a&&""!==r)&&(t-=l*o[s],""!==r&&(r+=n,l<10&&l>0&&a&&(l="0"+l),0===l&&(l="00")),r+=l+(i?LocalizationStrings.timeunits.short[s]:""),e--)}return t>0&&(r=s+r),r}function reload_page(t){timerHandler&&!timerHandler.pageReloadAlreadyTriggered&&(timerHandler.pageReloadAlreadyTriggered=!0,openParentLocation(t))}$((function(){$("thick-headline-background .minimizeBtn").on("click",(function(t){t.preventDefault(),t.stopPropagation(),$(t.currentTarget).hasClass("minimized")?($(t.currentTarget).removeClass("minimized").html("&#128469;&#xFE0E;"),$("combatsim-section[overview] combatsim-list").show(),$("combatsim-section[overview] combatsim-shortinfo").show(),$("combatsim-section[overview] combatsim-actions").removeAttr("style"),$("combatsim-section[overview]").removeAttr("minimized")):($(t.currentTarget).addClass("minimized").html("&#128470;&#xFE0E;"),$("combatsim-section[overview] combatsim-list").hide(),$("combatsim-section[overview] combatsim-shortinfo").hide(),$("combatsim-section[overview] combatsim-actions").css("flex-direction","row").css("width","100%"),$("combatsim-section[overview]").attr("minimized",!0))})),$("thick-headline-background .addParticipantBtn").on("click",(function(t){t.preventDefault(),t.stopPropagation(),addParticipant($($(t.currentTarget).closest("combatsim-section")[0]))})),$("thick-headline-background .removeParticipantBtn").on("click",(function(t){t.preventDefault(),t.stopPropagation();let e=$(t.currentTarget).closest("thick-headline-background").data("attackType"),i=$(t.currentTarget).closest("combatsim-section");if(1===i.find("participant-header").length)return;let n=i.find("participant-header.active").first(),a=n.data("participantId");const s=i.find("fleet-content[data-participant-id="+a+"][data-attack-type="+e+"]"),o={galaxy:s.find("coordinates-section input[name='galaxy']").first().val(),system:s.find("coordinates-section input[name='system']").first().val(),position:s.find("coordinates-section input[name='position']").first().val()};s.remove(),n.remove(),i.find("participants-headline participant-header p").each((function(t,e){$(e).html(t+1)}));let r=i.find("fleet-content").first().data("participantId");i.find("fleet-content[data-participant-id="+r+"][data-attack-type="+e+"]").show(),i.find("participants-headline participant-header[data-participant-id="+r+"][data-attack-type="+e+"]").addClass("active").show(),1===i.find("participant-header").length&&(i.find("participants-headline").hide(),i.find(".removeParticipantBtn").addClass("disabled")),$(i.find("fleet-section-clear .clearPlayer")).attr("data-participant-id",r).data("participantId",r).attr("data-attack-type",e).data("attackType",e),$(i.find("fleet-section-clear .clearTechnologies")).attr("data-participant-id",r).data("participantId",r).attr("data-attack-type",e).data("attackType",e);let l=$("fleet-content[data-attack-type=2]:not(fleet-content[base-defender])").first();l.find("lifeform-data technology-icon[solarsatellite]").closest("div.technology-fullrow").show(),l.find("lifeform-data technology-icon[resbuggy]").closest("div.technology-fullrow").show();let c=l.find("coordinates-section input[name='galaxy']").first(),d=l.find("coordinates-section input[name='system']").first(),u=l.find("coordinates-section input[name='position']").first();""!==c.val()&&""!==d.val()&&""!==u.val()||(c.val(o.galaxy),d.val(o.system),u.val(o.position)),$("fleet-content[base-defender]").attr("data-participant-id",l.data("participantId")).data("participantId",l.data("participantId")),simChanged(i)})),$("gradient-button #newCombatPlanning").on("click",(function(t){t.preventDefault(),t.stopPropagation(),newCombatPlanning()})),$("gradient-button #saveCombatPlanning").on("click",(function(t){t.preventDefault(),t.stopPropagation()}))})),$(document).ready((function(){let t=new URL(document.location).searchParams.get("reportHash");t&&loadSpyReport(t,$("fleet-content[data-participant-id=0][data-attack-type=2] .loadInfoParticipant"),!0,2)}));class SimpleCountdownTimer{constructor(t,e,i,n){this.timestamp=0,this.maxDigits=2,this.delimiter=" ",this.approx="",this.showunits=!0,this.zerofill=!1,this.startTime=(new Date).getTime(),this.startLeftoverTime=parseInt(e),this.targetName=t,this.reloadPage=i,this.countdownDoneFunction=n,this.timer=timerHandler.appendCallback(this.updateCountdown.bind(this)),this.updateCountdown()}get getTimer(){return this.timer}get getCurrentTimestring(){return formatTimeWrapper(this.getLeftoverTime(),this.maxDigits,this.showunits,this.delimiter,this.zerofill,this.approx)}getLeftoverTime(){let t=new Date;return Math.round(this.startLeftoverTime+-1*(t.getTime()-this.startTime)/1e3)}updateCountdown(){this.getLeftoverTime()>0?$(this.targetName).text(this.getCurrentTimestring):($(this.targetName).text(LocalizationStrings.status.ready),"function"==typeof this.countdownDoneFunction&&this.countdownDoneFunction(),null!=this.reloadPage&&reload_page(this.reloadPage),timerHandler.removeCallback(this.timer))}}class CountdownTimer{constructor(t,e,i,n,a,s=2,o=-1){this.countValue=parseInt(o),this.timestamp=0,this.maxDigits=parseInt(s),this.delimiter=" ",this.approx="",this.showunits=!0,this.zerofill=!1,this.startTime=(new Date).getTime(),this.startLeftoverTime=parseInt(e),this.targetName=t,this.reloadPage=i,this.countdownDoneFunction=n,this.primaryReloadViaWS=a,this.timer=timerHandler.appendCallback(this.updateCountdown.bind(this)),this.updateCountdown()}get getCurrentTimestring(){return formatTimeWrapper(this.getLeftoverTime(),this.maxDigits,this.showunits,this.delimiter,this.zerofill,this.approx)}getLeftoverTime(){let t=new Date;return Math.round(this.startLeftoverTime+(t.getTime()-this.startTime)*this.countValue/1e3)}updateCountdown(){this.getLeftoverTime()>0?$(`time.${this.targetName}`).text(this.getCurrentTimestring):($(`time.${this.targetName}`).text(LocalizationStrings.status.ready),"function"==typeof this.countdownDoneFunction&&this.countdownDoneFunction(),null==this.reloadPage||isOverlayOpen()||this.primaryReloadViaWS&&(!0!==this.primaryReloadViaWS||!0===ogame.frontendActions.connected)||reload_page(this.reloadPage),timerHandler.removeCallback(this.timer))}}class CountdownTimerUnit{constructor(t,e,i,n,a,s,o=2){this.timestamp=0,this.maxDigits=parseInt(o),this.delimiter=" ",this.approx="",this.showunits=!0,this.zerofill=!1,this.startTime=(new Date).getTime(),this.startLeftoverTime=parseInt(e),this.shipCount=i,this.timePerUnit=a,this.targetTechnologyId=n,this.targetName=t,this.reloadPage=s,this.timer=timerHandler.appendCallback(this.updateCountdown.bind(this)),this.updateCountdown()}get getCurrentTimestring(){return formatTimeWrapper(this.getLeftoverTime(),this.maxDigits,this.showunits,this.delimiter,this.zerofill,this.approx)}getLeftoverTime(){let t=new Date;return Math.round(this.startLeftoverTime+-1*(t.getTime()-this.startTime)/1e3)}updateCountdown(){let t=this.getLeftoverTime(),e=parseInt($(`li.technology[data-technology=${this.targetTechnologyId}] span.amount`).attr("data-value")),i=Math.max(0,t)/this.timePerUnit;$(`time.${this.targetName}`).text(this.getCurrentTimestring),i>0?$(`li.technology[data-technology=${this.targetTechnologyId}][data-status="active"] .cooldownBackground`).css("height",100*i+"%"):(this.shipCount>0&&(this.shipCount--,e++),this.shipCount>=0&&$(`.shipSumCount.${this.targetName}`).text(this.shipCount),$(`li.technology[data-technology=${this.targetTechnologyId}] span.amount`).attr("data-value",e),$(`li.technology[data-technology=${this.targetTechnologyId}] span.amount .stockAmount`).text(gfNumberGetHumanReadable(e)),this.shipCount>0?(this.startTime=(new Date).getTime(),this.startLeftoverTime=this.timePerUnit,$(`time.${this.targetName}`).text(LocalizationStrings.status.ready)):(t<=-1&&t>-6&&(null==this.reloadPage||isOverlayOpen()||reload_page(this.reloadPage),timerHandler.removeCallback(this.timer)),$(`time.${this.targetName}`).text(LocalizationStrings.status.ready)))}}function oldcountdown(t,e,i){null!=e&&""!=e||(e=2);var n=this;n.countValue=parseInt(i)||-1,n.timestamp=0,n.maxDigits=parseInt(e),n.delimiter=" ",n.approx="",n.showunits=!0,n.zerofill=!1;var a=new Date;n.startTime=a.getTime(),n.startLeftoverTime=parseInt(t),this.getCurrentTimestring=function(){return formatTimeWrapper(n.getLeftoverTime(),n.maxDigits,n.showunits,n.delimiter,n.zerofill,n.approx)},this.getLeftoverTime=function(){var t=new Date;return Math.round(n.startLeftoverTime+(t.getTime()-n.startTime)*n.countValue/1e3)}}function eventboxCountdown(t,e,i,n,a){if("object"==typeof t){var s=this;s.timeHtmlObj=t,this.updateCountdown=function(){s.countdown.getCurrentTimestring();var t=s.countdown.getLeftoverTime(),e=s.countdown.getCurrentTimestring();t>0?$(s.timeHtmlObj).html(e):(timerHandler.removeCallback(s.timer),$(s.timeHtmlObj).html(LocalizationStrings.status.ready),timerHandler.checkEventsAlreadyQueued||(timerHandler.checkEventsAlreadyQueued=!0,setTimeout((function(){$.post(n,{ids:a},(function(t){var e=$.parseJSON(t);for(var n in e.rows)$(i).find("#eventRow-"+e.rows[n]).remove(),$(".union"+e.rows[n]).remove();$(".eventFleet").removeClass("odd"),$(".partnerInfo").removeClass("part-even"),$(".eventFleet:odd").addClass("odd"),$(".partnerInfo:even").addClass("part-even"),timerHandler.checkEventsAlreadyQueued=!1}))}),2500)))},s.timeHtmlObj&&(s.countdown=new oldcountdown(e,3),s.timer=timerHandler.appendCallback(s.updateCountdown),s.updateCountdown())}}function simpleCountdown(t,e,i,n){if("object"==typeof t){var a=this;a.timeHtmlObj=$(t)[0],this.updateCountdown=function(){var t=a.countdownObject.getLeftoverTime(),e=a.countdownObject.getCurrentTimestring();t>0?($("#"+a.timeHtmlObj.id).text(e),"string"==typeof n&&$.isFunction(window[n])?window[n]():$.isFunction(n)&&n()):(timerHandler.removeCallback(a.timer),$("#"+a.timeHtmlObj.id).text(LocalizationStrings.status.ready),"string"==typeof i&&$.isFunction(window[i])?window[i]():$.isFunction(i)&&i())},void 0!==a.timer&&timerHandler.removeCallback(a.timer),a.timeHtmlObj&&(a.countdownObject=new oldcountdown(e,3),a.timer=timerHandler.appendCallback(a.updateCountdown),a.updateCountdown())}}function countdownWithTickFunction(t,e,i,n,a,s){if("object"==typeof t){var o=this;return o.timeHtmlObj=t,void 0!==$(t).attr("data-oldcountdown")&&timerHandler.removeCallback($(t).attr("data-oldcountdown")),this.updateCountdown=function(){timestamp=o.countdown.getLeftoverTime(),timestring=o.countdown.getCurrentTimestring(),timestamp>0?(o.timeHtmlObj.innerHTML=timestring,"string"==typeof a&&$.isFunction(window[a])?window[a](timestamp,i):$.isFunction(a)&&a(timestamp,i)):(timerHandler.removeCallback(o.timer),o.timeHtmlObj.innerHTML=LocalizationStrings.status.ready,"string"==typeof n&&$.isFunction(window[n])?window[n]():$.isFunction(n)&&n())},o.timeHtmlObj&&(o.countdown=new oldcountdown(e,s),o.timer=timerHandler.appendCallback(o.updateCountdown),o.updateCountdown(),$(t).attr("data-oldcountdown",o.timer)),o}}function movementImageCountdown(t,e,i,n,a,s){if("object"==typeof t){var o=this;o.timeHtmlObj=t,this.updateCountdown=function(){o.countdown.getCurrentTimestring();var t=o.countdown.getLeftoverTime();o.countdown.getCurrentTimestring();t>0&&(percent=clampFloat(t/i,0,1),pixel=n?Math.abs(s*percent):Math.abs(s-s*percent),pixel=clampInt(Math.round(pixel),0,s),a?o.timeHtmlObj.style.marginRight=pixel+"px":o.timeHtmlObj.style.marginLeft=pixel+"px")},o.timeHtmlObj&&(o.countdown=new oldcountdown(e,3),timerHandler.appendCallback(o.updateCountdown),o.updateCountdown())}}function initItemActivation(t){if(inventoryObj.initalizeSlider(inventoryObj.items_inventory,"js_activeItemSlider",395,172," ",!0," ",!0,!0),void 0===t||0==t.length||1==t){var e=$(".item_img_box .detail_button").filter(":first");if(0===e.length)return $("#noItems").show(),void $("#itemDetailBox").hide();$.bbq.pushState({item:e.attr("ref")})}else $.bbq.pushState({item:t}),$(window).trigger("hashchange");$("#activeBuffDetails .js_is_active").each((function(){$durationEl=$(this).parent().siblings(".js_duration"),$pusherEl=$(this).parent().siblings(".pusher"),startCooldown($durationEl,$pusherEl,75)})),$(document).undelegate("#activeBuffDetails .detail_button","click.updateItemDetails").delegate("#activeBuffDetails .detail_button","click.updateItemDetails",(function(){$(this).hasClass("active")||($("#activeBuffDetails .detail_button").removeClass("active"),$(this).addClass("active"),$.bbq.pushState({item:$(this).attr("ref")}))})).undelegate("#activeBuffDetails .build-it","click.activateItem").delegate("#activeBuffDetails .build-it","click.activateItem",(function(){activateItem($(this).attr("ref"))})).undelegate("#activeBuffDetails .buyAndActivate.dm.build-it_disabled","click.activateItem").delegate("#activeBuffDetails .buyAndActivate.dm.build-it_disabled","click.activateItem",(function(){if(!vacation){var t=$(this).attr("ref");0!=$("#js_activeItemSlider>li a[ref='"+t+"']").length&&errorBoxDecision(LocalizationStrings.error,translation.buyDMDecision,LocalizationStrings.yes,LocalizationStrings.no,(function(){window.location.href=$("#darkmatter_box a").attr("href")}))}})).undelegate("#activeBuffDetails .close_detail","click.changeHash").delegate("#activeBuffDetails .close_detail","click.changeHash",(function(){$.bbq.pushState({item:""})}))}function initBuffBar(){let t=$(".sliderWrapper .active_items");t.anythingSlider({buildNavigation:!1,buildStartStop:!1,infiniteSlides:!1,stopAtEnd:!0}),t.removeClass("hidden"),$(window).unbind("hashchange.openBuffBar").bind("hashchange.openBuffBar",(function(t){var e=$.deparam.fragment(t.fragment);if(void 0!==e.item){var i=$("#buffBar .activate_item");$("#buffBar a").removeClass("active");var n=e.item;if(""!=n)if($("#activeBuffDetails:visible").length){if(void 0===inventoryObj.items_inventory[n]){var a=$("#activeBuffDetails .detail_button").filter(":first");return void $.bbq.pushState({item:a.attr("ref")})}$("#buffBar a[ref='"+e.item+"']").addClass("active"),i.addClass("active"),$("#noItems").hide(),$("#itemDetailBox").show(),updateItemDetails(n)}else $("#buffBar a[ref='"+e.item+"']").addClass("active"),i.addClass("active"),gfSlider.slideIn(getElementByIdWithCache("detail"),n);else 0===$("#activeBuffDetails .detail_button").filter(":first").length&&($("#noItems").show(),$("#itemDetailBox").hide()),$("#activeBuffDetails .close_details").click(),i.removeClass("active")}})),$(document).undelegate("#buffBar a","click.openDetails").delegate("#buffBar a","click.openDetails",(function(){$(this).hasClass("active")?$.bbq.pushState({item:""}):$.bbq.pushState({item:$(this).attr("ref")})})),$("#buffBar").unbind("click.openDetails").bind("click.openDetails",(function(t){$(t.target).is("#buffBar .activate_item")||$(t.target).is(".arrow a")||$("#buffBar .activate_item").click()})),$("#buffBar .active_items div:not(.activate_item)").each((function(){$durationEl=$(this).find(".js_duration"),$pusherEl=$(this).find(".pusher"),startCooldown($durationEl,$pusherEl,32)})),$(window).trigger("hashchange")}function getItem(t){return void 0!==inventoryObj.items_inventory[t]?inventoryObj.items_inventory[t]:null}function updateItemDetails(t){var e=getItem(t);$("#activeBuffDetails .detail_button").removeClass("active"),$('#activeBuffDetails .detail_button[ref="'+t+'"]').addClass("active"),$("#activeBuffDetails .js_itemName").html(e.name),$("#activeBuffDetails .js_itemEffect").html(e.effect),$("#activeBuffDetails .js_itemAmount").html(e.amount),e.firstStatus?$("#activeBuffDetails .js_itemDurationStatus").html(translation.durationType[e.firstStatus]):$("#activeBuffDetails .js_itemDurationStatus").html(translation.durationType.effecting),e.duration?e.durationExtension?$("#activeBuffDetails .js_itemDuration").html(formatTimeWrapper(e.duration,2,!0," ",!1,"")+e.durationExtension):$("#activeBuffDetails .js_itemDuration").html(formatTimeWrapper(e.duration,2,!0," ",!1,"")):null===e.duration?e.moonOnlyItem?$("#activeBuffDetails .js_itemDuration").html(translation.permanentMoon):$("#activeBuffDetails .js_itemDuration").html(translation.permanent):$("#activeBuffDetails .js_itemDuration").html(translation.now),e.timeLeft?($("#activeBuffDetails .js_itemTimeLeftTxt").show(),$("#activeBuffDetails .js_itemTimeLeft").html(formatTimeWrapper(e.timeLeft,2,!0," ",!1,""))):$("#activeBuffDetails .js_itemTimeLeftTxt").hide();var i=$("#activationButton");if(i.attr("ref",t),i.removeClass("buyAndActivate activateItem build-it_disabled build-it dm bp").addClass(e.currency),e.amount>0)i.addClass("activateItem").html("<span>"+(e.timeLeft>0&&e.extendable?translation.extend:translation.activate)+"</span>").addClass(e.canBeActivated?"build-it":"build-it_disabled");else{var n=e.timeLeft>0&&e.extendable?translation.buyAndExtend:translation.buyAndActivate;n=(n=n.replace(/%price%/,tsdpkt(e.costs))).replace(/%currency%/,translation.currencies[e.currency]),i.addClass("buyAndActivate").html("<span>"+n+"</span>").addClass(e.canBeBoughtAndActivated&&e.hasEnoughCurrency?"build-it":"build-it_disabled")}}let startedActivation=!1;function noHandlerItemActivation(){startedActivation=!1}function activateItem(t){if(startedActivation)return;startedActivation=!0;var e={_token:token,itemUuid:t,referrerPage:$.deparam.querystring().page},i=getItem(t);let n="buyAndActivate";function a(){$.ajax({cache:!1,url:inventoryObj.inventoryUrl+`&itemUuid=${t}&action=${n}`,data:e,type:"GET",dataType:"json",success:function(e,i,n){if(token=e.newAjaxToken,"success"==e.status)if(e.reload)location.href=getRedirectLink();else{if(fadeBox(e.message,!1),!1!==e.buff){var a,s=getItem(e.buff),o=!0,r=$(".active_items"),l=r.data("AnythingSlider");if(r.find("li a").removeClass("active"),r.find("li a.activate_item").addClass("active"),r.find("div[data-id="+e.buffId+"]").each((function(){$(this).hide().show("pulsate").find("a").addClass("active"),o=!1,a=$(this)})),1==o){var c=$('<div data-uuid="'+e.buff+'" data-id="'+e.buffId+'"><div class="js_duration" style="display: none;"></div><a href="javascript:void(0);" ref="'+e.buff+'" class="detail_button slideIn active_item active r_'+e.item.rarity+" border3px tooltipHTML\" title='"+e.tooltip+'\'><div class="pusher" style="height: 0%; "></div><img src="/cdn/img/item-images/'+e.item.image+'-small.png" alt=""/></a></div>'),d=l.currentPage,u=l.options.animationTime;e.upgraded&&r.find("div[data-id="+e.upgraded+"]").remove(),r.children().last().children().length<14?(c.hide().appendTo(r.children().last()).show("pulsate"),d==l.pages&&(l.options.animationTime=0),l.gotoPage(l.pages),d==l.pages&&(l.options.animationTime=u)):((c=c.hide().wrap("<li/>")).parent().appendTo(r).children().last(),l.updateSlider(),d==l.pages&&(l.options.animationTime=0),l.gotoPage(l.pages),d==l.pages&&(l.options.animationTime=u),c.show("pulsate")),a=c}else{var h=$('<div data-uuid="'+s.ref+'" data-id="'+e.buffId+'"><div class="js_duration" style="display: none;"></div><a href="javascript:void(0);" ref="'+s.ref+'" class="detail_button slideIn active_item active r_'+e.item.rarity+' border3px tooltipHTML" title="'+e.item.toolTip+'"><div class="pusher" style="height: 0%; "></div><img src="/cdn/img/item-images/'+s.image+'-small.png" alt=""/></a></div>'),p=s.ref;r.find("div[data-uuid="+p+"]").remove(),h.hide().appendTo(r.children().last()).show("pulsate"),a=h}var f=a.find(".pusher"),m=a.find(".js_duration");m.attr("data-total-duration",e.duration).text(e.item.timeLeft),startCooldown(m,f,32),getAjaxResourcebox(),$.ajax({type:"POST",url:detailUrl,data:{type:t},beforeSend:function(){$("#detailWrapper .detail_screen").html('<div id="techDetailLoading"></div>')},success:function(t){$("#detailWrapper .detail_screen").html(t)}})}startedActivation=!1}else fadeBox(e.message,!0)},error:function(t){fadeBox("Error!",!0),startedActivation=!1}})}i.amount>0&&(n="activate"),i.isAnUpgrade?errorBoxDecision(LocalizationStrings.activateItem.upgradeItemQuestionHeader,LocalizationStrings.activateItem.upgradeItemQuestion,LocalizationStrings.yes,LocalizationStrings.no,a,noHandlerItemActivation):i.isCharacterClassItem?i.amount>0?errorBoxDecision(LocalizationStrings.notice,LocalizationStrings.characterClassItem.activateItemQuestion.replace("#characterClassName#",i.name),LocalizationStrings.yes,LocalizationStrings.no,a,noHandlerItemActivation):errorBoxDecision(LocalizationStrings.notice,LocalizationStrings.characterClassItem.buyAndActivateItemQuestion.replace("#characterClassName#",i.name).replace("#darkmatter#",tsdpkt(i.costs)),LocalizationStrings.yes,LocalizationStrings.no,a,noHandlerItemActivation):i.isAllianceClassItem?i.amount>0?fetchDataAboutCurrentAllianceClass(i.name,a,"activateItemQuestion",null):fetchDataAboutCurrentAllianceClass(i.name,a,"buyAndActivateItemQuestion",i.costs):a()}function initEmpireEquipment(){$(".overview_equipment .item_img_box .hidden").each((function(){startCooldown($(this),$(this).parent().parent().find(".pusher"),32)}))}function startCooldown(t,e,i){if($.trim(t.text()).match(/^\d+$/))new countdownWithTickFunction(t[0],parseInt($.trim(t.text())),parseInt(t.attr("data-total-duration")),(function(){location.href=getRedirectLink()}),(function(t,n){var a=1-t/n,s=Math.floor(i*a);e.css("height",s+"px")}))}let activatingItem=!1;function fetchDataAboutCurrentAllianceClass(t,e,i,n){activatingItem||(activatingItem=!0,$.ajax({url:inventoryObj.ingameUrl,type:"GET",data:{component:"allianceclassselection",action:"fetchDataAboutCurrentAllianceClass",ajax:1,asJson:1},dataType:"json",error:function(a){promptUserForAllianceClassChange(t,e,i,n)},success:function(a){promptUserForAllianceClassChange(t,e,i,n,a)}}))}function promptUserForAllianceClassChange(t,e,i,n,a){if(activatingItem=!1,a.userDoesNotHaveAlliance)return 0;let s=LocalizationStrings.allianceClassItem[i];s=s.replace("#allianceClassName#",t),"buyAndActivateItemQuestion"===i&&(s=s.replace("#darkmatter#",tsdpkt(n))),a&&a.currentAllianceClass&&a.dateOfLastAllianceClassChange&&(s+=LocalizationStrings.allianceClassItem.appendCurrentClassQuestion,s=s.replace("#currentAllianceClassName#",a.currentAllianceClass),s=s.replace("#lastAllianceClassChange#",a.dateOfLastAllianceClassChange)),errorBoxDecision(LocalizationStrings.notice,s,LocalizationStrings.yes,LocalizationStrings.no,e)}function errorBoxAsArray(t){"notify"==t.type?notifyBoxAsArray(t):"decision"==t.type?decisionBoxAsArray(t):"fadeBox"==t.type&&fadeBox(t.text,t.failed)}function notifyBoxAsArray(t){errorBoxNotify(t.title,t.text,t.buttonOk,String(t.okFunction),t.removeOpen,t.modal)}function fadeBox(t,e,i,n){e?$("#fadeBoxStyle").attr("class","failed"):$("#fadeBoxStyle").attr("class","success"),$("#fadeBoxContent").html(t),$("#fadeBox").stop(!1,!0).show().fadeOut(n||1e4,i)}let NotificationTimers={};function showNotification(t,e="info",i=null){let n={error:{sign:"&#x2716;",cssClass:"notification-error",headline:i??jsloca.LOCA_NOTIFY_ERROR},info:{sign:"&#x2139;",cssClass:"notification-info",headline:i??jsloca.LOCA_NOTIFY_INFO},success:{sign:"&#x2714;",cssClass:"notification-success",headline:i??jsloca.LOCA_NOTIFY_SUCCESS},warning:{sign:"&#x2755;",cssClass:"notification-warning",headline:i??jsloca.LOCA_NOTIFY_WARNING}},a=n[e]??n.info,s=Date.now(),o=`<notification id="${s}" class="${a.cssClass}">\n            <notification-content>\n                <notification-sign>${a.sign}</notification-sign>\n                <notification-message>\n                    <span class="headline">${a.headline}</span>\n                    <span>${t}</span>\n                </notification-message>\n            </notification-content>\n            <notification-close onclick="removeNotification(${s})">&#x2717;</notification-close>\n            <notification-progress class=""></notification-progress>\n        </notification>`;$("notification-container").append(o);let r=setTimeout((()=>{$("notification-container notification#"+s).addClass("active"),$("notification-container notification#"+s+" notification-progress").addClass("active")}),10),l=setTimeout((()=>{$("notification-container notification#"+s).removeClass("active")}),5010),c=setTimeout((()=>{removeNotification(s)}),5300);NotificationTimers[s]={timer1:r,timer2:l,timer3:c}}function removeNotification(t){$("notification-container notification#"+t).remove(),clearTimeout(NotificationTimers[t].timer1),clearTimeout(NotificationTimers[t].timer2),clearTimeout(NotificationTimers[t].timer3),delete NotificationTimers[t]}function decisionBoxAsArray(t){errorBoxDecision(t.title,t.text,t.buttonOk,t.buttonNOk,String(t.okFunction),String(t.nokFunction),t.removeOpen)}function errorBoxDecision(t,e,i,n,a,s,o){var r=getIEVersion()<=9&&(o||!1),l=$("#errorBoxDecision");l.find("#errorBoxDecisionHead").html(t),l.find("#errorBoxDecisionContent").html(e);var c=function(t){t.stopPropagation(),void 0!==l.data("uiDialog")&&l.dialog("destroy"),"function"==typeof a&&a(),"submit_planet_delete_form"==a&&$("#planetMaintenanceDelete").submit()},d=function(t){t.stopPropagation(),void 0!==l.data("uiDialog")&&l.dialog("destroy"),"reload"==s&&location.reload(),"function"==typeof s&&s()};l.find(".yes, .no").unbind("click"),l.unbind("keydown.yesHandler"),setTimeout((function(){var t=l.find(".yes"),e=l.find(".no");t.unbind("click").bind("click",c).focus().find("#errorBoxDecisionYes").html(i),e.unbind("click").bind("click",d).find("#errorBoxDecisionNo").html(n),r?(t.attr("href","#"),e.attr("href","#")):(t.attr("href","javascript:void(0);"),e.attr("href","javascript:void(0);")),l.bind("keydown.yesHandler",(function(t){t.which==KeyEvent.DOM_VK_RETURN&&l.find(".yes").trigger("click")}))}),100),Tipped.hideAll(),l.dialog({resizable:!1,modal:!0,title:t,close:d,width:400,dialogClass:"errorBox"})}function errorBoxNotify(t,e,i,n,a){var s=getIEVersion()<=9&&(a||!1),o=$("#errorBoxNotify");o.find("#errorBoxNotifyHead").html(t),o.find("#errorBoxNotifyContent").html(e);var r=function(t){t.stopPropagation(),o.dialog("destroy"),"function"==typeof n?n():"function"==typeof window[n]&&window[n]()},l=o.find(".ok");l.unbind("click").bind("click",r).find("#errorBoxNotifyOk").html(i),s?l.attr("href","#"):l.attr("href","javascript:void(0);"),Tipped.hideAll(),o.dialog({resizable:!1,modal:!0,title:t,close:r,width:400,dialogClass:"errorBox"})}function eventBDayInitGalaxy(){isMobile&&($(".js_bday_details").hide(),$(".bdaySlotBox .name").click((function(t){$(".row").children().each((function(){$(this).html().trim()&&$(this).removeClass("active")})),$(".bdaySlotBox .name").removeClass("active"),$(".js_detailRow").hide(),$(this).toggleClass("active"),-1!==$(t.target).attr("class").indexOf("planet")?$(".js_detailRowPlanet17").toggle():-1!==$(t.target).attr("class").indexOf("debris")&&$(".js_detailRowDebris17").toggle()})))}function eventBDayInit(){var t=$(".event_box");$("#eventBDayWrapper").click((function(e){("BDayContent"===$(e.target).attr("id")||"BDayEventClose"===$(e.target).attr("id")||$(e.target).closest("#BDayHeader").length>0)&&(t.hide(),$(".bday_box").removeClass("active")),e.stopPropagation()})),$(".bday_box").click((function(e){$(".bday_box").removeClass("active");var i=$(e.target).closest(".bday_box").attr("id").replace("box","");t.removeClass().addClass("event_box "+eventBoxData[i].eventTypeClass),void 0!==eventBoxData[i]&&(t.attr("id","eventBox"+i).show(),$("#box"+i).addClass("active"),"future"!==eventBoxData[i].eventTypeClass?$("#eventBox"+i+" #BDayEventDate").html(eventBoxData[i].date+": "):$("#eventBox"+i+" #BDayEventDate").html(""),$("#eventBox"+i+" #BDayEventTitle").html(eventBoxData[i].title),$("#eventBox"+i+" #BDayofficerImg").attr("src",eventBoxData[i].eventOfficerImgSrc),"future"!==eventBoxData[i].eventTypeClass||void 0!==eventBoxData[i].txtChronic?($("#eventBox"+i+" #BDayEventTxtChronic").html(eventBoxData[i].txtChronic),$("#eventBox"+i+" #BDayChronic").show()):$("#eventBox"+i+" #BDayChronic").hide(),void 0===eventBoxData[i].eventImgSrc&&"future"===eventBoxData[i].eventTypeClass?$("#eventBox"+i+" #BDayEventImg").attr("src","/img/icons/d995359d038c9a0c21aed16b3cc162.png"):$("#eventBox"+i+" #BDayEventImg").attr("src",eventBoxData[i].eventImgSrc),void 0===eventBoxData[i].eventTxtDesc?$("#eventBox"+i+" #BDayEventTxtDesc").html(""):$("#eventBox"+i+" #BDayEventTxtDesc").html(eventBoxData[i].eventTxtDesc),$("#eventBox"+i+" #BDayEventPastTxt").hide(),"past"===eventBoxData[i].eventTypeClass&&$("#eventBox"+i+" #BDayEventPastTxt").html(eventPastTxt).show(),$("#eventBox"+i+" #BDayEventBtnCTA").hide(),"past"!==eventBoxData[i].eventTypeClass&&void 0!==eventBoxData[i].btnCTA&&$("#eventBox"+i+" #BDayEventBtnCTA").html(eventBoxData[i].btnCTA).attr("href",eventBoxData[i].btnCTALink).show())}))}function initBDayEventHints(){$(document).undelegate(".event_build_faster, .event_active_hint","click").delegate(".event_build_faster, .event_active_hint","click",(function(t){t.stopPropagation(),"expeditionbutton"===$(this).parent().attr("id")?doExpedition():$(this).siblings(".detail_button").click()}))}function toggleEvents(t){if($("#eventboxContent").is(":hidden"))$("#eventboxContent").slideDown("fast"),$("#js_eventDetailsClosed").hide(),$("#js_eventDetailsOpen").show(),void 0!==toggleEvents.loaded&&toggleEvents.loaded||refreshFleetEvents();else{if(t)return;$("#eventboxContent").slideUp("fast"),$("#js_eventDetailsClosed").show(),$("#js_eventDetailsOpen").hide()}$("#contentWrapper select").ogameDropDown("hide")}function refreshFleetEvents(t){"undefined"!=typeof eventlistLink&&($("#eventboxContent").is(":hidden")&&!0!==t||($("#eventboxContent").html('<img height="16" width="16" src="/img/icons/3f9884806436537bdec305aa26fc60.gif" />'),$.ajax({url:eventlistLink,success:function(t){$("#eventboxContent").html(t),toggleEvents.loaded=!0}})))}function toggleDetails(){var t=$(".partnerInfo."+$(this).attr("rel"));$(t).is(":hidden")?($(t).show(),$(this).parents("tr").addClass("detailsOpened").removeClass("detailsClosed")):($(t).hide(),$(this).parents("tr").addClass("detailsClosed").removeClass("detailsOpened"))}function Exodus(t){this.loca=t.loca,this.initServerSelect(t)}Exodus.prototype.onAjaxDone=function(){this.loadingIndicator.hide()},Exodus.prototype.onAjaxError=function(){},Exodus.prototype.updateToken=function(t){this.token=t,token=t},Exodus.prototype.initCommon=function(t){this.serverWrapper=$(".exodus #serverNumbers"),this.loadingIndicator=this.serverWrapper.ogameLoadingIndicator(),this.serverLanguage=$(".exodus #serverLanguage"),this.serverNumber=$(".exodus #serverNumber"),this.serverNumbers=null,this.token=t.token,this.selectedLanguage=t.sourceLanguage,this.serverSelection=$("#serverSelection"),this.table=this.serverLanguage.closest(".og-table"),this.availableLanguages=t.availableLanguages,this.urlServerIds=t.urlServerIds||null,this.urlIsReady=t.urlIsReady||null,this.urlSubmitExodus=t.urlSubmitExodus||null,this.isReadyForExodus=t.isReadyForExodus||!1,this.serverAmount=0},Exodus.prototype.initServerSelect=function(t){this.initCommon(t),this.dropDownLanguageSelect=$(".exodus #serverLanguage"),this.dropDownServerSelect=$(".exodus #serverNumber"),this.exodusSubmitButton=$(".exodus #submitExodus"),this.exodusSubmitButton.on("click",this.onClickExecute.bind(this)),this.dropDownLanguageSelect.on("change",this.onChangeServerLanguage.bind(this)),this.dropDownServerSelect.on("change",this.onChangeServerNumber.bind(this)),this.refreshLanguage(),this.fetchServerNumbers()},Exodus.prototype.onChangeServerLanguage=function(t){this.selectedLanguage=this.dropDownLanguageSelect.val(),this.refreshLanguage(),this.fetchServerNumbers()},Exodus.prototype.onChangeServerNumber=function(t){this.selectedServer=this.dropDownServerSelect.val(),this.refreshServer()},Exodus.prototype.onClickExecute=function(t){t.stopPropagation(),t.preventDefault();let e=this.dropDownServerSelect.find('option[value="'+this.selectedServer+'"]').html();this.loadingIndicator.show();let i=this;errorBoxDecision(this.loca.LOCA_EXODUS_TRANSFER_QUESTION_TITLE,this.loca.LOCA_EXODUS_TRANSFER_QUESTION.replace("#uniname#",e),this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){let t={serverNumber:parseInt(i.selectedServer),serverLanguage:i.selectedLanguage,_token:i.token};$.post(i.urlSubmitExodus,t,i.handleSubmitExodusResponse.bind(i)).done(i.onAjaxDone.bind(i))}),(function(){i.loadingIndicator.hide()}))},Exodus.prototype.fetchServerNumbers=function(){this.loadingIndicator.show();let t={language:this.selectedLanguage};$.getJSON(this.urlServerIds,t,this.onFetchServerNumbers.bind(this)).done(this.onAjaxDone.bind(this))},Exodus.prototype.checkIsReady=function(){let t={};this.serverAmount>0&&$.getJSON(this.urlIsReady,t,this.onCheckIsReady.bind(this)).done(this.onAjaxDone.bind(this))},Exodus.prototype.setLanguage=function(t){let e=this.selectedLanguage;this.selectedLanguage=t,this.selectedLanguage!==e&&(this.resetLanguage(),this.refreshLanguage(),this.fetchServerNumbers(),this.resetServer(),this.checkIsReady())},Exodus.prototype.setServer=function(t){let e=this.selectedServer;this.selectedServer=t,this.selectedServer!==e&&(this.resetServer(),this.refreshServer(),this.checkIsReady())},Exodus.prototype.refreshLanguage=function(){this.dropDownLanguageSelect.find("option").removeAttr("selected"),this.selectedLanguage&&(this.dropDownLanguageSelect.find('option[value="'+this.selectedLanguage+'"]').attr("selected","selected"),this.dropDownLanguageSelect.val(this.selectedLanguage))},Exodus.prototype.refreshServer=function(){this.dropDownServerSelect.find("option").removeAttr("selected"),this.selectedServer&&(this.dropDownServerSelect.val(this.selectedServer),this.dropDownServerSelect.find('option[value="'+this.selectedServer+'"]').attr("selected","selected"))},Exodus.prototype.resetLanguage=function(){this.setLanguage(this.getFirstLanguage())},Exodus.prototype.resetServer=function(){this.setServer(this.selectedServer)},Exodus.prototype.getFirstLanguage=function(){return this.availableLanguages[0]},Exodus.prototype.onCheckIsReady=function(t){this.isReadyForExodus=t.isReady,this.isReadyForExodus&&0!==this.selectedServer?this.exodusSubmitButton.removeClass("disabled"):this.exodusSubmitButton.addClass("disabled")},Exodus.prototype.handleSubmitExodusResponse=function(t){let e=JSON.parse(t);"success"===(e.status||"failure")?(fadeBox(e.message,!1),window.location=e.redirectUrl):(this.updateToken(e.newAjaxToken),this.displayErrors(e))},Exodus.prototype.displayErrors=function(t){let e=t.errors[0]||void 0;e&&(fadeBox(e.message,!0),this.updateToken(t.newAjaxToken))},Exodus.prototype.onFetchServerNumbers=function(t){if(0===t.serverNumbers.length||!1===this.isReadyForExodus)return!1===this.isReadyForExodus&&this.serverSelection.html('<span id="noServer">'+this.loca.LOCA_EXODUS_RESTRICTION_NOT_FULFILLED+"</span>"),0===t.serverNumbers.length&&this.serverSelection.html('<span id="noServer">'+this.loca.LOCA_EXODUS_NO_SERVER_AVAILABLE+"</span>"),this.exodusSubmitButton.addClass("disabled"),this.serverAmount=0,void(this.selectedServer=0);this.serverSelection.html('<select id="serverNumber" type="text" class="og-input" name="serverNumber"></select>'),this.exodusSubmitButton.removeClass("disabled"),this.dropDownServerSelect=$(".exodus #serverNumber"),this.dropDownServerSelect.on("change",this.onChangeServerNumber.bind(this)),this.serverAmount=t.serverNumbers.length,this.selectedServer=t.serverNumbers[0].number,this.serverNumbers=t.serverNumbers;var e=this.dropDownServerSelect;if(e.prop)var i=e.prop("options");else i=e.attr("options");$("option",e).remove();let n="";$.each(t.serverNumbers,(function(t,e){i[i.length]=new Option(e.name,e.number),n+='<option value="'+e.number+'">'+e.name+"</option>"})),this.dropDownServerSelect.ogameDropDown("destroy"),this.dropDownServerSelect.html(""),this.dropDownServerSelect.html(n).ogameDropDown()},"function"!=typeof Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");t=Object(t);for(var e=1;e<arguments.length;e++){var i=arguments[e];if(null!=i)for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}),"function"!=typeof Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&t>-9007199254740992&&t<9007199254740992&&Math.floor(t)===t});var Formatter={timeUnits:{second:1,minute:60,hour:3600,day:86400,week:604800},secondsToTime:function(t,e){if(e=Object.assign({segments:-1,delimiter:" ",units:{weeks:"w",days:"d",hours:"h",minutes:"m",seconds:"s"},now:"now"},e),!Number.isInteger(t))throw"Integer expected for parameter seconds";if(t<=0)return e.now;var i={weeks:Math.floor(t/Formatter.timeUnits.week),days:Math.floor(t%Formatter.timeUnits.week/Formatter.timeUnits.day),hours:Math.floor(t%Formatter.timeUnits.day/Formatter.timeUnits.hour),minutes:Math.floor(t%Formatter.timeUnits.hour/Formatter.timeUnits.minute),seconds:t%Formatter.timeUnits.minute},n=[];for(var a in i)i[a]>0&&(-1==e.segments||n.length<e.segments)&&n.push(i[a]+e.units[a]);return n.join(e.delimiter)},secondsToPeriod:function(t){if(!Number.isInteger(t))throw"Integer expected for parameter seconds";if(t<=0)return"PT0H0M0S";var e={days:{value:Math.floor(t/Formatter.timeUnits.day),unit:"D"},hours:{value:Math.floor(t%Formatter.timeUnits.day/Formatter.timeUnits.hour),unit:"H"},minutes:{value:Math.floor(t%Formatter.timeUnits.hour/Formatter.timeUnits.minute),unit:"M"},seconds:{value:t%Formatter.timeUnits.minute,unit:"S"}},i=[],n=[];for(var a in e)e[a].value>0&&("days"==a?i.push(e[a].value+e[a].unit):n.push(e[a].value+e[a].unit));return"P"+i.join("")+(n.length>0?"T"+n.join(""):"")},numberToString:function(t,e){var i=function(t,e,i){switch(e){case 1:t=function(t,e){if("number"!=typeof t)throw"Numeric expected for parameter number";if(!Number.isInteger(e))throw"Integer expected for parameter precision";return e<=0?Math.round(t):Math.round(t*Math.pow(10,e))/Math.pow(10,e)}(t,i);break;case 2:t=function(t,e){if("number"!=typeof t)throw"Numeric expected for parameter number";if(!Number.isInteger(e))throw"Integer expected for parameter precision";return e<=0?Math.ceil(t):Math.ceil(t*Math.pow(10,e))/Math.pow(10,e)}(t,i);break;case 3:t=function(t,e){if("number"!=typeof t)throw"Numeric expected for parameter number";if(!Number.isInteger(e))throw"Integer expected for parameter precision";return e<=0?Math.floor(t):Math.floor(t*Math.pow(10,e))/Math.pow(10,e)}(t,i)}return t},n={transform:1,precision:{minimum:0,maximum:3},separators:{thousands:",",decimals:"."},boundaries:{1e6:"M",1e9:"Bn"}};if(e=Object.assign(n,e),"number"!=typeof t)throw"Numeric expected for parameter number";if(void 0===e.precision||void 0===e.precision.minimum)throw"Minimum precision not specified";if(void 0===e.precision||void 0===e.precision.maximum)throw"Maximum precision not specified";if(e.precision.minimum>e.precision.maximum)throw"Minimum precision larger than maximum precision";for(var a=Object.keys(e.boundaries).sort((function(t,e){return parseFloat(e)-parseFloat(t)})),s="",o=0;o<a.length;o++){var r=parseInt(a[o]);if(0!==r&&Math.abs(t)>=r){t/=r,s=e.boundaries[a[o]];break}}for(var l=e.precision.maximum;(t=i(t,e.transform,l))==i(t,e.transform,l-1)&&l>e.precision.minimum;)l--;var c=(t=t.toFixed(l)).toString().split(".");return c[0]=c[0].replace(/\B(?=(\d{3})+(?!\d))/g,e.separators.thousands),c.join(e.separators.decimals)+s}};function reloadComponent(t,e,i){$.ajax({type:"GET",url:`${ajaxReloadComponentURI}&component=${t}&currentComponent=${currentPage}`,success:function(t){try{let n=JSON.parse(t);$("#"+n.id).replaceWith(n.html),e&&$("#"+n.id).addClass("fleft"),token=n.newAjaxToken,i&&"function"==typeof i&&i(),$("select").ogameDropDown()}catch(t){window.location.reload()}},error:function(t){window.location.reload()}})}function Graveyard(t){this.loca=t.loca,this.initServerSelect(t)}ogame.frontendActions={socket:null,connected:!1,connecting:!1,timeout:null,retryInterval:5e3,initConnection:function(){var t=ogame.frontendActions;(t.connecting||t.connected||t.isMobile)&&this.socket&&t.socket.disconnect(),t.connecting=!0;try{t.socket=io.connect(":"+nodePort+"/frontendactions",nodeParams),t.socket.on("connect",(function(){clearTimeout(this.timeout),t.socket.emit("authorize",session,(function(e){t.connecting=!1,e?t.connected=!0:t.socket.disconnect()}))})),t.socket.on("refreshFrontendData",(function(e){t.refreshFrontendData(e)})),t.socket.on("refreshSimulationData",(function(e){t.refreshSimulationData(e)})),t.socket.on("disconnect",(function(){t.connected=!1,t.connecting=!1}))}catch(e){t.connecting=!1}},initialize:function(){if("undefined"!=typeof nodeUrl);},retryConnection:function(){var t=ogame.frontendActions;setTimeout((function(){t.initConnection()}),5e3)},refreshFrontendData:function(t){if(!buildListActionCalled&&!speedingUpBuildListEntry)try{let e=window.location.href,i=new URLSearchParams(e.split("?")[1]??""),n=i.get("component"),a=i.get("page");if(t.type&&"buildList"===t.type){if("empire"===n)return void window.location.reload();if(t.spaceObjectId&&"any"!==t.spaceObjectId&&"undefined"!=typeof currentSpaceObjectId&&t.spaceObjectId===currentSpaceObjectId||"any"===t.spaceObjectId){if("resourcesettings"===n&&t.actionType&&"built"===t.actionType)return void window.location.reload();if(t.component&&(t.component.indexOf(n)>-1||t.component.indexOf(a)>-1))return void window.location.reload();t.productionBox&&$(`#productionbox${t.productionBox}component`).length>0&&reloadComponent(`productionbox${t.productionBox}`),"undefined"!=typeof currentSpaceObjectId&&t.spaceObjectId===currentSpaceObjectId&&getAjaxResourcebox()}reloadComponent("planetbar","ingame"!==a)}}catch(t){}},refreshSimulationData:function(t){try{t.type&&"refreshSimInfo"===t.type&&t.remove&&(removeCombatSim(t.simId),loadSimDetails()),t.type&&"refreshSimInfo"===t.type&&(changeCombatSimState(t.simId,t.simState),loadSimDetails())}catch(t){}},initFrontendActions:function(){ogame.frontendActions.initialize()}},$(document).ready((()=>{ogame.frontendActions.initFrontendActions()})),Graveyard.prototype.onAjaxDone=function(){this.loadingIndicator.hide()},Graveyard.prototype.onAjaxError=function(){},Graveyard.prototype.updateToken=function(t){this.token=t},Graveyard.prototype.initCommon=function(t){this.serverWrapper=$(".graveyard #serverNumbers"),this.loadingIndicator=this.serverWrapper.ogameLoadingIndicator(),this.serverLanguage=$(".graveyard #serverLanguage"),this.serverNumber=$(".graveyard #serverNumber"),this.serverNumbers=null,this.selectedLanguage=null,this.serverSelection=$("#serverSelection"),this.token=t.token,this.table=this.serverLanguage.closest(".og-table"),this.availableLanguages=t.availableLanguages,this.urlServerIds=t.urlServerIds||null,this.urlIsReady=t.urlIsReady||null,this.urlSubmitExodus=t.urlSubmitExodus||null,this.isReadyForExodus=t.isReadyForExodus||!1,this.serverAmount=0},Graveyard.prototype.initServerSelect=function(t){this.initCommon(t),this.dropDownLanguageSelect=$(".graveyard #serverLanguage"),this.dropDownServerSelect=$(".graveyard #serverNumber"),this.exodusSubmitButton=$(".graveyard #submitExodus"),this.exodusSubmitButton.on("click",this.onClickExecute.bind(this)),this.dropDownLanguageSelect.on("change",this.onChangeServerLanguage.bind(this)),this.dropDownServerSelect.on("change",this.onChangeServerNumber.bind(this)),this.resetLanguage(),this.refreshLanguage()},Graveyard.prototype.onChangeServerLanguage=function(t){this.selectedLanguage=this.dropDownLanguageSelect.val(),this.refreshLanguage(),this.fetchServerNumbers()},Graveyard.prototype.onChangeServerNumber=function(t){this.selectedServer=this.dropDownServerSelect.val(),this.refreshServer()},Graveyard.prototype.onClickExecute=function(t){t.stopPropagation(),t.preventDefault();let e=this.dropDownServerSelect.find('option[value="'+this.selectedServer+'"]').html();this.loadingIndicator.show();let i=this;errorBoxDecision(this.loca.LOCA_EXODUS_TRANSFER_QUESTION_TITLE,this.loca.LOCA_EXODUS_TRANSFER_QUESTION.replace("#uniname#",e),this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){let t={serverNumber:parseInt(i.selectedServer),serverLanguage:i.selectedLanguage,_token:i.token};$.post(i.urlSubmitExodus,t,i.handleSubmitExodusResponse.bind(i)).done(i.onAjaxDone.bind(i))}),(function(){i.loadingIndicator.hide()}))},Graveyard.prototype.fetchServerNumbers=function(){this.loadingIndicator.show();let t={language:this.selectedLanguage};$.getJSON(this.urlServerIds,t,this.onFetchServerNumbers.bind(this)).done(this.onAjaxDone.bind(this))},Graveyard.prototype.checkIsReady=function(){let t={};this.serverAmount>0&&$.getJSON(this.urlIsReady,t,this.onCheckIsReady.bind(this)).done(this.onAjaxDone.bind(this))},Graveyard.prototype.setLanguage=function(t){let e=this.selectedLanguage;this.selectedLanguage=t,this.selectedLanguage!==e&&(this.resetLanguage(),this.refreshLanguage(),this.fetchServerNumbers(),this.resetServer(),this.checkIsReady())},Graveyard.prototype.setServer=function(t){let e=this.selectedServer;this.selectedServer=t,this.selectedServer!==e&&(this.resetServer(),this.refreshServer(),this.checkIsReady())},Graveyard.prototype.refreshLanguage=function(){this.dropDownLanguageSelect.find("option").removeAttr("selected"),this.selectedLanguage&&(this.dropDownLanguageSelect.find('option[value="'+this.selectedLanguage+'"]').attr("selected","selected"),this.dropDownLanguageSelect.val(this.selectedLanguage))},Graveyard.prototype.refreshServer=function(){this.dropDownServerSelect.find("option").removeAttr("selected"),this.selectedServer&&this.dropDownServerSelect.find('option[value="'+this.selectedServer+'"]').attr("selected","selected")},Graveyard.prototype.resetLanguage=function(){this.setLanguage(this.getFirstLanguage())},Graveyard.prototype.resetServer=function(){this.setServer(this.selectedServer)},Graveyard.prototype.getFirstLanguage=function(){return this.availableLanguages[0]},Graveyard.prototype.onCheckIsReady=function(t){this.isReadyForExodus=t.isReady,this.isReadyForExodus&&0!==this.selectedServer?this.exodusSubmitButton.removeClass("disabled"):this.exodusSubmitButton.addClass("disabled")},Graveyard.prototype.handleSubmitExodusResponse=function(t){let e=JSON.parse(t);"success"===(e.status||"failure")?(fadeBox(e.message,!1),window.location=e.redirectUrl):this.displayErrors(e)},Graveyard.prototype.displayErrors=function(t){let e=t.errors[0]||void 0;e&&(this.updateToken(t.newAjaxToken),fadeBox(e.message,!0))},Graveyard.prototype.onFetchServerNumbers=function(t){if(0===t.serverNumbers.length)return 0===t.serverNumbers.length&&this.serverSelection.html('<span id="noServer">'+this.loca.LOCA_EXODUS_NO_SERVER_AVAILABLE+"</span>"),!1===this.isReadyForExodus&&this.serverSelection.html('<span id="noServer">'+this.loca.LOCA_EXODUS_RESTRICTION_NOT_FULFILLED+"</span>"),this.exodusSubmitButton.addClass("disabled"),this.serverAmount=0,void(this.selectedServer=0);this.serverSelection.html('<select id="serverNumber" type="text" class="og-input" name="serverNumber"></select>'),this.exodusSubmitButton.removeClass("disabled"),this.dropDownServerSelect=$(".graveyard #serverNumber"),this.dropDownServerSelect.on("change",this.onChangeServerNumber.bind(this)),this.serverAmount=t.serverNumbers.length,this.selectedServer=t.serverNumbers[0].number,this.serverNumbers=t.serverNumbers;var e=this.dropDownServerSelect;if(e.prop)var i=e.prop("options");else i=e.attr("options");$("option",e).remove();let n="";$.each(t.serverNumbers,(function(t,e){i[i.length]=new Option(e.name,e.number),n+='<option value="'+e.number+'">'+e.name+"</option>"})),this.dropDownServerSelect.ogameDropDown("destroy"),this.dropDownServerSelect.html(""),this.dropDownServerSelect.html(n).ogameDropDown()};var DOM_GET_ELEMENT_BY_ID_CACHE=[];function getElementByIdWithCache(t){return DOM_GET_ELEMENT_BY_ID_CACHE[t]||(DOM_GET_ELEMENT_BY_ID_CACHE[t]=document.getElementById(t)),DOM_GET_ELEMENT_BY_ID_CACHE[t]}function number_format(t,e,n,a){n=n||LocalizationStrings.decimalPoint,a=a||LocalizationStrings.thousandSeperator;var s="",o=t.toString(),r=o.indexOf("e");if(r>-1&&(s=o.substring(r),t=parseFloat(o.substring(0,r))),null!=e){var l=Math.pow(10,e);t=Math.round(t*l)/l}var c=t<0?"-":"",d=(t>0?Math.floor(t):Math.abs(Math.ceil(t))).toString(),u=t.toString().substring(d.length+c.length);if(n=null!=n?n:".",u=null!=e&&e>0||u.length>1?n+u.substring(1):"",null!=e&&e>0)for(i=u.length-1,z=e;i<z;++i)u+="0";if(null!=(a=a!=n||0==u.length?a:null)&&""!=a)for(i=d.length-3;i>0;i-=3)d=d.substring(0,i)+a+d.substring(i);return c+d+u+s}function gfNumberGetHumanReadable(t,e,i){t=Math.floor(t);var n="";i=i||3;for((e=e||!1)&&(t>=1e9?(n=LocalizationStrings.unitMilliard,t/=1e9):t>=1e6&&(n=LocalizationStrings.unitMega,t/=1e6)),floorWithPrecision=function(t,e){return Math.floor(t*Math.pow(10,e))/Math.pow(10,e)},t=floorWithPrecision(t,i);i>=0&&floorWithPrecision(t,i-1)==t;)i-=1;return number_format(t,i,LocalizationStrings.decimalPoint,LocalizationStrings.thousandSeperator)+n}function getNumberFormatShort(t,e){void 0===e&&(e=0);var i="";return(t=Math.floor(t))>=1e9&&(i=LocalizationStrings.unitMilliard,t/=1e9),t>=1e6&&(i=LocalizationStrings.unitMega,t/=1e6),t>=1e3&&(i=LocalizationStrings.unitKilo,t/=1e3),number_format(t,e,LocalizationStrings.decimalPoint,LocalizationStrings.thousandSeperator)+i}function createExpireTime(t){var e=new Date;return t*=1e3,e.setTime(t),e}function initHighscore(){$("a.navButton, a.subnavButton").click((function(){var t=$(this).attr("rel"),e=$(this).parent(),i="";"typeButtons"==e.attr("id")?$("#typeButtons > a.active").removeClass("active"):"categoryButtons"==e.attr("id")&&($("#categoryButtons > a.active").removeClass("active"),$("#typeButtons a.active").each((function(){t=$(this).attr("rel")}))),(null!=searchRelId&&"typeButtons"==e.attr("id")||"subnav_fleet"==e.attr("id"))&&(i="&searchRelId="+searchRelId),$(".subnavButton[rel!="+t+"]").removeClass("active"),$("#stat_list_content").html(LocalizationStrings.loading),$(this).addClass("active");var n=$("#categoryButtons > a.active").attr("rel"),a=highscoreContentUrl+"?category="+n+"&type="+t+i;"typeButtons"!=e.attr("id")&&!$(this).hasClass("subnavButton")||searchSite==site||(a=a+"&site="+site),removeTooltip(getTooltipSelector("#highscoreContent #ranks")),ajaxSubmit(a,"#send","#stat_list_content",initHighscoreContent),1==$(".navButton.active").attr("rel")?$("#highscoreContent .header h2").text(highscoreLoca.playerHighscore):$("#highscoreContent .header h2").text(highscoreLoca.allianceHighscore)})),$(".stat_filter").click((function(){var t=$(this).attr("id");$(".subnav").hide(),$("#subnav_"+t).fadeIn("slow")}));var t=$("#ranks").offset().top,e=$("#scrollToTop");$(window).unbind("scroll.highscoreTop").bind("scroll.highscoreTop",(function(i){$(this).scrollTop()>t?e.css("visibility","visible"):e.css("visibility","hidden")})),$(document).undelegate(".scrollToTop","click").delegate(".scrollToTop","click",(function(){$("html, body").animate({scrollTop:0},50)}))}function initHighscoreContent(){userWantsFocus&&$("#position"+searchPosition).length>0&&$("html, body").animate({scrollTop:Math.max(0,$("#position"+searchPosition).offset().top-200)},1e3),$(".changeSite").change((function(){var t=$(this).val();$("#stat_list_content").html('<div class="ajaxLoad">'+LocalizationStrings.loading+"</div>"),ajaxCall(highscoreContentUrl+"?category="+currentCategory+"&type="+currentType+"&page="+t,"#stat_list_content",initHighscoreContent)}));var t=$("#scrollToTop"),e=$("#ranks thead .score");function i(){e.length&&t.css("left",e.offset().left)}i(),$(window).unbind("resize.highscoreTop").bind("resize.highscoreTop",i)}const IPI={config:null,loadingIndicator:null,highlights:[],highlightSteps:[],highlightStepIndex:0,ipiCall:(t,e)=>{IPI.loadingIndicator.show(),$.get(t,{},(t=>{IPI.loadingIndicator.hide();const i=JSON.parse(t);token=i.newAjaxToken??token,void 0!==i.success&&!0===i.success?e(i):void 0!==i.error&&fadeBox(i.error,!0)}))},trackTask:t=>{IPI.ipiCall(IPI.config.trackTaskUrl+"&token="+(token??"0")+"&taskId="+t,(e=>{if(document.querySelectorAll(".ipiTaskItem").forEach((e=>{const i=e.querySelector(".ipiTaskItemTrack"),n=e.getAttribute("data-state")??"none";if(parseInt(e.getAttribute("data-taskid"))===t)return e.setAttribute("data-state","none"===n?"tracked":"none"),i.textContent="none"===n?IPI.config.loca.LOCA_IPI_UNTRACK_TASK:IPI.config.loca.LOCA_IPI_TRACK_TASK,void IPI.showTaskDescription(e);"tracked"===n&&(e.setAttribute("data-state","none"),i.textContent=IPI.config.loca.LOCA_IPI_TRACK_TASK)})),void 0!==e.trackedAction){const t=e.trackedAction?.title??"",i=e.trackedAction?.highlights??[];IPI.updateCurrentAction(t,i)}}))},collectTask:t=>{IPI.ipiCall(IPI.config.collectTaskUrl+"&token="+(token??"0")+"&taskId="+t,(e=>{if(IPI.markTaskAsCollected(document.querySelector('.ipiTaskItem[data-taskid="'+t+'"]')),void 0!==e.unclaimedRewards){const t=document.querySelector("#ipiOverviewChapters .ipiChapterItem.active .ipiHintCollect");parseInt(e.unclaimedRewards)>0?t.textContent=e.unclaimedRewards:t.remove()}getAjaxResourcebox(),fadeBox(e.claimedRewardsRendered??"",!1)}))},collectChapter:t=>{t<=0?console.error("Invalid ChapterId: "+t):IPI.ipiCall(IPI.config.collectChapterUrl+"&token="+(token??"0")+"&chapterId="+t,(t=>{const e=document.querySelector("#ipiOverviewChapterRewards .ipiOverviewCollectRewards");e.classList.add("disabled"),e.textContent=IPI.config.loca.LOCA_IPI_CHAPTER_COLLECTED,document.querySelectorAll('.ipiTaskItem:not([data-state="collected"])').forEach(IPI.markTaskAsCollected),getAjaxResourcebox(),fadeBox(t.claimedRewardsRendered??"",!1)}))},initIpiLayer:t=>{IPI.config=t,IPI.loadingIndicator=$("#ipiOverviewContent").ogameLoadingIndicator(),document.querySelectorAll(".ipiOverviewSelectChapter").forEach((t=>{t.addEventListener("click",(t=>IPI.loadingIndicator.show()))}));document.querySelectorAll(".ipiTaskItem").forEach((t=>{const e=parseInt(t.getAttribute("data-taskid")??0);t.querySelector(".ipiTaskItemTitle")?.addEventListener("click",(e=>{t.classList.contains("active")?IPI.hideTaskDescription(t):IPI.showTaskDescription(t)})),"tracked"===t.getAttribute("data-state")&&IPI.showTaskDescription(t),5001===e&&"collected"!==t.getAttribute("data-state")&&IPI.showTaskDescription(t);t.querySelector(".ipiTaskItemTrack").addEventListener("click",(i=>{if(null===IPI.config)return void console.error("IPI Config missing");const n=t.getAttribute("data-state")??"none";if(e<=0)console.error("Invalid TaskId: "+e);else switch(n){case"none":case"tracked":IPI.trackTask(e);break;case"completed":IPI.collectTask(e)}}));t.querySelector(".ipiOverviewCollectRewards").addEventListener("click",(i=>{"completed"===t.getAttribute("data-state")&&IPI.collectTask(e)}));const i=t.querySelector(".ipiTaskItemProgress"),n=parseInt(i.getAttribute("data-progress")??0),a=parseInt(i.getAttribute("data-total")??0);if(n>0&&a>0&&a>=n){const t=n/a*100;let e="#5a5716",s="transparent";t>=100&&(e="#4f4f4f"),i.style.background=`linear-gradient(90deg, ${e} ${t}%, ${s} ${t}%)`}const s=document.querySelector("#ipiMenuWrapper");null!==s&&changeTooltip(s,"")}));const e=document.querySelector("#ipiOverviewChapterRewards .ipiOverviewCollectRewards");e.addEventListener("click",(t=>{if(null===IPI.config)return void console.error("IPI Config missing");if(e.classList.contains("disabled"))return;const i=parseInt(e.getAttribute("data-target")??0);i<=0?console.error("Invalid ChapterId: "+i):IPI.collectChapter(i)}))},showTaskDescription:t=>{t.classList.add("active");const e=t.querySelector(".ipiTaskItemContent");$(e).slideDown()},hideTaskDescription:t=>{t.classList.remove("active");const e=t.querySelector(".ipiTaskItemContent");$(e).slideUp()},markTaskAsCollected:t=>{const e=t.querySelector(".ipiTaskItemTrack");t.setAttribute("data-state","collected"),e.textContent=IPI.config.loca.LOCA_IPI_TASK_COLLECTED;const i=t.querySelector(".ipiTaskItemContentCollect .claimTaskRewards");i.textContent=IPI.config.loca.LOCA_IPI_TASK_COLLECTED,i.classList.add("disabled")},addHighlight:t=>{if("object"==typeof t&&t.length>0)return IPI.highlightSteps=t,IPI.highlightStepIndex=0,IPI.addHighlight(t[IPI.highlightStepIndex]);const e=document.querySelectorAll('.ipiHintable[data-ipi-hint="'+t+'"]');return!(e.length<=0)&&(e.forEach((t=>{t.classList.add("ipiHintActive")})),!0)},nextHighlightStep:t=>{if(IPI.highlightSteps.length<=0||IPI.highlightStepIndex>=IPI.highlightSteps.length)return;const e=t.target.getAttribute("data-ipi-highlight-step"),i=document.querySelectorAll('.ipiHintActive[data-ipi-hint="'+e+'"]');i.length<=0||(i.forEach((t=>{t.classList.remove("ipiHintActive")})),IPI.highlightStepIndex+=1,IPI.addHighlight(IPI.highlightSteps[IPI.highlightStepIndex]))},initIpiHighlights:t=>{IPI.highlights=t,IPI.refreshHighlights(),document.querySelectorAll("[data-ipi-highlight-step]").forEach((t=>{"input"!==t.nodeName.toLowerCase()?t.addEventListener("click",IPI.nextHighlightStep):t.addEventListener("change",IPI.nextHighlightStep)}))},refreshHighlights:()=>{document.querySelectorAll(".ipiHintable.ipiHintActive").forEach((t=>{t.classList.remove("ipiHintActive")}));const t=Array.from(IPI.highlights).reverse();for(highlight of t)if("object"!=typeof highlight){if(!0===IPI.addHighlight(highlight))break}else{let t=!1;if(highlight.forEach((e=>t=IPI.addHighlight(e)||t)),!0===t)break}},updateCurrentAction:(t,e)=>{const i=document.querySelector("#ipimenucomponent .ipiMenuBody"),n=document.querySelector("#ipimenucomponent .ipiMenuFooter");i.textContent=t,""===t?(i.classList.add("hidden"),n.classList.add("hidden")):(i.classList.remove("hidden"),n.classList.remove("hidden")),IPI.highlights=e,IPI.refreshHighlights()},initializeMenuContent:t=>{$.ajax({url:t.ipiMenuContentUrl}).done((t=>{IPI.populateMenuContent(t)})).fail((()=>(fadeBox(result.error,!0),!1))),$(".ipiMenuBody").mouseover(),IPI.initIpiHighlights(t.highlights)},populateMenuContent:t=>{$("#ipiMenuWrapper").html(t)},updateMenuContent:t=>{if(void 0!==t.unclaimedRewards){const e=$("#ipimenucomponent .ipiHintCollect");parseInt(t.unclaimedRewards)>0?e.textContent=t.unclaimedRewards:e.remove()}if(void 0!==t.trackedAction){const e=t.trackedAction?.title??"",i=t.trackedAction?.highlights??[];IPI.updateCurrentAction(e,i)}}};function saveImperiumOrder(t,e){var i="impSortOrder";e&&(i="impSortOrderMoon"),$.ajax({url:saveUrl,method:"post",dataType:"json",data:{ajax:1,type:i,planets:$(t).sortable("toArray")}})}function clearImperiumOrder(){$.ajax({url:saveUrl,method:"post",dataType:"json",data:{ajax:1,type:"reset"},success:function(t){t.error||location.reload()}})}function createSummaryHtml(t){var e="",i=null,n=0,a=0,s="";for(group in e=e+'<div class="planetHead"><div class="planetname">'+t.translations.summary+'</div><div class="planetImg"><img src="/img/icons/7efb2e73ca11d2344bbed43668da10.jpg"/></div><div class="planetData"><ul><li class="coords textLeft"></li><li class="fields textRight"></li></ul></div><div class="clearfloat"></div></div>',t.groups){for(e=e+'<div class="row"></div><div class="values '+group+" group"+group+'">',a=0;s=t.groups[group][a];a++)if(null!=t.translations.planets[s]){var o={hourly:0,daily:0,weekly:0};if("name"==s?n=t.translations.summary:(n=0,"research"==group?isNaN(t.planets[0][s])||(n=t.planets[0][s]):$.each(t.planets,(function(){i=this,isNaN(i[s])||(n+=parseInt(i[s]),"supply"!=group||isNaN(i.production.hourly[s-1])||(o.hourly+=i.production.hourly[s-1],o.daily+=i.production.daily[s-1],o.weekly+=i.production.weekly[s-1]))}))),n="supply"==group||"station"==group?"&#x00F8; "+tsdpkt(round(n/t.planets.length,1)):"items"==group?"&nbsp;":tsdpkt(n),"supply"==group&&"name"!=s&&o.hourly>0){var r="<table><tr><td>"+t.translations.production.hourly+":</td><td style=&quot;text-align: right;&quot;>"+tsdpkt(o.hourly)+"</td></tr><tr><td>"+t.translations.production.daily+":</td><td style=&quot;text-align: right;&quot;>"+tsdpkt(o.daily)+"</td></tr><tr><td>"+t.translations.production.weekly+":</td><td style=&quot;text-align: right;&quot;>"+tsdpkt(o.weekly)+"</td></tr></table>";r=r.replace(/</,"&lt;").replace(/>/,"&gt;"),e=e+'<div class="tooltipRight '+s+'" title="'+r+'">'+n+"</div>"}else e=e+'<div class="'+s+'">'+n+"</div>"}e+="</div>"}return e='<div id="planet0" class="planet summary">'+e+"</div>"}function createHeaderHtml(t){var e="",i=0,n="";for(group in e=e+'<div id="wrapTL"><div id="tab-left"><a id="planetsTab" href="javascript:void(0);" class="active" title=""><span>'+t.translations.planetsTab+'</span></a><a id="moonsTab" href="javascript:void(0);" title="" class=""><span>'+t.translations.moonsTab+"</span></a></div></div>",t.groups){for(e=e+'<div id="'+group+'" class="firstCat headers '+group+" headers"+group+'" group="'+group+'"><h3 class="open"><span>'+t.translations.groups[group]+'</span></h3><ul class="secondCat '+group+" group"+group+'">',i=0;n=t.groups[group][i];i++)null!=t.translations.planets[n]&&(e+='<li class="'+n+'">',t.translations.planets[n+"_full"]!=t.translations.planets[n]?e+='<span class="tooltipLeft" title="'+t.translations.planets[n+"_full"]+'">'+t.translations.planets[n]+"</span>":e+="<span>"+t.translations.planets[n]+"</span>",e+="</li>");e+="</ul></div>"}return e='<div id="empireTab"><div class="wrapTab"><div class="tab-part01"></div><h2>'+t.translations.header+'</h2><span class="reset"><img src="/img/icons/f805c477d15ae3131b7c39c7d70e48.gif" width="16" height="16"><a href="javascript:void(0);" onClick="clearImperiumOrder(); return false;">'+t.translations.reset+'</a></span><div class="wrapCorner"></div><br class="clearfloat"/></div></div><div class="header">'+e+"</div>"}function createPlanetsHtml(t){var e="",i="",n="",a="",s="",o=0,r="";return $.each(t.planets,(function(){for(var l in n="",a="",i=(e=this).name.length>13?e.name.substr(0,11)+"...":e.name,n+='<div class="planetHead">',e.name!=i?n+='<div class="planetname tooltip" title="'+e.name+'">'+i+"</div>":n+='<div class="planetname">'+i+"</div>",isMobile?n+='<div class="planetImg"><img class="'+e.border+'" src="'+e.image+'"/></div><div class="planetData"><div class="planetDataTop odd"><ul><li class="coords textLeft"><a class="dark_highlight_tablet" href="'+e.coordinatesLink+'" >'+e.coordinates+'</a></li><li class="coords"><span class="dark_highlight_tablet energy tooltipRight" title="'+(3==e.type?e.diameterTooltip:e.energyTooltip)+'">'+(3==e.type?": "+e.diameter:e.energyDescr+e.energy)+'</span></li></ul></div><div class="planetDataTop"><ul class="planet_data_2"><li class="fields textLeft">'+e.fieldUsed+"/"+e.fieldMax+'</li><li class="fields textLeft">'+e.temperature+'</li></ul></div></div><div class="clearfloat"></div></div>':n+='<div class="planetImg"><img class="'+e.border+'" src="'+e.image+'"/></div><div class="planetData"><div class="planetDataTop odd"><ul><li class="coords textLeft"><a href="'+e.coordinatesLink+'" >'+e.coordinates+'</a></li><li class="fields textRight">'+e.fieldUsed+"/"+e.fieldMax+'</li></ul></div><div class="planetDataTop"><ul><li class="coords textLeft">'+(3==e.type?e.diameterDescr:e.energyDescr)+'</li><li class="coords textRight">'+(3==e.type?e.diameter:e.energy)+'</li></ul></div><div class="planetDataBottom odd"><ul><li class="fields textCenter">'+e.temperature+'</li></ul></div></div><div class="clearfloat"></div></div>',t.groups){for(n=n+'<div class="row"></div><div class="values '+l+" group"+l+'">',o=0;r=t.groups[l][o];o++)r=String(r),null!=e[r+"_html"]&&(r+="_html"),a=r,"_html"==r.substring(r.length-5)&&(a=r.substring(0,r.length-5)),n=n+'<div class="'+a+'">'+e[r]+"</div>";n+="</div>"}s=s+'<div id="planet'+this.id+'" class="planet">'+n+"</div>"})),s}function createImperiumHtml(t,e,i,n){var a=0;void 0!==i.planets&&(a=i.planets.length);var s=345+165*a;$("#mainWrapper").attr("style","width: "+s+"px"),$(e).show();var o=createHeaderHtml(i)+'<div class="planetWrapper">'+createPlanetsHtml(i)+createSummaryHtml(i)+'</div><br class="clearfloat"/>';for(group in $(t).append(o),$(t+" .planetWrapper").sortable({start:function(){removeTooltip(getTooltipSelector())},update:function(){saveImperiumOrder(t+" .planetWrapper",n)}}).disableSelection(),i.groups){$(t+" .headers"+group).click((function(){var e=t+" .group"+$(this).attr("group"),i="#"+$(this).attr("group")+" h3";$(e).toggle(),$(i).removeClass("openhover").removeClass("closehover").removeClass("close").removeClass("open"),"none"==$(e).attr("style").toLowerCase().substr(9,4)?($(i).addClass("close"),$.cookie("impToggleState"+$(this).attr("group"),"1",{expires:365})):($(i).addClass("open"),$.cookie("impToggleState"+$(this).attr("group"),"0",{expires:365}))}));var r=$.cookie("impToggleState"+group);null!=r&&"1"==r&&($("#"+group+" > h3").removeClass("open"),$("#"+group+" > h3").addClass("close"),$(t+" .group"+group).toggle())}$(e).hide();var l=$.inArray(0,empireOrder);l>-1&&$(".planetWrapper .planet:eq("+l+"):not(:last-child)").before($("#planet0")),initTooltips()}function displayMessage(t){location.reload(!0)}function doUpgrade(t,e,i,n,a){let s;s=1===planetType?LocalizationStrings.lastSlotWarningMoon:LocalizationStrings.lastSlotWarningPlanet,a?errorBoxDecision(LocalizationStrings.attention,s,LocalizationStrings.yes,LocalizationStrings.no,(function(){executeBuildAction(t,e,i,n)})):executeBuildAction(t,e,i,n)}function executeBuildAction(t,e,i,n){1===i?buildListActionBuild(t,null,null,null,e):3===i?buildListActionDemolish(t,e):2===i&&n&&buildListActionCancel(t,n,e)}function initEmpire(){initConnectionErrorFunction(),$(".secondCat").each((function(){$(this).find("li:last").addClass("catbox-end")})),$(".values").each((function(){$(this).hasClass("groupitems")||($(this).find("div:even").addClass("even"),$(this).find("div:odd").addClass("odd"),$(this).find("div:last").addClass("box-end")),$(this).children().hasClass("equipment")&&$(this).children(".equipment").addClass("box-end")})),$("#settings li:last").addClass("set-end"),$(".header h3").hover((function(){$(this).addClass($(this).attr("class")+"hover")}),(function(){$(this).removeClass("openhover").removeClass("closehover")})),$(".header h3").click((function(){$(this).removeClass("openhover").removeClass("closehover");var t=$(this).attr("class");"open"==t?$(this).addClass("close"):$(this).addClass("open"),$(this).removeClass(t)})),$(".planet").hover((function(){$(this).addClass("move")}),(function(){$(this).removeClass("move")})),$(".values div img").hover((function(){$(this).addClass("imghover")}),(function(){$(this).removeClass("imghover")})),$("#planetsTab").click((function(){window.location.href=empireUrl+"&planetType=0"})),moonCount>0?$("#moonsTab").click((function(){window.location.href=empireUrl+"&planetType=1"})):$("#moonsTab").addClass("nomoons"),1==planetType&&($("#planetsTab").removeClass("active"),$("#moonsTab").addClass("active")),initBuffBarEmpire()}function initBuffBarEmpire(){$(".empireItems").removeClass("hidden")}function changeSetting(t,e,i,n,a){$.ajax({type:"POST",url:changeSettingsLink,dataType:"json",data:{_token:changeSettingsToken,key:t,value:e},success:function(t){changeSettingsToken=t.newToken,t.message.length>0&&fadeBox(t.message,t.error),t.error||"function"!=typeof i?t.error&&"function"==typeof n&&n():i()},error:function(t){(void 0===a||a)&&fadeBox(LocalizationStrings.error,!0),t.error&&"function"==typeof n&&n()}})}function getOverlayText(t){return t.hasClass("building")&&t.children().hasClass("build-faster-img")||t.hasClass("building")&&t.children().hasClass("build-finish-img")?questionbuilding:t.hasClass("lfbuilding")&&t.children().hasClass("build-faster-img")||t.hasClass("lfbuilding")&&t.children().hasClass("build-finish-img")?questionlfbuilding:t.hasClass("ship")&&t.children().hasClass("build-faster-img")||t.hasClass("ship")&&t.children().hasClass("build-finish-img")?questionship:t.hasClass("shipextended")&&t.children().hasClass("build-faster-img")||t.hasClass("shipextended")&&t.children().hasClass("build-finish-img")?questionshipextended:t.hasClass("research")&&t.children().hasClass("build-faster-img")||t.hasClass("research")&&t.children().hasClass("build-finish-img")?questionresearch:t.hasClass("lfresearch")&&t.children().hasClass("build-faster-img")||t.hasClass("lfresearch")&&t.children().hasClass("build-finish-img")?questionlfresearch:void 0}function getFastBuildPrice(t){return t.hasClass("building")?pricebuilding:t.hasClass("lfbuilding")?pricelfbuilding:t.hasClass("research")?priceresearch:t.hasClass("lfresearch")?pricelfresearch:t.hasClass("ship")?priceship:t.hasClass("shipextended")?priceshipextended:void 0}function getRedirectLink(t){var e={};if(null!=t){for(var i in t)e[i]=t[i];return $.param.fragment($.param.querystring(window.location.href,e),{})}return window.location.href.split("#")[0]}function sendShips(t,e,i,n,a,s,o){1==shipsendingDone&&(shipsendingDone=0,params={mission:t,galaxy:e,system:i,position:n,type:a,shipCount:s,_token:token},o&&"object"==typeof o&&Object.keys(o).map((t=>{params[t]||(params[t]=o[t])})),$.ajax(miniFleetLink,{data:params,dataType:"json",type:"POST",success:function(t){token=t.newAjaxToken,updateOverlayToken("phalanxSystemDialog",t.newAjaxToken),updateOverlayToken("phalanxDialog",t.newAjaxToken),getAjaxEventbox(),displayMiniFleetMessage(t.response),refreshFleetEvents(!0)}}))}function sendShipsWithPopup(t,e,i,n,a,s){params={mission:t,galaxy:e,system:i,position:n,type:a,shipCount:s,_token:token},$.ajax(miniFleetLink,{data:params,dataType:"json",type:"POST",success:function(t){token=t.newAjaxToken,updateOverlayToken("phalanxSystemDialog",t.newAjaxToken),updateOverlayToken("phalanxDialog",t.newAjaxToken),t.response.success?fadeBox(t.response.message+" "+t.response.coordinates.galaxy+":"+t.response.coordinates.system+":"+t.response.coordinates.position,!t.response.success):fadeBox(t.response.message,!0)}})}function outlawWarning(t,e,i,n,a,s,o){"function"!=typeof o&&(t==constants.espionage?o=function(){sendShips(t,e,i,n,a,s)}:t==constants.missleattack&&(o=function(){openOverlay(missleAttackLink+"&galaxy="+e+"&system="+i+"&position="+n+"&planetType="+a,{modal:!0})})),showOutlawWarning?errorBoxDecision(LocalizationStrings.attention,LocalizationStrings.outlawWarning,LocalizationStrings.yes,LocalizationStrings.no,o):o()}function initThousandSeparator(){$(".checkThousandSeparator").each((function(t){formatNumber(this,this.value)})).on("keydown",(function(t){var e=$(this).getSelection();if(0===e.length){var i=$(this).val();8===t.which&&i.substr(e.start-1,1)===LocalizationStrings.thousandSeperator&&(e.start-=1,e.end-=1,$(this).setSelection(e)),46===t.which&&i.substr(e.start,1)===LocalizationStrings.thousandSeperator&&(e.start+=1,e.end+=1,$(this).setSelection(e))}})).on("keyup",(function(t){formatNumber(this,this.value)}))}var speedingUpBuildListEntry=!1;function initIndex(){initConnectionErrorFunction(),timerHandler.appendCallback((function(){localTime=new Date,serverTime=new Date(localTime.valueOf()+timeDiff),$(".OGameClock").html(getFormatedDate(serverTime.getTime(),"[d].[m].[Y] <span>[H]:[i]:[s]</span>"))})),$("select").ogameDropDown(),$("#planet .slot").hover((function(){$(this).addClass("slot-hover")}),(function(){$(this).removeClass("slot-hover")})),$("#eventboxFilled").hover((function(){$(this).addClass("eventboxHover")}),(function(){$(this).removeClass("qeventboxHover")})),$(document).undelegate("a.build-faster","click").delegate("a.build-faster","click",(function(){var t=$(this);if(darkMatter<getFastBuildPrice(t))errorBoxDecision(LocalizationStrings.error,LocalizationStrings.errorNotEnoughDM,LocalizationStrings.yes,LocalizationStrings.no,redirectPremium);else if(!speedingUpBuildListEntry){speedingUpBuildListEntry=!0;var e=$.deparam.querystring().page;errorBoxDecision(LocalizationStrings.notice,getOverlayText(t),LocalizationStrings.yes,LocalizationStrings.no,(function(){return $.ajax({url:t.attr("rel"),data:{ajax:1,_token:token,referrerPage:e},type:"POST",dataType:"json",error:function(){fadeBox(LocalizationStrings.error,!0),t.addClass("disabled"),speedingUpBuildListEntry=!1},success:function(e){token=e.newAjaxToken,e.error?(fadeBox(e.message,!0),t.addClass("disabled"),speedingUpBuildListEntry=!1):location.href=getRedirectLink()}}),!1}),(function(){speedingUpBuildListEntry=!1}))}})).undelegate(".slideIn","click").delegate(".slideIn","click",(function(){$(".slideIn").removeClass("active");var t=$(this).attr("ref");$("a[ref='"+t+"']").addClass("active"),Tipped.hideAll(),$("html, body").animate({scrollTop:0},500),gfSlider.slideIn(getElementByIdWithCache("detail"),t)})).undelegate("a.close_details","click").delegate("a.close_details","click",(function(){void 0!==window.gfSlider&&gfSlider.hide(getElementByIdWithCache("detail"))})),$("#banner_skyscraper a.close_details").click((function(){changeSetting("hideBanner",$(this).attr("ref"),(function(){$("#banner_skyscraper").remove()}))}));var t=$("#wreckFieldCountDown");t&&new simpleCountdown(t,t.data("duration"),null),initHideElements(),initOverlays(),initThousandSeparator(),initTooltips(),initPlanetSorting(),initRetinaImages(),initBDayEventHints()}function initPlanetSorting(){$("#planetList.sortable").sortable({start:function(){Tipped.hideAll()},stop:function(){Tipped.hideAll(),changeSetting("customPlanetOrder",$(this).sortable("toArray"))}}),$(".lockPlanets").hasClass("closed")&&$("#planetList.sortable").sortable("disable"),$(".lockPlanets").unbind("click").bind("click",(function(){var t=$(this);changeSetting("planetOrderLocked",t.hasClass("open")?1:0,(function(){var e;t.hasClass("open")?(t.removeClass("open").addClass("closed"),$("#planetList.sortable").sortable("disable"),e=LocalizationStrings.planetOrder.unlock):(t.removeClass("closed").addClass("open"),$("#planetList.sortable").sortable("enable"),e=LocalizationStrings.planetOrder.lock),changeTooltip(t,e)}))}))}function initHideElements(){$(document).undelegate("html","touchstart.hideElem click.hideElem").delegate("html","touchstart.hideElem click.hideElem",(function(t){if(t.stopPropagation(),!$(this).data("noclick"))if(isMobile){var e=t.target.tagName.toUpperCase();"TEXTAREA"!==e&&"INPUT"!==e&&"SELECT"!==e&&document.activeElement.blur(),$(t.target).parents(".markItUpHeader ul").length||$(".markItUpHeader ul ul").hide()}else{if($(t.target).parents(".ui-dialog").length||$(t.target).parents(".tpd-tooltip").length)return;var i=$(".overlayDiv");if(void 0!==i.data("uiDialog")){for(var n=i.find(".markItUpDropMenu[id]"),a=0;a<n.length;++a){$("body>ul[rel="+n[a].id+"]").hide()}i.dialog("close"),$("#FederationLayer").length>0&&$("#FederationLayer").remove()}}}))}function initJumpgate(){$("select").ogameDropDown(),$(".list tr:even").addClass("alt"),$(document).undelegate("#jumpgateForm .ship_input_row .textinput","keyup change input").delegate("#jumpgateForm .ship_input_row .textinput","keyup change input",(function(){checkIntInput(this,0,$(this).attr("rel"))})).undelegate("#jumpgateForm .ship_input_row .textinput","focus").delegate("#jumpgateForm .ship_input_row .textinput","focus",(function(){!1===$.isNumeric($(this).val())?$(this).val(""):$(this).select()})),$("#jumpgate .answerHeadline, .js_openStandardMoonMenu").click((function(){player.hasCommander?($("#jumpgate").find(".answerHeadline").toggleClass("open"),$(".thirdCol").toggleClass("hidden")):errorBoxNotify(LocalizationStrings.error,translation.changeSettingOnlyWithCommander,LocalizationStrings.ok,null,!1)})),$(".js_executeJumpButton").click((function(){var t=$("#jumpgateForm").find('select[name="targetSpaceObjectId"]').val();if(window.jumpGateTargetId=t,0!=t){var e=!0;$(".ship_selection_table input").each((function(){$(this).val()>0&&(e=!1)})),e?fadeBox(translation.noShipsWereSelected,!0):ajaxFormSubmit("jumpgateForm",$(this).attr("data-url"),jumpgateDone)}else fadeBox(translation.validTargetNeeded,!0)}))}function jumpgateDone(t){(t=$.parseJSON(t)).status&&(planet=t.targetMoon,$(".overlayDiv").dialog("destroy")),errorBoxAsArray(t.errorbox),void 0!==t.newAjaxToken&&setNewTokenData(t.newAjaxToken)}function jumpgateDefaultTargetSelectionCallback(t){if((t=$.parseJSON(t)).status){token=t.token,$("#jumpgateForm").find('input[name="token"]').val(t.token);var e=$("#jumpgateForm").find('select[name="targetSpaceObjectId"]');e.find("option").removeAttr("selected");var i=e.find('option[value="'+t.targetMoon+'"]');i.length?i.attr("selected","selected"):0==e.find('option[value="0"]').length?e.append($(document.createElement("option")).attr("value",0).attr("selected","selected").text("--")):e.find('option[value="0"]').attr("selected","selected"),e.trigger("change"),e.ogameDropDown("refresh")}errorBoxAsArray(t.errorbox),void 0!==t.newAjaxToken&&setNewTokenData(t.newAjaxToken)}function setNewTokenData(t){$('#jumpgateForm input[name="token"]').val(t),$('#jumpgateDefaultTargetSelectionForm input[name="token"]').val(t),token=t}function openJumpgate(){openOverlay(jumpGateLink,{title:jumpGateLoca.LOCA_STATION_JUMPGATE_HEADLINE})}function redirectLogout(){location.href=redirectLogoutLink}function redirectBuyPremium(){location.href=redirectPremiumLink}function redirectOverview(){location.href=redirectOverviewLink}function redirectSpaceDock(){location.href=redirectSpaceDockLink}if(void 0===KeyEvent)var KeyEvent={DOM_VK_CANCEL:3,DOM_VK_HELP:6,DOM_VK_BACK_SPACE:8,DOM_VK_TAB:9,DOM_VK_CLEAR:12,DOM_VK_RETURN:13,DOM_VK_ENTER:14,DOM_VK_SHIFT:16,DOM_VK_CONTROL:17,DOM_VK_ALT:18,DOM_VK_PAUSE:19,DOM_VK_CAPS_LOCK:20,DOM_VK_ESCAPE:27,DOM_VK_SPACE:32,DOM_VK_PAGE_UP:33,DOM_VK_PAGE_DOWN:34,DOM_VK_END:35,DOM_VK_HOME:36,DOM_VK_LEFT:37,DOM_VK_UP:38,DOM_VK_RIGHT:39,DOM_VK_DOWN:40,DOM_VK_PRINTSCREEN:44,DOM_VK_INSERT:45,DOM_VK_DELETE:46,DOM_VK_0:48,DOM_VK_1:49,DOM_VK_2:50,DOM_VK_3:51,DOM_VK_4:52,DOM_VK_5:53,DOM_VK_6:54,DOM_VK_7:55,DOM_VK_8:56,DOM_VK_9:57,DOM_VK_SEMICOLON:59,DOM_VK_EQUALS:61,DOM_VK_A:65,DOM_VK_B:66,DOM_VK_C:67,DOM_VK_D:68,DOM_VK_E:69,DOM_VK_F:70,DOM_VK_G:71,DOM_VK_H:72,DOM_VK_I:73,DOM_VK_J:74,DOM_VK_K:75,DOM_VK_L:76,DOM_VK_M:77,DOM_VK_N:78,DOM_VK_O:79,DOM_VK_P:80,DOM_VK_Q:81,DOM_VK_R:82,DOM_VK_S:83,DOM_VK_T:84,DOM_VK_U:85,DOM_VK_V:86,DOM_VK_W:87,DOM_VK_X:88,DOM_VK_Y:89,DOM_VK_Z:90,DOM_VK_CONTEXT_MENU:93,DOM_VK_NUMPAD0:96,DOM_VK_NUMPAD1:97,DOM_VK_NUMPAD2:98,DOM_VK_NUMPAD3:99,DOM_VK_NUMPAD4:100,DOM_VK_NUMPAD5:101,DOM_VK_NUMPAD6:102,DOM_VK_NUMPAD7:103,DOM_VK_NUMPAD8:104,DOM_VK_NUMPAD9:105,DOM_VK_MULTIPLY:106,DOM_VK_ADD:107,DOM_VK_SEPARATOR:108,DOM_VK_SUBTRACT:109,DOM_VK_DECIMAL:110,DOM_VK_DIVIDE:111,DOM_VK_F1:112,DOM_VK_F2:113,DOM_VK_F3:114,DOM_VK_F4:115,DOM_VK_F5:116,DOM_VK_F6:117,DOM_VK_F7:118,DOM_VK_F8:119,DOM_VK_F9:120,DOM_VK_F10:121,DOM_VK_F11:122,DOM_VK_F12:123,DOM_VK_F13:124,DOM_VK_F14:125,DOM_VK_F15:126,DOM_VK_F16:127,DOM_VK_F17:128,DOM_VK_F18:129,DOM_VK_F19:130,DOM_VK_F20:131,DOM_VK_F21:132,DOM_VK_F22:133,DOM_VK_F23:134,DOM_VK_F24:135,DOM_VK_NUM_LOCK:144,DOM_VK_SCROLL_LOCK:145,DOM_VK_COMMA:188,DOM_VK_PERIOD:190,DOM_VK_SLASH:191,DOM_VK_BACK_QUOTE:192,DOM_VK_OPEN_BRACKET:219,DOM_VK_BACK_SLASH:220,DOM_VK_CLOSE_BRACKET:221,DOM_VK_QUOTE:222,DOM_VK_META:224};function OGameLoadingIndicator(t){this.container=t}function MessageSlider(t){var e=this;e.htmlobject=t;var i=document.documentElement.clientHeight-160;this.open=function(){this.inAction||(e.startTime=(new Date).getTime(),e.inAction=!0,e.slideInStep())},this.slideInStep=function(){time=(new Date).getTime(),height=parseInt(e.currHeight*((time-e.startTime)/500)),height<e.currHeight?(e.htmlobject.style.height=height+"px",window.setTimeout(e.slideInStep,10)):(e.htmlobject.style.height=e.currHeight+"px",e.inAction=!1)},this.close=function(){e.inAction||(e.startTime=(new Date).getTime(),e.inAction=!0,e.htmlobject.style.height="0px",e.inAction=!1)},e.inAction=!1,document.getElementById("messages")?e.currHeight=Math.min(document.getElementById("messages").offsetHeight,i):e.currHeight=i}function initShowMessage(){var t=$('.overlayDiv[data-page="showmessage"]');$(".answerHeadline",t).click((function(){$(this).toggleClass("open"),$(this).hasClass("open")?($(".answerForm",t).show(),$(".textWrapper",t).addClass("textWrapperSmall"),$(".textWrapper",t).removeClass("textWrapper")):($(".answerForm",t).hide(),$(".textWrapperSmall",t).addClass("textWrapper"),$(".textWrapperSmall",t).removeClass("textWrapperSmall"))})),$(".note > div:first-child",t).addClass("newMessage"),$(".info:odd",t).css("margin-left","40px"),$("div.note p:first").after('<span class="seperator">'),$(".answerHeadline",t).hover((function(){$(this).addClass("pushable")}),(function(){$(this).removeClass("pushable")})),$(".melden",t).click((function(){manageErrorbox($(this).attr("rel"),1)}))}function initNetworkAjax(){var t=$(".reiter");if(!$.isFunction(e))var e=function(){t.removeClass("active"),$(this).addClass("active"),ajaxLoad($(this).attr("id"),1)};t.off("click"),t.click(e),$("#checkAll").off("click").click((function(){$(".checker").prop("checked",$(this).is(":checked"))})),$(".overlay").click((function(){var t=$(this).attr("id");markAsRead(t)})),$("#messageContent select").change((function(){void 0===$("select option:selected").attr("id")?($(".buttonOK").hide(),mod=""):($(".buttonOK").show(),mod=$("select option:selected").attr("id"))})),$(".del").click((function(){mod=$(this).attr("id")})),$(".underlined").click((function(){$(".buttonOK").hide()})),reduceMsgCount(aktCat)}function closeDetails(t,e){var i=$("#fleet"+t);i.children(".openDetails").children().children().attr("src","/img/icons/de1e5f629d9e47d283488eee0c0ede.gif"),i.children(".quantity").show(),i.removeClass("detailsOpened"),i.addClass("detailsClosed"),currentMovementTabExtensionStates[t]=[0,e],updateCookieStatus(currentMovementTabExtensionStates)}function openDetails(t,e){var i=$("#fleet"+t);i.children(".openDetails").children().children().attr("src","/img/icons/577565fadab7780b0997a76d0dca9b.gif"),i.children(".quantity").hide(),i.removeClass("detailsClosed"),i.addClass("detailsOpened"),currentMovementTabExtensionStates[t]=[1,e],updateCookieStatus(currentMovementTabExtensionStates)}function updateCookieStatus(t){var e=JSON.stringify(t),i=JSON.stringify({expires:Math.round((new Date).getTime()/1e3)+604800});$.cookie("tabBoxFleets",e,i)}function openCloseDetails(t,e){"fleetDetails detailsOpened"==$("#fleet"+t).attr("class")?closeDetails(t,e):openDetails(t,e)}function preCloseMovements(){$.each(currentMovementTabExtensionStates,(function(t,e){if(0==e[0]){var i=$("#fleet"+t+" span.openDetails a").attr("data-end-time");closeDetails(t,i)}}))}function initMovement(){if(initToggleHeader("movement"),preCloseMovements(),null==t)var t=0;$("a.openCloseDetails").click((function(){openCloseDetails($(this).attr("data-mission-id"),$(this).attr("data-end-time"))})),$(".closeAll").click((function(){0==t?(t=1,$(".closeAll").children().removeClass("all_open").addClass("all_closed")):(t=0,$(".closeAll").children().removeClass("all_closed").addClass("all_open")),$("a.openCloseDetails").each((function(){1===t?closeDetails($(this).attr("data-mission-id"),$(this).attr("data-end-time")):0===t&&openDetails($(this).attr("data-mission-id"),$(this).attr("data-end-time"))}))})),timerHandler.appendCallback((function(){}))}function addUserToUnion(){$("#participantselect").append($("#buddyselect").find("li.ui-selected"))}function removeUserFromUnion(){$("#buddyselect").append($("#participantselect").find("li.ui-selected"))}function addUserToUnionByForm(){var t=$("#unionUserSearch").find('[name="addtogroup"]'),e=t.val(),i=$("#participantselect");0==i.find('li[ref="'+e+'"]').length&&i.append($(document.createElement("li")).attr("ref",e).text(e)),t.val("")}function setUnionUsers(){var t="";$("#participantselect").find("li").each((function(){t+=$(this).attr("ref")+";"})),t=t.substring(0,t.length-1),$("#unionUsers").val(t)}function unionUser(t){var e=$.parseJSON(t);e.status?addUserToUnionByForm():errorBoxAsArray(e.errorbox)}function initFederationLayer(){$("#switch").click((function(){var t=$("#searchFed");t.find("> .wrap").toggle(),t.find("> #honorWarning").toggle()})),$("#buddyselect, #participantselect").selectable({filter:"li:not(.undermark)"}),$(document).undelegate("ul#buddyselect li","dblclick").delegate("ul#buddyselect li","dblclick",(function(){addUserToUnion()})).undelegate("ul#participantselect li","dblclick").delegate("ul#participantselect li","dblclick",(function(){removeUserFromUnion()}))}function submit_unionform(){setUnionUsers(),ajaxFormSubmit("unionform",$("form#unionform").attr("action"),unionEdit)}function recallShipCountdown(t,e){var i=this,n=$(".reversal_time[ref='"+t+"']");isMobile&&n.length&&(this.updateCountdown=function(){var t=i.countdown.getLeftoverTime(),e=getFormatedDate(new Date(1e3*t+timeDiff),"[d].[m].[Y] [H]:[i]:[s]");n.html(e)},i.countdown=new oldcountdown(e,3,2),i.timer=timerHandler.appendCallback(i.updateCountdown),i.updateCountdown())}function initNotesForm(){$("select").ogameDropDown(),$("#createNote .text").trigger("keyup"),$("#popupContent").length&&initNotes()}function initNotes(){function t(t){var e=!1;return $(t).find(":input").each((function(){void 0!==$(this).data("value")&&$(this).data("value")!=$(this).val()&&(e=!0)})),e}$("select").ogameDropDown();var e=$(".overlayDiv.notices");e.find(".openOverlay").unbind("click").bind("click",(function(){var e=$(this).attr("data-overlay-class"),i={title:$(this).attr("data-title"),close:function(){var i=$("."+e);t(i.find("form"))?errorBoxDecision(LocalizationStrings.question,locaNotes.changesNotSaved+"<br/><br/>"+locaNotes.questionSaveChanges,LocalizationStrings.yes,LocalizationStrings.no,(function(){i.find("form").trigger("submit"),i.remove()}),(function(){i.remove()}),!0):i.remove()},class:e};if(openOverlay($(this).attr("href"),i),0===e.indexOf("newNote-")){var n=parseInt(e.replace(/^newNote-/,""))+1;$(this).attr("data-overlay-class","newNote-"+n)}return!1})),$(document).undelegate("#noteList form","submit").delegate("#noteList form","submit",(function(){$.post($("#noteList").attr("rel"),$(this).serialize(),(function(t){e.html(t)}))})).undelegate("#createNote form [type=submit]","click").delegate("#createNote form [type=submit]","click",(function(t){t.preventDefault(),$(this).parents("form").submit()})).undelegate("#createNote form","submit").delegate("#createNote form","submit",(function(t){t.preventDefault();var i=$(this);return $.ajax({url:$(this).attr("rel"),type:"post",data:i.serialize(),dataType:"json",error:function(){fadeBox(LocalizationStrings.error,!0)},success:function(t){null!=t.error?fadeBox(t.error,!0):$("#popupContent").length?($(window).unbind("beforeunload.checkChanges"),location.href=i.attr("rel")+"&popup=1"):(i.parents(".overlayDiv").is(":visible")&&i.parents(".overlayDiv").dialog("option","close",(function(){$(this).remove()})).dialog("close"),null!=t.success&&fadeBox(t.success,!1),e.load(e.find("#noteList").attr("rel")))}}),!1})).undelegate("#createNote .textBox","keyup touchstart change").delegate("#createNote .textBox","keyup touchstart change",(function(){var t=$(this).val().length,e=$(this).attr("data-max-length");if(t>e){var i=$(this).getSelection();$(this).val($(this).val().substr(0,e)),t=e,$(this).setSelection(i)}$(this).parents("form").find(".cntChars").text(t)})),$(window).unbind("beforeunload.checkChanges").bind("beforeunload.checkChanges",(function(){var e=!1;if($("#createNote form").each((function(){t(this)&&(e=!0)})),e)return locaNotes.changesNotSaved}))}function getAjaxEventbox(){"undefined"!=typeof ajaxEventboxURI&&$.get(ajaxEventboxURI,reloadEventbox,"text")}!function(t){t.fn.extend({ogameDropDown:function(e,i){if(t("body.showOldDropdowns").length)return this;function n(e){var i=e.outerHeight(),n=t('.dropdown.currentlySelected[rel="'+e.attr("id")+'"]');if(n.length){var a,s=Math.min(t(window).innerWidth()+t(window).scrollLeft()-e.width()-3,n.offset().left),o=Math.ceil(n.offset().top);a=o+n.height()+i+t("#siteFooter").outerHeight()>=t(window).innerHeight()+t(window).scrollTop()?o-i+1:o+n.height()+1,e.css("left",s).css("top",a).css("min-width",n.width())}}var a={destroy:function(){t(this).filter("select.dropdownInitialized").each((function(){var e=t(this);t('.dropdown[rel="'+e.data("dropdownId")+'"]').remove(),t("ul#"+e.data("dropdownId")).remove(),e.removeClass("dropdownInitialized").data("dropdownId","").show()}))},hide:function(){t(this).filter("select.dropdownInitialized").each((function(){var e=t('.currentlySelected[rel="'+t(this).data("dropdownId")+'"]');e.find("a").removeClass("hover"),t(".dropdownList#"+e.attr("rel")).hide()}))},reposition:function(){t(this).filter("select.dropdownInitialized").each((function(){n(t("#"+t(this).data("dropdownId")))}))},refresh:function(){var e=t(this).find("option[selected]");getIEVersion(),t('a[class="'+e.attr("class")+'"][rel="'+t(this).data("dropdownId")+'"]').text(e.text())},select:function(e){if(t(this).find("option").prop("selected",!1).removeAttr("selected"),"string"==typeof e&&e.length>0){let i=t(this).find("option[value='"+e+"']");if(i.length>0)return i.prop("selected",!0).attr("selected","selected"),void a.refresh.call(this)}let i=t(this.find("option[value='-']"));i.length>0&&(i.prop("selected",!0).attr("selected","selected"),a.refresh.call(this))}};if("string"==typeof e){if("function"==typeof a[e]){let t=Array.prototype.slice.call(arguments);t.shift(),a[e].apply(this,t)}return this}t(this).filter("select:not(.dropdownInitialized)").each((function(){var e=t(this),i="dropdown"+Math.floor(1e3*Math.random()),a=e.find("option[selected]");0==a.length&&(a=e.find("option:first-child"));var s=getIEVersion()<999?"#":"javascript:void(0);",o=t('<a class="'+a.attr("class")+'" data-value="'+a.val()+'" rel="'+i+'" href="'+s+'">'+a.text()+"</a>"),r=t('<span class="dropdown currentlySelected '+e.attr("class")+'" rel="'+i+'"></span>').append(o).width(e.css("width").length?e.css("width"):e.width()).data("selectElement",e);(e.is("[readonly]")||e.is(":disabled"))&&r.addClass("disabled"),e.after(r).hide().addClass("dropdownInitialized").data("dropdownId",i);var l=t('<ul class="dropdown dropdownList" id="'+i+'"></ul>').delegate("a","click",(function(i){if(i.stopPropagation(),"disabled"!==t(this).attr("disabled")){o.html(t(this).html()).attr("class",t(this).attr("class")).attr("data-value",t(this).attr("data-value")),l.hide().find("a").removeClass("focus"),t(this).addClass("focus");var n=t(this).attr("data-value");e.val(t(this).attr("data-value")).trigger("change").find('option[value="'+n+'"], option:contains("'+n+'")').trigger("click")}}));function c(){e.is(e.is("[readonly]")||":disabled")||l.hasClass("initialized")||(l.addClass("initialized"),e.find("option").each((function(){var e=t(this).html(),i="",n="";void 0!==t(this).attr("data-html")&&(e=t(this).attr("data-html")),void 0!==t(this).attr("data-html-prepend")&&(e=t(this).attr("data-html-prepend")+e),void 0!==t(this).attr("data-html-append")&&(e+=t(this).attr("data-html-append")),void 0!==t(this).attr("title")&&(n='title="'+t(this).attr("title")+'" '),void 0!==t(this).attr("disabled")&&(i='disabled="'+t(this).attr("disabled")+'" '),$li=t('<li><a class="'+t(this).attr("class")+'" '+i+n+'data-value="'+t(this).val()+'">'+e+"</a></li>"),l.append($li),t(this).is(":selected")&&$li.find("a").addClass("focus")})))}o.bind("focus",(function(e){t(".dropdownList").not(l).hide(),t(".dropdown.currentlySelected").removeClass("focus"),t(this).addClass("hover"),r.addClass("focus"),c()})).bind("mousewheel",(function(e){c(),t(this).unbind("mousewheel")})).bind("click",(function(a){a.preventDefault(),e.is(e.is("[readonly]")||":disabled")||(t(".dropdownList").not(l).hide(),t(".dropdown.currentlySelected").removeClass("focus"),r.addClass("focus"),l.is(":hidden")?(t(this).addClass("hover"),c(),n(l),t(window).unbind("resize.dropdown"+i).bind("resize.dropdown"+i,(function(){n(l)})),l.show(),l.hasScrollbar()&&l.find("a").css("padding-right",22)):(t(this).removeClass("hover"),t(window).unbind("resize.dropdown"+i),l.hide()))})),t("body").append(l)}));var s,o="";function r(e,i){o=e,clearTimeout(s),s=setTimeout((function(){o=""}),1500);var n=t(".dropdownList:visible"),a=!1;if(0==n.length){var r=t(".dropdown.currentlySelected.focus");if(!r.length)return;n=t("#"+r.attr("rel")),a=!0}var l=o.toLowerCase(),c=n.find("a").filter((function(){return 0==t(this).attr("data-value").toLowerCase().indexOf(l)||0==t(this).text().trim().toLowerCase().indexOf(l)}));c.length?(i.preventDefault(),n.find("a").removeClass("focus"),t(c.get(0)).addClass("focus").focus(),a&&c.click()):(clearTimeout(s),o="")}return t(document).undelegate("html","touchstart.dropdown click.dropdown").delegate("html","touchstart.dropdown click.dropdown",(function(e){0==t(e.target).closest(".dropdown").length&&t(".dropdownList").hide()})).undelegate(".dropdown","mousewheel.dropdown").delegate(".dropdown","mousewheel.dropdown",(function(e,n){if(!i){e.preventDefault();var a,s=t(e.target).closest(".dropdown");a=s.hasClass("currentlySelected")?t("#"+s.attr("rel")):s;var o=t('[rel="'+a.attr("id")+'"] a'),r=a.find("a:focus");0==r.length&&(r=a.find("a.focus")),0==r.length&&(r=a.find('a[data-value="'+o.attr("data-value")+'"]'));var l=r.parent(),c=null,d=Math.abs(n);if(n>0)for(var u=0;u<d;u++){if(l.is(":first-child")){c=l.find("a");break}c=l.prev().find("a"),l=c.parent()}else for(u=0;u<d;u++){if(l.is(":last-child")){c=l.find("a");break}c=l.next().find("a"),l=c.parent()}if(null!=c)if(l=c.parent(),a.find("a").removeClass("focus"),c.addClass("focus").focus(),a.is(":hidden"))c.click();else{var h=l.position().top;h<0?a.scrollTop(a.scrollTop()+h):h+l.outerHeight()>a.innerHeight()&&a.scrollTop(a.scrollTop()+h+l.outerHeight()-a.innerHeight())}}})).undelegate("*","focus.dropdown").delegate("*","focus.dropdown",(function(e){0==t(e.target).closest(".dropdown").length&&(t(".currentlySelected a").removeClass("hover"),t(".currentlySelected").removeClass("focus"))})).unbind("keydown.dropdown").bind("keydown.dropdown ",(function(e){if(!(t(":focus").length>0&&0==t(":focus").parents(".dropdown").length)){var i=!1,n=t(".dropdownList:visible");if(0==n.length){var a=t(".dropdown.currentlySelected.focus");if(!a.length)return;n=t("#"+a.attr("rel")),i=!0}var s=t('[rel="'+n.attr("id")+'"] a'),l=n.find("a:focus");0==l.length&&(l=n.find("a.focus")),0==l.length&&(l=n.find('a[data-value="'+s.attr("data-value")+'"]'));var c=l.parent(),d=null;if(e.keyCode==KeyEvent.DOM_VK_UP||e.keyCode==KeyEvent.DOM_VK_DOWN)e.keyCode==KeyEvent.DOM_VK_UP?(d=c.is(":first-child")?c.find("a"):c.prev().find("a"),c=d.parent()):(d=c.is(":last-child")?c.find("a"):c.next().find("a"),c=d.parent()),e.preventDefault();else if(e.keyCode==KeyEvent.DOM_VK_BACK_SPACE)r(o.substring(0,o.length-1),e);else if(e.keyCode==KeyEvent.DOM_VK_RETURN){if(e.preventDefault(),i)return void s.parents("form").submit();i=!0,d=l}else e.keyCode==KeyEvent.DOM_VK_ESCAPE&&(d=n.find('[data-value="'+s.attr("data-value")+'"]'),i=!0);if(null!=d)if(c=d.parent(),n.find("a").removeClass("focus"),d.addClass("focus").focus(),i)d.click();else{var u=c.position().top;u<0?n.scrollTop(n.scrollTop()+u):u+c.outerHeight()>n.innerHeight()&&n.scrollTop(n.scrollTop()+u+c.outerHeight()-n.innerHeight())}}})).unbind("keypress.dropdown").bind("keypress.dropdown",(function(e){t(":focus").length>0&&0==t(":focus").parents(".dropdown").length||0==e.charCode||r(o+String.fromCharCode(e.charCode),e)})),t(this)},selectText:function(){var e,i,n=this[0],a="function",s="object",o=function(t,e){return typeof e===t};return o(s,n.ownerDocument)&&o(s,n.ownerDocument.defaultView)&&o(a,n.ownerDocument.defaultView.getSelection)?o(a,(i=n.ownerDocument.defaultView.getSelection()).setBaseAndExtent)?i.setBaseAndExtent(n,0,n,t(n).contents().size()):o(a,n.ownerDocument.createRange)&&o(a,(e=n.ownerDocument.createRange()).selectNodeContents)&&o(a,i.removeAllRanges)&&o(a,i.addRange)&&(e.selectNodeContents(n),i.removeAllRanges(),i.addRange(e)):o(s,document.body)&&o(s,document.body.createTextRange)&&o(s,(e=document.body.createTextRange()).moveToElementText)&&o(s,e.select)&&(e.moveToElementText(n),e.select()),this},hasScrollbar:function(){return this.get(0).scrollHeight>this.innerHeight()}})}(jQuery),$(document).on("click","[data-toggable]",(function(){let t=$(this),e=t.attr("data-toggable"),i=t.parent();$(i).find('[data-toggable-target="'+e+'"]').slideToggle({start:function(){t.hasClass("active")?t.removeClass("active"):t.addClass("active")}})})),OGameLoadingIndicator.prototype.init=function(){this.element=$('<div class="og-loading"><div class="og-loading-overlay"><div class="og-loading-indicator"></div></div></div>'),this.container.append(this.element)},OGameLoadingIndicator.prototype.show=function(){this.element.show()},OGameLoadingIndicator.prototype.hide=function(){this.element.hide()},function(t){t.fn.ogameLoadingIndicator=function(e){if(this.length>0){let i=t(this[0]),n=i.data("ogameLoadingIndicator");return null==n&&(n=new OGameLoadingIndicator(i,e),t(this).data("ogameLoadingIndicator",n),n.init()),n}return null}}(jQuery),ogame.messagecounter={countData:{chat:0,messages:0,buddy:0},newChats:Array(),type_chat:10,type_message:11,type_buddy:12,currentLinkSelector:null,currentType:0,currentPlayer:null,sumNewChatMessages:0,initialize:function(t,e){var i=ogame.messagecounter;if(void 0===e&&t!==i.type_chat&&(i.currentPlayer=0),void 0===e&&t==i.type_chat)return!1;switch(void 0!==e&&(i.currentPlayer=e),i.currentType=t,t){case i.type_chat:i.currentLinkSelector=$("a.comm_menu.chat");break;case i.type_message:i.currentLinkSelector=$("a.comm_menu.messages");break;case i.type_buddy:i.currentLinkSelector=$("a.comm_menu.buddies");break;default:return!1}i.update()},initChatCounter:function(t){var e=ogame.messagecounter;e.currentLinkSelector=$("a.comm_menu.chat"),e.currentType=e.type_chat,e.setCount(t),e.update()},update:function(t){var e,i=ogame.messagecounter;e=void 0===t?chatLoca.X_NEW_CHATS:t,changeTooltip(i.currentLinkSelector,e.replace("#+#",i.getCount()))},resetCounterByType:function(t,e){var i=ogame.messagecounter.getIconSelectorByType(t);changeTooltip(i,(void 0===e?"":e).replace("#+#",0))},getCountSelectorByType:function(t){var e=ogame.messagecounter,i="";switch(t){case e.type_chat:i=$("a.comm_menu.chat .new_msg_count");break;case e.type_message:i=$("a.comm_menu.messages .new_msg_count");break;case e.type_buddy:i=$("a.comm_menu.buddies .new_msg_count")}return i},getIconSelectorByType:function(t){var e=ogame.messagecounter,i="";switch(t){case e.type_chat:i=$("a.comm_menu.chat");break;case e.type_message:i=$("a.comm_menu.messages");break;case e.type_buddy:i=$("a.comm_menu.buddies")}return i},getCounterHtml:function(t){return'<span class="new_msg_count">'+t+"</span>"},getCount:function(){var t=ogame.messagecounter;switch(t.currentType){case t.type_chat:return t.countData.chat;case t.type_message:return t.countData.messages;case t.type_buddy:return t.countData.buddy}},setCount:function(t){var e=ogame.messagecounter;switch(e.currentType){case e.type_chat:e.countData.chat=t;break;case e.type_message:e.countData.messages=t;break;case e.type_buddy:e.countData.buddy=t}},updateCountData:function(){var t=ogame.messagecounter;if(t.isOpen())t.setCount(0);else{if(t.shouldAddCounter())var e=1;else{e=t.getCountSelectorByType(t.currentType).html();e=parseInt(e)+1}t.setCount(e)}},shouldAddCounter:function(){var t=ogame.messagecounter,e=!1;return void 0===t.getCountSelectorByType(t.currentType).html()&&(e=!0),e},setNewCounter:function(t,e){t.html(e)},isOpen:function(){var t=ogame.messagecounter,e=!1;switch(t.currentType){case t.type_chat:e=ogame.chat.isOpen(t.currentPlayer);break;case t.type_message:e=location.href.indexOf("page=messages")>-1;break;case t.type_buddy:e=location.href.indexOf("page=ingame&component=buddies")>-1}return e}},ogame.messagemarker={type_chatbar:10,type_chattab:11,action_remove:20,action_add:21,currentCount:"",currentSelector:"",currentPlayernameObject:"",currentListPlayernameObject:"",currentPartnerId:"",currentListItemSelector:"",totalNewMessages:0,playerlist:new Array,newsInitialized:!1,effect:"highlight",initialize:function(){$(".new_msg_count[data-playerid]").each((function(){var t=ogame.messagemarker,e=$(this).data("playerid");e&&-1===$.inArray(e,t.playerlist)&&(t.playerlist.push(e),t.setPartnerId(e),t.updateNewMarker())})),ogame.messagemarker.effect="highlight"},initMarker:function(t){var e=ogame.messagemarker,i=0;return $.each(t,(function(t,n){e.setPartnerId(n);var a=$('.new_msg_count[data-playerid="'+n+'"]').data("new-messages");null!=a&&a>0&&(e.setSelectorByType(e.type_chatbar),e.mark(e.currentSelector,e.currentPlayernameObject,a),e.mark(e.currentListItemSelector,e.currentListPlayernameObject,a),e.setSelectorByType(e.type_chattab),e.mark(e.currentSelector,e.currentPlayernameObject,a)),i+=1})),i},setCounter:function(t,e){this.setPartnerId(t),$('.new_msg_count[data-playerid="'+this.currentPartnerId+'"]').data("new-messages",e),this.updateNewMarker()},toggle:function(t,e,i,n){this.setPartnerId(i),this.currentCount=parseInt($('.new_msg_count[data-playerid="'+this.currentPartnerId+'"]').data("new-messages")),t===this.action_add&&this.updateNewMarker(),t===this.action_remove&&this.removeNewMarker()},mark:function(t,e,i){$('.playerlist_item[data-playerid="'+this.currentPartnerId+'"] .playername').css("font-weight","bold"),$('.cb_playername[data-playerid="'+this.currentPartnerId+'"]').css("font-weight","bold")},addNewMarker:function(){var t=!1;$(this.currentSelector).find(".newMsgMarker").length||(this.mark(this.currentSelector,this.currentPlayernameObject,this.currentCount),t=!0),$(this.currentListItemSelector).find(".newMsgMarker").length||(this.mark(this.currentListItemSelector,this.currentListPlayernameObject,this.currentCount),t=!0),t||this.updateNewMarker()},removeNewMarker:function(){$('.playerlist_item[data-playerid="'+this.currentPartnerId+'"] .playername').css("font-weight","normal"),$('.cb_playername[data-playerid="'+this.currentPartnerId+'"]').css("font-weight","normal")},updateNewMarker:function(){var t=parseInt($('.new_msg_count[data-playerid="'+this.currentPartnerId+'"]').data("new-messages")),e=$(".new_msg_count.totalChatMessages").text(),i=ogame.chat.updateTotalNewChatCounter();0===t?isNaN(this.currentPartnerId)?$(".new_msg_count.totalMessages.news").text(t).addClass("noMessage"):($('.new_msg_count[data-playerid="'+this.currentPartnerId+'"]').text(t).addClass("noMessage"),0===i?$(".new_msg_count.totalChatMessages").text(i).addClass("noMessage"):e!=i&&$(".new_msg_count.totalChatMessages").text(i).removeClass("noMessage").effect(ogame.messagemarker.effect,{},500)):isNaN(this.currentPartnerId)?isNaN(t)?$(".new_msg_count.totalMessages.news").text(0).addClass("noMessage"):$(".new_msg_count.totalMessages.news").text(t).removeClass("noMessage").effect(ogame.messagemarker.effect,{},500):($('.msg[data-playerid="'+this.currentPartnerId+'"]').addClass("msg_new"),$('.new_msg_count[data-playerid="'+this.currentPartnerId+'"]').text(t).removeClass("noMessage").effect(ogame.messagemarker.effect,{},500),e!=i&&$(".new_msg_count.totalChatMessages").text(i).removeClass("noMessage").effect(ogame.messagemarker.effect,{},500))},setSelectorByType:function(t){selector="",t==this.type_chatbar&&(selector='ul.chat_bar_list li.chat_bar_list_item[data-playerid="'+this.currentPartnerId+'"]'),t==this.type_chattab&&(selector='ul#chatMsgList li.msg[data-playerid="'+this.currentPartnerId+'"]'),this.currentListItemSelector='.js_playerlist ul.playerlist li.playerlist_item[data-playerid="'+this.currentPartnerId+'"]',this.currentSelector=selector,this.currentPlayernameObject=$(selector).find(".cb_playername"),this.currentListPlayernameObject=$(this.currentListItemSelector).find(".playername")},setPartnerId:function(t){this.currentPartnerId=t}},ogame.messages={data:{initActions:{"tabs-nfFleets":"initTabFleets","tabs-nfCommunication":"initTabCommunication","tabs-nfMarket":"initTabMarket","subtabs-nfCommunicationMessages":"initSubTabMessages"}},addMessage:function(t,e,i){if(!1!==i&&(i=!0),"true"===t.attr("aria-selected"))if(e){var n=$("#"+t.attr("aria-controls")).find(".tab_inner"),a=!1;i&&(a=!0),ogame.messages.createMessageItem(e,n,a)}else console.warn("addMessage: msgData is ",e);else console.warn("addMessage: not correct Tab, aria-selected = ",t.attr("aria-selected"),t)},createMessageItem:function(t,e,i){var n={};for(var a in t){var s=t[a];n[a]=s.msgID}var o=JSON.stringify(n);$.ajax({url:"?page=messages",type:"POST",dataType:"html",data:{messageId:o,tabid:this.getCurrentMessageTab(),_token:token,action:121,ajax:1},success:function(t){if(token=t.newAjaxToken,i)e.prepend(t);else{var n=e.find(".favoriteCount");n.length>0?$(t).insertBefore(n):e.append(t)}},error:function(t,e,i){}})},createBroadcastMsgItem:function(t){if(t){var e=$('<div class="msg_head"></div>');e.append('<span class="msg_title blue_txt">'+t.title+"</span>"),e.append('<span class="msg_date fright">'+t.date+"</span><br>"),e.append('<span class="msg_sender_label">'+loca.LOCA_WRITE_MSG_FROM+": </span>"),e.append('<span class="msg_sender">'+t.senderName+"</span>");var i=$('<div class="msg_actions clearfix"></div>');i.append('<a class="fright txt_link overlay" href="'+t.detailURL+'" data-overlay-title="'+loca.broadcasts+'">'+loca.details+"</a>"),i.append('<a class="fright txt_link comments_link overlay" href="'+t.commentsURL+'" data-overlay-title="'+loca.broadcasts+'">'+t.commentsCount+' <span class="comments"></span></a></a>');var n=$('<li class="msg '+t.newClass+'" data-msg-id="'+t.msgID+'"></li>');return n.append('<div class="msg_status"></div>'),n.append(e),n.append('<span class="msg_content">'+t.msgContent+"</span>"),n.append(i),n}console.warn("createMessageItem: msgData is missing!")},createRecipient:function(t,e,i){var n;($(".input_replacement").each((function(){new RegExp($(this).data("recipient-cat")).test(e)&&(n=$(this))})),void 0!==n)&&(0===n.children(".recipient_txt").filter((function(){return $(this).data("recipient-id")===t})).length&&(n.hasClass("focus")||n.addClass("focus"),n.append('<div class="recipient_txt" data-recipient-id="'+t+'" data-recipient-cat="'+e+'">'+i+'<a role="button" class="remove_recipient"></a></div>')))},doInitAction:function(t){if("function"==typeof ogame.messages[ogame.messages.data.initActions[t]])return ogame.messages[ogame.messages.data.initActions[t]]()},initCombatReportDetails:function(){$("select").length>0&&$("select").ogameDropDown()},initDetailMessages:function(t){$(".detail_list_el:nth-of-type(4n + 3), .detail_list_el:nth-of-type(4n + 4)").addClass("odd");var e=$(window).height()-200;$(".detail_msg_ctn").css("height",e),$(".detail_msg_ctn").mCustomScrollbar({theme:"ogame"}),t&&($("#scrollToComments").on("click",(function(){$(".detail_msg_ctn").mCustomScrollbar("scrollTo","bottom")})),initBBCodeEditor(locaKeys,itemNames,!1,".comment_textarea",2e3)),$("#messages ul.pagination").on("click","li.p_li a",(function(){var t=$(this).data("tabid"),e=$(this).data("messageid");$.post("?page=messages",{tabid:t,messageId:e,_token:token,ajax:1},(function(t){$(t).find("#messages .ui-dialog");$(".overlayDiv").html(t),token=t.newAjaxToken,$("[name='_token']").val(t.newAjaxToken)}))}))},initMessages:function(t=null){null!==t&&(ogame.messages.token=t),$(".js_tabs .tabs_btn_img").each((function(){$(this).attr("rel")&&$(this).attr("href",$(this).attr("rel"))})),ogame.messages.initTabs($(".js_tabs"));let e=ogame.messages.getCurrentMessageTab();$("#contentWrapper #buttonz div.js_tabs.tabs_wrap.ui-tabs").on("click","ul li.list_item",(function(){e=ogame.messages.getCurrentMessageTab()}));const i=(t,e=null,i=null)=>{t._token||(t._token=$("[name='_token']").val()),t.ajax||(t.ajax=1),window.location.href.indexOf("page=standalone")>-1&&(t.standalonePage=1),$.ajax({type:"POST",url:"?page=messages",dataType:"json",data:t,success:function(t){t.newAjaxToken&&(token=t.newAjaxToken,$("[name='_token']").val(t.newAjaxToken)),e&&e(t)},error:function(){null!==i&&i()}})};$("body").on("click",".msg_actions .icon_not_favorited",(function(t){var n=$(this).parents("li.msg").data("msg-id")||$(this).parents("div.detail_msg").data("msg-id");i({tabid:e,messageId:n,_token:token,action:101},(e=>{if(token=e.newAjaxToken,$("[name='_token']").val(e.newAjaxToken),1==e[n].result){let e;$(t.target).is("img")?($(t.target).attr("src",$(t.target).attr("src").replace("not_favorited","favorited")),$(t.target).parent().removeClass("icon_not_favorited").addClass("icon_favorited"),e=$(t.target).parent()):($(t.target).removeClass("icon_not_favorited").addClass("icon_favorited"),$(t.target).find("img").attr("src",$(t.target).find("img").attr("src").replace("not_favorited","favorited")),e=$(t.target)),changeTooltip($(e),loca.LOCA_MSG_DELETE_FAV);var i=$(".favoriteTabFreeSlotCount");i.html(parseInt(i.html())-1)}else"undefined"!==e[n].reason?fadeBox(e[n].reason,1):fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)}))})).on("click",".msg_actions .icon_favorited",(function(t){var n=$(this).parents("li.msg").data("msg-id")||$(this).parents("div.detail_msg").data("msg-id");i({tabid:e,messageId:n,_token:token,action:102},(e=>{if(token=e.newAjaxToken,$("[name='_token']").val(e.newAjaxToken),1==e[n].result){let e;$(t.target).is("img")?($(t.target).attr("src",$(t.target).attr("src").replace("favorited","not_favorited")),$(t.target).parent().removeClass("icon_favorited").addClass("icon_not_favorited"),e=$(t.target).parent()):($(t.target).removeClass("icon_favorited").addClass("icon_not_favorited"),$(t.target).find("img").attr("src",$(t.target).find("img").attr("src").replace("favorited","not_favorited")),e=$(t.target)),changeTooltip($(e),loca.LOCA_MSG_ADD_FAV);var i=$(".favoriteTabFreeSlotCount");i.html(parseInt(i.html())+1)}else"undefined"!==e[n].reason?fadeBox(e[n].reason,1):fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)}))})).on("click",".js_actionKill",(function(t){var e=$(this).parents("li.msg").data("msg-id");i({messageId:e,_token:token,action:103},(i=>{token=i.newAjaxToken,$("[name='_token']").val(i.newAjaxToken),1==i[e]?$(t.target).parents("li.msg").remove():fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)}))})).on("click",".js_actionKillAll",(function(t){i({tabid:ogame.messages.getCurrentMessageTab(),messageId:-1,_token:token,action:103},(t=>{token=t.newAjaxToken,$("[name='_token']").val(t.newAjaxToken),1==t.result?location.reload():fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)}))})).on("click",".js_actionKillDetail",(function(t){var e=$(".detail_msg").data("msg-id");i({messageId:e,_token:token,action:103},(t=>{token=t.newAjaxToken,$("[name='_token']").val(t.newAjaxToken),1==t[e]?location.reload():fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)}))})).on("click",".js_actionRevive",(function(t){var n=$(this).parents("li.msg").data("msg-id");void 0===n&&(n=$(this).parents("div.detail_msg").data("msg-id")),i({tabid:e,messageId:n,_token:token,action:104},(e=>{token=e.newAjaxToken,$("[name='_token']").val(e.newAjaxToken),1==e[n]?($(t.target).parents("li.msg").remove(),$(t.target).parents("div.ui-dialog").remove(),$("li.msg[data-msg-id="+n+"]").remove(),window.location.href.indexOf("page=standalone")>-1&&location.reload()):fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)}))})).on("click",".js_actionReviveAll",(function(t){i({tabid:ogame.messages.getCurrentMessageTab(),messageId:-1,_token:token,action:104},(t=>{token=t.newAjaxToken,$("[name='_token']").val(t.newAjaxToken),1==t.result?location.reload():fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)}))})).on("click",".js_actionDelete",(function(t){var n=$(this).parents("li.msg").data("msg-id");n||(n=$(this).parents("div.detail_msg").data("msg-id")),i({tabid:e,messageId:n,_token:token,action:105},(e=>{token=e.newAjaxToken,$("[name='_token']").val(e.newAjaxToken),1==e[n]?($(t.target).parents("li.msg").remove(),window.location.href.indexOf("page=standalone")>-1&&location.replace("index.php?page=ingame&component=overview")):fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)}))})).on("click",".js_actionDeleteAll",(function(t){$(this).parents("li.msg").data("msg-id");i({tabid:ogame.messages.getCurrentMessageTab(),messageId:-1,_token:token,action:105},(t=>{token=t.newAjaxToken,$("[name='_token']").val(t.newAjaxToken),1==t.result?location.reload():fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)}))})).on("click",".paginator",(function(t){var e=$(this).data("tab"),i=$(this).data("page"),n=$(this).closest('div[class^="ui-tabs-panel"]');let a=$("[name='_token']").val();$.ajax({type:"POST",url:"?page=messages",dataType:"html",data:{messageId:-1,tabid:e,action:107,pagination:i,ajax:1,_token:a,standalonePage:window.location.href.indexOf("page=standalone")>-1?1:0},success:function(t){t.newAjaxToken&&(token=t.newAjaxToken,$("[name='_token']").val(t.newAjaxToken)),n.html(t)},error:function(){}})})).on("click",".jumpToAllianceApplications",(function(t){location.href="index.php?page=ingame&component=alliance&tab=applications"})).on("click","a.js_actionCollect",(function(t){t.preventDefault();let e=$(t.currentTarget).attr("href");$.ajax({type:"POST",url:e,dataType:"json",data:{new_token:ogame.messages.marketToken||""},success:function(e){let i=e.status||"failure",n=e.statusMessage||"";if("success"===i&&(ogame.messages.marketToken=e.newToken,$(t.currentTarget).hide(),$(t.currentTarget).replaceWith(n),fadeBox(e.message||"",!1),getAjaxResourcebox()),"failure"===i){let t=e.errors[0]||void 0;t&&fadeBox(t.message,!0)}},error:function(t){}})}))},selectCurrentMessageTab:function(){var t=$(".subtabs .ui-state-active:visible");return t.length||(t=$(".js_tabs .ui-state-active:visible")),t},getCurrentMessageTab:function(){var t=$(".subtabs .ui-state-active:visible").attr("data-tabid");return t||(t=$(".js_tabs .ui-state-active:visible").attr("data-tabid")),t},getCurrentEarliestMessage:function(){return $(".ui-tabs-panel .tab_inner .msg:visible").last().attr("data-msg-id")},initCommentForm:function(){ogame.messages.initWriteNewMsgBox($("#newCommentForm")),$("#newCommentForm").on("click",".js_send_comment",(function(t){let e=$("[name='_token']").val();t.preventDefault();var i=$(this).closest("form"),n=i.find("input[name=messageId]").val();$.ajax({type:"POST",url:i.attr("action"),dataType:"json",data:{messageId:n,ajax:1,action:108,text:i.find("textarea[name=text]").val(),_token:e,standalonePage:window.location.href.indexOf("page=standalone")>-1?1:0},success:function(t){t.newAjaxToken&&(token=t.newAjaxToken,$("[name='_token']").val(t.newAjaxToken)),fadeBox(t.message,t.error),i.find("textarea[name=text]").val(""),i.parent().after('<li class="msg"><div class="msg_status"></div><div class="msg_head">'+t.commentheader+'</div><div class="msg_content">'+t.commentcontent+"</div></li>"),$("#scrollToComments").text(t.commentcount)},error:function(t){}})}))},initShareReportOverlay:function(){ogame.messages.initWriteNewMsgBox($("#newSharedReportForm")),$("#newSharedReportForm").on("click",".js_send_msg_share",(function(t){t.preventDefault();var e=$(this).closest("form"),i=e.find("input[name=messageId]").val();let n=$("[name='_token']").val();var a=e.find("li.select2-selection__choice"),s=[];a.each((function(){s.push($(this).attr("title"))})),$.ajax({type:"POST",url:e.attr("action"),dataType:"json",data:{messageId:i,empfaenger:s,ajax:1,action:106,text:e.find("textarea[name=text]").val(),_token:n,standalonePage:window.location.href.indexOf("page=standalone")>-1?1:0},success:function(t){t.newAjaxToken&&(token=t.newAjaxToken,$("[name='_token']").val(t.newAjaxToken)),fadeBox(t.message,t.error),e.closest('div[class^="overlayDiv"]').remove()},error:function(t){}})}))},initSubTabMessages:function(){$(".js_accordion").accordion({collapsible:!0,heightStyle:"content",active:!1}),ogame.messages.initWriteNewMsgBox($("#newMsgForm")),$("html").off(".subtabmessages"),$("#newMsgForm").on("click.subtabmessages",".js_send_msg",(function(t){t.preventDefault();var e=$(this).parents("form");let i=$("[name='_token']").val();var n={};$(".input_replacement").children().each((function(){void 0===n[$(this).data("recipient-cat")]&&(n[$(this).data("recipient-cat")]=[]),n[$(this).data("recipient-cat")].push($(this).data("recipient-id"))})),$.ajax({type:"POST",url:e.attr("action"),dataType:"json",data:{empfaenger:n,_token:i,text:e.find(".new_msg_textarea").val()},success:function(t){t.newAjaxToken&&(token=t.newAjaxToken,$("[name='_token']").val(t.newAjaxToken)),fadeBox(t.message,t.error),t.error||ogame.messages.sendSubtabMsg($(".new_msg_textarea").val(),n)},error:function(){}})}))},initTabCommunication:function(){ogame.messages.initTabs($(".js_subtabs_communication"))},initTabFleets:function(){ogame.messages.initTabs($(".js_subtabs_fleets"),ogame.messages.initTrash)},initTabMarket:function(){ogame.messages.initTabs($(".js_subtabs_market"),ogame.messages.initTrash)},initTabs:function(t,e){t.tabs({beforeLoad:function(){$(".ajax_load_shadow").show()},load:function(t,i){ogame.messages.doInitAction(i.tab.attr("id")),$(".ajax_load_shadow").hide(),"function"==typeof e&&e(i.tab)},create:function(t,e){ogame.messages.doInitAction(e.tab.attr("id"))}})},initTrash:function(t){t&&($(".js_active_tab").html(t.data("subtabname")),"subtabs-nfFleetTrash"===t.attr("id")||"subtabs-nfMarketTrash"===t.attr("id")?($(".trash_box").addClass("trash_open"),$(".in_trash").show(),$(".not_in_trash").hide()):($(".trash_box").removeClass("trash_open"),$(".in_trash").hide(),$(".not_in_trash").show()))},initWriteNewMsgBox:function(t){initBBCodeEditor(locaKeys,itemNames,!1,".new_msg_textarea",2e3),$("html").off(".writeNewMsgBox"),$("html").on("click.writeNewMsgBox",(function(t){$(".new_msg_label").hasClass("open")&&$(t.target).parents(".recipient_select_box").length<1&&($(".input_replacement").removeClass("focus"),$(".new_msg_label").removeClass("open"),$(".new_msg_label").siblings(".recipient_select_box").hide())})),t.on("click.writeNewMsgBox",".input_replacement",(function(t){t.stopPropagation(),ogame.messages.toggleRecipientSelectBox($(t.target).data("recipient-cat"))})).on("click.writeNewMsgBox",".new_msg_label",(function(t){t.stopPropagation(),ogame.messages.toggleRecipientSelectBox($(t.currentTarget).data("recipient-cat"))})).on("click.writeNewMsgBox",".recipient_select_box .ally_rank",(function(){ogame.messages.toggleRecipientSelection($(this))})).on("click.writeNewMsgBox",".remove_recipient",(function(){ogame.messages.removeRecipient($(this).closest(".recipient_txt").data("recipient-id"))}))},removeRecipient:function(t){$(".ally_rank").filter((function(){$(this).data("recipient-id")===t&&$(this).removeClass("selected")})),$(".recipient_txt").filter((function(){$(this).data("recipient-id")===t&&$(this).remove()}))},sendSubtabMsg:function(t,e){if(t)if(e){var i={};i.date=getFormatedDate(serverTime.getTime(),"[d].[m].[Y] <span>[H]:[i]:[s]</span>"),i.newClass="msg_new",i.title=e,i.senderName="100011",i.msgID="111",i.msgContent=t,i.commentsURL="",i.detailURL="",i.commentsCount=0;var n=array(i);ogame.messages.addMessage($("#subtabs-nfCommunicationMessages"),n)}else console.warn("sendSubtabMsg: msg had no recipients");else console.warn("sendSubtabMsg: msg was empty")},toggleRecipientSelectBox:function(t){$(".input_replacement").filter((function(){$(this).data("recipient-cat")!==t||$(this).hasClass("focus")||$(this).addClass("focus")})),$(".new_msg_label").filter((function(){var e=$(this);if(e.data("recipient-cat")===t)if(e.hasClass("open"))e.removeClass("open").siblings(".recipient_select_box").hide();else{var i=e.siblings(".recipient_select_box"),n=i.find(".scroll_box");$(".new_msg_label").removeClass("open").siblings(".recipient_select_box").hide(),e.addClass("open"),i.show(),n.hasClass("mCustomScrollbar")?n.mCustomScrollbar("update"):n.mCustomScrollbar()}}))},toggleRecipientSelection:function(t){var e=t.data("recipient-cat"),i=t.data("recipient-id");t.hasClass("always_selected")||(t.hasClass("complete_ally")?ogame.messages.toggleSelectAllRecipients(e):t.hasClass("selected")?ogame.messages.removeRecipient(i):(ogame.messages.createRecipient(i,e,t.html()),t.addClass("selected")))},toggleSelectAllRecipients:function(t){var e=$(".complete_ally").hasClass("selected"),i=e?"255":"1",n=e?"loca.founder":"loca.completeAlliance";$(".input_replacement").children().remove(),ogame.messages.createRecipient(i,t,n),$(".recipient_list").filter((function(){$(this).data("recipient-cat")===t&&$(this).find(".ally_rank").each((function(){$(this).hasClass("always_selected")||(e?$(this).removeClass("selected"):$(this).addClass("selected"))}))}))}},ogame.messages.combatreport={data:[{combatReportId:$(".detailReport").attr("data-combatreportid")}],loca:[{weapon:"",shield:"",cover:""}],getCombatValueByCombatMember:function(){var t=ogame.messages.combatreport,e=t.data.activeMember,i={armorPercentage:0,weaponPercentage:0,shieldPercentage:0,characterClassName:"-"},n=0;return $.each(t.data.combatArray,(function(a,s){t.check(!0,e,{values:{is:{0:"all"}}})?(i.armorPercentage+=s.armorPercentage,i.weaponPercentage+=s.weaponPercentage,i.shieldPercentage+=s.shieldPercentage,n++):s.ownerName==e&&(i.armorPercentage=s.armorPercentage,i.weaponPercentage=s.weaponPercentage,i.shieldPercentage=s.shieldPercentage,i.characterClassName=s.ownerCharacterClassName,n=1)})),i.armorPercentage=Math.round(i.armorPercentage/n),i.weaponPercentage=Math.round(i.weaponPercentage/n),i.shieldPercentage=Math.round(i.shieldPercentage/n),i},setCombatValue:function(){var t=ogame.messages.combatreport,e=t.getCombatValueByCombatMember();$("."+t.data.combatside+"CharacterClass").text(t.loca.characterClass+" "+e.characterClassName),$("."+t.data.combatside+"Weapon").text(t.loca.weapon+" "+e.weaponPercentage+"%"),$("."+t.data.combatside+"Shield").text(t.loca.shield+" "+e.shieldPercentage+"%"),$("."+t.data.combatside+"Cover").text(t.loca.cover+" "+e.armorPercentage+"%")},setCombatLoca:function(t,e,i,n){var a=ogame.messages.combatreport;a.loca.weapon=t,a.loca.shield=e,a.loca.cover=i,a.loca.characterClass=n},isActive:function(t,e){var i=ogame.messages.combatreport;for(var n in e)if("length"!=n&&i.check(!0,e[n][t]))return"on";return i.check(!0,e[t])?"on":"off"},setActiveFlag4Fleet:function(t,e){var i=ogame.messages.combatreport,n=i.getAllShipClasses(t);$.each(n,(function(t,n){var a=i.getShipIdByClass(n),s=i.isActive(a,e),o=i.getShipSelectors(a);if(i.changeShipState(s,o.ship),"off"==s){var r=o.shipCount,l=o.loss,c={ships:{},losses:{}};c.ships[r]=0,c.losses[l]="",i.setShipCount(c)}i.toggleShipShowState(o.ship)}))},search4Class:function(t,e){for(var i in t){if($("."+t[i]+e)[0])return t[i]+e}return!1},getShipSelectors:function(t){var e=ogame.messages.combatreport,i=e.search4Class(["military","civil","defense"],t);return{ship:"."+e.data.combatside+" ."+i,shipCount:"."+e.data.combatside+" ."+i+" .ecke",loss:"."+e.data.combatside+" ."+i+" .lost_ships"}},getShipIdByClass:function(t){var e=t.length;return t.substr(e-3)},changeShipState:function(t,e){$(e).hasClass("off")&&"off"!=t&&$(e).removeClass("off"),$(e).hasClass("on")&&"on"!=t&&$(e).removeClass("on"),$(e).hasClass(t)||$(e).addClass(t)},toggleShipShowState:function(t){$(t).hasClass("off")&&$(t).parent().hide(),$(t).hasClass("on")&&$(t).parent().show()},getShipsByMembers:function(t){var e=ogame.messages.combatreport,i=[];return e.check(!0,e.data.combatArray.shipDetails)?void 0!==i[e.data.combatArray.ownerName]?$.extend(i[e.data.combatArray.ownerName],e.data.combatArray.shipDetails):i[e.data.combatArray.ownerName]=e.data.combatArray.shipDetails:$.each(e.data.combatArray,(function(t,e){"object"==typeof e&&void 0!==e.shipDetails?void 0!==i[e.ownerName]?$.extend(i[e.ownerName],e.shipDetails):i[e.ownerName]=e.shipDetails:void 0===i[e.ownerName]&&(i[e.ownerName]={})})),"all"==t?i:i[t]},getShipsByMembersAndCoords:function(t,e,i){var n=ogame.messages.combatreport,a=[];return n.check(!0,n.data.combatArray.shipDetails)?void 0!==a[n.data.combatArray.ownerName]?$.extend(a[n.data.combatArray.ownerName],n.data.combatArray.shipDetails):a[n.data.combatArray.ownerName]=n.data.combatArray.shipDetails:$.each(n.data.combatArray,(function(n,s){0!==e?"object"==typeof s&&void 0!==s.shipDetails&&s.ownerCoordinates===e&&s.ownerName==t&&s.ownerPlanetType==i&&(void 0!==a[s.ownerName]?$.extend(a[s.ownerName],s.shipDetails):a[s.ownerName]=s.shipDetails):"object"==typeof s&&void 0!==s.shipDetails&&(void 0!==a[s.ownerName]?$.extend(a[s.ownerName],s.shipDetails):a[s.ownerName]=s.shipDetails)})),"all"==t?a:a[t]},getShipCountArray:function(t,e){var i=ogame.messages.combatreport,n=!i.check(!0,e,{types:{0:"isEmpty"}}),a={},s={};for(var o in t){var r=i.getShipSelectors(o);if(a[r.shipCount]=parseInt(t[o]),!n){var l=r.loss;i.check(!0,e[o])&&(s[l]=parseInt(e[o]))}}return{ships:a,losses:s}},setShipCount4All:function(t){var e=ogame.messages.combatreport,i=t.ships,n=e.check(!0,t.losses)?t.losses:{},a={};for(var s in i){var o=i[s],r=e.check(!0,n,{types:{0:"isEmpty"}})&&e.check(!0,n[s])?n[s]:{};a[s]=e.getShipCountArray(o,r)}var l={},c={};for(var d in a){var u=a[d].ships,h=a[d].losses;for(var p in u)e.check(!0,l[p])?l[p]=l[p]+u[p]:l[p]=u[p];for(var p in h)e.check(!0,c[p])?c[p]=c[p]+h[p]:c[p]=h[p]}var f={ships:l,losses:c};e.setShipCount(f)},setShipCountByActiveMember:function(t,e,i,n,a){n=n||0,a=a||1;var s=ogame.messages.combatreport,o={},r={};for(var l in e){var c=e[l].ownerName,d=e[l].ownerCoordinates,u=e[l].ownerPlanetType;if(c==i){for(var h in t.ships[l])0!==n?n==d&&a==u&&(o.hasOwnProperty(h)?o[h]=o[h]+t.ships[l][h]:o[h]=t.ships[l][h]):o.hasOwnProperty(h)?o[h]=o[h]+t.ships[l][h]:o[h]=t.ships[l][h];if(s.check(!0,t.losses))for(var h in t.losses[l])0!==n?n==d&&a==u&&(r.hasOwnProperty(h)?r[h]=r[h]+parseInt(t.losses[l][h]):r[h]=parseInt(t.losses[l][h])):r.hasOwnProperty(h)?r[h]=r[h]+parseInt(t.losses[l][h]):r[h]=parseInt(t.losses[l][h])}}if(s.check(!0,o,{types:{0:"isEmpty"}})){var p=s.getShipCountArray(o,r);s.setShipCount(p)}},setShipCount:function(t){var e=ogame.messages.combatreport.data.combatside,i=t.ships,n=t.losses;if($.isEmptyObject(i))$("."+e+" .ecke").text("0");else for(var a in i)$(a).text(i[a].toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."));if($.isEmptyObject(n))$("."+e+" .lost_ships").text("-");else for(var a in n)$(a).text("-"+n[a].toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."))},getAllShipClasses:function(t){var e=t.map((function(){return $(this).attr("class")})).get().join(),i=[];return $.each(e.split(","),(function(t,e){var n=e.split(" ");i.push(n[1])})),i},displayShipData:function(t,e,i,n,a,s){a=void 0!==a?a:0;var o=ogame.messages.combatreport;o.check(!0,t,{values:{isNot:{0:"all"}}})?o.setShipCountByActiveMember(i,n,t,a,s):o.setShipCount4All(o.data.combatRounds[e][o.data.combatRounds[e].length-1])},initCombatText:function(t){var e=ogame.messages.combatreport,i=t.combatRounds.length-1;$(".combat_round_list .round_id").find("a").removeClass("active"),$(".combat_round_list .round_id[data-round="+i+"]").find("a").addClass("active"),e.loadDataBySelectedRound(t.attackerJSON,t.defenderJSON,i)},setCombatText:function(t,e,i){var n=".statistic_attacker",a=".statistic_defender",s=".hits",o=".strength",r=".absorbed",l=0,c=0,d=0,u=0,h=0,p=0;if(ogame.messages.combatreport.check(!0,t,{length:i}))for(var f in t)l+=parseInt(t[f].statistic.hits),c+=parseInt(t[f].statistic.absorbedDamage),d+=parseInt(t[f].statistic.fullStrength),u+=parseInt(e[f].statistic.hits),h+=parseInt(e[f].statistic.absorbedDamage),p+=parseInt(e[f].statistic.fullStrength);else l=parseInt(t[i].statistic.hits),c=parseInt(t[i].statistic.absorbedDamage),d=parseInt(t[i].statistic.fullStrength),u=parseInt(e[i].statistic.hits),h=parseInt(e[i].statistic.absorbedDamage),p=parseInt(e[i].statistic.fullStrength);$(n+s).text(l.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")),$(n+r).text(c.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")),$(n+o).text(d.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")),$(a+s).text(u.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")),$(a+r).text(h.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")),$(a+o).text(p.toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."))},setCombatArray:function(t,e){var i=jQuery.extend(!0,{},t),n=ogame.messages.combatreport;n.data.combatside=e,n.data.memberSelection=!1,$("#"+n.data.combatside+"_select_combatreport").find(":selected").length>0&&(n.data.memberSelection=!0),n.data.memberSelection?n.data.activeMember=""+$("#"+n.data.combatside+"_select_combatreport").find(":selected").val():n.data.activeMember=""+$("#"+n.data.combatside+"_select_combatreport").data("memberName"),n.data.activeMember=n.data.activeMember.split("|",1)[0],n.data.combatArray=i.member,n.data.combatRounds=[],n.data.combatRounds[e]=i.combatRounds},setCombatside:function(t){ogame.messages.combatreport.data.combatside=t},check:function(t,e,i){var n=!1,a=0,s=0,o=0,r=0,l=!1;if(0!=(i=null!=i&&void 0!==i&&"object"==typeof i&&i)){var c=null!=i.values&&void 0!==i.values&&"object"==typeof i.values?i.values:{},d=null!=i.types&&void 0!==i.types&&"object"==typeof i.types?i.types:{},u=null!=i.length&&void 0!==i.length&&i.length;if(!jQuery.isEmptyObject(c))for(m in c){var h=c[m];if("is"==m&&!jQuery.isEmptyObject(h))for(var p in h)e!=h[p]&&(a+=1);if("isNot"==m&&!jQuery.isEmptyObject(h))for(var f in h)e==h[f]&&(a+=1)}if(!jQuery.isEmptyObject(d))for(var m in d.isEmpty&&jQuery.isEmptyObject(e)&&(s+=1),d)typeof e==d[m]&&(s+=1);if("object"==typeof e)for(var m in e)void 0!==e[m]&&(r+=1);else r=(e+"").length;!1!==u&&"number"==typeof u&&"number"==typeof r&&(r!=u&&(o+=1),l=!0)}void 0!==e&&null!=e||(s+=1);var g=a+s;return 0!=l&&(g+=o),0==g&&(n=!0),t?n:{success:n,allErrors:g,valueErrors:a,typeErrors:s,type:typeof e,length:r,lengthChecked:l,lengthError:o}},loadData:function(t,e){var i=ogame.messages.combatreport;i.setCombatArray(t,e),i.loadDataBySelectedCombatMember(t,e),i.setCombatValue()},loadDataBySelectedRound:function(t,e,i){var n=ogame.messages.combatreport,a=parseInt(i),s=$(".attacker .participant_select option:selected").val(),o=$(".defender .participant_select option:selected").val(),r=$(".attacker .participant_select option:selected").data("coords"),l=$(".defender .participant_select option:selected").data("coords"),c=[],d=[];if(void 0!==r?(ids=s.split("|")[1].split(":"),c.push(ids),s=s.split("|")[0]):"all"!=s&&void 0!==s?(r=0,$(".attacker .participant_select option").each((function(){s==$(this).val().split("|")[0]&&void 0!==$(this).val().split("|")[1]&&c.push($(this).val().split("|")[1].split(":"))}))):c=[],void 0!==l?(ids=o.split("|")[1].split(":"),d.push(ids),o=o.split("|")[0]):"all"!=o&&void 0!==o?(l=0,$(".defender .participant_select option").each((function(){o==$(this).val().split("|")[0]&&void 0!==$(this).val().split("|")[1]&&d.push($(this).val().split("|")[1].split(":"))}))):d=[],c.length>0)for(var u in t)if("combatRounds"==u)for(var h in t[u][a])if("ships"==h)for(var p in t[u][a][h]){-1==$.inArray(p,c[0])&&delete t[u][a][h][p]}if(d.length>0)for(var u in e)if("combatRounds"==u)for(var h in e[u][a])if("ships"==h)for(var p in e[u][a][h]){-1==$.inArray(p,d[0])&&delete e[u][a][h][p]}var f=t.combatRounds,m=e.combatRounds;n.check(!0,f,{length:i})&&(a-=1),a+="",n.setCombatside("attacker"),n.setShipCount4All(f[a]),n.setCombatside("defender"),n.setShipCount4All(m[a]),n.data.memberSelection,n.setCombatText(f,m,i)},resetDropDowns:function(){$("#attacker_select_combatreport").val("all").ogameDropDown("refresh"),$("#defender_select_combatreport").val("all").ogameDropDown("refresh")},loadDataBySelectedCombatMember:function(t,e,i,n){var a=jQuery.extend(!0,{},t);i=i||0,n=n||1;var s=ogame.messages.combatreport;s.setCombatArray(a,e);var o=$("."+s.data.combatside+" .buildingimg"),r=$("."+s.data.combatside+" .defenseimg");o=$.merge(o,r);var l=s.getShipsByMembersAndCoords(s.data.activeMember,i,n);s.setActiveFlag4Fleet(o,l),s.displayShipData(s.data.activeMember,s.data.combatside,a.combatRounds[a.combatRounds.length-1],a.member,i,n),s.setCombatValue()}};let reloadEventBoxTimer=null;function reloadEventbox(t){var e,i=typeof(e="string"==typeof t?$.parseJSON(t):t).eventText,n=parseInt(e.friendly)+parseInt(e.neutral)+parseInt(e.hostile);if(n>0){var a,s=$('<p class="event_list">');if("galaxy"===$("body").attr("id"))s.append('<span class="next_event">'+eventboxLoca.nextEvent+': <span class="countdown" id="tempcounter" name="countdown"></span></span>').append('<span class="next_event">'+eventboxLoca.nextEventText+': <span class="'+e.eventType+'">'+e.eventText+"</span></span>"),a=s;else{var o=1===n?eventboxLoca.mission:eventboxLoca.missions;a=$('<p class="event_list">'+n+" "+o+": </p>"),e.friendly&&a.append('<span class="undermark">'+e.friendly+" "+eventboxLoca.friendly+"</span>"),e.neutral&&(e.friendly&&a.append(", "),a.append('<span class="middlemark">'+e.neutral+" "+eventboxLoca.neutral+"</span>")),e.hostile&&((e.friendly||e.neutral)&&a.append(", "),a.append('<span class="overmark">'+e.hostile+" "+eventboxLoca.hostile+"</span>")),s.append('<span class="next_event">'+eventboxLoca.nextEvent+': <span class="countdown" id="tempcounter" name="countdown"></span></span>').append('<span class="next_event">'+eventboxLoca.nextEventText+': <span class="'+e.eventType+'">'+e.eventText+"</span></span>"),a.append(s)}$("#eventboxFilled p.event_list").remove(),$("#eventboxFilled").prepend(a)}"string"!==i&&"undefined"!==i||($("#eventboxLoading").hide(),n>0?($("#eventboxBlank").hide(),$("#eventboxFilled").show(),null!==reloadEventBoxTimer&&timerHandler.removeCallback(reloadEventBoxTimer.timer),reloadEventBoxTimer=new simpleCountdown(getElementByIdWithCache("tempcounter"),e.eventTime,(function(){setTimeout(getAjaxEventbox,3e3)}))):($("#eventboxBlank").show(),$("#eventboxFilled").hide()))}if(function(t){t(document).undelegate(".eventToggle","click").delegate(".eventToggle","click",(function(){return toggleEvents(),!1})),t(document).undelegate("#eventboxContent .toggleDetails","click").delegate("#eventboxContent .toggleDetails","click",(function(){return toggleDetails.call(this),!1})),t((function(){t("#eventboxContent").is(":visible")&&(toggleEvents.loaded=!0,t("#js_eventDetailsClosed").hide(),t("#js_eventDetailsOpen").show()),void 0!==window.isStandalonePage&&!1!==window.isStandalonePage||(getAjaxEventbox(),refreshFleetEvents(!0))}))}(jQuery),void 0===ogame)var ogame={};function scrollToTopOfDialog(t){$("html, body").stop().animate({scrollTop:Math.max(0,t.offset().top-300)},200)}function openOverlay(t,e){if(!$(".ui-dialog span.ui-dialog-title:contains('"+e.title+"')").length){void 0===openOverlay.index?openOverlay.index=0:openOverlay.index++;var i=openOverlay.index;if(void 0!==(e=e||{}).type&&"inline"==e.type||t.match(new RegExp("^("+ogameUrl+"|"+startpageUrl+")"))){if(void 0===e.height&&(e.height="auto"),void 0===e.width&&(e.width="auto"),void 0===e.position&&(isMobile&&!isMobileApp?e.position={my:"top",at:"top"}:e.position={my:"center",at:"center"}),e.closeText="",$(".overlayDiv").length&&!isMobile){var n=$(".overlayDiv:last").offset();e.position={my:"left top",at:"left+"+(n.left+10)+" top+"+(n.top+10)}}var a,s=e.type;if(delete e.type,"inline"!==s){var o=$(document.createElement("img")).attr("src","/img/icons/4161a64a933a5345d00cb9fdaa25c7.gif").attr("alt",LocalizationStrings.loading),r=$(document.createElement("div")).css("text-align","center").css("margin-top","20px").append(o),l=$(document.createElement("div")).addClass("overlayDiv").css("display","none").append(r).appendTo("body"),c=function(){l.find("select").ogameDropDown("destroy"),l.remove(),Tipped.hideAll()};switch(typeof e.close){case"function":break;case"string":var d=e.close.split(" ");e.close=function(){$.each(d,(function(t,e){"__default"==e?c():window[e]()}))};break;default:e.close=c}}else e.close||"inline"!==s||(e.close=function(){closeTradeResourcesOverlay&&"function"==typeof closeTradeResourcesOverlay&&"undefined"!=typeof traderObj&&closeTradeResourcesOverlay(!0),$($(".ui-dialog span.ui-dialog-title:contains('"+e.title+"')").parents(".ui-dialog")[0]).length>0&&$($(".ui-dialog span.ui-dialog-title:contains('"+e.title+"')").parents(".ui-dialog")[0]).remove(),$(".overlayDiv").removeClass("overlayDiv")});if("string"==typeof t){var u=$.deparam($.param.querystring(t));if(void 0!==u.page&&l.attr("data-page",u.page),!isMobile&&-1!=$.inArray(u.page,popupWindows)){var h=Math.max(0,Math.floor($(window).height()/2-e.popupHeight/2)),p=Math.max(0,Math.floor($(window).width()/2-e.popupWidth/2)),f=window.open(t+"&popup=1",u.page,"width="+e.popupWidth+",height="+e.popupHeight+",scrollbars=yes,resizable=yes,top="+h+",left="+p);return l.remove(),void f.focus()}}if(void 0!==e.class){var m=e.class.split(" ").join(".");if($(".overlayDiv."+m).length)return $.get(t,{},(function(t){$(".overlayDiv."+e.class).empty().append(t).dialog("moveToTop")})),l.remove(),l=$(".overlayDiv."+m),void 0!==u.page&&l.attr("data-page",u.page),void 0!==e.title&&l.dialog("option","title",e.title),scrollToTopOfDialog(l),!0;l.addClass(e.class)}if("inline"==s&&(l=$(t)),isNaN(e.dragStart)&&isNaN(e.dragStop))e.dragStart=function(){$("html").data("noclick",!0),l.dialog("option","width",l.width()).dialog("option","height",l.height()),a={bg:l.css("background"),image:l.css("background-image"),x:l.css("background-position-x"),y:l.css("background-position-y"),position:l.css("background-position")},l.find("select").ogameDropDown("hide"),l.children().hide();for(var t=l.find(".markItUpDropMenu[id]"),e=0;e<t.length;++e){var i=$("body>ul[rel="+t[e].id+"]"),n=void 0===i.attr("old_left")?-18:0,s=void 0===i.attr("old_left")?-6:0;i.attr("old_top",l.offset().top+n).attr("old_left",l.offset().left+s).hide()}l.css("background","#000000")},e.dragStop=function(){setTimeout((function(){$("html").data("noclick",!1)}),100),void 0===l.bg||0==l.bg.length?(l.css("background-image",a.image),void 0===a.position||0==a.position.length?l.css("background-position-x",a.x).css("background-position-y",a.y):l.css("background-position",a.position)):l.css("background",a.bg),l.children().show();for(var t=l.find(".markItUpDropMenu[id]"),i=0;i<t.length;++i){var n=$("body>ul[rel="+t[i].id+"]");n.css({top:parseInt(n.css("top"))-n.attr("old_top")+l.offset().top+"px",left:parseInt(n.css("left"))-n.attr("old_left")+l.offset().left+"px"}),1==$(t[i]).attr("data-opened")&&n.show()}l.dialog("option","width",e.width).dialog("option","height",e.height),y(l)};switch(isNaN(e.resizable)&&(e.resizable=!1),isMobile&&(e.draggable=!1),e.modal&&(e.open=function(){$(".ui-widget-overlay").css("height","").css("width","")}),s){case"iframe":var g=overlayWidth,v=overlayHeight;void 0!==e.iframeWidth&&(g=e.iframeWidth,delete e.iframeWidth),void 0!==e.iframeHeight&&(v=e.iframeHeight,delete e.iframeHeight),l.html("<iframe allowTransparency='true'frameborder='0' hspace='0' src='"+t+"' id='TB_iframeContent' name='TB_iframeContent"+Math.round(1e3*Math.random())+"' style='width:"+(g+25)+"px;height:"+(v+1)+"px;' ></iframe>").dialog(e).dialog("moveToTop"),y(l);break;case"inline":var b=$(t);b.parent();b.addClass("overlayDiv").dialog(e).dialog("moveToTop"),y(b);break;default:l.dialog(e).dialog("moveToTop"),$.get(t,{}).done((function(t){l.empty().append(t).dialog("option","position",l.dialog("option","position")),setTimeout((function(){l.dialog("option","position",l.dialog("option","position")),y(l)}),100),$(document).trigger("ajaxShowOverlay")})).fail((function(){}))}Tipped.hideAll(),$("select").ogameDropDown("hide"),isMobile||$(window).bind("resize.overlay"+i,(function(){l.is(":data(dialog)")?(l.dialog("option","position",l.dialog("option","position")),y(l)):$(window).unbind("resize.overlay"+i)}))}else window.open("redir.php?url="+encodeURIComponent(t),"_newtab")}function y(t){var e=t.parent(".ui-dialog");e.length&&e.css("top",Math.max(0,parseInt(e.css("top").replace(/px$/,"")))).css("left",Math.max(0,parseInt(e.css("left").replace(/px$/,""))))}}function isOverlayOpen(){return $(".overlayDiv").length>0}function initOverlays(){$(document).undelegate('a[href*="overlay=1"], button[data-target*="overlay=1"], a.overlay, button.overlay',"click").delegate('a[href*="overlay=1"], button[data-target*="overlay=1"], a.overlay, button.overlay',"click",(function(t){t.preventDefault();var e=$(this).attr("href")||$(this).attr("data-target");if(void 0!==$(this).data("overlay-token")&&(e+="&token="+$(this).data("overlay-token")),$(this).data("overlay-same")){var i=$(this).parents(".ui-dialog"),n=i.find(".overlayDiv");if($(this).data("overlay-same")&&n.length>0)return $.get(e,{},(function(t){removeTooltip(n.find(getTooltipSelector())),n.empty().append(t).dialog("moveToTop"),n.dialog("option","position",n.dialog("option","position")),i.hide(),i.show()})),!1}var a={zIndex:4e3};return $(this).data("overlay-title")?a.title=$(this).data("overlay-title"):void 0!==$(this).attr("title")&&$(this).attr("title").length?a.title=$(this).attr("title"):$(this).data("tipped_restore_title")&&(a.title=$(this).data("tipped_restore_title").replace(/^.+\|/,"")),$(this).data("overlay-class")&&(a.class=$(this).data("overlay-class")),$(this).data("overlay-width")&&(a.width=$(this).data("overlay-width")),$(this).data("overlay-height")&&(a.height=$(this).data("overlay-height")),$(this).data("overlay-popup-width")&&(a.popupWidth=$(this).data("overlay-popup-width")),$(this).data("overlay-popup-height")&&(a.popupHeight=$(this).data("overlay-popup-height")),$(this).data("overlay-modal")&&(a.modal=$(this).data("overlay-modal"),a.resizable=!1,a.draggable=!1),$(this).data("overlay-iframe")?(a.type="iframe",$(this).data("iframe-width")&&(a.iframeWidth=$(this).data("iframe-width")),$(this).data("iframe-height")&&(a.iframeHeight=$(this).data("iframe-height"))):$(this).data("overlay-inline")&&(a.type="inline",e=$(this).data("overlay-inline")),$(this).data("overlay-close")&&(a.close=$(this).data("overlay-close")),openOverlay(e,a),!1}))}function updateOverlayToken(t,e){$("[data-overlay-token-id="+t+"]").data("overlay-token",e),token=e}function initOverview(){$(".cancelMove").click((function(){var t=$(this);window.location;errorBoxDecision(planetMoveLoca.askTitle,planetMoveLoca.askCancel,planetMoveLoca.yes,planetMoveLoca.no,(function(){$.ajax({method:"get",url:t.attr("rel"),dataType:"json",cache:!1,success:function(t){t.error.length>0?fadeBox(t.error,!0):location.href=getRedirectLink()},error:function(){fadeBox(planetMoveLoca.error,!0)}})}))})),$(document).undelegate("#planetMaintenanceDelete","submit").delegate("#planetMaintenanceDelete","submit",(function(t){t.preventDefault(),ajaxFormSubmit("planetMaintenanceDelete",$(this).attr("action"),planetGivenup)})).undelegate("#abandonplanet #block","click").delegate("#abandonplanet #block","click",(function(t){if(t.preventDefault(),hasAPassword)show_hide_menus("#validate"),show_hide_menus("#giveUpNotification");else{var e=3==$("#giveupHeadline").attr("rel")?loca.moonGiveupQuestion:loca.planetGiveupQuestion;e=e.replace("%planetName%",$("#giveupName").text()).replace("%planetCoordinates%",$("#giveupCoordinates").text()),errorBoxDecision($("#giveupHeadline").text(),e,LocalizationStrings.yes,LocalizationStrings.no,(function(){$("#planetMaintenanceDelete").submit()}))}})).undelegate(".openPlanetRenameGiveupBox","click").delegate(".openPlanetRenameGiveupBox","click",(function(t){t.stopPropagation(),openPlanetRenameGiveupBox()}))}function clearField(){currentValue=$("#planetName").val(),defaultName==currentValue&&clearInput("#planetName")}function fillField(){currentValue=$("#planetName").val(),""==currentValue&&$("#planetName").val(defaultName)}function openBuddyOverlay(t,e){openOverlay(t,{class:"buddies",title:e})}function planetGivenup(t){errorBoxAsArray(t.errorbox),"string"==typeof t.newAjaxToken&&$("#planetMaintenanceDelete input[name='_token']").val(t.newAjaxToken),void 0!==t.password_checked&&t.password_checked&&$("#planetMaintenanceDelete").attr("action",t.intent)}function initPreferences(){$(".category").click((function(){document.prefs.reset()})),$(".copy2PtrConainer a").on("click",this.onClickExecutePtrCopy.bind(this)),$("#db_character").on("input",(function(){$("#db_character").val()?$("#db_character_password").length||($("#confirmPasswordWrapper").show(),$("#confirmPasswordContainer").append('\n                        <input class="textInput w200"\n                               id="db_character_password"\n                               type="password"\n                               value=""\n                               size="30"\n                               name="db_character_password"\n                               autocomplete="new-password"\n                        />\n                    ')):($("#confirmPasswordWrapper").hide(),$("#db_character_password").remove())})),$("div.wrap > div.group").hide(),$("div.wrap > div.group:first,div.wrap:eq(1) > div.group:eq(0),div.wrap:eq(2) > div.group:eq(0),div.wrap:eq(3) > div.group:eq(0)").show(),$("div.wrap > div.bar").click((function(){$(this).next("div.group:hidden").slideDown("fast",(function(){Tipped.show($(":input:visible"))})).siblings("div.group:visible").slideUp("fast",(function(){Tipped.hide($(":input:not(:visible)"))})),$(".formError").validationEngine("closePrompt")})),$(".content .bar").hover((function(){$(this).addClass("bar-hover")}),(function(){$(this).removeClass("bar-hover")})),$("#newpass1").bind("keyup",(function(){var t=$(this).val(),e=t.length,i=t.match(/[^A-Za-z\d]/),n=t.match(/\d/),a=t.match(/[a-z]/)&&t.match(/[A-Z]/),s=0,o={length:!1,"mixed-case":!1,"special-chars":!1,numbers:!1};for(var r in e>=passwordMinLength&&e<=passwordMaxLength&&(o.length=!0,s++),a&&(o["mixed-case"]=!0,s++),n&&(o.numbers=!0,s++),i&&(o["special-chars"]=!0,s++),o){var l=o[r];$("#password-meter-status-"+r).find("img.status-checked").css("visibility",l?"visible":"hidden")}var c=Math.floor(s/4*2),d=new Array("low","medium","high");for(var u in d)u!=c?$("#password-meter-rating-"+d[u]).removeClass("arrow"):$("#password-meter-rating-"+d[u]).addClass("arrow")})),$(".contentzs").tabs({beforeActivate:function(t,e){$("input#selectedTab").val($(e.tab).parent().prevAll().length)},activate:function(){Tipped.hide($("input:not(:visible)")),Tipped.show($("input:visible"))},active:selectedTab}),$("#sortSetting").unbind("change").bind("change",(function(){var t="settings_order";if($(this).val()==customSorting){var e=$("#sortOrder");e.attr("disabled","disabled").attr("name",""),$("#sortOrderHidden").attr("name",t).val(e.val()),$("#sortOrder").next(".dropdown").addClass("disabled")}else{$("#sortOrder").next(".dropdown").removeClass("disabled");var i=$("#sortOrderHidden");i.attr("name",""),$("#sortOrder").removeClass("disabled").attr("name",t).removeAttr("disabled").val(i.val())}})).trigger("change"),moveInProgress&&$("form#prefs").on("submit",(function(t){var e=$(this);if(e.find("input#urlaubs_modus.notOnVacation:checked").length)return errorBoxDecision(LocalizationStrings.attention,preferenceLoca.planetMoveQuestion,LocalizationStrings.yes,LocalizationStrings.no,(function(){e.off("submit").submit()})),t.preventDefault(),!1})),hasAPassword&&$("#prefs").bind("submit",(function(){var t=$(this),e=$("#db_character",t);if(!t.data("asking")&&null!=e.val()&&e.val().length)return t.data("asking",!0),errorBoxDecision(preferenceLoca.changeNameTitle,preferenceLoca.changeNameQuestion.replace("%newName%",$("#db_character",t).val()),LocalizationStrings.yes,LocalizationStrings.no,(function(){t.submit(),t.data("asking",!1)}),(function(){t.data("asking",!1)})),!1})),$("#prefs").on("submit",(function(t){var e=$(this);if(e.find("input#urlaubs_modus.notOnVacation:checked").length&&!moveInProgress&&!e.data("vacation_confirming"))return e.data("vacation_confirming",!0),errorBoxDecision(LocalizationStrings.attention,preferenceLoca.vacationModeQuestion,LocalizationStrings.yes,LocalizationStrings.no,(function(){e.data("vacation_confirming",!1),e.off("submit").submit()}),(function(){e.find("input#urlaubs_modus").prop("checked",!1),e.data("vacation_confirming",!1)})),t.preventDefault(),!1})),$("#vacation-mode-button").on("click",(function(t){t.preventDefault();var e=$("#urlaubs_modus");e.is(":checked")?e.prop("checked",!1):e.prop("checked",!0),$("#prefs").submit()})),tabsDisabled&&($(".contentzs").tabs("option","disabled",[1,2]),$("#tabGeneral, #tabRepresentation").attr("title",preferenceLoca.tabDisabled).attr("class","tooltip")),$("div.wrap:visible > div.bar:eq("+openGroup+")").click()}function onClickExecutePtrCopy(t){t.stopPropagation(),t.preventDefault(),errorBoxDecision(LocalizationStrings.question,preferenceLoca.copyToPtrQuestion,LocalizationStrings.yes,LocalizationStrings.no,(function(){$.post($(".copy2PtrConainer a").attr("href"),{_token:token},(t=>{let e=JSON.parse(t);token=e.newAjaxToken,"success"===e.status&&(console.log(e.content),$(".copy2PtrConainer .fieldwrapper").replaceWith(e.content))}))}))}function pqChangeTarget(t){window.location=$(t).data("targetUrl")}function switchProductionTab(t){$("#productionqueuecomponent .spaceObjectTab").addClass("inactive"),$(`#productionqueuecomponent .spaceObjectTab.${t}`).removeClass("inactive"),$(`#productionqueuecomponent .${"planet"===t?"moonProduction":"planetProduction"}`).hide(),$(`#productionqueuecomponent .${t}Production`).show()}function display_info(t){""!=document.getElementById("infoInput").innerHTML&&document.getElementById("infoInput").innerHTML==get_displayText(t)||(document.getElementById("infoInput").innerHTML=get_displayText(t))}function display_error(t){""!=document.getElementById("errorInput").innerHTML&&document.getElementById("errorInput").innerHTML==get_errorText(t)||(document.getElementById("errorInput").innerHTML=get_errorText(t),document.getElementById("error").style.display="block")}function hide_error(t){document.getElementById("errorInput").innerHTML="",document.getElementById("error").style.display="none"}function checkUsername(){var t=document.forms.new.elements.username.value;t.length<3||t.length>=20?display_error("username"):hide_error()}function checkEmail(){var t=document.forms.new.elements.email.value;validate=t.match(/[a-zA-Z0-9]+@+[a-zA-Z0-9]+[.]+[a-zA-Z0-9]{2,4}/),t.length<3||t.length>=64||!validate?display_error("email"):hide_error()}ogame.Notify=function(t,e,i){if(this.canNotify=!1,this.title=t||"OGame",this.options=i||{},this.options.body=e||"",!("Notification"in window))return!1;"granted"===Notification.permission?this.canNotify=!0:"denied"!==Notification.permission&&Notification.requestPermission((function(t){"granted"===t&&(this.canNotify=!0)}))},ogame.Notify.prototype.setImage=function(t){this.options.icon=t},ogame.Notify.prototype.setTag=function(t){this.options.tag=t},ogame.Notify.prototype.show=function(){this.canNotify&&(this.notification=new Notification(this.title,this.options),setTimeout(this.notification.close.bind(this.notification),5e3))},Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var n=arguments[1],a=0;a<i;){var s=e[a];if(t.call(n,s,a,e))return s;a++}},configurable:!0,writable:!0}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var n=arguments[1],a=0;a<i;){var s=e[a];if(t.call(n,s,a,e))return a;a++}return-1},configurable:!0,writable:!0});var TECHID_REPAIR_DOCK=36,burnUpCountDownForStationScreen={},repairTimeDownForStationScreen={};function displayBurnUpEnquiry(){var t=$("input.burnUpButton");errorBoxDecision(t.data("loca_box_text"),t.data("loca_decision_text"),t.data("loca_yes"),t.data("loca_no"),(function(){$.ajax({url:t.data("url"),success:function(t){var e=jQuery.parseJSON(t);e.success?(fadeBox(e.reason,!1,(function(){})),redirectSpaceDock()):fadeBox(e.reason,!0,(function(){}))}})}),(function(){}))}function startWreckFieldRepairs(){var t=$("input.startRepairsButton");$.ajax({url:t.data("url"),success:function(t){var e=jQuery.parseJSON(t);e.success?(fadeBox(e.reason,!1,(function(){})),redirectSpaceDock()):fadeBox(e.reason,!0,(function(){}))}})}function reCommissionShips(){var t=$("input.reCommissionButton");$.ajax({url:t.data("url"),success:function(t){var e=jQuery.parseJSON(t);e.success?(fadeBox(e.reason,!1,(function(){})),redirectSpaceDock()):fadeBox(e.reason,!0,(function(){}))}})}function registerBurnUpCountDown(t){var e=$(t),i=$(t).data("duration");i>0&&(burnUpCountDownForStationScreen[t]||(burnUpCountDownForStationScreen[t]=new simpleCountdown(e,i,(function(){location.reload()}))))}function registerRepairTimeCountDown(t){var e=$(t),i=$(t).data("duration");i>0&&(repairTimeDownForStationScreen[t]||(repairTimeDownForStationScreen[t]=new simpleCountdown(e,i,(function(){location.reload()}))))}function initResourceTrader(){$(".big_tabs").tabs({activate:hideTipsOnTabChange}),$(".resource_link").on("click",onSelectResource),$(".btn_calltrader").on("click",callTrader)}function onSelectResource(t){var e=$(t.currentTarget);if(!e.hasClass("active")){$(".resource_link").removeClass("active"),e.addClass("active"),$(".btn_calltrader").attr("disabled",!1).data("offerId",e.data("resourceId"));var i=$(".getNewTraderDiv");(i.hasClass("hidden")&&!e.hasClass("oldTraderActive")||!i.hasClass("hidden")&&e.hasClass("oldTraderActive"))&&i.parent().children().toggleClass("hidden")}}function showTradeNowButton(){$("#callTrader").hasClass("traderActive")?$("#callTrader").show():$("#callTrader").hide()}function calcCosts(t,e){return Math.ceil(e*factor[offer_id]/factor[t])}function calcInputFromCosts(t,e){return Math.max(Math.floor(e/factor[offer_id]*factor[t]),0)}function setValue(t,e){offer_id==t?$("#"+t+"_value_label").html(number_format(e,0,loca.decimalPoint,loca.thousandsSeparator)):formatNumber("#"+t+"_value",e)}function checkValue(t){setValue(t,Math.min(getValue($("#"+t+"_value").val()),Math.round(freeStorage[t]))),free_id=6-t-offer_id,offer_costs=calcCosts(free_id,getValue($("#"+free_id+"_value").val())),costs=calcCosts(t,getValue($("#"+t+"_value").val())),freeOfferCosts=Math.round(offer_amount-offer_costs),costs>freeOfferCosts&&(setValue(t,calcInputFromCosts(t,freeOfferCosts)),costs=calcCosts(t,getValue($("#"+t+"_value").val()))),offer_costs+=costs,setValue(offer_id,offer_costs),document.getElementById(t+"_storage").innerHTML=number_format(freeStorage[t]-getValue($("#"+t+"_value").val()),0,loca.decimalPoint,loca.thousandsSeparator)}function setMaxValue(t){setValue(t,freeStorage[t]),checkValue(t)}function callTrader(t){if("disabled"!=$(t.currentTarget).attr("disabled")){var e=$(t.currentTarget).data("offerId"),i=$(t.currentTarget).data("askOverwrite");void 0===i&&(i=!0),darkMatter<traderCosts?errorBoxDecision(LocalizationStrings.error,loca.errorNotEnoughDM,LocalizationStrings.yes,LocalizationStrings.no,redirectBuyPremium):i&&$("#callTrader").is(":visible")?errorBoxDecision(loca.traderResourceNewQuestionHeadline,loca.traderResourceNewQuestion,LocalizationStrings.yes,LocalizationStrings.no,n):n()}function n(){$(".call_trader_box .getNewTraderDiv").hasClass("hidden")||$(".call_trader_box").children().toggleClass("hidden"),$(".resource_list .resource_link").removeClass("oldTraderActive").filter((function(t){return $(this).data("resourceId")==e})).addClass("oldTraderActive"),$.post(traderCallLink,{offer_id:e,_token:token},(function(t){if(t=$.parseJSON(t),token=t.newAjaxToken,"1"==t.status){$("#callTrader").show().addClass("traderActive"),traderObj.reloadResources(),$("#callTrader").addClass("traderActive").show(),openOverlay(traderOverlayLink,{class:"traderlayer"});var i=$("#activeTrader"),n="metal",a=loca.traderResourceTitleMetal;switch(e){case 2:n="crystal",a=loca.traderResourceTitleCrystal;break;case 3:n="deut",a=loca.traderResourceTitleDeuterium}i.find(".left_content #material").attr("class",n),i.find("p.stimulus").html(a),i.show(),$("#boxHeader, #boxFooter").show()}else errorBoxAsArray(t.errorbox)}))}}function tradeDone(t){t=$.parseJSON(t),token=t.token,!0===t.status&&closeTradeResourcesOverlay(),errorBoxAsArray(t.errorbox)}function closeTradeResourcesOverlay(t){$(".overlayDiv.traderlayer").remove(),traderObj.reloadResources(),t||($(".call_trader_box").children().toggleClass("hidden"),$("#callTrader").removeClass("traderActive").hide(),$(".btn_calltrader").attr("disabled",!0),$(".resource_link").removeClass("oldTraderActive active"),$("#activeTrader").hide())}function closeSearch(){void 0!==currentPage&&("fleet1"==currentPage||"fleet2"==currentPage?$("a#continue").focus():"fleet3"==currentPage&&$("a#start").focus())}function GFSlider(t){var e=this;e.duration=500,e.zIndex=10,e.intervalTime=30,e.lastTid=0,e.inAction=!1,e.isOpen=!1,e.lastObj=!1,e.currHeight=t.offsetHeight,e.opacity=1,e.header=document.getElementById("header_text"),e.ressButton=document.getElementById("resources_button"),e.areaMap=document.getElementById("transImg"),this.slideIn=function(t,i,n){e.inAction||(e.slideInObj=t,e.lastTid!=i||n?(t.opacity=1,e.lastTid=i,$("#detail").html('<div id="techDetailLoading"></div>'),e.isOpen?loadDetails(e.lastTid):(e.ressButton&&(e.ressButton.style.display="none"),t.style.height="1px",t.style.display="block",t.style.overflow="hidden",e.inAction=!0,e.startTime=(new Date).getTime(),e.slideInStep(),e.isOpen=!0)):(e.header.style.display="block",e.opacity=0,e.lastTid=0,e.inAction=!0,e.isOpen=!1,e.startTime=(new Date).getTime(),e.slideOutObj=e.slideInObj,e.slideOutStep()))},this.slideInStep=function(){t=e.slideInObj;var i=(new Date).getTime(),n=parseInt(e.currHeight*((i-e.startTime)/e.duration));n<e.currHeight?(t.style.height=n+"px",t.style.marginTop=e.currHeight-1-n+"px",window.setTimeout(e.slideInStep,e.intervalTime),e.opacity=Math.max(e.opacity-.1,0),e.header.style.opacity=e.opacity,e.header.style.filter="Alpha(opacity=50)"):(t.style.height=e.currHeight+"px",t.style.marginTop="0px",e.inAction=!1,e.header.style.display="none",loadDetails(e.lastTid),e.lastObj&&t!=e.lastObj&&e.hideLast(),e.lastObj=t)},this.slideOutStep=function(){t=e.slideInObj;var i=(new Date).getTime();height=parseInt(e.currHeight*((i-e.startTime)/e.duration)),height<e.currHeight?(t.style.height=e.currHeight-1-height+"px",t.style.marginTop=height+"px",window.setTimeout(e.slideOutStep,e.intervalTime),e.opacity=Math.max(e.opacity+.1,0),e.header.style.opacity=e.opacity):(t.style.height=e.currHeight+"px",t.style.marginTop="0px",e.opacity=1,e.header.style.opacity=e.opacity,e.ressButton&&(e.ressButton.style.display="block"),t.style.display="none",e.inAction=!1,e.hideLast())},this.hideLast=function(){e.lastObj&&($(".slideIn").removeClass("active"),e.lastObj.style.display="none",e.inAction=!1),$(document).trigger("ajaxHideElement",e.lastTid)},this.hide=function(t){$(".slideIn").removeClass("active"),e.slideOutObj=t,e.opacity=1,e.header.style.opacity=e.opacity,e.header.style.display="block",e.ressButton&&(e.ressButton.style.display="block"),e.areaMap&&(e.areaMap.style.display="block"),e.slideOutObj.style.display="none",e.inAction=!1,e.lastTid=0,e.isOpen=!1}}function supplyFleet(t){(t=$.parseJSON(t)).status&&(getAjaxResourcebox(),supplyTimes[t.id]=t.time,new simpleCountdown($("#holdingTime-"+t.id),t.time)),errorBoxAsArray(t.errorbox)}function updateSupplyDetails(t,e,i){$("#shipCount").html(gfNumberGetHumanReadable(t)),$("#deutCosts").html(gfNumberGetHumanReadable(e)),$("span.countdown").hide(),$("#holdingTime-"+i).show()}function initAllianceDepot(){for(var t in $(".overlayDiv #allydepotlayer select").ogameDropDown(),$(".holdingTime:first-child").show(),supplyTimes)new simpleCountdown($("#holdingTime-"+t),supplyTimes[t]);$("#supplyTimeInput").focus((function(){clearInput(this)})).keyup((function(){var t=getValue($("#resources_deuterium").text()),e=getValue($("#deutCosts").text());checkIntInput(this,1,Math.floor(t/e))}))}$(document).on("click","div.burnUpButton",displayBurnUpEnquiry),$(document).on("click","div.startRepairsButton",startWreckFieldRepairs),$(document).on("click","div.reCommissionButton",reCommissionShips),$(document).on("ajaxShowElement",(function(t,e){e==TECHID_REPAIR_DOCK&&(registerBurnUpCountDown("#burnUpCountDownForStationScreen"),registerRepairTimeCountDown("#repairTimeCountDownForStationScreen"))})),$(document).on("ajaxShowOverlay",(function(t){registerBurnUpCountDown("#burnUpCountDownForRepairOverlay"),registerRepairTimeCountDown("#repairTimeCountDownForRepairOverlay")})),inventoryObj={currentPage:null,currentItems:null,currentItem:null,currentCategory:null,activatingItem:!1,initalizeSlider:function(t,e,i,n,a,s,o,r,l){if((inventoryObj.currentItems!=t||void 0!==s)&&0!=s){inventoryObj.currentItems=t,a=a||"slideIn",o=o||"tooltipHTML js_hideTipOnMobile",void 0===r&&(r=!0),void 0===l&&(l=!0),$("#"+e+"Box").remove(".anythingSlider");var c=[],d=0;for(var u in t){if(void 0===(w=t[u]).hide||!w.hide){if("shop"==inventoryObj.currentPage||"inventory"==inventoryObj.currentPage){var h=d%inventoryObj.itemsPerSlide;c[d+h%3*2-2*Math.floor(h/3)]=w}else c[d]=w;d++}}for(var p=0,f=0,m=$('<ul id="'+e+'" />'),g=c.length;f<g;f++)if(void 0!==c[f]){var v,b,y,_,x,w=c[f];if(f%inventoryObj.itemsPerSlide==0){var C=$('<li class="slide_'+p+'" />').appendTo(m);p++}"shop"==inventoryObj.currentPage?(v=getNumberFormatShort(w.costs,null)+" "+loca.currency[w.currency],b="price"):(v=getNumberFormatShort(w.amount),b="amount"),_=r?w.imageLarge+"-75x.png":w.imageLarge+"-100x.png",x=w.canBeActivated||w.canBeBoughtAndActivated?"enabled":"disabled",y=w.isReduced?'<div class="sale_badge '+x+'"></div>':"";var k=null!=w.timeLeft?" js_is_active ":"",S="",T=w.title;-1!=e.indexOf("js_activeItemSlider")&&(T="",S=null!=w.timeLeft?'<span class="js_duration undermark" data-total-duration="'+w.totalTime+'">'+w.timeLeft+"</span>":"");var I="";null!=w.timeLeft&&-1!=e.indexOf("js_activeItemSlider")&&(I='<div class="pusher"></div>');var D="";-1!=$.inArray(birthdayCategory,w.category)&&(D='<div class="event_active_hint"></div>'),C.append('<div class="item_img r_'+w.rarity+'" style="background-image: url(/cdn/img/item-images/'+_+');"><div class="item_img_box">'+D+'<div class="activation '+x+k+'"></div><a href="javascript:void(0);" tabindex="1" title="'+T+'" class="detail_button '+o+" "+a+'" ref="'+w.ref+'">'+y+'<span class="ecke"><span class="level '+b+'">'+v+"</span></span></a></div>"+S+I+"</div>")}else C.append('<div class="item_img"><div class="empty border5px"></div></div>');if($("#"+e+"Box").prepend(m),f%inventoryObj.itemsPerSlide!=0)for(var A=f%inventoryObj.itemsPerSlide;A<inventoryObj.itemsPerSlide;A++)$("#"+e+" li:last").append('<div class="item_img"><div class="empty border5px"></div></div>');return mySlider=$("#"+e).anythingSlider({startStopped:!0,buildStartStop:!1,expand:!0,resizeContents:!1,theme:"default",infiniteSlides:!1,autoPlay:!1,easing:"swing",resizeContents:!0,stopAtEnd:!0,playRtl:isRTLEnabled,hashTags:!0,buildNavigation:l,onInitialized:function(t,e){if(isMobile){var i=0,n=0,a="ontouchend"in document,s=a?"touchstart":"mousedown",o=a?"touchmove":"mousemove",r=a?"touchend":"mouseup";e.$window.bind(s,(function(t){n=(new Date).getTime(),i=t.originalEvent.touches?t.originalEvent.touches[0].pageX:t.pageX})).bind(r,(function(t){n=0,i=0})).bind(o,(function(t){var a=t.originalEvent.touches?t.originalEvent.touches[0].pageX:t.pageX,s=0===i?0:Math.abs(a-i),o=(new Date).getTime();0!==n&&o-n<1e3&&s>50&&(a<i&&e.goForward(),a>i&&e.goBack(),n=0,i=0)}))}}})}},initShop:function(){var t=this;$(window).unbind(".shop"),$(document).undelegate(".slideIn","click.shop").delegate(".slideIn","click.shop",(function(){t.currentItem==$(this).attr("ref")?(t.currentItem=null,$.bbq.pushState({item:""})):(t.currentItem=$(this).attr("ref"),$.bbq.pushState({item:$(this).attr("ref")}))})),$("button.to_shop").bind("click.shop",(function(){$.bbq.pushState({page:"shop"})})),$("button.to_inventory").bind("click.shop",(function(){$.bbq.pushState({page:"inventory"})})),$("button.buyResourcesLink").bind("click",(function(){reload_page($(this).data("link"))})),$(".to_shop, .to_inventory").hover((function(){$(this).addClass("hover")}),(function(){$(this).removeClass("hover")})),$(".categoryFilter li a").bind("click.shop",(function(){$.bbq.pushState({category:$(this).attr("rel")})})),$(window).unbind("hashchange.shop").bind("hashchange.shop",(function(e){t.onHashChange($.deparam.fragment(e.fragment))})),t.onHashChange($.deparam.fragment()),inventoryObj.refreshResources()},onHashChange:function(t){if(void 0!==t.page){var e=this.currentPage!=t.page;if(e&&("inventory"==t.page?(this.openInventory(),$(".planetlink, .moonlink").fragment({page:t.inventory})):(this.openShop(),$(".planetlink, .moonlink").fragment({page:t.shop})),this.updateCategoryAmount()),void 0!==t.category){if((t.category!=this.currentCategory||e)&&this.changeCategory(t.category),void 0===t.item||""==t.item&&null!=this.currentItem)$("#itemDetails a.close_details").click(),$(".planetlink, .moonlink").fragment({item:""});else if(this.currentItem!=t.item){var i=$(".slideIn[ref='"+t.item+"']");i.length?i.click():gfSlider.slideIn(getElementByIdWithCache("detail"),t.item),$(".planetlink, .moonlink").fragment({item:t.item})}}else $.bbq.pushState({category:$(".categoryFilter a:first").attr("rel")})}else{var n={page:"shop",category:$(".categoryFilter a:first").attr("rel")};if(void 0!==t.item&&""!=t.item){var a=inventoryObj.items_shop[t.item];a.category.length>0&&(n.category=a.category[a.category.length-1])}$.bbq.pushState(n)}},initShopDetails:function(){var t=this,e=$.deparam.querystring().page;$(document).undelegate("#itemDetails .close_details","click").delegate("#itemDetails .close_details","click",(function(){gfSlider.hide(getElementByIdWithCache("itemDetails"))})).undelegate("#itemDetails a.item.build-it","click").delegate("#itemDetails a.item.build-it","click",(function(){return $.ajax({url:$(this).attr("rel"),data:{_token:token},type:"POST",dataType:"json",error:function(){fadeBox(translation.buyError,!0)},success:function(t){token=t.newAjaxToken,t.error||"failure"===t.status?(t.message?fadeBox(t.message,!0):fadeBox(t.errors[0].message,!0),$("#itemDetails a.item").removeClass("build-it").addClass("build-it_disabled")):(fadeBox(t.message,!1),inventoryObj.refreshResources(),inventoryObj.refreshItemData(t.item))}}),!1})).undelegate("#itemDetails a.item.build-it_disabled.dm","click").delegate("#itemDetails a.item.build-it_disabled.dm","click",(function(){errorBoxDecision(LocalizationStrings.error,loca.buyDMDecision,LocalizationStrings.yes,LocalizationStrings.no,(function(){$("a.dm_button").length>0?$("a.dm_button").click():window.location.href=$("#darkmatter_box a").attr("href")}))})).undelegate("#itemDetails a.activateItem.build-it","click").delegate("#itemDetails a.activateItem.build-it","click",(function(){var i=$(this);function n(){$.ajax({url:i.attr("rel"),data:{_token:token,referrerPage:e},type:"POST",dataType:"json",error:function(){fadeBox(translation.buyError,!0),$("#itemDetails a.activateItem").removeClass("build-it").addClass("build-it_disabled")},success:function(t){if(token=t.newAjaxToken,t.error||"failure"===t.status)t.message?fadeBox(t.message,!0):fadeBox(t.errors[0].message,!0),$("#itemDetails a.activateItem").removeClass("build-it").addClass("build-it_disabled");else{if(fadeBox(t.message,!1),t.reload)return void location.reload();inventoryObj.refreshResources(),inventoryObj.refreshItemData(t.item)}}})}if(i.hasClass("isUpgrade"))errorBoxDecision(LocalizationStrings.activateItem.upgradeItemQuestionHeader,LocalizationStrings.activateItem.upgradeItemQuestion,LocalizationStrings.yes,LocalizationStrings.no,n);else if(i.hasClass("isCharacterClassItem")){var a=i.data("itemName");errorBoxDecision(LocalizationStrings.notice,LocalizationStrings.characterClassItem.activateItemQuestion.replace("#characterClassName#",a),LocalizationStrings.yes,LocalizationStrings.no,n)}else i.hasClass("isAllianceClassItem")?t.fetchDataAboutCurrentAllianceClass(i.data("itemName"),n,"activateItemQuestion",null):n();return!1})).undelegate("#itemDetails a.buyAndActivate.build-it","click").delegate("#itemDetails a.buyAndActivate.build-it","click",(function(){var i=$(this);function n(){$.ajax({url:i.attr("rel"),data:{_token:token,referrerPage:e},type:"POST",dataType:"json",error:function(){fadeBox(translation.buyError,!0),$("#itemDetails a.activateItem").removeClass("build-it").addClass("build-it_disabled")},success:function(t){if(token=t.newAjaxToken,t.error||"failure"===t.status)t.message?fadeBox(t.message,!0):fadeBox(t.errors[0].message,!0),$("#itemDetails a.activateItem").removeClass("build-it").addClass("build-it_disabled");else{if(t.reload)return void location.reload();fadeBox(t.message,!1),inventoryObj.refreshResources(),inventoryObj.refreshItemData(t.item)}}})}if(i.hasClass("isUpgrade"))errorBoxDecision(LocalizationStrings.activateItem.upgradeItemQuestionHeader,LocalizationStrings.activateItem.upgradeItemQuestion,LocalizationStrings.yes,LocalizationStrings.no,n);else if(i.hasClass("isCharacterClassItem")){var a=i.data("itemName"),s=i.data("itemPrice");errorBoxDecision(LocalizationStrings.notice,LocalizationStrings.characterClassItem.buyAndActivateItemQuestion.replace("#characterClassName#",a).replace("#darkmatter#",tsdpkt(s)),LocalizationStrings.yes,LocalizationStrings.no,n)}else i.hasClass("isAllianceClassItem")?t.fetchDataAboutCurrentAllianceClass(i.data("itemName"),n,"buyAndActivateItemQuestion",i.data("itemPrice")):n();return!1})).undelegate("#itemDetails a.buyAndActivate.build-it_disabled.showGetMoreDmPopup","click").delegate("#itemDetails a.buyAndActivate.build-it_disabled.showGetMoreDmPopup","click",(function(){errorBoxDecision(LocalizationStrings.error,loca.buyDMDecision,LocalizationStrings.yes,LocalizationStrings.no,(function(){window.location.href=$("#darkmatter_box a").attr("href")}))}))},refreshResources:function(){getAjaxResourcebox((function(t){$(".to_dark_matter .level").text(gfNumberGetHumanReadable(t.darkmatter.amount,isMobile))}))},refreshItemData:function(t){var e=t.ref;if(changeTooltip($(".detail_button[ref='"+e+"']"),t.title),$(".detail_button[ref='"+e+"'] span.amount, #itemDetails[data-uuid='"+e+"'] span.amount").html(tsdpkt(t.amount)),void 0!==inventoryObj.items_inventory&&(0==inventoryObj.items_inventory.length?inventoryObj.items_inventory={}:t.amount<=0?delete inventoryObj.items_inventory[e]:inventoryObj.items_inventory[e]=t),void 0!==inventoryObj.items_shop&&(0==inventoryObj.items_shop.length&&(inventoryObj.items_shop={}),inventoryObj.items_shop[e]=t),changeTooltip($('#itemDetails[data-uuid="'+e+'"] a.activateItem, #itemDetails[data-uuid="'+e+'"] a.buyAndActivate'),t.activationTitle),t.hasEnoughCurrency?$('#itemDetails[data-uuid="'+e+'"] a.item').addClass("build-it").removeClass("build-it_disabled"):$('#itemDetails[data-uuid="'+e+'"] a.item').removeClass("build-it").addClass("build-it_disabled"),t.amount>0?($('#itemDetails[data-uuid="'+e+'"] a.activateItem').show(),$('#itemDetails[data-uuid="'+e+'"] a.buyAndActivate').hide(),t.canBeActivated?$('#itemDetails[data-uuid="'+e+'"] a.activateItem').removeClass("build-it_disabled").addClass("build-it"):$('#itemDetails[data-uuid="'+e+'"] a.activateItem').addClass("build-it_disabled").removeClass("build-it")):($('#itemDetails[data-uuid="'+e+'"] a.activateItem').hide(),$('#itemDetails[data-uuid="'+e+'"] a.buyAndActivate').show(),t.canBeBoughtAndActivated&&t.hasEnoughCurrency?$('#itemDetails[data-uuid="'+e+'"] a.buyAndActivate').removeClass("build-it_disabled").addClass("build-it"):$('#itemDetails[data-uuid="'+e+'"] a.buyAndActivate').addClass("build-it_disabled").removeClass("build-it")),isMobile){var i="";$('#itemDetails[data-uuid="'+e+'"] a.activateItem:visible,#itemDetails[data-uuid="'+e+'"] a.buyAndActivate:visible').hasClass("build-it_disabled")&&(i+=t.activationTitle),t.buyTitle.length&&t.buyTitle!=t.activationTitle&&(i+=t.buyTitle),$('#itemDetails[data-uuid="'+e+'"] .info_txt').text(i)}t.timeLeft>0&&t.extendable?($('#itemDetails[data-uuid="'+e+'"] a.activateItem span').html(loca.extend),$('#itemDetails[data-uuid="'+e+'"] a.buyAndActivate span').html(loca.buyAndExtend)):($('#itemDetails[data-uuid="'+e+'"] a.activateItem span').html(loca.activate),$('#itemDetails[data-uuid="'+e+'"] a.buyAndActivate span').html(loca.buyAndActivate)),t.isAnUpgrade?$('#itemDetails[data-uuid="'+e+'"] a.activateItem, #itemDetails[data-uuid="'+e+'"] a.buyAndActivate').addClass("isUpgrade"):$('#itemDetails[data-uuid="'+e+'"] a.activateItem, #itemDetails[data-uuid="'+e+'"] a.buyAndActivate').removeClass("isUpgrade"),!0===this.inShop&&this.changeCategory($(".categoryFilter a.active").attr("rel")),this.updateCategoryAmount()},boughtItemHint:function(){$(".to_inventory .bought_item_notice").show().fadeOut(1e3)},openShop:function(){this.currentPage="shop",$("#js_inventorySliderBox").hide(),$("#js_shopSliderBox").show(),$(".to_inventory").removeClass("active"),$(".to_shop").addClass("active"),$("#buttonz h2").text(loca.LOCA_PREMIUM_SHOP),isMobile&&$(".js_shopCurrentPage").html(loca.shopText)},openInventory:function(){this.currentPage="inventory",$("#js_shopSliderBox").hide(),$("#js_inventorySliderBox").show(),$(".to_shop").removeClass("active"),$(".to_inventory").addClass("active"),$("#buttonz h2").text(loca.LOCA_PREMIUM_INVENTORY),isMobile&&$(".js_shopCurrentPage").html(loca.inventoryText)},changeCategory:function(t){inventoryObj.currentCategory=t,$(".planetlink, .moonlink").fragment({category:t}),$(".categoryFilter li, .categoryFilter li a").removeClass("active"),$('.categoryFilter li a[rel="'+t+'"]').addClass("active").parent().addClass("active"),$(".anythingSlider").remove();var e=function(e,i){var n=[],a=[],s=0;$.each(e,(function(e){null!=this.category&&(-1!=("$"+this.category.join("$")+"$").toLowerCase().indexOf("$"+t+"$")&&(n[inventoryObj.item_orders[t][this.ref]]=this,inventoryObj.item_orders[t][this.ref]>s&&(s=inventoryObj.item_orders[t][this.ref])))}));for(var o=0;o<=s;++o)n[o]&&(a[o]=n[o]);inventoryObj.initalizeSlider(a,i,340,340,null,null,null,!1)};"shop"==inventoryObj.currentPage?e(inventoryObj.items_shop,"js_shopSlider"):"inventory"==inventoryObj.currentPage&&e(inventoryObj.items_inventory,"js_inventorySlider")},updateCategoryAmount:function(){var t;if("shop"==inventoryObj.currentPage)t=inventoryObj.items_shop;else{if("inventory"!=inventoryObj.currentPage)return;t=inventoryObj.items_inventory}var e=$(".categoryFilter");e.find(".amount").text(0),$.each(t,(function(t){if(null!=this.category)for(var i in this.category){var n,a=this.category[i],s=e.find('a[rel="'+a+'"] .amount');"shop"==inventoryObj.currentPage?n=1:"inventory"==inventoryObj.currentPage&&(n=this.amount),s.text(tsdpkt(getValue(s.text())+n))}})),$.each(e.find("li"),(function(t){var i=inventoryObj.currentPage.slice(0,1).toUpperCase()+inventoryObj.currentPage.slice(1);$(this).hasClass("in"+i)?$(this).show():($(this).hide(),e.find("li:visible .active").length||e.find("li:visible:first a").click())}))},fetchDataAboutCurrentAllianceClass:function(t,e,i,n){if(!this.activatingItem){this.activatingItem=!0;let a=this;$.ajax({url:inventoryObj.ingameUrl,type:"GET",data:{component:"allianceclassselection",action:"fetchDataAboutCurrentAllianceClass",ajax:1,asJson:1},dataType:"json",error:function(s){a.promptUserForAllianceClassChange(t,e,i,n)},success:function(s){a.promptUserForAllianceClassChange(t,e,i,n,s)}})}},promptUserForAllianceClassChange:function(t,e,i,n,a){if(this.activatingItem=!1,a.userDoesNotHaveAlliance)return 0;let s=LocalizationStrings.allianceClassItem[i];s=s.replace("#allianceClassName#",t),"buyAndActivateItemQuestion"===i&&(s=s.replace("#darkmatter#",tsdpkt(n))),a&&a.currentAllianceClass&&a.dateOfLastAllianceClassChange&&(s+=LocalizationStrings.allianceClassItem.appendCurrentClassQuestion,s=s.replace("#currentAllianceClassName#",a.currentAllianceClass),s=s.replace("#lastAllianceClassChange#",a.dateOfLastAllianceClassChange)),errorBoxDecision(LocalizationStrings.notice,s,LocalizationStrings.yes,LocalizationStrings.no,e)}};var pushButton=null,applicationServerPublicKey="BA_ADqzYuy45TlLLbSQcBmOwbjYYaU1snQM8UtO6ZLgUon7HAOELOS_Wnwyv4kAIARi2jrLmXxtDTnx7htApqyc",isSubscribed=!1,swRegistration=null;function urlB64ToUint8Array(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),i=window.atob(e),n=new Uint8Array(i.length),a=0;a<i.length;++a)n[a]=i.charCodeAt(a);return n}function initializeUI(){pushButton.addEventListener("click",(function(){pushButton.disabled=!0,isSubscribed?unsubscribeUser():subscribeUser()})),swRegistration.pushManager.getSubscription().then((function(t){isSubscribed=!(null===t),updateSubscriptionOnServer(t),updateBtn()}))}function updateBtn(){if("denied"===Notification.permission)return pushButton.textContent="Push Messaging Blocked.",pushButton.disabled=!0,void updateSubscriptionOnServer(null);isSubscribed?(pushButton.textContent="Disable Push Messaging",pushButton.checked=!0):(pushButton.textContent="Enable Push Messaging",pushButton.checked=!1),pushButton.disabled=!1}function subscribeUser(){var t=urlB64ToUint8Array(applicationServerPublicKey);swRegistration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:t}).then((function(t){updateSubscriptionOnServer(t),isSubscribed=!0,updateBtn()})).catch((function(t){updateBtn()}))}function unsubscribeUser(){swRegistration.pushManager.getSubscription().then((function(t){if(t)return t.unsubscribe()})).catch((function(t){})).then((function(){updateSubscriptionOnServer(null),isSubscribed=!1,updateBtn()}))}function updateSubscriptionOnServer(t){t&&$.post("?page=ajax&component=subscription&action=subscribe",{subscription:JSON.stringify(t)})}function initSubscriptionSystem(){pushButton=document.querySelector(".onoffswitch-checkbox"),console.log(pushButton),"serviceWorker"in navigator&&"PushManager"in window?(pushButton.setAttribute("disabled","disabled"),pushButton.classList.add("disabled"),console.log(pushButton),navigator.serviceWorker.register("sw.js").then((function(t){swRegistration=t,initializeUI()})).catch((function(t){}))):pushButton.textContent="Push Not Supported"}function tabletInitOverviewAdvice(){if(!isMobile)return!1;var t=$(".adviceWrapper"),e=t.find("#exodus-indicator, #exodus-timer"),i=t.find("#exodus-indicator-processed");t.prev().before(e),t.prev().before(i),$("#planetdata").after(t)}function tabletInitGalaxyDetails(){if(!isMobile)return!1;var t=["js_planet","js_moon","js_debris","js_playerName","js_allyTag"];$(".js_detailRow").css("display","none"),$(".js_detailRow").each((function(e){e=$(this).attr("rel");for(var i=0;i<t.length;i++){var n=$("."+t[i]+e);if(void 0===n||0==n.length){if(16==e)continue;if(17==e)continue;return}n.attr("class").indexOf("js_no_action")>=0||(n.unbind(),n.bind("click.planet",(function(t){$(this).hasClass("active")?($(".row *.active").removeClass("active"),$(".js_detailRow").css("display","none")):($(".row *.active").removeClass("active"),$(".bdaySlotBox")&&$(".bdaySlotBox .name").removeClass("active"),$(".js_detailRow").css("display","none"),$(this).html().trim()&&($(this).addClass("active"),$(this).attr("class").indexOf("js_planet")>=0?elem=".js_detailRowPlanet"+e:$(this).attr("class").indexOf("js_moon")>=0?elem=".js_detailRowMoon"+e:$(this).attr("class").indexOf("js_debris")>=0?elem=".js_detailRowDebris"+e:$(this).attr("class").indexOf("js_playerName")>=0?elem=".js_detailRowPlayer"+e:$(this).attr("class").indexOf("js_allyTag")>=0&&(elem=".js_detailRowAlliance"+e),$(elem).css("display","table-row")))})))}})),$("a.planetMoveIcons").bind("click",(function(t){t.stopPropagation()}))}function tabletToggleTechtreeInfos(t){if(!isMobile)return!1;var e=$("div.techtree[data-id='"+t+"']"),i=e.find(".techImage a");i.each((function(){var t=$(this),e=t.parent().hasClass("built")?"undermark":"overmark",i=t.data("tech-name"),n=t.data("tech-type");t.append('<div class="short_info" style="display: none"><span class="'+e+'">'+i+"</span><br/>"+n+"</div>")})),i.length&&e.append($('<a id="toggleDetails" href="javascript:void(0)" class="btn_blue">'+LocalizationStrings.moreDetails+"</a>").click((function(){var t=e.find(".short_info");t.is(":visible")?$(this).text(LocalizationStrings.moreDetails):$(this).text(LocalizationStrings.lessDetails),t.toggle()})))}function tabletInitEmpire(){if(!isMobile)return!1;var t=$("#mainWrapper").width();t=t<1024?"1024":t,$("#outerWrapper").width(t),$(".reset").hide()}function tabletInitPayment(){if(!isMobile)return!1;$("#payment").parent(".overlayDiv").dialog("option","title",paymentLoca.title),document.addEventListener("deviceready",(function(){$("#mobilePayment a.js_buyPacket").unbind("click").bind("click",(function(){HostApp.StartPayment($(this).attr("ref"),userData.id,constants.name,constants.language)})),HostApp.OnPaymentFinished=function(){getAjaxResourcebox((function(t){fadeBox(paymentLoca.success,!1),$("#payment").parent().dialog("close"),$("#planet #content .level span").attr("class","undermark").text(gfNumberGetHumanReadable(t.darkmatter.amount,isMobile))}))},HostApp.OnPaymentFailed=function(){fadeBox(paymentLoca.error,!0)}}),!1)}function tabletInitGalaxy(){if(!isMobile)return!1;$("#galaxyContent").wipetouch({wipeLeft:function(t){$("#galaxyLoading:visible").length||submitOnKey("ArrowLeft")},wipeRight:function(t){$("#galaxyLoading:visible").length||submitOnKey("ArrowRight")},preventDefault:!1,preventDefaultWhenTriggering:!0,moveX:180,moveY:60})}function initRetinaImages(){"1px"==$(".js_replace2x").css("font-size")&&$("img.js_replace2x").each((function(){$(this).attr("src",$(this).attr("rel"))}))}function setupOverlay(t,e,i){$(".build-it_premium").addClass("overlay"),$(".build-it_premium").attr("href",t),$(".build-it_premium").data("overlay-title",e),$(".build-it_premium").data("techid",i)}function drawErrorbox(t,e,i,n,a,s){var o=!1!==(s=null!=s&&s)?$("."+s):$(".build-it_disabled");void 0!==a&&""!=a||(a=document.location.href),o.click((function(){void 0!==i&&void 0!==n&&void 0!==a&&("notify"==t&&errorBoxNotify(i,e,n.allOk,(function(){window.location.href=a})),"decision"==t&&errorBoxDecision(i,e,n.allYes,n.allNo,(function(){window.location.href=a}))),"fadeBox"==t&&fadeBox(e,!0)}))}function showErrors(){var t={allYes:loca.allYes,allNo:loca.allNo,allOk:loca.allOk};if(isBuildlistNeeded){if(!hasCommander&&!isShip&&!isRocket)return drawErrorbox("decision",loca.infoBuildlist,loca.allError,t,links.decisionCommander,"build-it_premium"),1;if(isRocketAndStorageNotFree)return drawErrorbox("notify",loca.noRocketsiloCapacity,loca.allError,t,links.notify),1}else if(null!==error&&0!==error)return premiumerror?showErrorOnPremiumbutton?(drawErrorbox("decision",errorlist[error],loca.allError,t,links[error],buttonClass),1):(drawErrorbox("decision",errorlist[error],loca.allError,t,links[error]),1):isRocketAndStorageNotFree?(drawErrorbox("notify",loca.noRocketsiloCapacity,loca.allError,t,links.notify),1):(isBusy||drawErrorbox("notify",errorlist[error],loca.allError,t,""),1);return 0}function initGlobalTechtree(t){var e=$("div.graph[data-id='"+t+"']");e.find(".headline").unbind("click").bind("click",(function(){$(this).next().toggle((function(){var t=e.parents(".ui-dialog");t.hide(),$(this).toggleClass("open"),t.show()}))})),"all"==openTree?e.find(".techtree_content").show(0,(function(){$(this).addClass("open")})):null!=openTree&&e.find(".techtree_content_"+openTree).show(0,(function(){$(this).addClass("open")}))}function initOverlayName(){let t=$("#technologytree").data("title");$("#technologytree").closest(".ui-dialog").find(".ui-dialog-title").html(t)}function drawArrows(t){var e=$("div.graph[data-id='"+t+"']"),i=e.find(".techImage").outerHeight(!0),n=20;e.find(".techWrapper.depth1").each((function(){n+=$(this).outerWidth()})),e.css("width",n);var a=jsPlumb.getInstance();a.Defaults.Container=e,a.Defaults.Connector=["Flowchart",{cornerRadius:20}],a.Defaults.Endpoint=["Rectangle",{cssClass:"endpoint",width:1,height:1}],a.Defaults.Anchors=["ContinuousTop","ContinuousBottom"];var s,o={};$.each(endpoints,(function(){var t=e.find(".tech"+this.toString());a.addEndpoint(t);var i=t.find("a").offset();if(i){var n=Math.floor(i.left),s=Math.floor(i.top);o[this]=[n,s]}else o[this]=[0,0]}));do{s=!1,$.each(connections,(function(){var t=e.find(".tech"+this.source+" a"),n=e.find(".tech"+this.target+" a"),a=t.offset(),r=n.offset();null!=a&&null!=r&&a.top>=r.top-10&&a.top<=r.top+10&&(t.parent().css("margin-top",parseInt(t.parent().css("margin-top").replace(/px/,""))+i),t.parent().parent().find("a[data-tech-id]").each((function(){o[$(this).attr("data-tech-id")]&&(o[$(this).attr("data-tech-id")][1]+=i)})),s=!0)}))}while(s);var r=[],l=[];for(var c in o)-1==r.indexOf(o[c][0])&&r.push(o[c][0]),-1==l.indexOf(o[c][1])&&l.push(o[c][1]);r.sort((function(t,e){return t>e?1:-1})),l.sort((function(t,e){return t>e?1:-1}));var d={};for(var u in o)d[u]={left:r.indexOf(o[u][0]),top:l.indexOf(o[u][1])};connections.sort((function(t,e){return Math.abs(d[t.source].left-d[t.target].left)<Math.abs(d[e.source].left-d[e.target].left)?-1:1}));var h={hasRequirements:{strokeStyle:"#015100",lineWidth:3},hasNotRequirements:{strokeStyle:"#510009",lineWidth:3}},p=[[0,.5,-1,0],[0,.3,-1,0],[0,.7,-1,0],[0,.9,-1,0]],f=[[.5,1,0,1],[.3,1,0,1],[.7,1,0,1],[.9,1,0,1]],m=[[.5,0,0,-1],[.3,0,0,-1],[.7,0,0,-1],[.9,0,0,-1]],g={};function v(t,e,i,n){return n[t]||(n[t]={}),null==n[t][e]&&(n[t][e]=0),++n[t][e],i[n[t][e]-1]}$.each(connections,(function(){var t={source:e.find(".tech"+this.source+" a"),target:e.find(".tech"+this.target+" a"),overlays:[["Arrow",{location:-5,paintStyle:h[this.paintStyle],width:8,length:8,foldback:.8}],["Label",{label:this.label,cssClass:"label "+this.paintStyle,location:.85}]],paintStyle:h[this.paintStyle],hoverPaintStyle:{strokeStyle:"rgb(255, 255, 0)"}};d[this.target].left<d[this.source].left||d[this.target].left>d[this.source].left||(d[this.target].top<d[this.source].top-1&&lineInCoordinatesBlocked(d,d[this.source].left,d[this.source].top,d[this.target].left,d[this.target].top)?t.anchors=[v(this.source,"left",p,g),v(this.target,"left",p,g)]:(t.anchors=[v(this.source,"top",m,g),v(this.target,"bottom",f,g)],t.overlays[1][1]=readableVersionOfLabel(t.overlays[1][1],g[this.target].bottom))),a.connect(t)}))}function initTechtree(t){jQuery,drawArrows(t),tabletToggleTechtreeInfos(t)}function readableVersionOfLabel(t,e){t.location=-.05*e+.85;t.label.indexOf("/");return t}function lineInCoordinatesBlocked(t,e,i,n,a){if(e==n){for(var s in t)if(t[s].left==e&&i>t[s].top&&a<t[s].top)return!0}else if(i==a&&e>n){for(var o in t)if(t[o].top==i&&e>t[o].left&&n<t[o].left)return!0}else if(i==a&&e<n)for(var r in t)if(t[r].top==i&&e<t[r].left&&n>t[r].left)return!0;return!1}function positionInCoordinatesBlocked(t,e,i){for(var n in t)if(t[n].left==e&&t[n].top==i)return!0;return!1}var javascriptAvailable=!0,days=new Array("Mon","Tus","Wed","Thu","Fri","Sat","Sun"),months=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");function getFormatedDate(t,e){var i=new Date;return i.setTime(t),str=e,str=str.replace("[d]",dezInt(i.getDate(),2)),str=str.replace("[D]",days[i.getDay()]),str=str.replace("[m]",dezInt(i.getMonth()+1,2)),str=str.replace("[M]",months[i.getMonth()]),str=str.replace("[j]",parseInt(i.getDate())),str=str.replace("[Y]",i.getFullYear()),str=str.replace("[y]",i.getFullYear().toString().substr(2,4)),str=str.replace("[G]",i.getHours()),str=str.replace("[H]",dezInt(i.getHours(),2)),str=str.replace("[i]",dezInt(i.getMinutes(),2)),str=str.replace("[s]",dezInt(i.getSeconds(),2)),str}function dezInt(t,e,i){var n=t<0?"-":"",a="0"==(i=i||"0")?n:"";e-=(""+(t=Math.abs(parseInt(t,10)))).length;for(var s=1;s<=e;s++)a+=""+i;return a+=("0"!=i?n:"")+t}function getFormatedTime(t){return hours=Math.floor(t/3600),timeleft=t%3600,minutes=Math.floor(timeleft/60),timeleft%=60,seconds=timeleft,dezInt(hours,2)+":"+dezInt(minutes,2)+":"+dezInt(seconds,2)}function tsdpkt(t){var e="";t<0&&(e="-");for(var i=(t=Math.abs(t))%1e3;t>=1e3;){var n="";t%1e3<100&&(n="0"),t%1e3<10&&(n="00"),t%1e3==0&&(n="00"),i=(t=Math.abs((t-t%1e3)/1e3))%1e3+LocalizationStrings.thousandSeperator+n+i}return i=e+i}function formatTime(t){var e=Math.floor(t/3600);t-=3600*e;var i=Math.floor(t/60);return t-=60*i,i<10&&(i="0"+i),t<10&&(t="0"+t),e+":"+i+":"+t}function round(t,e){if(e<1||e>14)return!1;var i=Math.pow(10,e),n=(Math.round(t*i)/i).toString();return-1==n.indexOf(".")&&(n+="."),(n+=i.toString().substring(1)).substring(0,n.indexOf(".")+e+1)}function show_hide_menus(t){$(t).is(":visible")?$(t).hide():$(t).show()}function change_class(t){"closed"==document.getElementById(t).className?document.getElementById(t).className="opened":document.getElementById(t).className="closed"}function show_hide_tbl(t){var e=document.getElementById(t);try{e&&(e.style.display="none"==e.style.display?"table-row":"none")}catch(t){e.style.display="block"}}function cntchar(t,e){var i=$(t);i.val().length>e&&i.val(i.val().substr(0,e)),i.parents("form").find(".cntChars").text(i.val().length)}function showGalaxy(t,e,i){openParentLocation("index.php?page=ingame&component=galaxy&no_header=1&galaxy="+t+"&system="+e+"&planet="+i)}function openParentLocation(t){try{document.location.href=t}catch(e){try{window.parent.document.location.href=t}catch(e){window.opener.document.location.href=t}}}function submitOnEnter(t){return"Enter"!==t.key||(t.preventDefault(),trySubmit(),!1)}function setMaxIntInput(t,e){for(var i in e)$(t).find("#ship_"+i).attr("disabled")||($(t).find("#ship_"+i).val(e[i]),checkIntInput($(t).find("ship_"+i),0,e[i]))}function clearInput(t){$(t).val("")}function checkIntInput(t,e,i){var n=$(t).val();void 0!==n&&""!=n&&(intVal=Math.abs(getValue(n)),null!=i&&(intVal=Math.min(intVal,i)),$(t).val(intVal))}function clampInt(t,e,i,n){if(n&&(""===t||0===t))return"";let a=parseInt(t);return isNaN(a)?e:(a=Math.min(a,i),a=Math.max(a,e),a)}function clampFloat(t,e,i){let n=parseFloat(t);return isNaN(n)?e:(n=Math.max(n,e),n=Math.min(n,i),n)}function handlerToSubmitAjaxForm(t){var e="submit_"+String(t);return $.isFunction(window[e])&&window[e](),!1}function ajaxCall(t,e,i){if("string"==typeof e){let t=$(e);t.find("select").ogameDropDown("destroy"),t.html('<p class="ajaxLoad"></p>')}$.post(t,(function(t){if("string"==typeof e){let i=$(e);i.html(t),i.find("select").ogameDropDown()}"function"==typeof i&&i()}))}function ajaxSubmit(t,e,i,n){if("string"==typeof i){let t=$(i);t.find("select").ogameDropDown("destroy"),t.html('<p class="ajaxLoad"><?=LOCA_ALL_AJAXLOAD ?></p>')}let a="string"==typeof e?$(e).serialize():e;$.post(t,a,(function(t){if("string"==typeof i){let e=$(i);e.html(t),e.find("select").ogameDropDown()}"function"==typeof n&&n()}))}function getValue(t){return result=parseInt(t.toString().replace(/^k$/,"1000").replace(/k/,"000").replace(/^0+/,"").replace(/[^0-9]/g,"")),isNaN(result)?0:result}function loadScript(t,e){if(void 0===loadScript.loadedScripts&&(loadScript.loadedScripts={}),void 0===loadScript.loadedScripts[t]){loadScript.loadedScripts[t]=!0;var i=document.createElement("script");i.type="text/javascript",i.readyState?i.onreadystatechange=function(){"loaded"!=i.readyState&&"complete"!=i.readyState||(i.onreadystatechange=null,e())}:i.onload=function(){e()},i.src=t,document.getElementsByTagName("head")[0].appendChild(i)}else e()}function formatNumber(t,e){var i=number_format(getValue(e),0,LocalizationStrings.decimalPoint,LocalizationStrings.thousandSeparator),n=$(t),a=n.getSelection();n.val().length!==i.length&&(a.start=Math.max(0,a.start+i.length-n.val().length),a.end=Math.max(0,a.end+i.length-n.val().length)),n.val(i),n.is(":focus")&&n.setSelection(a)}function initToggleHeader(t){$("a.toggleHeader[data-name="+t+"]").click((function(e){e.preventDefault();let i=$(e.currentTarget).closest(".planet-header").hasClass("shortHeader");$(e.currentTarget).closest(".planet-header").toggleClass("shortHeader"),$(".c-left").toggleClass("shortCorner"),$(".c-right").toggleClass("shortCorner"),changeSetting("headerImage",t+"|"+i)}))}function initFormValidation(){$("form.formValidation").validationEngine({validationEventTrigger:"keyup blur",promptPosition:"centerRight"})}function hideTipsOnTabChange(){$("select").ogameDropDown("hide"),Tipped.hideAll()}function focusOnTabChange(t,e){var i=function(){$(t).focus()};1==e&&$(document).ready(i),$(window).unbind("blur").bind("blur",i)}function getIEVersion(){var t=999;return-1!=navigator.appVersion.indexOf("MSIE")&&(t=parseFloat(navigator.appVersion.split("MSIE")[1])),t}function refreshBars(t,e,i){$("."+t).each((function(){var t=$(this),n=t.data("currentAmount")/t.data("capacity")*100,a=t.find("."+e);if(n>100?n=100:0==n?n=0:n<1.3&&(n=1.3),a.css("width",n+"%"),n<90?a.attr("class",e+" filllevel_undermark"):n>90&&n<100?a.attr("class",e+" filllevel_middlemark"):a.attr("class",e+" filllevel_overmark"),i){var s=t.find("."+i),o=s.data("premiumPercent");n+o>100&&(o=100-n),s.css("width",o+"%")}}))}function initTooltipSkins(){jQuery.extend(Tipped.Skins,{cloud:{offset:{x:0,y:-1,mouse:{x:-12,y:-12}},stem:{height:6,width:11,offset:{x:5,y:5},spacing:0}},premium:{offset:{x:0,y:-1,mouse:{x:-12,y:-12}},stem:{height:6,width:11,offset:{x:5,y:5},spacing:0}}})}function changeTooltip(t,e){var i=$(t);0!=i.length&&(removeTooltip(i),$(i).attr("title",e),initTooltips(i))}function removeTooltip(t){$(t).each((function(){$(this).data("tooltipLoaded")&&($(this).data("tooltipLoaded",!1),Tipped.remove($(this)))}))}function getTooltipOptions(t){var e=$(t),i={skin:"cloud",size:"x-small",maxWidth:400,closeButton:!1,hideOn:{element:"mouseleave",tooltip:"mouseleave"},hideOnClickOutside:!0};return-1!==window.location.href.indexOf("galaxy")&&(i.maxWidth=400),e.hasClass("tooltipPremium")&&(i.skin="premium"),e.hasClass("tooltipLeft")?i.position={target:"leftmiddle",tooltip:"righttop"}:e.hasClass("tooltipRight")?i.position={target:"rightmiddle",tooltip:"lefttop"}:e.hasClass("tooltipBottom")&&(i.position={target:"bottommiddle",tooltip:"topmiddle"}),e.data("tooltip-width")&&(i.maxWidth=e.data("tooltip-width")),e.hasClass("hideTooltipOnMouseenter")&&(i.hideOn.tooltip="mouseenter"),(isMobile||e.hasClass("tooltipClose"))&&(i.hideOthers=!0),e.hasClass("hideOthers")&&(i.hideOthers=!0),i.afterUpdate=function(t,i){if(isMobile&&e.data("tooltip-button")){var n=$(document.createElement("div")).addClass("tooltipButton");$(document.createElement("a")).addClass("btn_blue").attr("href","javascript:void(0);").html(e.data("tooltip-button")).bind("click",(function(t){$(i).not("a")&&$(i).find("a").length&&(i=$(i).find("a")[0]);var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),i.dispatchEvent(e)})).appendTo(n),$(t).append(n)}if(isMobile||e.hasClass("tooltipClose")){var a=$(document.createElement("div")).addClass("close-tooltip");$(t).prepend(a)}Tipped.refresh(i)},i}function getTooltipSelector(t){var e=".tooltipPremium, .tooltip, .tooltipRight, .tooltipLeft, .tooltipBottom, .tooltipClose, .tooltipHTML, .tooltipRel, .tooltipAJAX, .tooltipCustom, .markItUpButton a";if(void 0===t)t=e;else if("string"==typeof t&&!t.match(/\.tooltip/)){var n=e.split(", "),a=t;for(i in n)t+=", "+a+" "+n[i]}return t}function sanitizeTooltip(t){return t.replace(/<\s*script/g,"&lt;script")}function initTooltips(t){function e(t){var e={},i=t.split("|"),n=$(document.createElement("h1")).html(i[0]),a=$(document.createElement("div")).addClass("splitLine");if(void 0!==i[2]&&void 0!==i[3]){var s=$(document.createElement("h1")).html(i[2]),o=$(document.createElement("div")).addClass("splitLine");e=$(document.createElement("div")).css("display","none").addClass("htmlTooltip").append(n).append(a).append(i[1]+"</br>").append(s).append(o).append(i[3])}else e=$(document.createElement("div")).css("display","none").addClass("htmlTooltip").append(n).append(a).append(i[1]);return e[0]}function i(t){var i=$(t);if(!i.data("tooltipLoaded"))if(i.data("tooltipLoaded",!0),isMobile&&i.hasClass("js_hideTipOnMobile"))i.attr("title","");else{var n=getTooltipOptions(i);if(i.hasClass("tooltipCustom")&&(0!=n.hideOn&&(n.hideOn={element:"mouseleave",tooltip:"mouseleave"}),n.afterUpdate=function(t){$(t).find(".tooltipCustom").each((function(t,n){var a=getTooltipOptions(i);$(this).hasClass("tooltipHTML")?(a.inline=!0,a.hideOthers=!1,Tipped.create(this,e(sanitizeTooltip($(this).attr("title"))),a)):(a.hideOthers=!1,Tipped.create(this,sanitizeTooltip($(this).attr("title")),a))}))}),i.hasClass("tooltipHTML")){if(void 0===i.attr("title")||0==i.attr("title").trim().length)return;Tipped.create(i[0],e(sanitizeTooltip(i.attr("title"))),n)}else{if(i.hasClass("tooltipRel"))return n.inline=i.attr("rel"),i.hasClass("tooltipPersistent")&&(n.detach=!1),void Tipped.create(i[0],void 0,n);i.hasClass("tooltipAJAX")?$.get(i.attr("rel"),{},(function(t){Tipped.create(i[0],t,n)})):void 0!==i.attr("title")&&0!=i.attr("title").trim().length&&Tipped.create(i[0],sanitizeTooltip(i.attr("title")),n)}}}initTooltipSkins(),t=getTooltipSelector(t),removeTooltip(t),$(document).undelegate(t,"touchstart.tooltipClick").delegate(t,"touchstart.tooltipClick",(function(t){if(Tipped.visible(this)){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),this.dispatchEvent(e),t.preventDefault(),t.stopPropagation()}})),$(document).undelegate(".t_Tooltip.t_visible .close-tooltip","click").delegate(".t_Tooltip.t_visible .close-tooltip","click",(function(t){Tipped.hide($(t.currentTarget).closest(".t_Tooltip")[0])})),"string"==typeof t?$(document).undelegate(t,"mouseenter.tooltipLoad touchstart.tooltipLoad").delegate(t,"mouseenter.tooltipLoad touchstart.tooltipLoad",(function(t){i(this),Tipped.show(this)})):$(t).each((function(){i(this)}))}function initTrader(){var t=!1;void 0!==(e=$.deparam.fragment()).animation&&"false"==e.animation&&(t=!0);var e,i={$link:null,$panel:null,close:function(){this.$panel.hide()},setPanel:function(){this.$panel=$("#js_togglePanel"+traderObj.traderId.replace(/#div_trader/,""))},init:function(t){var e=$(t+" .selectWrapper");if(t=t.replace(/#div_trader/,""),e){this.$link=$("#js_toggleLink"+t),this.$panel=$("#js_togglePanel"+t);var n=this.$panel;n.hide(),this.$link.unbind("click.selectLink").bind("click.selectLink",(function(e){return t=traderObj.traderId.replace(/#div_trader/,""),$(this).hasClass("honor")||n.find("ul.active").has("li").length&&n.toggle(),!1})),$(".selectWrapper .source").unbind("click.selectPlanetOrMoon").bind("click.selectPlanetOrMoon",(function(t){i.selectPlanetOrMoon(this)})),$("#"+n.attr("id")).find("li").unbind("click.selectSource").bind("click.selectSource",(function(t){return traderObj.selectSource(this),!1})),i.outerClick(e,n);var a=null;e.unbind("mouseout.closeSelect").bind("mouseout.closeSelect",(function(t){var s=(t=t||window.event).relatedTarget?t.relatedTarget:t.toElement;s==e||i.isChildOf(s,e)||(a=setTimeout((function(){n.hide()}),8e3))})).unbind("mouseover.clearTimeout").bind("mouseover.clearTimeout",(function(){a&&clearTimeout(a)}))}},isChildOf:function(t,e){for(e=e[0];t&&t!=e;)t=t.parentNode;return t==e},outerClick:function(t,e){$("body").bind("click.outerClick",(function(i){i||(i=window.event),$(i.target).closest(".selectWrapper")!=t&&0!=e.is(":visible")&&e.toggle()}))},selectPlanetOrMoon:function(t){var e;if($(t).hasClass("selected"))return!1;var i="",n=null;if($(t).hasClass("js_honor")){$(traderObj.traderId+" .selectWrapper .source").removeClass("selected"),$(traderObj.traderId+" .js_honor").addClass("selected"),$(traderObj.traderId+" .toggleLink").addClass("honor");i='<img height="18" src="/img/icons/f35675179214f8f6f0f8d75740d7db.png" alt="'+loca.honorPoints+'"/><span class="option_source">'+loca.honorPoints+"</span>";return $(traderObj.traderId+" .js_valSourcePlanet").html(i),$(traderObj.traderId+" .normalResource").hide(),$(traderObj.traderId+" .honorResource").show(),!1}var a=$(traderObj.traderId+" .togglePanel"),s="planet";if($(t).hasClass("js_moon")){var o=0;for(e in s="moon",traderObj.planets)traderObj.planets[e].isMoon&&o++;if(0==o)return!1}var r=traderObj.planets[traderObj.current.planet];return a.find("ul").hide().removeClass("active"),a.find("ul."+s).show().addClass("active"),$(traderObj.traderId+" .toggleLink").removeClass("honor"),$(traderObj.traderId+" .selectWrapper .source").removeClass("selected"),$(traderObj.traderId+" .js_"+s).addClass("selected"),n=($(t).hasClass("js_moon")?r.isMoon:!r.isMoon)?traderObj.current.planet:null!=r.otherPlanetId&&void 0!==traderObj.planets[r.otherPlanetId]?r.otherPlanetId:a.find("ul."+s+" li:first").attr("id"),$(traderObj.traderId+" .normalResource").show(),$(traderObj.traderId+" .honorResource").hide(),a.find("ul li#"+n).click(),!1},setToggleLink:function(t){var e=traderObj.traderId.replace(/#div_trader/,""),i=$(t).find("span"),n=traderObj.planets[$(t).attr("id")].name;n!=i.text()&&i.attr("title",n.replace(/\|/g,"&#124;")),this.$link=$("#js_toggleLink"+e),this.$link.html($(t).html())}};traderObj={traderBGPos:{"#div_traderResources":"0px 0px","#div_traderAuctioneer":"-546px 0px","#div_traderScrap":"0px -220px","#div_traderImportExport":"-546px -220px"},timer:500,planets:{},honorOutput:0,price:0,deficit:0,priceImportExport:0,sumResources:0,traderId:null,resources:["Metal","Crystal","Deuterium"],current:{planet:currentPlanetId,resource:"",sliderValue:""},barXPos:-180,barYPos:0,percentPaid:0,switchingTrader:!1,checkOverbidden:function(){0==playerBid||playerBid>=getValue($(".detail_value.currentSum").html())?$(".overbid_text").hide():$(".overbid_text").show()},refresh:function(){var t=traderObj.traderId;if("#"+$(this).closest(".div_trader").attr("id")===t){var e=$(this).attr("class");(e=!!new RegExp(/\b(js_slider\w*)\b/).test(e)&&RegExp.$1)&&(traderObj.current.sliderValue=$(this).slider("value"),traderObj.current.resource=e.replace("js_slider","").toLowerCase(),"honor"==traderObj.current.resource?traderObj.honorOutput=traderObj.current.sliderValue:traderObj.planets[traderObj.current.planet].output[traderObj.current.resource]=traderObj.current.sliderValue,formatNumber($(t+" .js_amount.js_"+traderObj.current.resource),traderObj.current.sliderValue),"#div_traderAuctioneer"==t?(traderObj.price=getValue($(t+" .js_price").html()),traderObj.sumAuctioneer(),traderObj.checkOverbidden()):"#div_traderImportExport"==t&&traderObj.sumImportExport())}},resetValues:function(t,e){for(var n in t=t||traderObj.traderId,e=e||!1,traderObj.planets)for(var a in traderObj.planets[n].output)traderObj.planets[n].output[a]=0;traderObj.honorOutput=0,$(".js_amount").val(0),"#div_traderAuctioneer"==traderObj.traderId?traderObj.sumAuctioneer():"#div_traderImportExport"==traderObj.traderId&&traderObj.sumImportExport(),e&&(t=t.replace(/#div_trader/,""),$("#js_togglePanel"+t).find("li#"+currentPlanetId).click()),i.close()},resetMaxAmount:function(t,e){var n=traderObj.traderId,a=traderObj.resources;for(var s in traderObj.planets)for(var o=0;o<a.length;o++){var r=a[o].toLowerCase();traderObj.planets[s].input[r]=t[s][r]}for(var l=0;l<a.length;l++){r=a[l].toLowerCase();var c=traderObj.planets[traderObj.current.planet].input[r];$(n+" .max_planet_"+r).html(number_format(c,0))}honorScore=e,$(n+" .max_planet_honor").html(number_format(Math.max(0,e),0)),i.close()},selectSource:function(t){traderObj.current.planet=$(t).attr("id"),i.close(),i.setToggleLink($(t));var e=traderObj.traderId,n=traderObj.resources;$.ajax({url:urlRefreshPlanet,type:"POST",data:{planetId:traderObj.current.planet,_token:token,ajax:1},dataType:"json",success:function(t){if("success"===t.status){token=t.newAjaxToken;for(var i=0;i<n.length;i++){var a=n[i].toLowerCase(),s=t.refreshPlanet.input[a],o=s;if("#div_traderImportExport"==e){var r=traderObj.priceImportExport/multiplier[a]-traderObj.sumResources+t.refreshPlanet.output[a];o=Math.min(s,r)}$(e+" .max_planet_"+a).html(number_format(o,0)),$(e+" .js_amount.js_"+a).val(number_format(t.refreshPlanet.output[a],0))}}else{for(i=0;i<n.length;i++){a=n[i].toLowerCase();$(e+" .max_planet_"+a).html(number_format(0,0)),$(e+" .js_amount.js_"+a).val(number_format(0,0))}fadeBox(loca.error+": "+t.errors[0].message,!0)}},error:function(t){fadeBox(loca.error+": "+loca.ajaxError,!0)}})},selectTrader:function(e,n,a){n=n||traderObj.timer,$.bbq.pushState({page:e,animation:"false"}),$(".planetlink, .moonlink").fragment({page:e,animation:"false"}),traderObj.traderId="#div_"+e;var s=traderObj.traderId,o=$(".back_to_overview"),r=function(){"#div_traderAuctioneer"!=s&&"#div_traderImportExport"!=s||traderObj.resetValues(null,!0);var r=function(){$("#traderOverview").find(".c-left, .c-right").addClass("c-small"),o.show(),"#div_traderAuctioneer"==s||"#div_traderImportExport"==s?(o.addClass("left"),o.removeClass("right")):"#div_traderResources"!=s&&"#div_traderScrap"!=s||(o.addClass("right"),o.removeClass("left")),$("#planet #header_text h2").html(loca[e]).parent().show()};animation&&!t?($("#traderOverview").find(".c-left, .c-right").hide(),$("#planet").animate({backgroundPosition:traderObj.traderBGPos[s],height:"250px"},n,(function(){$("#planet").addClass("detail"),$("#traderOverview").find(".c-left, .c-right").show(),r(),"#div_traderResources"==s&&showTradeNowButton()}))):(t=!1,$("#planet").css("background-position",traderObj.traderBGPos[s]).css("height","250px"),r(),"#div_traderResources"==s&&showTradeNowButton()),i.setPanel(),$("#planet").addClass("detail"),$(".js_trader").hide(),$(s).show(),"#div_traderResources"==s&&void 0!==a&&$(s+" .ui-tabs").tabs("option","active",a),traderObj.switchingTrader=!1};if(0==$(traderObj.traderId).length){var l=e.toLowerCase().replace(/^trader/,"");let t=traderUrls[l];$.ajax({url:t,type:"POST",data:{show:l,ajax:1},beforeSend:function(){$("#loadingOverlay").addClass(l).show()},success:function(t){$("#inhalt").append(t),$("#loadingOverlay").hide().removeClass(l),r()},error:function(){fadeBox(loca.error,!0),$("#loadingOverlay").hide().removeClass(l)}})}else r()},submitAuction:function(){var t=traderObj.traderId;getValue($(t+" .js_auctioneerSum").html());if(!$(t+" .right_box .pay").hasClass("disabled")&&traderObj.price>0&&traderObj.deficit<=0){$(t+" .right_box .pay").addClass("disabled");var e={planets:{},honor:traderObj.honorOutput};for(var i in traderObj.planets)e.planets[i]=traderObj.planets[i].output;$.ajax({url:auctionUrl,type:"POST",data:{bid:e,_token:token,ajax:1},dataType:"json",success:function(e){token=e.newAjaxToken,fadeBox(e.message,e.error),e.error||(traderObj.resetValues(t,!1),traderObj.resetMaxAmount(e.planetResources,e.honor),traderObj.reloadResources())},error:function(){fadeBox(loca.error,!0)}})}return!1},submitImportExport:function(){if(!$(traderObj.traderId+" .right_box .pay").hasClass("disabled")){$(traderObj.traderId+" .right_box .pay").addClass("disabled");var t={planets:{},honor:traderObj.honorOutput};for(planetId in traderObj.planets)t.planets[planetId]=traderObj.planets[planetId].output;$.ajax({url:importUrlTrade,type:"POST",data:{action:"trade",bid:t,_token:token,ajax:1},dataType:"json",success:function(t){if(token=t.newAjaxToken,fadeBox(t.message,t.error),!t.error){for(planetId in traderObj.planets)traderObj.planets[planetId].output={metal:0,crystal:0,deuterium:0};$(traderObj.traderId+" .bargain_overlay").show(),$(traderObj.traderId+" .payment").hide(),$(traderObj.traderId+" .image_140px a").addClass("slideIn"),traderObj.reloadResources(),traderObj.updateImportItem(t.item),traderObj.refresh()}},error:function(){fadeBox(loca.error,!0)}})}return!1},reloadResources:function(t){getAjaxResourcebox(t)},changeImportItem:function(){return $(traderObj.traderId+" .import_bargain.change").hasClass("disabled")?darkMatter<importChangeCost&&errorBoxDecision(LocalizationStrings.error,loca.errorNotEnoughDM,LocalizationStrings.yes,LocalizationStrings.no,redirectBuyPremium):($(traderObj.traderId+" .import_bargain.change").addClass("disabled"),$.ajax({url:importUrlBargain,type:"POST",data:{action:"bargain",_token:token,ajax:1},dataType:"json",success:function(t){token=t.newAjaxToken,fadeBox(t.message,t.error),t.error||(traderObj.updateImportItem(t.item),traderObj.reloadResources((function(){t.item.offersLeft>0&&darkMatter>=importChangeCost?$(traderObj.traderId+" .import_bargain.change").removeClass("disabled"):$(traderObj.traderId+" .import_bargain.change").addClass("disabled")})),traderObj.refresh())},error:function(){fadeBox(loca.error,!0)}})),!1},updateImportItem:function(t){$(traderObj.traderId+" .got_item_text").html(t.itemText),$(traderObj.traderId+" .bargain_text").html(t.bargainText),$(traderObj.traderId+" .bargain_cost").html(t.bargainCostText),importChangeCost=t.bargainCost,$(traderObj.traderId+" .image_140px img").attr("src","/cdn/img/item-images/"+t.image+"-140x.png"),removeTooltip($(traderObj.traderId+" .image_140px a")),$(traderObj.traderId+" .image_140px a").attr("ref",t.uuid).removeClass("tooltip").addClass("tooltipHTML").attr("title",t.tooltip),initTooltips($(traderObj.traderId+" .image_140px a")),$(traderObj.traderId+" .detail_button .amount").text(t.amount)},takeImportItem:function(){return $(traderObj.traderId+" .import_bargain.take").hasClass("disabled")||($(traderObj.traderId+" .import_bargain.change").addClass("disabled"),$(traderObj.traderId+" .import_bargain.take").addClass("disabled"),$(traderObj.traderId+" .import_bargain.change").addClass("hidden"),$(traderObj.traderId+" .import_bargain.take").addClass("hidden"),$(traderObj.traderId+" .bargain_cost").addClass("hidden"),$.ajax({url:importUrlTakeItem,type:"POST",data:{action:"takeItem",_token:token,ajax:1},dataType:"json",success:function(t){if(token=t.newAjaxToken,fadeBox(t.message,t.error),!t.error){var e=t.item.ref;changeTooltip($(".detail_button[ref='"+e+"']"),t.item.title),$(".detail_button[ref='"+e+"'] span.amount, #itemDetails[data-uuid='"+e+"'] span.amount").html(tsdpkt(t.item.amount)),t.item.canBeActivated?$('#itemDetails[data-uuid="'+e+'"] a.activateItem').removeClass("build-it_disabled").addClass("build-it"):$('#itemDetails[data-uuid="'+e+'"] a.activateItem').addClass("build-it_disabled").removeClass("build-it"),0==t.item.newOffer?$(traderObj.traderId+" .bargain_text").html(t.item.noOfferMessage):traderObj.resetImport(t.item.newOffer)}},error:function(){fadeBox(loca.error,!0)}})),!1},resetImport:function(t){importChangeCost=t.bargainCost,darkMatter>=importChangeCost?$(traderObj.traderId+" .import_bargain.change").removeClass("disabled"):$(traderObj.traderId+" .import_bargain.change").addClass("disabled"),$(traderObj.traderId+" .import_bargain.take").removeClass("disabled"),$(traderObj.traderId+" .import_bargain.change").removeClass("hidden"),$(traderObj.traderId+" .import_bargain.take").removeClass("hidden"),$(traderObj.traderId+" .bargain_cost").removeClass("hidden"),$(traderObj.traderId+" .bargain_overlay").hide(),$(traderObj.traderId+" .payment").show(),$(traderObj.traderId+" .image_140px img").attr("src","/cdn/img/trader/container_"+t.rarity+".jpg"),$(traderObj.traderId+" .image_140px a").removeClass("slideIn").attr("ref","").removeClass("tooltipHTML").addClass("tooltip").removeClass("r_common_140px").removeClass("r_uncommon_140px").removeClass("r_rare_140px").removeClass("r_epic_140px").removeClass("r_buddy_140px").addClass("r_"+t.rarity+"_140px"),changeTooltip($(traderObj.traderId+" .image_140px a"),t.tooltip),$(traderObj.traderId+" .js_import_price").removeClass("green_text").text(number_format(t.price,0)),$(traderObj.traderId+" .image_140px .amount").text("?"),traderObj.priceImportExport=getValue($(".js_import_price").html()),traderObj.resetValues(null,!0),traderObj.init()},sumAuctioneer:function(){traderObj.traderId;var t=traderObj.price;0==t?$("#div_traderAuctioneer .js_amount").attr("disabled","disabled"):$("#div_traderAuctioneer .js_amount").removeAttr("disabled");var e=0;for(var i in traderObj.planets){var n=traderObj.planets[i].output;e+=parseInt(n.metal)*multiplier.metal+parseInt(n.crystal)*multiplier.crystal+parseInt(n.deuterium)*multiplier.deuterium}e+=parseInt(traderObj.honorOutput)*multiplier.honor,e=Math.floor(e),traderObj.deficit=Number(auctioneer.calculateDeficit())-Number(e),traderObj.deficit>0?$(" .js_deficit").html(number_format(traderObj.deficit,0)):$(" .js_deficit").html(number_format(0,0)),e>0?$("#div_traderAuctioneer .js_auctioneerSum").html("+ "+number_format(e,0)):$("#div_traderAuctioneer .js_auctioneerSum").html(""),$("#div_traderAuctioneer .js_alreadyBidden").html(number_format(Math.floor(playerBid+e),0)),t>0&&traderObj.deficit<=0?$("#div_traderAuctioneer .right_box .pay").removeClass("disabled"):$("#div_traderAuctioneer .right_box .pay").addClass("disabled")},sumImportExport:function(){var t=traderObj.traderId,e=0,i=0,n=0;for(var a in traderObj.sumResources=0,traderObj.planets){var s=traderObj.planets[a].output;e+=parseInt(s.metal)*multiplier.metal,i+=parseInt(s.crystal)*multiplier.crystal,n+=parseInt(s.deuterium)*multiplier.deuterium}var o=traderObj.honorOutput*multiplier.honor;traderObj.sumResources+=e+i+n+o,traderObj.sumResources>=traderObj.priceImportExport&&(traderObj.sumResources=traderObj.priceImportExport),$(t+" .js_sum_price").html(number_format(Math.floor(traderObj.sumResources),0)),traderObj.sumResources>=traderObj.priceImportExport?($(t+" .js_import_price").addClass("green_text"),$(t+" .right_box .pay").removeClass("disabled")):($(t+" .js_import_price").removeClass("green_text"),$(t+" .right_box .pay").addClass("disabled"))},updateValues:function(t){var e=traderObj.traderId;if(e==="#"+t.closest(".div_trader").attr("id")){var i=t.attr("class");if(i=!!new RegExp(/\b(js_slider\w*)\b/).test(i)&&RegExp.$1){var n,a,s,o=traderObj.current.planet;-1!=i.indexOf("More")?(s=i.replace("More",""),n="More"):-1!=i.indexOf("Max")&&(s=i.replace("Max",""),n="Max"),traderObj.current.resource=s.replace("js_slider","").toLowerCase()||null;var r=traderObj.current.resource,l=0;l="honor"==r?Math.max(0,honorScore):traderObj.planets[o].input[r],a=getValue($(e+" ."+s+"Input").val()),"More"==n?("#div_traderImportExport"==e?traderObj.sumResources<=traderObj.priceImportExport-1e3*multiplier[r]?a+=1e3:traderObj.sumResources<traderObj.priceImportExport&&(a+=Math.ceil((traderObj.priceImportExport-traderObj.sumResources)/multiplier[r])):"#div_traderAuctioneer"==e&&traderObj.price>0&&(a+=1e3),a>=l&&(a=Math.max(0,l))):"Max"==n&&("#div_traderImportExport"==e?0==traderObj.sumResources?a=Math.min(l,Math.ceil(traderObj.priceImportExport/multiplier[r])):traderObj.sumResources.isBetween(0,traderObj.priceImportExport-1)&&(a=Math.min(l,a+Math.ceil((traderObj.priceImportExport-traderObj.sumResources)/multiplier[r])),a=Math.max(0,a)):"#div_traderAuctioneer"==e&&traderObj.price>0&&(a=Math.min(l,Math.ceil(getValue($(e+" .js_deficit").html())/multiplier[r]+a))),"honor"==r&&a<0&&(a=0)),$(e+" .js_amount."+s+"Input").val(number_format(a,0)),"honor"==r?traderObj.honorOutput=a:traderObj.planets[o].output[r]=a,"#div_traderImportExport"==e?traderObj.sumImportExport():"#div_traderAuctioneer"==e&&traderObj.price>0&&(traderObj.sumAuctioneer(),traderObj.checkOverbidden())}}},updateValuesInputCanged:function(t){var e=traderObj.traderId;if(e==="#"+t.closest(".div_trader").attr("id")){var i=t.attr("class");if(i=!!new RegExp(/\b(js_slider\w*)\b/).test(i)&&RegExp.$1){var n=i.replace("Input",""),a=n.replace("js_slider","").toLowerCase(),s=traderObj.current.planet,o=0;o="honor"==a?Math.max(0,honorScore):parseInt(traderObj.planets[s].input[a]);var r=0;if("#div_traderImportExport"==e){var l=0;for(var c in traderObj.planets){var d=traderObj.planets[c].output;"metal"!=a&&(l+=Math.floor(parseInt(d.metal)*multiplier.metal)),"crystal"!=a&&(l+=Math.floor(parseInt(d.crystal)*multiplier.crystal)),"deuterium"!=a&&(l+=Math.floor(parseInt(d.deuterium)*multiplier.deuterium))}r=Math.min(getValue(t.val()),Math.ceil((traderObj.priceImportExport-l)/multiplier[a]))}else"#div_traderAuctioneer"==e&&(r=getValue(t.val()));r=Math.min(r,o),traderObj.planets[s].output[a]=r,"honor"==a?traderObj.honorOutput=r:traderObj.planets[s].output[a]=r,"#div_traderImportExport"==e?traderObj.sumImportExport():"#div_traderAuctioneer"==e&&(traderObj.sumAuctioneer(),traderObj.checkOverbidden()),formatNumber(e+" .js_amount."+n+"Input",r)}}},init:function(){$(".honorResource").hide(),$("#menuTable a.trader").unbind("click.gotoTrader").bind("click.gotoTrader",(function(t){t.preventDefault(),traderObj.switchTrader("traderResources")})),$(window).unbind("hashchange.switchTrader").bind("hashchange.switchTrader",(function(t){var e=$.deparam.fragment(t.fragment);void 0===e.page||""==e.page&&null!=traderObj.traderId?traderObj.returnToOverview():traderObj.switchTrader(e.page)})),$(".small_back_to_overview").unbind("mouseenter").unbind("mouseout").bind("mouseenter",(function(){$("#header_text").css("background-position","0 -250px")})).bind("mouseout",(function(){$("#header_text").css("background-position","0 0")}))},initSliderTrader:function(t){$(t+" .js_valButton").unbind("click.valControl"),$(t+" .js_amount").unbind("keyup.inputVal"),i.init(t),$(t+" .js_valButton").bind("click.valControl",(function(t){traderObj.updateValues($(this)),t.stopPropagation()})),$(t+" .js_amount").bind("keyup.inputVal",(function(t){traderObj.updateValuesInputCanged($(this)),t.stopPropagation()}))},initImportExport:function(){traderObj.planets=planetResources,traderObj.priceImportExport=getValue($(".js_import_price").html()),traderObj.initSliderTrader("#div_traderImportExport"),$("#div_traderImportExport .right_box .pay").bind("click",(function(){traderObj.submitImportExport()})),$("#div_traderImportExport .import_bargain.change").bind("click",(function(){traderObj.changeImportItem()})),$("#div_traderImportExport .import_bargain.take").bind("click",(function(){traderObj.takeImportItem()}))},switchTrader:function(e){traderObj.switchingTrader||(traderObj.switchingTrader=!0,Tipped.hideAll(),$("#planet .close_details:visible").click(),"#div_"+e!=traderObj.traderId&&(null!=traderObj.traderId||""==e||null==e?(traderObj.returnToOverview(),animation&&!t?setTimeout((function(){traderObj.selectTrader(e)}),500):traderObj.selectTrader(e)):traderObj.selectTrader(e)))},returnToOverview:function(){$("#planet #header_text h2").empty().parent().hide(),$("#traderOverview").find(".c-left, .c-right").hide();var e=traderObj.traderId;e&&($(e).hide(),$("#callTrader").hide(),animation&&!t?($("#planet h2").hide(),$("#planet").animate({backgroundPosition:"-273px 0px",height:"470px"},500,(function(){$("#planet h2").show(),$("#planet").removeClass("detail"),$("#traderOverview").find(".c-left, .c-right").show(),$(".js_trader").show()}))):($("#planet").removeClass("detail").css("background-position","-273px 0px").css("height","470px"),$(".js_trader").show()),$("#planet a").show(),$("#planet .back_to_overview").hide(),removeTooltip($("#planet .back_to_overview")),$("#traderOverview").find(".c-left, .c-right").removeClass("c-small"),traderObj.traderId=null,traderObj.switchingTrader=!1)}},breakerObj={costs:null,offer:null,ships:{},locked:!1,lastTechId:null,initialize:function(){this.offer=parseInt($(".scrap_offer_amount").html()),this.costs=breakerCosts;var t=this;$("#js_anythingSliderShips, #js_anythingSliderDefense").anythingSlider({startStopped:!0,buildStartStop:!1,expand:!0,resizeContents:!1,theme:"default",infiniteSlides:!1,autoPlay:!1,easing:"swing",resizeContents:!0,stopAtEnd:!0,playRtl:isRTLEnabled,buildNavigation:!1,onInitialized:function(t,e){if(isMobile){var i=0,n=0,a="ontouchend"in document,s=a?"touchstart":"mousedown",o=a?"touchmove":"mousemove",r=a?"touchend":"mouseup";e.$window.bind(s,(function(t){n=(new Date).getTime(),i=t.originalEvent.touches?t.originalEvent.touches[0].pageX:t.pageX})).bind(r,(function(t){n=0,i=0})).bind(o,(function(t){t.preventDefault();var a=t.originalEvent.touches?t.originalEvent.touches[0].pageX:t.pageX,s=0===i?0:Math.abs(a-i),o=(new Date).getTime();0!==n&&o-n<1e3&&s>50&&(a<i&&e.goForward(),a>i&&e.goBack(),n=0,i=0)}))}}}),$("#js_anythingSliderDefense").parent().parent().hide(),$(".scrap_defense").bind("click.tabDefense",(function(){$(".scrap_ships").removeClass("selected"),$(this).addClass("selected"),$("#js_anythingSliderShips").parent().parent().hide(),$("#js_anythingSliderDefense").parent().parent().show()})),$(".scrap_ships").bind("click.tabShips",(function(){$(".scrap_defense").removeClass("selected"),$(this).addClass("selected"),$("#js_anythingSliderDefense").parent().parent().hide(),$("#js_anythingSliderShips").parent().parent().show()})),$(".image a").each((function(){var e=$(this).attr("ref").substr(6,3),i=$(this).find(".level"),n=i.contents().filter((function(){return 3==this.nodeType}));t.ships[e]=n.text().replace(/^\s+|\s+$/g,""),n.remove(),i.append(tsdpkt(t.ships[e]))})),$("#js_scrapBargain").unbind("click").bind("click",(function(){return $(this).hasClass("disabled")?breakerMaximumPercent>t.offer&&errorBoxDecision(LocalizationStrings.error,loca.errorNotEnoughDM,LocalizationStrings.yes,LocalizationStrings.no,redirectBuyPremium):t.bargain(t),!1})),$("#js_scrapScrapIT").unbind("click").bind("click",(function(){return $(this).hasClass("disabled")||t.trade(t),!1})),$("input.ship_amount").unbind("focus").bind("focus",(function(){t.lastTechId=$(this).attr("name").substr(2,3),$(this).val("")})),$("input.ship_amount").unbind("keyup change").bind("keyup change",(function(e){t.lastTechId=$(this).attr("name").substr(2,3),formatNumber(this,$(this).val());var i=$(this);clearTimeout(i.data("timer")),i.data("timer",setTimeout((function(){i.removeData("timer"),t.updateResources(t)}),300))})),$(".buildingimg a").unbind("click").bind("click",(function(){return!1})),$(".js_maxShips").unbind("click").bind("click",(function(){isMobile||$($(this).attr("ref")).focus();var e=t.ships[$(this).attr("ref").substr(6,3)];return $($(this).attr("ref")).val(tsdpkt(e)).trigger("change"),t.updateResources(t),!1})),$(".sendAll").unbind("click").bind("click",(function(){$(".anythingSlider ul:visible input").each((function(){t.lastTechId=$(this).attr("name").substr(2,3);var e=t.ships[t.lastTechId];e>0&&$(this).val(tsdpkt(e))})),t.updateResources(t,(function(e){e.error&&($(".anythingSlider ul:visible input").val(""),$("#div_traderScrap .resource_amount").text(0),t.checkShips(t))}))})),$(".sendNone").unbind("click").bind("click",(function(){$(".anythingSlider ul:visible input").each((function(){t.lastTechId=$(this).attr("name").substr(2,3),$(this).val("")})),t.updateResources(t)})),$("#js_bargainCost").text(tsdpkt(this.costs)),this.checkMoney(this),this.checkShips(this),this.updateBargain(this)},bargain:function(t){$("#js_scrapBargain").addClass("disabled"),$.ajax({url:breakerLinkBargain,type:"POST",dataType:"json",data:{bargain:1,_token:token},beforeSend:function(){t.lock(t)},success:function(e){let i=e.data;t.unlock(t),token=e.newAjaxToken,fadeBox(i.message,i.error),i.error||(t.costs=i.bargainPrice,t.offer=i.percentage,darkMatter=i.resources.dm,t.updateBargain(t),t.updateResources(t),traderObj.reloadResources((function(){t.checkMoney(t),Tipped.show($("#js_scrapBargain")[0])}))),$(".scrap_trader_quote").text(i.quote)},error:function(){t.unlock(t)}})},trade:function(t){t.lock(t);var e,i,n=t.getTradeArray();errorBoxDecision(loca.breaker,(e=loca.breakerQuestion+'<br/><br/><div style="text-align: left; margin-left: 30px">',i=0,$.each(n,(function(t){e+=this+"x "+breakerTechs[t].name+", ",++i%2==0&&(e+="<br/>")})),e=e.replace(/, (<br\/>)?$/,""),e+="</div>"),LocalizationStrings.yes,LocalizationStrings.no,(function(){$.ajax({url:breakerLinkTrade,type:"POST",dataType:"json",data:{lastTechId:t.lastTechId,finishTrade:1,trade:n,_token:token},success:function(e){let i=e.data;t.unlock(t),token=e.newAjaxToken,i.error?fadeBox(i.message,!0):(fadeBox(i.message,!1),t.offer=i.percentage,t.costs=i.bargainPrice,t.resetForm(),t.updateBargain(t),$("#js_scrapAmountMetal").html(0),$("#js_scrapAmountCrystal").html(0),$("#js_scrapAmountDeuterium").html(0),traderObj.reloadResources((function(){t.updateShips(t)}))),$(".scrap_trader_quote").text(i.quote)},error:function(){t.unlock(t),fadeBox(loca.error,!0)}})}),(function(){t.unlock(t)}))},updateResources:function(t,e){t.locked||$.ajax({url:breakerLinkTrade,type:"POST",dataType:"json",data:{lastTechId:t.lastTechId,trade:t.getTradeArray(),_token:token},beforeSend:function(){t.lock(t)},success:function(i){let n=i.data;token=i.newAjaxToken,n.error&&fadeBox(n.message,!0),t.locked=!1;var a=!1;for(var s in n.techAmount)$("#ship_"+s).val(tsdpkt(n.techAmount[s])),a||$("#ship_"+s).val()==t.ships[s]||(a=!0);$("#js_scrapAmountMetal").html(tsdpkt(round(n.resources.metal,2))),$("#js_scrapAmountCrystal").html(tsdpkt(round(n.resources.crystal,2))),$("#js_scrapAmountDeuterium").html(tsdpkt(round(n.resources.deuterium,2))),t.notFirstOffer||($(".scrap_trader_quote").text(loca.breakerFirstOffer),t.notFirstOffer=!0),a?t.updateShips(t):t.unlock(t),"function"==typeof e&&e(n)},error:function(){t.unlock(t)}})},updateShips:function(t){$.ajax({url:techUrl,type:"POST",dataType:"json",beforeSend:function(){t.lock(t)},success:function(e){$("#div_traderScrap .item").each((function(){var i=$(this).attr("id").substr(6,3);if(void 0!==e[i]){var n=0;null!=e[i]&&(n=getValue(e[i])),t.ships[i]=n;var a=$(this).find(".level");if(a.contents().filter((function(){return 3==this.nodeType})).remove(),a.append(tsdpkt(n)),null!=e[i]){var s=$("#button"+i);s.removeClass("on").removeClass("off"),n>0?s.addClass("on"):s.addClass("off")}}})),t.unlock(t)},error:function(){t.unlock(t)}})},getTradeArray:function(){var t={};return $("input.ship_amount").each((function(){var e=$(this).attr("name").substr(2,3);0!=getValue($(this).val())&&(t[e]=getValue($(this).val()))})),t},resetForm:function(){$("input.ship_amount").each((function(){$(this).val("0")})),removeTooltip($("#js_scrapBargain")),$("#js_scrapBargain").removeClass("tooltip").removeAttr("title")},checkMoney:function(t){darkMatter<t.costs?$("#js_scrapBargain").addClass("disabled"):breakerMaximumPercent<=t.offer?($("#js_scrapBargain").addClass("disabled").addClass("tooltip").attr("title",loca.infoMaxBargain),initTooltips($("#js_scrapBargain"))):$("#js_scrapBargain").removeClass("disabled")},checkShips:function(t){var e=!1;$("input.ship_amount").each((function(){$(this).val().length>0&&getValue($(this).val())>0&&(e=!0)})),e?$("#js_scrapScrapIT").removeClass("disabled"):$("#js_scrapScrapIT").addClass("disabled")},updateBargain:function(t){$(".scrap_offer_amount").css("height",t.offer/100*$(".scrap_offer_amount").parent().css("height").replace("px","")),$(".scrap_offer_amount").html(t.offer+"%"),$(".js_bargainCost").text(tsdpkt(t.costs))},lock:function(t){$("#js_scrapBargain").addClass("disabled"),$("#js_scrapScrapIT").addClass("disabled"),t.locked=!0},unlock:function(t){t.locked=!1,t.checkShips(t),t.checkMoney(t)}},auctioneer={socket:null,connected:!1,timeout:null,retryInterval:5e3,historyShown:!1,initConnection:function(){try{var t=auctioneer;this.socket=new io.connect(":"+nodePort+"/auctioneer",nodeParams),this.socket.on("connect",(function(){t.connected=!0,clearTimeout(this.timeout)})),this.socket.on("disconnect",(function(){t.connected=!1,t.retryConnection()})),this.socket.on("new auction",(function(e){auctionId=e.auctionId;var i=$("#div_traderAuctioneer .detail_value.currentPlayer").html();i=null==e.oldAuction.player?loca.auctionNotSold:'<a href="'+e.oldAuction.player.link+'">'+e.oldAuction.player.name+"</a>",removeTooltip($("#div_traderAuctioneer .image_140px .detail_button"));var n=$("#div_traderAuctioneer .image_140px .detail_button").attr("title"),a='                        <li class="'+($(".auction_history li:first").hasClass("even")?"odd":"even")+'" style="display: none">                            <a href="javascript:void(0);"                               class="slideIn"                               ref="'+e.oldAuction.item.uuid+'">                                <img height="30" width="30"                                     src="/cdn/img/item-images/'+e.oldAuction.item.imageSmall+'-small.png"                                     alt="" title="'+n+'"                                     class="item_img tooltipHTML tooltipLeft r_'+e.oldAuction.item.rarity+'"/>                            </a>                            <span class="detail sum">'+number_format(e.oldAuction.sum,0)+'</span>                            <span class="detail player">'+i+'</span>                            <span class="detail date_time">'+e.oldAuction.time+"</span>                        </li>";$(".auction_history .history_content ul").prepend(a),$(".auction_history .history_content li:first").slideDown("slow"),$("#div_traderAuctioneer .auction_history li").length>3&&($(".auction_history .history_content li:last").slideUp("slow",(function(){$(".auction_history .history_content li:eq(21)").remove();var t=$(".auction_history .history_content li:eq(3)");t.addClass("more_auctions_li"),auctioneer.historyShown&&t.show()})),$("#div_traderAuctioneer .auction_history .more").show()),$("#div_traderAuctioneer .image_140px .detail_button").attr("ref",e.item.uuid).attr("title","").removeClass("r_common_140px").removeClass("r_uncommon_140px").removeClass("r_rare_140px").removeClass("r_epic_140px").addClass("r_"+e.item.rarity+"_140px"),$("#div_traderAuctioneer .image_140px img").attr("src","/cdn/img/item-images/"+e.item.image+"-140x.png"),$("#div_traderAuctioneer .left_header h2").html(loca.auctionRunning),t.setItemTooltip($("#div_traderAuctioneer .image_140px .detail_button")),t.setData({price:1e3,sum:0,player:null,bids:0,info:e.info}),$("#div_traderAuctioneer .js_alreadyBidden").html(number_format(0,0)),$(".noAuctionOverlay").hide(),traderObj.resetValues("#div_traderAuctioneer",!1),traderObj.checkOverbidden()})),this.socket.on("new bid",(function(e){e.player.id==playerId&&(playerBid=e.sum,AuctionIdOflastPlayerBid=e.auctionId,$("#div_traderAuctioneer .js_alreadyBidden").html(number_format(Math.floor(playerBid),0))),t.setData({price:e.price,sum:e.sum,player:e.player,bids:e.bids}),traderObj.checkOverbidden()})),this.socket.on("auction finished",(function(e){t.setData({price:0,player:e.player,bids:e.bids,info:e.info}),traderObj.resetValues("#div_traderAuctioneer",!1),$("#div_traderAuctioneer .js_alreadyBidden").html(number_format(0,0)),$("#div_traderAuctioneer .js_auctioneerSum").html(""),$("#div_traderAuctioneer .left_header h2").html(loca.auctionFinished),null!=e.player&&e.player.id==playerId&&t.setItemTooltip($("#div_traderAuctioneer .image_140px .detail_button")),$(".noAuctionOverlay").show(),traderObj.checkOverbidden()})),this.socket.on("timeLeft",(function(e){t.setData({info:e})}))}catch(t){}},setItemTooltip:function(t){$.ajax({url:detailUrl,data:{getDetails:1,type:$(t).attr("ref"),ajax:1},dataType:"json",success:function(e){changeTooltip(t,e.title),$("#itemDetails[data-uuid='"+$(t).attr("ref")+"'] .amount,a.detail_button[ref='"+$(t).attr("ref")+"'] .amount").html(tsdpkt(e.amount))},error:function(){fadeBox(loca.error,!0)}})},initialize:function(){"undefined"!=typeof nodeUrl&&(traderObj.initSliderTrader("#div_traderAuctioneer"),traderObj.planets=planetResources,traderObj.price=getValue($(".js_price").html()),$("#div_traderAuctioneer .right_box .pay").bind("click",(function(){traderObj.submitAuction()})),$("#div_traderAuctioneer .auction_history .more").bind("click",(function(){auctioneer.historyShown?$(this).text("["+loca.auctionShowMore+"]"):$(this).text("["+loca.auctionShowLess+"]"),auctioneer.historyShown=!auctioneer.historyShown,$("#div_traderAuctioneer .auction_history .more_auctions_li").slideToggle("slow")})),traderObj.sumAuctioneer(),traderObj.checkOverbidden(),this.initCountdown(),loadScript(nodeUrl,this.initConnection))},retryConnection:function(){var t=this;setTimeout((function(){t.initConnection()}),5e3)},setData:function(t){var e=!1;void 0!==t.player&&(null==t.player?($("#div_traderAuctioneer .detail_value.currentPlayer").text(""),$("#div_traderAuctioneer .detail_value.currentPlayer").attr("href","")):($("#div_traderAuctioneer .detail_value.currentPlayer").text(t.player.name),$("#div_traderAuctioneer .detail_value.currentPlayer").attr("href",t.player.link),$("#div_traderAuctioneer .detail_value.currentPlayer").attr("data-player-id",t.player.id),$("#div_traderAuctioneer .detail_value.currentPlayer").data("playerId",t.player.id)),e=!0),void 0!==t.price&&(traderObj.price=t.price,$("#div_traderAuctioneer .js_price").html(number_format(Math.floor(t.price),0)),e=!0),void 0!==t.sum&&($("#div_traderAuctioneer .detail_value.currentSum").html(number_format(Math.floor(t.sum),0)),e=!0),void 0!==t.bids&&($("#div_traderAuctioneer .detail_value.numberOfBids").html(number_format(t.bids,0)),e=!0),void 0!==t.info&&$.trim($("#div_traderAuctioneer .auction_info").html())!=t.info&&($("#div_traderAuctioneer .auction_info").html(t.info),this.initCountdown(),e=!0),e&&(this.flash(),traderObj.sumAuctioneer())},initCountdown:function(){"object"==typeof this.nextAuctionTimer&&timerHandler.removeCallback(this.nextAuctionTimer.timer),$(".nextAuction").length>0&&(this.nextAuctionTimer=new simpleCountdown($(".nextAuction").get(0),$(".nextAuction").text()))},flash:function(){"#div_traderAuctioneer"==traderObj.traderId&&$("#div_traderAuctioneer .overlay").fadeIn("normal",(function(){$(this).fadeOut("normal")}))},calculateDeficit:function(){var t=0;return t=0==Math.floor(traderObj.price)?0:auctionId!=AuctionIdOflastPlayerBid?Math.floor(traderObj.price):Math.floor(traderObj.price)-Math.floor(playerBid),Math.floor(t)}},$(".js_trader").hover((function(){var t=$(this).attr("id").replace("js_trader","").toLowerCase();$(this).addClass(t+"_link_hover")}),(function(){var t=$(this).attr("id").replace("js_trader","").toLowerCase();$(".trader_link").each((function(e,i){$(this).removeClass(t+"_link_hover")}))})),$(".right_box .pay, .value-control, .ui-slider-handle, .bargain, .scrap_it, .source").hover((function(){$(this).addClass("hover")}),(function(){$(this).removeClass("hover")})),traderObj.init(),$(document).undelegate(".js_trader","click").delegate(".js_trader","click",(function(){var t=$(this).attr("id").replace("js_","");traderObj.switchTrader(t)})).undelegate("#planet .js_backToOverview","click").delegate("#planet .js_backToOverview","click",(function(){$.bbq.pushState({page:"",animation:""}),$(".planetlink, .moonlink").fragment({page:"",animation:""})})),void 0!==(e=$.deparam.fragment()).page&&""!=e.page&&traderObj.selectTrader(e.page,void 0,e.tab)}function Alliance(t){this.tab=t.tab||"",this.token=t.token,this.loca=t.loca,this.tabs=["overview","management","broadcast","applications","classselection","createNewAlliance","handleApplication"],this.initMap={overview:this.initOverview.bind(this),management:this.initManagement.bind(this),applications:this.initApplication.bind(this),broadcast:this.initBroadcast.bind(this),classselection:this.initClasses.bind(this),createNewAlliance:this.initCreateAlliance.bind(this),handleApplication:this.initHandleApplication.bind(this)},this.initMap[this.tab]&&this.initMap[this.tab](t)}function AllianceClassBoxes(t){this.loca=t.loca,this.token=t.token,this.activatingItem=!1,this.ingameUrl=t.ingameUrl,this.init()}Number.prototype.isBetween=function(t,e){return this>=t&&this<=e},Function.prototype.clone=function(){var t=this,e=function(){return t.apply(this,arguments)};for(var i in e.prototype=t.prototype,t)t.hasOwnProperty(i)&&"prototype"!==i&&(e[i]=t[i]);return e},jQuery.fn.slideFadeToggle=function(t,e,i){return this.animate({opacity:"toggle",width:"toggle"},t,e,i)},ogame.tools={addHover:function(t){$(t).on({mouseenter:function(){$(this).addClass("over")},mouseleave:function(){$(this).removeClass("over")}})},scrollToTop:function(){var t=$(".scroll_to_top");$(window).on("scroll.scrollToTop",(function(){$(".scroll_to_top").css({visibility:t.offset().top>window.innerHeight?"visible":"hidden"},600)})),t.on("click.scrollToTop",(function(){$("body, html").animate({scrollTop:0},600)}))}},$((function(){initTooltips()})),Alliance.prototype.displayErrors=function(t){let e=t[0]||void 0;e&&fadeBox(e.message,!0)},Alliance.prototype.initCommon=function(t){this.taskWrapper=$("#alliancecomponent .alliance_wrapper"),this.loadingIndicator=this.taskWrapper.ogameLoadingIndicator(),this.allianceContent=$("#alliancecomponent .allianceContent"),this.titlebar=$("#alliancecomponent #tab-ally"),this.titlebar.on("click",".overview",this.onClickTab.bind(this)),this.titlebar.on("click",".management",this.onClickTab.bind(this)),this.titlebar.on("click",".broadcast",this.onClickTab.bind(this)),this.titlebar.on("click",".applications",this.onClickTab.bind(this)),this.titlebar.on("click",".classselection",this.onClickTab.bind(this))},Alliance.prototype.initCommonWithout=function(t){this.taskWrapper=$("#alliancecomponent .alliance_wrapper"),this.loadingIndicator=this.taskWrapper.ogameLoadingIndicator(),this.allianceContent=$("#alliancecomponent .allianceContent"),this.titlebar=$("#alliancecomponent #tab-ally"),this.titlebar.on("click","#isNewApplication",this.onClickTab.bind(this))},Alliance.prototype.refreshContent=function(t){this.allianceContent.html(t)},Alliance.prototype.onAjaxDone=function(){this.loadingIndicator.hide();let t=this;switch(this.tab){case"createNewAlliance":$("#form_createAlly .createAlly").bind("click",t.onClickCreateAlliance.bind(t)),this.urlCreateAlliance=urlCreateAlliance;break;case"handleApplication":this.urlSendApplication=urlSendApplication,this.urlCancelApplication=urlCancelApplication,$("#writeapplication .sendNewApplication").bind("click",t.onClickSendApplication.bind(t)),$(".bewerbung .cancelApplication").bind("click",t.onClickCancelApplication.bind(t));break;case"overview":$(".kickMemberButton").each((function(){$(this).bind("click",t.onClickKickMember.bind(t))})),$("#kickMemberForm .cancel").bind("click",t.onClickKickMemberCancel.bind(t)),$("#kickMemberForm .submit").bind("click",t.onClickKickMemberSubmit.bind(t)),$("#form_assignRank .assignRank").bind("click",t.onClickAssignRankSubmit.bind(t)),$("#leaveAlly .leaveAlly").bind("click",t.onClickLeaveAlliance.bind(t)),this.urlKickMember=urlKickMember,this.urlSubmitRanks=urlSubmitRanks,this.urlLeaveAlliance=urlLeaveAlliance;break;case"management":$("#form_newRank .createRank").bind("click",t.onClickCreateRank.bind(t)),$("#form_allyRankRights .editRank").bind("click",t.onClickUpdateRank.bind(t)),$(".delete-rank .deleteRank").each((function(){$(this).bind("click",t.onClickDeleteRank.bind(t))})),$("#form_internAllyText .submitText").bind("click",t.onClickUpdateAllianceText.bind(t)),$("#form_externAllyText .submitText").bind("click",t.onClickUpdateAllianceText.bind(t)),$("#form_candidacyText .submitText").bind("click",t.onClickUpdateAllianceText.bind(t)),$("#allySettings .saveSetting").bind("click",t.onClickUpdateSettings.bind(t)),$("#form_newTag .newTag").bind("click",t.onClickSubmitTag.bind(t)),$("#form_newName .newName").bind("click",t.onClickSubmitName.bind(t)),$("#dissolveally .dissolve").bind("click",t.onClickSubmitDisolve.bind(t)),$("#assignally .transferLeadership").bind("click",t.onClickSubmitTransferLeadership.bind(t)),$("#assignally .takeoverLeadership").bind("click",t.onClickSubmitTakeoverLeadership.bind(t)),this.urlCreateRank=urlCreateRank,this.urlUpdateRank=urlUpdateRank,this.urlDeleteRank=urlDeleteRank,this.urlUpdateAllianceText=urlUpdateAllianceText,this.urlUpdateSettings=urlUpdateSettings,this.urlUpdateTag=urlUpdateTag,this.urlUpdateName=urlUpdateName,this.urlDissolve=urlDissolve,this.urlTransferLeadership=urlTransferLeadership,this.urlTakeoverLeadership=urlTakeoverLeadership;break;case"applications":$(".action_icons .action").each((function(){switch($(this).data("type")){case"deny":$(this).bind("click",t.onClickDenyApplication.bind(t));break;case"accept":$(this).bind("click",t.onClickAcceptApplication.bind(t))}})),$(".members form").each((function(){$(this).find(".accept").bind("click",t.onFormClickAcceptApplication.bind(t)),$(this).find(".deny").bind("click",t.onFormClickDenyApplication.bind(t))})),this.urlAccept=urlAccept,this.urlDeny=urlDeny,this.urlReport=urlReport;break;case"broadcast":$("#submitMail").bind("click",t.onFormClickBroadcastButton.bind(t)),this.urlSend=urlSend}},Alliance.prototype.initCreateAlliance=function(t){this.initCommonWithout(t),this.urlCreateAlliance=t.urlCreateAlliance,this.fetchNewAlliance()},Alliance.prototype.initHandleApplication=function(t){this.initCommonWithout(t),this.appliedAllyId=t.appliedAllyId,this.urlSendApplication=t.urlSendApplication,this.urlCancelApplication=t.urlCancelApplication,this.fetchNewApplication()},Alliance.prototype.initOverview=function(t){this.initCommon(t),this.urlKickMember=t.urlKickMember,this.urlSubmitRanks=t.urlSubmitRanks,this.urlLeaveAlliance=t.urlLeaveAlliance,this.fetch(this.tab)},Alliance.prototype.initManagement=function(t){this.initCommon(t),this.urlCreateRank=t.urlCreateRank,this.urlUpdateRank=t.urlUpdateRank,this.urlDeleteRank=t.urlDeleteRank,this.urlUpdateAllianceText=t.urlUpdateAllianceText,this.urlUpdateSettings=t.urlUpdateSettings,this.urlUpdateTag=t.urlUpdateTag,this.urlUpdateName=t.urlUpdateName,this.urlDissolve=t.urlDissolve,this.urlTransferLeadership=t.urlTransferLeadership,this.urlTakeoverLeadership=t.urlTakeoverLeadership,this.fetch(this.tab)},Alliance.prototype.initApplication=function(t){this.initCommon(t),this.urlAccept=t.urlAccept,this.urlDeny=t.urlDeny,this.urlReport=t.urlReport,this.fetch(this.tab)},Alliance.prototype.initBroadcast=function(t){this.initCommon(t),this.urlSend=t.urlSend,this.fetch(this.tab)},Alliance.prototype.initClasses=function(t){this.initCommon(t),this.fetch(this.tab)},Alliance.prototype.onClickCreateRank=function(t){t.preventDefault();let e={rankName:$("#form_newRank #newRankName").val(),_token:this.token};this.loadingIndicator.show(),$.post(this.urlCreateRank,e,this.handleResponse.bind(this)).done(this.onAjaxDone.bind(this))},Alliance.prototype.onClickUpdateRank=function(t){t.preventDefault();let e={_token:this.token};$('#form_allyRankRights input[type="checkbox"]').each((function(){$(this).prop("checked")&&(void 0===e["rankId_"+$(this).data("rankid")]&&(e["rankId_"+$(this).data("rankid")]=0),e["rankId_"+$(this).data("rankid")]=e["rankId_"+$(this).data("rankid")]+$(this).data("rankvalue"))})),this.loadingIndicator.show(),$.post(this.urlUpdateRank,e,this.handleResponse.bind(this)).done(this.onAjaxDone.bind(this))},Alliance.prototype.onClickDeleteRank=function(t){t.preventDefault();let e={rankId:$(t.currentTarget).data("rankid"),_token:this.token};this.loadingIndicator.show(),$.post(this.urlDeleteRank,e,this.handleResponse.bind(this)).done(this.onAjaxDone.bind(this))},Alliance.prototype.onClickUpdateAllianceText=function(t){t.preventDefault();let e={allianceText:$(t.currentTarget).parent().find(".alliancetexts").val(),submitType:$(t.currentTarget).data("type"),_token:this.token};this.loadingIndicator.show(),$.post(this.urlUpdateAllianceText,e,this.handleResponse.bind(this)).done(this.onAjaxDone.bind(this))},Alliance.prototype.onClickUpdateSettings=function(t){t.preventDefault();let e={homepageUrl:$("#allySettings #homepageUrl").val(),logoUrl:$("#allySettings #logoUrl").val(),state:$("#allySettings #state").val(),foundername:$("#allySettings #foundername").val(),newcomerrankname:$("#allySettings #newcomerrankname").val(),language:$("#allySettings #languageSelectionDropdown").val(),_token:this.token};this.loadingIndicator.show(),$.post(this.urlUpdateSettings,e,this.handleResponse.bind(this)).done(this.onAjaxDone.bind(this))},Alliance.prototype.onClickSubmitTag=function(t){t.preventDefault();let e={newTag:$("#form_newTag #newTag").val(),_token:this.token};this.loadingIndicator.show(),$.post(this.urlUpdateTag,e,this.handleResponse.bind(this)).done(this.onAjaxDone.bind(this))},Alliance.prototype.onClickSubmitName=function(t){t.preventDefault();let e={newName:$("#form_newName #newName").val(),_token:this.token};this.loadingIndicator.show(),$.post(this.urlUpdateName,e,this.handleResponse.bind(this)).done(this.onAjaxDone.bind(this))},Alliance.prototype.onClickSubmitDisolve=function(t){t.preventDefault();let e={_token:this.token},i=this;this.loadingIndicator.show(),errorBoxDecision(this.loca.LOCA_ALL_NETWORK_ATTENTION,this.loca.LOCA_NETWORK_ALLY_GIVEUP,this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){$.post(this.urlDissolve,e,i.handleResponse.bind(i)).done(i.onAjaxDone.bind(i))}),(function(){i.loadingIndicator.hide()}))},Alliance.prototype.onClickSubmitTransferLeadership=function(t){t.preventDefault();let e={newLeaderId:$("#assignally #newLeaderId").val(),_token:this.token},i=this;this.loadingIndicator.show(),errorBoxDecision(this.loca.LOCA_ALL_NETWORK_ATTENTION,this.loca.LOCA_NETWORK_ALLY_TAKEOVER_ARE_YOU_SURE,this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){$.post(this.urlTransferLeadership,e,i.handleResponse.bind(i)).done(i.onAjaxDone.bind(i))}),(function(){i.loadingIndicator.hide()}))},Alliance.prototype.onClickSubmitTakeoverLeadership=function(t){t.preventDefault();let e={_token:this.token},i=this;this.loadingIndicator.show(),errorBoxDecision(this.loca.LOCA_ALL_NETWORK_ATTENTION,this.loca.LOCA_ALLY_TAKEOVER_QUESTION,this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){$.post(this.urlTakeoverLeadership,e,i.handleResponse.bind(i)).done(i.onAjaxDone.bind(i))}),(function(){i.loadingIndicator.hide()}))},Alliance.prototype.onClickLeaveAlliance=function(t){t.preventDefault();let e={_token:this.token},i=this;this.loadingIndicator.show(),errorBoxDecision(this.loca.LOCA_ALL_NETWORK_ATTENTION,this.loca.locaAllyLeaveQuestion,this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){$.post(this.urlLeaveAlliance,e,i.handleResponse.bind(i)).done(i.onAjaxDone.bind(i))}),(function(){i.loadingIndicator.hide()}))},Alliance.prototype.onClickKickMember=function(t){t.preventDefault(),$("#kickMemberReasonText").val("");let e=$(t.currentTarget).attr("id").split("-")[1];$("#kickMemberId").val(e)},Alliance.prototype.onClickKickMemberCancel=function(t){t.preventDefault(),$("#kickMemberReason").dialog("destroy")},Alliance.prototype.onClickKickMemberSubmit=function(t){t.preventDefault();let e=$("#kickMemberId").val(),i=$("#kickMemberReasonText").val();this.submitKickMember(e,i),$("#kickMemberReason").dialog("destroy")},Alliance.prototype.onClickAssignRankSubmit=function(t){t.preventDefault();let e={};$('select[name^="memberRanks"]').each((function(){e[$(this).attr("id")]=$(this).val()})),this.submitRanks(e)},Alliance.prototype.submitRanks=function(t){let e={_token:this.token,memberRanks:t};this.loadingIndicator.show(),$.post(this.urlSubmitRanks,e,this.handleResponse.bind(this)).done(this.onAjaxDone.bind(this))},Alliance.prototype.onClickCreateAlliance=function(){let t={createTag:$("#allyTagField").val(),createName:$("#allyNameField").val(),_token:this.token};this.loadingIndicator.show(),$.post(this.urlCreateAlliance,t,this.handleResponse.bind(this)).done(this.onAjaxDone.bind(this))},Alliance.prototype.onClickSendApplication=function(t){t.preventDefault();let e=$("#writeapplication .alliancetexts").val(),i={allianceId:this.appliedAllyId,applicationText:e,_token:this.token};this.loadingIndicator.show(),$.post(this.urlSendApplication,i,this.handleResponse.bind(this)).done(this.onAjaxDone.bind(this))},Alliance.prototype.onClickCancelApplication=function(t){t.preventDefault();let e={_token:this.token};this.loadingIndicator.show(),$.post(this.urlCancelApplication,e,this.handleResponse.bind(this)).done(this.onAjaxDone.bind(this))},Alliance.prototype.submitKickMember=function(t,e){let i={playerId:t,reasonText:e,_token:this.token};this.loadingIndicator.show(),$.post(this.urlKickMember,i,this.handleResponse.bind(this)).done(this.onAjaxDone.bind(this))},Alliance.prototype.onClickNewAlly=function(t){t.preventDefault(),"disabled"!==$(t.currentTarget).parent().attr("disabled")&&this.fetchNewAlliance()},Alliance.prototype.onClickTab=function(t){t.preventDefault(),"disabled"!==$(t.currentTarget).parent().attr("disabled")&&(this.tab=$(t.currentTarget).data("tab"),this.fetch(this.tab))},Alliance.prototype.fetchNewApplication=function(){this.tab="handleApplication",this.loadingIndicator.show();let t={_token:this.token,appliedAllyId:this.appliedAllyId},e=$("#alliancecomponent #isNewApplication").attr("rel");$.getJSON(e,t,this.onFetch.bind(this)).done(this.onAjaxDone.bind(this))},Alliance.prototype.fetchNewAlliance=function(){this.tab="createNewAlliance",this.loadingIndicator.show();let t={_token:this.token},e=$("#alliancecomponent .createNewAlliance").attr("rel");$.getJSON(e,t,this.onFetch.bind(this)).done(this.onAjaxDone.bind(this))},Alliance.prototype.fetch=function(t){let e=$("#alliancecomponent ."+t);if(""!==e.attr("rel")){this.loadingIndicator.show();let i={_token:this.token};$.getJSON(e.attr("rel"),i,this.onFetch.bind(this)).done(this.onAjaxDone.bind(this)),this.tabs.forEach((function(e){let i=$("#alliancecomponent #tab-ally ."+e).parent();i.removeClass("aktiv"),e===t&&i.addClass("aktiv")}))}},Alliance.prototype.onFetch=function(t){let e=t.content[t.target];this.updateToken(t.newAjaxToken),this.refreshContent(e)},Alliance.prototype.updateToken=function(t){this.token=t,token=t},Alliance.prototype.refreshTabs=function(t){t.applications.applicationCount>=1?($("."+t.applications.tab+" #applicationTab").removeClass("undermark").addClass("undermark"),$("."+t.applications.tab+" #applicationTab span").removeClass("undermark").addClass("undermark").html("("+t.applications.applicationCount+")")):($("."+t.applications.tab+" #applicationTab").removeClass("undermark"),$("."+t.applications.tab+" #applicationTab span").removeClass("undermark").html(""))},Alliance.prototype.onClickDenyApplication=function(t){t.preventDefault();let e=$(t.currentTarget).data("playerid");this.submitDenyApplication(e)},Alliance.prototype.submitDenyApplication=function(t){let e={playerId:t,_token:this.token};this.loadingIndicator.show(),$.post(this.urlDeny,e,this.handleResponse.bind(this)).done(this.onAjaxDone.bind(this))},Alliance.prototype.onFormClickDenyApplication=function(t){t.preventDefault();let e={playerId:$(t.currentTarget).data("playerid"),reasonText:$(t.currentTarget).closest("form").find(".alliancetexts").val(),_token:this.token};this.loadingIndicator.show(),$.post(this.urlDeny,e,this.handleResponse.bind(this)).done(this.onAjaxDone.bind(this))},Alliance.prototype.onClickAcceptApplication=function(t){t.preventDefault();let e=$(t.currentTarget).data("playerid");this.submitAcceptApplication(e)},Alliance.prototype.submitAcceptApplication=function(t){let e={playerId:t,_token:this.token};this.loadingIndicator.show(),$.post(this.urlAccept,e,this.handleResponse.bind(this)).done(this.onAjaxDone.bind(this))},Alliance.prototype.onFormClickAcceptApplication=function(t){t.preventDefault();let e={playerId:$(t.currentTarget).data("playerid"),reasonText:$(t.currentTarget).closest("form").find(".alliancetexts").val(),_token:this.token};this.loadingIndicator.show(),$.post(this.urlAccept,e,this.handleResponse.bind(this)).done(this.onAjaxDone.bind(this))},Alliance.prototype.handleResponse=function(t){let e=JSON.parse(t),i=e.status||"failure";this.updateToken(e.newAjaxToken),"success"===i?void 0!==e.redirectUrl?window.location=e.redirectUrl:(void 0!==e.tabs&&this.refreshTabs(e.tabs),fadeBox(e.message,!1),getAjaxEventbox(),getAjaxResourcebox(),this.fetch(this.tab)):(void 0!==e.tabs&&this.refreshTabs(e.tabs),this.displayErrors(e.errors))},Alliance.prototype.onFormClickBroadcastButton=function(t){t.preventDefault();let e={rankIds:$("#selectNew").val(),broadcastText:$("#allianceBroadCast").find(".alliancetexts").val(),_token:this.token};this.loadingIndicator.show(),$.post(this.urlSend,e,this.handleResponse.bind(this)).done(this.onAjaxDone.bind(this))},$((function(){$(document).on("click","[data-homepage-link]",(function(t){t.preventDefault(),errorBoxDecision(LocalizationStrings.attention,LocalizationStrings.redirectMessage,LocalizationStrings.yes,LocalizationStrings.no,(function(){window.open("redir.php?url="+encodeURIComponent(allyHome),"_newtab")}),!1,!1)}))})),AllianceClassBoxes.prototype.init=function(){$(document).on("click",".allianceclass.boxes .buttons .freeselect",this.onClickFreeSelect.bind(this)),$(document).on("click",".allianceclass.boxes .buttons .darkmatter",this.onClickDarkMatter.bind(this)),$(document).on("click",".allianceclass.boxes .buttons .deactivate",this.onClickDeactivate.bind(this)),$(document).on("click",".allianceclass.boxes .buttons .nodarkmatter",this.onClickNoDarkMatter.bind(this)),$(document).on("click",".allianceclass.boxes .buttons .classchangeitem",this.onClickClassChangeItem.bind(this))},AllianceClassBoxes.prototype.hasActiveSelection=function(){return $(".allianceclass.box.selected").length>0},AllianceClassBoxes.prototype.executeActionWithRedirect=function(t){let e={_token:token};$.post(t,e,this.handleResponse.bind(this))},AllianceClassBoxes.prototype.onClickFreeSelect=function(t){let e=this,i=$(t.currentTarget).attr("rel"),n=$(t.currentTarget).closest(".allianceclass.box").data("allianceClassName");1!==$(t.currentTarget).data("disabled")&&this.fetchDataAboutCurrentAllianceClass(n,(function(){e.executeActionWithRedirect(i)}),"",0)},AllianceClassBoxes.prototype.onClickDarkMatter=function(t){let e=this,i=$(t.currentTarget).attr("rel"),n=$(t.currentTarget).closest(".allianceclass.box"),a=n.data("allianceClassName"),s=n.data("allianceClassPrice");1!==$(t.currentTarget).data("disabled")&&this.fetchDataAboutCurrentAllianceClass(a,(function(){e.executeActionWithRedirect(i)}),"buyAndActivateItemQuestion",s)},AllianceClassBoxes.prototype.onClickNoDarkMatter=function(t){$(t.currentTarget).attr("rel");1!==$(t.currentTarget).data("disabled")&&errorBoxDecision(this.loca.LOCA_ALL_NOTICE,this.loca.LOCA_ALL_ERROR_LACKING_DM,this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,redirectPremium)},AllianceClassBoxes.prototype.onClickDeactivate=function(t){let e=this,i=$(t.currentTarget).attr("rel"),n=$(t.currentTarget).closest(".allianceclass.box").data("allianceClassName"),a=this.loca.LOCA_ALLIANCE_CLASS_NOTE_DEACTIVATE.replace("#allianceClassName#",n);1!==$(t.currentTarget).data("disabled")&&errorBoxDecision(this.loca.LOCA_ALL_NOTICE,a,this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){e.executeActionWithRedirect(i)}))},AllianceClassBoxes.prototype.onClickClassChangeItem=function(t){let e=this,i=$(t.currentTarget).attr("rel"),n=$(t.currentTarget).closest(".allianceclass.box").data("allianceClassName");1!==$(t.currentTarget).data("disabled")&&this.fetchDataAboutCurrentAllianceClass(n,(function(){let t={_token:token};$.post(i,t).done((function(t){var i=$.parseJSON(t);token=i.newAjaxToken,"success"===i.status?window.location.reload():e.displayErrors(i)}))}),"activateItemQuestion",null)},AllianceClassBoxes.prototype.displayErrors=function(t){let e=t[0]||void 0;e&&fadeBox(e.message,!0)},AllianceClassBoxes.prototype.handleResponse=function(t){let e=JSON.parse(t),i=e.status||"failure";token=e.newAjaxToken,alliance.updateToken(e.newAjaxToken),"success"===i?void 0!==e.redirectUrl?window.location=e.redirectUrl:(void 0!==e.tabs&&alliance.refreshTabs(e.tabs),fadeBox(e.message,!1),getAjaxEventbox(),getAjaxResourcebox(),this.fetch(this.tab)):(void 0!==e.tabs&&alliance.refreshTabs(e.tabs),this.displayErrors(e.errors))},AllianceClassBoxes.prototype.fetchDataAboutCurrentAllianceClass=function(t,e,i,n){if(!this.activatingItem){this.activatingItem=!0;let a=this;$.ajax({url:this.ingameUrl,type:"GET",data:{component:"allianceclassselection",action:"fetchDataAboutCurrentAllianceClass",ajax:1,asJson:1},dataType:"json",error:function(s){a.promptUserForAllianceClassChange(t,e,i,n)},success:function(s){a.promptUserForAllianceClassChange(t,e,i,n,s)}})}},AllianceClassBoxes.prototype.promptUserForAllianceClassChange=function(t,e,i,n,a){if(this.activatingItem=!1,a.userDoesNotHaveAlliance)return 0;let s=this.loca.LOCA_ALLIANCE_CLASS_NOTE_ACTIVATE_WITH_ITEM;"buyAndActivateItemQuestion"===i&&(s=this.loca.LOCA_ALLIANCE_CLASS_NOTE_ACTIVATE_WITH_DM),s=s.replace("#allianceClassName#",t),"buyAndActivateItemQuestion"===i&&(s=s.replace("#darkmatter#",tsdpkt(n))),a&&a.currentAllianceClass&&a.dateOfLastAllianceClassChange&&(s+=this.loca.LOCA_ALLIANCE_CLASS_NOTE_ACTIVATE_APPEND_CURRENT_CLASS,s=s.replace("#currentAllianceClassName#",a.currentAllianceClass),s=s.replace("#lastAllianceClassChange#",a.dateOfLastAllianceClassChange)),errorBoxDecision(LocalizationStrings.notice,s,LocalizationStrings.yes,LocalizationStrings.no,e)};let buildListActionCalled=!1;function buildListActionBuild(t,e,i,n,a){if("undefined"==typeof scheduleBuildListEntryUrl)return;if(buildListActionCalled)return;buildListActionCalled=!0;let s={technologyId:t,amount:e||1,mode:i||1,_token:token};0!==$(".shipyardSelection .radioShipyardSelection").length&&(s.selectedShipyard=parseInt($(".shipyardSelection .radioShipyardSelection:checked").val())),n&&(s.buyWithDmAmount=n),a&&(s.planetId=a),$.ajax({url:scheduleBuildListEntryUrl,data:s,type:"POST",dataType:"json",success:function(t){"success"===t.status?(t.message&&fadeBox(t.message),window.location.reload()):(token=t.newAjaxToken,t.errors&&t.errors.length&&fadeBox(t.errors[0].message,!0),buildListActionCalled=!1)},error:function(){"undefined"!=typeof LOCA_ERROR_INQUIRY_NOT_WORKED_TRYAGAIN&&LOCA_ERROR_INQUIRY_NOT_WORKED_TRYAGAIN&&fadeBox(LOCA_ERROR_INQUIRY_NOT_WORKED_TRYAGAIN,!0),buildListActionCalled=!1}})}function buildListActionDemolish(t,e){if("undefined"==typeof scheduleBuildListEntryUrl)return;if(buildListActionCalled)return;buildListActionCalled=!0;let i={technologyId:t,mode:3,_token:token};e&&(i.planetId=e),$.ajax({url:scheduleBuildListEntryUrl,data:i,type:"POST",dataType:"json",success:function(t){"success"===t.status?(t.message&&fadeBox(t.message),window.location.reload()):(token=t.newAjaxToken,t.errors&&t.errors.length&&fadeBox(t.errors[0].message,!0),buildListActionCalled=!1)},error:function(){"undefined"!=typeof LOCA_ERROR_INQUIRY_NOT_WORKED_TRYAGAIN&&LOCA_ERROR_INQUIRY_NOT_WORKED_TRYAGAIN&&fadeBox(LOCA_ERROR_INQUIRY_NOT_WORKED_TRYAGAIN,!0),buildListActionCalled=!1}})}function buildListActionCancel(t,e,i){if("undefined"==typeof cancelBuildListEntryUrl)return;if(buildListActionCalled)return;buildListActionCalled=!0;let n={technologyId:t,listId:e,_token:token};i&&(n.planetId=i),$.ajax({url:cancelBuildListEntryUrl,data:n,type:"POST",dataType:"json",success:function(t){"success"===t.status?(t.message&&fadeBox(t.message),window.location.reload()):(token=t.newAjaxToken,t.errors&&t.errors.length&&fadeBox(t.errors[0].message,!0),buildListActionCalled=!1)},error:function(){"undefined"!=typeof LOCA_ERROR_INQUIRY_NOT_WORKED_TRYAGAIN&&LOCA_ERROR_INQUIRY_NOT_WORKED_TRYAGAIN&&fadeBox(LOCA_ERROR_INQUIRY_NOT_WORKED_TRYAGAIN,!0),buildListActionCalled=!1}})}function CharacterClassBoxes(t){this.loca=t.loca,this.init()}function initExpeditionFleetTemplate(){$(".list tr:even").addClass("alt"),$("#expeditionFleetTemplateResetForm").on("click",(function(t){t.preventDefault(),resetExpedtionFleetTemplateForm()}))}function selectShipsPerFleet(t){$("#expeditionFleetTemplateSelect").ogameDropDown("destroy"),$("#expeditionFleetTemplateSelect").ogameDropDown(),$("#expeditionFleetTemplateSelect").ogameDropDown("select",t),$("#expeditionFleetTemplateSelect").val(t).trigger("change"),$("#expeditionFleetTemplates").parents(".ui-dialog").find(".ui-dialog-titlebar-close").click()}CharacterClassBoxes.prototype.init=function(){$(document).on("click",".characterclass.boxes .buttons .freeselect",this.onClickFreeSelect.bind(this)),$(document).on("click",".characterclass.boxes .buttons .darkmatter",this.onClickDarkMatter.bind(this)),$(document).on("click",".characterclass.boxes .buttons .deactivate",this.onClickDeactivate.bind(this)),$(document).on("click",".characterclass.boxes .buttons .nodarkmatter",this.onClickNoDarkMatter.bind(this)),$(document).on("click",".characterclass.boxes .buttons .classchangeitem",this.onClickClassChangeItem.bind(this))},CharacterClassBoxes.prototype.hasActiveSelection=function(){return $(".characterclass.box.selected").length>0},CharacterClassBoxes.prototype.executeActionWithRedirect=function(t){let e=this;$.post(t).done((function(t){var i=$.parseJSON(t);"success"===i.status?fadeBox(i.message,!1,(function(){window.location.replace(i.redirectUrl)}),2e3):e.displayErrors(i)}))},CharacterClassBoxes.prototype.onClickFreeSelect=function(t){let e=this,i=$(t.currentTarget).attr("rel");$.post(i).done((function(t){var i=$.parseJSON(t);"success"===i.status?fadeBox(i.message,!1,(function(){window.location.replace(i.redirectUrl)}),2e3):e.displayErrors(i)}))},CharacterClassBoxes.prototype.onClickDarkMatter=function(t){let e=this,i=$(t.currentTarget).attr("rel"),n=$(t.currentTarget).closest(".characterclass.box"),a=n.data("characterClassName"),s=n.data("characterClassPrice"),o=this.loca.LOCA_CHARACTER_CLASS_NOTE_ACTIVATE_WITH_DM.replace("#characterClassName#",a).replace("#darkmatter#",tsdpkt(s));errorBoxDecision(this.loca.LOCA_ALL_NOTICE,o,this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){e.executeActionWithRedirect(i)}))},CharacterClassBoxes.prototype.onClickNoDarkMatter=function(t){$(t.currentTarget).attr("rel");errorBoxDecision(this.loca.LOCA_ALL_NOTICE,this.loca.LOCA_ALL_ERROR_LACKING_DM,this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,redirectPremium)},CharacterClassBoxes.prototype.onClickDeactivate=function(t){let e=this,i=$(t.currentTarget).attr("rel"),n=$(t.currentTarget).closest(".characterclass.box").data("characterClassName"),a=this.loca.LOCA_CHARACTER_CLASS_NOTE_DEACTIVATE.replace("#characterClassName#",n);errorBoxDecision(this.loca.LOCA_ALL_NOTICE,a,this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){e.executeActionWithRedirect(i)}))},CharacterClassBoxes.prototype.onClickClassChangeItem=function(t){let e=this,i=$(t.currentTarget).attr("rel"),n=$(t.currentTarget).closest(".characterclass.box").data("characterClassName"),a=this.loca.LOCA_CHARACTER_CLASS_NOTE_ACTIVATE_WITH_ITEM.replace("#characterClassName#",n);errorBoxDecision(this.loca.LOCA_ALL_NOTICE,a,this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){let t={_token:token};$.post(i,t).done((function(t){var i=$.parseJSON(t);token=i.newAjaxToken,"success"===i.status?window.location.reload():e.displayErrors(i)}))}))},CharacterClassBoxes.prototype.displayErrors=function(t){t.errorCode;fadeBox(t.errorMessage||t.message||"",!0)};var editingTemplate=!1;function saveExpeditionFleetTemplate(t){if(t.preventDefault(),editingTemplate)return;editingTemplate=!0;let e=$("#expeditionFleetTemplateForm").serialize();e+=`&token=${token}`,e+="&action=saveExpeditionTemplate",$.ajax({url:fleetTemplateUrl,type:"POST",data:e,dataType:"json",success:function(t){"success"===t.status?(showNotification(t.message,"success"),$("#expeditionFleetTemplateForm").parents(".ui-dialog").find(".ui-dialog-titlebar-close").click(),$('div.ui-dialog[aria-describedby="expeditionFleetTemplatesEdit"]').remove(),updateExpeditionFleetTemplates(t.expeditionFleetTemplates),reloadComponent("expeditionfleettemplate")):showNotification(t.errors[0].message,"error"),token=t.newAjaxToken,editingTemplate=!1},error:function(t){window.location.reload()}})}function deleteExpeditionFleetTemplate(t){editingTemplate||(editingTemplate=!0,$.ajax({url:fleetTemplateUrl,type:"POST",data:{action:"deleteExpeditionTemplate",expeditionFleetTemplateId:t,_token:token},dataType:"json",success:function(t){"success"===t.status?(showNotification(t.message,"success"),$('div.ui-dialog[aria-describedby="expeditionFleetTemplatesEdit"]').length&&($("#expeditionFleetTemplateForm").parents(".ui-dialog").find(".ui-dialog-titlebar-close").click(),$('div.ui-dialog[aria-describedby="expeditionFleetTemplatesEdit"]').remove()),updateExpeditionFleetTemplates(t.expeditionFleetTemplates),reloadComponent("expeditionfleettemplate")):showNotification(t.errors[0].message,"error"),token=t.newAjaxToken,editingTemplate=!1},error:function(t){window.location.reload()}}))}function updateExpeditionFleetTemplates(t){expeditionFleetTemplates=t,$("#expeditionFleetTemplateSelect").ogameDropDown("destroy"),$("#expeditionFleetTemplateSelect option").each(((t,e)=>{"0"!==e.value&&$(e).remove()})),t.map((t=>{$("#expeditionFleetTemplateSelect").append(`<option value="${t.id}">${t.name}</option>`)})),$("#expeditionFleetTemplateSelect").ogameDropDown(),$("#expeditionFleetTemplateSelect").val("0").trigger("change")}function resetExpedtionFleetTemplateForm(){$("#expeditionFleetTemplateForm")[0].reset(),$("#expeditionFleetTemplateHoldingTimeSelect").val("1").ogameDropDown("select","1"),$("#expeditionFleetTemplateSpeedSelect").val("100").ogameDropDown("select","100")}function setExpeditionFleetTemplateShips(t,e,i,n,a){$("#expeditionFleetTemplateForm")[0].reset(),$("#expeditionFleetTemplateId").val(i),$("#expeditionFleetTemplateName").val(e);for(let e in t)$("#expeditionFleetTemplateShip_"+e).val(t[e]);$("#expeditionFleetTemplateHoldingTimeSelect").val(n.toString()).ogameDropDown("select",n.toString()),$("#expeditionFleetTemplateSpeedWarning").css({display:"none"}),-1===allowedSpeedsInExpeditionTemplate.indexOf(a)&&$("#expeditionFleetTemplateSpeedWarning").css({display:"flex"});let s=allowedSpeedsInExpeditionTemplate.find((t=>t>=a));$("#expeditionFleetTemplateSpeedSelect").val(s.toString()).ogameDropDown("select",s.toString())}function reinitializeExpeditionFleetTemplateOGameDropdown(){$("#expeditionFleetTemplateForm select").ogameDropDown("destroy"),$("#expeditionFleetTemplateForm span.dropdown.currentlySelected").remove(),$("#expeditionFleetTemplateForm select").ogameDropDown()}const FLEET_DISPATCH_PAGE1="fleet1",FLEET_DISPATCH_PAGE2="fleet2";function getResourcesFromHeader(t){let e=$("#resources_"+t).data("raw");return parseInt(e)}function getKeyCode(t){return window.event?window.event.keyCode:t?t.which:null}function FleetDispatcher(t){this.fleetHelper=new FleetHelper(t),this.loading=!1,this.lifeformEnabled=t.lifeformEnabled,this.checkTargetUrl=t.checkTargetUrl,this.sendFleetUrl=t.sendFleetUrl,this.saveSettingsUrl=t.saveSettingsUrl,this.fleetBoxOrder=t.fleetBoxOrder||{},this.token=t.token||null,this.currentPlanet=t.currentPlanet,this.targetPlanet=t.targetPlanet||null,this.targetInhabited=t.targetInhabited||!1,this.targetPlayerId=t.targetPlayerId||this.fleetHelper.PLAYER_ID_SPACE,this.targetPlayerName=t.targetPlayerName||"",this.targetPlayerColorClass=t.targetPlayerColorClass||"",this.targetPlayerRankIcon=t.targetPlayerRankIcon||"",this.cargoCapacity=t.cargoCapacity,this.fuelCapacity=t.fuelCapacity,this.currentPage=FLEET_DISPATCH_PAGE1,this.shipsOnPlanet=t.shipsOnPlanet||[],this.shipsToSend=t.shipsToSend||[],this.useHalfSteps=t.useHalfSteps||!1,this.planets=t.planets||[],this.standardFleets=t.standardFleets||[],this.expeditionFleetTemplates=t.expeditionFleetTemplates||[],this.unions=t.unions||[],this.orders=[],this.orderNames=t.orderNames||[],this.orderDescriptions=t.orderDescriptions||[],this.mission=t.mission||this.fleetHelper.MISSION_NONE,this.union=0,this.targetIsStrong=!1,this.targetIsOutlaw=!1,this.targetIsBuddyOrAllyMember=!1,this.playerIsOutlaw=!1,this.retreatAfterDefenderRetreat=!1,this.lootFoodOnAttack=t.lootFoodOnAttack,this.holdingTime=t.holdingTime,this.expeditionTime=t.expeditionTime,this.speedPercent=10,this.cargoMetal=0,this.cargoCrystal=0,this.cargoDeuterium=0,this.cargoFood=0,this.prioMetal=t.LOOT_PRIO_METAL,this.prioCrystal=t.LOOT_PRIO_CRYSTAL,this.prioDeuterium=t.LOOT_PRIO_DEUTERIUM,this.prioFood=t.LOOT_PRIO_FOOD,this.metalOnPlanet=t.metalOnPlanet,this.crystalOnPlanet=t.crystalOnPlanet,this.deuteriumOnPlanet=t.deuteriumOnPlanet,this.foodOnPlanet=0,this.lifeformEnabled&&(this.foodOnPlanet=t.foodOnPlanet),this.fleetCount=t.fleetCount,this.maxFleetCount=t.maxFleetCount,this.expeditionCount=t.expeditionCount,this.maxExpeditionCount=t.maxExpeditionCount,this.warningsEnabled=t.warningsEnabled,this.playerId=t.playerId,this.hasAdmiral=t.hasAdmiral,this.hasCommander=t.hasCommander,this.isOnVacation=t.isOnVacation,this.moveInProgress=t.moveInProgress,this.planetCount=t.planetCount,this.explorationCount=t.explorationCount,this.apiDataJson=t.apiDataJson,this.apiCommonData=t.apiCommonData,this.apiTechData=t.apiTechData,this.apiDefenseData=t.apiDefenseData,this.apiShipBaseData=t.apiShipBaseData,this.loca=t.loca,this.locadyn=t.locadyn,this.errorCodeMap=t.errorCodeMap,this.urlFleetCheck=t.urlFleetCheck,this.additionalFlightSpeed=0,this.timerTimes=null,this.fetchTargetPlayerDataTimeout=null,this.deferred=[],this.emptySystems=t.emptySystems,this.inactiveSystems=t.inactiveSystems}function FleetHelper(t){this.shipsData=t.shipsData,this.COLONIZATION_ENABLED=t.COLONIZATION_ENABLED,this.MAX_NUMBER_OF_PLANETS=t.MAX_NUMBER_OF_PLANETS,this.PLAYER_ID_LEGOR=t.PLAYER_ID_LEGOR,this.PLAYER_ID_SPACE=t.PLAYER_ID_SPACE,this.MISSION_NONE=t.missions.MISSION_NONE,this.MISSION_ATTACK=t.missions.MISSION_ATTACK,this.MISSION_UNIONATTACK=t.missions.MISSION_UNIONATTACK,this.MISSION_TRANSPORT=t.missions.MISSION_TRANSPORT,this.MISSION_DEPLOY=t.missions.MISSION_DEPLOY,this.MISSION_HOLD=t.missions.MISSION_HOLD,this.MISSION_ESPIONAGE=t.missions.MISSION_ESPIONAGE,this.MISSION_COLONIZE=t.missions.MISSION_COLONIZE,this.MISSION_RECYCLE=t.missions.MISSION_RECYCLE,this.MISSION_DESTROY=t.missions.MISSION_DESTROY,this.MISSION_MISSILEATTACK=t.missions.MISSION_MISSILEATTACK,this.MISSION_EXPEDITION=t.missions.MISSION_EXPEDITION,this.DONUT_GALAXY=t.DONUT_GALAXY,this.DONUT_SYSTEM=t.DONUT_SYSTEM,this.MAX_GALAXY=t.MAX_GALAXY,this.MAX_SYSTEM=t.MAX_SYSTEM,this.MAX_POSITION=t.MAX_POSITION,this.EXPEDITION_POSITION=t.EXPEDITION_POSITION,this.SPEEDFAKTOR_FLEET_PEACEFUL=t.SPEEDFAKTOR_FLEET_PEACEFUL,this.SPEEDFAKTOR_FLEET_WAR=t.SPEEDFAKTOR_FLEET_WAR,this.SPEEDFAKTOR_FLEET_HOLDING=t.SPEEDFAKTOR_FLEET_HOLDING,this.FLEET_DEUTERIUM_SAVE_FACTOR=t.FLEET_DEUTERIUM_SAVE_FACTOR,this.PLANETTYPE_PLANET=t.PLANETTYPE_PLANET,this.PLANETTYPE_DEBRIS=t.PLANETTYPE_DEBRIS,this.PLANETTYPE_MOON=t.PLANETTYPE_MOON}var cancelProduction_id,production_listid;function cancelProduction(t,e,i){cancelProduction_id=t,production_listid=e,errorBoxDecision(loca.LOCA_ALL_NETWORK_ATTENTION,""+i,loca.LOCA_ALL_YES,loca.LOCA_ALL_NO,cancelProductionStart)}function cancelProductionStart(){window.location.replace(urlCancleBuilding+"&techid="+cancelProduction_id+"&listid="+production_listid)}function submitOnKey(t){selectShipsPerFleet("0"),"ArrowLeft"===t?(system=system>1?parseInt(system)-1:maxSystems,isMobile?loadContent(galaxy,system):loadContentNew(galaxy,system)):"ArrowRight"===t?(system=system<maxSystems?parseInt(system)+1:1,isMobile?loadContent(galaxy,system):loadContentNew(galaxy,system)):"ArrowDown"===t?(galaxy=galaxy>1?parseInt(galaxy)-1:maxGalaxies,isMobile?loadContent(galaxy,system):loadContentNew(galaxy,system)):"ArrowUp"===t&&(galaxy=galaxy<maxGalaxies?parseInt(galaxy)+1:1,isMobile?loadContent(galaxy,system):loadContentNew(galaxy,system))}function keyevent(t){let e,i=$(":focus");return!!i.closest(".ui-dialog").length||(!!i.closest(".chat_box_textarea").length||(!t||(e=t.key,void submitOnKey(e))))}function launchMissiles(t){var e=$.parseJSON(t);token=e.newAjaxToken,updateOverlayToken("phalanxSystemDialog",e.newAjaxToken),updateOverlayToken("phalanxDialog",e.newAjaxToken),e.status&&($("#missileValue").html(e.rockets),getAjaxEventbox()),errorBoxAsArray(e.errorbox),$("#rocketattack").closest(".ui-dialog-content").remove()}function movePlanet(t,e,i){errorBoxDecision(galaxyLoca.questionTitle,galaxyLoca.question,LocalizationStrings.yes,LocalizationStrings.no,(function(){$.post(t,e,(function(t){""==t.error?(fadeBox(galaxyLoca.reservationSuccess,!1),setTimeout('reload_page("'+i+'")',3e3)):fadeBox(t.error,!0)}),"json")}))}function discoverPlanet(t,e,i=(()=>{})){const n=()=>{$.post(t,e,(function(t){token=t.newAjaxToken,void 0!==t.response.success&&!0===t.response.success&&(getAjaxEventbox(),i(),getAjaxResourcebox()),displayMiniFleetMessage(t.response);Array.from(document.getElementsByClassName("planetDiscover")).forEach((e=>{if(e.classList.contains("position"+t.response.coordinates.position))return;if(!0!==t.response.discovery.canSendDiscovery)return void $(e).replaceWith(`\n                        <div class="planetDiscoverIcons planetDiscoverUnavailable tooltip icon js_hideTipOnMobile"\n                            title="${t.response.discovery.canSendDiscovery}">\n                        </div>\n                    `);const i=galaxyLoca.discoverySend+" "+t.response.discovery.discoveryCount;e.title=i,changeTooltip(e,i)}));$(".planetDiscover.position"+t.response.coordinates.position).replaceWith(`<div class="planetDiscoverIcons planetDiscoverUnavailable tooltip icon js_hideTipOnMobile"\n                    title="${galaxyLoca.discoveryUnderway}">\n                </div>`),document.getElementById("galaxyHeaderDiscoveryCount").innerHTML=t.response.discovery.galaxyHeader.LOCA_GALAXY_LIFEFORM_DISCOVERY_COUNT}),"json")};showDiscoveryWarning?errorBoxDecision(galaxyLoca.discoverQuestionTitle,galaxyLoca.discoverQuestionText,LocalizationStrings.yes,LocalizationStrings.no,n):n()}FleetDispatcher.prototype.init=function(){this.initFleet1(),this.initFleet2();let t=this;$((function(){$(".sortable").sortable({handle:".move-box",tolerance:"pointer",revert:!0,update:function(e,i){a=$("#fleet2 #buttonz > div"),param={},t.appendTokenParams(param);for(let t=0;t<a.length;t++)param[a[t].id]=t;$.post(t.saveSettingsUrl,param,(function(e){e=JSON.parse(e),t.updateToken(e.newAjaxToken),token=e.newAjaxToken}))}}),$(".sortable").disableSelection()})),$("#fleetdispatchcomponent").on("keypress",(async function(e){if(13===getKeyCode(e))return e.preventDefault(),e.stopPropagation(),$("#fleet1").is(":visible")?(await new Promise(((t,e)=>setTimeout((()=>t()),250))),t.trySubmitFleet1()):$("#fleet2").is(":visible")&&(t.fetchTargetPlayerDataTimeout||(await new Promise(((t,e)=>setTimeout((()=>t()),250))),t.trySubmitFleet2())),!1}))},FleetDispatcher.prototype.displayErrors=function(t){let e=t[0]||void 0;e&&fadeBox(e.message,!0)},FleetDispatcher.prototype.refresh=function(){switch(this.currentPage){case FLEET_DISPATCH_PAGE1:this.refreshFleet1();break;case FLEET_DISPATCH_PAGE2:this.refreshFleet2()}},FleetDispatcher.prototype.switchToPage=function(t){let e=this;t!==this.currentPage&&(t===FLEET_DISPATCH_PAGE1&&(this.currentPage=t,$("#"+FLEET_DISPATCH_PAGE1).show(),$("#"+FLEET_DISPATCH_PAGE2).hide(),e.focusSubmitFleet1()),t===FLEET_DISPATCH_PAGE2&&(this.currentPage=t,$("#"+FLEET_DISPATCH_PAGE1).hide(),$("#"+FLEET_DISPATCH_PAGE2).show(),this.setTargetType(this.targetPlanet.type),e.focusSendFleet()),this.currentPage===FLEET_DISPATCH_PAGE1&&null!==this.timerTimes&&(clearInterval(this.timerTimes),this.timerTimes=null),this.currentPage===FLEET_DISPATCH_PAGE2&&null===this.timerTimes&&(this.timerTimes=setInterval((function(){e.refreshFleetTimes()}),1e3)),this.refresh())},FleetDispatcher.prototype.startLoading=function(){this.loading=!0,$("#fleetdispatchcomponent .ajax_loading").show()},FleetDispatcher.prototype.stopLoading=function(){this.loading=!1,$("#fleetdispatchcomponent .ajax_loading").hide()},FleetDispatcher.prototype.updateToken=function(t){token=t},FleetDispatcher.prototype.appendTokenParams=function(t){t.token=token},FleetDispatcher.prototype.updateEmptySystems=function(t){this.emptySystems=t},FleetDispatcher.prototype.updateInactiveSystems=function(t){this.inactiveSystems=t},FleetDispatcher.prototype.appendShipParams=function(t){this.shipsToSend.forEach((function(e){t["am"+e.id]=e.number}))},FleetDispatcher.prototype.appendTargetParams=function(t){t.galaxy=this.targetPlanet.galaxy,t.system=this.targetPlanet.system,t.position=this.targetPlanet.position,t.type=this.targetPlanet.type},FleetDispatcher.prototype.appendCargoParams=function(t){t.metal=this.cargoMetal,t.crystal=this.cargoCrystal,t.deuterium=this.cargoDeuterium,this.lifeformEnabled&&(t.food=this.cargoFood)},FleetDispatcher.prototype.appendPrioParams=function(t){t.prioMetal=this.prioMetal,t.prioCrystal=this.prioCrystal,t.prioDeuterium=this.prioDeuterium,this.lifeformEnabled&&(t.prioFood=this.prioFood)},FleetDispatcher.prototype.initFleet1=function(){initToggleHeader("fleet1");let t=this,e=$("#fleet1");e.find("select.combatunits").ogameDropDown(),t.refresh(),e.on("click","#continueToFleet2",(async function(e){e.preventDefault(),await new Promise(((t,e)=>setTimeout((()=>t()),250))),t.trySubmitFleet1()})),e.on("keyup","#technologies li input",(function(e){e.preventDefault();let i=parseInt($(e.currentTarget).closest("li").data("technology")),n=getValue($(e.currentTarget).val());t.selectShip(i,n)})),e.on("focusout","#technologies li input",(function(e){e.preventDefault();let i=parseInt($(e.currentTarget).closest("li").data("technology")),n=getValue($(e.currentTarget).val());t.selectShip(i,n),t.refresh()})),e.on("click","#technologies li .icon",(function(e){e.preventDefault();let i=parseInt($(e.currentTarget).closest("li").data("technology"));t.getNumberOfShipsSelected(i)<t.getNumberOfShipsOnPlanet(i)?t.selectMaxShips(i):t.selectShip(i,0),t.refresh(),t.focusSubmitFleet1()})),e.on("click","#sendall",(function(e){e.preventDefault(),t.selectAllShips(),t.refresh(),t.focusSubmitFleet1()})),e.on("click","#resetall",(function(e){e.preventDefault(),t.resetShips(),t.refresh(),t.focusSubmitFleet1()})),e.on("click","#combatunits",(function(t){t.preventDefault(),initStandardFleet()})),e.on("change","#standardfleet",(function(e){let i=getValue($("select.combatunits").val());t.selectStandardFleet(i),t.refresh()})),e.on("change","#expeditionFleetTemplateSelect",(function(e){let i=getValue($("#expeditionFleetTemplateSelect").val());t.selectExpeditionFleet(i),t.refresh()}))},FleetDispatcher.prototype.focusSubmitFleet1=function(){$("#continueToFleet2").focus()},FleetDispatcher.prototype.hasShipsSelected=function(){return this.getTotalNumberOfShipsSelected()>0},FleetDispatcher.prototype.hasFreeSlots=function(){return this.maxFleetCount-this.fleetCount>0},FleetDispatcher.prototype.hasEnoughFuel=function(){return this.deuteriumOnPlanet>=this.getConsumption()},FleetDispatcher.prototype.validateFleet1=function(t,e){return this.hasShipsSelected()?!!this.hasFreeSlots()||(this.displayErrors([{message:this.loca.LOCA_FLEET_NO_FREE_SLOTS}]),!1):(this.displayErrors([{message:this.loca.LOCA_FLEET_NO_SELECTION}]),!1)},FleetDispatcher.prototype.trySubmitFleet1=function(){!1!==this.validateFleet1()&&this.switchToPage(FLEET_DISPATCH_PAGE2)},FleetDispatcher.prototype.refreshFleet1=function(){this.refreshNavigationFleet1(),this.refreshShips(),this.refreshAPIData(),this.refreshStatusBarFleet()},FleetDispatcher.prototype.refreshNavigationFleet1=function(){let t="";this.hasShipsSelected()?this.hasFreeSlots()?$("#continueToFleet2").attr("class","continue on"):($("#continueToFleet2").attr("class","continue off"),t=this.loca.LOCA_FLEET_NO_FREE_SLOTS):($("#continueToFleet2").attr("class","continue off"),t=this.loca.LOCA_FLEET_NO_SELECTION),$("#allornone .info").html(t)},FleetDispatcher.prototype.refreshShips=function(){let t=this;$("#fleet1 #technologies li").each((function(e,i){const n=$(i).data("technology"),a=t.findShip(n),s=$(i).find("input"),o=""===s.val()?"":parseInt(s.val()),r=a?.number??"";if(o!==r){s.val(r);const t=new Event("change");s.get(0).dispatchEvent(t)}}))},FleetDispatcher.prototype.refreshAPIData=function(){let t=this.shipsToSend.map((function(t){return[t.id,t.number]}));t.length<1&&(t=this.apiShipBaseData);let e=[].concat(this.apiCommonData).concat(this.apiTechData).concat(t).concat(this.apiDefenseData).map((function(t){return t.join(";")})).join("|"),i=JSON.parse(JSON.stringify(this.apiDataJson));this.shipsToSend.length>0&&(Object.keys(i.ships).forEach((t=>i.ships[t].amount=0)),this.shipsToSend.forEach((t=>{i.ships[t.id]=this.apiDataJson.ships[t.id],i.ships[t.id].amount=t.number})));let n=JSON.stringify(i),a=document.createElement("div");a.textContent=this.loca.LOCA_API_FLEET_DATA,a.append(document.createElement("br")),a.append(document.createTextNode("API 1:"));let s=document.createElement("input");s.setAttribute("id","FLEETAPI"),s.setAttribute("readonly","1"),s.setAttribute("onclick","select()"),s.setAttribute("value",e??""),s.value=e??"",a.appendChild(s),a.append(document.createElement("br")),a.append(document.createTextNode("API 2:"));let o=document.createElement("input");o.setAttribute("id","FLEETAPI_JSON"),o.setAttribute("readonly","1"),o.setAttribute("onclick","select()"),o.setAttribute("value",n),o.value=n,a.appendChild(o),changeTooltip($(".show_fleet_apikey"),a.outerHTML)},FleetDispatcher.prototype.selectShip=function(t,e){let i=this.getNumberOfShipsOnPlanet(t);(e=Math.min(i,e))<=0?this.removeShip(t):this.hasShip(t)?this.updateShip(t,e):this.addShip(t,e),this.resetCargo()},FleetDispatcher.prototype.addShip=function(t,e){this.shipsToSend.push({id:t,number:e})},FleetDispatcher.prototype.findShip=function(t){return this.shipsToSend.find((function(e){return e.id===t}))},FleetDispatcher.prototype.getNumberOfShipsSelected=function(t){let e=this.findShip(t);return void 0!==e?e.number:0},FleetDispatcher.prototype.hasShip=function(t){return void 0!==this.findShip(t)},FleetDispatcher.prototype.hasColonizationShip=function(){return this.hasShip(this.SHIP_ID_COLONIZATION)},FleetDispatcher.prototype.hasRecycler=function(){return this.hasShip(this.SHIP_ID_RECYCLER)},FleetDispatcher.prototype.hasValidTarget=function(){return(this.targetPlanet.galaxy!==this.currentPlanet.galaxy||this.targetPlanet.system!==this.currentPlanet.system||this.targetPlanet.position!==this.currentPlanet.position||this.targetPlanet.type!==this.currentPlanet.type)&&this.targetPlanet.galaxy>0&&this.targetPlanet.system>0&&this.targetPlanet.position>0},FleetDispatcher.prototype.removeShip=function(t){let e=this.shipsToSend.findIndex((function(e){return e.id===t}));-1!=e&&this.shipsToSend.splice(e,1)},FleetDispatcher.prototype.updateShip=function(t,e){let i=this.findShip(t);i&&(i.number=e)},FleetDispatcher.prototype.getNumberOfShipsOnPlanet=function(t){let e=this.shipsOnPlanet.find((function(e){return e.id===t}));return e?e.number:0},FleetDispatcher.prototype.getTotalNumberOfShipsSelected=function(){let t=0;return this.shipsToSend.forEach((function(e){t+=e.number})),t},FleetDispatcher.prototype.getShipIds=function(){return this.shipsToSend.map((function(t){return t.id}))},FleetDispatcher.prototype.resetShips=function(){this.shipsToSend=[]},FleetDispatcher.prototype.selectAllShips=function(){let t=this;this.shipsOnPlanet.forEach((function(e){t.selectShip(e.id,e.number)}))},FleetDispatcher.prototype.selectMaxShips=function(t){let e=this.getNumberOfShipsOnPlanet(t);this.selectShip(t,e)},FleetDispatcher.prototype.selectShips=function(t){for(let e in t){let i=t[e];this.selectShip(parseInt(e),i)}},FleetDispatcher.prototype.selectStandardFleet=function(t){let e=this.standardFleets.find((function(e){return e.id===t}));void 0!==e&&void 0!==e.ships&&this.selectShips(e.ships)},FleetDispatcher.prototype.selectExpeditionFleet=function(t){this.resetShips();let e=$("#speedPercentage");e&&e.length&&e.data("percentageBarInstance").setValue(10),$("#expeditiontime").val("1").ogameDropDown("select","1"),this.refresh(),this.focusSubmitFleet1();let i=expeditionFleetTemplates.find((e=>e.id===t));if(i&&i.ships){if(this.selectShips(i.ships),e&&e.length){let t=allowedSpeedsInExpeditionTemplate.find((t=>t>=i.fleetSpeed));e.data("percentageBarInstance").setValue(t/10)}$("#position").val(EXPEDITION_POSITION),$("#expeditiontime").val(i.expeditionTime.toString()).ogameDropDown("select",i.expeditionTime.toString()),this.updateTarget()}},FleetDispatcher.prototype.initFleet2=function(){addPercentageBarPlugin(),initToggleHeader("fleet2");let t=Object.fromEntries(Object.entries(this.fleetBoxOrder).sort((([,t],[,e])=>t-e))),e=$("#fleet2 #buttonz");for(let i in t){let t=$("#fleet2 #buttonz #"+i);$(e).append(t)}let i=this,n=$("#fleet2").off();$("#speedPercentage").percentageBar().on("change",(function(t){i.setFleetPercent(t.value),i.refresh()})),n.find("#slbox").ogameDropDown(),n.find("#aksbox").ogameDropDown(),n.on("click","#backToFleet1",(function(t){t.preventDefault(),i.switchToPage(FLEET_DISPATCH_PAGE1)})),n.on("focus","#galaxy",(function(){clearInput("#galaxy"),i.targetPlanet.galaxy="",i.refreshFleet2()})),n.on("focus","#system",(function(){clearInput("#system"),i.targetPlanet.system="",i.refreshFleet2()})),n.on("focus","#position",(function(){clearInput("#position"),i.targetPlanet.position="",i.refreshFleet2()})),n.on("keyup","#galaxy, #system, #position",(function(t){let e=(1*$("#galaxy").val()>0?1:0)+(1*$("#system").val()>0?1:0)+(1*$("#position").val()>0?1:0);i.updateTarget(3===e),i.updateTargetDropDowns(),i.refresh(),3!==e&&(i.clearMissions(),i.updateTargetDropDowns())})),n.on("click","#pbutton",(function(t){t.preventDefault(),i.clearMissions(),i.setTargetType(i.fleetHelper.PLANETTYPE_PLANET),i.updateTargetDropDowns(),i.refresh()})),n.on("click","#mbutton",(function(t){t.preventDefault(),i.clearMissions(),i.setTargetType(i.fleetHelper.PLANETTYPE_MOON),i.updateTargetDropDowns(),i.refresh()})),n.on("click","#dbutton",(function(t){t.preventDefault(),i.clearMissions(),i.setTargetType(i.fleetHelper.PLANETTYPE_DEBRIS),i.updateTargetDropDowns(),i.refresh()})),n.on("change","#slbox",(function(t){t.preventDefault(),i.selectShortLink($(t.currentTarget)),i.updateTarget(),i.refresh()})),n.on("change","#aksbox",(function(t){t.preventDefault(),i.selectCombatUnion($(t.currentTarget)),i.updateTarget(),i.refresh()})),n.on("click","#selectMaxMetal",(function(t){t.preventDefault(),i.selectMaxMetal(),i.refresh(),i.focusSendFleet()})),n.on("click","#selectMinMetal",(function(t){t.preventDefault(),i.selectMinMetal(),i.refresh(),i.focusSendFleet()})),n.on("click","#selectMaxCrystal",(function(t){t.preventDefault(),i.selectMaxCrystal(),i.refresh(),i.focusSendFleet()})),n.on("click","#selectMinCrystal",(function(t){t.preventDefault(),i.selectMinCrystal(),i.refresh(),i.focusSendFleet()})),n.on("click","#selectMaxDeuterium",(function(t){t.preventDefault(),i.selectMaxDeuterium(),i.refresh(),i.focusSendFleet()})),n.on("click","#selectMinDeuterium",(function(t){t.preventDefault(),i.selectMinDeuterium(),i.refresh(),i.focusSendFleet()})),n.on("click","#selectMaxFood",(function(t){t.preventDefault(),i.selectMaxFood(),i.refresh(),i.focusSendFleet()})),n.on("click","#selectMinFood",(function(t){t.preventDefault(),i.selectMinFood(),i.refresh(),i.focusSendFleet()})),n.on("click","#allresources",(function(t){t.preventDefault(),i.selectMaxAll(),i.refresh(),i.focusSendFleet()})),n.on("keyup","#metal",(function(t){i.updateMetal(),i.refresh()})),n.on("change","#metal",(function(t){i.updateMetal(),i.refresh()})),n.on("keyup","#crystal",(function(t){i.updateCrystal(),i.refresh()})),n.on("change","#crystal",(function(t){i.updateCrystal(),i.refresh()})),n.on("keyup","#deuterium",(function(t){i.updateDeuterium(),i.refresh()})),n.on("change","#deuterium",(function(t){i.updateDeuterium(),i.refresh()})),n.on("keyup","#food",(function(t){i.updateFood(),i.refresh()})),n.on("change","#food",(function(t){i.updateFood(),i.refresh()})),n.on("click","#sendFleet",(async function(t){t.preventDefault(),await new Promise(((t,e)=>setTimeout((()=>t()),250))),i.trySubmitFleet2()})),n.on("click","#missions > li > a",(function(t){t.preventDefault();let e=parseInt($(t.currentTarget).data("mission")||this.fleetHelper.MISSION_NONE);i.selectMission(e),i.focusSendFleet()})),n.on("click",".prioButton",(function(t){t.preventDefault();let e=$(t.currentTarget).attr("data-resource-type"),n=parseInt($(t.currentTarget).attr("data-resource-prio"));i.selectPriority(e,n),i.refresh(),i.focusSendFleet()})),FleetDispatcher.prototype.focusSendFleet=function(){$("#sendFleet").focus()},n.on("change","input[name=retreatAfterDefenderRetreat]",(function(t){i.selectRetreatAfterDefenderRetreat($(t.currentTarget).is(":checked"))})),n.on("change","input[name=lootFoodOnAttack]",(function(t){i.selectLootFoodOnAttack($(t.currentTarget).is(":checked"))})),n.on("change keyup","#holdingtime",(function(){i.updateHoldingTime(),i.refresh(),i.focusSendFleet()})),n.on("change keyup","#expeditiontime",(function(t){i.updateExpeditionTime(),i.refresh(),i.focusSendFleet()})),this.fetchTargetPlayerData()},FleetDispatcher.prototype.validateFleet2=function(){return!(!this.hasValidTarget()||!this.hasMission())},FleetDispatcher.prototype.trySubmitFleet2=function(){clearTimeout(this.fetchTargetPlayerDataTimeout),this.fetchTargetPlayerDataTimeout=null;let t=this;this.refreshNavigationFleet2(!0),1!==$("#sendFleet.off").length&&!1!==this.validateFleet2()&&(this.moveInProgress?errorBoxDecision(this.loca.LOCA_ALL_NETWORK_ATTENTION,this.loca.LOCA_PLANETMOVE_BREAKUP_WARNING,this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){t.submitFleet2()})):this.warningsEnabled&&this.targetIsStrong&&!this.targetIsOutlaw&&!this.targetIsBuddyOrAllyMember&&!this.playerIsOutlaw&&this.fleetHelper.isAggressiveMission(this.mission)?errorBoxDecision(this.loca.LOCA_ALL_NETWORK_ATTENTION,this.locadyn.locaAllOutlawWarning,this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){t.submitFleet2()})):this.mission!==this.fleetHelper.MISSION_COLONIZE||!0!==this.fleetHelper.COLONIZATION_ENABLED||this.hasFreePlanetSlots()?this.submitFleet2():errorBoxDecision(this.loca.LOCA_ALL_NOTICE,this.loca.LOCA_FLEETSENDING_MAX_PLANET_WARNING,this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){t.submitFleet2()})))},FleetDispatcher.prototype.refreshFleet2=function(){this.refreshNavigationFleet2(),this.refreshTarget(),this.refreshBriefing(),this.refreshCargo(),this.refreshPriorities()},FleetDispatcher.prototype.refreshTarget=function(){this.targetPlanet.type===this.fleetHelper.PLANETTYPE_PLANET?$("#pbutton").attr("class","planet_selected"):$("#pbutton").attr("class","planet"),this.targetPlanet.type===this.fleetHelper.PLANETTYPE_DEBRIS?$("#dbutton").attr("class","debris_selected"):$("#dbutton").attr("class","debris"),this.targetPlanet.type===this.fleetHelper.PLANETTYPE_MOON?$("#mbutton").attr("class","moon_selected"):$("#mbutton").attr("class","moon"),$("#galaxy").val(this.targetPlanet.galaxy),$("#system").val(this.targetPlanet.system),$("#position").val(this.targetPlanet.position),$("#type").val(this.targetPlanet.type),$("#distanceValue").html(tsdpkt(this.getDistance()));let t=this.getOwnPlanetName(this.targetPlanet,this.targetPlanet.type);void 0!==t&&""!==t?$("#targetPlanetName").html(t):this.targetPlanet.type===this.fleetHelper.PLANETTYPE_PLANET?$("#targetPlanetName").html(this.loca.LOCA_ALL_PLANET):this.targetPlanet.type===this.fleetHelper.PLANETTYPE_DEBRIS?$("#targetPlanetName").html(this.loca.LOCA_FLEET_DEBRIS):this.targetPlanet.type===this.fleetHelper.PLANETTYPE_MOON&&$("#targetPlanetName").html(this.loca.LOCA_ALL_MOON),this.refreshMissions()},FleetDispatcher.prototype.refreshBriefing=function(){this.refreshDuration(),this.refreshConsumption(),this.refreshStorage(),this.refreshFleetTimes(),this.refreshMaxSpeed(),this.refreshEmptySystems(),this.refreshInactiveSystems()},FleetDispatcher.prototype.refreshTargetPlanet=function(){let t="["+this.targetPlanet.galaxy+":"+this.targetPlanet.system+":"+this.targetPlanet.position+"] "+(this.targetPlanet.type===this.fleetHelper.PLANETTYPE_DEBRIS?this.loca.LOCA_FLEET_DEBRIS:this.targetPlanet.name),e=$("#fleet2 #targetPlanet"),i=!0===this.targetInhabited?this.loca.LOCA_ALL_PLAYER+": "+this.targetPlayerName:"";e.toggleClass("tooltip",this.targetInhabited).toggleClass("active",this.targetInhabited).attr("title",i).html(t),changeTooltip(e)},FleetDispatcher.prototype.refreshDuration=function(){let t=this.getDuration();t=!isNaN(t)&&isFinite(t)?t:0,$("#fleet2 #duration").html(formatTime(t)+" h")},FleetDispatcher.prototype.refreshConsumption=function(){let t=this.getFuelCapacity(),e=getResourcesFromHeader("deuterium"),i=this.getConsumption();i=!isNaN(i)&&isFinite(i)?i:0;let n=i>t||i>e?"overmark":"undermark",a=Math.ceil(100*i/t),s='<span class="'+n+'">'+tsdpkt(i)+" ("+a+"%)</span>";$("#fleet2 #consumption").html(s)},FleetDispatcher.prototype.refreshStorage=function(){let t=this.getFreeCargoSpace(),e='<span class="'+(t<0?"overmark":"undermark")+'">'+tsdpkt(t)+"</span>";$("#storage").html(e)},FleetDispatcher.prototype.refreshFleetTimes=function(){let t=this.getDuration(),e=0;this.mission===this.fleetHelper.MISSION_EXPEDITION&&(e=3600*this.expeditionTime),this.mission===this.fleetHelper.MISSION_HOLD&&(e=3600*this.holdingTime),t=!isNaN(t)&&isFinite(t)?t:0,e=!isNaN(e)&&isFinite(e)?e:0;let i=getFormatedDate(serverTime.getTime()+1e3*t,"[d].[m].[y] [G]:[i]:[s]"),n=getFormatedDate(serverTime.getTime()+1e3*(2*t+e),"[d].[m].[y] [G]:[i]:[s]");if($("#fleet2 #arrivalTime").html(i),$("#fleet2 #returnTime").html(n),this.mission===this.fleetHelper.MISSION_UNIONATTACK){let t=this.getUnionData(this.union);if(null!==t){let e=formatTime(parseInt(t.time-serverTime.getTime()/1e3));$("#durationAKS").html(e)}}},FleetDispatcher.prototype.refreshMaxSpeed=function(){let t=this.getMaxSpeed();$("#maxspeed").html(tsdpkt(t))},FleetDispatcher.prototype.refreshEmptySystems=function(){$("#emptySystems").html(this.emptySystems)},FleetDispatcher.prototype.refreshInactiveSystems=function(){$("#inactiveSystems").html(this.inactiveSystems)},FleetDispatcher.prototype.getPlanetIcon=function(t,e){e=e||!0;let i="",n="";switch(t){case this.fleetHelper.PLANETTYPE_MOON:i="moon",n=this.loca.LOCA_ALL_MOON;break;case this.fleetHelper.PLANETTYPE_DEBRIS:i="tf",n=this.loca.LOCA_FLEET_DEBRIS;break;case this.fleetHelper.PLANETTYPE_PLANET:default:i="planet",n=this.loca.LOCA_ALL_PLANET}let a="";return e&&(i+=" tooltip js_hideTipOnMobile",a=' title="'+n+'"'),'<figure class="planetIcon '+i+'"'+a+"></figure>"},FleetDispatcher.prototype.updateTarget=function(t=!0){let e=clampInt(getValue($("#galaxy").val()),1,this.fleetHelper.MAX_GALAXY,!0),i=clampInt(getValue($("#system").val()),1,this.fleetHelper.MAX_SYSTEM,!0),n=clampInt(getValue($("#position").val()),1,this.fleetHelper.MAX_POSITION,!0);if(this.targetPlanet.galaxy=e,this.targetPlanet.system=i,this.targetPlanet.position=n,this.targetPlanet.position===this.fleetHelper.EXPEDITION_POSITION&&(this.targetPlanet.type=this.fleetHelper.PLANETTYPE_PLANET),clearTimeout(this.fetchTargetPlayerDataTimeout),t&&$("#fleet2").is(":visible")){let t=this;this.fetchTargetPlayerDataTimeout=setTimeout((()=>{t.deferred.push($.Deferred()),1===t.deferred.length&&t.fetchTargetPlayerData(),t.deferred[t.deferred.length-1].done((()=>{0!==t.deferred.length&&t.fetchTargetPlayerData()}))}),500)}},FleetDispatcher.prototype.updateTargetDropDowns=function(){this.resetDropDown("#slbox"),this.resetDropDown("#aksbox")},FleetDispatcher.prototype.resetDropDown=function(t){let e=[this.targetPlanet.galaxy,this.targetPlanet.system,this.targetPlanet.position,this.targetPlanet.type].join("#");0===$(t).find('option[value^="'+e+'"]').length&&$(t).ogameDropDown("select","-")},FleetDispatcher.prototype.selectShortLink=function(t){let e=t.val().split("#");e instanceof Array&&e.length>=5&&($("#galaxy").val(e[0]),$("#system").val(e[1]),$("#position").val(e[2]),this.setTargetType(parseInt(e[3]),!0))},FleetDispatcher.prototype.setTargetType=function(t,e){this.targetPlanet.type=t,!e&&$("#fleet2").is(":visible")&&(clearTimeout(this.fetchTargetPlayerDataTimeout),this.fetchTargetPlayerDataTimeout=null,this.fetchTargetPlayerData())},FleetDispatcher.prototype.selectCombatUnion=function(t){let e=t.val().split("#");e instanceof Array&&e.length>=5?($("#galaxy").val(e[0]),$("#system").val(e[1]),$("#position").val(e[2]),this.setTargetType(parseInt(e[3]),!0),this.union=parseInt(e[5])):(this.mission=this.fleetHelper.MISSION_NONE,this.union=0)},FleetDispatcher.prototype.setFleetPercent=function(t){this.speedPercent=t},FleetDispatcher.prototype.findOwnPlanet=function(t,e){if(!t)return;if(!e)return;let i=this.planets.find((function(i){return i.galaxy==t.galaxy&&(i.system==t.system&&(i.position==t.position&&i.type==e))}));return i},FleetDispatcher.prototype.getOwnPlanetName=function(t,e){if(!t)return;if(!e)return;let i=this.findOwnPlanet(t,e);return i?i.name:void 0},FleetDispatcher.prototype.getDistance=function(){return this.fleetHelper.calcDistance(this.currentPlanet,this.targetPlanet,this.emptySystems,this.inactiveSystems)},FleetDispatcher.prototype.getConsumption=function(){return this.fleetHelper.calcConsumption(this.shipsToSend,this.getDistance(),this.speedPercent,this.getHoldingTime(),this.mission)},FleetDispatcher.prototype.getDuration=function(){let t=this.getDistance(),e=this.getMaxSpeed();return this.fleetHelper.calcDuration(t,e,this.speedPercent,this.mission)},FleetDispatcher.prototype.getHoldingTime=function(){switch(this.mission){case this.fleetHelper.MISSION_EXPEDITION:return this.expeditionTime;case this.fleetHelper.MISSION_HOLD:return this.holdingTime;default:return 0}},FleetDispatcher.prototype.getMaxSpeed=function(){let t=this.getShipIds();return this.fleetHelper.getMaxSpeed(t)},FleetDispatcher.prototype.getCargoCapacity=function(){let t=this,e=0;return this.shipsToSend.forEach((function(i){e+=t.fleetHelper.calcCargoCapacity(i.id,i.number)})),Math.floor(e)},FleetDispatcher.prototype.getFuelCapacity=function(){let t=this,e=0;return this.shipsToSend.forEach((function(i){e+=t.fleetHelper.calcFuelCapacity(i.id,i.number)})),Math.floor(e)},FleetDispatcher.prototype.getFreeCargoSpace=function(){return this.getCargoCapacity()-this.cargoMetal-this.cargoCrystal-this.cargoDeuterium-this.cargoFood},FleetDispatcher.prototype.getUsedCargoSpace=function(){return this.cargoMetal+this.cargoCrystal+this.cargoDeuterium+this.cargoFood},FleetDispatcher.prototype.setOrders=function(t){this.orders=t},FleetDispatcher.prototype.setTargetInhabited=function(t){this.targetInhabited=t},FleetDispatcher.prototype.setTargetPlayerId=function(t){this.targetPlayerId=t},FleetDispatcher.prototype.setTargetPlayerName=function(t){this.targetPlayerName=t},FleetDispatcher.prototype.setTargetIsStrong=function(t){this.targetIsStrong=t},FleetDispatcher.prototype.setTargetIsOutlaw=function(t){this.targetIsOutlaw=t},FleetDispatcher.prototype.setTargetIsBuddyOrAllyMember=function(t){this.targetIsBuddyOrAllyMember=t},FleetDispatcher.prototype.setPlayerIsOutlaw=function(t){this.playerIsOutlaw=t},FleetDispatcher.prototype.setTargetPlayerColorClass=function(t){this.targetPlayerColorClass=t},FleetDispatcher.prototype.setTargetPlayerRankIcon=function(t){this.targetPlayerRankIcon=t},FleetDispatcher.prototype.setTargetPlanet=function(t){this.targetPlanet=t},FleetDispatcher.prototype.fetchTargetPlayerData=function(){this.fetchTargetPlayerDataTimeout||(this.fetchTargetPlayerDataTimeout=!0);let t=this;this.startLoading();let e={};this.appendShipParams(e),this.appendTargetParams(e),this.appendTokenParams(e),e.union=this.union,this.hasColonizationShip()&&(e.cs=1),this.hasRecycler()&&(e.recycler=1),e.galaxy&&e.system&&e.position&&e.type?$.post(this.checkTargetUrl,e,(function(e){let i=e.status||"failure";if($("#additionalFleetSpeedInfo").html(e.additionalFlightSpeedinfo),t.fleetHelper.shipsData=e.shipsData,"success"===i){let{targetPlanet:i}=e;i&&parseInt($("#galaxy").val())===i.galaxy&&parseInt($("#system").val())===i.system&&parseInt($("#position").val())===i.position&&(t.refreshDataAfterAjax(e),t.refreshStatusBarFleet())}else t.setTargetPlayerNameOnStatusBarFleet(),t.setTargetPlayerPlanetNameOnStatusBarFleet(),"fleet2"===t.currentPage&&(t.clearMissions(),t.updateTargetDropDowns(),t.displayErrors(e.errors));"fleet2"===t.currentPage&&(t.mission===t.fleetHelper.MISSION_NONE||t.isMissionAvailable(t.mission)||(t.mission=t.fleetHelper.MISSION_NONE),0!==t.union&&!1===t.hasMission()&&t.isMissionAvailable(t.fleetHelper.MISSION_UNIONATTACK)&&t.selectMission(t.fleetHelper.MISSION_UNIONATTACK),t.validateMissions()),t.updateToken(e.newAjaxToken),t.updateEmptySystems(e.emptySystems),t.updateInactiveSystems(e.inactiveSystems),t.refreshTargetPlanet(),t.refreshFleet2(),t.fetchTargetPlayerDataTimeout=null,t.stopLoading(),e.bashingSystemLimitReached?$("#attackMissionsDisabledBashingLimit").show():$("#attackMissionsDisabledBashingLimit").hide();let n=t.deferred.shift();n&&n.resolve()})):this.stopLoading()},FleetDispatcher.prototype.setTargetPlayerNameOnStatusBarFleet=function(t){let e=$("#statusBarFleet .targetPlayerName"),i="";t?t.targetPlanet&&t.targetPlanet.type===this.fleetHelper.PLANETTYPE_DEBRIS?i=this.loca.LOCA_EVENTH_ENEMY_INFINITELY_SPACE:t.targetPlayerName?t.targetPlayerId===this.playerId?i=t.targetPlayerName:(i=t.targetPlayerRankIcon+'<span class="status_abbr_{color}">{name}</span>',i=i.replace("{color}",t.targetPlayerColorClass),i=i.replace("{name}",t.targetPlayerName)):i=this.loca.LOCA_EVENTH_ENEMY_INFINITELY_SPACE:i=this.loca.LOCA_EVENTH_ENEMY_INFINITELY_SPACE,e.closest("li").show(),e.html(i)},FleetDispatcher.prototype.setTargetPlayerPlanetNameOnStatusBarFleet=function(t){let e;if(!t||t&&!t.targetPlanet){let t=this.getPlanetIcon(this.fleetHelper.PLANETTYPE_PLANET,!1);e=`[${$("#galaxy").val()}:${$("#system").val()}:${$("#position").val()}] ${t} ?`}else{let i=this.getPlanetIcon(t.targetPlanet.type,!1);e="["+t.targetPlanet.galaxy+":"+t.targetPlanet.system+":"+t.targetPlanet.position+"] "+i+t.targetPlanet.name}$("#statusBarFleet .targetName").html(e)},FleetDispatcher.prototype.submitFleet2=function(t){t=t||!1;let e=this,i={};this.appendTokenParams(i),this.appendShipParams(i),this.appendTargetParams(i),this.appendCargoParams(i),this.appendPrioParams(i),i.mission=this.mission,i.speed=this.speedPercent,i.retreatAfterDefenderRetreat=!0===this.retreatAfterDefenderRetreat?1:0,i.lootFoodOnAttack=!0===this.lootFoodOnAttack?1:0,i.union=this.union,t&&(i.force=t),i.holdingtime=this.getHoldingTime(),this.startLoading(),$.post(this.sendFleetUrl,i,(function(t){!0===t.success?(fadeBox(t.message,!1),$("#sendFleet").removeAttr("disabled"),window.location=t.redirectUrl):t.responseArray&&t.responseArray.limitReached&&!t.responseArray.force?(e.updateToken(t.newAjaxToken||""),errorBoxDecision(e.loca.LOCA_ALL_NETWORK_ATTENTION,e.locadyn.localBashWarning,e.loca.LOCA_ALL_YES,e.loca.LOCA_ALL_NO,(function(){e.submitFleet2(!0)}))):(e.displayErrors(t.errors),e.updateToken(t.newAjaxToken||""),$("#sendFleet").removeAttr("disabled"),e.stopLoading())}))},FleetDispatcher.prototype.refreshNavigationFleet2=function(t=!1){let e=null;const i=document.getElementById("sendFleet");this.hasShipsSelected()?this.hasMission()?this.hasFreeSlots()?this.hasEnoughFuel()?(i.classList.add("on"),i.classList.remove("off"),i.removeAttribute("disabled")):(i.classList.add("off"),i.classList.remove("on"),e=this.loca.LOCA_FLEETSENDING_NOT_ENOUGH_FOIL):(i.classList.add("off"),i.classList.remove("on"),e=this.loca.LOCA_FLEET_NO_FREE_SLOTS):(i.classList.add("off"),i.classList.remove("on"),e=this.loca.LOCA_FLEETSENDING_NO_MISSION_SELECTED):(i.classList.add("off"),i.classList.remove("on"),e=this.loca.LOCA_FLEET_NO_SELECTION),t&&null!=e&&this.displayErrors([{message:e}])},FleetDispatcher.prototype.refreshStatusBarFleet=function(){this.hasValidTarget();let t=this.getMissionData(this.mission),e=null!==t?t.name:this.loca.LOCA_FLEET_NO_SELECTION,i=this.getPlanetIcon(this.targetPlanet.type,!1),n="["+this.targetPlanet.galaxy+":"+this.targetPlanet.system+":"+this.targetPlanet.position+"] "+i+(this.targetPlanet.type===this.fleetHelper.PLANETTYPE_DEBRIS?this.loca.LOCA_FLEET_DEBRIS:this.targetPlanet.name);$("#statusBarFleet .missionName").text(e),$("#statusBarFleet .targetName").html(n);let a=$("#statusBarFleet .targetPlayerName");if(this.targetPlanet.type===this.fleetHelper.PLANETTYPE_DEBRIS)a.closest("li").hide(),a.html("");else{let t="";0===this.targetPlayerId||this.fleetHelper.isPlayerSpace(this.targetPlayerId)?t=this.loca.LOCA_EVENTH_ENEMY_INFINITELY_SPACE:this.targetPlayerId===this.playerId?t=this.targetPlayerName:(t=this.targetPlayerRankIcon+'<span class="status_abbr_{color}">{name}</span>',t=t.replace("{color}",this.targetPlayerColorClass),t=t.replace("{name}",this.targetPlayerName)),a.closest("li").show(),a.html(t)}},FleetDispatcher.prototype.clearMissions=function(){this.mission=this.fleetHelper.MISSION_NONE;for(let t in this.orders)this.orders[t]=!1},FleetDispatcher.prototype.validateMissions=function(){let t=!1;this.hasShipsSelected()&&this.hasFreeSlots()&&this.hasValidTarget()&&-1!==Object.values(this.orders).indexOf(!0)||(t=!0),t&&this.clearMissions()},FleetDispatcher.prototype.refreshMissions=function(){$("#missions>li>a.selected").removeClass("selected"),this.isOnlyMissionAvailable(this.fleetHelper.MISSION_EXPEDITION)&&(!1===this.hasMission()&&this.selectMission(this.fleetHelper.MISSION_EXPEDITION),this.updateExpeditionTime());for(let t in this.orders){let e=this.getMissionData(t);$("#missions>li#button"+t).toggleClass("on",!0===e.isAvailable).toggleClass("off",!1===e.isAvailable)}let t=this.getMissionData(this.mission);null!==t?($(".missionName").text(t.name),$(".mission_description").text(t.description),$("#missions>li#button"+this.mission+">a").toggleClass("selected",!0),!1===t.isAvailable?($(".briefing_overlay").show(),$("#missionNameWrapper").addClass("off")):($(".briefing_overlay").hide(),$("#missionNameWrapper").removeClass("off"))):($(".briefing_overlay").show(),$("#missionNameWrapper").addClass("off"),$(".missionName").text(this.loca.LOCA_FLEET_NO_SELECTION),$(".mission_description").text("")),$('form input[name="mission"]').val(this.mission),$("#fightAfterRetreat,#aks,#holdtimeline,#expeditiontimeline,.prioButton,.fleet_dispatch_toggle_wrap").hide(),this.mission===this.fleetHelper.MISSION_ATTACK&&($("#fightAfterRetreat").show(),$(".prioButton").show(),$(".fleet_dispatch_toggle_wrap").show()),this.mission===this.fleetHelper.MISSION_UNIONATTACK&&($("#aks").show(),$(".prioButton").show(),$(".fleet_dispatch_toggle_wrap").show()),this.mission===this.fleetHelper.MISSION_DESTROY&&($(".prioButton").show(),$(".fleet_dispatch_toggle_wrap").show()),this.mission===this.fleetHelper.MISSION_HOLD&&$("#holdtimeline").show(),this.mission===this.fleetHelper.MISSION_EXPEDITION&&$("#expeditiontimeline").show()},FleetDispatcher.prototype.refreshCargo=function(){formatNumber($("#metal"),this.cargoMetal),formatNumber($("#crystal"),this.cargoCrystal),formatNumber($("#deuterium"),this.cargoDeuterium),this.lifeformEnabled&&formatNumber($("#food"),this.cargoFood);let t=this.getUsedCargoSpace(),e=this.getFreeCargoSpace(),i=this.getCargoCapacity(),n=e<0?"overmark":"undermark";$("#remainingresources").html('<span class="'+n+'">'+tsdpkt(e)+"</style>"),$("#maxresources").html(tsdpkt(i)),$("#loadRoom .bar_container").data("currentAmount",t).data("capacity",i),refreshBars("bar_container","filllevel_bar")},FleetDispatcher.prototype.refreshPriorities=function(){switch($('form input[name="prioMetal"]').val(this.prioMetal),$('form input[name="prioCrystal"]').val(this.prioCrystal),$('form input[name="prioDeuterium"]').val(this.prioDeuterium),this.lifeformEnabled&&$('form input[name="prioFood"]').val(this.prioFood),$("#prioM1").attr("src","/img/icons/4b53e83f8b8583ea279fd26f3a55a5.gif"),$("#prioM2").attr("src","/img/icons/8afbd59ffe091239a7c6f1e961b267.gif"),$("#prioM3").attr("src","/img/icons/4acc67e1ca4d8debb1b114abcb7c1e.gif"),this.lifeformEnabled&&$("#prioM4").attr("src","/img/icons/8860dee24c03537549ad782922b6b5.gif"),this.prioMetal){case 1:$("#prioM1").attr("src","/img/icons/b357323b99e20a46fc0b2495728351.gif");break;case 2:$("#prioM2").attr("src","/img/icons/f8959fe540cd329f3a764ad9aeaf93.gif");break;case 3:$("#prioM3").attr("src","/img/icons/823b3270ed0f4a243287c12d4ee5f8.gif");break;case 4:$("#prioM4").attr("src","/img/icons/43bf98a73ba1abb53860f2c5b8edc3.gif")}switch($("#prioC1").attr("src","/img/icons/4b53e83f8b8583ea279fd26f3a55a5.gif"),$("#prioC2").attr("src","/img/icons/8afbd59ffe091239a7c6f1e961b267.gif"),$("#prioC3").attr("src","/img/icons/4acc67e1ca4d8debb1b114abcb7c1e.gif"),this.lifeformEnabled&&$("#prioC4").attr("src","/img/icons/8860dee24c03537549ad782922b6b5.gif"),this.prioCrystal){case 1:$("#prioC1").attr("src","/img/icons/b357323b99e20a46fc0b2495728351.gif");break;case 2:$("#prioC2").attr("src","/img/icons/f8959fe540cd329f3a764ad9aeaf93.gif");break;case 3:$("#prioC3").attr("src","/img/icons/823b3270ed0f4a243287c12d4ee5f8.gif");break;case 4:$("#prioC4").attr("src","/img/icons/43bf98a73ba1abb53860f2c5b8edc3.gif")}switch($("#prioD1").attr("src","/img/icons/4b53e83f8b8583ea279fd26f3a55a5.gif"),$("#prioD2").attr("src","/img/icons/8afbd59ffe091239a7c6f1e961b267.gif"),$("#prioD3").attr("src","/img/icons/4acc67e1ca4d8debb1b114abcb7c1e.gif"),this.lifeformEnabled&&$("#prioD4").attr("src","/img/icons/8860dee24c03537549ad782922b6b5.gif"),this.prioDeuterium){case 1:$("#prioD1").attr("src","/img/icons/b357323b99e20a46fc0b2495728351.gif");break;case 2:$("#prioD2").attr("src","/img/icons/f8959fe540cd329f3a764ad9aeaf93.gif");break;case 3:$("#prioD3").attr("src","/img/icons/823b3270ed0f4a243287c12d4ee5f8.gif");break;case 4:$("#prioD4").attr("src","/img/icons/43bf98a73ba1abb53860f2c5b8edc3.gif")}if(this.lifeformEnabled)switch($("#prioF1").attr("src","/img/icons/4b53e83f8b8583ea279fd26f3a55a5.gif"),$("#prioF2").attr("src","/img/icons/8afbd59ffe091239a7c6f1e961b267.gif"),$("#prioF3").attr("src","/img/icons/4acc67e1ca4d8debb1b114abcb7c1e.gif"),$("#prioF4").attr("src","/img/icons/8860dee24c03537549ad782922b6b5.gif"),this.prioFood){case 1:$("#prioF1").attr("src","/img/icons/b357323b99e20a46fc0b2495728351.gif");break;case 2:$("#prioF2").attr("src","/img/icons/f8959fe540cd329f3a764ad9aeaf93.gif");break;case 3:$("#prioF3").attr("src","/img/icons/823b3270ed0f4a243287c12d4ee5f8.gif");break;case 4:$("#prioF4").attr("src","/img/icons/43bf98a73ba1abb53860f2c5b8edc3.gif")}},FleetDispatcher.prototype.isMissionAvailable=function(t){return!0===this.orders[t]},FleetDispatcher.prototype.hasMission=function(){return this.fleetHelper.isMissionValid(this.mission)&&this.isMissionAvailable(this.mission)},FleetDispatcher.prototype.hasFreePlanetSlots=function(){return this.planetCount<this.fleetHelper.MAX_NUMBER_OF_PLANETS},FleetDispatcher.prototype.getAvailableMissions=function(){let t=[];for(let e in this.orders)!0===this.orders[e]&&t.push(parseInt(e));return t},FleetDispatcher.prototype.isOnlyMissionAvailable=function(t){let e=this.getAvailableMissions();return 1===e.length&&e[0]===t},FleetDispatcher.prototype.getMissionData=function(t){return t===this.fleetHelper.MISSION_NONE?null:{isAvailable:this.orders[t]||!1,name:this.orderNames[t]||"",description:this.orderDescriptions[t]||""}},FleetDispatcher.prototype.getUnionData=function(t){for(let e=0;e<this.unions.length;++e)if(this.unions[e].id===t)return this.unions[e];return null},FleetDispatcher.prototype.selectMaxMetal=function(){let t;t=this.getCargoCapacity()-this.cargoCrystal-this.cargoDeuterium-this.cargoFood,t=Math.max(t,0),t=Math.min(t,this.metalOnPlanet),this.cargoMetal=Math.max(this.cargoMetal,t)},FleetDispatcher.prototype.selectMinMetal=function(){this.cargoMetal=0},FleetDispatcher.prototype.selectMaxCrystal=function(){let t;t=this.getCargoCapacity()-this.cargoMetal-this.cargoDeuterium-this.cargoFood,t=Math.max(t,0),t=Math.min(t,this.crystalOnPlanet),this.cargoCrystal=Math.max(this.cargoCrystal,t)},FleetDispatcher.prototype.getDeuteriumOnPlanetWithoutConsumption=function(){return Math.max(0,this.deuteriumOnPlanet-this.getConsumption())},FleetDispatcher.prototype.selectMinCrystal=function(){this.cargoCrystal=0},FleetDispatcher.prototype.selectMaxDeuterium=function(){let t;t=this.getCargoCapacity()-this.cargoMetal-this.cargoCrystal-this.cargoFood,t=Math.max(t,0),t=Math.min(t,this.getDeuteriumOnPlanetWithoutConsumption()),this.cargoDeuterium=Math.max(this.cargoDeuterium,t)},FleetDispatcher.prototype.selectMinDeuterium=function(){this.cargoDeuterium=0},FleetDispatcher.prototype.selectMaxFood=function(){let t;t=this.getCargoCapacity()-this.cargoMetal-this.cargoCrystal-this.cargoDeuterium,t=Math.max(t,0),t=Math.min(t,this.foodOnPlanet),this.cargoFood=Math.max(this.cargoFood,t)},FleetDispatcher.prototype.selectMinFood=function(){this.cargoFood=0},FleetDispatcher.prototype.selectMaxAll=function(){this.cargoMetal=0,this.cargoCrystal=0,this.cargoDeuterium=0,this.selectMaxDeuterium(),this.selectMaxCrystal(),this.selectMaxMetal(),$("#food_box").length&&(this.cargoFood=0,this.selectMaxFood())},FleetDispatcher.prototype.resetCargo=function(){this.cargoMetal=0,this.cargoCrystal=0,this.cargoDeuterium=0,this.cargoFood=0},FleetDispatcher.prototype.updateCargo=function(){this.updateMetal(),this.updateCrystal(),this.updateDeuterium(),$("#food_box").length&&this.updateFood()},FleetDispatcher.prototype.updateMetal=function(){let t=getValue($("#metal").val()),e=this.getCargoCapacity()-this.cargoCrystal-this.cargoDeuterium-this.cargoFood;this.cargoMetal=Math.min(t,this.metalOnPlanet,e)},FleetDispatcher.prototype.updateCrystal=function(){let t=getValue($("#crystal").val()),e=this.getCargoCapacity()-this.cargoMetal-this.cargoDeuterium-this.cargoFood;this.cargoCrystal=Math.min(t,this.crystalOnPlanet,e)},FleetDispatcher.prototype.updateDeuterium=function(){let t=getValue($("#deuterium").val()),e=this.getCargoCapacity()-this.cargoMetal-this.cargoCrystal-this.cargoFood,i=this.getDeuteriumOnPlanetWithoutConsumption();this.cargoDeuterium=Math.min(t,this.deuteriumOnPlanet,e,i)},FleetDispatcher.prototype.updateFood=function(){if(!this.lifeformEnabled)return;let t=getValue($("#food").val()),e=this.getCargoCapacity()-this.cargoMetal-this.cargoCrystal-this.cargoDeuterium;this.cargoFood=Math.min(t,this.foodOnPlanet,e)},FleetDispatcher.prototype.selectMission=function(t){this.fleetHelper.isMissionValid(t)&&(this.mission=t),this.updateHoldingTime(),this.updateExpeditionTime(),this.refresh()},FleetDispatcher.prototype.selectRetreatAfterDefenderRetreat=function(t){this.retreatAfterDefenderRetreat=t},FleetDispatcher.prototype.selectLootFoodOnAttack=function(t){this.lootFoodOnAttack=t},FleetDispatcher.prototype.updateHoldingTime=function(){this.mission===this.fleetHelper.MISSION_HOLD?this.holdingTime=getValue($("#fleet2 #holdingtime").val()):this.holdingTime=0},FleetDispatcher.prototype.updateExpeditionTime=function(){this.mission===this.fleetHelper.MISSION_EXPEDITION?this.expeditionTime=getValue($("#fleet2 #expeditiontime").val()):this.expeditionTime=0},FleetDispatcher.prototype.selectPriority=function(t,e){if(this.lifeformEnabled||4!==e)switch(t){case"metal":if(this.prioMetal===e)break;this.prioCrystal===e&&(this.prioCrystal=this.prioMetal),this.prioDeuterium===e&&(this.prioDeuterium=this.prioMetal),this.prioFood===e&&(this.prioFood=this.prioMetal),this.prioMetal=e;break;case"crystal":if(this.prioCrystal===e)break;this.prioMetal===e&&(this.prioMetal=this.prioCrystal),this.prioDeuterium===e&&(this.prioDeuterium=this.prioCrystal),this.prioFood===e&&(this.prioFood=this.prioCrystal),this.prioCrystal=e;break;case"deuterium":if(this.prioDeuterium===e)break;this.prioMetal===e&&(this.prioMetal=this.prioDeuterium),this.prioCrystal===e&&(this.prioCrystal=this.prioDeuterium),this.prioFood===e&&(this.prioFood=this.prioDeuterium),this.prioDeuterium=e;break;case"food":if(this.prioFood===e)break;this.prioMetal===e&&(this.prioMetal=this.prioFood),this.prioCrystal===e&&(this.prioCrystal=this.prioFood),this.prioDeuterium===e&&(this.prioDeuterium=this.prioFood),this.prioFood=e}},FleetDispatcher.prototype.refreshDataAfterAjax=function(t){this.setOrders(t.orders),this.setTargetInhabited(t.targetInhabited),this.setTargetPlayerId(t.targetPlayerId),this.setTargetPlayerName(t.targetPlayerName),this.setTargetIsStrong(t.targetIsStrong),this.setTargetIsOutlaw(t.targetIsOutlaw),this.setTargetIsBuddyOrAllyMember(t.targetIsBuddyOrAllyMember),this.setTargetPlayerColorClass(t.targetPlayerColorClass),this.setTargetPlayerRankIcon(t.targetPlayerRankIcon),this.setPlayerIsOutlaw(t.playerIsOutlaw),this.setTargetPlanet(t.targetPlanet)},FleetHelper.prototype.isPlayerSpace=function(t){return t===this.PLAYER_ID_SPACE},FleetHelper.prototype.isPlayerLegor=function(t){return t===this.PLAYER_ID_LEGOR},FleetHelper.prototype.calcDistance=function(t,e,i,n){let a=Math.abs(t.galaxy-e.galaxy),s=Math.abs(t.system-e.system),o=Math.abs(t.position-e.position);if(0!=a){let t=Math.abs(a-this.MAX_GALAXY);return 1==this.DONUT_GALAXY&&t<a?2e4*t:2e4*a}if(0!=s){let t=Math.abs(s-this.MAX_SYSTEM),e=0;return e=1==this.DONUT_SYSTEM&&t<s?t:s,e=Math.max(e-i-n,1),5*e*19+2700}return 0!=o?5*o+1e3:5},FleetHelper.prototype.getFleetSpeedFaktor=function(t){let e=[this.MISSION_TRANSPORT,this.MISSION_DEPLOY,this.MISSION_COLONIZE,this.MISSION_EXPEDITION],i=[this.MISSION_ATTACK,this.MISSION_UNIONATTACK,this.MISSION_ESPIONAGE,this.MISSION_RECYCLE,this.MISSION_DESTROY,this.MISSION_MISSILEATTACK],n=[this.MISSION_HOLD];return e.includes(t)?this.SPEEDFAKTOR_FLEET_PEACEFUL:i.includes(t)?this.SPEEDFAKTOR_FLEET_WAR:n.includes(t)?this.SPEEDFAKTOR_FLEET_HOLDING:0},FleetHelper.prototype.calcDuration=function(t,e,i,n){return n=n||this.MISSION_NONE,Math.max(Math.round((35e3/i*Math.sqrt(10*t/e)+10)/this.getFleetSpeedFaktor(n)),1)},FleetHelper.prototype.calcConsumption=function(t,e,i,n,a){a=a||this.MISSION_NONE;let s=this,o=0,r=0,l=t.map((function(t){return t.id})),c=this.getMaxSpeed(l),d=this.calcDuration(e,c,i,a),u=Math.max(.5,d*this.getFleetSpeedFaktor(a)-10);return t.forEach((function(t){if(t.number){let i=s.getShipData(t.id),a=35e3/u*Math.sqrt(10*e/i.speed);r+=i.fuelConsumption*t.number*n,o+=Math.max(i.fuelConsumption*t.number*e/35e3*(a/10+1)*(a/10+1),1)}})),o=Math.round(o),o+=n>0?Math.max(Math.floor(r/10),1):0,o},FleetHelper.prototype.calcCargoCapacity=function(t,e){let i=this.getShipData(t);return Math.floor(i.baseCargoCapacity*e)},FleetHelper.prototype.calcFuelCapacity=function(t,e){return this.getShipData(t).baseFuelCapacity*e},FleetHelper.prototype.getMaxSpeed=function(t){let e=this,i=[];return t.forEach((function(t){let n=e.getShipData(t);n&&n.speed&&i.push(n.speed)})),i.reduce((function(t,e){return Math.min(t,e)}),1e9)},FleetHelper.prototype.getShipData=function(t){return void 0===this.shipsData?null:this.shipsData[t]},FleetHelper.prototype.isAggressiveMission=function(t){switch(t){case this.MISSION_ATTACK:case this.MISSION_UNIONATTACK:case this.MISSION_ESPIONAGE:case this.MISSION_DESTROY:return!0}return!1},FleetHelper.prototype.isMissionValid=function(t){switch(t){case this.MISSION_ATTACK:case this.MISSION_UNIONATTACK:case this.MISSION_TRANSPORT:case this.MISSION_DEPLOY:case this.MISSION_HOLD:case this.MISSION_ESPIONAGE:case this.MISSION_COLONIZE:case this.MISSION_RECYCLE:case this.MISSION_DESTROY:case this.MISSION_MISSILEATTACK:case this.MISSION_EXPEDITION:return!0}return!1};let sendingSystemDiscoveryMission=!1;function sendSystemDiscoveryMission(){"undefined"!=typeof sendDiscoverSystemUrl&&sendDiscoverSystemUrl&&"undefined"!=typeof galaxy&&galaxy&&"undefined"!=typeof system&&system&&(sendingSystemDiscoveryMission||(sendingSystemDiscoveryMission=!0,$.ajax({url:sendDiscoverSystemUrl,data:{galaxy:galaxy,system:system,_token:token},type:"POST",dataType:"json",success:function(t){token=t.newAjaxToken,t.response.success?(getAjaxEventbox(),getAjaxResourcebox(),t.response.sentToCoordinates.map((e=>{displayMiniFleetMessage({...t.response,coordinates:e},!1);$(".planetDiscover.position"+e.position).replaceWith(`\n                        <div class="planetDiscoverIcons planetDiscoverUnavailable tooltip icon js_hideTipOnMobile"\n                            title="${galaxyLoca.discoveryUnderway}">\n                        </div>\n                    `)}))):fadeBox(t.response.message,!0),sendingSystemDiscoveryMission=!1},error:function(){sendingSystemDiscoveryMission=!1}})))}function addToTable(t,e,i){let n=t.message||t;if(null!=i&&(n+=" ("+tsdpkt(i)+") "+LocalizationStrings.ok),isMobile)return void fadeBox(n,"success"!=e);let a="<div "+('id="'+("fleetstatus"+(new Date).getTime())+'"')+" "+('class="'+e+'"')+">"+n+"</div>";$("#fleetstatusrow").has("div").length&&$("#fleetstatusrow").empty(),$(a).prependTo("#fleetstatusrow").fadeOut(3e3,(function(){$(this).remove()}))}function setShips(t,e){var i=document.getElementById(t);null!==i&&(i.innerHTML=e)}function renderContentGalaxy(t){token=t.token,updateOverlayToken("phalanxSystemDialog",t.token),updateOverlayToken("phalanxDialog",t.token),toGalaxyLink=t.system.toGalaxyLink,$("#amountColonized").html(t.system.slotsColonized),$("#probeValue").html(t.system.availableProbes),$("#recyclerValue").html(t.system.availableRecyclers),$("#missileValue").html(t.system.availableMissiles),$("#slotUsed").html(t.system.usedFleetSlots),$("#slotValue").html(t.system.maximumFleetSlots),$("input#galaxy_input").val(t.system.galaxy),$("input#system_input").val(t.system.system),canSwitchGalaxy=t.system.canSwitchGalaxy,$.each(t.filterSettings,(function(t,e){e&&$(`#filterCell #${t}`).addClass("filter_active")})),canSwitchGalaxy||fadeBox(notEnoughDeuteriumMessage,!0),preserveSystemOnPlanetChange&&$(".planetlink, .moonlink").querystring({galaxy:t.system.galaxy,system:t.system.system}),$("#expeditionDebris").remove(),$("#galaxyRow17planet").remove(),$("#galaxyRow17debris").remove(),buildListCountdowns.map((t=>{timerHandler.removeCallback(t.getTimer)})),buildListCountdowns=[];for(const e of t.system.galaxyContent)if(clearPosition(e.position),16!==e.position)if(17!==e.position)if($("#galaxyRow"+e.position).addClass(e.positionFilters),e.planets.length>0){let i=!1;for(const n of e.planets)switch(n.planetType){case 1:renderPlanet(e,n,t.system),i=!0;break;case 2:renderDebris(e,n,t.system);break;case 3:renderMoon(e,n,t.system),i=!0}i?(renderPlayer(e,t.system),colorNumberInFrontOfFriendsPlanet(e),renderPhalanx(e),renderAlliance(e,t.system),renderActions(e,t.system)):renderEmptySlot(e,t.system,t.reservedPositions)}else renderEmptySlot(e,t.system,t.reservedPositions);else renderEventSpaceObjects(e,t.system);else $("#expeditionDebrisSlotDebrisContainer").append(`\n                <div id="expeditionDebris" class="name float_left tooltipRel tooltipClose tooltipRight js_hideTipOnMobile js_bday_debris tpd-hideOnClickOutside" rel="debris16">\n                    <div style="position: relative;width: 30px;height: 30px;display: inline-block;">\n                        <img class="float_left" src="/img/icons/fa3e396b8af2ae31e28ef3b44eca91.gif" width="30" height="30"/>\n                        ${addFleetContainer(e.position,e.planets.planetType)}\n                    </div>\n                </div>\n            `),$("#expeditionDebris").append(getDebrisTooltip(e.planets,e,t.system)),getFleetIcon(e.planets.fleet,e.position,e.planets.planetType);$("#galaxyLoading").hide(),inProgress=!1,void 0!==IPI&&IPI.refreshHighlights()}function renderPlanet(t,e,i){$("#galaxyRow"+t.position+" .cellPlanetName").html(`<span class="${t.player.isBuddy?"status_abbr_buddy":""}">${e.planetName}</span>`),$("#galaxyRow"+t.position+" .cellPlanet").html(`<a href="javascript: void(0);" onclick="${getEspionageMission(t,e,i)}"><div class="microplanet"></div></a>`),$("#galaxyRow"+t.position+" .cellPlanet .microplanet").addClass(e.imageInformation).append(getActivityStar(e.activity)).append(addFleetContainer(t.position,e.planetType)).append(getFleetIcon(e.fleet,t.position,e.planetType)).attr("data-planet-id",e.planetId).addClass("planetTooltip tooltipRel tooltipPersistent tooltipClose tooltipRight js_hideTipOnMobile").attr("rel","planet"+t.position).append(getPlanetTooltip(e,t,i))}function renderDebris(t,e,i){$("#galaxyRow"+t.position+" .cellDebris").html(`<a href="javascript: void(0);"><div class="microdebris ${e.imageInformation}"></div></a>`),$("#galaxyRow"+t.position+" .cellDebris .microdebris").append(addFleetContainer(t.position,e.planetType)).append(getFleetIcon(e.fleet,t.position,e.planetType)).attr("rel","debris"+t.position).addClass("tooltipRel tooltipClose tooltipRight js_hideTipOnMobile").append(getDebrisTooltip(e,t,i))}function renderMoon(t,e,i){$("#galaxyRow"+t.position+" .cellMoon").html(`<a href="javascript: void(0);" onclick="${getEspionageMission(t,e,i)}"><div class="micromoon ${e.imageInformation}"></div></a>`),$("#galaxyRow"+t.position+" .cellMoon .micromoon").append(getActivityStar(e.activity)).append(addFleetContainer(t.position,e.planetType)).append(getFleetIcon(e.fleet,t.position,e.planetType)).attr("data-moon-id",e.planetId).attr("rel","moon"+t.position).addClass("tooltipRel tooltipClose tooltipRight js_hideTipOnMobile").append(getMoonTooltip(e,t,i))}function renderPlayer(t,e){let{player:i}=t;i&&99999!==i.playerId&&$("#galaxyRow"+t.position+" .cellPlayerName").html(getPlayerName(t,e))}function colorNumberInFrontOfFriendsPlanet(t){let{player:e}=t;e.isBuddy&&$("#galaxyRow"+t.position+" .cellPosition").addClass("status_abbr_buddy")}function renderEmptySlot(t,e,i){if(t.availableMissions){let n=$("#galaxyRow"+t.position+" .cellPlanetName");n.html("");let a=i[t.position];a&&a.isReserved&&parseInt(a.user_id)===e.playerId&&(n.append(`\n                <span class="planetMoveGalaxyCooldown" id="cooldown-${t.position}">\n                    ${loca.LOCA_ALL_AJAXLOAD}\n                </span>\n            `),buildListCountdowns.push(new SimpleCountdownTimer(`#cooldown-${t.position}`,a.cooldown,toGalaxyLink))),renderEmptySlotActions(t,e)}}function renderPhalanx(t){let{player:e}=t;e&&t.actions.canPhalanx&&(t.actions.phalanxInactive?$("#galaxyRow"+t.position+" .cellPlanetName").append(`<div class="tooltip js_hideTipOnMobile phalanxInctive" title="${t.actions.phalanxInactiveReason}"></div>`):($("#galaxyRow"+t.position+" .cellPlanetName").append('<a class="phalanxlink" href="javascript:void(0);"></a>'),$("#galaxyRow"+t.position+" .cellPlanetName .phalanxlink").append('<div class="tooltip js_hideTipOnMobile phalanxActive"></div>').attr("title","Use phalanx"),$("#galaxyRow"+t.position+" .cellPlanetName .phalanxlink").on("click",(function(e){e.preventDefault(),scanWithPhalanx(t.galaxy,t.system,t.position)}))))}function renderAlliance(t,e){let{player:i}=t;i.allianceId&&$("#galaxyRow"+t.position+" .cellAlliance").html(`\n                <span\n                class="${i.isAllianceMember?"status_abbr_ally_own":""} tooltipRel tooltipClose tooltipRight js_hideTipOnMobile"\n                rel="alliance${i.allianceId}">\n                    ${i.allianceTag} ${getAllianceTooltip(t,e)}\n                </span>\n            `)}function renderActions(t,e){if(e.playerId!==t.player.playerId)$("#galaxyRow"+t.position+" .cellAction").html(`${getActions(t,e)}`);else{let e=`\n        ${getDiscoveryLinkIcon(t)}\n        <div class="emptyAction"></div>\n        <div class="emptyAction"></div>\n        <div class="emptyAction"></div>\n        <div class="emptyAction"></div>\n       `;$("#galaxyRow"+t.position+" .cellAction").html(getDiscoveryLinkIcon(t)).html(`${e}`)}}function renderEmptySlotActions(t,e){$("#galaxyRow"+t.position+" .cellAction").html(`${getEmptySlotActions(t,e)}`)}function getPlayerName(t,e){let{player:i}=t,n="";return i.rank&&i.rank.hasRank&&(n=`<span class="honorRank ${i.rank.rankClass} tooltip js_hideTipOnMobile" title="${i.rank.rankTitle}"></span>`),i.playerId!==e.playerId?n+=`<span class="playerName tooltipRel tooltipClose tooltipRight js_hideTipOnMobile ${getPlayerColorClass(i)}"\n           rel="player${i.playerId}">${i.playerName}${getPlayerTooltip(t)}</span>`:n+=`<span class="${getPlayerColorClass(i)} ownPlayerRow">${i.playerName}</span>`,n+=getPlayerAbbreviations(i,t),n}function getPlayerColorClass(t){switch(!0){case t.isAdmin:return"status_abbr_admin";case t.isBanned:return"status_abbr_banned";case t.isOnVacation:return"status_abbr_vacation";case t.isLongInactive:return"status_abbr_longinactive";case t.isInactive:return"status_abbr_inactive";case t.isOutlaw:return"status_abbr_outlaw";case t.isNewbie:return"status_abbr_noob";case t.isStrong:return"status_abbr_strong";case t.isHonorableTarget:return"status_abbr_honorableTarget"}return"status_abbr_active"}function getPlayerAbbreviations(t){let e=[];return t.isAdmin?e.push(`<span class="status_abbr_admin tooltip js_hideTipOnMobile" title="${loca.LOCA_GALAXY_LEGEND_ADMIN}">${loca.LOCA_GALAXY_PLAYER_STATUS_A}</span>`):(t.isBanned&&e.push(`<span class="status_abbr_banned tooltip js_hideTipOnMobile" title="${loca.LOCA_GALAXY_LEGEND_BANNED}">${loca.LOCA_GALAXY_PLAYER_STATUS_G}</span>`),t.isOnVacation&&e.push(`<span class="status_abbr_vacation tooltip js_hideTipOnMobile" title="${loca.LOCA_STATION_JUMP_VACATION}">${loca.LOCA_GALAXY_PLAYER_STATUS_U}</span>`),t.isLongInactive?e.push(`<span class="status_abbr_longinactive tooltip js_hideTipOnMobile" title="${loca.LOCA_GALAXY_LEGEND_TWENTYEIGHT_DAYS_INACTIVE}">${loca.LOCA_GALAXY_PLAYER_STATUS_I_LONG}</span>`):t.isInactive&&e.push(`<span class="status_abbr_inactive tooltip js_hideTipOnMobile" title="${loca.LOCA_GALAXY_LEGEND_SEVEN_DAYS_INACTIVE}">${loca.LOCA_GALAXY_PLAYER_STATUS_I}</span>`),t.isOutlaw&&e.push(`<span class="status_abbr_outlaw tooltipHTML" title="${loca.LOCA_GALAXY_LEGEND_OUTLAW}|${loca.LOCA_OUTLAW_EXPLANATION}">${loca.LOCA_GALAXY_PLAYER_STATUS_OUTLAW}</span>`),t.isNewbie&&e.push(`<span class="status_abbr_noob tooltip js_hideTipOnMobile" title="${loca.LOCA_GALAXY_LEGEND_NOOB}">${loca.LOCA_GALAXY_PLAYER_STATUS_N}</span>`),t.isStrong&&e.push(`<span class="status_abbr_strong tooltip js_hideTipOnMobile" title="${loca.LOCA_GALAXY_LEGEND_STRONG_PLAYER}">${loca.LOCA_GALAXY_PLAYER_STATUS_S}</span>`),t.isHonorableTarget&&e.push(`<span class="status_abbr_honorableTarget tooltipHTML" title="${loca.LOCA_GALAXY_LEGEND_HONORABLE_TARGET}|${loca.LOCA_GALAXY_LEGEND_HONORABLE_TARGET_EXPLANATION}">${loca.LOCA_GALAXY_PLAYER_STATUS_EP}</span>`)),e.length?`<pre> (${e.join()})</pre>`:""}function getPlayerSelectedLanguage(t){return t.selectedLanguageIcon?` <selected-language-icon style="background-image: url('${t.selectedLanguageIcon}');" ></selected-language-icon> `:""}function getActivityStar(t){return!1===t.showActivity?"":t.showMinutes&&60===t.showActivity?`<div class="activity showMinutes tooltip js_hideTipOnMobile hideTooltipOnMouseenter"\n                title="${loca.LOCA_ALL_ACTIVITY}">\n                ${t.idleTime}\n            </div>`:`<div class="activity minute${t.showActivity} tooltip js_hideTipOnMobile hideTooltipOnMouseenter"\n            title="${loca.LOCA_ALL_ACTIVITY}">\n        </div>`}function addFleetContainer(t,e){return`<div id="ownFleetStatus_${t}_${e}"\n            class="fleetAction js_hideTipOnMobile hideTooltipOnMouseenter"\n            title="">\n        </div>`}function getFleetIcon(t,e,i){if(!t||!t.length)return"";$(`#ownFleetStatus_${e}_${i}`).removeClass("fleetNeutral").addClass("tooltip").addClass(t[0].class).attr("title",t[0].text)}function getPlanetTooltip(t,e,i){let{galaxy:n,system:a,position:s}=e;return`\n        <div id="planet${s}" style="display: none;" class="htmlTooltip galaxyTooltip">\n            <h1>${loca.LOCA_ALL_PLANET}: <span class="textNormal">${t.planetName}</span></h1>\n            <div class="splitLine"></div>\n            <ul class="ListImage">\n                <li><span>[${n}:${a}:${s}]</span></li>\n                <li><div class="planetTooltip microplanet ${t.imageInformation}"></div></li>\n            </ul>\n            <ul class="ListLinks">\n                ${getPlanetOrMoonTooltipLinks(t,e,i)}\n            </ul>\n        </div>\n        `}function getMoonTooltip(t,e,i){let{galaxy:n,system:a,position:s}=e;return`\n        <div id="moon${s}" style="display: none;" class="htmlTooltip galaxyTooltip">\n            <h1><span class="textNormal">${t.planetName}</span></h1>\n            <div class="splitLine"></div>\n            <ul class="ListImage">\n                <li><span id="pos-moon">[${n}:${a}:${s}]</span></li>\n                <li><div class="moonTooltip micromoon ${t.imageInformation}"></div></li>\n                <li><span id="moonsize" title="${loca.LOCA_GALAXY_MOON_DIAMETER_KM}">${t.size} ${loca.LOCA_OVERVIEW_JS_KM}</span></li>\n            </ul>\n            <ul class="ListLinks">\n                ${getPlanetOrMoonTooltipLinks(t,e,i)}\n            </ul>\n        </div>\n        `}function getPlanetOrMoonTooltipLinks(t,e,i){let n=getActivityElement(t.activity),{currentPlanetId:a}=i;if(t.planetId===a)return n+=loca.LOCA_FLEET_NO_ACTION_AVAILABLE,n;let{galaxy:s,system:o,position:r,player:l}=e;if(l.isOnVacation)return n+=loca.LOCA_FLEET_PLAYER_UMODE,n;if(!i.canFly)return n+=`<li>${loca.LOCA_FLEET_NO_FREE_SLOTS}</li>`,i.hasAdmiral||(n+=`<li><a href="${premiumLink}">${loca.LOCA_HEADER_GETADMIRAL}</a></li>`),n;if(t.availableMissions){if(t.availableMissions.map((a=>{if(a.missionType===constants.espionage){if(a.canSpy){let s=getEspionageMission(e,t,i);s&&(n+=`<li><a href="#"\n                                onClick="${s}">\n                                ${a.name}\n                            </a></li>`)}a.reportId&&a.reportLink&&(n+=`<li><a href="${a.reportLink}" class="overlay">${loca.LOCA_MESSAGES_ESPIONAGEREPORT}</a></li>`)}else n+=`<li><a href="${a.link}">${a.name}</a></li>`})),e.actions.canMissileAttack&&!l.isAdmin){let a=t.availableMissions.find((t=>5===t.missionType));i.showOutlawWarning&&!i.isOutlaw&&l.isStrong&&!a?n+=`<li><a href="#"\n                            onClick="outlawWarning(${constants.missleattack}, ${s}, ${o}, ${r}, ${t.planetType}, ${i.availableMissiles});return false;">\n                            ${loca.LOCA_FLEET_MISSILEATTACK}\n                        </a></li>`:n+=`<li><a class="overlay" href="${e.actions.missileAttackLink}&planetType=${t.planetType}" data-overlay-modal='true'>${loca.LOCA_FLEET_MISSILEATTACK}</a></li>`}return n}return loca.LOCA_FLEET_NO_ACTION_AVAILABLE}function getEspionageMission(t,e,i){let{galaxy:n,system:a,position:s,player:o}=t,{settingsProbeCount:r}=i,l=e.availableMissions.find((t=>t.missionType===constants.espionage)),c=e.availableMissions.find((t=>5===t.missionType));return l&&l.canSpy&&!o.isAdmin&&n&&a&&s&&r?i.showOutlawWarning&&!i.isOutlaw&&o.isStrong&&!c?`outlawWarning(${l.missionType}, ${n}, ${a}, ${s}, ${e.planetType}, ${r});return false;`:`sendShips(${l.missionType}, ${n}, ${a}, ${s}, ${e.planetType}, ${r});return false;`:""}function getDebrisTooltip(t,e,i){let{galaxy:n,system:a,position:s}=e,{metal:o,crystal:r,deuterium:l}=t.resources,c=Math.min(t.requiredShips,16===s?i.availablePathfinders:i.availableRecyclers),d="";return i.canFly?d=c&&(16===s?i.availablePathfinders:i.availableRecyclers)&&t.recyclePossible?`<li><a href="#"\n            onClick="sendShips(8, ${e.galaxy}, ${e.system}, ${e.position}, ${t.planetType}, ${c});return false;">\n                ${loca.LOCA_GALAXY_DEBRIS_REDUCE}\n            </a></li>`:`<li><span class="inactiveLink">${loca.LOCA_GALAXY_DEBRIS_REDUCE}</span></li>`:(d+=`<li>${loca.LOCA_FLEET_NO_FREE_SLOTS}</li>`,i.hasAdmiral||(d+=`<li><a href="${premiumLink}">${loca.LOCA_HEADER_GETADMIRAL}</a></li>`)),`\n        <div id="debris${s}" style="display: none;" class="htmlTooltip galaxyTooltip">\n            <h1>${loca.LOCA_FLEET_DEBRIS}</h1>\n            <div class="splitLine"></div>\n            <ul class="ListImage">\n                <li><span id="pos-debris">[${n}:${a}:${s}]</span></li>\n                <li><div class="debrisTooltip microdebris ${t.imageInformation}"></div></li>\n            </ul>\n            <ul class="ListLinks">\n                <li class="debris-content">${loca.LOCA_ALL_METAL}: ${number_format(o.amount,0)}</li>\n                <li class="debris-content">${loca.LOCA_ALL_CRYSTAL}: ${number_format(r.amount,0)}</li>\n                <li class="debris-content">${loca.LOCA_ALL_DEUTERIUM}: ${number_format(l.amount,0)}</li>\n                <li class="debris-recyclers">${16===s?loca.LOCA_GALAXY_PATHFINDER_NEEDED:loca.LOCA_GALAXY_RECYCLER_NEEDED}: ${number_format(t.requiredShips,0)}</li>\n                ${d}\n            </ul>\n        </div>\n        `}function getPlayerTooltip(t){let{player:e}=t,{actions:i}=e,n="";if(i.highscore.available){let t=`\n            <a href="${i.highscore.link}">${e.highscorePositionPlayer}</a>\n        `;n=`<li class="rank">${i.highscore.title}: ${t}</li>`}let a="";i.message.available&&(a=i.message.disabledChatBar?`<li><a href="${i.message.link}" data-playerId="${e.playerId}">${i.message.title}</a></li>`:`<li><a href="javascript:void(0)" class="sendMail js_openChat" data-playerId="${e.playerId}">${i.message.title}</a></li>`);let s="";i.buddies.available&&(s=`\n                <li><a href="javascript:void(0);" class="sendBuddyRequestLink" data-playerid="${i.buddies.playerId}" data-playername="${i.buddies.playerName}">${i.buddies.title}</a></li>\n            `);let o="";i.support&&i.support.available&&(o=`\n                <li>\n                    <a style="margin-top: 4px;"\n                    href="${i.support.link}"\n                    target="_blank" title="${i.support.title}"\n                    class="js_hideTipOnMobile no_decoration">\n                        <span class="support_icon icon icon_mail" style="margin-top: 5px;"></span> &nbsp;\n                        <div style="position:absolute; top: 32px;left:30px">${i.support.title}</div>\n                    </a>\n                </li>\n            `);let r="";return i.ignore.available&&(r=`<li><a href="javascript:void(0);" class="ignorePlayerLink" data-playerid="${i.ignore.playerId}" data-playername="${i.ignore.playerName}">${i.ignore.title}</a></li>`),`\n        <div id="player${e.playerId}" style="display: none;"  class="htmlTooltip galaxyTooltip">\n            <h1>${getPlayerSelectedLanguage(e)}<span>${e.playerName}</span></h1>\n            <div class="splitLine"></div>\n            <ul class="ListLinks">\n                ${n}\n                ${a}\n                ${s}\n                ${o}\n                ${r}\n            </ul>\n        </div>\n        `}function renderEventSpaceObjects(t,e){t.planets.map((i=>{switch(i.planetType){case 1:renderEventPlanet(i,t,e);break;case 2:renderEventDebris(i,t,e)}}))}function renderEventPlanet(t,e,i){if(!t)return;let n=$("div.expeditionDebrisSlotBoxRow"),a=parseInt(n.find(".cellPosition").text())+1;n.after(`\n        <div class="eventSlotRow">\n            <div class="eventSlotBoxCell cellPosition">${a}</div>\n            <div class="bdaySlotBox"  id="galaxyRow17planet">\n                <div>\n                    <h3 class="title float_left">${loca.LOCA_EVENTH_ENEMY_INFINITELY_SPACE}:</h3>\n                </div>\n                <div class="birthdayNameWrapper">\n                    <div id="birthdayName" class="name float_left tooltipRel tooltipClose tooltipRight js_hideTipOnMobile js_bday_planet"\n                       rel="planet17"\n                    >\n                        <div style="position: relative;width: 30px;height: 30px;display: inline-block;">\n                            <img class="float_left"\n                                src="${t.imageInformation}"\n                                width="30"\n                                height="30"\n                            />\n                            ${addFleetContainer(e.position,t.planetType)}\n                        </div>${t.planetName}\n                        ${getEventPlanetTooltip(t,e,i)}\n                    </div>\n                </div>\n            </div>\n        </div>\n    `),getFleetIcon(t.fleet,e.position,t.planetType)}function renderEventDebris(t,e,i){if(!t)return;let n=t.resources.darkMatter;if(!n||!n.amount)return;let a=$("#galaxyRow17planet");a.length||(a=$("div.expeditionDebrisSlotBoxRow"));let s=parseInt(a.find(".cellPosition").text())+1;a.after(`\n        <div class="eventSlotRow">\n            <div class="eventSlotBoxCell cellPosition">${s}</div>\n            <div class="bdaySlotBox"  id="galaxyRow17debris">\n                <div>\n                    <h3 class="title float_left">${loca.LOCA_EVENTH_ENEMY_INFINITELY_SPACE}:</h3>\n                </div>\n                <div class="birthdayNameWrapper">\n                    <div id="birthdayName" class="name float_left tooltipRel tooltipClose tooltipRight js_hideTipOnMobile js_bday_planet"\n                       rel="debris17"\n                    >\n                        <div style="position: relative;width: 30px;height: 30px;display: inline-block;">\n                            <img class="float_left" src="/img/icons/e1b6654d1b29bc65aea0b8fc79be80.png" width="30" height="30"/>\n                            ${addFleetContainer(e.position,t.planetType)}\n                        </div>${t.planetName}\n                        ${getEventDebrisTooltip(t,e,i)}\n                    </div>\n                </div>\n            </div>\n        </div>\n    `),getFleetIcon(t.fleet,e.position,t.planetType)}function getEventPlanetTooltip(t,e,i){let{galaxy:n,system:a,position:s}=e,o="";return i.canFly?t.availableMissions.map((n=>{if(n.missionType===constants.espionage){if(n.canSpy){let a=getEspionageMission(e,t,i);a&&(o+=`<li><a href="#"\n                                onClick="${a}">\n                                ${n.name}\n                            </a></li>`)}n.reportId&&n.reportLink&&(o+=`<li><a href="${n.reportLink}" class="overlay">${loca.LOCA_MESSAGES_ESPIONAGEREPORT}</a></li>`)}else o+=`<li><a href="${n.link}">${n.name}</a></li>`})):(o+=`<li>${loca.LOCA_FLEET_NO_FREE_SLOTS}</li>`,i.hasAdmiral||(o+=`<li><a href="${premiumLink}">${loca.LOCA_HEADER_GETADMIRAL}</a></li>`)),`\n        <div id="planet${s}" style="display: none;" class="htmlTooltip galaxyTooltip">\n            <h1>${loca.LOCA_ALL_PLANET}: <span class="textNormal">${t.planetName}</span></h1>\n            <div class="splitLine"></div>\n            <ul class="ListImage">\n                <li><span>[${n}:${a}:${s}]</span></li>\n                <li><img src="${t.imageInformation}" alt="" height="30" width="30"></li>\n            </ul>\n            <ul class="ListLinks">\n                ${o}\n            </ul>\n        </div>\n        `}function getEventDebrisTooltip(t,e,i){let{galaxy:n,system:a,position:s}=e,o=number_format(t.resources.darkMatter.amount),r=t.requiredShips,l="";if(i.canFly)if(i.availableRecyclers>0){l=`<li><a href="#" onClick="${`sendShips(8, ${n}, ${a}, ${s}, ${t.planetType}, ${r})`};return false">${loca.LOCA_GALAXY_DEBRIS_REDUCE}</a></li>`}else l=`<li><span class="inactiveLink">${loca.LOCA_GALAXY_DEBRIS_REDUCE}</span></li>`;else l+=`<li>${loca.LOCA_FLEET_NO_FREE_SLOTS}</li>`,i.hasAdmiral||(l+=`<li><a href="${premiumLink}">${loca.LOCA_HEADER_GETADMIRAL}</a></li>`);let c=loca.LOCA_FLEET_DEBRIS;return`\n        <div id="debris${s}" style="display: none;" class="htmlTooltip galaxyTooltip">\n            <h1>${c}</h1>\n            <div class="splitLine"></div>\n            <ul class="ListImage">\n                <li><span id="pos-debris">[${n}:${a}:${s}]</span></li>\n                <li><img class="float_left" src="/img/icons/e1b6654d1b29bc65aea0b8fc79be80.png" width="30" height="30" alt="${c}"/></li>\n            </ul>\n            <ul class="ListLinks">\n                <li class="debris-content">${loca.LOCA_ALL_DARKMATTER}: ${o}</li>\n                ${l}\n            </ul>\n        </div>\n    `}function getActions(t,e){let{galaxy:i,system:n,position:a,player:s}=t,{actions:o}=s,r=t.planets.find((t=>1===t.planetType)),l=r.availableMissions.find((t=>5===t.missionType)),c="";r.availableMissions.find((t=>6===t.missionType&&t.reportId))&&(c="hueRotate");let d="";if(s.isAdmin)d='<div class="emptyAction"></div>';else if(!1===t.actions.canEspionage)d=`<a class="tooltip js_hideTipOnMobile espionage"\n                   title="${loca.LOCA_FLEET_NO_ESPIONAGE}"\n                   href="javascript: void(0);"\n                >\n                    <span class="icon icon_eye grayscale"></span>\n                </a>`;else{let i="ipiGalaxyActionSpy";t.player.isOnVacation&&(i="ipiGalaxyActionSpyVacation"),d=`\n                <a class="tooltip js_hideTipOnMobile espionage ipiHintable"\n                       title="${loca.LOCA_FLEET_ESPIONAGE}"\n                       href="javascript: void(0);"\n                       onclick="${getEspionageMission(t,r,e)}"\n                       data-ipi-hint="${i}"\n                    >\n                    <span class="icon icon_eye ${c}"></span>\n                </a>`}let u="";u=o.message.available?o.message.disabledChatBar?`<a href="${o.message.link}" class="tooltip" data-playerId="${s.playerId}" title="${o.message.title}"><span class="icon icon_chat"></span></a>`:`<a href="javascript:void(0)" class="sendMail js_openChat tooltip" data-playerId="${s.playerId}" title="${o.message.title}"><span class="icon icon_chat"></span></a>`:o.support&&o.support.available?`\n                <a href="${o.support.link}"\n                    target="_blank" title="${o.support.title}"\n                    class="tooltip js_hideTipOnMobile icon">\n                        <span class="support_icon icon icon_mail"></span>\n                </a>\n            `:'<div class="emptyAction"></div>';let h="";h=o.buddies.available?`\n            <a class="tooltip overlay buddyrequest ipiHintable"\n               title="Buddy request to player"\n               href="${o.buddies.link}"\n               data-overlay-title="Buddy request to player"\n               data-playerid="${o.buddies.playerId}"\n               data-playername="${o.buddies.playerName}"\n               data-ipi-hint="ipiGalaxySendBuddyRequest"\n            >\n                <span class="icon icon_user"></span>\n            </a>`:'<div class="emptyAction"></div>';let p="";p=t.actions.canMissileAttack&&!s.isAdmin&&i&&n&&a?e.showOutlawWarning&&!e.isOutlaw&&s.isStrong&&!l?`\n                <a class="tooltip js_hideTipOnMobile missleattack"\n                       title="${loca.LOCA_FLEET_MISSILEATTACK}"\n                       href="javascript: void(0);"\n                       onclick="outlawWarning(\n                       10,\n                       ${i},\n                       ${n},\n                       ${a},\n                       1,\n                       ${e.availableMissiles}\n                               ); return false;"\n                    >\n                    <span class="icon icon_missile"></span>\n                </a>`:`<a class="tooltip js_hideTipOnMobile overlay missleattack"\n               title="${loca.LOCA_FLEET_MISSILEATTACK}"\n               href="${t.actions.missileAttackLink}&planetType=${r.planetType}"\n               data-overlay-modal='true'\n            >\n                <span class="icon icon_missile"></span>\n            </a>`:s.isAdmin?'<div class="emptyAction"></div>':`<a class="tooltip js_hideTipOnMobile missleattack"\n               title="${loca.LOCA_FLEET_MISSILEATTACK}"\n               href="javascript: void(0);"\n            >\n                <span class="icon icon_missile grayscale"></span>\n            </a>`;return`\n        ${getDiscoveryLinkIcon(t)}\n        ${d}\n        ${u}\n        ${h}\n        ${p}\n        `}function getEmptySlotActions(t,e){let i='<div class="emptyAction"></div>',n=t.availableMissions.find((t=>7===t.missionType)),a="";a=e.canColonize&&n&&"#"!==n.link?`<a href="${n.link}" class="tooltip planetMoveIcons colonize-active icon tpd-hideOnClickOutside ipiHintable" data-ipi-hint="ipiGalaxyColonize">\n                    <div class="tooltip planetMoveIcons colonize-active icon tpd-hideOnClickOutside"\n                      title="${n.description}"></div></a>`:`<div class="tooltip planetMoveIcons colonize-inactive icon tpd-hideOnClickOutside"\n                      title="${n?n.description:loca.LOCA_GALAXY_ERROR_COLONIZATION}"></div>`;let s=t.availableMissions.find((t=>0===t.missionType)),o="";o=void 0===s?'<div class="emptyAction"></div>':!0===s.planetMovePossible?`<a class="planetMoveIcons planetMoveDefault tooltip icon js_hideTipOnMobile"\n               href="javascript: void(0);"\n               onClick="movePlanet(\n                       '${s.moveLink}',\n                       {'position':${t.position},\n                       'galaxy': ${t.galaxy},\n                       'system': ${t.system}},\n                       '${s.galaxyLink}'\n                       ); return false;"\n               title="${s.title}"\n            ><div class="planetMoveIcons planetMoveDefault tooltip icon js_hideTipOnMobile"\n                      title="${s.title}"></div></a>`:`<div class="planetMoveIcons planetMoveInactive tooltip icon"\n                      title="${s.title}"></div>`;return`\n        ${getDiscoveryLinkIcon(t)}\n        ${a}\n        ${o}\n        ${i}\n        ${i}\n        `}function getDiscoveryLinkIcon(t){let e="";if(!0===constants.lifeformEnabled){const i=t.availableMissions.find((t=>t.missionType===constants.discover));if(void 0!==i)if(!0===i.canSend){const n=galaxyLoca.discoverySend+" "+i.discoveryCount;e=`<div class="planetDiscoverIcons planetDiscoverDefault icon"><a href="#"\n                    class="tooltip js_hideTipOnMobile ipiHintable planetDiscover position${t.position}"\n                    data-ipi-hint="ipiDiscoverLifeform"\n                    onClick="discoverPlanet(\n                        '${i.link}',\n                        {\n                            'galaxy': ${t.galaxy},\n                            'system': ${t.system},\n                            'position':${t.position},\n                            '_token': token\n                        }\n                    ); return false;"\n                    title="${n}">\n                </a></div>`}else e=`<div class="planetDiscoverIcons planetDiscoverUnavailable tooltip ipiHintable icon js_hideTipOnMobile"\n                    data-ipi-hint="ipiDiscoverLifeform"\n                    title="${i.canSend}">\n                </div>`}return e}function getAllianceTooltip(t){let{player:e}=t,{alliance:i}=e.actions;if(!i)return"";let n,a="";i.allianceClassName&&i.allianceClassCss&&(a=`<li>${loca.LOCA_ALLIANCE_CLASS}: <span class="${i.allianceClassCss}">${i.allianceClassName}</span></li>`),n=e.isAllianceMember?`<li><a href="${i.infoPageLink}">${i.infoPageTitle}</a></li>`:`<li><a href="allianceInfo.php?allianceId=${e.allianceId}" target="_ally">${i.infoPageTitle}</a></li>`;let s="";return i.applicationLink&&i.applicationTitle&&(s=`<li><a href="${i.applicationLink}">${i.applicationTitle}</a></li>`),`\n        <div id="alliance${e.allianceId}" style="display: none;"  class="htmlTooltip galaxyTooltip">\n            <h1>\n                ${getAllianceSelectedLanguage(e)}\n                ${e.allianceName}\n            </h1>\n            <div class="splitLine"></div>\n            <ul class="ListLinks">\n                <li class="rank">${loca.LOCA_GALAXY_RANK}: <a href="${i.highscoreLink}">${i.highscoreTitle}</a></li>\n                <li class="members">${loca.LOCA_NETWORK_USERS}: ${i.memberCount}</li>\n                ${a}\n                ${n}\n                ${s}\n            </ul>\n        </div>\n        `}function getAllianceSelectedLanguage(t){return t.allianceSelectedLanguage?` <selected-language-icon style="background-image: url('${t.allianceSelectedLanguage}');" ></selected-language-icon> `:""}function getActivityElement(t){let{idleTime:e,showActivity:i}=t;if(i){let t;return t=60===i?loca.LOCA_ALL_ACTIVITY+": "+e+loca.LOCA_ALL_TIME_MINUTE:loca.LOCA_ALL_ACTIVITY+":<div class=\"alert_triangle\"><img src='/img/icons/b4c8503dd1f37dc9924909d28f3b26.gif'/></div>",`<li>${t}</li>`}return""}function clearPosition(t){$("#galaxyRow"+t+" .cellPosition").removeClass("status_abbr_buddy"),$("#galaxyRow"+t+" .cellPlanet").html(""),$("#galaxyRow"+t+" .cellPlayerName").html(""),$("#galaxyRow"+t+" .cellPlanetName").html(""),$("#galaxyRow"+t+" .cellMoon").html(""),$("#galaxyRow"+t+" .cellDebris").html(""),$("#galaxyRow"+t+" .cellAlliance").html(""),$("#galaxyRow"+t+" .cellAction").html("");let e=$("#galaxyRow"+t);e.removeClass("inactive_filter"),e.removeClass("filtered_filter_inactive"),e.removeClass("vacation_filter"),e.removeClass("filtered_filter_vacation"),e.removeClass("strong_filter"),e.removeClass("filtered_filter_strong"),e.removeClass("newbie_filter"),e.removeClass("filtered_filter_newbie"),e.removeClass("empty_filter"),e.removeClass("filtered_filter_empty")}function displayContentGalaxy(t){var e=$.parseJSON(t);$("#galaxyContent").html(e.galaxy),$("galaxyContent").find("script").each((function(){$.globalEval($(this).text())})),tabletInitGalaxyDetails(),eventBDayInitGalaxy(),$("#galaxyLoading").hide(),preserveSystemOnPlanetChange&&$(".planetlink, .moonlink").querystring({galaxy:galaxy,system:system}),getAjaxResourcebox()}function submitForm(){galaxy=$("#galaxy_input").val(),system=$("#system_input").val(),0!==galaxy.length&&$.isNumeric(+galaxy)||(galaxy=1),0!==system.length&&$.isNumeric(+system)||(system=1),mobile?loadContent(galaxy,system):loadContentNew(galaxy,system)}function loadContent(t,e){$("#galaxyLoading").show(),0!==t.length&&$.isNumeric(+t)||(t=1),0!==e.length&&$.isNumeric(+e)||(e=1),$("#galaxy_input").val(t),$("#system_input").val(e);let i=$("#galaxyHeader .phalanxlink.btn_system_action");i.length&&i.attr("href",i.attr("href").replace(/(galaxy=)\d+/,"$1"+t).replace(/(system=)\d+/,"$1"+e)),$.post(contentLink,{galaxy:t,system:e,_token:token},displayContentGalaxy)}function loadContentNew(t,e){if(!canSwitchGalaxy&&notEnoughDeuteriumMessage)return void fadeBox(notEnoughDeuteriumMessage,!0);$("#galaxyLoading").show(),0!==t.length&&!1!==$.isNumeric(+t)||(t=1),0!==e.length&&!1!==$.isNumeric(+e)||(e=1),$("input#galaxy_input").val(t),$("input#system_input").val(e);let i=$("#galaxyHeader .phalanxlink.btn_system_action");i.length&&i.attr("href",i.attr("href").replace(/(galaxy=)\d+/,"$1"+t).replace(/(system=)\d+/,"$1"+e)),!1===inProgress&&(inProgress=!0,$.post(galaxyContentLink,{galaxy:t,system:e,_token:token},renderContentGalaxy))}function errorBoxDeuterium(){fadeBox(galaxyLoca.deuteriumNeeded,!0)}function doScan(t,e){sendShips(constants.espionage,galaxy,system,t,e,spionageAmount)}function initPhalanx(){getAjaxResourcebox(),$(".eventFleet:odd").addClass("odd"),$(".partnerInfo:even").addClass("part-even"),$(".toggleInfos").click((function(){id=$(this).attr("rel"),"toggleInfos infosOpen"==$(this).attr("class")?($(this).removeClass("infosOpen"),$(this).addClass("infosClosed"),$(this).children().attr("src","/img/icons/de1e5f629d9e47d283488eee0c0ede.gif"),$("."+id).attr("style","display: none;")):($(this).addClass("infosOpen"),$(this).removeClass("infosClosed"),$(this).children().attr("src","/img/icons/577565fadab7780b0997a76d0dca9b.gif"),$("."+id).attr("style","display: block;"))}));var t=$(".overlayDiv.phalanx").siblings(".ui-dialog-titlebar");t.find(".refreshPhalanxLink").length?$("#phalanxWrap .refreshPhalanxLink").remove():t.find(".ui-dialog-title").append($("#phalanxWrap .refreshPhalanxLink"))}function initSpySystem(){$("#galaxyHeader").off("click").on("click",".spysystemlink",(function(t){t.preventDefault(),t.stopPropagation();let e=$(t.target),i=e.data("targetUrl");i||(i=e.parents().data("targetUrl")),i&&$.post(i,{galaxy:$("#galaxy_input").val(),system:$("#system_input").val(),_token:token},"json").done((function(t){let e=JSON.parse(t);token=e.newAjaxToken,updateOverlayToken("phalanxDialog",e.newAjaxToken),updateOverlayToken("phalanxSystemDialog",e.newAjaxToken);for(let t=0;t<e.planets.length;++t)$("#ownFleetStatus_"+e.planets[t].position+"_"+e.planets[t].type).removeClass("fleetNeutral").attr("title",galaxyLoca.fleetAttacking).addClass("fleetHostile").addClass("tooltip");addToTable(e.text,e.count<=0?"error":"success"),e.count>0&&getAjaxEventbox()}))}))}function initExpeditionFleetTemplates(){$("#expeditionFleetTemplateSelect").on("change",(function(t){let e=getValue($("#expeditionFleetTemplateSelect").val());if(0===e)$("#expeditionbutton").show(),$("#sendExpeditionFleetTemplateFleet").hide().attr("disabled",!0);else{expeditionFleetTemplates.find((t=>t.id===e))?($("#expeditionbutton").hide(),$("#sendExpeditionFleetTemplateFleet").show(),galaxyCheckTarget(e,galaxy,system)):($("#expeditionbutton").show(),$("#sendExpeditionFleetTemplateFleet").hide().attr("disabled",!0))}}))}let checkingTarget=!1;function galaxyCheckTarget(t,e,i){if(!e)return;if(!i)return;let n=expeditionFleetTemplates.find((e=>e.id===t));if(!n)return;if(checkingTarget)return;checkingTarget=!0;let a={galaxy:e,system:i,position:expeditionPosition,type:spaceObjectTypePlanet,mission:missionExpedition,speed:n.fleetSpeed,_token:token},s=n.ships;Object.keys(s).forEach((function(t){a["am"+t]=s[t]})),$.ajax({url:checkTargetUrl,type:"POST",dataType:"json",data:a,success:function(n){if(e===galaxy&&i===system&&t===getValue($("#expeditionFleetTemplateSelect").val()))if(n.targetOk)$("#sendExpeditionFleetTemplateFleet").removeAttr("disabled");else{let t=n.errors[0];showNotification(t?t.message:void 0,"error")}token=n.newAjaxToken,checkingTarget=!1},error:function(t){showNotification(void 0,"error"),checkingTarget=!1}})}function sendExpedtionFleetFromTemplate(){let t=getValue($("#expeditionFleetTemplateSelect").val());if(!t)return;let e=expeditionFleetTemplates.find((e=>e.id===t));if(!e)return;let i=e.ships,n={speed:e.fleetSpeed/10,holdingtime:e.expeditionTime};Object.keys(i).forEach((function(t){n["am"+t]=i[t]})),sendShips(missionExpedition,galaxy,system,expeditionPosition,spaceObjectTypePlanet,0,n)}function initMissleAttackLayer(){function t(){var t=$("#rocketattack #arrivalTime #timer");t.html(getFormatedDate(serverTime.getTime()+1e3*t.data("duration"),"[d].[m].[y] [G]:[i]:[s]"))}$("#rocketattack").closest(".ui-dialog-content").dialog("option","title",$("#rocketattack").data("title")),$("#rocketattack input#missileCount").keyup((function(){checkIntInput($(this),1,$(this).data("max"))})).change((function(){checkIntInput($(this),1,$(this).data("max"))})).focus(),$("#rocketattack #number").bind("click",(function(){var t=$("#rocketattack input#missileCount");parseInt(t.val())!=t.data("max")?t.val(t.data("max")):t.val("1")})),$("#rocketattack #priority a").bind("click",(function(){var t=$(this),e=$("#primaryTarget");$("#rocketattack #priority a").not(t).removeClass("active"),t.hasClass("active")?(t.removeClass("active"),e.val(""),$("#noPriorityInfo").show()):(t.addClass("active"),e.val(t.attr("ref")),$("#noPriorityInfo").hide())})),$("form#rocketForm").submit((function(){return $.post($(this).attr("action"),$(this).serialize(),(function(t){t&&launchMissiles(t)})),!1})),timerHandler.appendCallback(t),t()}function displayMiniFleetMessage(t,e=!0){var i=t.message;if(e&&void 0!==t.coordinates&&t.coordinates&&(i+=" ["+t.coordinates.galaxy+":"+t.coordinates.system+":"+t.coordinates.position+"]"),t.success){var n="#ownFleetStatus_"+t.coordinates.position+"_"+t.planetType;switch(t.type){case 1:$(n).removeClass("fleetNeutral"),$(n).attr("title",galaxyLoca.fleetAttacking).addClass("fleetHostile").addClass("tooltip");break;case 2:case 3:case 4:$(n).attr("title",galaxyLoca.fleetUnderway).addClass("fleetNeutral").addClass("tooltip")}addToTable(i,"success",t.shipsSent),showNotification(i,"success"),$("#slotUsed").html(tsdpkt(t.slots)),setShips("probeValue",tsdpkt(t.probes)),setShips("recyclerValue",tsdpkt(t.recyclers)),setShips("missileValue",tsdpkt(t.missiles))}else addToTable(i,"error"),showNotification(i,"error");shipsendingDone=1}function getFilterClass(t){let e;switch(t){case"filter_empty":e=".empty_filter";break;case"filter_inactive":e=".inactive_filter";break;case"filter_vacation":e=".vacation_filter";break;case"filter_strong":e=".strong_filter";break;case"filter_newbie":e=".newbie_filter"}return e}function filterToggle(t){let e=t.target,i=getFilterClass(e.id);e=$(e),e.hasClass("filter_active")?(e.removeClass("filter_active"),$(i).each((function(e,i){$(this).removeClass("filtered_"+$(t.target)[0].id)})),sendFilterToggle($(t.target)[0].id,0),t.stopPropagation()):(e.addClass("filter_active"),$(i).each((function(e,i){$(this).addClass("filtered_"+$(t.target)[0].id)})),sendFilterToggle($(t.target)[0].id,1),t.stopPropagation())}function sendFilterToggle(t,e){$.ajax({type:"POST",url:"?page=togglefilter",dataType:"json",data:{id:t,state:e},success:function(t){},error:function(){}})}function HappyEdit(t){this.tab=t.tab||"",this.urlSubmitPlayer=t.urlSubmitPlayer,this.urlSubmitBuildings=t.urlSubmitBuildings,this.urlSubmitResearch=t.urlSubmitResearch,this.urlSubmitShips=t.urlSubmitShips,this.urlSubmitDefense=t.urlSubmitDefense,this.urlSubmitPlanet=t.urlSubmitPlanet,this.urlSubmitWreckfield=t.urlSubmitWreckfield,this.urlSubmitFleet=t.urlSubmitFleet,this.urlSubmitRewards=t.urlSubmitRewards,this.urlRestartEventHandler=t.urlRestartEventHandler,this.urlTriggerNews=t.urlTriggerNews,this.urlSubmitBuffs=t.urlSubmitBuffs,this.tabs={player:t.urlFetchPlayerData||null,buildings:t.urlFetchBuildingsData||null,research:t.urlFetchResearchData||null,ships:t.urlFetchShipsData||null,defenses:t.urlFetchDefensesData||null,wreckfield:t.urlFetchWreckfieldData||null,rewards:t.urlFetchRewardsData||null,trader:t.urlFetchTraderData||null,planet:t.urlFetchPlanetData||null,fleet:t.urlFetchFleetData||null,eventHandler:t.urlFetchEventHandlerData||null,lifeform:t.urlFetchLifeformData||null,lfbuilding:t.urlFetchLifeformBuildingData||null,lfresearch:t.urlFetchLifeformResearchData||null,buffs:t.urlFetchBuffData||null,ipi:t.urlFetchIpiData||null},this.initItemsCommon(t),this.fetchData(this.tab)}function LifeformResearch(t){this.token=t.token||null,this.loca=t.loca}function LifeformSettings(t){this.token=t.token||null,this.loca=t.loca,this.lifeformIds=t.lifeformIds}function OGameLineChart(t,e){this.container=t,this.dataPoints=e.dataPoints||[],this.deltaY=e.deltaY||1,this.digitsY=e.digitsY||0,this.title=e.title||"",this.titleFont=e.titleFont||"Bold 13px Verdana, Arial, SunSans-Regular, Sans-Serif",this.titleColor=e.titleColor||"#6f9fc8",this.titleBaseline=e.titleBaseline||"middle",this.labelFontY=e.labelFont||"11px Verdana, Arial, SunSans-Regular, Sans-Serif",this.labelColorY=e.labelColor||"#6f9fc8",this.labelBaselineY=e.labelBaseline||"middle",this.labelLineHeightY=e.labelLineHeightY||11,this.labelSpacingY=e.labelSpacingY||20,this.labelHeightY=e.labelHeightY||20,this.labelFontX=e.labelFont||"11px Verdana, Arial, SunSans-Regular, Sans-Serif",this.labelColorX=e.labelColor||"#6f9fc8",this.labelBaselineX=e.labelBaseline||"middle",this.labelLineHeightX=e.labelLineHeightX||11,this.guidesStyle=e.guidesStyle||"#6f9fc8",this.lineStyles=e.lineStyles||{},this.lineWidths=e.lineWidths||{},this.lineStyleHighlight=e.lineStyleHighlight||"#aaffaa",this.lineWidthHighlight=e.lineWidthHighlight||5,this.lineThresholdHighlight=e.lineThresholdHighlight||10,this.tooltips=e.tooltips||{},this.dataKeyHighlight=null,this.marginLeft=e.marginLeft||60,this.marginRight=e.marginRight||30,this.marginTop=e.marginTop||20,this.marginBottom=e.marginBottom||110,this.visibility=e.visibility||{}}var LazyLoader;function Marketplace(t){this.tab=t.tab||"",this.loca=t.loca,this.constants=t.marketConstants,this.token=t.token,this.initMap={buying:this.initTabBuying.bind(this),selling:this.initTabSelling.bind(this),overview:this.initTabOverview.bind(this),statistics:this.initTabStatistics.bind(this),history_buying:this.initTabHistoryBuying.bind(this),history_selling:this.initTabHistorySelling.bind(this),create_offer:this.initTabCreateOffer.bind(this)},this.initMap[this.tab]&&this.initMap[this.tab](t)}function Missile(t){this.token=t.token,this.interceptor=t.interceptor,this.maxInterceptor=t.maxInterceptor,this.interplanetary=t.interplanetary,this.maxInterplanetary=t.maxInterplanetary,this.urlMissileDestroy=t.urlMissileDestroy||null,this.initCommon(t)}HappyEdit.prototype.onAjaxDone=function(){this.loadingIndicator.hide();let t=this,e=$("#lvlOfAllBuilding");switch(this.tab){case"player":$(".triggerNews").bind("click",t.triggerNews.bind(t)),$(".playerSubmit").bind("click",t.onClickSavePlayerData.bind(t));break;case"buildings":$(".buildingsSubmit").bind("click",t.onClickSaveBuildingsData.bind(t));break;case"research":$(".researchSubmit").bind("click",t.onClickSaveResearchData.bind(t));break;case"ships":$(".shipsSubmit").bind("click",t.onClickSaveShipsData.bind(t));break;case"defenses":$(".defenseSubmit").bind("click",t.onClickSaveDefensesData.bind(t));break;case"planet":$(".planetSubmit").bind("click",t.onClickSavePlanetData.bind(t)),$("#resetBashing .ajax").bind("click",t.onClickResetBashing.bind(t));break;case"wreckfield":$(".wreckfieldSubmit").bind("click",t.onClickSaveWreckfieldData.bind(t));break;case"rewards":$(".rewardsSubmit").bind("click",t.onClickSaveRewardsData.bind(t));break;case"trader":$("#traderEdit .ajax").each((function(){$(this).bind("click",t.onItemClick.bind(t))}));break;case"fleet":$(".finishFleet").bind("click",t.onClickFinishFleet.bind(t));break;case"lifeform":$("#lifeformSettings .lfdiscover").bind("click",t.submitDiscoverData.bind(t)),$(".lifeformSettingsSubmit").bind("click",t.onClickSaveLifeformData.bind(t));break;case"lfbuilding":e.bind("focus",(function(t){$(this).val("")})),e.bind("keyup",(function(t){let e=this,i=$(e).val();!1===$.isNumeric(i)?$(e).val("level of all"):$("#lfbuilding input.textInput").each((function(){$(this).val(i)}))})),$(".lifeformBuildingSubmit").bind("click",t.onClickSaveLifeformBuildingData.bind(t));break;case"lfresearch":e.bind("focus",(function(t){$(this).val("")})),e.bind("keyup",(function(t){let e=this,i=$(e).val();!1===$.isNumeric(i)?$(e).val("level of all"):$("#lfresearch input.textInput").each((function(){$(this).val(i)}))})),$("#lfresearch .radioResearch").bind("focus",t.onClickSelectResearch.bind(t)),$("#lfresearch .classSelector").bind("click",t.onClickSelectAllResearch.bind(t)),$(".lifeformResearchSubmit").bind("click",t.onClickSaveLifeformResearchData.bind(t));break;case"eventHandler":$("#eventHandlerSubmit").bind("click",t.onClickRestartEventHandler.bind(t));break;case"buffs":$("#buffEditForm button.submit").bind("click",t.onClickSaveBuffs.bind(t)),$('#buffEditForm input[type="datetime-local"]').bind("change",t.onChangeBuffTime.bind(t));break;case"ipi":$("#ipiEdit .ajax").bind("click",t.onItemClick.bind(t))}},HappyEdit.prototype.onItemClick=function(t){t.preventDefault(),$.post($(t.currentTarget).data("link"),{},this.handleSubmitResponse.bind(this))},HappyEdit.prototype.onClickResetBashing=function(t){t.preventDefault();let e,i,n=0;e=document.getElementById("bashingGalaxy").value??-1,i=document.getElementById("bashingSystem").value??-1,n=document.getElementById("bashingPosition").value??-1,$.post($(t.currentTarget).data("link"),{galaxy:e,system:i,position:n},this.handleSubmitResponse.bind(this))},HappyEdit.prototype.fetchData=function(t){this.loadingIndicator.show(),$.getJSON(this.tabs[t],{},this.onFetch.bind(this)).done(this.onAjaxDone.bind(this))},HappyEdit.prototype.displayErrors=function(t){let e=t[0]||void 0;e&&fadeBox(e.message,!0)},HappyEdit.prototype.onClickTab=function(t){t.preventDefault(),"disabled"!==$(t.currentTarget).parent().attr("disabled")&&(this.loadingIndicator.show(),this.tab=$(t.currentTarget).data("tab"),this.fetch(this.tab))},HappyEdit.prototype.onFetch=function(t){let e=t.content[t.target];this.refreshItems(e)},HappyEdit.prototype.fetch=function(t){const e=$("#happyeditcomponent .tabs ."+t);""!==e.attr("rel")&&($.getJSON(e.attr("rel"),{},this.onFetch.bind(this)).done(this.onAjaxDone.bind(this)),Object.keys(this.tabs).forEach((e=>{const i=$("#happyeditcomponent .tabs ."+e).parent();i.removeClass("active"),e===t&&i.addClass("active")})))},HappyEdit.prototype.initItemsCommon=function(t){this.itemsWrapper=$("#happyeditcomponent .wrapper"),this.loadingIndicator=this.itemsWrapper.ogameLoadingIndicator(),this.happyeditContent=$("#happyeditcomponent .content"),this.titlebar=$("#happyeditcomponent .tabs"),Object.keys(this.tabs).forEach((t=>this.titlebar.on("click","."+t,this.onClickTab.bind(this))))},HappyEdit.prototype.refreshItems=function(t){this.happyeditContent.html(t)},HappyEdit.prototype.handleSubmitResponse=function(t){let e=JSON.parse(t);"success"===(e.status||"failure")?(this.fetchData(this.tab),fadeBox(e.message,!1),getAjaxEventbox(),getAjaxResourcebox()):this.displayErrors(e.errors)},HappyEdit.prototype.onClickSavePlayerData=function(t){t.preventDefault(),t.currentTarget.hasAttribute("disabled")||this.submitPlayerData($("#playerSettings").serializeArray())},HappyEdit.prototype.triggerNews=function(t){t.preventDefault(),$.post(this.urlTriggerNews,{},this.handleSubmitResponse.bind(this))},HappyEdit.prototype.submitPlayerData=function(t){this.loadingIndicator.show(),$.post(this.urlSubmitPlayer,t,this.handleSubmitResponse.bind(this)).done(this.onAjaxDone.bind(this))},HappyEdit.prototype.onClickSaveBuildingsData=function(t){t.preventDefault();let e=$('[name="allBuildings"]').val();if(0===e.length){let t=$("#buildingsSettings").serializeArray().filter((function(t){return"allBuildings"!==t.name}));this.submitBuildingsData(t)}else this.submitBuildingsData({allBuildings:e})},HappyEdit.prototype.submitBuildingsData=function(t){this.loadingIndicator.show(),$.post(this.urlSubmitBuildings,t,this.handleSubmitResponse.bind(this)).done(this.onAjaxDone.bind(this))},HappyEdit.prototype.onClickSaveResearchData=function(t){t.preventDefault();let e=$('[name="allResearches"]').val();if(0===e.length){let t=$("#researchSettings").serializeArray().filter((function(t){return"allResearches"!==t.name}));this.submitResearchData(t)}else this.submitResearchData({allResearches:e})},HappyEdit.prototype.submitResearchData=function(t){this.loadingIndicator.show(),$.post(this.urlSubmitResearch,t,this.handleSubmitResponse.bind(this)).done(this.onAjaxDone.bind(this))},HappyEdit.prototype.onClickSaveShipsData=function(t){t.preventDefault();let e=$('[name="allShips"]').val();if(0===e.length){let t=$("#shipsSettings").serializeArray().filter((function(t){return"allShips"!==t.name}));this.submitShipsData(t)}else this.submitShipsData({allShips:e})},HappyEdit.prototype.submitShipsData=function(t){this.loadingIndicator.show(),$.post(this.urlSubmitShips,t,this.handleSubmitResponse.bind(this)).done(this.onAjaxDone.bind(this))},HappyEdit.prototype.onClickSaveDefensesData=function(t){t.preventDefault();let e=$('[name="allDefense"]').val();if(0===e.length){let t=$("#defenseSettings").serializeArray().filter((function(t){return"allDefense"!==t.name}));this.submitDefensesData(t)}else this.submitDefensesData({allDefense:e})},HappyEdit.prototype.submitDefensesData=function(t){this.loadingIndicator.show(),$.post(this.urlSubmitDefense,t,this.handleSubmitResponse.bind(this)).done(this.onAjaxDone.bind(this))},HappyEdit.prototype.onClickSaveWreckfieldData=function(t){t.preventDefault();let e=$('[name="allShips"]').val();if(0===e.length){let t=$("#wreckfieldSettings").serializeArray().filter((function(t){return"allShips"!==t.name}));this.submitWreckfieldData(t)}else this.submitWreckfieldData({allShips:e})},HappyEdit.prototype.submitWreckfieldData=function(t){this.loadingIndicator.show(),$.post(this.urlSubmitWreckfield,t,this.handleSubmitResponse.bind(this)).done(this.onAjaxDone.bind(this))},HappyEdit.prototype.onClickSaveRewardsData=function(t){t.preventDefault(),t.currentTarget.hasAttribute("disabled")||this.submitRewardsData($("#rewardsSettings").serializeArray())},HappyEdit.prototype.submitRewardsData=function(t){this.loadingIndicator.show(),$.post(this.urlSubmitRewards,t,this.handleSubmitResponse.bind(this)).done(this.onAjaxDone.bind(this))},HappyEdit.prototype.onClickSavePlanetData=function(t){t.preventDefault(),t.currentTarget.hasAttribute("disabled")||this.submitPlanetData($("#planetSettings").serializeArray())},HappyEdit.prototype.submitPlanetData=function(t){this.loadingIndicator.show(),$.post(this.urlSubmitPlanet,t,this.handleSubmitResponse.bind(this)).done(this.onAjaxDone.bind(this))},HappyEdit.prototype.onClickFinishFleet=function(t){t.preventDefault(),this.submitFinishFleet($(t.target).attr("data-fleet-id"))},HappyEdit.prototype.submitFinishFleet=function(t){this.loadingIndicator.show(),$.post(this.urlSubmitFleet,{fleetId:t},this.handleSubmitResponse.bind(this)).done(this.onAjaxDone.bind(this))},HappyEdit.prototype.onClickRestartEventHandler=function(t){t.preventDefault(),$.post(this.urlRestartEventHandler,{},this.handleSubmitResponse.bind(this)).done(this.onAjaxDone.bind(this))},HappyEdit.prototype.submitDiscoverData=function(t){let e=$(t.currentTarget).data("link"),i={lifeformId:$(t.currentTarget).data("id")};$.post(e,i,this.handleSubmitResponse.bind(this)).done(this.onAjaxDone.bind(this))},HappyEdit.prototype.onClickSaveLifeformData=function(t){if(t.preventDefault(),!t.currentTarget.hasAttribute("disabled")){let e=$("#lifeformSettings").serializeArray();this.loadingIndicator.show();let i=$(t.currentTarget).data("link");$.post(i,e,this.handleSubmitResponse.bind(this)).done(this.onAjaxDone.bind(this))}},HappyEdit.prototype.onClickSaveLifeformBuildingData=function(t){if(t.preventDefault(),!t.currentTarget.hasAttribute("disabled")){let e=$("#lifeformBuilding").serializeArray();this.loadingIndicator.show();let i=$(t.currentTarget).data("link");$.post(i,e,this.handleSubmitResponse.bind(this)).done(this.onAjaxDone.bind(this))}},HappyEdit.prototype.onClickSelectResearch=function(t){t.preventDefault();let e=$(t.currentTarget).attr("name"),i=$("#lfresearch input[name='"+e+"']:checked"),n=i.data("techid"),a=$(t.currentTarget).data("techid"),s=i.data("lifeformid"),o=$(t.currentTarget).data("lifeformid"),r=$(t.currentTarget).data("slot"),l=$("#slotPic"+r);0===o?($(".slotName"+r).text("None"),l.removeClass("lifeformsprite").removeClass("queuePic").removeClass("lifeformTech"+n).addClass("lifeformTech0")):0===s&&0!==o?($(".slotName"+r).text(lfResearch[r][o].name),l.removeClass("lifeformTech0").addClass("lifeformsprite").addClass("queuePic").addClass("lifeformTech"+a)):($(".slotName"+r).text(lfResearch[r][o].name),l.removeClass("lifeformTech"+n).addClass("lifeformTech"+a))},HappyEdit.prototype.onClickSelectAllResearch=function(t){t.preventDefault();let e=$(t.currentTarget).data("lifeformid");$("#lfresearch input[data-lifeformid='"+e+"']").each((function(){let t=$(this).attr("name"),e=$("#lfresearch input[name='"+t+"']:checked"),i=e.data("techid"),n=$(this).data("techid"),a=e.data("lifeformid"),s=$(this).data("lifeformid"),o=$(this).data("slot"),r=$("#slotPic"+o);0===s?($(".slotName"+o).text("None"),r.removeClass("lifeformsprite").removeClass("queuePic").removeClass("lifeformTech"+i).addClass("lifeformTech0")):0===a&&0!==s?($(".slotName"+o).text(lfResearch[o][s].name),r.removeClass("lifeformTech0").addClass("lifeformsprite").addClass("queuePic").addClass("lifeformTech"+n)):($(".slotName"+o).text(lfResearch[o][s].name),r.removeClass("lifeformTech"+i).addClass("lifeformTech"+n)),$(this).prop("checked",!0)}))},HappyEdit.prototype.onClickSaveLifeformResearchData=function(t){if(t.preventDefault(),!t.currentTarget.hasAttribute("disabled")){let e=$("#lifeformResearch").serializeArray();this.loadingIndicator.show();let i=$(t.currentTarget).data("link");$.post(i,e,this.handleSubmitResponse.bind(this)).done(this.onAjaxDone.bind(this))}},HappyEdit.prototype.onClickSaveBuffs=function(t){if(t.preventDefault(),this.loadingIndicator.show(),"all"===t.target.value){const e={targets:[],buffAction:"buffDeleteAll"===t.target.name?"delete":"update"};return document.querySelectorAll("#buffEditForm .happyedit-buffs-buff").forEach((t=>{e.targets.push({id:t.dataset.target,effectTime:t.querySelector('input[data-type="buffEffectTime"]').value,cooldownTime:t.querySelector('input[data-type="buffCooldownTime"]').value})})),void $.post(this.urlSubmitBuffs,e,this.handleSubmitResponse.bind(this)).done(this.onAjaxDone.bind(this))}const e={targets:[{id:t.target.value,effectTime:document.querySelector('#buffEditForm input[data-type="buffEffectTime"][data-target="'+t.target.value+'"]').value,cooldownTime:document.querySelector('#buffEditForm input[data-type="buffCooldownTime"][data-target="'+t.target.value+'"]').value}],buffAction:"buffDelete"===t.target.name?"delete":"update"};$.post(this.urlSubmitBuffs,e,this.handleSubmitResponse.bind(this)).done(this.onAjaxDone.bind(this))},HappyEdit.prototype.onChangeBuffTime=function(t){if("buffEffectTime"===t.target.dataset.type){const e=document.querySelector('#buffEditForm input[data-type="buffCooldownTime"][data-target="'+t.target.dataset.target+'"]');e.value<t.target.value&&(e.value=t.target.value)}},LifeformResearch.prototype.init=function(){if($(".lfresearchlayer").length>1)for(let t=0;t<$(".lfresearchlayer").length-1;t++)$($(".lfresearchlayer")[t]).remove();let t=this;this.lifeformWrapper=$("#technologies"),this.loadingIndicator=this.lifeformWrapper.ogameLoadingIndicator(),$("#selectTechnology").bind("click",t.onClickSelect100.bind(t)),$("#selectChance").bind("click",t.onClickSelectRandom.bind(t)),!0===$(".selectArtifacts").data("enabled")&&$(".selectArtifacts").bind("click",t.onClickSelectArtifacts.bind(t)),!0===$("#resetTechTree").data("enabled")&&$("#resetTechTree").bind("click",t.onClickResetTree.bind(t)),!0===$("#buyResetTechTree").data("enabled")&&$("#buyResetTechTree").bind("click",t.onClickResetTree.bind(t)),!0===$("#restoreTechTree").data("enabled")&&$("#restoreTechTree").bind("click",t.onClickRestoreTree.bind(t))},LifeformResearch.prototype.handleResponse=function(t){let e=JSON.parse(t),i=e.status||"failure";this.updateToken(e.newAjaxToken),"success"===i?(fadeBox(e.message,!1),void 0!==e.redirectUrl&&(window.location=e.redirectUrl)):(void 0!==e.redirectUrl&&(window.location=e.redirectUrl),this.displayErrors(e.errors))},LifeformResearch.prototype.updateToken=function(t){this.token=t,token=t},LifeformResearch.prototype.displayErrors=function(t){let e=t[0]||void 0;e&&fadeBox(e.message,!0)},LifeformResearch.prototype.onAjaxDone=function(){this.loadingIndicator.hide(),$("#lfresearchlayer").parents(".overlayDiv").dialog("close"),$(".lfresearchlayer").remove()},LifeformResearch.prototype.onClickSelect100=function(t){t.preventDefault();let e={_token:this.token,slotNumber:$(t.currentTarget).data("slotNumber"),planetId:$(t.currentTarget).data("planetId")},i=this;this.loadingIndicator.show();let n=this.loca.LOCA_LIFEFORM_RESEARCH_SELECT_TECHNOLOGY+$(t.currentTarget).data("name");errorBoxDecision(this.loca.LOCA_ALL_NETWORK_ATTENTION,n,this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){$.post(this.urlSelect100,e,i.handleResponse.bind(i)).done(i.onAjaxDone.bind(i))}),(function(){i.loadingIndicator.hide()}))},LifeformResearch.prototype.onClickSelectRandom=function(t){t.preventDefault();let e={_token:this.token,slotNumber:$(t.currentTarget).data("slotNumber"),planetId:$(t.currentTarget).data("planetId")},i=this;this.loadingIndicator.show(),errorBoxDecision(this.loca.LOCA_ALL_NETWORK_ATTENTION,this.loca.LOCA_LIFEFORM_RESEARCH_SELECT_TECHNOLOGY_RANDOM,this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){$.post(this.urlSelectRandom,e,i.handleResponse.bind(i)).done(i.onAjaxDone.bind(i))}),(function(){i.loadingIndicator.hide()}))},LifeformResearch.prototype.onClickSelectArtifacts=function(t){t.preventDefault();let e={_token:this.token,slotNumber:$(t.currentTarget).data("slotNumber"),planetId:$(t.currentTarget).data("planetId"),technologyId:$(t.currentTarget).data("technology-id")},i=this;this.loadingIndicator.show();let n=this.loca.LOCA_LIFEFORM_RESEARCH_SELECT_TECHNOLOGY+$(t.currentTarget).data("name")+"<br/>"+this.loca.LOCA_LIFEFORM_ARTIFACTS_SELECT_RESEARCH.replace("#artifactcost#",$(t.currentTarget).data("artifacts-cost"));errorBoxDecision(this.loca.LOCA_ALL_NETWORK_ATTENTION,n,this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){$.post(this.urlSelectArtifacts,e,i.handleResponse.bind(i)).done(i.onAjaxDone.bind(i))}),(function(){i.loadingIndicator.hide()}))},LifeformResearch.prototype.onClickResetTree=function(t){t.preventDefault();let e={_token:this.token,tier:$(t.currentTarget).data("tier"),planetId:$(t.currentTarget).data("planetId")},i=this;this.loadingIndicator.show(),errorBoxDecision(this.loca.LOCA_ALL_NETWORK_ATTENTION,this.loca.LOCA_LIFEFORM_RESET_TECHNOLOGY_RESEARCH_TREE+" "+$(t.currentTarget).data("tier"),this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){$.post($(t.currentTarget).attr("href"),e,i.handleResponse.bind(i)).done(i.onAjaxDone.bind(i))}),(function(){i.loadingIndicator.hide()}))},LifeformResearch.prototype.onClickRestoreTree=function(t){t.preventDefault();let e={_token:this.token,tier:$(t.currentTarget).data("tier"),planetId:$(t.currentTarget).data("planetId")},i=this;this.loadingIndicator.show(),errorBoxDecision(this.loca.LOCA_ALL_NETWORK_ATTENTION,this.loca.LOCA_LIFEFORM_RESTORE_TECHNOLOGY_RESEARCH_TREE+" "+$(t.currentTarget).data("tier"),this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){$.post($(t.currentTarget).attr("href"),e,i.handleResponse.bind(i)).done(i.onAjaxDone.bind(i))}),(function(){i.loadingIndicator.hide()}))},LifeformSettings.prototype.init=function(){let t=this;this.lifeformWrapper=$("#lfsettings .lfsettingsContent"),this.loadingIndicator=this.lifeformWrapper.ogameLoadingIndicator(),initToggleHeader("lfsettings"),!1===$("#removeLifeform").hasClass("disabled")&&$("#removeLifeform").bind("click",t.onClickSubmitRemove.bind(t)),$(".selectLifeform").each((function(){!1===$(this).hasClass("disabled")&&$(this).bind("click",t.onClickSubmitSelect.bind(t))}))},LifeformSettings.prototype.handleResponse=function(t){let e=JSON.parse(t),i=e.status||"failure";this.updateToken(e.newAjaxToken),"success"===i?(fadeBox(e.message,!1),void 0!==e.redirectUrl&&(window.location=e.redirectUrl)):(void 0!==e.tabs&&this.refreshTabs(e.tabs),void 0!==e.redirectUrl&&(window.location=e.redirectUrl),this.displayErrors(e.errors))},LifeformSettings.prototype.updateToken=function(t){this.token=t,token=t},LifeformSettings.prototype.displayErrors=function(t){let e=t[0]||void 0;e&&fadeBox(e.message,!0)},LifeformSettings.prototype.onAjaxDone=function(){this.loadingIndicator.hide();let t=this;$("#removeLifeform").bind("click",t.onClickSubmitRemove.bind(t)),$(".selectLifeform").each((function(){$(this).bind("click",t.onClickSubmitSelect.bind(t))}))},LifeformSettings.prototype.onClickSubmitRemove=function(t){t.preventDefault();let e={_token:this.token,planetId:$(t.currentTarget).data("planetid")},i=this;this.loadingIndicator.show(),errorBoxDecision(this.loca.LOCA_ALL_NETWORK_ATTENTION,this.loca.LOCA_LIFEFORM_REMOVE_FROM_PLANET+"<br/><br/>"+this.loca.LOCA_DEBUFF_ACTIVATION+"<br/>"+this.loca.LOCA_DEBUFF_REMOVED_LIFEFORM_DESCRIPTION,this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){$.post(this.urlRemoveLifeform,e,i.handleResponse.bind(i)).done(i.onAjaxDone.bind(i))}),(function(){i.loadingIndicator.hide()}))},LifeformSettings.prototype.onClickSubmitSelect=function(t){t.preventDefault(),$(t.currentTarget).hasClass("disabled")||t.currentTarget.hasAttribute("lifeformid")||this.submitLifeform($(t.currentTarget).data("lifeformid"),$(t.currentTarget).data("planetid"),$(t.currentTarget).data("name"))},LifeformSettings.prototype.submitLifeform=function(t,e,i){this.loadingIndicator.show();let n={lifeformId:t,planetId:e,_token:this.token},a=this.loca.LOCA_LIFEFORM_SELECT_QUESTION.replace("#lifeformname#",i),s=this;this.loadingIndicator.show(),errorBoxDecision(this.loca.LOCA_ALL_NETWORK_ATTENTION,a,this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){$.post(this.urlSelectLifeform,n,s.handleResponse.bind(s)).done(s.onAjaxDone.bind(s))}),(function(){s.loadingIndicator.hide()}))},OGameLineChart.epsilon=1e-4,OGameLineChart.prototype.init=function(){this.container.html('<div class="og-linechart"><canvas></canvas><div class="tooltip"></div></div>'),this.canvas=this.container.find("canvas")[0],this.tooltip=this.container.find(".tooltip"),this.fixDPI(),this.context=this.canvas.getContext("2d"),this.context.imageSmoothingEnabled=!0,this.container.on("mousemove",this.handleMouseMove.bind(this)),this.container.on("mouseleave",this.handleMouseLeave.bind(this))},OGameLineChart.prototype.handleMouseMove=function(t){let e=this.transformEventToCanvas(t);this.updateHighlight(e),this.updateTooltip(e),this.onMouseMove&&this.onMouseMove(t,this),this.render()},OGameLineChart.prototype.handleMouseLeave=function(t){this.setHighlight(null),this.render()},OGameLineChart.prototype.updateHighlight=function(t){let e=this.getClosestLine(t,this.lineThresholdHighlight),i=e?e.key:null;this.setHighlight(i)},OGameLineChart.prototype.updateTooltip=function(t){let e=this.getClosestDataPoint(t,this.lineThresholdHighlight);if(null===e)this.hideTooltip();else{let t=this.transformDataPointToCanvas(e.index,e.dataPoint.y),i=(this.tooltips[e.key]||"")+":"+e.dataPoint.y.toFixed(2);this.tooltip.html(i),this.tooltip.css({left:t.x-20,top:t.y}),this.showTooltip()}},OGameLineChart.prototype.showTooltip=function(){this.tooltip.show()},OGameLineChart.prototype.hideTooltip=function(){this.tooltip.hide()},OGameLineChart.prototype.getClosestLine=function(t,e){let i=null,n=null,a=null;for(let s in this.dataPoints){let o=this.dataPoints[s];for(let r=0;r<o.length-1;++r){let l=this.transformDataPointToCanvas(r,o[r].y),c=this.transformDataPointToCanvas(r+1,o[r+1].y),d=this.orthogonalDistanceFromLineSegment(t,l,c);null===d||d>e||(null===n||n>d)&&(i=s,n=d,a=r)}}return null!==i?{key:i,distance:n,index:a}:null},OGameLineChart.prototype.getClosestDataPoint=function(t,e){let i=this.getClosestLine(t,e);if(null===i)return null;let n=null,a=null,s=null,o=this.getDataPoints(i.key);if(o)for(let i=0;i<o.length;++i){let r=this.transformDataPointToCanvas(i,o[i].y),l=this.distance(r,t);l>e||(null===n||n>l)&&(a=o[i],n=l,s=i)}return null!==a?{key:i.key,index:s,dataPoint:a}:null},OGameLineChart.prototype.render=function(){this.height=$(this.canvas).outerHeight(),this.width=$(this.canvas).outerWidth(),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.renderTitle(),this.renderLabels(),this.renderData()},OGameLineChart.prototype.renderTitle=function(){this.context.save(),this.context.font=this.titleFont,this.context.fillStyle=this.titleColor,this.context.textBaseline=this.titleBaseline;let t=this.marginLeft,e=Math.floor(this.marginTop/2);this.context.fillText(this.title,t,e),this.context.restore()},OGameLineChart.prototype.renderLabels=function(){this.renderAxis(),this.renderVerticalLabels(),this.renderHorizontalLabels()},OGameLineChart.prototype.renderAxis=function(){let t=this.marginLeft,e=this.marginTop,i=this.marginLeft,n=this.height-this.marginBottom;this.context.save(),this.context.strokeStyle=this.guidesStyle,this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(i,n),this.context.stroke(),this.context.closePath(),t=i,e=n,i=this.width-this.marginRight,n=this.height-this.marginBottom,this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(i,n),this.context.stroke(),this.context.closePath(),this.context.restore()},OGameLineChart.prototype.renderVerticalLabels=function(){let t=this.marginTop,e=this.height-this.marginBottom,i=Math.floor((e-t)/(this.labelLineHeightY+this.labelSpacingY))+1,n=Math.floor((e-t)/(i-1)),a=Math.floor(this.getMinY()/this.deltaY),s=Math.ceil(this.getMaxY()/this.deltaY),o=Math.floor((s-a)/(i-1));this.context.save(),this.context.font=this.labelFontY,this.context.fillStyle=this.labelColorY,this.context.textBaseline=this.labelBaselineY;for(let t=0;t<i;++t){let i=tsdpkt((a+o*t).toFixed(this.digitsY)),s=this.context.measureText(i).width,r=Math.floor(this.marginLeft/2-s/2),l=e-n*t;this.context.fillText(i,0+r,l)}this.context.restore()},OGameLineChart.prototype.renderHorizontalLabels=function(){let t=this.getDataKeys();if(0===t.length)return;let e=t[0],i=this.getDataPoints(e);if(i.length<2)return;let n=this.marginLeft,a=this.width-this.marginRight,s=Math.floor((a-n)/(i.length-1)),o=this.marginLeft,r=this.height-this.marginBottom+this.labelHeightY;this.context.save(),this.context.font=this.labelFontX,this.context.fillStyle=this.labelColorX,this.context.textBaseline=this.labelBaselineX;for(let t=0;t<i.length;++t){let e=i[t].x.toString(),n=this.context.measureText(e).width;Math.floor(n/2);this.context.save(),this.context.translate(o,r),this.context.rotate(.375*Math.PI),this.context.fillText(e,0,0),this.context.restore(),o+=s}this.context.restore()},OGameLineChart.prototype.renderData=function(){for(let t in this.dataPoints)this.dataKeyHighlight!==t&&this.renderDataPoints(t,this.dataPoints[t]);null!==this.dataKeyHighlight&&this.renderDataPoints(this.dataKeyHighlight,this.dataPoints[this.dataKeyHighlight])},OGameLineChart.prototype.renderDataPoints=function(t,e){if(this.isDataSetVisible(t)){this.context.save(),this.context.strokeStyle=this.getLineStyle(t),this.context.lineWidth=this.getLineWidth(t),this.context.beginPath();for(let t=0;t<e.length-1;++t){let i=this.transformDataPointToCanvas(t,e[t].y),n=this.transformDataPointToCanvas(t+1,e[t+1].y);this.context.moveTo(i.x,i.y),this.context.lineTo(n.x,n.y)}this.context.stroke(),this.context.closePath(),this.context.restore()}},OGameLineChart.prototype.transformDataPointToCanvas=function(t,e){let i=Math.ceil(this.getMinY()/this.deltaY),n=Math.floor(this.getMaxY()/this.deltaY),a=this.getNumDataPoints();if(void 0===e)throw"Y is undefined";let s=this.marginTop,o=this.height-this.marginBottom,r=this.marginLeft,l=this.width-this.marginRight,c=Math.floor((l-r)/(a-1)),d=(o-s)/(n-i);return{x:Math.floor(c*t+r),y:Math.floor(-(e-i)*d+o)}},OGameLineChart.prototype.transformEventToCanvas=function(t){let e=$(this.canvas).offset();return{x:t.pageX-e.left,y:t.pageY-e.top}},OGameLineChart.prototype.getMinY=function(){let t=null;for(let e in this.dataPoints){let i=this.dataPoints[e];for(let e=0;e<i.length;++e)(null===t||t>i[e].y)&&(t=i[e].y)}return null===t?0:t-1},OGameLineChart.prototype.getMaxY=function(){let t=null;for(let e in this.dataPoints){let i=this.dataPoints[e];for(let e=0;e<i.length;++e)(null===t||t<i[e].y)&&(t=i[e].y)}return null===t?4:t+1},OGameLineChart.prototype.getDataKeys=function(){let t=[];for(let e in this.dataPoints)t.push(e);return t},OGameLineChart.prototype.getDataPoints=function(t){return void 0!==this.dataPoints[t]?this.dataPoints[t]:[]},OGameLineChart.prototype.getNumDataPoints=function(){let t=0;for(let e in this.dataPoints)t<this.dataPoints[e].length&&(t=this.dataPoints[e].length);return t},OGameLineChart.prototype.setHighlight=function(t){this.dataKeyHighlight=t},OGameLineChart.prototype.setDataSetVisible=function(t,e){this.visibility[t]=!0===e},OGameLineChart.prototype.isDataSetVisible=function(t){return void 0===this.visibility[t]||this.visibility[t]},OGameLineChart.prototype.getLineStyle=function(t){return t===this.dataKeyHighlight?this.lineStyleHighlight:this.lineStyles[t]||"#ffffff"},OGameLineChart.prototype.getLineWidth=function(t){return t===this.dataKeyHighlight?this.lineWidthHighlight:this.lineWidths[t]||1},OGameLineChart.prototype.fixDPI=function(){let t=window.devicePixelRatio,e=this,i=function(){return+getComputedStyle(e.canvas).getPropertyValue("height").slice(0,-2)},n=function(){return+getComputedStyle(e.canvas).getPropertyValue("width").slice(0,-2)};this.canvas.setAttribute("width",n()*t),this.canvas.setAttribute("height",i()*t)},OGameLineChart.prototype.crossProduct=function(t,e,i){return(i.y-t.y)*(e.x-t.x)-(i.x-t.x)*(e.y-t.y)},OGameLineChart.prototype.dotProduct=function(t,e){return t.x*e.x+t.y*e.y},OGameLineChart.prototype.addVector2=function(t,e){return{x:t.x+e.x,y:t.y+e.y}},OGameLineChart.prototype.subVector2=function(t,e){return{x:t.x-e.x,y:t.y-e.y}},OGameLineChart.prototype.scaleVector2=function(t,e){return{x:t.x*e,y:t.y*e}},OGameLineChart.prototype.distance=function(t,e){let i=this.subVector2(t,e);return Math.sqrt(this.dotProduct(i,i))},OGameLineChart.prototype.projectOntoLineSegment=function(t,e,i){let n=this.subVector2(t,e),a=this.subVector2(i,e),s=this.dotProduct(n,a)/this.dotProduct(a,a);return s<0||s>1?null:this.addVector2(e,this.scaleVector2(a,s))},OGameLineChart.prototype.orthogonalDistanceFromLineSegment=function(t,e,i){let n=this.projectOntoLineSegment(t,e,i);if(null===n)return null;let a=this.subVector2(t,n),s=this.dotProduct(a,a);return Math.sqrt(s)},function(t){t.fn.ogameLineChart=function(e){if(this.length>0){let i=t(this[0]),n=i.data("ogameLineChart");return null==n&&(n=new OGameLineChart(i,e),t(this).data("ogameLineChart",n),n.init(),n.render()),n}return null}}(jQuery),function(t){LazyLoader={pendingCssFiles:[],loadedCssFiles:[],pendingJsFiles:[],loadedJsFiles:[],_downloadCompleteHandler:function(e,i){switch(e){case"css":LazyLoader.pendingCssFiles=t.grep(LazyLoader.pendingCssFiles,(function(t){return t!=i})),LazyLoader.loadedCssFiles.push(i),0===LazyLoader.pendingCssFiles.length&&t(document).trigger("cssComplete");break;case"js":LazyLoader.pendingJsFiles=t.grep(LazyLoader.pendingJsFiles,(function(t){return t!=i})),LazyLoader.loadedJsFiles.push(i),0===LazyLoader.pendingJsFiles.length&&t(document).trigger("jsComplete")}0===LazyLoader.pendingCssFiles.length&&0===LazyLoader.pendingJsFiles.length&&t(document).trigger("allComplete")},_loadCssFiles:function(e){var i=[];return t.each(e,(function(e,n){if(t.inArray(n,LazyLoader.pendingCssFiles)>-1||t.inArray(n,LazyLoader.loadedCssFiles)>-1)return!0;LazyLoader.pendingCssFiles.push(n),i.push(t("<link />").attr("href",n).attr("rel","stylesheet").on("load",{path:n},(function(t){LazyLoader._downloadCompleteHandler("css",t.data.path)})))})),0===i.length?{status:"done"}:(t(i).map(t.fn.toArray).appendTo("head"),{status:"queued"})},_loadJsFiles:function(e){var i=!1;return t.each(e,(function(e,n){if(t.inArray(n,LazyLoader.pendingJsFiles)>-1||t.inArray(n,LazyLoader.loadedJsFiles)>-1)return!0;i=!0,LazyLoader.pendingJsFiles.push(n),t.ajax({cache:!0,url:n,dataType:"script"}).success((function(){LazyLoader._downloadCompleteHandler("js",n)}))})),i?{status:"queued"}:{status:"done"}},loadFiles:function(e,i){var n=LazyLoader._loadCssFiles(e),a=LazyLoader._loadJsFiles(i);"done"===n.status&&"done"===a.status&&t(document).trigger("allComplete")}},t(document).ready((function(){t("#mainmenucomponent li.has-sub > a").on("click",(function(){t(this).removeAttr("href");var e=t(this).parent("li");e.hasClass("open")?(e.removeClass("open"),e.find("li").removeClass("open"),e.find("ul").slideUp(50)):(e.addClass("open"),e.children("ul").slideDown(50),e.siblings("li").children("ul").slideUp(50),e.siblings("li").removeClass("open"),e.siblings("li").find("li").removeClass("open"),e.siblings("li").find("ul").slideUp(50))}))}))}(jQuery),Marketplace.prototype.onAjaxDone=function(){this.loadingIndicator.hide()},Marketplace.prototype.onAjaxError=function(){},Marketplace.prototype.updateToken=function(t){this.token=t},Marketplace.prototype.initItemsCommon=function(t){this.itemsWrapper=$(".marketplace .items_wrapper"),this.loadingIndicator=this.itemsWrapper.ogameLoadingIndicator(),this.items=$(".marketplace .items"),this.table=this.items.closest(".og-table")},Marketplace.prototype.refreshItems=function(t){this.items.html(t),this.table.toggleClass("isScrollbarVisible",this.items.children().length>5)},Marketplace.prototype.getSorting=function(){return{playerName:this.sortPlayerName.getOrder(),price:this.sortPrice.getOrder(),deliveryTime:this.sortDelivery.getOrder()}},Marketplace.prototype.getFilters=function(){let t={};return t.resourceId=$("#filterResources").val(),t.shipId=$("#filterShips").val(),t.tradableItemId=$("#filterItems").val(),t.priceType=$("#filterPriceType").val(),t},Marketplace.prototype.getPagination=function(){let t={};return t.page=this.pagination.getPage(),t},Marketplace.prototype.initTabBuying=function(t){this.initItemsCommon(t),this.urlFetchBuyingItems=t.urlFetchBuyingItems||null,this.urlAccept=t.urlAccept,this.sortPlayerName=$("#sortPlayerName").ogameSortable({allowUnsorted:!0,order:"",_token:this.token,onChange:this.onSortChangeBuying.bind(this)}),this.sortDelivery=$("#sortDelivery").ogameSortable({allowUnsorted:!0,order:"",align:"center",_token:this.token,onChange:this.onSortChangeBuying.bind(this)}),this.sortPrice=$("#sortPrice").ogameSortable({allowUnsorted:!0,order:"",align:"center",_token:this.token,onChange:this.onSortChangeBuying.bind(this)}),this.pagination=$(".marketplace .pagination_wrapper").ogamePaginatable({page:1,numPages:1,_token:this.token,onChange:this.onPaginationChangeBuying.bind(this)}),$("#showFilterResources, #showFilterShips, #showFilterItems, #filterResources, #filterShips, #filterItems, #filterPriceType").on("change",this.onFilterChangeBuying.bind(this)),this.items.on("click",".item a.og-button.submit",this.onClickBuyingItem.bind(this)),this.fetchBuyingItems()},Marketplace.prototype.onClickPriceMin=function(t){t.preventDefault();let e=$(t.currentTarget).data("priceMin");this.inputPrice.val(e),this.quantity>0?this.setPrice(parseFloat(e)):this.setPrice(0)},Marketplace.prototype.onClickPriceMax=function(t){t.preventDefault();let e=$(t.currentTarget).data("priceMax");this.inputPrice.val(e),this.quantity>0?this.setPrice(parseFloat(e)):this.setPrice(0)},Marketplace.prototype.onClickBuyingItem=function(t){t.preventDefault();let e=$(t.currentTarget).data("itemid"),i=$(t.currentTarget).data("_token");this.submitAcceptBuying(e,i)},Marketplace.prototype.onSortChangeBuying=function(t){this.token=t.token,this.fetchBuyingItems()},Marketplace.prototype.onFilterChangeBuying=function(t){this.token=t.token,this.fetchBuyingItems()},Marketplace.prototype.onPaginationChangeBuying=function(t){this.token=t.token,this.fetchBuyingItems()},Marketplace.prototype.onPaginationChangeHistoryBuying=function(t){this.token=t.token,this.fetchHistoryBuyingItems()},Marketplace.prototype.onPaginationChangeHistorySelling=function(t){this.token=t.token,this.fetchHistorySellingItems()},Marketplace.prototype.fetchBuyingItems=function(){this.loadingIndicator.show();let t={sorting:this.getSorting(),filters:this.getFilters(),pagination:this.getPagination(),_token:this.token};$.getJSON(this.urlFetchBuyingItems,t,this.onFetchBuyingItems.bind(this)).done(this.onAjaxDone.bind(this))},Marketplace.prototype.onFetchBuyingItems=function(t){let e=t.content[t.target];this.updateToken(t.newToken),this.refreshItems(e)},Marketplace.prototype.submitAcceptBuying=function(t,e){let i={marketItemId:t,_token:e};this.loadingIndicator.show(),$.post(this.urlAccept,i,this.handleSubmitAcceptBuyingResponse.bind(this)).done(this.onAjaxDone.bind(this))},Marketplace.prototype.handleSubmitAcceptBuyingResponse=function(t){let e=JSON.parse(t),i=e.status||"failure";this.updateToken(e.newToken),"success"===i?(this.fetchBuyingItems(),fadeBox(e.message,!1),getAjaxEventbox(),getAjaxResourcebox()):this.displayErrors(e.errors)},Marketplace.prototype.initTabSelling=function(t){this.initItemsCommon(t),this.urlFetchSellingItems=t.urlFetchSellingItems||null,this.urlAccept=t.urlAccept,this.sortPlayerName=$("#sortPlayerName").ogameSortable({allowUnsorted:!0,order:"",_token:this.token,onChange:this.onSortChangeSelling.bind(this)}),this.sortDelivery=$("#sortDelivery").ogameSortable({allowUnsorted:!0,order:"",align:"center",_token:this.token,onChange:this.onSortChangeSelling.bind(this)}),this.sortPrice=$("#sortPrice").ogameSortable({allowUnsorted:!0,order:"",align:"center",_token:this.token,onChange:this.onSortChangeSelling.bind(this)}),this.pagination=$(".marketplace .pagination_wrapper").ogamePaginatable({page:1,numPages:1,_token:this.token,onChange:this.onPaginationChangeSelling.bind(this)}),$("#showFilterResources, #showFilterShips, #showFilterItems, #filterResources, #filterShips, #filterItems, #filterPriceType").on("change",this.onFilterChangeSelling.bind(this)),this.items.on("click",".item .og-button.submit",this.onClickSellingItem.bind(this)),this.fetchSellingItems()},Marketplace.prototype.onClickSellingItem=function(t){t.preventDefault();let e=$(t.currentTarget).data("itemid"),i=$(t.currentTarget).data("_token");this.submitAcceptSelling(e,i)},Marketplace.prototype.onSortChangeSelling=function(t){this.token=t.token,this.fetchSellingItems()},Marketplace.prototype.onFilterChangeSelling=function(t){this.token=t.token,this.fetchSellingItems()},Marketplace.prototype.onPaginationChangeSelling=function(t){this.token=t.token,this.fetchSellingItems()},Marketplace.prototype.fetchSellingItems=function(){this.loadingIndicator.show();let t={sorting:this.getSorting(),filters:this.getFilters(),pagination:this.getPagination(),_token:this.token};$.getJSON(this.urlFetchSellingItems,t,this.onFetchSellingItems.bind(this)).done(this.onAjaxDone.bind(this))},Marketplace.prototype.onFetchSellingItems=function(t){let e=t.content[t.target];this.updateToken(t.newToken),this.refreshItems(e)},Marketplace.prototype.submitAcceptSelling=function(t,e){let i={marketItemId:t,_token:e};this.loadingIndicator.show(),$.post(this.urlAccept,i,this.handleSubmitAcceptSellingResponse.bind(this)).done(this.onAjaxDone.bind(this))},Marketplace.prototype.handleSubmitAcceptSellingResponse=function(t){let e=JSON.parse(t),i=e.status||"failure";this.updateToken(e.newToken),"success"===i?(this.fetchSellingItems(),fadeBox(e.message,!1),getAjaxEventbox(),getAjaxResourcebox()):this.displayErrors(e.errors)},Marketplace.prototype.initTabOverview=function(t){this.initItemsCommon(),this.urlFetchOverviewItems=t.urlFetchOverviewItems||null,this.items.on("click",".og-button.delete",this.onClickDeleteItem.bind(this)),this.sortType=$("#sortType").ogameSortable({allowUnsorted:!0,order:"",align:"center",_token:this.token,onChange:this.onSortChangeOverview.bind(this)}),this.sortPrice=$("#sortPrice").ogameSortable({allowUnsorted:!0,order:"",align:"center",_token:this.token,onChange:this.onSortChangeOverview.bind(this)}),this.pagination=$(".marketplace .pagination_wrapper").ogamePaginatable({page:1,numPages:1,_token:this.token,onChange:this.onPaginationChangeOverview.bind(this)}),this.fetchOverviewItems()},Marketplace.prototype.getOverviewSorting=function(){return{type:this.sortType.getOrder(),price:this.sortPrice.getOrder()}},Marketplace.prototype.onSortChangeOverview=function(t){this.token=t.token,this.fetchOverviewItems()},Marketplace.prototype.onPaginationChangeOverview=function(t){this.token=t.token,this.fetchOverviewItems()},Marketplace.prototype.onClickDeleteItem=function(t){t.stopPropagation(),t.preventDefault(),this.loadingIndicator.show();let e=t.currentTarget.href,i={_token:this.token},n=this;errorBoxDecision(this.loca.LOCA_ALL_NETWORK_ATTENTION,this.loca.LOCA_MARKET_CANCELLATION_NOTE,this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){$.post(e,i,n.handleSubmitDeleteResponse.bind(n)).done(n.onAjaxDone.bind(n))}),(function(){n.loadingIndicator.hide()}))},Marketplace.prototype.handleSubmitDeleteResponse=function(t){let e=JSON.parse(t),i=e.status||"failure";this.updateToken(e.newToken),"success"===i?(this.fetchOverviewItems(),getAjaxEventbox(),getAjaxResourcebox()):this.displayErrors(e.errors)},Marketplace.prototype.onItemDeleted=function(){this.onAjaxDone()},Marketplace.prototype.fetchOverviewItems=function(){this.loadingIndicator.show();let t={sorting:this.getOverviewSorting(),pagination:this.getPagination(),_token:this.token};$.getJSON(this.urlFetchOverviewItems,t,this.onFetchOverviewItems.bind(this)).done(this.onAjaxDone.bind(this))},Marketplace.prototype.onFetchOverviewItems=function(t){let e=t.content[t.target];this.updateToken(t.newToken),this.refreshItems(e)},Marketplace.prototype.initTabStatistics=function(t){let e=t.statisticsChartData||null;this.lineChart=$("#chart_container").ogameLineChart(e),$("#showRatioMetal").on("change",this.refreshLineChart.bind(this)),$("#showRatioCrystal").on("change",this.refreshLineChart.bind(this)),$("#showRatioDeuterium").on("change",this.refreshLineChart.bind(this)),this.refreshLineChart()},Marketplace.prototype.refreshLineChart=function(){this.lineChart.setDataSetVisible("metal",$("#showRatioMetal").is(":checked")),this.lineChart.setDataSetVisible("crystal",$("#showRatioCrystal").is(":checked")),this.lineChart.setDataSetVisible("deuterium",$("#showRatioDeuterium").is(":checked")),this.lineChart.render()},Marketplace.prototype.initTabHistoryBuying=function(t){this.initItemsCommon(),this.urlCollectItem=t.urlCollectItem,this.urlCollectPrice=t.urlCollectPrice,this.urlFetchHistoryBuyingItems=t.urlFetchHistoryBuyingItems||null,this.sortPayment=$("#sortPayment").ogameSortable({allowUnsorted:!0,order:"",align:"center",_token:this.token,onChange:this.onSortChangeHistoryBuying.bind(this)}),this.sortDate=$("#sortDate").ogameSortable({allowUnsorted:!0,order:"desc",align:"center",_token:this.token,onChange:this.onSortChangeHistoryBuying.bind(this)}),this.pagination=$(".marketplace .pagination_wrapper").ogamePaginatable({page:1,numPages:1,_token:this.token,onChange:this.onPaginationChangeHistoryBuying.bind(this)}),this.items.on("click",".item a.og-button.submit.collect-item",this.onClickCollectItem.bind(this)),this.items.on("click",".item a.og-button.submit.collect-price",this.onClickCollectPrice.bind(this)),this.fetchHistoryBuyingItems()},Marketplace.prototype.onClickCollectItem=function(t){t.preventDefault();let e=$(t.currentTarget).data("transactionid"),i=$(t.currentTarget).data("_token");this.submitCollectItem(e,i)},Marketplace.prototype.submitCollectItem=function(t,e){let i={marketTransactionId:t,_token:e};this.loadingIndicator.show(),$.post(this.urlCollectItem,i,this.handleSubmitCollectItemResponse.bind(this)).done(this.onAjaxDone.bind(this))},Marketplace.prototype.handleSubmitCollectItemResponse=function(t){let e=JSON.parse(t),i=e.status||"failure",n=(e.statusMessage,e.marketTransactionId||0);this.updateToken(e.newToken),"success"===i?($('.row.item[data-transactionid="'+n+'"] .col.date').show(),$("a[data-token]").each((function(){$(this).data("_token",e.newToken),$(this).attr("data-token",e.newToken)})),$('.collect-item[data-transactionid="'+n+'"]').parent().hide(),fadeBox(e.message,!1),getAjaxResourcebox()):this.displayErrors(e.errors)},Marketplace.prototype.onClickCollectPrice=function(t){t.preventDefault();let e=$(t.currentTarget).data("transactionid"),i=$(t.currentTarget).data("_token");this.submitCollectPrice(e,i)},Marketplace.prototype.submitCollectPrice=function(t,e){let i={marketTransactionId:t,_token:e};this.loadingIndicator.show(),$.post(this.urlCollectPrice,i,this.handleSubmitCollectPriceResponse.bind(this)).done(this.onAjaxDone.bind(this))},Marketplace.prototype.handleSubmitCollectPriceResponse=function(t){let e=JSON.parse(t),i=e.status||"failure",n=(e.statusMessage,e.marketTransactionId||0);this.updateToken(e.newToken),"success"===i?($('.row.item[data-transactionid="'+n+'"] .col.date').show(),$("a[data-token]").each((function(){$(this).data("_token",e.newToken),$(this).attr("data-token",e.newToken)})),$('.collect-price[data-transactionid="'+n+'"]').parent().hide(),fadeBox(e.message,!1),getAjaxResourcebox()):this.displayErrors(e.errors)},Marketplace.prototype.getHistorySorting=function(){return{price:this.sortPayment.getOrder(),date:this.sortDate.getOrder()}},Marketplace.prototype.fetchHistoryBuyingItems=function(){this.loadingIndicator.show();let t={sorting:this.getHistorySorting(),pagination:this.getPagination(),_token:this.token};$.getJSON(this.urlFetchHistoryBuyingItems,t,this.onFetchHistoryBuyingItems.bind(this)).done(this.onAjaxDone.bind(this))},Marketplace.prototype.onFetchHistoryBuyingItems=function(t){let e=t.content[t.target];this.updateToken(t.newToken),this.refreshItems(e)},Marketplace.prototype.onSortChangeHistoryBuying=function(t){this.token=t.token,this.fetchHistoryBuyingItems()},Marketplace.prototype.initTabHistorySelling=function(t){this.initItemsCommon(),this.urlCollectItem=t.urlCollectItem,this.urlCollectPrice=t.urlCollectPrice,this.sortPayment=$("#sortPayment").ogameSortable({allowUnsorted:!0,order:"",align:"center",_token:this.token,onChange:this.onSortChangeHistorySelling.bind(this)}),this.sortDate=$("#sortDate").ogameSortable({allowUnsorted:!0,order:"desc",align:"center",_token:this.token,onChange:this.onSortChangeHistorySelling.bind(this)}),this.pagination=$(".marketplace .pagination_wrapper").ogamePaginatable({page:1,numPages:1,_token:this.token,onChange:this.onPaginationChangeHistorySelling.bind(this)}),this.urlFetchHistorySellingItems=t.urlFetchHistorySellingItems||null,this.items.on("click",".item a.og-button.submit.collect-item",this.onClickCollectItem.bind(this)),this.items.on("click",".item a.og-button.submit.collect-price",this.onClickCollectPrice.bind(this)),this.fetchHistorySellingItems()},Marketplace.prototype.fetchHistorySellingItems=function(){this.loadingIndicator.show();let t={sorting:this.getHistorySorting(),pagination:this.getPagination(),_token:this.token};$.getJSON(this.urlFetchHistorySellingItems,t,this.onFetchHistorySellingItems.bind(this)).done(this.onAjaxDone.bind(this))},Marketplace.prototype.onFetchHistorySellingItems=function(t){let e=t.content[t.target];this.updateToken(t.newToken),this.refreshItems(e)},Marketplace.prototype.onSortChangeHistorySelling=function(t){this.token=t.token,this.fetchHistorySellingItems()},Marketplace.prototype.initTabCreateOffer=function(t){this.content=$(".marketplace .content"),this.loadingIndicator=this.content.ogameLoadingIndicator(),this.ITEM_TYPE_SHIP=t.itemTypes.ITEM_TYPE_SHIP,this.ITEM_TYPE_RESOURCE=t.itemTypes.ITEM_TYPE_RESOURCE,this.ITEM_TYPE_TRADABLE_ITEM=t.itemTypes.ITEM_TYPE_TRADABLE_ITEM,this.MARKET_ITEM_TYPE_SELL_ORDER=t.marketItemTypes.SELL_ORDER,this.MARKET_ITEM_TYPE_BUY_ORDER=t.marketItemTypes.BUY_ORDER,this.RESOURCE_TYPE_METAL=t.resourceTypes.RESOURCE_TYPE_METAL,this.RESOURCE_TYPE_CRYSTAL=t.resourceTypes.RESOURCE_TYPE_CRYSTAL,this.RESOURCE_TYPE_DEUTERIUM=t.resourceTypes.RESOURCE_TYPE_DEUTERIUM,this.urlSubmitOffer=t.urlSubmitOffer,this.marketItemTypes=t.marketItemTypes,this.formSteps=t.formSteps,this.itemTypes=t.itemTypes,this.itemOptions=t.itemOptions,this.priceTypeOptions=t.priceTypeOptions,this.currentRatio=t.priceValidation.currentRatio,this.priceRangeLower=t.priceValidation.priceRangeLower,this.priceRangeUpper=t.priceValidation.priceRangeUpper,this.defaultPriceRange=t.defaultPriceRange,this.marketFee=t.marketFee,this.itemBox=$(".marketplace #itemBox"),this.inputMarketItemType=$('.marketplace input[name="type"]'),this.inputItemType=$('.marketplace input[name="itemType"]'),this.inputQuantity=$('.marketplace input[name="quantity"]'),this.inputPrice=$('.marketplace input[name="price"]'),this.priceLimit=$(".marketplace #priceLimit"),this.priceLimitMin=$(".marketplace #priceLimit #priceMin"),this.priceLimitMax=$(".marketplace #priceLimit #priceMax"),this.priceInformation=$("#orderPriceInformation"),this.priceToPay=$("#priceToPay"),this.priceInTotal=$("#priceInTotal"),this.priceRangeValue=$("#priceRangeValue"),this.marketFeeElem=$(".marketplace #marketFee"),this.marketFeeColElem=$(".marketplace #colMarketFee"),this.dropDownItemId=$(".marketplace #itemId"),this.dropDownPriceType=$(".marketplace #priceType"),this.dropDownPriceRange=$(".marketplace #priceRange"),this.btnSubmitOffer=$("#submitOffer"),this.dropDownPriceType.ogameDropDown(),this.dropDownPriceRange.ogameDropDown(),this.btnOptSellRequest=$("#btnOptSellRequest"),this.btnOptBuyRequest=$("#btnOptBuyRequest"),this.btnOptSellOrder=$("#btnOptSellOrder"),this.btnOptBuyOrder=$("#btnOptBuyOrder"),this.btnOptShips=$("#btnOptShips"),this.btnOptResources=$("#btnOptResources"),this.btnOptItems=$("#btnOptItems"),this.btnSubmitOffer.on("click",this.onClickSubmitOffer.bind(this)),this.inputMarketItemType.on("change",this.onChangeMarketItemType.bind(this)),this.inputItemType.on("change",this.onChangeItemType.bind(this)),this.inputQuantity.on("blur",this.onChangeQuantity.bind(this)),this.inputQuantity.on("focus",this.onFocusQuantity.bind(this)),this.inputQuantity.on("keyup",this.onKeyInputQuantity.bind(this)),this.inputPrice.on("blur",this.onChangePrice.bind(this)),this.inputPrice.on("focus",this.onFocusPrice.bind(this)),this.inputPrice.on("keyup",this.onKeyInputPrice.bind(this)),this.dropDownItemId.on("change",this.onChangeItemId.bind(this)),this.dropDownPriceType.on("change",this.onChangePriceType.bind(this)),this.dropDownPriceRange.on("change",this.onChangePriceRange.bind(this)),this.priceLimitMin.on("click",this.onClickPriceMin.bind(this)),this.priceLimitMax.on("click",this.onClickPriceMax.bind(this)),this.resetPriceType(),this.resetMarketItemType(),this.resetItemType(),this.refreshAvailableItemTypes(),this.resetPrice(),this.resetPriceRange(),this.refreshMarketItemTypes(),this.refreshFormSteps(),this.refreshItemTypes(),this.refreshItemIdOptions(),this.refreshItemId(),this.refreshItemBox(),this.refreshPriceRangeVisiblity(),this.refreshPrice()},Marketplace.prototype.onClickSubmitOffer=function(t){t.preventDefault(),this.submitOffer()},Marketplace.prototype.refreshAvailableItemTypes=function(){let t=this.getMinQuantityByItemType(this.ITEM_TYPE_SHIP),e=this.getItemOptionsByItemType(this.ITEM_TYPE_SHIP,t);this.MARKET_ITEM_TYPE_SELL_ORDER===this.marketItemType?(this.marketFeeColElem.show(),0==e.length&&(this.btnOptShips.attr("disabled","disabled"),$("label[for='btnOptShips']").addClass("disabled"))):this.MARKET_ITEM_TYPE_BUY_ORDER===this.marketItemType&&(this.marketFeeColElem.hide(),this.btnOptShips.removeAttr("disabled"),$("label[for='btnOptShips']").removeClass("disabled")),t=this.getMinQuantityByItemType(this.ITEM_TYPE_TRADABLE_ITEM),e=this.getItemOptionsByItemType(this.ITEM_TYPE_TRADABLE_ITEM,t),this.MARKET_ITEM_TYPE_SELL_ORDER===this.marketItemType?(this.marketFeeColElem.show(),0==e.length&&(this.btnOptItems.attr("disabled","disabled"),$("label[for='btnOptItems']").addClass("disabled"))):this.MARKET_ITEM_TYPE_BUY_ORDER===this.marketItemType&&(this.marketFeeColElem.hide(),this.btnOptItems.removeAttr("disabled"),$("label[for='btnOptItems']").removeClass("disabled"))},Marketplace.prototype.submitOffer=function(){let t={marketItemType:this.marketItemType,itemType:this.itemType,itemId:this.itemId,quantity:this.quantity,priceType:this.priceType,price:this.price,_token:this.token};this.isOrder()&&(t.priceRange=this.priceRange),this.loadingIndicator.show(),$.post(this.urlSubmitOffer,t,this.handleSubmitOfferResponse.bind(this)).done(this.onAjaxDone.bind(this))},Marketplace.prototype.handleSubmitOfferResponse=function(t){let e=JSON.parse(t),i=e.status||"failure";this.updateToken(e.newToken),"success"===i?window.location=e.redirectUrl:this.displayErrors(e.errors)},Marketplace.prototype.resetMarketItemType=function(){this.setMarketItemType(this.getFirstMarketItemType())},Marketplace.prototype.setMarketItemType=function(t){let e=this.marketItemType;this.marketItemType=parseInt(t),this.marketItemType!==e&&(this.marketItemType===this.MARKET_ITEM_TYPE_BUY_ORDER&&this.priceInformation.show(),this.marketItemType===this.MARKET_ITEM_TYPE_SELL_ORDER&&this.priceInformation.hide(),this.resetItemType(),this.resetItemId(),this.refreshAvailableItemTypes(),this.refreshItemTypes(),this.refreshItemIdOptions(),this.refreshItemId(),this.refreshItemBox(),this.refreshFormSteps(),this.refreshPriceRangeVisiblity())},Marketplace.prototype.resetItemType=function(){this.setItemType(this.getFirstItemType())},Marketplace.prototype.setItemType=function(t){let e=this.itemType;this.itemType=parseInt(t),e!==this.itemType&&(this.resetItemId(),this.resetPriceTypeOnEqualResource(),this.refreshItemTypes(),this.refreshItemIdOptions(),this.refreshItemId(),this.refreshItemBox())},Marketplace.prototype.resetItemId=function(){this.setItemId(this.getFirstItemId(this.itemType))},Marketplace.prototype.setItemId=function(t){this.itemType!==this.ITEM_TYPE_TRADABLE_ITEM&&(t=parseInt(t));let e=this.itemId;this.itemId=t,e!==this.itemId&&(this.refreshItemBox(),this.resetQuantity(),this.resetPriceTypeOnEqualResource())},Marketplace.prototype.resetPriceTypeOnEqualResource=function(){if(this.itemType===this.ITEM_TYPE_RESOURCE&&this.itemId===this.priceType)switch(this.itemId){case this.RESOURCE_TYPE_METAL:this.setPriceType(this.RESOURCE_TYPE_CRYSTAL);break;case this.RESOURCE_TYPE_CRYSTAL:this.setPriceType(this.RESOURCE_TYPE_DEUTERIUM);break;case this.RESOURCE_TYPE_DEUTERIUM:this.setPriceType(this.RESOURCE_TYPE_METAL)}},Marketplace.prototype.getDefaultQuantity=function(){return this.getItemOption(this.itemType,this.itemId).minQuantity},Marketplace.prototype.resetQuantity=function(){this.setQuantity(this.getDefaultQuantity(),!0)},Marketplace.prototype.setQuantity=function(t,e){e=e||!1;let i=this.quantity,n=this.getItemOption(this.itemType,this.itemId),a=void 0!==n?Math.min(n.quantity,n.maxQuantity):0;a=Math.min(a,this.constants.MARKET_MAX_QUANTITY),this.isSelling()&&(this.quantity=clampInt(t,n.minQuantity,a)),this.isBuying()&&(this.quantity=clampInt(t,n.minQuantity,this.constants.MARKET_MAX_QUANTITY)),this.quantity===i&&this.quantity===parseInt(t)&&!0!==e||(this.resetPrice(),this.refreshQuantity(),this.refreshPrice(),this.refreshPriceLimit())},Marketplace.prototype.resetPrice=function(){let t=this.getPriceCalculated(this.quantity);this.setPrice(t)},Marketplace.prototype.setPrice=function(t){let e=this.price,i=this.getPriceCalculated(this.quantity),n=this.getPriceMin(this.quantity),a=this.getPriceMax(this.quantity);void 0===i||void 0===n||void 0===a||0===this.quantity?this.price=0:this.price=clampFloat(t,n,a),this.price===e&&this.price===t||(this.refreshPrice(),this.refreshPriceValidation(),this.refreshPriceLimit())},Marketplace.prototype.resetPriceType=function(){this.setPriceType(this.getFirstResourceType()),this.refreshPriceType()},Marketplace.prototype.setPriceType=function(t){let e=this.priceType;this.priceType=parseInt(t),this.priceType!==e&&(this.resetPrice(),this.refreshPriceType())},Marketplace.prototype.resetPriceRange=function(){this.setPriceRange(this.defaultPriceRange)},Marketplace.prototype.setPriceRange=function(t){let e=this.priceRange;this.priceRange=parseInt(t),this.priceRange!==e&&this.refreshPrice()},Marketplace.prototype.onChangeMarketItemType=function(t){this.setMarketItemType($('.marketplace input[name="type"]:checked').val())},Marketplace.prototype.onChangeItemType=function(t){this.setItemType($('.marketplace input[name="itemType"]:checked').val())},Marketplace.prototype.onChangeItemId=function(t){this.setItemId(this.dropDownItemId.val())},Marketplace.prototype.onChangeQuantity=function(t){this.setQuantity(this.inputQuantity.val())},Marketplace.prototype.onFocusQuantity=function(t){this.inputQuantity.val("")},Marketplace.prototype.onKeyInputQuantity=function(t){if(75==t.which){let e=parseInt($(t.target).val())||0;0==e&&(e=1),e+="000",$(t.target).val(e)}},Marketplace.prototype.onChangePrice=function(t){this.quantity>0?this.setPrice(parseFloat(this.inputPrice.val())):this.setPrice(0)},Marketplace.prototype.onFocusPrice=function(t){this.inputPrice.val("")},Marketplace.prototype.onKeyInputPrice=function(t){if(75==t.which){let e=parseInt($(t.target).val())||0;0==e&&(e=1),e+="000",$(t.target).val(e)}},Marketplace.prototype.onChangePriceType=function(t){this.setPriceType(this.dropDownPriceType.val())},Marketplace.prototype.onChangePriceRange=function(t){this.setPriceRange(this.dropDownPriceRange.val()),this.refreshPriceInformation()},Marketplace.prototype.refreshMarketItemTypes=function(){this.btnOptSellOrder.prop("checked",this.marketItemType===this.MARKET_ITEM_TYPE_SELL_ORDER),this.btnOptBuyOrder.prop("checked",this.marketItemType===this.MARKET_ITEM_TYPE_BUY_ORDER)},Marketplace.prototype.refreshFormSteps=function(){let t=this.formSteps[this.marketItemType]||[];$(".marketplace .og-sub-step.sub-step-1").html(t[0]||""),$(".marketplace .og-sub-step.sub-step-2").html(t[1]||""),$(".marketplace .og-sub-step.sub-step-3").html(t[2]||"")},Marketplace.prototype.refreshItemTypes=function(){this.btnOptShips.prop("checked",this.itemType===this.ITEM_TYPE_SHIP),this.btnOptResources.prop("checked",this.itemType===this.ITEM_TYPE_RESOURCE),this.btnOptItems.prop("checked",this.itemType===this.ITEM_TYPE_TRADABLE_ITEM)},Marketplace.prototype.refreshItemBox=function(){let t=this.getItemOption(this.itemType,this.itemId);if(t){let e="";e=t.type===this.ITEM_TYPE_TRADABLE_ITEM?'<img src="'+t.itemImage+'"/>':'<div class="sprite '+t.cssClass+'"></div>',this.itemBox.find(".thumbnail").html(e),this.itemBox.find(".quantity").html(tsdpkt(t.quantity))}else this.itemBox.find(".thumbnail").html(""),this.itemBox.find(".quantity").html("-")},Marketplace.prototype.refreshItemIdOptions=function(){this.dropDownItemId.ogameDropDown("destroy"),this.dropDownItemId.html("");let t="";this.ITEM_TYPE_SHIP===this.itemType&&this.MARKET_ITEM_TYPE_SELL_ORDER===this.marketItemType&&this.itemOptions.ships.forEach((function(e){e.quantity>0&&(t+='<option value="'+e.value+'">'+e.name+"</option>")})),this.ITEM_TYPE_SHIP===this.itemType&&this.MARKET_ITEM_TYPE_BUY_ORDER===this.marketItemType&&this.itemOptions.ships.forEach((function(e){t+='<option value="'+e.value+'">'+e.name+"</option>"})),this.ITEM_TYPE_RESOURCE===this.itemType&&this.itemOptions.resources.forEach((function(e){t+='<option value="'+e.value+'">'+e.name+"</option>"})),this.ITEM_TYPE_TRADABLE_ITEM===this.itemType&&this.MARKET_ITEM_TYPE_SELL_ORDER===this.marketItemType&&this.itemOptions.items.forEach((function(e){e.quantity>0&&(t+='<option value="'+e.value+'">'+e.name+"</option>")})),this.ITEM_TYPE_TRADABLE_ITEM===this.itemType&&this.MARKET_ITEM_TYPE_BUY_ORDER===this.marketItemType&&this.itemOptions.items.forEach((function(e){t+='<option value="'+e.value+'">'+e.name+"</option>"})),this.dropDownItemId.html(t).ogameDropDown()},Marketplace.prototype.refreshItemId=function(){this.dropDownItemId.find("option").removeAttr("selected"),this.itemId&&this.dropDownItemId.find('option[value="'+this.itemId+'"]').attr("selected","selected")},Marketplace.prototype.refreshQuantity=function(){this.inputQuantity.val(this.quantity)},Marketplace.prototype.refreshPriceRangeVisiblity=function(){this.isOrder()?$("#colPriceRange").show():$("#colPriceRange").hide()},Marketplace.prototype.refreshPrice=function(){this.refreshPriceRange();let t=parseInt(this.price);this.inputPrice.val(t),this.refreshPriceLimit(),this.refreshMarketFee(),this.refreshPriceInformation()},Marketplace.prototype.refreshPriceType=function(){this.dropDownPriceType.find("option").removeAttr("selected"),this.priceType&&(this.dropDownPriceType.val(this.priceType),this.dropDownPriceType.find('option[value="'+this.priceType+'"]').attr("selected","selected"),this.dropDownPriceType.ogameDropDown("refresh"))},Marketplace.prototype.refreshPriceRange=function(){this.dropDownPriceRange.find("option").removeAttr("selected"),this.priceRange&&(this.dropDownPriceRange.find('option[value="'+this.priceRange+'"]').attr("selected","selected"),this.dropDownPriceRange.val(this.priceRange),this.dropDownPriceRange.ogameDropDown("refresh"))},Marketplace.prototype.refreshPriceLimit=function(){let t=this.getPriceMin(this.quantity),e=this.getPriceMax(this.quantity);void 0===t||void 0===e?(this.priceLimitMin.html(""),this.priceLimitMax.html(""),this.priceLimitMin.data("priceMin",0),this.priceLimitMax.data("priceMax",0)):(this.priceLimitMin.html(tsdpkt(t)),this.priceLimitMin.data("priceMin",t),this.priceLimitMax.html(tsdpkt(e)),this.priceLimitMax.data("priceMax",e))},Marketplace.prototype.refreshPriceValidation=function(){},Marketplace.prototype.refreshMarketFee=function(){let t=this.getPriceTypeOption(this.priceType);if(this.isOrder()){this.getPriceMin(this.quantity),this.getPriceMax(this.quantity);let e=Math.floor(this.price*(1-this.priceRange/100)*this.marketFee),i=Math.floor(this.price*(1+this.priceRange/100)*this.marketFee);this.marketFeeElem.html(tsdpkt(e)+" - "+tsdpkt(i)+" "+t.name)}else{let e=Math.floor(this.price*this.marketFee);this.marketFeeElem.html(tsdpkt(e)+" "+t.name)}},Marketplace.prototype.refreshPriceInformation=function(){let t=Math.floor(this.price*(1+$("#priceRange option:selected").val()/100));this.priceToPay.html(tsdpkt(t)),this.priceInTotal.html(tsdpkt(this.price)),this.priceRangeValue.html($("#priceRange option:selected").text())},Marketplace.prototype.getFirstMarketItemType=function(){return parseInt(this.marketItemTypes[Object.keys(this.marketItemTypes)[0]])},Marketplace.prototype.getFirstItemType=function(){let t=parseInt(this.itemTypes[Object.keys(this.itemTypes)[0]]),e=this.getMinQuantityByItemType(t);return 0==this.getItemOptionsByItemType(t,e).length?this.ITEM_TYPE_RESOURCE:parseInt(this.itemTypes[Object.keys(this.itemTypes)[0]])},Marketplace.prototype.getMinQuantityByItemType=function(t){return this.ITEM_TYPE_TRADABLE_ITEM!==t&&this.ITEM_TYPE_SHIP!==t||this.MARKET_ITEM_TYPE_SELL_ORDER!==this.marketItemType?0:1},Marketplace.prototype.getItemOptionsByItemType=function(t,e){let i,n=[];if(void 0===t)return n;switch(t){case this.ITEM_TYPE_SHIP:i=this.itemOptions.ships;break;case this.ITEM_TYPE_RESOURCE:i=this.itemOptions.resources;break;case this.ITEM_TYPE_TRADABLE_ITEM:i=this.itemOptions.items}for(let t=0;t<i.length;t++)i[t].quantity>=e&&n.push(i[t]);return n},Marketplace.prototype.getFirstItemId=function(t){let e=this.getMinQuantityByItemType(t),i=this.getItemOptionsByItemType(t,e);return i.length>0?i[0].value:void 0},Marketplace.prototype.getItemOption=function(t,e){if(void 0===t)return;let i=this.getMinQuantityByItemType(t);return this.getItemOptionsByItemType(t,i).find((function(t){return t.value===e}))},Marketplace.prototype.getPriceTypeOption=function(t){return this.priceTypeOptions.find((function(e){return e.value===t}))},Marketplace.prototype.getFirstResourceType=function(){return this.itemOptions.resources[0].value},Marketplace.prototype.isOrder=function(){return this.marketItemType===this.MARKET_ITEM_TYPE_BUY_ORDER||this.marketItemType===this.MARKET_ITEM_TYPE_SELL_ORDER},Marketplace.prototype.isBuying=function(){return this.marketItemType===this.MARKET_ITEM_TYPE_BUY_ORDER},Marketplace.prototype.isSelling=function(){return this.marketItemType===this.MARKET_ITEM_TYPE_SELL_ORDER},Marketplace.prototype.displayErrors=function(t){let e=t[0]||void 0;e&&fadeBox(e.message,!0)},Marketplace.prototype.isPriceValid=function(){let t=this.getPriceCalculated(this.quantity),e=this.getPriceMin(this.quantity),i=this.getPriceMax(this.quantity);return void 0!==t&&void 0!==e&&void 0!==i&&(e<t&&t<i)},Marketplace.prototype.getPriceCalculated=function(t){let e=this.getItemOption(this.itemType,this.itemId);if(void 0!==e)return Math.floor(this.convertMCDTo(e.priceCalculatedInMCD*t,this.priceType))},Marketplace.prototype.getPriceMin=function(t){let e=this.getPriceCalculated(t);if(void 0!==e)return this.calcMinPrice(e)},Marketplace.prototype.getPriceMax=function(t){let e=this.getPriceCalculated(t);if(void 0!==e)return this.calcMaxPrice(e)},Marketplace.prototype.convertMCDTo=function(t,e){switch(e){case this.RESOURCE_TYPE_METAL:return this.convertMCDToMetal(t);case this.RESOURCE_TYPE_CRYSTAL:return this.convertMCDToCrystal(t);case this.RESOURCE_TYPE_DEUTERIUM:return this.convertMCDToDeuterium(t)}return 0},Marketplace.prototype.convertMCDToMetal=function(t){return t},Marketplace.prototype.convertMCDToCrystal=function(t){return t*(this.currentRatio.crystal/this.currentRatio.metal)},Marketplace.prototype.convertMCDToDeuterium=function(t){return t*(this.currentRatio.deuterium/this.currentRatio.metal)},Marketplace.prototype.calcMinPrice=function(t){return Math.max(Math.floor(t*(1-this.priceRangeLower)),1)},Marketplace.prototype.calcMaxPrice=function(t){return Math.floor(t*(1+this.priceRangeUpper))},Marketplace.prototype.getMetalAvailable=function(){return this.getResourceAvailable(this.RESOURCE_TYPE_CRYSTAL)},Marketplace.prototype.getCrystalAvailable=function(){return this.getResourceAvailable(this.RESOURCE_TYPE_CRYSTAL)},Marketplace.prototype.getDeuteriumAvailable=function(){return this.getResourceAvailable(this.RESOURCE_TYPE_CRYSTAL)},Marketplace.prototype.getResourceAvailable=function(t){let e=this.getItemOption(this.ITEM_TYPE_RESOURCE,t);return void 0!==e?e.quantity:0},Missile.prototype.onAjaxDone=function(t){if("success"===JSON.parse(t).status){$("#rocketsilo").parents(".overlayDiv").dialog("close");let t=$("#technologydetails").data("technology-id");technologyDetails.show(t),this.deattachCommon(),$(".rocketlayer").remove()}},Missile.prototype.initCommon=function(t){if($(".rocketlayer").length>1)for(let t=0;t<$(".rocketlayer").length-1;t++)$($(".rocketlayer")[t]).remove();this.missileInterceptor=$("#rocketsilo #destroy_"+this.interceptor),this.missileInterplanetary=$("#rocketsilo #destroy_"+this.interplanetary),this.destroyButton=$("#rocketsilo #destroyMissiles"),this.deattachCommon(),this.missileInterceptor.on("focus",this.onFocusInterceptor.bind(this)),this.missileInterceptor.on("keyup",this.onKeyInputInterceptor.bind(this)),this.missileInterplanetary.on("focus",this.onFocusInterplanetary.bind(this)),this.missileInterplanetary.on("keyup",this.onKeyInputInterplanetary.bind(this)),this.destroyButton.on("click",this.onClickButtonDestroy.bind(this))},Missile.prototype.deattachCommon=function(){this.missileInterceptor.off("focus"),this.missileInterceptor.off("keyup"),this.missileInterplanetary.off("focus"),this.missileInterplanetary.off("keyup"),this.destroyButton.off("click")},Missile.prototype.onFocusInterceptor=function(t){this.missileInterceptor.val("")},Missile.prototype.onKeyInputInterceptor=function(t){var e=$(t.target).val();void 0!==typeof e&&""!==e&&(intVal=Math.abs(getValue(e)),intVal=Math.min(intVal,this.maxInterceptor),$(t.target).val(intVal))},Missile.prototype.onFocusInterplanetary=function(t){this.missileInterplanetary.val("")},Missile.prototype.onKeyInputInterplanetary=function(t){var e=$(t.target).val();void 0!==typeof e&&""!==e&&(intVal=Math.abs(getValue(e)),intVal=Math.min(intVal,this.maxInterplanetary),$(t.target).val(intVal))},Missile.prototype.onClickButtonDestroy=function(t){t.preventDefault();let e={interceptorMissile:this.missileInterceptor.val()||0,interplanetaryMissile:this.missileInterplanetary.val()||0,_token:this.token};$.post(this.urlMissileDestroy,e,this.onDestroyMissiles.bind(this)).done(this.onAjaxDone.bind(this))},Missile.prototype.onDestroyMissiles=function(t){let e=JSON.parse(t);this.token=e.newAjaxToken,token=e.newAjaxToken,"success"===e.status?fadeBox(e.message,!1):fadeBox(e.message,!0)},$((function(){$(".slideIn").on("click",(function(){loadDetails($(this).data("type"))})),$("#detail").on("click",".close_details",(function(){$("#detail").hide()}))}));var textDestination=[];function type(){if(animatedOverview){var t=document.getElementById(textDestination[currentIndex]);if(t){if("<"==textContent[currentIndex].substr(currentChar,1)&&1!=linetwo)for(;">"!=textContent[currentIndex].substr(currentChar,1);)currentChar++;1==linetwo?(t.innerHTML=textContent[currentIndex],currentChar=t.innerHTML=textContent[currentIndex].length+1):(t.innerHTML=textContent[currentIndex].substr(0,currentChar)+"_",currentChar++),currentChar>textContent[currentIndex].length?(t.innerHTML=textContent[currentIndex],currentIndex++,currentChar=0,currentIndex<textContent.length&&type()):setTimeout("type()",15)}}else for(var e=0;e<textDestination.length;e++)document.getElementById(textDestination[e]).innerHTML=textContent[e]}function initType(){type()}function OGamePaginatable(t,e){this.container=t,this.page=e.page||0,this.numPages=e.numPages||0,this.size=e.size||10,this.token=e.token||null,this.onChange=e.onChange||null}function PercentageBar(t){this.elem=$(t),this.elem.data("percentageBarInstance",this),this.elem.disableSelection(),this.value=parseFloat(this.elem.attr("value")||20),this.minValue=parseInt(this.elem.attr("minValue")||.5),this.steps=parseInt(this.elem.attr("steps")||20),this.stepSize=parseInt(this.elem.attr("stepSize")||20),this.useHalfStep="true"===this.elem.attr("useHalfStep")||!1,this.barFactor=1,this.valueOnEnter=null,this.isDragging=!1,this.init(),this.updateBar()}function addPercentageBarPlugin(){jQuery.fn.percentageBar=function(t){return new PercentageBar(this,t),this}}textDestination[0]="diameterField",textDestination[1]="diameterContentField",textDestination[2]="temperatureField",textDestination[3]="temperatureContentField",textDestination[4]="positionField",textDestination[5]="positionContentField",textDestination[6]="scoreField",textDestination[7]="scoreContentField",textDestination[8]="honorField",textDestination[9]="honorContentField",OGamePaginatable.prototype.init=function(){this.container.text();this.element=$('<ul class="og-paginatable"></ul>'),this.container.html(this.element),$(this.element).on("click","li",this.handleClick.bind(this)),this.refresh()},OGamePaginatable.prototype.handleClick=function(t){let e=$(t.currentTarget).data("page");switch(e){case"page-first":this.page=1;break;case"page-left":this.page=clampInt(parseInt(this.page-1),1,this.numPages);break;case"page-last":this.page=this.numPages;break;case"page-right":this.page=clampInt(parseInt(this.page+1),1,this.numPages);break;default:this.page=clampInt(parseInt(e),1,this.numPages)}this.refresh(),this.notifyChange()},OGamePaginatable.prototype.update=function(t){this.page=t.page||this.page,this.numPages=t.numPages||this.numPages,this.token=t.token||this.token,this.refresh()},OGamePaginatable.prototype.getPage=function(){return this.page},OGamePaginatable.prototype.getNumPages=function(){return this.numPages},OGamePaginatable.prototype.notifyChange=function(){this.onChange&&this.onChange({page:this.page,numPages:this.numPages,_token:this.token})},OGamePaginatable.prototype.refresh=function(){if(0===this.numPages)return void this.element.html("-");let t=this.page-Math.floor(this.size/2),e=t+this.size;if(t<1){let i=1-t;t+=i,e+=i}else if(e>this.numPages){let i=this.numPages-e;t+=i,e+=i}t=clampInt(t,1,this.numPages),e=clampInt(e,1,this.numPages);let i=[];i.push('<li data-page="page-first">&lt;&lt;</li>'),i.push('<li data-page="page-left">&lt;</li>');for(let n=t;n<=e;++n){let t=n===this.page?"active":"";i.push('<li data-page="'+n+'" class="'+t+'">'+n+"</li>")}i.push('<li data-page="page-right">&gt;</li>'),i.push('<li data-page="page-last">&gt;&gt;</li>'),this.element.html(i.join(""))},function(t){t.fn.ogamePaginatable=function(e){if(this.length>0){let i=t(this[0]),n=e||{},a=i.data("ogamePaginatable");return null==a&&(a=new OGamePaginatable(i,n),t(this).data("ogamePaginatable",a),a.init()),a}return null}}(jQuery),PercentageBar.prototype.init=function(){this.useHalfStep&&(this.barFactor=2),this.initBar(),this.initSteps(),void 0===document.createTouch?(this.elem.on("mouseup",this.onMouseUp.bind(this)),this.elem.on("mousemove",this.onMouseMove.bind(this)),this.elem.on("mouseenter",this.onMouseEnter.bind(this)),this.elem.on("mouseleave",this.onMouseLeave.bind(this))):(this.elem.on("touchstart",this.onTouchStart.bind(this)),this.elem.on("touchmove",this.onTouchMove.bind(this)),this.elem.on("touchend",this.onTouchEnd.bind(this)))},PercentageBar.prototype.initSteps=function(){let t='<div class="steps">';for(let e=0;e<this.steps;++e){let i=(e+1)*this.stepSize;t+='<div class="step'+(10===this.stepSize?" step2":"")+'"  style="cursor: pointer" onclick="" data-step="'+(e+1)/this.barFactor+'">'+i+"</div>"}this.elem.append(t)},PercentageBar.prototype.initBar=function(){this.elem.append('<div class="bar"></bar>')},PercentageBar.prototype.updateDrag=function(t){let e=this.elem.offset().left,i=e+this.elem.outerWidth(),n=t.pageX,a=this.calcValue(n,e,i);this.setValue(a)},PercentageBar.prototype.onMouseUp=function(t){this.valueOnEnter&&(this.valueOnEnter=this.getValue(),this.setValue(this.valueOnEnter)),this.updateDrag(t)},PercentageBar.prototype.onMouseMove=function(t){this.updateDrag(t)},PercentageBar.prototype.onMouseEnter=function(t){this.valueOnEnter=this.getValue()},PercentageBar.prototype.onMouseLeave=function(t){this.valueOnEnter>0&&this.setValue(this.valueOnEnter)},PercentageBar.prototype.onTouchStart=function(t){this.startDrag()},PercentageBar.prototype.onTouchMove=function(t){},PercentageBar.prototype.onTouchEnd=function(t){this.valueOnEnter&&(this.valueOnEnter=this.getValue(),this.setValue(this.valueOnEnter)),this.updateDragTouch(t),this.stopDrag()},PercentageBar.prototype.startDrag=function(){this.isDragging=!0,this.valueOnEnter=this.getValue()},PercentageBar.prototype.stopDrag=function(){this.isDragging=!1},PercentageBar.prototype.updateDragTouch=function(t){if(!0===this.isDragging){let e=this.elem.offset().left,i=e+this.elem.outerWidth(),n=t.originalEvent.pageX;0===n&&(n=t.originalEvent.changedTouches[0].pageX);let a=this.calcValue(n,e,i);this.setValue(a)}},PercentageBar.prototype.calcValue=function(t,e,i){let n=(clampInt(t,e,i)-e)/(i-e),a=Math.floor(n*this.steps),s=Math.ceil(n*this.steps);return Math.round((s+a)/2)/this.barFactor},PercentageBar.prototype.setValue=function(t){let e=this.value;this.value=clampFloat(t,this.minValue,this.steps),e!==t&&this.elem.trigger($.Event("change",{value:this.value})),this.updateBar()},PercentageBar.prototype.getValue=function(){return this.value},PercentageBar.prototype.updateBar=function(){let t=this.elem.offset().left,e=t+this.elem.outerWidth(),i=parseInt(this.value/this.steps*(e-t)*this.barFactor);this.elem.find(".bar").width(i),this.elem.find(".step").toggleClass("selected",!1),this.elem.find('.step[data-step="'+this.value+'"]').toggleClass("selected",!0)},$((function(){$(".percentSelector").each((function(){PercentSelector.initBar(this)}))}));var PercentSelector={},buildUrl;function sendBuildRequest(t,e,i){if(null!=e){var n;if(window.event)n=window.event.keyCode;else{if(!e)return!0;n=e.which}if(13!=n)return!0}function a(){null==t||fastBuild()}return null==t||(fallBackFunc=a,buildUrl=t),planetMoveInProgress?errorBoxDecision(LOCA_ALL_NETWORK_ATTENTION,LOCA_PLANETMOVE_BREAKUP_WARNING,LOCA_ALL_YES,LOCA_ALL_NO,fallBackFunc):i&&lastBuildingSlot.showWarning?errorBoxDecision(LOCA_ALL_NETWORK_ATTENTION,lastBuildingSlot.slotWarning,LOCA_ALL_YES,LOCA_ALL_NO,a):a(),!1}function fastBuild(){return location.href=buildUrl,!1}function cancelResearch(t,e,i){errorBoxDecision(LOCA_ALL_NETWORK_ATTENTION,""+i,LOCA_ALL_YES,LOCA_ALL_NO,(function(){window.location.replace(urlResearchCancel+"&techid="+t+"&listid="+e)}))}PercentSelector.fallbackMode=!1,PercentSelector.initBar=function(bar){if(bar){var $bar=$(bar),height=$bar.innerHeight();$bar.children(".PBcolorGrad").remove(),$bar.children(".PBoverlay").remove();var opcAttr=$bar.attr("onpercentchange");if(opcAttr&&("function"==typeof opcAttr?$bar.get(0).onpercentchange=opcAttr:"string"==typeof opcAttr&&(/^function/.test(opcAttr)?eval("$bar.get(0).onpercentchange = "+opcAttr):eval("$bar.get(0).onpercentchange = function() {"+opcAttr+"}"))),PercentSelector.fallbackMode?($bar.addClass("fallback"),$bar.append($("<div class='PBfallbackColor'></div>").css("height",height).css("width",$bar.innerWidth()))):($bar.append($("<canvas class='PBoverlay'></canvas>").css("height",height).css("width",$bar.innerWidth())),$bar.append($("<div class='PBcolorGrad'></div>").css("height",20*height).css("top",-2*height)),PercentSelector.createOverlay($bar)),null!=$bar.attr("percent")){var percent=parseInt($bar.attr("percent"));$bar.attr("percent",100),PercentSelector.setPercent($bar,percent,!0)}if(!bar.isBound){if(!$bar.attr("enabled")||"false"!=$bar.attr("enabled").toLowerCase()){var $bindBar=$bar;null==document.createTouch?($bindBar.bind("mousedown",PercentSelector.handlers.mouseDown),$bindBar.bind("mousemove",PercentSelector.handlers.mouseMove),$bindBar.bind("mouseup",PercentSelector.handlers.mouseUp),$bindBar.bind("mouseout",PercentSelector.handlers.mouseOut)):($bindBar.bind("touchstart",PercentSelector.handlers.touchStart),$bindBar.bind("touchmove",PercentSelector.handlers.touchMove),$bindBar.bind("touchend",PercentSelector.handlers.touchEnd))}bar.isBound=!0}}},PercentSelector.setPercent=function(t,e,i){var n=$(t),a=n.attr("step");if(a=a?parseInt(a):1,(e=Math.round(e/a)*a)!=parseInt(n.attr("percent")))if(n.attr("percent",e),PercentSelector.fallbackMode)n.children(".PBfallbackColor").css("width",n.innerWidth()*e/100);else{i?(n.children(".PBcolorGrad").css("-webkit-transition","-webkit-transform 0.6s ease-in"),n.children(".PBcolorGrad").css("-moz-transition","-moz-transform 0.6s ease-in")):(n.children(".PBcolorGrad").css("-webkit-transition","-webkit-transform 0.1s ease-in"),n.children(".PBcolorGrad").css("-moz-transition","-moz-transform 0.1s ease-in"));var s=Math.round(.9*n.children(".PBcolorGrad").outerHeight()*(100-e)/100),o=Math.round(n.children(".PBcolorGrad").innerWidth()*((100-e)/100));i?setTimeout((function(){n.children(".PBcolorGrad").css("-webkit-transform","translate(-"+o+"px, -"+s+"px)"),n.children(".PBcolorGrad").css("-moz-transform","translate(-"+o+"px, -"+s+"px)"),n.children(".PBcolorGrad").css("-ms-transform","translate(-"+o+"px, -"+s+"px)")}),1):(n.children(".PBcolorGrad").css("-webkit-transform","translate(-"+o+"px, -"+s+"px)"),n.children(".PBcolorGrad").css("-moz-transform","translate(-"+o+"px, -"+s+"px)"),n.children(".PBcolorGrad").css("-ms-transform","translate(-"+o+"px, -"+s+"px)"))}},PercentSelector.setPercentFromPageX=function(t,e,i){var n=$(t),a=100*(e-n.offset().left)/n.outerWidth();a>100&&(a=100),a<10&&(a=10),a=Math.round(a),PercentSelector.setPercent(t,a,i)},PercentSelector.createOverlay=function(t){var e=$(t);$overlay=e.children(".PBoverlay");var i=$overlay.innerWidth(),n=$overlay.innerHeight(),a=$overlay.get(0);a.width=i,a.height=n;var s=a.getContext("2d"),o=s.createLinearGradient(0,0,0,n);o.addColorStop(0,"rgba(0,0,0,0.05)"),o.addColorStop(1,"rgba(0,0,0,0.3)"),s.fillStyle=o,s.fillRect(0,0,i,n),s.clearRect(3,3,i-6,n-6),(o=s.createLinearGradient(0,0,0,n)).addColorStop(0,"rgba(0,0,0,0.2)"),o.addColorStop(1,"rgba(0,0,0,0.05)"),s.fillStyle=o,s.fillRect(3,3,i-6,n-6);var r=e.attr("step");r||(r=100),s.lineWidth=1;for(var l=i/r,c=i/r,d=0;d*r<100;d+=1){var u=Math.floor(d*r*i/100)-.5;s.beginPath(),s.font="12px serif",s.fillStyle="white",s.strokeStyle="black",s.textAlign="center",s.textBaseline="middle",s.fillText((10*(d+1)).toString(),u+c/2,n/2,l),s.moveTo(u,n),s.lineTo(u,.75*n),s.closePath(),s.stroke()}},PercentSelector.handlers={},PercentSelector.handlers.touchDragging=!1,PercentSelector.handlers.touchStart=function(t){t.originalEvent.touches.length>1||(t.preventDefault(),PercentSelector.handlers.touchDragging=!1)},PercentSelector.handlers.touchEnd=function(t){if(touches=t.originalEvent.touches,0==touches.length&&(touches=t.originalEvent.changedTouches),!(touches.length>1)){var e=touches[0].target.parentNode;PercentSelector.setPercentFromPageX(e,touches[0].pageX,!0),null!=e.onpercentchange&&e.onpercentchange($(e).attr("percent")),t.preventDefault()}},PercentSelector.handlers.touchMove=function(t){PercentSelector.handlers.touchDragging=!0;var e=t.originalEvent.touches;e.length>1||(t.preventDefault(),PercentSelector.setPercentFromPageX(e[0].target.parentNode,e[0].pageX))},PercentSelector.handlers.mouseDragging=!1,PercentSelector.handlers.mouseDown=function(t){PercentSelector.handlers.mouseDragging=!0},PercentSelector.handlers.mouseOut=function(t){if(PercentSelector.handlers.mouseDragging)PercentSelector.fallbackMode?t.currentTarget:t.originalEvent.target.parentNode;PercentSelector.handlers.mouseDragging=!1},PercentSelector.handlers.mouseUp=function(t){PercentSelector.handlers.mouseDragging=!1;var e=PercentSelector.fallbackMode?t.currentTarget:t.originalEvent.target.parentNode;PercentSelector.setPercentFromPageX(e,t.pageX,!0)},PercentSelector.handlers.mouseMove=function(t){if(PercentSelector.handlers.mouseDragging){t.preventDefault();var e=PercentSelector.fallbackMode?t.currentTarget:t.originalEvent.target.parentNode;PercentSelector.setPercentFromPageX(e,t.pageX)}},$((function(){jQuery(".planetlink").hover((function(){jQuery(this).parent().addClass("hoverPlanet")}),(function(){jQuery(this).parent().removeClass("hoverPlanet")})),jQuery(".moonlink").hover((function(){jQuery(this).parent().addClass("hoverMoon")}),(function(){jQuery(this).parent().removeClass("hoverMoon")}))}));var metalTicker=void 0,crystalTicker=void 0,deuteriumTicker=void 0,populationTicker=void 0,foodTicker=void 0;function ResourceTicker(){this.timerObj=void 0,this.onClickActive=!1}ResourceTicker.Metal="metal",ResourceTicker.Crystal="crystal",ResourceTicker.Deuterium="deuterium",ResourceTicker.Energy="energy",ResourceTicker.Population="population",ResourceTicker.Food="food",ResourceTicker.prototype.reload=function(t){this.techs=t.techs||{},this.resources=t.resources||{},changeTooltip($("#metal_box"),t.resources.metal.tooltip),changeTooltip($("#crystal_box"),t.resources.crystal.tooltip),changeTooltip($("#deuterium_box"),t.resources.deuterium.tooltip),changeTooltip($("#darkmatter_box"),t.resources.darkmatter.tooltip),changeTooltip($("#energy_box"),t.resources.energy.tooltip),$("#population_box").length&&changeTooltip($("#population_box"),t.resources.population.tooltip),$("#food_box").length&&changeTooltip($("#food_box"),t.resources.food.tooltip),this.refresh()},ResourceTicker.prototype.start=function(){void 0===this.timerObj&&(this.timerObj=timerHandler.appendCallback(this.update.bind(this)))},ResourceTicker.prototype.stop=function(){void 0!==this.timerObj&&(timerHandler.removeCallback(this.timerObj),delete this.timerObj)},ResourceTicker.prototype.restart=function(){this.stop(),this.start()},ResourceTicker.prototype.update=function(){let t={metal:0,crystal:0,deuterium:0};$("#population_box").length&&(t.population=0);for(let e in t)if("population"===e){let t=0,e=0,i=0,n=0,a=0,s=0,o=0,r=0,l=0;if(this.resources.population.amount<Math.min(this.resources.population.capableToFeed,this.resources.population.storage)){i=Math.min(this.resources.population.capableToFeed-this.resources.population.amount,Math.min(this.resources.population.storage-this.resources.population.amount,this.resources.population.growthRate));let e=this.resources.population.amount*this.resources.population.singleFoodConsumption,n=i*this.resources.population.singleFoodConsumption;t=Math.max(0,Math.min(this.resources.food.storage-this.resources.food.amount,this.resources.food.production-n-e))}if(this.resources.population.amount>=Math.min(this.resources.population.capableToFeed,this.resources.population.storage)){let r=Math.floor(Math.max(this.resources.population.amount-this.resources.population.capableToFeed,0));e=Math.min(this.resources.food.amount,r*this.resources.population.singleFoodConsumption);let l=Math.max(this.resources.food.amount-e,0);if(0===r){let e=this.resources.population.amount*this.resources.population.singleFoodConsumption;t+=Math.max(0,Math.min(this.resources.food.storage-this.resources.population.amount,this.resources.food.production-e))}else o=Math.floor(l/(r*this.resources.population.singleFoodConsumption)),this.resources.food.vacationMode.length>1?$(".resourceTooltip .timeTillFoodRunsOut").html(this.resources.food.vacationMode):$(".resourceTooltip .timeTillFoodRunsOut").html("~"+formatTimeWrapper(o,2,!0," ",!1,""));let c=0;l+t>0?(n=Math.min(Math.max(this.resources.population.storage-this.resources.population.amount-i,0),this.resources.population.growthRate),n=Math.min((l+t)/this.resources.population.singleFoodConsumption,n),a=n*this.resources.population.singleFoodConsumption):c=1;let d=Math.max(this.resources.population.amount+i+n-Math.min(this.resources.population.storage,this.resources.population.capableToFeed),0);s=Math.min(this.resources.population.growthRate*c,d)}r+=i,r+=n,r-=s,l+=t,l-=e,l-=a;let c=this.resources.population.amount+r;this.resources.population.amount<this.resources.population.storage&&r>0?this.resources.population.amount=Math.min(c,this.resources.population.storage):r<0?this.resources.population.amount=Math.max(c,0):this.resources.population.amount>=this.resources.population.storage&&r>0&&(this.resources.population.amount=this.resources.population.storage,this.resources.population.growthRate=0);let d=this.resources.food.amount+l;this.resources.food.amount<this.resources.food.storage&&l>0?this.resources.food.amount=Math.min(d,this.resources.food.storage):l<=0?this.resources.food.amount=Math.max(d,0):0===d&&(this.resources.food.amount=0)}else{t[e]=this.resources[e].production;let i=this.resources[e].amount+t[e];this.resources[e].amount<this.resources[e].storage&&t[e]>0?this.resources[e].amount=Math.min(i,this.resources[e].storage):t[e]<0&&(this.resources[e].amount=Math.max(i,0))}this.refresh()},ResourceTicker.prototype.refresh=function(){let t={metal:$("#resources_metal"),crystal:$("#resources_crystal"),deuterium:$("#resources_deuterium"),darkmatter:$("#resources_darkmatter"),energy:$("#resources_energy"),population:$("#resources_population"),food:$("#resources_food")};t.metal.html(gfNumberGetHumanReadable(Math.floor(this.resources.metal.amount),!0)),t.metal.removeClass("overmark middlemark"),storageClass=this.getStorageClass(this.resources.metal.amount,this.resources.metal.storage),storageClass&&t.metal.toggleClass(storageClass,!0),t.crystal.html(gfNumberGetHumanReadable(Math.floor(this.resources.crystal.amount),!0)),t.crystal.removeClass("overmark middlemark"),storageClass=this.getStorageClass(this.resources.crystal.amount,this.resources.crystal.storage),storageClass&&t.crystal.toggleClass(storageClass,!0),t.deuterium.html(gfNumberGetHumanReadable(Math.floor(this.resources.deuterium.amount),!0)),t.deuterium.removeClass("overmark middlemark"),storageClass=this.getStorageClass(this.resources.deuterium.amount,this.resources.deuterium.storage),storageClass&&t.deuterium.toggleClass(storageClass,!0),t.darkmatter.html(gfNumberGetHumanReadable(this.resources.darkmatter.amount,!0)),t.energy.html(gfNumberGetHumanReadable(Math.floor(this.resources.energy.amount),!0)),t.energy.toggleClass("overmark",this.resources.energy.amount<0),t.population.length&&(t.population.html(gfNumberGetHumanReadable(Math.floor(this.resources.population.amount),!0)),t.population.removeClass("overmark middlemark"),storageClass=this.getStorageClass(this.resources.population.amount,this.resources.population.storage),storageClass&&t.population.toggleClass(storageClass,!0)),t.food.length&&(t.food.html(gfNumberGetHumanReadable(Math.floor(this.resources.food.amount),!0)),t.food.removeClass("overmark middlemark"),storageClass=this.getStorageClass(this.resources.food.amount,this.resources.food.storage),storageClass&&t.food.toggleClass(storageClass,!0))},ResourceTicker.prototype.getStorageClass=function(t,e){return t>=e?"overmark":t>=.9*e?"middlemark":void 0},ResourceTicker.prototype.activateOnClick=function(){!0!==this.onClickActive&&($("#metal_box, #crystal_box, #deuterium_box").off("click").on("click",(function(t){location.href=$(this).data("shopUrl")})),this.onClickActive=!0)};var resourcesBar=new ResourceTicker;function reloadResources(t,e){"string"==typeof t&&(t=$.parseJSON(t)),resourcesBar.reload(t),resourcesBar.activateOnClick(),!0===t.vacation?resourcesBar.stop():resourcesBar.restart(),honorScore=t.honorScore,darkMatter=t.resources.darkmatter.amount,"function"==typeof e&&e(t.resources)}function getAjaxResourcebox(t){}function Rewarding(t){this.tab=t.tab||"",this.token=t.token,this.tiers=t.tiers,this.currentTier=t.currentTier,this.urlFetchTasks=t.urlFetchTasks||null,this.urlFetchRewards=t.urlFetchRewards||null,this.selectedTier=t.selectedTier||1,this.initMap={tasks:this.initTabTasks.bind(this),rewards:this.initTabRewards.bind(this)},this.initMap[this.tab]&&this.initMap[this.tab](t)}function OGameSortable(t,e){this.container=t,this.state="active"===(e.state||"active")?"active":"inactive",this.order=e.order||"",this.align=e.align||"",this.allowUnsorted=e.allowUnsorted||!1,this.token=e.token||null,this.onChange=e.onChange||null}function initStandardFleet(){$(".list tr:even").addClass("alt"),$(".standardFleetSubmit").unbind("click").bind("click",(function(){$(this).parents("form").submit()})),$(".standardFleetReset").unbind("click").bind("click",(function(){$(this).parents("form")[0].reset()})),$(".changeFleet").unbind("click").bind("click",(function(){$(".combatunits").val($(this).attr("rel")).trigger("change"),$(this).parents(".ui-dialog").find(".ui-dialog-titlebar-close").click()}))}function setShipsFleet(t,e,i){for(var n in $("#template_id").val(i),$("#template_name").val(e),t)$("#ship"+n).val(t[n])}function TechnologyDetails(t){this.setParams(t)}window.addEventListener("load",(()=>{const t=document.getElementById("resourcesettingsForm");null!==t&&t.addEventListener("submit",(e=>{e.preventDefault();const i=new FormData(t,t.querySelector("input[type=submit]"));let n={};for(const t of i.entries())n[t[0]]=t[1];return n._token=token,$.post(saveResourcesettingsUrl,n,(t=>{const e=JSON.parse(t);if(token=e.newAjaxToken??token,void 0===e.status||"success"!==e.status)return void("object"==typeof e.errors&&e.errors.length>0&&(console.log(e.errors),fadeBox(e.errors[0].message,!0)));if(fadeBox(e.message??"",!1),getAjaxResourcebox(),void 0===e.changes||e.changes.length<=0)return;document.querySelector("#resourcesettingscomponent .productionFactorValue").textContent=Math.floor(100*(e.prodfactor??0));const i=(t,e)=>{Object.entries(e).forEach((([e,i])=>{const n=t.querySelector('td[data-resourceIdx="'+e+'"] span');n.textContent=i.number??i.value??0,changeTooltip(n,i.tooltipNumber??i.title??0),!1===n.classList.contains(i.class)&&(n.classList.remove("undermark"),n.classList.remove("overmark"),n.classList.remove("normalmark"),n.classList.add(i.class))}))};e.changes.forEach((t=>{if(void 0===e.techlist[t])return;const n=document.querySelector('#resourcesettingscomponent tr[data-techid="'+t+'"]');null!==n&&i(n,e.techlist[t].techProduction)})),i(document.querySelector("#resourcesettingscomponent .summaryHourly"),e.hourly),i(document.querySelector("#resourcesettingscomponent .summaryDaily"),e.daily),i(document.querySelector("#resourcesettingscomponent .summaryWeekly"),e.weekly),"object"==typeof e.ipiMenuData&&IPI.updateMenuContent(e.ipiMenuData)})),!1}))})),ogame.retrieveEmail={send:function(){$.ajax({type:"POST",url:window.location.href+"&"+$.param({action:"get"}),data:{username:$("#username").val(),password:$("#password").val()},dataType:"json",success:function(t){$("#response").html(t.response).removeClass().addClass(t.type)}})}},$(document).ready((function(){$("#retrieveEmailComponent #username").off().keypress((function(t){13==t.which&&(t.preventDefault(),$("#retrieveEmailComponent #password").focus())})),$("#retrieveEmailComponent #password").off().keypress((function(t){13==t.which&&(t.preventDefault(),ogame.retrieveEmail.send())})),$("#retrieve").off().on("click",(function(){ogame.retrieveEmail.send()}))})),Rewarding.prototype.onAjaxTasksDone=function(){this.loadingIndicator.hide()},Rewarding.prototype.onAjaxSelectDone=function(){this.loadingIndicator.hide()},Rewarding.prototype.onAjaxRewardsDone=function(){this.loadingIndicator.hide();let t=this;t.urlSubmitReward=urlSubmitReward,$("#rewardings .normalRewards .singleReward").each((function(){this.urlSubmitReward=t.urlSubmitReward,this.token=t.token,$(this).bind("click",t.onClickButtonSelectReward.bind(t)),$(this).hover((function(){$(this).find(".select-button").css("background-position","0 -214px")}),(function(){$(this).find(".select-button").css("background-position","0 -188px")}))}))},Rewarding.prototype.displayErrors=function(t){let e=t[0]||void 0;e&&fadeBox(e.message,!0)},Rewarding.prototype.onAjaxError=function(){},Rewarding.prototype.initCommon=function(t){this.taskWrapper=$("#rewardings .rewardlist_wrapper"),this.loadingIndicator=this.taskWrapper.ogameLoadingIndicator(),this.taskContent=$("#rewardings .rewardContent"),this.titlebar=$("#rewardings .titlebar"),this.tierButton=$("#rewardings #tothetier")},Rewarding.prototype.refreshContent=function(t){this.taskContent.html(t)},Rewarding.prototype.initTabTasks=function(t){for(var e in this.initCommon(t),this.titlebar.on("click","#buttonTasks",this.onClickButtonTasks.bind(this)),this.tiers)this.tiers.hasOwnProperty(e)&&this.titlebar.on("click",'div[data-tier="'+e+'"]',this.onClickButtonRewards.bind(this));this.tierButton.on("click",".tier-button",this.onClickButtonCurrentTier.bind(this)),this.fetchTasks()},Rewarding.prototype.onClickButtonTasks=function(t){if(t.preventDefault(),!t.currentTarget.hasAttribute("disabled"))for(var e in this.fetchTasks(),$("#rewardings .titlebar #buttonTasks").attr("disabled","disabled"),this.tiers)this.tiers.hasOwnProperty(e)&&$('#rewardings .titlebar div[data-tier="'+e+'"]').removeAttr("disabled")},Rewarding.prototype.onClickButtonRewards=function(t){t.preventDefault();let e=$(t.currentTarget).data("tier");t.currentTarget.hasAttribute("disabled")||this.fetchRewards(e)},Rewarding.prototype.onClickButtonCurrentTier=function(t){t.preventDefault();let e=this.currentTier;this.fetchRewards(e)},Rewarding.prototype.onClickButtonSelectReward=function(t){t.preventDefault(),t.currentTarget.hasAttribute("disabled")||this.submitReward($(t.currentTarget).data("id"))},Rewarding.prototype.fetchTasks=function(t){this.loadingIndicator.show();let e={_token:this.token};$.getJSON(this.urlFetchTasks,e,this.onFetchTasks.bind(this)).done(this.onAjaxTasksDone.bind(this))},Rewarding.prototype.onFetchTasks=function(t){let e=t.content[t.target];this.token=t.newAjaxToken,this.refreshContent(e)},Rewarding.prototype.initTabRewards=function(t){this.initCommon(t),this.titlebar.on("click","#buttonTasks",this.onClickButtonTasks.bind(this));for(let t in this.tiers)this.tiers.hasOwnProperty(t)&&this.titlebar.on("click",'div[data-tier="'+t+'"]',this.onClickButtonRewards.bind(this));this.tierButton.on("click",".tier-button",this.onClickButtonCurrentTier.bind(this)),this.fetchRewards(this.selectedTier)},Rewarding.prototype.fetchRewards=function(t){this.loadingIndicator.show();let e={tier:t,_token:this.token};for(var i in this.selectedTier=t,$.getJSON(this.urlFetchRewards,e,this.onFetchRewards.bind(this)).done(this.onAjaxRewardsDone.bind(this)),this.tiers)this.tiers.hasOwnProperty(i)&&$('#rewardings .titlebar div[data-tier="'+i+'"]').removeAttr("disabled");$("#rewardings .titlebar #buttonTasks").removeAttr("disabled"),$('#rewardings .titlebar div[data-tier="'+t+'"]').attr("disabled","disabled")},Rewarding.prototype.onFetchRewards=function(t){let e=t.content[t.target];this.token=t.newAjaxToken,this.refreshContent(e)},Rewarding.prototype.submitReward=function(t){this.loadingIndicator.show();let e={selectedReward:t,selectedTier:this.selectedTier,_token:this.token};$.post(this.urlSubmitReward,e,this.handleSubmitRewardResponse.bind(this)).done(this.onAjaxSelectDone.bind(this))},Rewarding.prototype.handleSubmitRewardResponse=function(t){let e=JSON.parse(t),i=e.status||"failure";if(this.token=e.newAjaxToken,"success"===i){let t=$("#rewardings #select_one");t.removeClass("overmark"),t.addClass("undermark"),t.html(e.rewardSelected),$('#rewardings .titlebar .btn_blue[data-tier="'+e.selectedTier+'"]').addClass("undermark"),$("#rewardings .normalRewards .singleReward").each((function(){$(this).attr("disabled","disabled"),$(this).data("id")!==e.selectedReward&&$("#rewardings .normalRewards #itemBox"+$(this).data("id")+" .thumbnail").data("status","off").attr("data-status","off")})),$("#rewardings .normalRewards .select-button").each((function(){$(this).remove()})),!1===e.allOfficers&&$("#rewardings .additionalRewards .singleReward").each((function(){$("#rewardings .additionalRewards #itemBox"+$(this).data("id")+" .thumbnail").data("status","off").attr("data-status","off")})),fadeBox(e.message,!1)}else this.displayErrors(e.errors)},OGameSortable.prototype.init=function(){let t='<div class="og-sortable"><h3>'+this.container.text()+'</h3><div class="icon"></div></div>';this.element=$(t),this.container.html(this.element),this.icon=this.element.find(".icon"),$(this.element).on("click",this.handleClick.bind(this)),this.refresh()},OGameSortable.prototype.handleClick=function(){"active"===this.state&&("asc"===this.order?this.order="desc":"desc"===this.order&&!1===this.allowUnsorted?this.order="asc":"desc"===this.order&&!0===this.allowUnsorted?this.order="":""===this.order&&(this.order="asc"),this.refresh(),this.notifyChange())},OGameSortable.prototype.notifyChange=function(){this.onChange&&this.onChange({order:this.order,state:this.state,_token:this.token})},OGameSortable.prototype.activate=function(){this.state="active",this.refresh(),this.notifyChange()},OGameSortable.prototype.deactivate=function(){this.state="inactive",this.refresh(),this.notifyChange()},OGameSortable.prototype.isValidOrder=function(t){return!0===this.allowUnsorted?-1!==["","asc","desc"].indexOf(t):-1!==["asc","desc"].indexOf(t)},OGameSortable.prototype.setOrder=function(t){this.isValidOrder(t)&&(this.order=t,this.refresh(),this.notifyChange())},OGameSortable.prototype.getOrder=function(){return this.order},OGameSortable.prototype.refresh=function(){this.refreshAlign(),this.refreshState(),this.refreshOrder()},OGameSortable.prototype.refreshAlign=function(){this.element.toggleClass("left","left"===this.align),this.element.toggleClass("center","center"===this.align),this.element.toggleClass("right","right"===this.align)},OGameSortable.prototype.refreshState=function(){this.element.toggleClass("active","active"===this.state),this.element.toggleClass("inactive","inactive"===this.state)},OGameSortable.prototype.refreshOrder=function(){this.element.toggleClass("asc","asc"===this.order),this.element.toggleClass("desc","desc"===this.order)},OGameSortable.prototype.update=function(t){this.token=t.token||this.token},function(t){t.fn.ogameSortable=function(e){if(this.length>0){let i=t(this[0]),n=e||{},a=i.data("ogameSortable");return null==a&&(a=new OGameSortable(i,n),t(this).data("ogameSortable",a),a.init()),a}return null}}(jQuery),$((function(){$(".techdetail").on("click",(function(){loadDetails($(this).data("techid"))})),$("#detail").on("click",".close_details",(function(){$("#detail").hide()}))})),$((function(){var t;(t=document.createElement("style")).appendChild(document.createTextNode("")),document.head.appendChild(t),t.sheet;$(document).on("click",".technology .icon button.upgrade",(function(t){t.preventDefault(),t.stopPropagation();let e=1==$(this).data("is-spaceprovider"),i=$(this).data("technology"),n=$(this).data("lifeform-bonus-cap-reached")>0;return planetMoveInProgress?errorBoxDecision(LocalizationStrings.attention,LocalizationStrings.planetMoveBreakUpWarning,LocalizationStrings.yes,LocalizationStrings.no,(function(){buildListActionBuild(i)})):lastBuildingSlot.showWarning&&!e?errorBoxDecision(LocalizationStrings.notice,lastBuildingSlot.slotWarning,LocalizationStrings.yes,LocalizationStrings.no,(function(){buildListActionBuild(i)})):n?errorBoxDecision(LocalizationStrings.attention,loca.LOCA_LIFEFORM_BONUS_CAP_REACHED_WARNING,LocalizationStrings.yes,LocalizationStrings.no,(function(){buildListActionBuild(i)})):void buildListActionBuild(i)})),$(document).on("click",".technology .icon button.buildmulti",(function(t){t.preventDefault(),t.stopPropagation();let e=1==$(this).data("is-spaceprovider"),i=$(this).data("technology"),n=$(this).data("lifeform-bonus-cap-reached")>0;return planetMoveInProgress?errorBoxDecision(LocalizationStrings.attention,LocalizationStrings.planetMoveBreakUpWarning,LocalizationStrings.yes,LocalizationStrings.no,(function(){buildListActionBuild(i,1,4)})):lastBuildingSlot.showWarning&&!e?errorBoxDecision(LocalizationStrings.notice,lastBuildingSlot.slotWarning,LocalizationStrings.yes,LocalizationStrings.no,(function(){buildListActionBuild(i,1,4)})):n?errorBoxDecision(LocalizationStrings.attention,loca.LOCA_LIFEFORM_BONUS_CAP_REACHED_WARNING,LocalizationStrings.yes,LocalizationStrings.no,(function(){buildListActionBuild(i,1,4)})):void buildListActionBuild(i,1,4)}))})),TechnologyDetails.prototype.init=function(){$(document).on("click",".technology.hasDetails:not(.showsDetails) .icon",this.onClickShow.bind(this)),$(document).on("click","#technologydetails .close, .showsDetails",this.onClickHide.bind(this)),$(document).on("change","#technologydetails .build_amount",this.onChangeAmount.bind(this)),$(document).on("keypress","#technologydetails .build_amount",this.onKeyPressAmount.bind(this)),$(document).on("click","#technologydetails button.upgrade",this.onClickUpgrade.bind(this)),$(document).on("click","#technologydetails a.upgrade",this.onClickUpgradeStorage.bind(this)),$(document).on("click","#technologydetails a.build-it_premium",this.onClickBuyCommander.bind(this)),$(document).on("click","#technologydetails button.downgrade",this.onClickDowngrade.bind(this)),$(document).on("click","#technologydetails button.maximum",this.onClickMaximum.bind(this)),$(document).on("click","#technologydetails .button.select_class",this.onClickSelectClass.bind(this)),$(document).on("click","#technologydetails .button.deselect_class",this.onClickDeselectClass.bind(this)),$(document).on("click",'#technologydetails button[data-target]:not(#technologydetails button[data-target*="overlay=1"], #technologydetails button.overlay)',(function(){}))},TechnologyDetails.prototype.setParams=function(t){this.loca=t.loca,this.technologyDetailsEndpoint=t.technologyDetailsEndpoint,this.selectCharacterClassEndpoint=t.selectCharacterClassEndpoint,this.deselectCharacterClassEndpoint=t.deselectCharacterClassEndpoint},TechnologyDetails.prototype.onChangeAmount=function(t){let e=$(t.currentTarget),i=parseInt(e.attr("min")),n=parseInt(e.attr("max")),a=parseInt(getValue(e.val()))||0;void 0!==i&&(a=Math.max(a,i)),void 0!==n&&(a=Math.min(a,n)),e.val(a)},TechnologyDetails.prototype.onKeyPressAmount=function(t){13==getKeyCode(t)&&$("#technologydetails button.upgrade").click()},TechnologyDetails.prototype.onClickUpgrade=function(t){let e=$(t.currentTarget).data("technology"),i=$("#build_amount").val()||1;return planetMoveInProgress?errorBoxDecision(LocalizationStrings.attention,LocalizationStrings.planetMoveBreakUpWarning,LocalizationStrings.yes,LocalizationStrings.no,(function(){buildListActionBuild(e,i)})):1==lastBuildingSlot.showWarning?errorBoxDecision(LocalizationStrings.notice,lastBuildingSlot.slotWarning,LocalizationStrings.yes,LocalizationStrings.no,(function(){buildListActionBuild(e,i)})):showLifeformBonusCapReached?errorBoxDecision(LocalizationStrings.attention,this.loca.LOCA_LIFEFORM_BONUS_CAP_REACHED_WARNING,LocalizationStrings.yes,LocalizationStrings.no,(function(){buildListActionBuild(e,i)})):void buildListActionBuild(e,i)},TechnologyDetails.prototype.onClickUpgradeStorage=function(t){let e=$(t.currentTarget).data("url"),i=$(t.currentTarget).data("title"),n=$(t.currentTarget).data("question");errorBoxDecision(this.loca.LOCA_ALL_NETWORK_ATTENTION,i+" - "+n,this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){document.location.replace(e)}))},TechnologyDetails.prototype.onClickBuyCommander=function(t){let e=$(t.currentTarget).data("technology"),i=$(t.currentTarget).data("url"),n=$(t.currentTarget).data("question"),a=$(t.currentTarget).attr("href"),s=$("#build_amount").val();i&&n?errorBoxDecision(this.loca.LOCA_ALL_NOTICE,n,this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){document.location.replace(i)})):a&&$(t.currentTarget).attr("href",a+"&amount="+s+"&techID="+e)},TechnologyDetails.prototype.handleDowngrade=function(t,e){errorBoxDecision(this.loca.LOCA_ALL_NETWORK_ATTENTION,this.loca.locaDemolishStructureQuestion.replace("TECHNOLOGY_NAME",e)+"<br><br>"+$("#demolition_costs_tooltip").html(),this.loca.LOCA_ALL_YES,this.loca.LOCA_ALL_NO,(function(){buildListActionDemolish(t)}))},TechnologyDetails.prototype.onClickDowngrade=function(t){let e=$(t.currentTarget).data("technology"),i=$(t.currentTarget).data("name");planetMoveInProgress?errorBoxDecision(LocalizationStrings.attention,LocalizationStrings.planetMoveBreakUpWarning,LocalizationStrings.yes,LocalizationStrings.no,this.handleDowngrade.bind(this,e,i)):this.handleDowngrade(e,i)},TechnologyDetails.prototype.onClickMaximum=function(t){this.setMaximumBuildableAmount()},TechnologyDetails.prototype.onClickSelectClass=function(t){t.preventDefault();let e=$(t.currentTarget).data("characterclassid");this.selectClass(e)},TechnologyDetails.prototype.onClickDeselectClass=function(t){t.preventDefault();let e=$(t.currentTarget).data("characterclassid");this.deselectClass(e)},TechnologyDetails.prototype.onClickShow=function(t){this.show($(t.currentTarget).closest(".hasDetails").data("technology"))},TechnologyDetails.prototype.onClickHide=function(t){this.hide($(t.currentTarget))},TechnologyDetails.prototype.selectClass=function(t){let e=this,i=this.selectCharacterClassEndpoint.replace("CHARACTERCLASSID",t);$.post(i).done((function(t){var i=$.parseJSON(t);"success"===i.status?e.show(37):e.displayErrors(i)}))},TechnologyDetails.prototype.deselectClass=function(t){let e=this,i=this.deselectCharacterClassEndpoint.replace("CHARACTERCLASSID",t);$.post(i).done((function(t){var i=$.parseJSON(t);"success"===i.status?e.show(37):e.displayErrors(i)}))},TechnologyDetails.prototype.displayErrors=function(t){t.errorCode;fadeBox(t.errorMessage||"",!0)},TechnologyDetails.prototype.show=function(t){let e=this,i=$(".technology.hasDetails[data-technology="+t+"]"),n=$("#technologydetails_wrapper"),a=$("#technologydetails_content"),s=$("#technologydetails"),o=a.ogameLoadingIndicator();o.show(),$.ajax({url:this.technologyDetailsEndpoint,data:{technology:t}}).done((function(r){if("failure"===r.status)e.displayErrors(r.errors),o.hide();else{n.toggleClass("slide-up",!0),n.toggleClass("slide-down",!1),$(".showsDetails").removeClass("showsDetails"),i.closest(".hasDetails").addClass("showsDetails"),o.hide();let e=$("header[data-anchor=technologyDetails]");s.length>0?(removeTooltip(s.find(getTooltipSelector())),s.replaceWith(r.content[r.target]),s.addClass(e.data("technologydetails-size")).offset(e.offset())):(a.append(r.content[r.target]),s.addClass(e.data("technologydetails-size")).offset(e.offset())),$(document).trigger("ajaxShowElement",void 0===t?0:t)}}))},TechnologyDetails.prototype.hide=function(){let t=$("#technologydetails");removeTooltip(t.find(getTooltipSelector())),$("#technologydetails_wrapper").removeClass("slide-up"),this.startSlideDown(),$(".showsDetails").removeClass("showsDetails")},TechnologyDetails.prototype.startSlideDown=function(){$("#technologydetails_wrapper").toggleClass("slide-down",!0),this.timerSlideDownEnd=setTimeout(function(){this.stopSlideDown()}.bind(this),500)},TechnologyDetails.prototype.stopSlideDown=function(){$("#technologydetails_wrapper").removeClass("slide-down"),clearTimeout(this.timerSlideDownEnd),this.timerSlideDownEnd=null},TechnologyDetails.prototype.setMaximumBuildableAmount=function(){var t=$("#technologydetails #build_amount");t.val(t.attr("max"))},$(document).on("click",".sendBuddyRequestLink",(function(t){t.preventDefault();var e=$(this).data("playerid"),i=$(this).data("playername");$.ajax({type:"POST",url:"/buddies",data:{action:1,player_id:e,_token:$('meta[name="csrf-token"]').attr("content")},success:function(t){fadeBox("Buddy request sent to "+i,!1)},error:function(t){fadeBox(t.responseJSON&&t.responseJSON.message?t.responseJSON.message:"Failed to send buddy request",!0)}})})),$(document).on("click",".ignorePlayerLink",(function(t){t.preventDefault();var e=$(this).data("playerid"),i=$("<form>",{method:"POST",action:"/buddies/ignore"});i.append($("<input>",{type:"hidden",name:"_token",value:$('meta[name="csrf-token"]').attr("content")})),i.append($("<input>",{type:"hidden",name:"ignored_user_id",value:e})),$("body").append(i),i.submit()})),function(){var t=ogame.messages.initDetailMessages;ogame.messages.initDetailMessages=function(e){t.call(ogame.messages,e),$(".overlayDiv ul.pagination").off("click.msgPagination").on("click.msgPagination","li.p_li a",(function(t){if(t.preventDefault(),t.stopPropagation(),$(this).hasClass("disabled"))return!1;var e=$(this).data("messageid"),i=$(this).data("tab"),n=$(this).data("subtab");if(!e)return!1;var a="/ajax/messages/"+e;i&&(a+="?tab="+encodeURIComponent(i),n&&(a+="&subtab="+encodeURIComponent(n)));var s=$(this).closest(".overlayDiv");0===s.length&&(s=$(".overlayDiv"));var o=s.closest(".ui-dialog"),r=o.length?o.width():null,l=o.length?o.height():null,c=o.length?o.position():null;return $.get(a,(function(t){try{removeTooltip(s.find(getTooltipSelector()))}catch(t){}s.empty().append(t),o.length&&r&&l&&(o.css({width:r,height:l}),c&&o.css({top:c.top,left:c.left}),o.hide().show()),ogame.messages.initDetailMessages(!0);try{initTooltips()}catch(t){}})).fail((function(){"function"==typeof fadeBox&&"undefined"!=typeof loca&&fadeBox(loca.LOCA_GALAXY_ERROR_OCCURED,1)})),!1}))}}();
